[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m222 | [0m[35m            Dictionary format is {protocol: proxy_url}[0m
[30;1m223 | [0m[35m            Where protocol is https, http, etc. and proxy_url can contain[0m
[30;1m224 | [0m[35m            optional authentication information in the format[0m
[30;1m225 | [0m[35m            "https://username:password@proxy_host:port"[0m
[30;1m226 | [0m[35m            If you have a proxy configuration in msticpyconfig.yaml and[0m
[30;1m227 | [0m[35m            you do not want to use it, set this to an empty dictionary.[0m
[30;1m228 | [0m[35m        fail_on_partial: bool[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m            Dictionary format is {protocol: proxy_url}[0m
[30;1m100 | [0m[35m            Where protocol is https, http, etc. and proxy_url can contain[0m
[30;1m101 | [0m[35m            optional authentication information in the format[0m
[30;1m102 | [0m[35m            "https://username:password@proxy_host:port"[0m
[30;1m103 | [0m[35m            If you have a proxy configuration in msticpyconfig.yaml and[0m
[30;1m104 | [0m[35m            you do not want to use it, set this to an empty dictionary.[0m
[30;1m105 | [0m[35m            (can be overridden in connect method)[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        """[0m
[30;1m47 | [0m[35m        super().__init__(connection_str=connection_str, **kwargs)[0m
[30;1m48 | [0m[35m        self.environment = kwargs.get("data_environment", DataEnvironment.Kusto)[0m
[30;1m49 | [0m[35m        self.set_driver_property(DriverProps.EFFECTIVE_ENV, DataEnvironment.Kusto.name)[0m
[30;1m50 | [0m[35m        self._connected = True[0m
[30;1m51 | [0m[35m        self._kusto_settings: KustoClusterSettings = _get_kusto_settings()[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m449 | [0m[35m    "username": ("username", "user_name"),[0m
[30;1m450 | [0m[35m    "private_key": ("privatekey", "private_key"),[0m
[30;1m451 | [0m[35m    "certificate": ("certificate", "cert"),[0m
[30;1m452 | [0m[35m    "private_key_secret": ("privatekeysecret", "private_key_secret"),[0m
[30;1m453 | [0m[35m}[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m449 | [0m[35m    "username": ("username", "user_name"),[0m
[30;1m450 | [0m[35m    "private_key": ("privatekey", "private_key"),[0m
[30;1m451 | [0m[35m    "certificate": ("certificate", "cert"),[0m
[30;1m452 | [0m[35m    "private_key_secret": ("privatekeysecret", "private_key_secret"),[0m
[30;1m453 | [0m[35m}[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m449 | [0m[35m    "username": ("username", "user_name"),[0m
[30;1m450 | [0m[35m    "private_key": ("privatekey", "private_key"),[0m
[30;1m451 | [0m[35m    "certificate": ("certificate", "cert"),[0m
[30;1m452 | [0m[35m    "private_key_secret": ("privatekeysecret", "private_key_secret"),[0m
[30;1m453 | [0m[35m}[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m447 | [0m[35m    "client_id": ("clientid", "client_id"),[0m
[30;1m448 | [0m[35m    "client_secret": ("clientsecret", "client_secret"),[0m
[30;1m449 | [0m[35m    "username": ("username", "user_name"),[0m
[30;1m450 | [0m[35m    "private_key": ("privatekey", "private_key"),[0m
[30;1m451 | [0m[35m    "certificate": ("certificate", "cert"),[0m
[30;1m452 | [0m[35m    "private_key_secret": ("privatekeysecret", "private_key_secret"),[0m
[30;1m453 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m447 | [0m[35m    "client_id": ("clientid", "client_id"),[0m
[30;1m448 | [0m[35m    "client_secret": ("clientsecret", "client_secret"),[0m
[30;1m449 | [0m[35m    "username": ("username", "user_name"),[0m
[30;1m450 | [0m[35m    "private_key": ("privatekey", "private_key"),[0m
[30;1m451 | [0m[35m    "certificate": ("certificate", "cert"),[0m
[30;1m452 | [0m[35m    "private_key_secret": ("privatekeysecret", "private_key_secret"),[0m
[30;1m453 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m447 | [0m[35m    "client_id": ("clientid", "client_id"),[0m
[30;1m448 | [0m[35m    "client_secret": ("clientsecret", "client_secret"),[0m
[30;1m449 | [0m[35m    "username": ("username", "user_name"),[0m
[30;1m450 | [0m[35m    "private_key": ("privatekey", "private_key"),[0m
[30;1m451 | [0m[35m    "certificate": ("certificate", "cert"),[0m
[30;1m452 | [0m[35m    "private_key_secret": ("privatekeysecret", "private_key_secret"),[0m
[30;1m453 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m230 | [0m[35m            ),[0m
[30;1m231 | [0m[35m        }[0m
[30;1m232 | [0m[35m        if "private_key_secret" in cs_dict:[0m
[30;1m233 | [0m[35m            client_credential["passphrase"] = cs_dict["private_key_secret"][0m
[30;1m234 | [0m[35m        result: dict[str, Any] | None = None[0m
[30;1m235 | [0m[35m        if not (self.oauth_url and self.api_root):[0m
[30;1m236 | [0m[35m            err_msg: str = f"Missing OAuth {self.oauth_url} or api_root {self.api_root}"[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m229 | [0m[35m                "utf-8",[0m
[30;1m230 | [0m[35m            ),[0m
[30;1m231 | [0m[35m        }[0m
[30;1m232 | [0m[35m        if "private_key_secret" in cs_dict:[0m
[30;1m233 | [0m[35m            client_credential["passphrase"] = cs_dict["private_key_secret"][0m
[30;1m234 | [0m[35m        result: dict[str, Any] | None = None[0m
[30;1m235 | [0m[35m        if not (self.oauth_url and self.api_root):[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m223 | [0m[35m        cert_data: Certificate = load_der_x509_certificate(certificate.read_bytes())[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m        client_credential: dict[str, Any] = {[0m
[30;1m226 | [0m[35m            "private_key": private_key.read_text(encoding="utf-8"),[0m
[30;1m227 | [0m[35m            "thumbprint": cert_data.fingerprint(hashes.SHA1()).hex(),  # nosec[0m
[30;1m228 | [0m[35m            "public_certificate": cert_data.public_bytes(encoding=Encoding.PEM).decode([0m
[30;1m229 | [0m[35m                "utf-8",[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m223 | [0m[35m        cert_data: Certificate = load_der_x509_certificate(certificate.read_bytes())[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m        client_credential: dict[str, Any] = {[0m
[30;1m226 | [0m[35m            "private_key": private_key.read_text(encoding="utf-8"),[0m
[30;1m227 | [0m[35m            "thumbprint": cert_data.fingerprint(hashes.SHA1()).hex(),  # nosec[0m
[30;1m228 | [0m[35m            "public_certificate": cert_data.public_bytes(encoding=Encoding.PEM).decode([0m
[30;1m229 | [0m[35m                "utf-8",[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m218 | [0m[35m        _check_config(cs_dict, "certificate", "application authentication")[0m
[30;1m219 | [0m[35m        client_id: str = cs_dict["client_id"][0m
[30;1m220 | [0m[35m        certificate: Path = Path(cs_dict["certificate"])[0m
[30;1m221 | [0m[35m        private_key: Path = Path(cs_dict["private_key"])[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        cert_data: Certificate = load_der_x509_certificate(certificate.read_bytes())[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m218 | [0m[35m        _check_config(cs_dict, "certificate", "application authentication")[0m
[30;1m219 | [0m[35m        client_id: str = cs_dict["client_id"][0m
[30;1m220 | [0m[35m        certificate: Path = Path(cs_dict["certificate"])[0m
[30;1m221 | [0m[35m        private_key: Path = Path(cs_dict["private_key"])[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        cert_data: Certificate = load_der_x509_certificate(certificate.read_bytes())[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m410 | [0m[35m		"subcategory": "User Account Management",[0m
[30;1m411 | [0m[35m		"event_id": 4724,[0m
[30;1m412 | [0m[35m		"description": "An attempt was made to reset an account's password. ",[0m
[30;1m413 | [0m[35m		"full_desc": "4724: An attempt was made to reset an account's password. "[0m
[30;1m414 | [0m[35m	},[0m
[30;1m415 | [0m[35m	{[0m
[30;1m416 | [0m[35m		"category": "Account Management",[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m409 | [0m[35m		"category": "Account Management",[0m
[30;1m410 | [0m[35m		"subcategory": "User Account Management",[0m
[30;1m411 | [0m[35m		"event_id": 4724,[0m
[30;1m412 | [0m[35m		"description": "An attempt was made to reset an account's password. ",[0m
[30;1m413 | [0m[35m		"full_desc": "4724: An attempt was made to reset an account's password. "[0m
[30;1m414 | [0m[35m	},[0m
[30;1m415 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m403 | [0m[35m		"subcategory": "User Account Management",[0m
[30;1m404 | [0m[35m		"event_id": 4723,[0m
[30;1m405 | [0m[35m		"description": "An attempt was made to change an account's password. ",[0m
[30;1m406 | [0m[35m		"full_desc": "4723: An attempt was made to change an account's password. "[0m
[30;1m407 | [0m[35m	},[0m
[30;1m408 | [0m[35m	{[0m
[30;1m409 | [0m[35m		"category": "Account Management",[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m402 | [0m[35m		"category": "Account Management",[0m
[30;1m403 | [0m[35m		"subcategory": "User Account Management",[0m
[30;1m404 | [0m[35m		"event_id": 4723,[0m
[30;1m405 | [0m[35m		"description": "An attempt was made to change an account's password. ",[0m
[30;1m406 | [0m[35m		"full_desc": "4723: An attempt was made to change an account's password. "[0m
[30;1m407 | [0m[35m	},[0m
[30;1m408 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m270 | [0m[35m		"subcategory": "Other Account Management Events",[0m
[30;1m271 | [0m[35m		"event_id": 4793,[0m
[30;1m272 | [0m[35m		"description": "The Password Policy Checking API was called. ",[0m
[30;1m273 | [0m[35m		"full_desc": "4793: The Password Policy Checking API was called. "[0m
[30;1m274 | [0m[35m	},[0m
[30;1m275 | [0m[35m	{[0m
[30;1m276 | [0m[35m		"category": "Account Management",[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m269 | [0m[35m		"category": "Account Management",[0m
[30;1m270 | [0m[35m		"subcategory": "Other Account Management Events",[0m
[30;1m271 | [0m[35m		"event_id": 4793,[0m
[30;1m272 | [0m[35m		"description": "The Password Policy Checking API was called. ",[0m
[30;1m273 | [0m[35m		"full_desc": "4793: The Password Policy Checking API was called. "[0m
[30;1m274 | [0m[35m	},[0m
[30;1m275 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m263 | [0m[35m		"subcategory": "Other Account Management Events",[0m
[30;1m264 | [0m[35m		"event_id": 4782,[0m
[30;1m265 | [0m[35m		"description": "The password hash an account was accessed. ",[0m
[30;1m266 | [0m[35m		"full_desc": "4782: The password hash an account was accessed. "[0m
[30;1m267 | [0m[35m	},[0m
[30;1m268 | [0m[35m	{[0m
[30;1m269 | [0m[35m		"category": "Account Management",[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m262 | [0m[35m		"category": "Account Management",[0m
[30;1m263 | [0m[35m		"subcategory": "Other Account Management Events",[0m
[30;1m264 | [0m[35m		"event_id": 4782,[0m
[30;1m265 | [0m[35m		"description": "The password hash an account was accessed. ",[0m
[30;1m266 | [0m[35m		"full_desc": "4782: The password hash an account was accessed. "[0m
[30;1m267 | [0m[35m	},[0m
[30;1m268 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m231 | [0m[35m        {add_query_items}'[0m
[30;1m232 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Discovery/SM[0m
[30;1m233 | [0m[35m  b64_pe:[0m
[30;1m234 | [0m[35m    description: Finding base64 encoded PE files header seen in the command line parameters[0m
[30;1m235 | [0m[35m    metadata:[0m
[30;1m236 | [0m[35m    args:[0m
[30;1m237 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m299 | [0m[35m                    )[0m
[30;1m300 | [0m[35m                    continue[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m                for env_value in metadata.get("data_environments", []):[0m
[30;1m303 | [0m[35m                    if "." in env_value:[0m
[30;1m304 | [0m[35m                        env_value = env_value.split(".")[1][0m
[30;1m305 | [0m[35m                    environment = DataEnvironment.parse(env_value)[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m630 | [0m[35m        if not val:[0m
[30;1m631 | [0m[35m            continue[0m
[30;1m632 | [0m[35m        if isinstance(val, dict) and "EnvironmentVar" in val:[0m
[30;1m633 | [0m[35m            env_name = val.get("EnvironmentVar")[0m
[30;1m634 | [0m[35m            if not env_name:[0m
[30;1m635 | [0m[35m                mp_errs.append(f"{section}: No environment variable name specified.")[0m
[30;1m636 | [0m[35m            elif env_name not in os.environ:[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m549 | [0m[35m        )[0m
[30;1m550 | [0m[35m[0m
[30;1m551 | [0m[35m        mp_errors.extend([0m
[30;1m552 | [0m[35m            _check_env_vars(args_key=p_setting.get("Args"), section=sec_path)[0m
[30;1m553 | [0m[35m        )[0m
[30;1m554 | [0m[35m    return mp_errors, mp_warnings[0m
[30;1m555 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35mdef _get_custom_config():[0m
[30;1m333 | [0m[35m    config_path = os.environ.get(_CONFIG_ENV_VAR, None)[0m
[30;1m334 | [0m[35m    if config_path and Path(config_path).is_file():[0m
[30;1m335 | [0m[35m        _CURRENT_CONF_FILE(str(Path(config_path).resolve()))[0m
[30;1m336 | [0m[35m        return _read_config_file(current_config_path())[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m330 | [0m[35m        )[0m
[30;1m331 | [0m[35m        raise NotImplementedError(err_msg)[0m
[30;1m332 | [0m[35m    if "EnvironmentVar" in config_setting:[0m
[30;1m333 | [0m[35m        env_value: str | None = os.environ.get(config_setting["EnvironmentVar"])[0m
[30;1m334 | [0m[35m        if not env_value:[0m
[30;1m335 | [0m[35m            warnings.warn([0m
[30;1m336 | [0m[35m                f"Environment variable {config_setting['EnvironmentVar']}"[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m187 | [0m[35m    auth_methods : List[str], optional[0m
[30;1m188 | [0m[35m        List of authentication methods to try[0m
[30;1m189 | [0m[35m        Possible options are:[0m
[30;1m190 | [0m[35m        - "env" - to get authentication details from environment variables[0m
[30;1m191 | [0m[35m        - "cli" - to use Azure CLI authentication details[0m
[30;1m192 | [0m[35m        - "msi" - to user Managed Service Identity details[0m
[30;1m193 | [0m[35m        - "interactive" - to prompt for interactive login[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m385 | [0m[35m        """Refresh the authentication token."""[0m
[30;1m386 | [0m[35m        logger.info("Refreshing authentication token...")[0m
[30;1m387 | [0m[35m        try:[0m
[30;1m388 | [0m[35m            response = self.client.post("/auth_token/extend")[0m
[30;1m389 | [0m[35m            response.raise_for_status()[0m
[30;1m390 | [0m[35m            result = self._parse_json(response)[0m
[30;1m391 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m355 | [0m[35m        try:[0m
[30;1m356 | [0m[35m            response = self.client.post([0m
[30;1m357 | [0m[35m                "/login",[0m
[30;1m358 | [0m[35m                json={"username": username, "password": password},[0m
[30;1m359 | [0m[35m            )[0m
[30;1m360 | [0m[35m            response.raise_for_status()[0m
[30;1m361 | [0m[35m            result = self._parse_json(response)[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m355 | [0m[35m        try:[0m
[30;1m356 | [0m[35m            response = self.client.post([0m
[30;1m357 | [0m[35m                "/login",[0m
[30;1m358 | [0m[35m                json={"username": username, "password": password},[0m
[30;1m359 | [0m[35m            )[0m
[30;1m360 | [0m[35m            response.raise_for_status()[0m
[30;1m361 | [0m[35m            result = self._parse_json(response)[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m347 | [0m[35m            username = self.config.get("username")[0m
[30;1m348 | [0m[35m            password = self.config.get("password")[0m
[30;1m349 | [0m[35m            if not username or not password:[0m
[30;1m350 | [0m[35m                msg = "Both 'username' and 'password' must be provided."[0m
[30;1m351 | [0m[35m                raise PrismaCloudAuthError(msg)[0m
[30;1m352 | [0m[35m            msg = "authentication information obtained"[0m
[30;1m353 | [0m[35m            logger.debug(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m349 | [0m[35m        if not username or not password:[0m
[30;1m350 | [0m[35m            username = self.config.get("username")[0m
[30;1m351 | [0m[35m            password = self.config.get("password")[0m
[30;1m352 | [0m[35m            if not username or not password:[0m
[30;1m353 | [0m[35m                msg = "Both 'username' and 'password' must be provided."[0m
[30;1m354 | [0m[35m                raise PrismaCloudAuthError(msg)[0m
[30;1m355 | [0m[35m            msg = "authentication information obtained"[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m345 | [0m[35m            )[0m
[30;1m346 | [0m[35m        if not username or not password:[0m
[30;1m347 | [0m[35m            username = self.config.get("username")[0m
[30;1m348 | [0m[35m            password = self.config.get("password")[0m
[30;1m349 | [0m[35m            if not username or not password:[0m
[30;1m350 | [0m[35m                msg = "Both 'username' and 'password' must be provided."[0m
[30;1m351 | [0m[35m                raise PrismaCloudAuthError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m345 | [0m[35m            )[0m
[30;1m346 | [0m[35m        if not username or not password:[0m
[30;1m347 | [0m[35m            username = self.config.get("username")[0m
[30;1m348 | [0m[35m            password = self.config.get("password")[0m
[30;1m349 | [0m[35m            if not username or not password:[0m
[30;1m350 | [0m[35m                msg = "Both 'username' and 'password' must be provided."[0m
[30;1m351 | [0m[35m                raise PrismaCloudAuthError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m343 | [0m[35m                if ":" in connection_str[0m
[30;1m344 | [0m[35m                else None[0m
[30;1m345 | [0m[35m            )[0m
[30;1m346 | [0m[35m        if not username or not password:[0m
[30;1m347 | [0m[35m            username = self.config.get("username")[0m
[30;1m348 | [0m[35m            password = self.config.get("password")[0m
[30;1m349 | [0m[35m            if not username or not password:[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m339 | [0m[35m        if connection_str:[0m
[30;1m340 | [0m[35m            username = username or connection_str.split(":")[0][0m
[30;1m341 | [0m[35m            password = ([0m
[30;1m342 | [0m[35m                password or connection_str.split(":")[1][0m
[30;1m343 | [0m[35m                if ":" in connection_str[0m
[30;1m344 | [0m[35m                else None[0m
[30;1m345 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m        if connection_str:[0m
[30;1m340 | [0m[35m            username = username or connection_str.split(":")[0][0m
[30;1m341 | [0m[35m            password = ([0m
[30;1m342 | [0m[35m                password or connection_str.split(":")[1][0m
[30;1m343 | [0m[35m                if ":" in connection_str[0m
[30;1m344 | [0m[35m                else None[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m330 | [0m[35m        -------[0m
[30;1m331 | [0m[35m        >>> driver = PrismaCloudDriver()[0m
[30;1m332 | [0m[35m        >>> # Authenticate using separate username and password parameters[0m
[30;1m333 | [0m[35m        >>> driver.connect(username="user@example.com", password="xxxxx")[0m
[30;1m334 | [0m[35m        >>> # Alternatively, using a connection string:[0m
[30;1m335 | [0m[35m        >>> driver.connect(connection_str="user@example.com:xxxxx")[0m
[30;1m336 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m329 | [0m[35m        Example[0m
[30;1m330 | [0m[35m        -------[0m
[30;1m331 | [0m[35m        >>> driver = PrismaCloudDriver()[0m
[30;1m332 | [0m[35m        >>> # Authenticate using separate username and password parameters[0m
[30;1m333 | [0m[35m        >>> driver.connect(username="user@example.com", password="xxxxx")[0m
[30;1m334 | [0m[35m        >>> # Alternatively, using a connection string:[0m
[30;1m335 | [0m[35m        >>> driver.connect(connection_str="user@example.com:xxxxx")[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m309 | [0m[35m        Behavior[0m
[30;1m310 | [0m[35m        --------[0m
[30;1m311 | [0m[35m        - If `connection_str` is provided, the method extracts the username and password from it.[0m
[30;1m312 | [0m[35m        - If either the username or password remains missing,[0m
[30;1m313 | [0m[35m        it attempts to retrieve them from the driver configuration.[0m
[30;1m314 | [0m[35m        - Sends a POST request to the `/login` endpoint with the provided credentials.[0m
[30;1m315 | [0m[35m        - On a successful login (indicated by a "login_successful" message),[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m        Behavior[0m
[30;1m310 | [0m[35m        --------[0m
[30;1m311 | [0m[35m        - If `connection_str` is provided, the method extracts the username and password from it.[0m
[30;1m312 | [0m[35m        - If either the username or password remains missing,[0m
[30;1m313 | [0m[35m        it attempts to retrieve them from the driver configuration.[0m
[30;1m314 | [0m[35m        - Sends a POST request to the `/login` endpoint with the provided credentials.[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m297 | [0m[35m            The corresponding password for the Prisma Cloud account.[0m
[30;1m298 | [0m[35m        connection_str : str or None, optional[0m
[30;1m299 | [0m[35m            An alternative connection string in the format "username:password". This[0m
[30;1m300 | [0m[35m            parameter is used to extract credentials if `username` and `password` are not provided.[0m
[30;1m301 | [0m[35m        **kwargs : Any[0m
[30;1m302 | [0m[35m            Additional keyword arguments to be passed to the connection logic.[0m
[30;1m303 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m296 | [0m[35m        password : str or None, optional[0m
[30;1m297 | [0m[35m            The corresponding password for the Prisma Cloud account.[0m
[30;1m298 | [0m[35m        connection_str : str or None, optional[0m
[30;1m299 | [0m[35m            An alternative connection string in the format "username:password". This[0m
[30;1m300 | [0m[35m            parameter is used to extract credentials if `username` and `password` are not provided.[0m
[30;1m301 | [0m[35m        **kwargs : Any[0m
[30;1m302 | [0m[35m            Additional keyword arguments to be passed to the connection logic.[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m294 | [0m[35m        username : str or None, optional[0m
[30;1m295 | [0m[35m            The Prisma Cloud account username for authentication.[0m
[30;1m296 | [0m[35m        password : str or None, optional[0m
[30;1m297 | [0m[35m            The corresponding password for the Prisma Cloud account.[0m
[30;1m298 | [0m[35m        connection_str : str or None, optional[0m
[30;1m299 | [0m[35m            An alternative connection string in the format "username:password". This[0m
[30;1m300 | [0m[35m            parameter is used to extract credentials if `username` and `password` are not provided.[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m293 | [0m[35m        ----------[0m
[30;1m294 | [0m[35m        username : str or None, optional[0m
[30;1m295 | [0m[35m            The Prisma Cloud account username for authentication.[0m
[30;1m296 | [0m[35m        password : str or None, optional[0m
[30;1m297 | [0m[35m            The corresponding password for the Prisma Cloud account.[0m
[30;1m298 | [0m[35m        connection_str : str or None, optional[0m
[30;1m299 | [0m[35m            An alternative connection string in the format "username:password". This[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m286 | [0m[35m        an access token if the login is successful. The token is stored in[0m
[30;1m287 | [0m[35m        `self.client.headers` to enable subsequent authenticated requests. Credentials[0m
[30;1m288 | [0m[35m        can be provided directly via the `username` and `password` parameters, or as a[0m
[30;1m289 | [0m[35m        single `connection_str` (formatted as "username:password"). If neither is provided,[0m
[30;1m290 | [0m[35m        the method attempts to retrieve the credentials from the driver configuration.[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m        Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m285 | [0m[35m        This method sends authentication credentials to the Prisma Cloud API and retrieves[0m
[30;1m286 | [0m[35m        an access token if the login is successful. The token is stored in[0m
[30;1m287 | [0m[35m        `self.client.headers` to enable subsequent authenticated requests. Credentials[0m
[30;1m288 | [0m[35m        can be provided directly via the `username` and `password` parameters, or as a[0m
[30;1m289 | [0m[35m        single `connection_str` (formatted as "username:password"). If neither is provided,[0m
[30;1m290 | [0m[35m        the method attempts to retrieve the credentials from the driver configuration.[0m
[30;1m291 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m275 | [0m[35m    def connect(  # type: ignore[override][0m
[30;1m276 | [0m[35m        self,[0m
[30;1m277 | [0m[35m        username: str | None = None,[0m
[30;1m278 | [0m[35m        password: str | None = None,[0m
[30;1m279 | [0m[35m        connection_str: str | None = None,[0m
[30;1m280 | [0m[35m        **kwargs: Any,[0m
[30;1m281 | [0m[35m    ) -> "PrismaCloudDriver":[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    Example Usage direct query:[0m
[30;1m115 | [0m[35m      >>> driver = PrismaCloudDriver(base_url="https://api.prismacloud.io", timeout=200)[0m
[30;1m116 | [0m[35m      >>> driver.connect(username="user@example.com", password="xxxxx")[0m
[30;1m117 | [0m[35m      >>> # Execute a network search query[0m
[30;1m118 | [0m[35m      >>> query_result = driver.direct_execute_query("config where cloud.type = 'aws'", "network")[0m
[30;1m119 | [0m[35m      >>> print(query_result)[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m    retries.[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    Features:[0m
[30;1m94 | [0m[35m      - Authenticate with Prisma Cloud using username and password.[0m
[30;1m95 | [0m[35m      - Authenticate using msticpyconfig configuration file.[0m
[30;1m96 | [0m[35m      - Execute predefined queries on different Prisma Cloud data sources.[0m
[30;1m97 | [0m[35m      - Retrieve assets, config_resource, events, and network-related data.[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m59 | [0m[35m@import_driver.register[0m
[30;1m60 | [0m[35mdef _(data_environment: DataEnvironment) -> type:[0m
[30;1m61 | [0m[35m    """Import driver class for a data environment."""[0m
[30;1m62 | [0m[35m    mod_name, cls_name = _ENVIRONMENT_DRIVERS.get(data_environment, (None, None))[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if not (mod_name and cls_name):[0m
[30;1m65 | [0m[35m        raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m697 | [0m[35m                "to use certificate authentication"[0m
[30;1m698 | [0m[35m            )[0m
[30;1m699 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m700 | [0m[35m        cert_bytes: bytes = base64.b64decode(auth_params.params["certificate"])[0m
[30;1m701 | [0m[35m        ([0m
[30;1m702 | [0m[35m            private_key,[0m
[30;1m703 | [0m[35m            certificate,[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m6 | [0m[35m"""Kusto Driver subclass."""[0m
[30;1m7 | [0m[35mfrom __future__ import annotations[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport base64[0m
[30;1m10 | [0m[35mimport dataclasses[0m
[30;1m11 | [0m[35mimport json[0m
[30;1m12 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m706 | [0m[35m        if private_key is None or certificate is None:[0m
[30;1m707 | [0m[35m            err_msg = f"Could not load certificate for cluster {self.cluster_uri}"[0m
[30;1m708 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m709 | [0m[35m        private_cert: bytes = private_key.private_bytes([0m
[30;1m710 | [0m[35m            encoding=serialization.Encoding.PEM,[0m
[30;1m711 | [0m[35m            format=serialization.PrivateFormat.TraditionalOpenSSL,[0m
[30;1m712 | [0m[35m            encryption_algorithm=serialization.NoEncryption(),[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m703 | [0m[35m            certificate,[0m
[30;1m704 | [0m[35m            _,[0m
[30;1m705 | [0m[35m        ) = pkcs12.load_key_and_certificates(data=cert_bytes, password=None)[0m
[30;1m706 | [0m[35m        if private_key is None or certificate is None:[0m
[30;1m707 | [0m[35m            err_msg = f"Could not load certificate for cluster {self.cluster_uri}"[0m
[30;1m708 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m709 | [0m[35m        private_cert: bytes = private_key.private_bytes([0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m702 | [0m[35m            private_key,[0m
[30;1m703 | [0m[35m            certificate,[0m
[30;1m704 | [0m[35m            _,[0m
[30;1m705 | [0m[35m        ) = pkcs12.load_key_and_certificates(data=cert_bytes, password=None)[0m
[30;1m706 | [0m[35m        if private_key is None or certificate is None:[0m
[30;1m707 | [0m[35m            err_msg = f"Could not load certificate for cluster {self.cluster_uri}"[0m
[30;1m708 | [0m[35m            raise ValueError(err_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m699 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m700 | [0m[35m        cert_bytes: bytes = base64.b64decode(auth_params.params["certificate"])[0m
[30;1m701 | [0m[35m        ([0m
[30;1m702 | [0m[35m            private_key,[0m
[30;1m703 | [0m[35m            certificate,[0m
[30;1m704 | [0m[35m            _,[0m
[30;1m705 | [0m[35m        ) = pkcs12.load_key_and_certificates(data=cert_bytes, password=None)[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m178 | [0m[35m            Dictionary format is {protocol: proxy_url}[0m
[30;1m179 | [0m[35m            Where protocol is https, http, etc. and proxy_url can contain[0m
[30;1m180 | [0m[35m            optional authentication information in the format[0m
[30;1m181 | [0m[35m            "https://username:password@proxy_host:port"[0m
[30;1m182 | [0m[35m            If you have a proxy configuration in msticpyconfig.yaml and[0m
[30;1m183 | [0m[35m            you do not want to use it, set this to an empty dictionary.[0m
[30;1m184 | [0m[35m            (can be overridden in connect method)[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1003 | [0m[35m                setting_name=key_name,[0m
[30;1m1004 | [0m[35m            )[0m
[30;1m1005 | [0m[35m            if isinstance(value, dict)[0m
[30;1m1006 | [0m[35m            and (value.get("EnvironmentVar") or value.get("KeyVault"))[0m
[30;1m1007 | [0m[35m            else value[0m
[30;1m1008 | [0m[35m        )[0m
[30;1m1009 | [0m[35m        for key_name, value in args.items()[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m752 | [0m[35m                return True[0m
[30;1m753 | [0m[35m            # Create a basic auth object for the request[0m
[30;1m754 | [0m[35m            basic_auth = httpx.BasicAuth([0m
[30;1m755 | [0m[35m                username=self._account_id, password=self._api_key  # type: ignore[arg-type][0m
[30;1m756 | [0m[35m            )[0m
[30;1m757 | [0m[35m            # Stream download and write to file[0m
[30;1m758 | [0m[35m            logger.info([0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m497 | [0m[35m            Read more about GeoLite2 : https://dev.maxmind.com/geoip/geoip2/geolite2/[0m
[30;1m498 | [0m[35m            Sign up for a MaxMind account:[0m
[30;1m499 | [0m[35m            https://www.maxmind.com/en/geolite2/signup[0m
[30;1m500 | [0m[35m            Set your password and create a license key:[0m
[30;1m501 | [0m[35m            https://www.maxmind.com/en/accounts/current/license-key[0m
[30;1m502 | [0m[35m        account_id: str, optional[0m
[30;1m503 | [0m[35m            Your numeric Maxmind account ID, default is None.[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    Notes[0m
[30;1m195 | [0m[35m    -----[0m
[30;1m196 | [0m[35m    Saves `obj` as picked, base64-encoded blob to[0m
[30;1m197 | [0m[35m    a new notebook cell.[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m164 | [0m[35mfrom base64 import b64decode[0m
[30;1m165 | [0m[35mimport pickle[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m## Store dynamic summaries as base64 byte string[0m
[30;1m168 | [0m[35msummary_data = {encoded_bytes}[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m# decode and unpickle the summaries[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m161 | [0m[35m# the object "{var_name}"[0m
[30;1m162 | [0m[35m#########################################[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35mfrom base64 import b64decode[0m
[30;1m165 | [0m[35mimport pickle[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m## Store dynamic summaries as base64 byte string[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m6 | [0m[35m"""Notebook utility functions."""[0m
[30;1m7 | [0m[35m# pickle only used here for storing data.[0m
[30;1m8 | [0m[35mimport pickle  # nosec[0m
[30;1m9 | [0m[35mfrom base64 import b64encode[0m
[30;1m10 | [0m[35mfrom typing import Any, Iterable, Optional, Union[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom IPython import get_ipython[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m500 | [0m[35mand[0m
[30;1m501 | [0m[35m[Base64Unpack Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Base64Unpack[0m
[30;1m502 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m500 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m### base64unpack[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m### base64unpack[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m14 | [0m[35m_LAZY_IMPORTS = {[0m
[30;1m15 | [0m[35m    "msticpy.nbwidgets.core.IPyDisplayMixin",[0m
[30;1m16 | [0m[35m    "msticpy.nbwidgets.core.RegisteredWidget",[0m
[30;1m17 | [0m[35m    "msticpy.nbwidgets.get_environment_key.GetEnvironmentKey",[0m
[30;1m18 | [0m[35m    "msticpy.nbwidgets.get_text.GetText",[0m
[30;1m19 | [0m[35m    "msticpy.nbwidgets.lookback.Lookback",[0m
[30;1m20 | [0m[35m    "msticpy.nbwidgets.option_buttons.OptionButtons",[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m307 | [0m[35m        )[0m
[30;1m308 | [0m[35m        req_body: dict[str, str] = {[0m
[30;1m309 | [0m[35m            "username": cs_dict["client_id"],[0m
[30;1m310 | [0m[35m            "password": cs_dict["client_secret"],[0m
[30;1m311 | [0m[35m        }[0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m        # Authenticate and obtain cookie for future calls[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m    ([0m
[30;1m126 | [0m[35m        AzureCredEnvNames.AZURE_CLIENT_ID,[0m
[30;1m127 | [0m[35m        AzureCredEnvNames.AZURE_USERNAME,[0m
[30;1m128 | [0m[35m        AzureCredEnvNames.AZURE_PASSWORD,[0m
[30;1m129 | [0m[35m        AzureCredEnvNames.AZURE_TENANT_ID,[0m
[30;1m130 | [0m[35m    ),[0m
[30;1m131 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m    #   "CS002:SecretInNextLine",[0m
[30;1m109 | [0m[35m    #   Justification="This is an enum of env variable names"[0m
[30;1m110 | [0m[35m    # )][0m
[30;1m111 | [0m[35m    AZURE_PASSWORD: ClassVar[str] = "AZURE_PASSWORD"  # User password  # nosec  # noqa[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m_VALID_ENV_VAR_COMBOS: tuple[tuple[str, ...], ...] = ([0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m    #   "CS002:SecretInNextLine",[0m
[30;1m109 | [0m[35m    #   Justification="This is an enum of env variable names"[0m
[30;1m110 | [0m[35m    # )][0m
[30;1m111 | [0m[35m    AZURE_PASSWORD: ClassVar[str] = "AZURE_PASSWORD"  # User password  # nosec  # noqa[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m_VALID_ENV_VAR_COMBOS: tuple[tuple[str, ...], ...] = ([0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m    #   "CS002:SecretInNextLine",[0m
[30;1m109 | [0m[35m    #   Justification="This is an enum of env variable names"[0m
[30;1m110 | [0m[35m    # )][0m
[30;1m111 | [0m[35m    AZURE_PASSWORD: ClassVar[str] = "AZURE_PASSWORD"  # User password  # nosec  # noqa[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m_VALID_ENV_VAR_COMBOS: tuple[tuple[str, ...], ...] = ([0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m        "AZURE_CLIENT_SEND_CERTIFICATE_CHAIN"[0m
[30;1m100 | [0m[35m    )[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    # Username and password:[0m
[30;1m103 | [0m[35m    AZURE_USERNAME: ClassVar[str] = ([0m
[30;1m104 | [0m[35m        "AZURE_USERNAME"  # The username/upn of an AAD user account.[0m
[30;1m105 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m    # (Optional) The password protecting the certificate file[0m
[30;1m91 | [0m[35m    # (for PFX (PKCS12) certificates).[0m
[30;1m92 | [0m[35m    AZURE_CLIENT_CERTIFICATE_PASSWORD: ClassVar[str] = ([0m
[30;1m93 | [0m[35m        "AZURE_CLIENT_CERTIFICATE_PASSWORD"  # nosec  # noqa[0m
[30;1m94 | [0m[35m    )[0m
[30;1m95 | [0m[35m    # (Optional) Specifies whether an authentication request will include an x5c[0m
[30;1m96 | [0m[35m    # header to support subject name / issuer based authentication.[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m89 | [0m[35m    AZURE_CLIENT_CERTIFICATE_PATH: ClassVar[str] = "AZURE_CLIENT_CERTIFICATE_PATH"[0m
[30;1m90 | [0m[35m    # (Optional) The password protecting the certificate file[0m
[30;1m91 | [0m[35m    # (for PFX (PKCS12) certificates).[0m
[30;1m92 | [0m[35m    AZURE_CLIENT_CERTIFICATE_PASSWORD: ClassVar[str] = ([0m
[30;1m93 | [0m[35m        "AZURE_CLIENT_CERTIFICATE_PASSWORD"  # nosec  # noqa[0m
[30;1m94 | [0m[35m    )[0m
[30;1m95 | [0m[35m    # (Optional) Specifies whether an authentication request will include an x5c[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m    # Certificate auth:[0m
[30;1m88 | [0m[35m    # A path to certificate and private key pair in PEM or PFX format[0m
[30;1m89 | [0m[35m    AZURE_CLIENT_CERTIFICATE_PATH: ClassVar[str] = "AZURE_CLIENT_CERTIFICATE_PATH"[0m
[30;1m90 | [0m[35m    # (Optional) The password protecting the certificate file[0m
[30;1m91 | [0m[35m    # (for PFX (PKCS12) certificates).[0m
[30;1m92 | [0m[35m    AZURE_CLIENT_CERTIFICATE_PASSWORD: ClassVar[str] = ([0m
[30;1m93 | [0m[35m        "AZURE_CLIENT_CERTIFICATE_PASSWORD"  # nosec  # noqa[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m177 | [0m[35m) -> ManagedIdentityCredential:[0m
[30;1m178 | [0m[35m    """Build a credential from Managed Identity."""[0m
[30;1m179 | [0m[35m    msi_kwargs: dict[str, Any] = kwargs.copy()[0m
[30;1m180 | [0m[35m    client_id = client_id or os.environ.get(AzureCredEnvNames.AZURE_CLIENT_ID)[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    try:[0m
[30;1m183 | [0m[35m        cred = ManagedIdentityCredential(client_id=client_id)[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m381 | [0m[35m        and provider.instance != "Default"[0m
[30;1m382 | [0m[35m        and not _use_v1_query_naming()[0m
[30;1m383 | [0m[35m    ):[0m
[30;1m384 | [0m[35m        container_name = f"{provider.environment}_{provider.instance.casefold()}"[0m
[30;1m385 | [0m[35m    else:[0m
[30;1m386 | [0m[35m        container_name = provider.environment[0m
[30;1m387 | [0m[35m    add_queries_to_entities([0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m500 | [0m[35mand[0m
[30;1m501 | [0m[35m[Base64Unpack Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Base64Unpack[0m
[30;1m502 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m500 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m### base64unpack[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m### base64unpack[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m134 | [0m[35mget_config = settings.get_config[0m
[30;1m135 | [0m[35msetup_logging()[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35mif not os.environ.get("KQLMAGIC_EXTRAS_REQUIRES"):[0m
[30;1m138 | [0m[35m    os.environ["KQLMAGIC_EXTRAS_REQUIRES"] = "jupyter-basic"[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m_LAZY_IMPORTS = {[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/secret_settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m50 | [0m[35m        auth_methods : List[str][0m
[30;1m51 | [0m[35m            The authentication methods to use for Key Vault auth[0m
[30;1m52 | [0m[35m            Possible values are:[0m
[30;1m53 | [0m[35m            - "env" - to get authentication details from environment variables[0m
[30;1m54 | [0m[35m            - "cli" - to use Azure CLI authentication details[0m
[30;1m55 | [0m[35m            - "msi" - to user Managed Service Identity details[0m
[30;1m56 | [0m[35m            - "interactive" - to prompt for interactive login[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mpconfig_defaults.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m159 | [0m[35m      host: str()[0m
[30;1m160 | [0m[35m      username: str(required=False)[0m
[30;1m161 | [0m[35m      # [SuppressMessage("Microsoft.Security", "CS002:SecretInNextLine", Justification="Test code")][0m
[30;1m162 | [0m[35m      password: *cred_key[0m
[30;1m163 | [0m[35m      port: int(required=False)[0m
[30;1m164 | [0m[35m      http_scheme: str(default=https, required=False)[0m
[30;1m165 | [0m[35m      verify: bool(required=False)[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m769 | [0m[35m        del button[0m
[30;1m770 | [0m[35m        self.metadata.version = self.version_widget.value[0m
[30;1m771 | [0m[35m        self.metadata.description = self.description_widget.value[0m
[30;1m772 | [0m[35m        self.metadata.data_environments = list(self.data_env_widget.value)[0m
[30;1m773 | [0m[35m        self.metadata.data_families = [[0m
[30;1m774 | [0m[35m            fam.strip()[0m
[30;1m775 | [0m[35m            for fam in self.data_families_widget.value.split(",")[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m745 | [0m[35m        """Populate the widgets with the metadata of the Metadata object."""[0m
[30;1m746 | [0m[35m        self.version_widget.value = self.metadata.version or ""[0m
[30;1m747 | [0m[35m        self.description_widget.value = self.metadata.description or ""[0m
[30;1m748 | [0m[35m        self.data_env_widget.value = ([0m
[30;1m749 | [0m[35m            tuple(self.metadata.data_environments)[0m
[30;1m750 | [0m[35m            if self.metadata.data_environments[0m
[30;1m751 | [0m[35m            else ()[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m708 | [0m[35m            [[0m
[30;1m709 | [0m[35m                self.version_widget,[0m
[30;1m710 | [0m[35m                self.description_widget,[0m
[30;1m711 | [0m[35m                self.data_env_widget,[0m
[30;1m712 | [0m[35m                self.data_families_widget,[0m
[30;1m713 | [0m[35m                self.database_widget,[0m
[30;1m714 | [0m[35m                widgets.Label([0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m660 | [0m[35m            description="Description",[0m
[30;1m661 | [0m[35m            **txt_fmt(),[0m
[30;1m662 | [0m[35m        )[0m
[30;1m663 | [0m[35m        self.data_env_widget: widgets.SelectMultiple = widgets.SelectMultiple([0m
[30;1m664 | [0m[35m            options=list(DataEnvironment.__members__),[0m
[30;1m665 | [0m[35m            description="Data Environments",[0m
[30;1m666 | [0m[35m            **sel_fmt(),[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_asset_search.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m          - UNENCRYPTED_DATA[0m
[30;1m99 | [0m[35m          - UNUSED_PRIVILEGES[0m
[30;1m100 | [0m[35m          - USER_ANOMALY[0m
[30;1m101 | [0m[35m          - WEAK_PASSWORD[0m
[30;1m102 | [0m[35m          - WEB_ATTACK[0m
[30;1m103 | [0m[35m          - WEB_SCRAPING[0m
[30;1m104 | [0m[35m  asset_host_with_high_cve:[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m331 | [0m[35m    @property[0m
[30;1m332 | [0m[35m    def job_id(self):[0m
[30;1m333 | [0m[35m        """Return current job ID."""[0m
[30;1m334 | [0m[35m        return mssparkutils.env.getJobId()[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m    @property[0m
[30;1m337 | [0m[35m    def config_path(self):[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m321 | [0m[35m    @property[0m
[30;1m322 | [0m[35m    def workspace_name(self) -> str:[0m
[30;1m323 | [0m[35m        """Return the Synapse workspace name."""[0m
[30;1m324 | [0m[35m        return mssparkutils.env.getWorkspaceName()[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m    @property[0m
[30;1m327 | [0m[35m    def fs_mounts(self) -> Dict[str, str]:[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35mdef is_in_synapse():[0m
[30;1m56 | [0m[35m    """Return True if running in Synapse Pipeline."""[0m
[30;1m57 | [0m[35m    return os.environ.get("MMLSPARK_PLATFORM_INFO") == "synapse"[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35mIdentityType = Literal["managed", "service_principal"][0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35mdef _set_mpconfig_var():[0m
[30;1m378 | [0m[35m    """Set MSTICPYCONFIG to file in user directory if no other found."""[0m
[30;1m379 | [0m[35m    mp_path_val = os.environ.get(MP_ENV_VAR)[0m
[30;1m380 | [0m[35m    if ([0m
[30;1m381 | [0m[35m        # If a valid MSTICPYCONFIG value is found - return[0m
[30;1m382 | [0m[35m        (mp_path_val and Path(mp_path_val).is_file())[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m322 | [0m[35m    else:[0m
[30;1m323 | [0m[35m        os.environ["KQLMAGIC_EXTRAS_REQUIRE"] = "jupyter-basic"[0m
[30;1m324 | [0m[35m    if is_in_aml():[0m
[30;1m325 | [0m[35m        os.environ["KQLMAGIC_AZUREML_COMPUTE"] = _get_vm_fqdn()[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35mdef _get_pkg_version(version: Union[str, Tuple]):[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m309 | [0m[35m    # Use the release ver specified in params, in the environment or[0m
[30;1m310 | [0m[35m    # the notebook default.[0m
[30;1m311 | [0m[35m    pkg_version = _get_pkg_version(min_mp_ver)[0m
[30;1m312 | [0m[35m    mp_install_version = mp_release or os.environ.get("MP_TEST_VER") or str(pkg_version)[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m    check_mp_ver(min_msticpy_ver=mp_install_version, extras=extras)[0m
[30;1m315 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mdef is_in_aml():[0m
[30;1m88 | [0m[35m    """Return True if running in Azure Machine Learning."""[0m
[30;1m89 | [0m[35m    return os.environ.get("APPSETTING_WEBSITE_SITE_NAME") == "AMLComputeInstance"[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef check_aml_settings([0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mdef is_in_aml_pyspark():[0m
[30;1m83 | [0m[35m    """Return True if running in Spark on Azure Machine Learning."""[0m
[30;1m84 | [0m[35m    return os.environ.get("AZUREML_FRAMEWORK") == "PySpark"[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mdef is_in_aml():[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_provider_base.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m<ul>[0m
[30;1m34 | [0m[35m    <li>Text - this is the usual way to store values that are not sensitive</li>[0m
[30;1m35 | [0m[35m    <li>Environment Var - Type the name of variable in the text box</li>[0m
[30;1m36 | [0m[35m    <li>Key Vault - use this for sensitive data like passwords and API keys<br>[0m
[30;1m37 | [0m[35m    The KeyVault value here can be left empty (the secret name is generated[0m
[30;1m38 | [0m[35m    from the settings path), can contain a secret name or can contain a[0m
[30;1m39 | [0m[35m    path {vaultname}/{secretname}[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_pandas_accessors.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m201 | [0m[35m        Parameters[0m
[30;1m202 | [0m[35m        ----------[0m
[30;1m203 | [0m[35m        data : pd.DataFrame[0m
[30;1m204 | [0m[35m            dataframe containing column to obfuscate[0m
[30;1m205 | [0m[35m        column_map : Mapping[str, Any], optional[0m
[30;1m206 | [0m[35m            Custom column mapping, by default None[0m
[30;1m207 | [0m[35m        use_default: bool[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_pandas_accessors.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m196 | [0m[35m        self, column_map: Mapping[str, Any] = None, use_default: bool = True[0m
[30;1m197 | [0m[35m    ) -> pd.DataFrame:[0m
[30;1m198 | [0m[35m        """[0m
[30;1m199 | [0m[35m        Obfuscate the data in columns of a pandas dataframe.[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        Parameters[0m
[30;1m202 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_pandas_accessors.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def b64extract(self, column: str, **kwargs) -> pd.DataFrame:[0m
[30;1m35 | [0m[35m        """[0m
[30;1m36 | [0m[35m        Base64-decode strings taken from a pandas dataframe.[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        Parameters[0m
[30;1m39 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m855 | [0m[35m[0m
[30;1m856 | [0m[35m    def extract(self, column, **kwargs) -> pd.DataFrame:[0m
[30;1m857 | [0m[35m        """[0m
[30;1m858 | [0m[35m        Base64 decode strings taken from a pandas dataframe.[0m
[30;1m859 | [0m[35m[0m
[30;1m860 | [0m[35m        Parameters[0m
[30;1m861 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m847 | [0m[35m# pylint: disable=too-few-public-methods[0m
[30;1m848 | [0m[35m@pd.api.extensions.register_dataframe_accessor("mp_b64")[0m
[30;1m849 | [0m[35mclass B64ExtractAccessor:[0m
[30;1m850 | [0m[35m    """Base64 Unpack pandas extension."""[0m
[30;1m851 | [0m[35m[0m
[30;1m852 | [0m[35m    def __init__(self, pandas_obj):[0m
[30;1m853 | [0m[35m        """Initialize the extension."""[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m638 | [0m[35m        file_type = f_type[0m
[30;1m639 | [0m[35m[0m
[30;1m640 | [0m[35m    try:[0m
[30;1m641 | [0m[35m        decoded_bytes = base64.b64decode(input_string)[0m
[30;1m642 | [0m[35m        return _unpack_and_hash_b64_binary(decoded_bytes, file_type)[0m
[30;1m643 | [0m[35m    except binascii.Error:[0m
[30;1m644 | [0m[35m        # we couldn't decode[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m    if decode_success:[0m
[30;1m417 | [0m[35m        # stuff that we have already decoded may also contain further[0m
[30;1m418 | [0m[35m        # base64 encoded strings[0m
[30;1m419 | [0m[35m        prefix = ([0m
[30;1m420 | [0m[35m            f"{item_prefix}.{fragment_index}." if item_prefix else f"{fragment_index}."[0m
[30;1m421 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    while True:[0m
[30;1m352 | [0m[35m        # search sequentially through the input string for any strings[0m
[30;1m353 | [0m[35m        # that look like base64[0m
[30;1m354 | [0m[35m        _debug_print_trace([0m
[30;1m355 | [0m[35m            f"regex searching {decoded_string[:200]} ",[0m
[30;1m356 | [0m[35m            f"from pos: {match_pos} bin_index {fragment_index}",[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m263 | [0m[35m    data: pd.DataFrame, column: str, trace: bool = False, utf16: bool = False[0m
[30;1m264 | [0m[35m) -> pd.DataFrame:[0m
[30;1m265 | [0m[35m    """[0m
[30;1m266 | [0m[35m    Base64 decode strings taken from a pandas dataframe.[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m    Parameters[0m
[30;1m269 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m221 | [0m[35m    input_string: str, trace: bool = False, utf16: bool = False[0m
[30;1m222 | [0m[35m) -> Tuple[str, pd.DataFrame]:[0m
[30;1m223 | [0m[35m    """[0m
[30;1m224 | [0m[35m    Base64 decode an input string.[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    Parameters[0m
[30;1m227 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m144 | [0m[35m    utf16: bool = False,[0m
[30;1m145 | [0m[35m) -> Any:[0m
[30;1m146 | [0m[35m    """[0m
[30;1m147 | [0m[35m    Base64 decode an input string or strings taken from a pandas dataframe.[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    Parameters[0m
[30;1m150 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m83 | [0m[35m}[0m
[30;1m84 | [0m[35m_BASE64_HEADER_OFFSET_TYPES = {"DAxMDA3NzcAMDAwMDAwM": "tar"}[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m# Base64 simple regex[0m
[30;1m87 | [0m[35m_BASE64_REGEX = "(?P<b64>[A-Za-z0-9+/\\n\\r]{30,}={0,2})"[0m
[30;1m88 | [0m[35mBASE64_REGEX_C = re.compile(_BASE64_REGEX, re.I | re.X)[0m
[30;1m89 | [0m[35m# Same expresion without group for pandas[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m24 | [0m[35mget_hashes(binary): Return md5, sha1 and sha256 hashes of input byte string[0m
[30;1m25 | [0m[35m"""[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mimport base64[0m
[30;1m28 | [0m[35mimport binascii[0m
[30;1m29 | [0m[35mimport gzip[0m
[30;1m30 | [0m[35mimport hashlib[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m7 | [0m[35mbase64_unpack.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mThe main function of this module is to decode and unpack[0m
[30;1m10 | [0m[35mstrings that are obfuscated using base64 and/or certain[0m
[30;1m11 | [0m[35mcompression algorithms such as gzip and zip.[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mIt has the following functions:[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m227 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m228 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m231 | [0m[35mand[0m
[30;1m232 | [0m[35m[Base64Unpack Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Base64Unpack[0m
[30;1m233 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m225 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m226 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m227 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m228 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m231 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m### base64unpack[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m226 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m227 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m228 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m### base64unpack[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m226 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m227 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m228 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m                self.driver.connect([0m
[30;1m50 | [0m[35m                    host=self.host,[0m
[30;1m51 | [0m[35m                    username=self.username,[0m
[30;1m52 | [0m[35m                    password=self.password,[0m
[30;1m53 | [0m[35m                    port=self.port,[0m
[30;1m54 | [0m[35m                )[0m
[30;1m55 | [0m[35m            elif self.bearer_token:[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m                self.driver.connect([0m
[30;1m50 | [0m[35m                    host=self.host,[0m
[30;1m51 | [0m[35m                    username=self.username,[0m
[30;1m52 | [0m[35m                    password=self.password,[0m
[30;1m53 | [0m[35m                    port=self.port,[0m
[30;1m54 | [0m[35m                )[0m
[30;1m55 | [0m[35m            elif self.bearer_token:[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m        super().__init__()[0m
[30;1m32 | [0m[35m        self._kwargs = kwargs[0m
[30;1m33 | [0m[35m        self.host = kwargs.get("host")[0m
[30;1m34 | [0m[35m        self.password = kwargs.get("password")[0m
[30;1m35 | [0m[35m        self.username = kwargs.get("username")[0m
[30;1m36 | [0m[35m        self.bearer_token = kwargs.get("bearer_token")[0m
[30;1m37 | [0m[35m        self.driver = SplunkDriver()[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m        super().__init__()[0m
[30;1m32 | [0m[35m        self._kwargs = kwargs[0m
[30;1m33 | [0m[35m        self.host = kwargs.get("host")[0m
[30;1m34 | [0m[35m        self.password = kwargs.get("password")[0m
[30;1m35 | [0m[35m        self.username = kwargs.get("username")[0m
[30;1m36 | [0m[35m        self.bearer_token = kwargs.get("bearer_token")[0m
[30;1m37 | [0m[35m        self.driver = SplunkDriver()[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m79 | [0m[35m        )[0m
[30;1m80 | [0m[35m        bytes_to_hash = bytes(string_to_hash, encoding="utf-8")[0m
[30;1m81 | [0m[35m        decoded_key = base64.b64decode(self.workspace_secret)[0m
[30;1m82 | [0m[35m        encoded_hash = base64.b64encode([0m
[30;1m83 | [0m[35m            hmac.new(decoded_key, bytes_to_hash, digestmod=hashlib.sha256).digest()[0m
[30;1m84 | [0m[35m        ).decode()[0m
[30;1m85 | [0m[35m        return f"SharedKey {self.workspace}:{encoded_hash}"[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m78 | [0m[35m            [method, str(content_length), content_type, x_headers, resource][0m
[30;1m79 | [0m[35m        )[0m
[30;1m80 | [0m[35m        bytes_to_hash = bytes(string_to_hash, encoding="utf-8")[0m
[30;1m81 | [0m[35m        decoded_key = base64.b64decode(self.workspace_secret)[0m
[30;1m82 | [0m[35m        encoded_hash = base64.b64encode([0m
[30;1m83 | [0m[35m            hmac.new(decoded_key, bytes_to_hash, digestmod=hashlib.sha256).digest()[0m
[30;1m84 | [0m[35m        ).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""LogAnalytics Uploader class."""[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport datetime[0m
[30;1m9 | [0m[35mimport hashlib[0m
[30;1m10 | [0m[35mimport hmac[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m    os.environ["KQLMAGIC_LOAD_MODE"] = "silent"[0m
[30;1m765 | [0m[35m    # Kqlmagic config will use AZ CLI login if available[0m
[30;1m766 | [0m[35m    kql_config = os.environ.get("KQLMAGIC_CONFIGURATION", "")[0m
[30;1m767 | [0m[35m    if "try_azcli_login" not in kql_config:[0m
[30;1m768 | [0m[35m        kql_config = ";".join([kql_config, "try_azcli_login=True"])[0m
[30;1m769 | [0m[35m        os.environ["KQLMAGIC_CONFIGURATION"] = kql_config[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m704 | [0m[35m    # 7. Error - no Microsoft Sentinel config[0m
[30;1m705 | [0m[35m    if current_config_path() is not None:[0m
[30;1m706 | [0m[35m        return True[0m
[30;1m707 | [0m[35m    mp_path = os.environ.get("MSTICPYCONFIG")[0m
[30;1m708 | [0m[35m    if mp_path and not Path(mp_path).is_file():[0m
[30;1m709 | [0m[35m        _err_output(_MISSING_MPCONFIG_ENV_ERR)[0m
[30;1m710 | [0m[35m        logger.warning("MSTICPYCONFIG set to %s but no file found", mp_path)[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m559 | [0m[35m    detect_opt = kwargs.get("detect_env", True)[0m
[30;1m560 | [0m[35m    if isinstance(detect_opt, bool):[0m
[30;1m561 | [0m[35m        return detect_opt[0m
[30;1m562 | [0m[35m    return env_name in detect_opt if isinstance(detect_opt, list) else True[0m
[30;1m563 | [0m[35m[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35mdef list_default_imports():[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m497 | [0m[35m    tok_data = token[0m
[30;1m498 | [0m[35m    tok_data = tok_data.split(".")[1][0m
[30;1m499 | [0m[35m    tok_data += "=" * ((4 - len(tok_data) % 4) % 4)[0m
[30;1m500 | [0m[35m    return json.loads(base64.b64decode(tok_data))[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35mdef _print_status(message, newline=True):[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""Keyvault client - adapted from Bluehound code."""[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mfrom typing import Any, List[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m84 | [0m[35m        auth_methods : List[str][0m
[30;1m85 | [0m[35m            The authentication methods to use for Key Vault auth[0m
[30;1m86 | [0m[35m            Possible values are:[0m
[30;1m87 | [0m[35m            - "env" - to get authentication details from environment variables[0m
[30;1m88 | [0m[35m            - "cli" - to use Azure CLI authentication details[0m
[30;1m89 | [0m[35m            - "msi" - to user Managed Service Identity details[0m
[30;1m90 | [0m[35m            - "interactive" - to prompt for interactive login[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m142 | [0m[35m            data_env_queries.update([0m
[30;1m143 | [0m[35m                self._read_queries_from_paths(query_paths=query_paths),[0m
[30;1m144 | [0m[35m            )[0m
[30;1m145 | [0m[35m        self.query_store: QueryStore = data_env_queries.get([0m
[30;1m146 | [0m[35m            self.environment_name,[0m
[30;1m147 | [0m[35m            QueryStore(self.environment_name),[0m
[30;1m148 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m533 | [0m[35m        Parameters[0m
[30;1m534 | [0m[35m        ----------[0m
[30;1m535 | [0m[35m        data : pd.DataFrame[0m
[30;1m536 | [0m[35m            dataframe containing column to obfuscate[0m
[30;1m537 | [0m[35m        column_map : Mapping[str, Any], optional[0m
[30;1m538 | [0m[35m            Custom column mapping, by default None[0m
[30;1m539 | [0m[35m        use_default: bool[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m528 | [0m[35m        self, column_map: Mapping[str, Any] = None, use_default: bool = True[0m
[30;1m529 | [0m[35m    ) -> pd.DataFrame:[0m
[30;1m530 | [0m[35m        """[0m
[30;1m531 | [0m[35m        Obfuscate the data in columns of a pandas dataframe.[0m
[30;1m532 | [0m[35m[0m
[30;1m533 | [0m[35m        Parameters[0m
[30;1m534 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m@pd.api.extensions.register_dataframe_accessor("mp_mask")[0m
[30;1m520 | [0m[35mclass ObfuscationAccessor:[0m
[30;1m521 | [0m[35m    """Base64 Unpack pandas extension."""[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    def __init__(self, pandas_obj):[0m
[30;1m524 | [0m[35m        """Initialize the extension."""[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m405 | [0m[35m    silent: bool = True,[0m
[30;1m406 | [0m[35m) -> pd.DataFrame:[0m
[30;1m407 | [0m[35m    """[0m
[30;1m408 | [0m[35m    Obfuscate columns of a DataFrame.[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m    Parameters[0m
[30;1m411 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m56 | [0m[35mSQL_KQL_FUNC_MAP = {[0m
[30;1m57 | [0m[35m    "add": FuncFormat(None, None, "{p0} + {p1}"),[0m
[30;1m58 | [0m[35m    "avg": FuncFormat("avg", None, None),[0m
[30;1m59 | [0m[35m    "base64": FuncFormat("base64_encode_tostring", None, None),[0m
[30;1m60 | [0m[35m    "concat": FuncFormat("strcat", None, None),[0m
[30;1m61 | [0m[35m    "count": FuncFormat("count", None, None),[0m
[30;1m62 | [0m[35m    "if": FuncFormat("iif", None, None),[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m205 | [0m[35m        # between user/pass and authorization bearer token[0m
[30;1m206 | [0m[35m        if "username" in cs_dict:[0m
[30;1m207 | [0m[35m            self._required_params = ["host", "username", "password"][0m
[30;1m208 | [0m[35m            print("username/password method is selected.")[0m
[30;1m209 | [0m[35m        else:[0m
[30;1m210 | [0m[35m            self._required_params = ["host", "bearer_token"][0m
[30;1m211 | [0m[35m            print("bearer_token method is selected.")[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m204 | [0m[35m        # Different required parameters for the REST API authentication method[0m
[30;1m205 | [0m[35m        # between user/pass and authorization bearer token[0m
[30;1m206 | [0m[35m        if "username" in cs_dict:[0m
[30;1m207 | [0m[35m            self._required_params = ["host", "username", "password"][0m
[30;1m208 | [0m[35m            print("username/password method is selected.")[0m
[30;1m209 | [0m[35m        else:[0m
[30;1m210 | [0m[35m            self._required_params = ["host", "bearer_token"][0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m74 | [0m[35m        "(string) The Splunk account username, which is used to "[0m
[30;1m75 | [0m[35m        + "authenticate the Splunk instance."[0m
[30;1m76 | [0m[35m    ),[0m
[30;1m77 | [0m[35m    "password": "(string) The password for the Splunk account.",[0m
[30;1m78 | [0m[35m    "bearer_token": ([0m
[30;1m79 | [0m[35m        "(string) The Authorization Bearer Token <JWT> created in the Splunk."[0m
[30;1m80 | [0m[35m        + " (Named as 'splunkToken' in Splunk Python SDK)"[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m74 | [0m[35m        "(string) The Splunk account username, which is used to "[0m
[30;1m75 | [0m[35m        + "authenticate the Splunk instance."[0m
[30;1m76 | [0m[35m    ),[0m
[30;1m77 | [0m[35m    "password": "(string) The password for the Splunk account.",[0m
[30;1m78 | [0m[35m    "bearer_token": ([0m
[30;1m79 | [0m[35m        "(string) The Authorization Bearer Token <JWT> created in the Splunk."[0m
[30;1m80 | [0m[35m        + " (Named as 'splunkToken' in Splunk Python SDK)"[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/proxy_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m58 | [0m[35m            if "Password" in settings[0m
[30;1m59 | [0m[35m            else None[0m
[30;1m60 | [0m[35m        )[0m
[30;1m61 | [0m[35m        auth_str = f"{user}:{password}@" if user else ""[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        proxy_dict[protocol.casefold()] = f"{prot_str}//{auth_str}{host}"[0m
[30;1m64 | [0m[35m    return proxy_dict[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/proxy_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m        )[0m
[30;1m56 | [0m[35m        password = ([0m
[30;1m57 | [0m[35m            get_protected_setting("http.proxies.{protocol}", "Password")[0m
[30;1m58 | [0m[35m            if "Password" in settings[0m
[30;1m59 | [0m[35m            else None[0m
[30;1m60 | [0m[35m        )[0m
[30;1m61 | [0m[35m        auth_str = f"{user}:{password}@" if user else ""[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/proxy_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m            else None[0m
[30;1m55 | [0m[35m        )[0m
[30;1m56 | [0m[35m        password = ([0m
[30;1m57 | [0m[35m            get_protected_setting("http.proxies.{protocol}", "Password")[0m
[30;1m58 | [0m[35m            if "Password" in settings[0m
[30;1m59 | [0m[35m            else None[0m
[30;1m60 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/proxy_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m53 | [0m[35m            if "UserName" in settings[0m
[30;1m54 | [0m[35m            else None[0m
[30;1m55 | [0m[35m        )[0m
[30;1m56 | [0m[35m        password = ([0m
[30;1m57 | [0m[35m            get_protected_setting("http.proxies.{protocol}", "Password")[0m
[30;1m58 | [0m[35m            if "Password" in settings[0m
[30;1m59 | [0m[35m            else None[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/proxy_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m                UserName: user[0m
[30;1m22 | [0m[35m                Password: [PLACEHOLDER][0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mThe entries for the username and password can be specified[0m
[30;1m25 | [0m[35mas a string, an dictionary of EnvironmentVar: ENV_VAR_NAME[0m
[30;1m26 | [0m[35mor a dictionary of one of the following:[0m
[30;1m27 | [0m[35m- KeyVault: None[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/proxy_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m19 | [0m[35m            https:[0m
[30;1m20 | [0m[35m                Url: proxy_url[0m
[30;1m21 | [0m[35m                UserName: user[0m
[30;1m22 | [0m[35m                Password: [PLACEHOLDER][0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mThe entries for the username and password can be specified[0m
[30;1m25 | [0m[35mas a string, an dictionary of EnvironmentVar: ENV_VAR_NAME[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/proxy_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m            http:[0m
[30;1m16 | [0m[35m                Url: proxy_url[0m
[30;1m17 | [0m[35m                UserName: user[0m
[30;1m18 | [0m[35m                Password: [PLACEHOLDER][0m
[30;1m19 | [0m[35m            https:[0m
[30;1m20 | [0m[35m                Url: proxy_url[0m
[30;1m21 | [0m[35m                UserName: user[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m85 | [0m[35m        # self.use_query_paths = True[0m
[30;1m86 | [0m[35m        # self.has_driver_queries = False[0m
[30;1m87 | [0m[35m        self._previous_connection = False[0m
[30;1m88 | [0m[35m        self.data_environment = kwargs.get("data_environment")[0m
[30;1m89 | [0m[35m        self._query_filter: Dict[str, Set[str]] = defaultdict(set)[0m
[30;1m90 | [0m[35m        self._instance: Optional[str] = None[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m191 | [0m[35m        init_args = settings.get("InitArgs", {})[0m
[30;1m192 | [0m[35m        if init_args is None:[0m
[30;1m193 | [0m[35m            init_args = {}[0m
[30;1m194 | [0m[35m        if data_env := settings.get("DataEnvironment"):[0m
[30;1m195 | [0m[35m            init_args["data_environment"] = data_env[0m
[30;1m196 | [0m[35m        instance = cls(**init_args)[0m
[30;1m197 | [0m[35m        logger.info("Initialized %s", name)[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/get_environment_key.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m53 | [0m[35m            Whether to display on instantiation (the default is False)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        """[0m
[30;1m56 | [0m[35m        env_val = os.environ.get(env_var)[0m
[30;1m57 | [0m[35m        self._name = env_var[0m
[30;1m58 | [0m[35m        self._value = ""[0m
[30;1m59 | [0m[35m        description = kwargs.pop("prompt", description)[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/get_environment_key.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35m__author__ = "Ian Hellen"[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mclass GetEnvironmentKey(RegisteredWidget, IPyDisplayMixin):[0m
[30;1m21 | [0m[35m    """[0m
[30;1m22 | [0m[35m    GetEnvironmentKey.[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m430 | [0m[35m    def _set_kql_cloud(self):[0m
[30;1m431 | [0m[35m        """If cloud is set in Azure Settings override default."""[0m
[30;1m432 | [0m[35m        # Check that there isn't a cloud setting in the KQLMAGIC env var[0m
[30;1m433 | [0m[35m        kql_config = os.environ.get(_KQL_ENV_OPTS, "")[0m
[30;1m434 | [0m[35m        if "cloud" in kql_config:[0m
[30;1m435 | [0m[35m            # Set by user - we don't want to override this[0m
[30;1m436 | [0m[35m            kql_cloud = self._get_kql_option("cloud")[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m408 | [0m[35m    @staticmethod[0m
[30;1m409 | [0m[35m    def _set_kql_env_option(option, value):[0m
[30;1m410 | [0m[35m        """Set an item in the KqlMagic main config environment variable."""[0m
[30;1m411 | [0m[35m        kql_config = os.environ.get(_KQL_ENV_OPTS, "")[0m
[30;1m412 | [0m[35m        current_opts = {[0m
[30;1m413 | [0m[35m            opt.split("=")[0].strip(): opt.split("=")[1][0m
[30;1m414 | [0m[35m            for opt in kql_config.split(";")[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m38 | [0m[35m# Need to set KQL option before importing[0m
[30;1m39 | [0m[35mdef _set_kql_env_option(option, value):[0m
[30;1m40 | [0m[35m    """Set an item in the KqlMagic main config environment variable."""[0m
[30;1m41 | [0m[35m    kql_config = os.environ.get(_KQL_ENV_OPTS, "")[0m
[30;1m42 | [0m[35m    current_opts = {[0m
[30;1m43 | [0m[35m        opt.split("=")[0].strip(): opt.split("=")[1][0m
[30;1m44 | [0m[35m        for opt in kql_config.split(";")[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/cmd_line_rules.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1 | [0m[35m{[0m
[30;1m2 | [0m[35m    "Syslog" : [[0m
[30;1m3 | [0m[35m        ".*authorized_keys.*",[0m
[30;1m4 | [0m[35m        ".*(wget|curl).*\\|?.*sh.*",[0m
[30;1m5 | [0m[35m        ".*(:\\(\\){:\\|:&};:).*",[0m
[30;1m6 | [0m[35m        ".*(mv.*\/dev\/null).*",[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/sectools/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m41 | [0m[35m    "msticpy.context.geoip.IPStackLookup",[0m
[30;1m42 | [0m[35m    "msticpy.context.geoip.geo_distance",[0m
[30;1m43 | [0m[35m    "msticpy.context.tilookup.TILookup",[0m
[30;1m44 | [0m[35m    "msticpy.transform.base64unpack as base64",[0m
[30;1m45 | [0m[35m    "msticpy.transform.iocextract.IoCExtract",[0m
[30;1m46 | [0m[35m}[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/aiagents/config_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    """[0m
[30;1m63 | [0m[35m    if "api_key" in config:[0m
[30;1m64 | [0m[35m        api_key = os.environ.get(str(config["api_key"]), None)[0m
[30;1m65 | [0m[35m        if not api_key:[0m
[30;1m66 | [0m[35m            raise MsticpyUserConfigError([0m
[30;1m67 | [0m[35m                f"Environment variable {config['api_key']} specified, but not found!"[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m235 | [0m[35m        {add_query_items}'[0m
[30;1m236 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Discovery/SM[0m
[30;1m237 | [0m[35m  b64_pe:[0m
[30;1m238 | [0m[35m    description: Finding base64 encoded PE files header seen in the command line parameters[0m
[30;1m239 | [0m[35m    metadata:[0m
[30;1m240 | [0m[35m    args:[0m
[30;1m241 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/logging.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m69 | [0m[35mdef _get_logging_config():[0m
[30;1m70 | [0m[35m    """Obtain logging configuration from environment or config."""[0m
[30;1m71 | [0m[35m    log_file = os.environ.get(_MP_LOG_FILE_ENV)[0m
[30;1m72 | [0m[35m    log_level = os.environ.get(_MP_LOG_LEVEL_ENV)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    log_file = log_file or get_config("Logging.FileName", None)[0m
[30;1m75 | [0m[35m    log_level = log_level or get_config("Logging.LogLevel", None)[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/logging.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mdef _get_logging_config():[0m
[30;1m70 | [0m[35m    """Obtain logging configuration from environment or config."""[0m
[30;1m71 | [0m[35m    log_file = os.environ.get(_MP_LOG_FILE_ENV)[0m
[30;1m72 | [0m[35m    log_level = os.environ.get(_MP_LOG_LEVEL_ENV)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    log_file = log_file or get_config("Logging.FileName", None)[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyring_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m        if self.debug:[0m
[30;1m104 | [0m[35m            print(f"Deleting {secret_name} from keyring {self.keyring}")[0m
[30;1m105 | [0m[35m        self._secret_names.remove(secret_name)[0m
[30;1m106 | [0m[35m        keyring.delete_password(self.keyring, secret_name)[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m    @staticmethod[0m
[30;1m109 | [0m[35m    def is_keyring_available() -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyring_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m88 | [0m[35m        if self.debug:[0m
[30;1m89 | [0m[35m            print(f"Saving {secret_name} to keyring {self.keyring}")[0m
[30;1m90 | [0m[35m        self._secret_names.add(secret_name)[0m
[30;1m91 | [0m[35m        keyring.set_password(self.keyring, secret_name, secret_value)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    def delete_secret(self, secret_name: str):[0m
[30;1m94 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyring_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m        if self.debug:[0m
[30;1m63 | [0m[35m            print(f"Fetching {secret_name} from keyring")[0m
[30;1m64 | [0m[35m        try:[0m
[30;1m65 | [0m[35m            secret = keyring.get_password(self.keyring, secret_name)[0m
[30;1m66 | [0m[35m        except (KeyringError, KeyringLocked):[0m
[30;1m67 | [0m[35m            if self.debug:[0m
[30;1m68 | [0m[35m                print([0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m188 | [0m[35m        if self.rb_store_type.value == STORE_TEXT:[0m
[30;1m189 | [0m[35m            sec_value = self.txt_val.value[0m
[30;1m190 | [0m[35m        elif self.rb_store_type.value == STORE_ENV_VAR:[0m
[30;1m191 | [0m[35m            sec_value = os.environ.get(self.txt_val.value.strip())[0m
[30;1m192 | [0m[35m        else:[0m
[30;1m193 | [0m[35m            return[0m
[30;1m194 | [0m[35m        if not sec_value:[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/cmd_line.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m93 | [0m[35m    with open(detection_rules, "r", encoding="utf-8") as json_file:[0m
[30;1m94 | [0m[35m        rules = json.load(json_file)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    # Decode any Base64 encoded commands so we can match on them as well[0m
[30;1m97 | [0m[35m    b64_regex = re.compile([0m
[30;1m98 | [0m[35m        "(?P<b64>(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|"[0m
[30;1m99 | [0m[35m        + "[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$)"[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbmagics.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m92 | [0m[35m                return results[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m            args = magic_arguments.parse_argstring(self.b64, line)[0m
[30;1m95 | [0m[35m            results, df_results = base64.unpack(cell, utf16=args.utf16)[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m            if args.clean:[0m
[30;1m98 | [0m[35m                results = re.sub(self._STRIP_TAGS, "", results)[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbmagics.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m            """[0m
[30;1m90 | [0m[35m            if cell is None:[0m
[30;1m91 | [0m[35m                results, _ = base64.unpack(line)[0m
[30;1m92 | [0m[35m                return results[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m            args = magic_arguments.parse_argstring(self.b64, line)[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbmagics.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m        def b64(self, line: str = "", cell: str = None) -> str:[0m
[30;1m74 | [0m[35m            """[0m
[30;1m75 | [0m[35m            Base64 IPython magic extension.[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m            Parameters[0m
[30;1m78 | [0m[35m            ----------[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbmagics.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    @magics_class[0m
[30;1m44 | [0m[35m    class Base64Magic(Magics):[0m
[30;1m45 | [0m[35m        """Base64 IPython magic extension."""[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        _STRIP_TAGS = r"</?decoded[^>]*>"[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbmagics.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m31 | [0m[35mfrom .._version import VERSION[0m
[30;1m32 | [0m[35mfrom ..common.utility import is_ipython[0m
[30;1m33 | [0m[35mfrom ..common.utility.ipython import save_obj_to_cell[0m
[30;1m34 | [0m[35mfrom ..transform import base64unpack as base64[0m
[30;1m35 | [0m[35mfrom ..transform.iocextract import IoCExtract[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m__version__ = VERSION[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m        description: The Registry key name[0m
[30;1m225 | [0m[35m        type: str[0m
[30;1m226 | [0m[35m  mail_message_alerts:[0m
[30;1m227 | [0m[35m    description: Lists alerts associated with a specified mail message[0m
[30;1m228 | [0m[35m    metadata:[0m
[30;1m229 | [0m[35m    args:[0m
[30;1m230 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m        {add_query_items}'[0m
[30;1m90 | [0m[35m    parameters:[0m
[30;1m91 | [0m[35m      ip_address:[0m
[30;1m92 | [0m[35m        description: Remote IP Address[0m
[30;1m93 | [0m[35m        type: str[0m
[30;1m94 | [0m[35m  url_alerts:[0m
[30;1m95 | [0m[35m    description: Lists alerts associated with a specified URL[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m        description: Name of host[0m
[30;1m72 | [0m[35m        type: str[0m
[30;1m73 | [0m[35m  ip_alerts:[0m
[30;1m74 | [0m[35m    description: Lists alerts associated with a specified remote IP[0m
[30;1m75 | [0m[35m    metadata:[0m
[30;1m76 | [0m[35m    args:[0m
[30;1m77 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m
[30;1m20 | [0m[35m      type: datetime[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m      type: str[0m
[30;1m14 | [0m[35m      default: "AlertInfo"[0m
[30;1m15 | [0m[35m    start:[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m  config_resource_rbac_disabled_azurekeyvault:[0m
[30;1m107 | [0m[35m    description: |-[0m
[30;1m108 | [0m[35m      List of Azure Key Vault instances where Role-Based Access Control (RBAC) is not enabled.[0m
[30;1m109 | [0m[35m      If this query returns results, investigate Azure Key Vault instances where Role-Based Access C[0m
[30;1m110 | [0m[35m      is disabled or not enforced. This condition can expose sensitive information, such as encrypti[0m
[30;1m111 | [0m[35m      secrets, or credentials, to unauthorized access due to inadequate access restrictions.[0m
[30;1m112 | [0m[35m      Security analysts should verify these instances for suspicious activities or unauthorized acce[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m105 | [0m[35mnetworkAcls does not exist) or (properties.publicNetworkAccess does not equal ignore case disabled a[0m
[30;1m106 | [0m[35m  config_resource_rbac_disabled_azurekeyvault:[0m
[30;1m107 | [0m[35m    description: |-[0m
[30;1m108 | [0m[35m      List of Azure Key Vault instances where Role-Based Access Control (RBAC) is not enabled.[0m
[30;1m109 | [0m[35m      If this query returns results, investigate Azure Key Vault instances where Role-Based Access C[0m
[30;1m110 | [0m[35m      is disabled or not enforced. This condition can expose sensitive information, such as encrypti[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m        description: enter query[0m
[30;1m81 | [0m[35m        type: str[0m
[30;1m82 | [0m[35m  config_resource_list_azurekeyvault:[0m
[30;1m83 | [0m[35m    description: Retrieve azurekeyvault configuration data from Prisma Cloud using relative time[0m
[30;1m84 | [0m[35m    metadata:[0m
[30;1m85 | [0m[35m    args:[0m
[30;1m86 | [0m[35m      query: *config_resource_query_relative[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m        description: enter query[0m
[30;1m67 | [0m[35m        type: str[0m
[30;1m68 | [0m[35m  search_config_resource_absolute:[0m
[30;1m69 | [0m[35m    description: Retrieve configuration data from Prisma Cloud using relative time using dynamic que[0m
[30;1m70 | [0m[35m    metadata:[0m
[30;1m71 | [0m[35m    args:[0m
[30;1m72 | [0m[35m      query: *config_resource_query_absolute[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m      default: 0[0m
[30;1m53 | [0m[35msources:[0m
[30;1m54 | [0m[35m  search_config_resource_relative:[0m
[30;1m55 | [0m[35m    description: Retrieve configuration data from Prisma Cloud using relative time using dynamic que[0m
[30;1m56 | [0m[35m    metadata:[0m
[30;1m57 | [0m[35m    args:[0m
[30;1m58 | [0m[35m      query: *config_resource_query_relative[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m      type: datetime[0m
[30;1m48 | [0m[35m      default: -7[0m
[30;1m49 | [0m[35m    end:[0m
[30;1m50 | [0m[35m      description: Query end time[0m
[30;1m51 | [0m[35m      type: datetime[0m
[30;1m52 | [0m[35m      default: 0[0m
[30;1m53 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m      type: int[0m
[30;1m44 | [0m[35m      default: 60[0m
[30;1m45 | [0m[35m    start:[0m
[30;1m46 | [0m[35m      description: Query start time[0m
[30;1m47 | [0m[35m      type: datetime[0m
[30;1m48 | [0m[35m      default: -7[0m
[30;1m49 | [0m[35m    end:[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m      type: str[0m
[30;1m40 | [0m[35m      default: minute[0m
[30;1m41 | [0m[35m    amount_value:[0m
[30;1m42 | [0m[35m      description: Field to use for time[0m
[30;1m43 | [0m[35m      type: int[0m
[30;1m44 | [0m[35m      default: 60[0m
[30;1m45 | [0m[35m    start:[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_config_resource_keyvault.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    data_source: "Prismacloud"[0m
[30;1m36 | [0m[35m  parameters:[0m
[30;1m37 | [0m[35m    unit_type:[0m
[30;1m38 | [0m[35m      description: Field to use for time[0m
[30;1m39 | [0m[35m      type: str[0m
[30;1m40 | [0m[35m      default: minute[0m
[30;1m41 | [0m[35m    amount_value:[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_heartbeat_info.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m50 | [0m[35m        description: Name of host[0m
[30;1m51 | [0m[35m        type: str[0m
[30;1m52 | [0m[35m      host_op:[0m
[30;1m53 | [0m[35m        description: The hostname match operator[0m
[30;1m54 | [0m[35m        type: str[0m
[30;1m55 | [0m[35m        default: has[0m
[30;1m56 | [0m[35m  get_info_by_ipaddress:[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_heartbeat_info.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m31 | [0m[35m        type: str[0m
[30;1m32 | [0m[35m        default: '| top 1 by TimeGenerated desc nulls last'[0m
[30;1m33 | [0m[35msources:[0m
[30;1m34 | [0m[35m  get_info_by_hostname:[0m
[30;1m35 | [0m[35m    description: Deprecated - use 'get_heartbeat_for_host'[0m
[30;1m36 | [0m[35m    metadata:[0m
[30;1m37 | [0m[35m      pivot:[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_heartbeat_info.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m        {add_query_items}'[0m
[30;1m70 | [0m[35m    parameters:[0m
[30;1m71 | [0m[35m      ip_address:[0m
[30;1m72 | [0m[35m        description: IP address value[0m
[30;1m73 | [0m[35m        type: str[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_heartbeat_info.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m      add_query_items:[0m
[30;1m30 | [0m[35m        description: Additional query clauses[0m
[30;1m31 | [0m[35m        type: str[0m
[30;1m32 | [0m[35m        default: '| top 1 by TimeGenerated desc nulls last'[0m
[30;1m33 | [0m[35msources:[0m
[30;1m34 | [0m[35m  get_info_by_hostname:[0m
[30;1m35 | [0m[35m    description: Deprecated - use 'get_heartbeat_for_host'[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_heartbeat_info.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m        description: Query start time[0m
[30;1m21 | [0m[35m        type: datetime[0m
[30;1m22 | [0m[35m      end:[0m
[30;1m23 | [0m[35m        description: Query end time[0m
[30;1m24 | [0m[35m        type: datetime[0m
[30;1m25 | [0m[35m      subscription_filter:[0m
[30;1m26 | [0m[35m        description: Optional subscription/tenant filter expression[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_heartbeat_info.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m        type: str[0m
[30;1m18 | [0m[35m        default: ''[0m
[30;1m19 | [0m[35m      start:[0m
[30;1m20 | [0m[35m        description: Query start time[0m
[30;1m21 | [0m[35m        type: datetime[0m
[30;1m22 | [0m[35m      end:[0m
[30;1m23 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m159 | [0m[35m        type: str[0m
[30;1m160 | [0m[35m        default: ''[0m
[30;1m161 | [0m[35m      host_name:[0m
[30;1m162 | [0m[35m        description: The hostname to find[0m
[30;1m163 | [0m[35m        type: str[0m
[30;1m164 | [0m[35m        default: ''[0m
[30;1m165 | [0m[35m      process_name:[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m95 | [0m[35m        description: 'The IP address listed in the alert'[0m
[30;1m96 | [0m[35m        type: str[0m
[30;1m97 | [0m[35m  list_alerts_for_host:[0m
[30;1m98 | [0m[35m    description: Retrieves list of alerts for a hostname or FQDN[0m
[30;1m99 | [0m[35m    metadata:[0m
[30;1m100 | [0m[35m      data_source: 'graph_alert'[0m
[30;1m101 | [0m[35m    args:[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m        type: str[0m
[30;1m164 | [0m[35m        default: ''[0m
[30;1m165 | [0m[35m      process_name:[0m
[30;1m166 | [0m[35m        description: The process name to find[0m
[30;1m167 | [0m[35m        type: str[0m
[30;1m168 | [0m[35m        default: ''[0m
[30;1m169 | [0m[35m      user_principal_name:[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m159 | [0m[35m        type: str[0m
[30;1m160 | [0m[35m        default: ''[0m
[30;1m161 | [0m[35m      host_name:[0m
[30;1m162 | [0m[35m        description: The hostname to find[0m
[30;1m163 | [0m[35m        type: str[0m
[30;1m164 | [0m[35m        default: ''[0m
[30;1m165 | [0m[35m      process_name:[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m      uri: None[0m
[30;1m156 | [0m[35m    parameters:[0m
[30;1m157 | [0m[35m      ip_address:[0m
[30;1m158 | [0m[35m        description: 'The host IP address listed in the alert'[0m
[30;1m159 | [0m[35m        type: str[0m
[30;1m160 | [0m[35m        default: ''[0m
[30;1m161 | [0m[35m      host_name:[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m      uri: None[0m
[30;1m93 | [0m[35m    parameters:[0m
[30;1m94 | [0m[35m      ip_address:[0m
[30;1m95 | [0m[35m        description: 'The IP address listed in the alert'[0m
[30;1m96 | [0m[35m        type: str[0m
[30;1m97 | [0m[35m  list_alerts_for_host:[0m
[30;1m98 | [0m[35m    description: Retrieves list of alerts for a hostname or FQDN[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m        type: str[0m
[30;1m79 | [0m[35m        default: ''[0m
[30;1m80 | [0m[35m  list_alerts_for_ip:[0m
[30;1m81 | [0m[35m    description: Retrieves list of alerts for a IP Address[0m
[30;1m82 | [0m[35m    metadata:[0m
[30;1m83 | [0m[35m      data_source: 'graph_alert'[0m
[30;1m84 | [0m[35m    args:[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        type: datetime[0m
[30;1m55 | [0m[35m        default: 0  # fake default to prevent this being viewed as required[0m
[30;1m56 | [0m[35m      end:[0m
[30;1m57 | [0m[35m        description: Query end time[0m
[30;1m58 | [0m[35m        type: datetime[0m
[30;1m59 | [0m[35m        default: 0  # fake default to prevent this being viewed as required[0m
[30;1m60 | [0m[35m  list_alerts_for_user:[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        description: 'The ID of the alert'[0m
[30;1m51 | [0m[35m        type: str[0m
[30;1m52 | [0m[35m      start:[0m
[30;1m53 | [0m[35m        description: Query start time[0m
[30;1m54 | [0m[35m        type: datetime[0m
[30;1m55 | [0m[35m        default: 0  # fake default to prevent this being viewed as required[0m
[30;1m56 | [0m[35m      end:[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m
[30;1m20 | [0m[35m        type: datetime[0m
[30;1m21 | [0m[35m      add_query_items:[0m
[30;1m22 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/msgraph/graph_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m        type: str[0m
[30;1m14 | [0m[35m        default: '/security/alerts'[0m
[30;1m15 | [0m[35m      start:[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        as lastTime where index= "*" timeformat={timeformat} earliest={start} latest={end} by index [0m
[30;1m46 | [0m[35m      | fieldformat firstTime=strftime(firstTime,"%Y/%m/%d %H:%M:%S")[0m
[30;1m47 | [0m[35m      | fieldformat lastTime=strftime(lastTime,"%Y/%m/%d %H:%M:%S")[0m
[30;1m48 | [0m[35m      | sort by totalCount desc[0m
[30;1m49 | [0m[35m      '[0m
[30;1m50 | [0m[35m  list_all_alerts:[0m
[30;1m51 | [0m[35m    description: Retrieves all configured alerts[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    add_query_items:[0m
[30;1m30 | [0m[35m      description: Additional query clauses[0m
[30;1m31 | [0m[35m      type: str[0m
[30;1m32 | [0m[35m      default: '| head 100'[0m
[30;1m33 | [0m[35m    timeformat:[0m
[30;1m34 | [0m[35m      description: 'Datetime format to use in Splunk query'[0m
[30;1m35 | [0m[35m      type: str[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m      description: Query start time[0m
[30;1m21 | [0m[35m      type: datetime[0m
[30;1m22 | [0m[35m    end:[0m
[30;1m23 | [0m[35m      description: Query end time[0m
[30;1m24 | [0m[35m      type: datetime[0m
[30;1m25 | [0m[35m    project_fields:[0m
[30;1m26 | [0m[35m      description: Project Field names[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m      type: str[0m
[30;1m18 | [0m[35m      default: '*'[0m
[30;1m19 | [0m[35m    start:[0m
[30;1m20 | [0m[35m      description: Query start time[0m
[30;1m21 | [0m[35m      type: datetime[0m
[30;1m22 | [0m[35m    end:[0m
[30;1m23 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/resourcegraph/resource_graph_queries.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m103 | [0m[35m      uri: None[0m
[30;1m104 | [0m[35m    parameters:[0m
[30;1m105 | [0m[35m      host_name:[0m
[30;1m106 | [0m[35m        description: A hostname to filter on[0m
[30;1m107 | [0m[35m        type: str[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/resourcegraph/resource_graph_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m        {add_query_items}'[0m
[30;1m52 | [0m[35m      uri: None[0m
[30;1m53 | [0m[35m  list_public_ips:[0m
[30;1m54 | [0m[35m    description: Retrieves list of resources with public IP addresses[0m
[30;1m55 | [0m[35m    metadata:[0m
[30;1m56 | [0m[35m    args:[0m
[30;1m57 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m561 | [0m[35m    Parameters[0m
[30;1m562 | [0m[35m    ----------[0m
[30;1m563 | [0m[35m    session: List[Cmd][0m
[30;1m564 | [0m[35m        list of Cmd datatype[0m
[30;1m565 | [0m[35m        an example session::[0m
[30;1m566 | [0m[35m[0m
[30;1m567 | [0m[35m            [[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m463 | [0m[35m    Parameters[0m
[30;1m464 | [0m[35m    ----------[0m
[30;1m465 | [0m[35m    session: List[Cmd][0m
[30;1m466 | [0m[35m        list of Cmd datatype[0m
[30;1m467 | [0m[35m        an example session::[0m
[30;1m468 | [0m[35m[0m
[30;1m469 | [0m[35m            [[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m354 | [0m[35m    Parameters[0m
[30;1m355 | [0m[35m    ----------[0m
[30;1m356 | [0m[35m    window: List[Cmd][0m
[30;1m357 | [0m[35m        part or all of a session, where a session is a list the Cmd datatype[0m
[30;1m358 | [0m[35m        an example session::[0m
[30;1m359 | [0m[35m[0m
[30;1m360 | [0m[35m            [[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m281 | [0m[35m    cmd: str[0m
[30;1m282 | [0m[35m        name of command (e.g. for Exchange powershell commands: "Set-Mailbox")[0m
[30;1m283 | [0m[35m    params_with_vals: Union[dict, set][0m
[30;1m284 | [0m[35m        dict of accompanying params and values for the cmd[0m
[30;1m285 | [0m[35m        e.g for Exchange powershell commands::[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m            {'Identity': 'an_identity' , 'ForwardingEmailAddress': 'email@email.com'}[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m100 | [0m[35m    for session in sessions:[0m
[30;1m101 | [0m[35m        prev = start_token[0m
[30;1m102 | [0m[35m        seq1_counts[prev] += 1[0m
[30;1m103 | [0m[35m        for cmd in session:[0m
[30;1m104 | [0m[35m            seq1_counts[cmd.name] += 1[0m
[30;1m105 | [0m[35m            seq2_counts[prev][cmd.name] += 1[0m
[30;1m106 | [0m[35m            prev = cmd.name[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35m    ----------[0m
[30;1m51 | [0m[35m    sessions: List[List[Cmd]][0m
[30;1m52 | [0m[35m        each session is a list of the Cmd datatype.[0m
[30;1m53 | [0m[35m        Where the Cmd datatype has a name attribute (command name) and[0m
[30;1m54 | [0m[35m        a params attribute (dict with the params and values associated[0m
[30;1m55 | [0m[35m        with the command)[0m
[30;1m56 | [0m[35m        an example session::[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35m    Parameters[0m
[30;1m50 | [0m[35m    ----------[0m
[30;1m51 | [0m[35m    sessions: List[List[Cmd]][0m
[30;1m52 | [0m[35m        each session is a list of the Cmd datatype.[0m
[30;1m53 | [0m[35m        Where the Cmd datatype has a name attribute (command name) and[0m
[30;1m54 | [0m[35m        a params attribute (dict with the params and values associated[0m
[30;1m55 | [0m[35m        with the command)[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35mHelper module for computations when modelling sessions.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mIn particular, this module is for when each session is a list of the[0m
[30;1m10 | [0m[35mCmd datatype with the params attribute set to a dictionary of[0m
[30;1m11 | [0m[35maccompanying params and values.[0m
[30;1m12 | [0m[35m"""[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_values.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m556 | [0m[35m    use_geo_mean: bool = False,[0m
[30;1m557 | [0m[35m) -> Tuple[List[Cmd], float]:[0m
[30;1m558 | [0m[35m    """[0m
[30;1m559 | [0m[35m    Find and compute likelihood of the rarest window of `window_len` in the session.[0m
[30;1m560 | [0m[35m[0m
[30;1m561 | [0m[35m    Parameters[0m
[30;1m562 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m697 | [0m[35m    columns = {[0m
[30;1m698 | [0m[35m        col["name"]: col["type"] for col in table_schema.get("standardColumns", {})[0m
[30;1m699 | [0m[35m    }[0m
[30;1m700 | [0m[35m    for col in table_schema.get("customColumns", []):[0m
[30;1m701 | [0m[35m        columns[col["name"]] = col["type"][0m
[30;1m702 | [0m[35m    return dict(sorted(columns.items()))[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m695 | [0m[35mdef _schema_format_columns(table_schema: dict[str, Any]) -> dict[str, str]:[0m
[30;1m696 | [0m[35m    """Return a sorted dictionary of column names and types."""[0m
[30;1m697 | [0m[35m    columns = {[0m
[30;1m698 | [0m[35m        col["name"]: col["type"] for col in table_schema.get("standardColumns", {})[0m
[30;1m699 | [0m[35m    }[0m
[30;1m700 | [0m[35m    for col in table_schema.get("customColumns", []):[0m
[30;1m701 | [0m[35m        columns[col["name"]] = col["type"][0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m        tables = response.json()[0m
[30;1m636 | [0m[35m        logger.info([0m
[30;1m637 | [0m[35m            "Schema retrieved from workspace. %d tables found.",[0m
[30;1m638 | [0m[35m            len(tables.get("value", 0)),[0m
[30;1m639 | [0m[35m        )[0m
[30;1m640 | [0m[35m        return _schema_format_tables(tables)[0m
[30;1m641 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m625 | [0m[35m            timeout=get_http_timeout(),[0m
[30;1m626 | [0m[35m            **httpx_proxy_kwargs,[0m
[30;1m627 | [0m[35m        ) as httpx_client:[0m
[30;1m628 | [0m[35m            response: httpx.Response = httpx_client.get([0m
[30;1m629 | [0m[35m                fmt_url,[0m
[30;1m630 | [0m[35m                headers=headers,[0m
[30;1m631 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m        if not self.schema:[0m
[30;1m547 | [0m[35m            return[0m
[30;1m548 | [0m[35m        try:[0m
[30;1m549 | [0m[35m            table = query_source.params.get("table", {}).get("default")[0m
[30;1m550 | [0m[35m        except KeyError:[0m
[30;1m551 | [0m[35m            table = None[0m
[30;1m552 | [0m[35m        if table:[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m        if not self.schema:[0m
[30;1m547 | [0m[35m            return[0m
[30;1m548 | [0m[35m        try:[0m
[30;1m549 | [0m[35m            table = query_source.params.get("table", {}).get("default")[0m
[30;1m550 | [0m[35m        except KeyError:[0m
[30;1m551 | [0m[35m            table = None[0m
[30;1m552 | [0m[35m        if table:[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m516 | [0m[35m        default_time_params = kwargs.get("default_time_params", False)[0m
[30;1m517 | [0m[35m        time_params = kwargs.get("time_span", {})[0m
[30;1m518 | [0m[35m        start = time_params.get("start")[0m
[30;1m519 | [0m[35m        end = time_params.get("end")[0m
[30;1m520 | [0m[35m        if default_time_params or (start is None or end is None):[0m
[30;1m521 | [0m[35m            time_span_value = None[0m
[30;1m522 | [0m[35m            logger.info("No time parameters supplied.")[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m515 | [0m[35m        """Return the timespan for the query API call."""[0m
[30;1m516 | [0m[35m        default_time_params = kwargs.get("default_time_params", False)[0m
[30;1m517 | [0m[35m        time_params = kwargs.get("time_span", {})[0m
[30;1m518 | [0m[35m        start = time_params.get("start")[0m
[30;1m519 | [0m[35m        end = time_params.get("end")[0m
[30;1m520 | [0m[35m        if default_time_params or (start is None or end is None):[0m
[30;1m521 | [0m[35m            time_span_value = None[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m514 | [0m[35m    def _get_time_span_value(self, **kwargs):[0m
[30;1m515 | [0m[35m        """Return the timespan for the query API call."""[0m
[30;1m516 | [0m[35m        default_time_params = kwargs.get("default_time_params", False)[0m
[30;1m517 | [0m[35m        time_params = kwargs.get("time_span", {})[0m
[30;1m518 | [0m[35m        start = time_params.get("start")[0m
[30;1m519 | [0m[35m        end = time_params.get("end")[0m
[30;1m520 | [0m[35m        if default_time_params or (start is None or end is None):[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    def _get_time_span_value(self, **kwargs):[0m
[30;1m515 | [0m[35m        """Return the timespan for the query API call."""[0m
[30;1m516 | [0m[35m        default_time_params = kwargs.get("default_time_params", False)[0m
[30;1m517 | [0m[35m        time_params = kwargs.get("time_span", {})[0m
[30;1m518 | [0m[35m        start = time_params.get("start")[0m
[30;1m519 | [0m[35m        end = time_params.get("end")[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m438 | [0m[35m            return[0m
[30;1m439 | [0m[35m[0m
[30;1m440 | [0m[35m        # standard - single-workspace configuration[0m
[30;1m441 | [0m[35m        workspace_name = kwargs.get("workspace")[0m
[30;1m442 | [0m[35m        ws_config: WorkspaceConfig | None = None[0m
[30;1m443 | [0m[35m        connection_str = connection_str or self._def_connection_str[0m
[30;1m444 | [0m[35m        if workspace_name or connection_str is None:[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m    def _get_workspaces(self, connection_str: str | None = None, **kwargs):[0m
[30;1m430 | [0m[35m        """Get workspace or workspaces to connect to."""[0m
[30;1m431 | [0m[35m        self._az_tenant_id = kwargs.get("tenant_id", kwargs.get("mp_az_tenant_id"))[0m
[30;1m432 | [0m[35m        # multiple workspace IDs[0m
[30;1m433 | [0m[35m        if workspaces := kwargs.pop("workspaces", None):[0m
[30;1m434 | [0m[35m            self._get_workspaces_by_name(workspaces)[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m    def _get_workspaces(self, connection_str: str | None = None, **kwargs):[0m
[30;1m430 | [0m[35m        """Get workspace or workspaces to connect to."""[0m
[30;1m431 | [0m[35m        self._az_tenant_id = kwargs.get("tenant_id", kwargs.get("mp_az_tenant_id"))[0m
[30;1m432 | [0m[35m        # multiple workspace IDs[0m
[30;1m433 | [0m[35m        if workspaces := kwargs.pop("workspaces", None):[0m
[30;1m434 | [0m[35m            self._get_workspaces_by_name(workspaces)[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m        if not self._ws_config or not self._ws_config.settings_path:[0m
[30;1m421 | [0m[35m            return {}[0m
[30;1m422 | [0m[35m        args_path = f"{self._ws_config.settings_path}.Args"[0m
[30;1m423 | [0m[35m        args_settings = self._ws_config.settings.get("Args", {})[0m
[30;1m424 | [0m[35m        return {[0m
[30;1m425 | [0m[35m            name: get_protected_setting(args_path, name)[0m
[30;1m426 | [0m[35m            for name in args_settings.keys()[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m412 | [0m[35m        return LogsQueryClient([0m
[30;1m413 | [0m[35m            credential=credentials.modern,[0m
[30;1m414 | [0m[35m            endpoint=self.url_endpoint,[0m
[30;1m415 | [0m[35m            proxies=kwargs.get("proxies", self._def_proxies),[0m
[30;1m416 | [0m[35m        )[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m    def _get_workspace_settings_args(self) -> dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m            "Created query client. Auth type: %s, Url: %s, Proxies: %s",[0m
[30;1m408 | [0m[35m            type(credentials.modern) if credentials else "None",[0m
[30;1m409 | [0m[35m            self.url_endpoint,[0m
[30;1m410 | [0m[35m            kwargs.get("proxies", self._def_proxies),[0m
[30;1m411 | [0m[35m        )[0m
[30;1m412 | [0m[35m        return LogsQueryClient([0m
[30;1m413 | [0m[35m            credential=credentials.modern,[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m    def _create_query_client(self, connection_str, **kwargs):[0m
[30;1m387 | [0m[35m        """Create the query client."""[0m
[30;1m388 | [0m[35m        az_auth_types = kwargs.pop("auth_types", kwargs.get("mp_az_auth"))[0m
[30;1m389 | [0m[35m        if isinstance(az_auth_types, bool):[0m
[30;1m390 | [0m[35m            az_auth_types = None[0m
[30;1m391 | [0m[35m        if isinstance(az_auth_types, str):[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m            )[0m
[30;1m331 | [0m[35m        time_span_value = self._get_time_span_value(**kwargs)[0m
[30;1m332 | [0m[35m        fail_on_partial = kwargs.get([0m
[30;1m333 | [0m[35m            "fail_if_partial", kwargs.get("fail_on_partial", self._fail_on_partial)[0m
[30;1m334 | [0m[35m        )[0m
[30;1m335 | [0m[35m        server_timeout = kwargs.pop("timeout", self._def_timeout)[0m
[30;1m336 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m                help_uri=_HELP_URL,[0m
[30;1m330 | [0m[35m            )[0m
[30;1m331 | [0m[35m        time_span_value = self._get_time_span_value(**kwargs)[0m
[30;1m332 | [0m[35m        fail_on_partial = kwargs.get([0m
[30;1m333 | [0m[35m            "fail_if_partial", kwargs.get("fail_on_partial", self._fail_on_partial)[0m
[30;1m334 | [0m[35m        )[0m
[30;1m335 | [0m[35m        server_timeout = kwargs.pop("timeout", self._def_timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m        self._connected = False[0m
[30;1m240 | [0m[35m        self._query_client = self._create_query_client(connection_str, **kwargs)[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m        self._fail_on_partial = kwargs.get("fail_on_partial", self._fail_on_partial)[0m
[30;1m243 | [0m[35m        # get the schema[0m
[30;1m244 | [0m[35m        if self._try_get_schema:[0m
[30;1m245 | [0m[35m            self._schema = self._get_schema()[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m        )[0m
[30;1m139 | [0m[35m        self.set_driver_property(DriverProps.SUPPORTS_THREADING, value=True)[0m
[30;1m140 | [0m[35m        self.set_driver_property([0m
[30;1m141 | [0m[35m            DriverProps.MAX_PARALLEL, value=kwargs.get("max_threads", 4)[0m
[30;1m142 | [0m[35m        )[0m
[30;1m143 | [0m[35m        self.az_cloud_config = AzureCloudConfig()[0m
[30;1m144 | [0m[35m        logger.info([0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m        self._def_connection_str: str | None = connection_str[0m
[30;1m130 | [0m[35m        self._connect_auth_types: list[str] | None = None[0m
[30;1m131 | [0m[35m        self._try_get_schema: bool = True[0m
[30;1m132 | [0m[35m        self._fail_on_partial: bool = kwargs.get("fail_on_partial", False)[0m
[30;1m133 | [0m[35m        self.add_query_filter([0m
[30;1m134 | [0m[35m            "data_environments", ("MSSentinel", "LogAnalytics", "AzureSentinel")[0m
[30;1m135 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m        self._def_timeout = kwargs.get([0m
[30;1m120 | [0m[35m            "timeout", kwargs.get("server_timeout", self._DEFAULT_TIMEOUT)[0m
[30;1m121 | [0m[35m        )[0m
[30;1m122 | [0m[35m        self._def_proxies = kwargs.get("proxies", get_http_proxies())[0m
[30;1m123 | [0m[35m        self._query_client: LogsQueryClient | None = None[0m
[30;1m124 | [0m[35m        self._az_tenant_id: str | None = None[0m
[30;1m125 | [0m[35m        self._ws_config: WorkspaceConfig | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m        self._loaded = True[0m
[30;1m118 | [0m[35m        self._ua_policy = UserAgentPolicy(user_agent=mp_ua_header()["UserAgent"])[0m
[30;1m119 | [0m[35m        self._def_timeout = kwargs.get([0m
[30;1m120 | [0m[35m            "timeout", kwargs.get("server_timeout", self._DEFAULT_TIMEOUT)[0m
[30;1m121 | [0m[35m        )[0m
[30;1m122 | [0m[35m        self._def_proxies = kwargs.get("proxies", get_http_proxies())[0m
[30;1m123 | [0m[35m        self._query_client: LogsQueryClient | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        )[0m
[30;1m117 | [0m[35m        self._loaded = True[0m
[30;1m118 | [0m[35m        self._ua_policy = UserAgentPolicy(user_agent=mp_ua_header()["UserAgent"])[0m
[30;1m119 | [0m[35m        self._def_timeout = kwargs.get([0m
[30;1m120 | [0m[35m            "timeout", kwargs.get("server_timeout", self._DEFAULT_TIMEOUT)[0m
[30;1m121 | [0m[35m        )[0m
[30;1m122 | [0m[35m        self._def_proxies = kwargs.get("proxies", get_http_proxies())[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m            (can be overridden in connect method)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        """[0m
[30;1m108 | [0m[35m        if kwargs.get("debug", False):[0m
[30;1m109 | [0m[35m            logger.setLevel(logging.DEBUG)[0m
[30;1m110 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m519 | [0m[35m        end = time_params.get("end")[0m
[30;1m520 | [0m[35m        if default_time_params or (start is None or end is None):[0m
[30;1m521 | [0m[35m            time_span_value = None[0m
[30;1m522 | [0m[35m            logger.info("No time parameters supplied.")[0m
[30;1m523 | [0m[35m        else:[0m
[30;1m524 | [0m[35m            time_span = TimeSpan([0m
[30;1m525 | [0m[35m                start=time_params["start"],[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m        Other Parameters[0m
[30;1m280 | [0m[35m        ----------------[0m
[30;1m281 | [0m[35m        timeout : int (seconds)[0m
[30;1m282 | [0m[35m            Specify a timeout for the query. Default is 300 seconds.[0m
[30;1m283 | [0m[35m        fail_on_partial: bool[0m
[30;1m284 | [0m[35m            Fail the query if only partial results are returned.[0m
[30;1m285 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m        Other Parameters[0m
[30;1m280 | [0m[35m        ----------------[0m
[30;1m281 | [0m[35m        timeout : int (seconds)[0m
[30;1m282 | [0m[35m            Specify a timeout for the query. Default is 300 seconds.[0m
[30;1m283 | [0m[35m        fail_on_partial: bool[0m
[30;1m284 | [0m[35m            Fail the query if only partial results are returned.[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m            List of workspace IDs to run the queries against. Must be supplied[0m
[30;1m216 | [0m[35m            along with a `tenant_id`.[0m
[30;1m217 | [0m[35m        timeout : int (seconds)[0m
[30;1m218 | [0m[35m            Specify a timeout for queries. Default is 300 seconds.[0m
[30;1m219 | [0m[35m            (can be overridden query method)[0m
[30;1m220 | [0m[35m        proxies : dict[str, str][0m
[30;1m221 | [0m[35m            Proxy settings for log analytics queries.[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35m        workspace_ids: Iterable[str], optional[0m
[30;1m215 | [0m[35m            List of workspace IDs to run the queries against. Must be supplied[0m
[30;1m216 | [0m[35m            along with a `tenant_id`.[0m
[30;1m217 | [0m[35m        timeout : int (seconds)[0m
[30;1m218 | [0m[35m            Specify a timeout for queries. Default is 300 seconds.[0m
[30;1m219 | [0m[35m            (can be overridden query method)[0m
[30;1m220 | [0m[35m        proxies : dict[str, str][0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m        debug : bool[0m
[30;1m93 | [0m[35m            print out additional diagnostic information.[0m
[30;1m94 | [0m[35m        timeout : int (seconds)[0m
[30;1m95 | [0m[35m            Specify a timeout for queries. Default is 300 seconds.[0m
[30;1m96 | [0m[35m            (can be set here or in connect and overridden in query methods)[0m
[30;1m97 | [0m[35m        proxies : dict[str, str][0m
[30;1m98 | [0m[35m            Proxy settings for log analytics queries.[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_monitor_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m        ----------------[0m
[30;1m92 | [0m[35m        debug : bool[0m
[30;1m93 | [0m[35m            print out additional diagnostic information.[0m
[30;1m94 | [0m[35m        timeout : int (seconds)[0m
[30;1m95 | [0m[35m            Specify a timeout for queries. Default is 300 seconds.[0m
[30;1m96 | [0m[35m            (can be set here or in connect and overridden in query methods)[0m
[30;1m97 | [0m[35m        proxies : dict[str, str][0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m507 | [0m[35m    next(e_ranges, None)  # skip to the next item in the 2nd iterable[0m
[30;1m508 | [0m[35m    # Zip them together to get a list of (start, end) tuples of ranges[0m
[30;1m509 | [0m[35m    # Note: we subtract 1 nanosecond from the 'end' value of each range so[0m
[30;1m510 | [0m[35m    # to avoid getting duplicated records at the boundaries of the ranges.[0m
[30;1m511 | [0m[35m    # Some providers don't have nanosecond granularity so we might[0m
[30;1m512 | [0m[35m    # get duplicates in these cases[0m
[30;1m513 | [0m[35m    ranges: list[tuple[datetime, datetime]] = [[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m519 | [0m[35m    # we need to adjust the end time on the final range.[0m
[30;1m520 | [0m[35m    # If the difference between the calculated last range end and[0m
[30;1m521 | [0m[35m    # the query 'end' that the user requested is small (< 0.1% of a delta),[0m
[30;1m522 | [0m[35m    # we just replace the last "end" time with our query end time.[0m
[30;1m523 | [0m[35m    if (end - ranges[-1][1]) < (split_delta / 1000):[0m
[30;1m524 | [0m[35m        ranges[-1] = ranges[-1][0], pd.Timestamp(end)[0m
[30;1m525 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m516 | [0m[35m    ][0m
[30;1m517 | [0m[35m[0m
[30;1m518 | [0m[35m    # Since the generated time ranges are based on deltas from 'start'[0m
[30;1m519 | [0m[35m    # we need to adjust the end time on the final range.[0m
[30;1m520 | [0m[35m    # If the difference between the calculated last range end and[0m
[30;1m521 | [0m[35m    # the query 'end' that the user requested is small (< 0.1% of a delta),[0m
[30;1m522 | [0m[35m    # we just replace the last "end" time with our query end time.[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m515 | [0m[35m        for s_time, e_time in zip(s_ranges, e_ranges)[0m
[30;1m516 | [0m[35m    ][0m
[30;1m517 | [0m[35m[0m
[30;1m518 | [0m[35m    # Since the generated time ranges are based on deltas from 'start'[0m
[30;1m519 | [0m[35m    # we need to adjust the end time on the final range.[0m
[30;1m520 | [0m[35m    # If the difference between the calculated last range end and[0m
[30;1m521 | [0m[35m    # the query 'end' that the user requested is small (< 0.1% of a delta),[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m501 | [0m[35m    end: datetime,[0m
[30;1m502 | [0m[35m    split_delta: pd.Timedelta,[0m
[30;1m503 | [0m[35m) -> list[tuple[datetime, datetime]]:[0m
[30;1m504 | [0m[35m    """Return a list of time ranges split by `split_delta`."""[0m
[30;1m505 | [0m[35m    # Use pandas date_range and split the result into 2 iterables[0m
[30;1m506 | [0m[35m    s_ranges, e_ranges = tee(pd.date_range(start, end, freq=split_delta))[0m
[30;1m507 | [0m[35m    next(e_ranges, None)  # skip to the next item in the 2nd iterable[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m460 | [0m[35m                    # A new task should be queued[0m
[30;1m461 | [0m[35m                    failed_tasks_ids.append(query_id)[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m        # Sort the results by the order of the tasks[0m
[30;1m464 | [0m[35m        results = [result for _, result in sorted(zip(thread_tasks, results))][0m
[30;1m465 | [0m[35m[0m
[30;1m466 | [0m[35m        if retry and failed_tasks_ids:[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m388 | [0m[35m        end: datetime,[0m
[30;1m389 | [0m[35m        split_by: str,[0m
[30;1m390 | [0m[35m    ) -> dict[tuple[datetime, datetime], str]:[0m
[30;1m391 | [0m[35m        """Return separate queries for split time ranges."""[0m
[30;1m392 | [0m[35m        try:[0m
[30;1m393 | [0m[35m            if split_by.strip().endswith("H"):[0m
[30;1m394 | [0m[35m                split_by = split_by.replace("H", "h")[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m        Parameters[0m
[30;1m253 | [0m[35m        ----------[0m
[30;1m254 | [0m[35m        split_by : str[0m
[30;1m255 | [0m[35m            The time interval to split the query by.[0m
[30;1m256 | [0m[35m        query_source : QuerySource[0m
[30;1m257 | [0m[35m            The query to execute.[0m
[30;1m258 | [0m[35m        query_params : dict[str, Any][0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_connections_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mfrom abc import abstractmethod[0m
[30;1m12 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m13 | [0m[35mfrom functools import partial[0m
[30;1m14 | [0m[35mfrom itertools import tee[0m
[30;1m15 | [0m[35mfrom typing import TYPE_CHECKING, Any, Protocol[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mimport nest_asyncio[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/storage/azure_blob_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m            expiry=end,[0m
[30;1m253 | [0m[35m            start=start,[0m
[30;1m254 | [0m[35m        )[0m
[30;1m255 | [0m[35m        suffix = AzureCloudConfig().suffixes.get("storage")[0m
[30;1m256 | [0m[35m        return f"https://{abs_name}.blob.{suffix}/{container_name}/{blob_name}?{sast}"[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m        kusto_settings[cluster.casefold()] = {[0m
[30;1m289 | [0m[35m            "tenant_id": settings.args.get("TenantId"),  # type: ignore[0m
[30;1m290 | [0m[35m            "integrated_auth": settings.args.get("IntegratedAuth"),  # type: ignore[0m
[30;1m291 | [0m[35m            "client_id": settings.args.get("ClientId"),  # type: ignore[0m
[30;1m292 | [0m[35m            "args": settings.args,[0m
[30;1m293 | [0m[35m            "cluster": cluster,[0m
[30;1m294 | [0m[35m            "alias": instance,[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m            )[0m
[30;1m288 | [0m[35m        kusto_settings[cluster.casefold()] = {[0m
[30;1m289 | [0m[35m            "tenant_id": settings.args.get("TenantId"),  # type: ignore[0m
[30;1m290 | [0m[35m            "integrated_auth": settings.args.get("IntegratedAuth"),  # type: ignore[0m
[30;1m291 | [0m[35m            "client_id": settings.args.get("ClientId"),  # type: ignore[0m
[30;1m292 | [0m[35m            "args": settings.args,[0m
[30;1m293 | [0m[35m            "cluster": cluster,[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m                title=f"No Cluster value for {prov_name}",[0m
[30;1m287 | [0m[35m            )[0m
[30;1m288 | [0m[35m        kusto_settings[cluster.casefold()] = {[0m
[30;1m289 | [0m[35m            "tenant_id": settings.args.get("TenantId"),  # type: ignore[0m
[30;1m290 | [0m[35m            "integrated_auth": settings.args.get("IntegratedAuth"),  # type: ignore[0m
[30;1m291 | [0m[35m            "client_id": settings.args.get("ClientId"),  # type: ignore[0m
[30;1m292 | [0m[35m            "args": settings.args,[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m        if "-" in prov_name:[0m
[30;1m279 | [0m[35m            _, instance = prov_name.split("-", maxsplit=1)[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m        cluster = settings.args.get("Cluster")[0m
[30;1m282 | [0m[35m        if not cluster:[0m
[30;1m283 | [0m[35m            raise MsticpyUserConfigError([0m
[30;1m284 | [0m[35m                "Mandatory 'Cluster' setting is missing in msticpyconfig.",[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m                if ([0m
[30;1m256 | [0m[35m                    cluster_key.startswith(f"https://{cluster.casefold()}.")[0m
[30;1m257 | [0m[35m                    or ([0m
[30;1m258 | [0m[35m                        kusto_config.get("alias", "").casefold()  # type: ignore[0m
[30;1m259 | [0m[35m                        == cluster.casefold()[0m
[30;1m260 | [0m[35m                    )[0m
[30;1m261 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m        else:[0m
[30;1m241 | [0m[35m            # Note, we don't add the secret until required at runtime to prevent[0m
[30;1m242 | [0m[35m            # it hanging around in memory as much as possible.[0m
[30;1m243 | [0m[35m            fmt_items["clientsecret"] = fmt_items["args"].get("ClientSecret")  # type: ignore[0m
[30;1m244 | [0m[35m            auth_string = _KCS_APP.format(**fmt_items)[0m
[30;1m245 | [0m[35m        return _KCS_TEMPLATE.format(auth=auth_string, **fmt_items)[0m
[30;1m246 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m        if not fmt_items:[0m
[30;1m236 | [0m[35m            return None[0m
[30;1m237 | [0m[35m        fmt_items["database"] = database[0m
[30;1m238 | [0m[35m        if fmt_items.get("integrated_auth"):[0m
[30;1m239 | [0m[35m            auth_string = _KCS_CODE[0m
[30;1m240 | [0m[35m        else:[0m
[30;1m241 | [0m[35m            # Note, we don't add the secret until required at runtime to prevent[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    def _format_connection_str(self, cluster: str, database: str) -> Optional[str]:[0m
[30;1m233 | [0m[35m        """Return connection string with client secret added."""[0m
[30;1m234 | [0m[35m        fmt_items = self._kusto_settings.get(cluster.casefold())[0m
[30;1m235 | [0m[35m        if not fmt_items:[0m
[30;1m236 | [0m[35m            return None[0m
[30;1m237 | [0m[35m        fmt_items["database"] = database[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m        return new_connection[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    def _get_db_from_datafamily(self, query_source, cluster, database):[0m
[30;1m177 | [0m[35m        data_families = query_source.metadata.get("data_families")[0m
[30;1m178 | [0m[35m        if ([0m
[30;1m179 | [0m[35m            not isinstance(data_families, list) or len(data_families) == 0[0m
[30;1m180 | [0m[35m        ) and not self.current_connection:[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m            cluster = cluster or query_source.metadata.get("cluster")[0m
[30;1m167 | [0m[35m            database = ([0m
[30;1m168 | [0m[35m                database[0m
[30;1m169 | [0m[35m                or query_source.metadata.get("database")[0m
[30;1m170 | [0m[35m                or self._get_db_from_datafamily(query_source, cluster, database)[0m
[30;1m171 | [0m[35m            )[0m
[30;1m172 | [0m[35m            new_connection = self._create_connection(cluster=cluster, database=database)[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m                self._cluster_uri = cluster[0m
[30;1m164 | [0m[35m        if not new_connection and query_source:[0m
[30;1m165 | [0m[35m            # try to get cluster and db from query_source metadata[0m
[30;1m166 | [0m[35m            cluster = cluster or query_source.metadata.get("cluster")[0m
[30;1m167 | [0m[35m            database = ([0m
[30;1m168 | [0m[35m                database[0m
[30;1m169 | [0m[35m                or query_source.metadata.get("database")[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m        database = kwargs.get("database")[0m
[30;1m156 | [0m[35m        if not new_connection:[0m
[30;1m157 | [0m[35m            # try to get cluster and db from kwargs or query_source metadata[0m
[30;1m158 | [0m[35m            cluster = self._lookup_cluster(kwargs.get("cluster", "Kusto"))[0m
[30;1m159 | [0m[35m            if cluster and database:[0m
[30;1m160 | [0m[35m                new_connection = self._create_connection([0m
[30;1m161 | [0m[35m                    cluster=cluster, database=database[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        # If the connection string is supplied as a parameter, use that[0m
[30;1m153 | [0m[35m        cluster = None[0m
[30;1m154 | [0m[35m        new_connection = kwargs.get("connection_str")[0m
[30;1m155 | [0m[35m        database = kwargs.get("database")[0m
[30;1m156 | [0m[35m        if not new_connection:[0m
[30;1m157 | [0m[35m            # try to get cluster and db from kwargs or query_source metadata[0m
[30;1m158 | [0m[35m            cluster = self._lookup_cluster(kwargs.get("cluster", "Kusto"))[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m        """Create a connection string from arguments and configuration."""[0m
[30;1m152 | [0m[35m        # If the connection string is supplied as a parameter, use that[0m
[30;1m153 | [0m[35m        cluster = None[0m
[30;1m154 | [0m[35m        new_connection = kwargs.get("connection_str")[0m
[30;1m155 | [0m[35m        database = kwargs.get("database")[0m
[30;1m156 | [0m[35m        if not new_connection:[0m
[30;1m157 | [0m[35m            # try to get cluster and db from kwargs or query_source metadata[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m        if ([0m
[30;1m92 | [0m[35m            self._cluster_uri[0m
[30;1m93 | [0m[35m        ):  # This should be set by _get_connection_string called above[0m
[30;1m94 | [0m[35m            cluster_settings = self._kusto_settings.get(self._cluster_uri.casefold())[0m
[30;1m95 | [0m[35m            if cluster_settings:[0m
[30;1m96 | [0m[35m                if mp_az_auth is None and cluster_settings["integrated_auth"]:[0m
[30;1m97 | [0m[35m                    mp_az_auth = "default"[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        """[0m
[30;1m47 | [0m[35m        super().__init__(connection_str=connection_str, **kwargs)[0m
[30;1m48 | [0m[35m        self.environment = kwargs.get("data_environment", DataEnvironment.Kusto)[0m
[30;1m49 | [0m[35m        self.set_driver_property(DriverProps.EFFECTIVE_ENV, DataEnvironment.Kusto.name)[0m
[30;1m50 | [0m[35m        self._connected = True[0m
[30;1m51 | [0m[35m        self._kusto_settings: KustoClusterSettings = _get_kusto_settings()[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m238 | [0m[35m        if fmt_items.get("integrated_auth"):[0m
[30;1m239 | [0m[35m            auth_string = _KCS_CODE[0m
[30;1m240 | [0m[35m        else:[0m
[30;1m241 | [0m[35m            # Note, we don't add the secret until required at runtime to prevent[0m
[30;1m242 | [0m[35m            # it hanging around in memory as much as possible.[0m
[30;1m243 | [0m[35m            fmt_items["clientsecret"] = fmt_items["args"].get("ClientSecret")  # type: ignore[0m
[30;1m244 | [0m[35m            auth_string = _KCS_APP.format(**fmt_items)[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kusto_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m198 | [0m[35m                err_mssg = "cluster uri and database name"[0m
[30;1m199 | [0m[35m            raise MsticpyParameterError([0m
[30;1m200 | [0m[35m                f"Could not determine the {err_mssg} for the query.",[0m
[30;1m201 | [0m[35m                "Please update the query with the correct values or specify",[0m
[30;1m202 | [0m[35m                "explicitly with the 'cluster' and 'database' parameters to",[0m
[30;1m203 | [0m[35m                "this function.",[0m
[30;1m204 | [0m[35m                "In the query template these values are specified in the metadata:",[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mdatp_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m                connection_str,[0m
[30;1m132 | [0m[35m                delegated_auth=delegated_auth,[0m
[30;1m133 | [0m[35m                auth_type=auth_type,[0m
[30;1m134 | [0m[35m                location=cs_dict.get("location", "token_cache.bin"),[0m
[30;1m135 | [0m[35m            )[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m    def query([0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m471 | [0m[35m) -> dict[str, str]:[0m
[30;1m472 | [0m[35m    """Try to retrieve config settings for OAuth drivers."""[0m
[30;1m473 | [0m[35m    config_key: str = f"{config_name}-{instance}" if instance else config_name[0m
[30;1m474 | [0m[35m    drv_config: ProviderSettings | None = get_provider_settings("DataProviders").get([0m
[30;1m475 | [0m[35m        config_key,[0m
[30;1m476 | [0m[35m    )[0m
[30;1m477 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m            return None, {"response": json_response}[0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35m        results_key: str = "Results" if "Results" in json_response else "results"[0m
[30;1m376 | [0m[35m        result: dict[str, Any] = json_response.get(results_key, json_response)[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m        if not result:[0m
[30;1m379 | [0m[35m            LOGGER.warning("Query did not return any results.")[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m        else:[0m
[30;1m358 | [0m[35m            # self.request_uri set if self.connected[0m
[30;1m359 | [0m[35m            req_url = f"{self.request_uri}{query}"[0m
[30;1m360 | [0m[35m            response = httpx.get([0m
[30;1m361 | [0m[35m                url=req_url,[0m
[30;1m362 | [0m[35m                headers=self.req_headers,[0m
[30;1m363 | [0m[35m                timeout=self.get_http_timeout(**kwargs),[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m        if kwargs["body"] is True:[0m
[30;1m349 | [0m[35m            req_url: str = f"{self.request_uri}{kwargs['api_end']}"[0m
[30;1m350 | [0m[35m            req_url = urllib.parse.quote(req_url, safe="%/:=&?~#+!$,;'@()*[]")[0m
[30;1m351 | [0m[35m            response: httpx.Response = httpx.post([0m
[30;1m352 | [0m[35m                url=req_url,[0m
[30;1m353 | [0m[35m                headers=self.req_headers,[0m
[30;1m354 | [0m[35m                json={"Query": query},[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m            username=cs_dict["username"],[0m
[30;1m308 | [0m[35m            scopes=self.scopes,[0m
[30;1m309 | [0m[35m            auth_type=kwargs.get("auth_type", "device"),[0m
[30;1m310 | [0m[35m            location=cs_dict.get("location", "token_cache.bin"),[0m
[30;1m311 | [0m[35m            connect=True,[0m
[30;1m312 | [0m[35m        )[0m
[30;1m313 | [0m[35m        self.aad_token = self.msal_auth.token[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m306 | [0m[35m            authority=authority,[0m
[30;1m307 | [0m[35m            username=cs_dict["username"],[0m
[30;1m308 | [0m[35m            scopes=self.scopes,[0m
[30;1m309 | [0m[35m            auth_type=kwargs.get("auth_type", "device"),[0m
[30;1m310 | [0m[35m            location=cs_dict.get("location", "token_cache.bin"),[0m
[30;1m311 | [0m[35m            connect=True,[0m
[30;1m312 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m            headers=mp_ua_header(),[0m
[30;1m280 | [0m[35m        )[0m
[30;1m281 | [0m[35m        json_response: dict[str, Any] = response.json()[0m
[30;1m282 | [0m[35m        self.aad_token = json_response.get("access_token")[0m
[30;1m283 | [0m[35m        if not self.aad_token:[0m
[30;1m284 | [0m[35m            err_msg = ([0m
[30;1m285 | [0m[35m                f"Could not obtain access token - {json_response['error_description']}"[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m        # Authenticate and obtain AAD Token for future calls[0m
[30;1m274 | [0m[35m        data: bytes = urllib.parse.urlencode(req_body).encode("utf-8")[0m
[30;1m275 | [0m[35m        response: httpx.Response = httpx.post([0m
[30;1m276 | [0m[35m            url=req_url,[0m
[30;1m277 | [0m[35m            content=data,[0m
[30;1m278 | [0m[35m            timeout=self.get_http_timeout(**kwargs),[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m        if not result or "access_token" not in result:[0m
[30;1m253 | [0m[35m            err_msg = "Could not obtain access token"[0m
[30;1m254 | [0m[35m            raise MsticpyConnectionError(err_msg)[0m
[30;1m255 | [0m[35m        self.aad_token = result.get("access_token", None)[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m    def _get_token_standard_auth([0m
[30;1m258 | [0m[35m        self: Self,[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        if not self.api_root:[0m
[30;1m209 | [0m[35m            err_msg = f"Sub class {self.__class__.__name__} did not set self.api_root"[0m
[30;1m210 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m211 | [0m[35m        api_ver: str | None = cs_dict.get("apiVersion", self.api_ver)[0m
[30;1m212 | [0m[35m        self.request_uri = self.api_root + str(api_ver)[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        print("Connected.")[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m            self._get_token_standard_auth(kwargs, cs_dict)[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m        self.req_headers["Authorization"] = f"Bearer {self.aad_token}"[0m
[30;1m207 | [0m[35m        self.api_root = cs_dict.get("apiRoot", self.api_root)[0m
[30;1m208 | [0m[35m        if not self.api_root:[0m
[30;1m209 | [0m[35m            err_msg = f"Sub class {self.__class__.__name__} did not set self.api_root"[0m
[30;1m210 | [0m[35m            raise ValueError(err_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/odata_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m        Parameters[0m
[30;1m65 | [0m[35m        ----------[0m
[30;1m66 | [0m[35m        connect: bool, optional[0m
[30;1m67 | [0m[35m            Set true if you want to connect to the provider at initialization[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        """[0m
[30;1m70 | [0m[35m        super().__init__(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2468 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2469 | [0m[35m		"event_id": 6406,[0m
[30;1m2470 | [0m[35m		"description": "%1 registered to Windows Firewall to control filtering for the following: %2",[0m
[30;1m2471 | [0m[35m		"full_desc": "6406: %1 registered to Windows Firewall to control filtering for the following: %2"[0m
[30;1m2472 | [0m[35m	},[0m
[30;1m2473 | [0m[35m	{[0m
[30;1m2474 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2467 | [0m[35m		"category": "System",[0m
[30;1m2468 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2469 | [0m[35m		"event_id": 6406,[0m
[30;1m2470 | [0m[35m		"description": "%1 registered to Windows Firewall to control filtering for the following: %2",[0m
[30;1m2471 | [0m[35m		"full_desc": "6406: %1 registered to Windows Firewall to control filtering for the following: %2"[0m
[30;1m2472 | [0m[35m	},[0m
[30;1m2473 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2328 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2329 | [0m[35m		"event_id": 5484,[0m
[30;1m2330 | [0m[35m		"description": "The IPsec Policy Agent service experienced a critical failure and has shut down. T[0m
[30;1m2331 | [0m[35m		"full_desc": "5484: The IPsec Policy Agent service experienced a critical failure and has shut dow[0m
[30;1m2332 | [0m[35m	},[0m
[30;1m2333 | [0m[35m	{[0m
[30;1m2334 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2327 | [0m[35m		"category": "System",[0m
[30;1m2328 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2329 | [0m[35m		"event_id": 5484,[0m
[30;1m2330 | [0m[35m		"description": "The IPsec Policy Agent service experienced a critical failure and has shut down. T[0m
[30;1m2331 | [0m[35m		"full_desc": "5484: The IPsec Policy Agent service experienced a critical failure and has shut dow[0m
[30;1m2332 | [0m[35m	},[0m
[30;1m2333 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2307 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2308 | [0m[35m		"event_id": 5479,[0m
[30;1m2309 | [0m[35m		"description": "IPsec Services has been shut down successfully. The shutdown of IPsec Services can[0m
[30;1m2310 | [0m[35m		"full_desc": "5479: IPsec Services has been shut down successfully. The shutdown of IPsec Services[0m
[30;1m2311 | [0m[35m	},[0m
[30;1m2312 | [0m[35m	{[0m
[30;1m2313 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2306 | [0m[35m		"category": "System",[0m
[30;1m2307 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2308 | [0m[35m		"event_id": 5479,[0m
[30;1m2309 | [0m[35m		"description": "IPsec Services has been shut down successfully. The shutdown of IPsec Services can[0m
[30;1m2310 | [0m[35m		"full_desc": "5479: IPsec Services has been shut down successfully. The shutdown of IPsec Services[0m
[30;1m2311 | [0m[35m	},[0m
[30;1m2312 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1978 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1979 | [0m[35m		"event_id": 5465,[0m
[30;1m1980 | [0m[35m		"description": "IPsec Policy Agent received a control for forced reloading of IPsec policy and pro[0m
[30;1m1981 | [0m[35m		"full_desc": "5465: IPsec Policy Agent received a control for forced reloading of IPsec policy and[0m
[30;1m1982 | [0m[35m	},[0m
[30;1m1983 | [0m[35m	{[0m
[30;1m1984 | [0m[35m		"category": "Policy Change",[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1978 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1979 | [0m[35m		"event_id": 5465,[0m
[30;1m1980 | [0m[35m		"description": "IPsec Policy Agent received a control for forced reloading of IPsec policy and pro[0m
[30;1m1981 | [0m[35m		"full_desc": "5465: IPsec Policy Agent received a control for forced reloading of IPsec policy and[0m
[30;1m1982 | [0m[35m	},[0m
[30;1m1983 | [0m[35m	{[0m
[30;1m1984 | [0m[35m		"category": "Policy Change",[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1977 | [0m[35m		"category": "Policy Change",[0m
[30;1m1978 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1979 | [0m[35m		"event_id": 5465,[0m
[30;1m1980 | [0m[35m		"description": "IPsec Policy Agent received a control for forced reloading of IPsec policy and pro[0m
[30;1m1981 | [0m[35m		"full_desc": "5465: IPsec Policy Agent received a control for forced reloading of IPsec policy and[0m
[30;1m1982 | [0m[35m	},[0m
[30;1m1983 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1977 | [0m[35m		"category": "Policy Change",[0m
[30;1m1978 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1979 | [0m[35m		"event_id": 5465,[0m
[30;1m1980 | [0m[35m		"description": "IPsec Policy Agent received a control for forced reloading of IPsec policy and pro[0m
[30;1m1981 | [0m[35m		"full_desc": "5465: IPsec Policy Agent received a control for forced reloading of IPsec policy and[0m
[30;1m1982 | [0m[35m	},[0m
[30;1m1983 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2531 | [0m[35m		"subcategory": "Security System Extension",[0m
[30;1m2532 | [0m[35m		"event_id": 4697,[0m
[30;1m2533 | [0m[35m		"description": "A service was installed in the system. ",[0m
[30;1m2534 | [0m[35m		"full_desc": "4697: A service was installed in the system. "[0m
[30;1m2535 | [0m[35m	},[0m
[30;1m2536 | [0m[35m	{[0m
[30;1m2537 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2530 | [0m[35m		"category": "System",[0m
[30;1m2531 | [0m[35m		"subcategory": "Security System Extension",[0m
[30;1m2532 | [0m[35m		"event_id": 4697,[0m
[30;1m2533 | [0m[35m		"description": "A service was installed in the system. ",[0m
[30;1m2534 | [0m[35m		"full_desc": "4697: A service was installed in the system. "[0m
[30;1m2535 | [0m[35m	},[0m
[30;1m2536 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2489 | [0m[35m		"subcategory": "Security State Change",[0m
[30;1m2490 | [0m[35m		"event_id": 4616,[0m
[30;1m2491 | [0m[35m		"description": "The system time was changed. ",[0m
[30;1m2492 | [0m[35m		"full_desc": "4616: The system time was changed. "[0m
[30;1m2493 | [0m[35m	},[0m
[30;1m2494 | [0m[35m	{[0m
[30;1m2495 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2488 | [0m[35m		"category": "System",[0m
[30;1m2489 | [0m[35m		"subcategory": "Security State Change",[0m
[30;1m2490 | [0m[35m		"event_id": 4616,[0m
[30;1m2491 | [0m[35m		"description": "The system time was changed. ",[0m
[30;1m2492 | [0m[35m		"full_desc": "4616: The system time was changed. "[0m
[30;1m2493 | [0m[35m	},[0m
[30;1m2494 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2377 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2378 | [0m[35m		"event_id": 5030,[0m
[30;1m2379 | [0m[35m		"description": "The Windows Firewall service failed to start.",[0m
[30;1m2380 | [0m[35m		"full_desc": "5030: The Windows Firewall service failed to start."[0m
[30;1m2381 | [0m[35m	},[0m
[30;1m2382 | [0m[35m	{[0m
[30;1m2383 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2376 | [0m[35m		"category": "System",[0m
[30;1m2377 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2378 | [0m[35m		"event_id": 5030,[0m
[30;1m2379 | [0m[35m		"description": "The Windows Firewall service failed to start.",[0m
[30;1m2380 | [0m[35m		"full_desc": "5030: The Windows Firewall service failed to start."[0m
[30;1m2381 | [0m[35m	},[0m
[30;1m2382 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2370 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2371 | [0m[35m		"event_id": 5029,[0m
[30;1m2372 | [0m[35m		"description": "The Windows Firewall service failed to initialize the driver. Windows Firewall wil[0m
[30;1m2373 | [0m[35m		"full_desc": "5029: The Windows Firewall service failed to initialize the driver. Windows Firewall[0m
[30;1m2374 | [0m[35m	},[0m
[30;1m2375 | [0m[35m	{[0m
[30;1m2376 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2369 | [0m[35m		"category": "System",[0m
[30;1m2370 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2371 | [0m[35m		"event_id": 5029,[0m
[30;1m2372 | [0m[35m		"description": "The Windows Firewall service failed to initialize the driver. Windows Firewall wil[0m
[30;1m2373 | [0m[35m		"full_desc": "5029: The Windows Firewall service failed to initialize the driver. Windows Firewall[0m
[30;1m2374 | [0m[35m	},[0m
[30;1m2375 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2356 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2357 | [0m[35m		"event_id": 5027,[0m
[30;1m2358 | [0m[35m		"description": "The Windows Firewall service was unable to retrieve the security policy from the l[0m
[30;1m2359 | [0m[35m		"full_desc": "5027: The Windows Firewall service was unable to retrieve the security policy from t[0m
[30;1m2360 | [0m[35m	},[0m
[30;1m2361 | [0m[35m	{[0m
[30;1m2362 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2355 | [0m[35m		"category": "System",[0m
[30;1m2356 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2357 | [0m[35m		"event_id": 5027,[0m
[30;1m2358 | [0m[35m		"description": "The Windows Firewall service was unable to retrieve the security policy from the l[0m
[30;1m2359 | [0m[35m		"full_desc": "5027: The Windows Firewall service was unable to retrieve the security policy from t[0m
[30;1m2360 | [0m[35m	},[0m
[30;1m2361 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2349 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2350 | [0m[35m		"event_id": 5025,[0m
[30;1m2351 | [0m[35m		"description": "The Windows Firewall service was stopped.",[0m
[30;1m2352 | [0m[35m		"full_desc": "5025: The Windows Firewall service was stopped."[0m
[30;1m2353 | [0m[35m	},[0m
[30;1m2354 | [0m[35m	{[0m
[30;1m2355 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2348 | [0m[35m		"category": "System",[0m
[30;1m2349 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2350 | [0m[35m		"event_id": 5025,[0m
[30;1m2351 | [0m[35m		"description": "The Windows Firewall service was stopped.",[0m
[30;1m2352 | [0m[35m		"full_desc": "5025: The Windows Firewall service was stopped."[0m
[30;1m2353 | [0m[35m	},[0m
[30;1m2354 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2342 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2343 | [0m[35m		"event_id": 5024,[0m
[30;1m2344 | [0m[35m		"description": "The Windows Firewall service started successfully.",[0m
[30;1m2345 | [0m[35m		"full_desc": "5024: The Windows Firewall service started successfully."[0m
[30;1m2346 | [0m[35m	},[0m
[30;1m2347 | [0m[35m	{[0m
[30;1m2348 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2341 | [0m[35m		"category": "System",[0m
[30;1m2342 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2343 | [0m[35m		"event_id": 5024,[0m
[30;1m2344 | [0m[35m		"description": "The Windows Firewall service started successfully.",[0m
[30;1m2345 | [0m[35m		"full_desc": "5024: The Windows Firewall service started successfully."[0m
[30;1m2346 | [0m[35m	},[0m
[30;1m2347 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2337 | [0m[35miagnose the problem.",[0m
[30;1m2338 | [0m[35m		"full_desc": "5485: IPsec Policy Agent failed to process some IPsec filters on a plug-and-play eve[0m
[30;1m2339 | [0m[35m	},[0m
[30;1m2340 | [0m[35m	{[0m
[30;1m2341 | [0m[35m		"category": "System",[0m
[30;1m2342 | [0m[35m		"subcategory": "Other System Events",[0m
[30;1m2343 | [0m[35m		"event_id": 5024,[0m
[30;1m2344 | [0m[35m		"description": "The Windows Firewall service started successfully.",[0m
[30;1m2345 | [0m[35m		"full_desc": "5024: The Windows Firewall service started successfully."[0m
[30;1m2346 | [0m[35m	},[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2335 | [0m[35mver",[0m
[30;1m2336 | [0m[35m		"event_id": 5485,[0m
[30;1m2337 | [0m[35m		"description": "IPsec Policy Agent failed to process some IPsec filters on a plug-and-play event f[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2328 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2329 | [0m[35m		"event_id": 5484,[0m
[30;1m2330 | [0m[35m		"description": "The IPsec Policy Agent service experienced a critical failure and has shut down. T[0m
[30;1m2331 | [0m[35m		"full_desc": "5484: The IPsec Policy Agent service experienced a critical failure and has shut dow[0m
[30;1m2332 | [0m[35m	},[0m
[30;1m2333 | [0m[35m	{[0m
[30;1m2334 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2328 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2329 | [0m[35m		"event_id": 5484,[0m
[30;1m2330 | [0m[35m		"description": "The IPsec Policy Agent service experienced a critical failure and has shut down. T[0m
[30;1m2331 | [0m[35m		"full_desc": "5484: The IPsec Policy Agent service experienced a critical failure and has shut dow[0m
[30;1m2332 | [0m[35m	},[0m
[30;1m2333 | [0m[35m	{[0m
[30;1m2334 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2327 | [0m[35m		"category": "System",[0m
[30;1m2328 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2329 | [0m[35m		"event_id": 5484,[0m
[30;1m2330 | [0m[35m		"description": "The IPsec Policy Agent service experienced a critical failure and has shut down. T[0m
[30;1m2331 | [0m[35m		"full_desc": "5484: The IPsec Policy Agent service experienced a critical failure and has shut dow[0m
[30;1m2332 | [0m[35m	},[0m
[30;1m2333 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2327 | [0m[35m		"category": "System",[0m
[30;1m2328 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2329 | [0m[35m		"event_id": 5484,[0m
[30;1m2330 | [0m[35m		"description": "The IPsec Policy Agent service experienced a critical failure and has shut down. T[0m
[30;1m2331 | [0m[35m		"full_desc": "5484: The IPsec Policy Agent service experienced a critical failure and has shut dow[0m
[30;1m2332 | [0m[35m	},[0m
[30;1m2333 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2321 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2322 | [0m[35m		"event_id": 5483,[0m
[30;1m2323 | [0m[35m		"description": "The IPsec Policy Agent service failed to initialize its RPC server. The service co[0m
[30;1m2324 | [0m[35m		"full_desc": "5483: The IPsec Policy Agent service failed to initialize its RPC server. The servic[0m
[30;1m2325 | [0m[35m	},[0m
[30;1m2326 | [0m[35m	{[0m
[30;1m2327 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2321 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2322 | [0m[35m		"event_id": 5483,[0m
[30;1m2323 | [0m[35m		"description": "The IPsec Policy Agent service failed to initialize its RPC server. The service co[0m
[30;1m2324 | [0m[35m		"full_desc": "5483: The IPsec Policy Agent service failed to initialize its RPC server. The servic[0m
[30;1m2325 | [0m[35m	},[0m
[30;1m2326 | [0m[35m	{[0m
[30;1m2327 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2320 | [0m[35m		"category": "System",[0m
[30;1m2321 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2322 | [0m[35m		"event_id": 5483,[0m
[30;1m2323 | [0m[35m		"description": "The IPsec Policy Agent service failed to initialize its RPC server. The service co[0m
[30;1m2324 | [0m[35m		"full_desc": "5483: The IPsec Policy Agent service failed to initialize its RPC server. The servic[0m
[30;1m2325 | [0m[35m	},[0m
[30;1m2326 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2320 | [0m[35m		"category": "System",[0m
[30;1m2321 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2322 | [0m[35m		"event_id": 5483,[0m
[30;1m2323 | [0m[35m		"description": "The IPsec Policy Agent service failed to initialize its RPC server. The service co[0m
[30;1m2324 | [0m[35m		"full_desc": "5483: The IPsec Policy Agent service failed to initialize its RPC server. The servic[0m
[30;1m2325 | [0m[35m	},[0m
[30;1m2326 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2316 | [0m[35mor snap-in to diagnose the problem.",[0m
[30;1m2317 | [0m[35m		"full_desc": "5480: IPsec Policy Agent failed to get the complete list of network interfaces on th[0m
[30;1m2318 | [0m[35m	},[0m
[30;1m2319 | [0m[35m	{[0m
[30;1m2320 | [0m[35m		"category": "System",[0m
[30;1m2321 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2322 | [0m[35m		"event_id": 5483,[0m
[30;1m2323 | [0m[35m		"description": "The IPsec Policy Agent service failed to initialize its RPC server. The service co[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2314 | [0m[35mry": "IPsec Driver",[0m
[30;1m2315 | [0m[35m		"event_id": 5480,[0m
[30;1m2316 | [0m[35m		"description": "IPsec Policy Agent failed to get the complete list of network interfaces on the co[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2300 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2301 | [0m[35m		"event_id": 5478,[0m
[30;1m2302 | [0m[35m		"description": "The IPsec Policy Agent service was started.",[0m
[30;1m2303 | [0m[35m		"full_desc": "5478: The IPsec Policy Agent service was started."[0m
[30;1m2304 | [0m[35m	},[0m
[30;1m2305 | [0m[35m	{[0m
[30;1m2306 | [0m[35m		"category": "System",[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2299 | [0m[35m		"category": "System",[0m
[30;1m2300 | [0m[35m		"subcategory": "IPsec Driver",[0m
[30;1m2301 | [0m[35m		"event_id": 5478,[0m
[30;1m2302 | [0m[35m		"description": "The IPsec Policy Agent service was started.",[0m
[30;1m2303 | [0m[35m		"full_desc": "5478: The IPsec Policy Agent service was started."[0m
[30;1m2304 | [0m[35m	},[0m
[30;1m2305 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2251 | [0m[35m		"subcategory": "Sensitive Privilege Use / Non-Sensitive Privilege Use",[0m
[30;1m2252 | [0m[35m		"event_id": 4673,[0m
[30;1m2253 | [0m[35m		"description": "A privileged service was called. ",[0m
[30;1m2254 | [0m[35m		"full_desc": "4673: A privileged service was called. "[0m
[30;1m2255 | [0m[35m	},[0m
[30;1m2256 | [0m[35m	{[0m
[30;1m2257 | [0m[35m		"category": "Privilege Use",[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2250 | [0m[35m		"category": "Privilege Use",[0m
[30;1m2251 | [0m[35m		"subcategory": "Sensitive Privilege Use / Non-Sensitive Privilege Use",[0m
[30;1m2252 | [0m[35m		"event_id": 4673,[0m
[30;1m2253 | [0m[35m		"description": "A privileged service was called. ",[0m
[30;1m2254 | [0m[35m		"full_desc": "4673: A privileged service was called. "[0m
[30;1m2255 | [0m[35m	},[0m
[30;1m2256 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1957 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1958 | [0m[35m		"event_id": 5462,[0m
[30;1m1959 | [0m[35m		"description": "IPsec Policy Agent failed to apply some rules of the active IPsec policy on the co[0m
[30;1m1960 | [0m[35m		"full_desc": "5462: IPsec Policy Agent failed to apply some rules of the active IPsec policy on th[0m
[30;1m1961 | [0m[35m	},[0m
[30;1m1962 | [0m[35m	{[0m
[30;1m1963 | [0m[35m		"category": "Policy Change",[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1956 | [0m[35m		"category": "Policy Change",[0m
[30;1m1957 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1958 | [0m[35m		"event_id": 5462,[0m
[30;1m1959 | [0m[35m		"description": "IPsec Policy Agent failed to apply some rules of the active IPsec policy on the co[0m
[30;1m1960 | [0m[35m		"full_desc": "5462: IPsec Policy Agent failed to apply some rules of the active IPsec policy on th[0m
[30;1m1961 | [0m[35m	},[0m
[30;1m1962 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1768 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1769 | [0m[35m		"event_id": 4710,[0m
[30;1m1770 | [0m[35m		"description": "The IPsec Policy Agent service was disabled.",[0m
[30;1m1771 | [0m[35m		"full_desc": "4710: The IPsec Policy Agent service was disabled."[0m
[30;1m1772 | [0m[35m	},[0m
[30;1m1773 | [0m[35m	{[0m
[30;1m1774 | [0m[35m		"category": "Policy Change",[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1767 | [0m[35m		"category": "Policy Change",[0m
[30;1m1768 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1769 | [0m[35m		"event_id": 4710,[0m
[30;1m1770 | [0m[35m		"description": "The IPsec Policy Agent service was disabled.",[0m
[30;1m1771 | [0m[35m		"full_desc": "4710: The IPsec Policy Agent service was disabled."[0m
[30;1m1772 | [0m[35m	},[0m
[30;1m1773 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1761 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1762 | [0m[35m		"event_id": 4709,[0m
[30;1m1763 | [0m[35m		"description": "The IPsec Policy Agent service was started.",[0m
[30;1m1764 | [0m[35m		"full_desc": "4709: The IPsec Policy Agent service was started."[0m
[30;1m1765 | [0m[35m	},[0m
[30;1m1766 | [0m[35m	{[0m
[30;1m1767 | [0m[35m		"category": "Policy Change",[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1760 | [0m[35m		"category": "Policy Change",[0m
[30;1m1761 | [0m[35m		"subcategory": "Filtering Platform Policy Change",[0m
[30;1m1762 | [0m[35m		"event_id": 4709,[0m
[30;1m1763 | [0m[35m		"description": "The IPsec Policy Agent service was started.",[0m
[30;1m1764 | [0m[35m		"full_desc": "4709: The IPsec Policy Agent service was started."[0m
[30;1m1765 | [0m[35m	},[0m
[30;1m1766 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1411 | [0m[35m		"subcategory": "Filtering Platform Connection",[0m
[30;1m1412 | [0m[35m		"event_id": 5155,[0m
[30;1m1413 | [0m[35m		"description": "The Windows Filtering Platform has blocked an application or service from listenin[0m
[30;1m1414 | [0m[35m		"full_desc": "5155: The Windows Filtering Platform has blocked an application or service from list[0m
[30;1m1415 | [0m[35m	},[0m
[30;1m1416 | [0m[35m	{[0m
[30;1m1417 | [0m[35m		"category": "Object Access",[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1410 | [0m[35m		"category": "Object Access",[0m
[30;1m1411 | [0m[35m		"subcategory": "Filtering Platform Connection",[0m
[30;1m1412 | [0m[35m		"event_id": 5155,[0m
[30;1m1413 | [0m[35m		"description": "The Windows Filtering Platform has blocked an application or service from listenin[0m
[30;1m1414 | [0m[35m		"full_desc": "5155: The Windows Filtering Platform has blocked an application or service from list[0m
[30;1m1415 | [0m[35m	},[0m
[30;1m1416 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1404 | [0m[35m		"subcategory": "Filtering Platform Connection",[0m
[30;1m1405 | [0m[35m		"event_id": 5154,[0m
[30;1m1406 | [0m[35m		"description": "The Windows Filtering Platform has permitted an application or service to listen o[0m
[30;1m1407 | [0m[35m		"full_desc": "5154: The Windows Filtering Platform has permitted an application or service to list[0m
[30;1m1408 | [0m[35m	},[0m
[30;1m1409 | [0m[35m	{[0m
[30;1m1410 | [0m[35m		"category": "Object Access",[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1403 | [0m[35m		"category": "Object Access",[0m
[30;1m1404 | [0m[35m		"subcategory": "Filtering Platform Connection",[0m
[30;1m1405 | [0m[35m		"event_id": 5154,[0m
[30;1m1406 | [0m[35m		"description": "The Windows Filtering Platform has permitted an application or service to listen o[0m
[30;1m1407 | [0m[35m		"full_desc": "5154: The Windows Filtering Platform has permitted an application or service to list[0m
[30;1m1408 | [0m[35m	},[0m
[30;1m1409 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1369 | [0m[35m		"subcategory": "Filtering Platform Connection",[0m
[30;1m1370 | [0m[35m		"event_id": 5031,[0m
[30;1m1371 | [0m[35m		"description": "The Windows Firewall Service blocked an application from accepting incoming connec[0m
[30;1m1372 | [0m[35m		"full_desc": "5031: The Windows Firewall Service blocked an application from accepting incoming co[0m
[30;1m1373 | [0m[35m	},[0m
[30;1m1374 | [0m[35m	{[0m
[30;1m1375 | [0m[35m		"category": "Object Access",[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1368 | [0m[35m		"category": "Object Access",[0m
[30;1m1369 | [0m[35m		"subcategory": "Filtering Platform Connection",[0m
[30;1m1370 | [0m[35m		"event_id": 5031,[0m
[30;1m1371 | [0m[35m		"description": "The Windows Firewall Service blocked an application from accepting incoming connec[0m
[30;1m1372 | [0m[35m		"full_desc": "5031: The Windows Firewall Service blocked an application from accepting incoming co[0m
[30;1m1373 | [0m[35m	},[0m
[30;1m1374 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1257 | [0m[35m		"subcategory": "Certification Services",[0m
[30;1m1258 | [0m[35m		"event_id": 5121,[0m
[30;1m1259 | [0m[35m		"description": "OCSP Responder Service Stopped. ",[0m
[30;1m1260 | [0m[35m		"full_desc": "5121: OCSP Responder Service Stopped. "[0m
[30;1m1261 | [0m[35m	},[0m
[30;1m1262 | [0m[35m	{[0m
[30;1m1263 | [0m[35m		"category": "Object Access",[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1256 | [0m[35m		"category": "Object Access",[0m
[30;1m1257 | [0m[35m		"subcategory": "Certification Services",[0m
[30;1m1258 | [0m[35m		"event_id": 5121,[0m
[30;1m1259 | [0m[35m		"description": "OCSP Responder Service Stopped. ",[0m
[30;1m1260 | [0m[35m		"full_desc": "5121: OCSP Responder Service Stopped. "[0m
[30;1m1261 | [0m[35m	},[0m
[30;1m1262 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1250 | [0m[35m		"subcategory": "Certification Services",[0m
[30;1m1251 | [0m[35m		"event_id": 5120,[0m
[30;1m1252 | [0m[35m		"description": "OCSP Responder Service Started. ",[0m
[30;1m1253 | [0m[35m		"full_desc": "5120: OCSP Responder Service Started. "[0m
[30;1m1254 | [0m[35m	},[0m
[30;1m1255 | [0m[35m	{[0m
[30;1m1256 | [0m[35m		"category": "Object Access",[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1249 | [0m[35m		"category": "Object Access",[0m
[30;1m1250 | [0m[35m		"subcategory": "Certification Services",[0m
[30;1m1251 | [0m[35m		"event_id": 5120,[0m
[30;1m1252 | [0m[35m		"description": "OCSP Responder Service Started. ",[0m
[30;1m1253 | [0m[35m		"full_desc": "5120: OCSP Responder Service Started. "[0m
[30;1m1254 | [0m[35m	},[0m
[30;1m1255 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m956 | [0m[35m		"subcategory": "Other Logon/Logoff Events",[0m
[30;1m957 | [0m[35m		"event_id": 4803,[0m
[30;1m958 | [0m[35m		"description": "The screen saver was dismissed. ",[0m
[30;1m959 | [0m[35m		"full_desc": "4803: The screen saver was dismissed. "[0m
[30;1m960 | [0m[35m	},[0m
[30;1m961 | [0m[35m	{[0m
[30;1m962 | [0m[35m		"category": "Logon/Logoff",[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m955 | [0m[35m		"category": "Logon/Logoff",[0m
[30;1m956 | [0m[35m		"subcategory": "Other Logon/Logoff Events",[0m
[30;1m957 | [0m[35m		"event_id": 4803,[0m
[30;1m958 | [0m[35m		"description": "The screen saver was dismissed. ",[0m
[30;1m959 | [0m[35m		"full_desc": "4803: The screen saver was dismissed. "[0m
[30;1m960 | [0m[35m	},[0m
[30;1m961 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m949 | [0m[35m		"subcategory": "Other Logon/Logoff Events",[0m
[30;1m950 | [0m[35m		"event_id": 4802,[0m
[30;1m951 | [0m[35m		"description": "The screen saver was invoked. ",[0m
[30;1m952 | [0m[35m		"full_desc": "4802: The screen saver was invoked. "[0m
[30;1m953 | [0m[35m	},[0m
[30;1m954 | [0m[35m	{[0m
[30;1m955 | [0m[35m		"category": "Logon/Logoff",[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m948 | [0m[35m		"category": "Logon/Logoff",[0m
[30;1m949 | [0m[35m		"subcategory": "Other Logon/Logoff Events",[0m
[30;1m950 | [0m[35m		"event_id": 4802,[0m
[30;1m951 | [0m[35m		"description": "The screen saver was invoked. ",[0m
[30;1m952 | [0m[35m		"full_desc": "4802: The screen saver was invoked. "[0m
[30;1m953 | [0m[35m	},[0m
[30;1m954 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m659 | [0m[35m	},[0m
[30;1m660 | [0m[35m	{[0m
[30;1m661 | [0m[35m		"category": "DS Access",[0m
[30;1m662 | [0m[35m		"subcategory": "Directory Service Replication",[0m
[30;1m663 | [0m[35m		"event_id": 4933,[0m
[30;1m664 | [0m[35m		"description": "Synchronization of a replica of an Active Directory naming context has ended. ",[0m
[30;1m665 | [0m[35m		"full_desc": "4933: Synchronization of a replica of an Active Directory naming context has ended. [0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m652 | [0m[35m	},[0m
[30;1m653 | [0m[35m	{[0m
[30;1m654 | [0m[35m		"category": "DS Access",[0m
[30;1m655 | [0m[35m		"subcategory": "Directory Service Replication",[0m
[30;1m656 | [0m[35m		"event_id": 4932,[0m
[30;1m657 | [0m[35m		"description": "Synchronization of a replica of an Active Directory naming context has begun. ",[0m
[30;1m658 | [0m[35m		"full_desc": "4932: Synchronization of a replica of an Active Directory naming context has begun. [0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m648 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m649 | [0m[35m		"event_id": 5141,[0m
[30;1m650 | [0m[35m		"description": " A directory service object was deleted. ",[0m
[30;1m651 | [0m[35m		"full_desc": "5141:  A directory service object was deleted. "[0m
[30;1m652 | [0m[35m	},[0m
[30;1m653 | [0m[35m	{[0m
[30;1m654 | [0m[35m		"category": "DS Access",[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m647 | [0m[35m		"category": "DS Access",[0m
[30;1m648 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m649 | [0m[35m		"event_id": 5141,[0m
[30;1m650 | [0m[35m		"description": " A directory service object was deleted. ",[0m
[30;1m651 | [0m[35m		"full_desc": "5141:  A directory service object was deleted. "[0m
[30;1m652 | [0m[35m	},[0m
[30;1m653 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m645 | [0m[35m	},[0m
[30;1m646 | [0m[35m	{[0m
[30;1m647 | [0m[35m		"category": "DS Access",[0m
[30;1m648 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m649 | [0m[35m		"event_id": 5141,[0m
[30;1m650 | [0m[35m		"description": " A directory service object was deleted. ",[0m
[30;1m651 | [0m[35m		"full_desc": "5141:  A directory service object was deleted. "[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m641 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m642 | [0m[35m		"event_id": 5139,[0m
[30;1m643 | [0m[35m		"description": "A directory service object was moved. ",[0m
[30;1m644 | [0m[35m		"full_desc": "5139: A directory service object was moved. "[0m
[30;1m645 | [0m[35m	},[0m
[30;1m646 | [0m[35m	{[0m
[30;1m647 | [0m[35m		"category": "DS Access",[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m640 | [0m[35m		"category": "DS Access",[0m
[30;1m641 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m642 | [0m[35m		"event_id": 5139,[0m
[30;1m643 | [0m[35m		"description": "A directory service object was moved. ",[0m
[30;1m644 | [0m[35m		"full_desc": "5139: A directory service object was moved. "[0m
[30;1m645 | [0m[35m	},[0m
[30;1m646 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m638 | [0m[35m	},[0m
[30;1m639 | [0m[35m	{[0m
[30;1m640 | [0m[35m		"category": "DS Access",[0m
[30;1m641 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m642 | [0m[35m		"event_id": 5139,[0m
[30;1m643 | [0m[35m		"description": "A directory service object was moved. ",[0m
[30;1m644 | [0m[35m		"full_desc": "5139: A directory service object was moved. "[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m634 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m635 | [0m[35m		"event_id": 5138,[0m
[30;1m636 | [0m[35m		"description": "A directory service object was undeleted. ",[0m
[30;1m637 | [0m[35m		"full_desc": "5138: A directory service object was undeleted. "[0m
[30;1m638 | [0m[35m	},[0m
[30;1m639 | [0m[35m	{[0m
[30;1m640 | [0m[35m		"category": "DS Access",[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m633 | [0m[35m		"category": "DS Access",[0m
[30;1m634 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m635 | [0m[35m		"event_id": 5138,[0m
[30;1m636 | [0m[35m		"description": "A directory service object was undeleted. ",[0m
[30;1m637 | [0m[35m		"full_desc": "5138: A directory service object was undeleted. "[0m
[30;1m638 | [0m[35m	},[0m
[30;1m639 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m631 | [0m[35m	},[0m
[30;1m632 | [0m[35m	{[0m
[30;1m633 | [0m[35m		"category": "DS Access",[0m
[30;1m634 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m635 | [0m[35m		"event_id": 5138,[0m
[30;1m636 | [0m[35m		"description": "A directory service object was undeleted. ",[0m
[30;1m637 | [0m[35m		"full_desc": "5138: A directory service object was undeleted. "[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m627 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m628 | [0m[35m		"event_id": 5137,[0m
[30;1m629 | [0m[35m		"description": "A directory service object was created. ",[0m
[30;1m630 | [0m[35m		"full_desc": "5137: A directory service object was created. "[0m
[30;1m631 | [0m[35m	},[0m
[30;1m632 | [0m[35m	{[0m
[30;1m633 | [0m[35m		"category": "DS Access",[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m626 | [0m[35m		"category": "DS Access",[0m
[30;1m627 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m628 | [0m[35m		"event_id": 5137,[0m
[30;1m629 | [0m[35m		"description": "A directory service object was created. ",[0m
[30;1m630 | [0m[35m		"full_desc": "5137: A directory service object was created. "[0m
[30;1m631 | [0m[35m	},[0m
[30;1m632 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m624 | [0m[35m	},[0m
[30;1m625 | [0m[35m	{[0m
[30;1m626 | [0m[35m		"category": "DS Access",[0m
[30;1m627 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m628 | [0m[35m		"event_id": 5137,[0m
[30;1m629 | [0m[35m		"description": "A directory service object was created. ",[0m
[30;1m630 | [0m[35m		"full_desc": "5137: A directory service object was created. "[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m620 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m621 | [0m[35m		"event_id": 5136,[0m
[30;1m622 | [0m[35m		"description": "A directory service object was modified. ",[0m
[30;1m623 | [0m[35m		"full_desc": "5136: A directory service object was modified. "[0m
[30;1m624 | [0m[35m	},[0m
[30;1m625 | [0m[35m	{[0m
[30;1m626 | [0m[35m		"category": "DS Access",[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m619 | [0m[35m		"category": "DS Access",[0m
[30;1m620 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m621 | [0m[35m		"event_id": 5136,[0m
[30;1m622 | [0m[35m		"description": "A directory service object was modified. ",[0m
[30;1m623 | [0m[35m		"full_desc": "5136: A directory service object was modified. "[0m
[30;1m624 | [0m[35m	},[0m
[30;1m625 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m617 | [0m[35m	},[0m
[30;1m618 | [0m[35m	{[0m
[30;1m619 | [0m[35m		"category": "DS Access",[0m
[30;1m620 | [0m[35m		"subcategory": "Directory Service Changes",[0m
[30;1m621 | [0m[35m		"event_id": 5136,[0m
[30;1m622 | [0m[35m		"description": "A directory service object was modified. ",[0m
[30;1m623 | [0m[35m		"full_desc": "5136: A directory service object was modified. "[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m610 | [0m[35m	},[0m
[30;1m611 | [0m[35m	{[0m
[30;1m612 | [0m[35m		"category": "DS Access",[0m
[30;1m613 | [0m[35m		"subcategory": "Directory Service Access",[0m
[30;1m614 | [0m[35m		"event_id": 4662,[0m
[30;1m615 | [0m[35m		"description": " An operation was performed on an object. ",[0m
[30;1m616 | [0m[35m		"full_desc": "4662:  An operation was performed on an object. "[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m603 | [0m[35m	},[0m
[30;1m604 | [0m[35m	{[0m
[30;1m605 | [0m[35m		"category": "DS Access",[0m
[30;1m606 | [0m[35m		"subcategory": "Detailed Directory Service Replication",[0m
[30;1m607 | [0m[35m		"event_id": 4937,[0m
[30;1m608 | [0m[35m		"description": "A lingering object was removed from a replica. ",[0m
[30;1m609 | [0m[35m		"full_desc": "4937: A lingering object was removed from a replica. "[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m596 | [0m[35m	},[0m
[30;1m597 | [0m[35m	{[0m
[30;1m598 | [0m[35m		"category": "DS Access",[0m
[30;1m599 | [0m[35m		"subcategory": "Detailed Directory Service Replication",[0m
[30;1m600 | [0m[35m		"event_id": 4936,[0m
[30;1m601 | [0m[35m		"description": "Replication failure ends. ",[0m
[30;1m602 | [0m[35m		"full_desc": "4936: Replication failure ends. "[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m589 | [0m[35m	},[0m
[30;1m590 | [0m[35m	{[0m
[30;1m591 | [0m[35m		"category": "DS Access",[0m
[30;1m592 | [0m[35m		"subcategory": "Detailed Directory Service Replication",[0m
[30;1m593 | [0m[35m		"event_id": 4935,[0m
[30;1m594 | [0m[35m		"description": "Replication failure begins. ",[0m
[30;1m595 | [0m[35m		"full_desc": "4935: Replication failure begins. "[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m582 | [0m[35m	},[0m
[30;1m583 | [0m[35m	{[0m
[30;1m584 | [0m[35m		"category": "DS Access",[0m
[30;1m585 | [0m[35m		"subcategory": "Detailed Directory Service Replication",[0m
[30;1m586 | [0m[35m		"event_id": 4934,[0m
[30;1m587 | [0m[35m		"description": "Attributes of an Active Directory object were replicated. ",[0m
[30;1m588 | [0m[35m		"full_desc": "4934: Attributes of an Active Directory object were replicated. "[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m575 | [0m[35m	},[0m
[30;1m576 | [0m[35m	{[0m
[30;1m577 | [0m[35m		"category": "DS Access",[0m
[30;1m578 | [0m[35m		"subcategory": "Detailed Directory Service Replication",[0m
[30;1m579 | [0m[35m		"event_id": 4931,[0m
[30;1m580 | [0m[35m		"description": "An Active Directory replica destination naming context was modified. ",[0m
[30;1m581 | [0m[35m		"full_desc": "4931: An Active Directory replica destination naming context was modified. "[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m568 | [0m[35m	},[0m
[30;1m569 | [0m[35m	{[0m
[30;1m570 | [0m[35m		"category": "DS Access",[0m
[30;1m571 | [0m[35m		"subcategory": "Detailed Directory Service Replication",[0m
[30;1m572 | [0m[35m		"event_id": 4930,[0m
[30;1m573 | [0m[35m		"description": "An Active Directory replica source naming context was modified. ",[0m
[30;1m574 | [0m[35m		"full_desc": "4930: An Active Directory replica source naming context was modified. "[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m561 | [0m[35m	},[0m
[30;1m562 | [0m[35m	{[0m
[30;1m563 | [0m[35m		"category": "DS Access",[0m
[30;1m564 | [0m[35m		"subcategory": "Detailed Directory Service Replication",[0m
[30;1m565 | [0m[35m		"event_id": 4929,[0m
[30;1m566 | [0m[35m		"description": "An Active Directory replica source naming context was removed. ",[0m
[30;1m567 | [0m[35m		"full_desc": "4929: An Active Directory replica source naming context was removed. "[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m554 | [0m[35m	},[0m
[30;1m555 | [0m[35m	{[0m
[30;1m556 | [0m[35m		"category": "DS Access",[0m
[30;1m557 | [0m[35m		"subcategory": "Detailed Directory Service Replication",[0m
[30;1m558 | [0m[35m		"event_id": 4928,[0m
[30;1m559 | [0m[35m		"description": "An Active Directory replica source naming context was established. ",[0m
[30;1m560 | [0m[35m		"full_desc": "4928: An Active Directory replica source naming context was established. "[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m68 | [0m[35m		"event_id": 4773,[0m
[30;1m69 | [0m[35m		"description": "A Kerberos service ticket request failed. ",[0m
[30;1m70 | [0m[35m		"full_desc": "4773: A Kerberos service ticket request failed. "[0m
[30;1m71 | [0m[35m	},[0m
[30;1m72 | [0m[35m	{[0m
[30;1m73 | [0m[35m		"category": "Account Management",[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m		"category": "Account Logon",[0m
[30;1m67 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m68 | [0m[35m		"event_id": 4773,[0m
[30;1m69 | [0m[35m		"description": "A Kerberos service ticket request failed. ",[0m
[30;1m70 | [0m[35m		"full_desc": "4773: A Kerberos service ticket request failed. "[0m
[30;1m71 | [0m[35m	},[0m
[30;1m72 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m	},[0m
[30;1m65 | [0m[35m	{[0m
[30;1m66 | [0m[35m		"category": "Account Logon",[0m
[30;1m67 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m68 | [0m[35m		"event_id": 4773,[0m
[30;1m69 | [0m[35m		"description": "A Kerberos service ticket request failed. ",[0m
[30;1m70 | [0m[35m		"full_desc": "4773: A Kerberos service ticket request failed. "[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m61 | [0m[35m		"event_id": 4770,[0m
[30;1m62 | [0m[35m		"description": "A Kerberos service ticket was renewed. ",[0m
[30;1m63 | [0m[35m		"full_desc": "4770: A Kerberos service ticket was renewed. "[0m
[30;1m64 | [0m[35m	},[0m
[30;1m65 | [0m[35m	{[0m
[30;1m66 | [0m[35m		"category": "Account Logon",[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m		"category": "Account Logon",[0m
[30;1m60 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m61 | [0m[35m		"event_id": 4770,[0m
[30;1m62 | [0m[35m		"description": "A Kerberos service ticket was renewed. ",[0m
[30;1m63 | [0m[35m		"full_desc": "4770: A Kerberos service ticket was renewed. "[0m
[30;1m64 | [0m[35m	},[0m
[30;1m65 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m	},[0m
[30;1m58 | [0m[35m	{[0m
[30;1m59 | [0m[35m		"category": "Account Logon",[0m
[30;1m60 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m61 | [0m[35m		"event_id": 4770,[0m
[30;1m62 | [0m[35m		"description": "A Kerberos service ticket was renewed. ",[0m
[30;1m63 | [0m[35m		"full_desc": "4770: A Kerberos service ticket was renewed. "[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m54 | [0m[35m		"event_id": 4769,[0m
[30;1m55 | [0m[35m		"description": "A Kerberos service ticket was requested. ",[0m
[30;1m56 | [0m[35m		"full_desc": "4769: A Kerberos service ticket was requested. "[0m
[30;1m57 | [0m[35m	},[0m
[30;1m58 | [0m[35m	{[0m
[30;1m59 | [0m[35m		"category": "Account Logon",[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m		"category": "Account Logon",[0m
[30;1m53 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m54 | [0m[35m		"event_id": 4769,[0m
[30;1m55 | [0m[35m		"description": "A Kerberos service ticket was requested. ",[0m
[30;1m56 | [0m[35m		"full_desc": "4769: A Kerberos service ticket was requested. "[0m
[30;1m57 | [0m[35m	},[0m
[30;1m58 | [0m[35m	{[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/WinSecurityEvent.json[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m	},[0m
[30;1m51 | [0m[35m	{[0m
[30;1m52 | [0m[35m		"category": "Account Logon",[0m
[30;1m53 | [0m[35m		"subcategory": "Kerberos Service Ticket Operations",[0m
[30;1m54 | [0m[35m		"event_id": 4769,[0m
[30;1m55 | [0m[35m		"description": "A Kerberos service ticket was requested. ",[0m
[30;1m56 | [0m[35m		"full_desc": "4769: A Kerberos service ticket was requested. "[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pd_accessor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m362 | [0m[35m                sort_cols[col] = col_dict[col][0m
[30;1m363 | [0m[35m                continue[0m
[30;1m364 | [0m[35m            # Look for case-insensitive match[0m
[30;1m365 | [0m[35m            df_col = df_cols.get(col.casefold())[0m
[30;1m366 | [0m[35m            if df_col:[0m
[30;1m367 | [0m[35m                sort_cols[col] = col_dict[col][0m
[30;1m368 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pd_accessor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m    def list_to_rows(self, cols: Union[str, Iterable[str]]) -> pd.DataFrame:[0m
[30;1m387 | [0m[35m        """[0m
[30;1m388 | [0m[35m        Expand a list column to individual rows.[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m        Parameters[0m
[30;1m391 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m    def list_to_rows(self, cols: Union[str, Iterable[str]]) -> pd.DataFrame:[0m
[30;1m387 | [0m[35m        """[0m
[30;1m388 | [0m[35m        Expand a list column to individual rows.[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m        Parameters[0m
[30;1m391 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m377 | [0m[35m                sort_cols.update({df_col: col_dict[col] for df_col in df_match_cols})[0m
[30;1m378 | [0m[35m                continue[0m
[30;1m379 | [0m[35m            raise ValueError([0m
[30;1m380 | [0m[35m                f"'{col}' column in sort list did not match any columns in input data."[0m
[30;1m381 | [0m[35m            )[0m
[30;1m382 | [0m[35m        # create the ascending parameter[0m
[30;1m383 | [0m[35m        asc_param = ascending if ascending is not None else list(sort_cols.values())[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m319 | [0m[35m            expression is either a column name, a case-insenstive column name or a[0m
[30;1m320 | [0m[35m            regular expression to match one or more column names.[0m
[30;1m321 | [0m[35m            Each column name expression can be of[0m
[30;1m322 | [0m[35m            the format `col_name_expr:desc` to sort descending (`col_name_expr:asc` is the default).[0m
[30;1m323 | [0m[35m            The col_name can also be a regular expression or partial column name.[0m
[30;1m324 | [0m[35m            If this is a list, then each element should be a column name expression[0m
[30;1m325 | [0m[35m            with an optional ':asc' or ':desc' suffix.[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m310 | [0m[35m        self, cols: Union[str, Iterable[str], Dict[str, str]], ascending: bool = None[0m
[30;1m311 | [0m[35m    ) -> pd.DataFrame:[0m
[30;1m312 | [0m[35m        """[0m
[30;1m313 | [0m[35m        Sort output by column expression.[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m        Parameters[0m
[30;1m316 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m        match_case: bool, optional[0m
[30;1m226 | [0m[35m            Use case-sensitive matching, by default False[0m
[30;1m227 | [0m[35m        sort_cols : bool, optional[0m
[30;1m228 | [0m[35m            Alphabetically sort column names, by default False[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        Returns[0m
[30;1m231 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m            Query to filter the displayed data, by default None[0m
[30;1m112 | [0m[35m            This should be a string executable by the DataFrame.query[0m
[30;1m113 | [0m[35m            function[0m
[30;1m114 | [0m[35m        head : int, optional[0m
[30;1m115 | [0m[35m            Limit the displayed output to `head` rows, by default None[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/elastic_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m        self.service = None[0m
[30;1m41 | [0m[35m        self._loaded = True[0m
[30;1m42 | [0m[35m        self._connected = False[0m
[30;1m43 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        self.set_driver_property([0m
[30;1m46 | [0m[35m            DriverProps.FORMATTERS,[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/vt_pivot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m    if vt_settings:[0m
[30;1m217 | [0m[35m        return ([0m
[30;1m218 | [0m[35m            VTAPIScope.PRIVATE[0m
[30;1m219 | [0m[35m            if vt_settings.args.get(_USE_PRIVATE_API_KEY, False)[0m
[30;1m220 | [0m[35m            else VTAPIScope.PUBLIC[0m
[30;1m221 | [0m[35m        )[0m
[30;1m222 | [0m[35m    return VTAPIScope.PUBLIC[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/vt_pivot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35mdef _get_vt_api_scope() -> VTAPIScope:[0m
[30;1m213 | [0m[35m    """Retrieve the VT enterprise key from settings."""[0m
[30;1m214 | [0m[35m    prov_settings = get_provider_settings("TIProviders")[0m
[30;1m215 | [0m[35m    vt_settings = prov_settings.get("VirusTotal")[0m
[30;1m216 | [0m[35m    if vt_settings:[0m
[30;1m217 | [0m[35m        return ([0m
[30;1m218 | [0m[35m            VTAPIScope.PRIVATE[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m552 | [0m[35m        for ws_name, workspace_conf in workspaces.items():[0m
[30;1m553 | [0m[35m            if workspace.casefold() in [[0m
[30;1m554 | [0m[35m                ws_name.casefold(),[0m
[30;1m555 | [0m[35m                workspace_conf.get("WorkspaceName", "").casefold(),[0m
[30;1m556 | [0m[35m            ]:[0m
[30;1m557 | [0m[35m                self.workspace_config = workspace_conf[0m
[30;1m558 | [0m[35m                self.workspace_alias = ws_name[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m432 | [0m[35m        )[0m
[30;1m433 | [0m[35m        if response.is_success:[0m
[30;1m434 | [0m[35m            logger.info("Dynamic summary deleted.")[0m
[30;1m435 | [0m[35m            return response.json().get("name")[0m
[30;1m436 | [0m[35m        logger.warning([0m
[30;1m437 | [0m[35m            "delete_dynamic_summary failure %s",[0m
[30;1m438 | [0m[35m            response.content.decode("utf-8"),[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m310 | [0m[35m        )[0m
[30;1m311 | [0m[35m        if response.is_success:[0m
[30;1m312 | [0m[35m            logger.info("Dynamic summary created/updated.")[0m
[30;1m313 | [0m[35m            return response.json().get("name")[0m
[30;1m314 | [0m[35m        logger.warning([0m
[30;1m315 | [0m[35m            "_create_dynamic_summary (DynamicSummary) failure %s",[0m
[30;1m316 | [0m[35m            response.content.decode("utf-8"),[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m        if not self._token:[0m
[30;1m168 | [0m[35m            err_msg = "Token not found, can't get dynamic summary."[0m
[30;1m169 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m170 | [0m[35m        response = httpx.get([0m
[30;1m171 | [0m[35m            dyn_sum_url,[0m
[30;1m172 | [0m[35m            headers=get_api_headers(self._token),[0m
[30;1m173 | [0m[35m            params=params,[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m460 | [0m[35m        source_info: dict[str, Any] | None = None,[0m
[30;1m461 | [0m[35m    ) -> str | None:[0m
[30;1m462 | [0m[35m        """[0m
[30;1m463 | [0m[35m        Update a dynamic summary in the Sentinel Workspace.[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m        Parameters[0m
[30;1m466 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m559 | [0m[35m                logger.info("Found workspace config %s", ws_name)[0m
[30;1m560 | [0m[35m                break[0m
[30;1m561 | [0m[35m        else:[0m
[30;1m562 | [0m[35m            err_msg: str = f"Cannot find workspace configuration for {workspace}"[0m
[30;1m563 | [0m[35m            raise LookupError(err_msg)[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m        self.qry_prov = QueryProvider("MSSentinel")[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m                    )[0m
[30;1m153 | [0m[35m                except LookupError:[0m
[30;1m154 | [0m[35m                    logging.info([0m
[30;1m155 | [0m[35m                        "Unable to find default workspace."[0m
[30;1m156 | [0m[35m                        "Use 'sentinel.set_default_workspace(workspace='my_ws_name' "[0m
[30;1m157 | [0m[35m                        "and retry.",[0m
[30;1m158 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_ti_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35mdef _get_ip_functions(ioc_type_supp, ti_lookup):[0m
[30;1m136 | [0m[35m    """Get functions for IP IoC Types."""[0m
[30;1m137 | [0m[35m    # Special case for ipv4 and ipv6[0m
[30;1m138 | [0m[35m    # we want to merge these into single "ip" function[0m
[30;1m139 | [0m[35m    ioc_queries = defaultdict(dict)[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_workspaces.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m377 | [0m[35m        tenant_ep_rgx = r"(?P<endpoint>https://[^/]+)/(?P<tenant_id>[^/]+).*"[0m
[30;1m378 | [0m[35m        match: re.Match[str] | None = re.search([0m
[30;1m379 | [0m[35m            tenant_ep_rgx,[0m
[30;1m380 | [0m[35m            tenant_details.get("token_endpoint", ""),[0m
[30;1m381 | [0m[35m        )[0m
[30;1m382 | [0m[35m        return match.groupdict()["tenant_id"] if match else None[0m
[30;1m383 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_workspaces.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m365 | [0m[35m        """Get the tenant ID from login domain."""[0m
[30;1m366 | [0m[35m        az_cloud_config = AzureCloudConfig(cloud)[0m
[30;1m367 | [0m[35m        login_endpoint: str = az_cloud_config.authority_uri[0m
[30;1m368 | [0m[35m        t_resp: httpx.Response = httpx.get([0m
[30;1m369 | [0m[35m            cls._TENANT_URI.format(cloud_endpoint=login_endpoint, tenant_name=domain),[0m
[30;1m370 | [0m[35m            timeout=get_http_timeout(),[0m
[30;1m371 | [0m[35m            headers=mp_ua_header(),[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_workspaces.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m342 | [0m[35m        return ParsedUrlComponents([0m
[30;1m343 | [0m[35m            domain=uri_match.groupdict().get("domain"),[0m
[30;1m344 | [0m[35m            resource_id=resource_id,[0m
[30;1m345 | [0m[35m            tenant_name=uri_match.groupdict().get("tenantname"),[0m
[30;1m346 | [0m[35m            res_components=res_components,[0m
[30;1m347 | [0m[35m            raw_res_id=raw_res_id,[0m
[30;1m348 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_workspaces.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m340 | [0m[35m            logger.exception("Invalid Sentinel resource id")[0m
[30;1m341 | [0m[35m            return None[0m
[30;1m342 | [0m[35m        return ParsedUrlComponents([0m
[30;1m343 | [0m[35m            domain=uri_match.groupdict().get("domain"),[0m
[30;1m344 | [0m[35m            resource_id=resource_id,[0m
[30;1m345 | [0m[35m            tenant_name=uri_match.groupdict().get("tenantname"),[0m
[30;1m346 | [0m[35m            res_components=res_components,[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_workspaces.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m            subscription_id,[0m
[30;1m179 | [0m[35m            resource_group,[0m
[30;1m180 | [0m[35m        )[0m
[30;1m181 | [0m[35m        return next(iter(settings.values())).get("WorkspaceId") if settings else None[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    @classmethod[0m
[30;1m184 | [0m[35m    def get_workspace_settings([0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_workspaces.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m            resource_id=resource_id,[0m
[30;1m147 | [0m[35m        )[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        return next(iter(settings.values())).get("WorkspaceName") if settings else None[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    @classmethod[0m
[30;1m152 | [0m[35m    def get_workspace_id([0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_workspaces.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m                workspace_tenant_id=workspace_df.iloc[0].tenantId,[0m
[30;1m104 | [0m[35m            )[0m
[30;1m105 | [0m[35m        logger.warning([0m
[30;1m106 | [0m[35m            "Failed to find Azure resource for workspace. Returning partial results.",[0m
[30;1m107 | [0m[35m        )[0m
[30;1m108 | [0m[35m        return cls._get_settings_for_workspace([0m
[30;1m109 | [0m[35m            workspace_name=resource_comps.res_components["name"],[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_watchlists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m            raise CloudError(response=response)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        logger.info("Watchlist created.")[0m
[30;1m131 | [0m[35m        return response.json().get("name")[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    def list_watchlist_items([0m
[30;1m134 | [0m[35m        self: Self,[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_watchlists.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m168 | [0m[35m        overwrite: bool = False,[0m
[30;1m169 | [0m[35m    ) -> None:[0m
[30;1m170 | [0m[35m        """[0m
[30;1m171 | [0m[35m        Add or update an item in a Watchlist.[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m        Parameters[0m
[30;1m174 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        if not self._token:[0m
[30;1m125 | [0m[35m            err_msg = "Token not found, can't check search status."[0m
[30;1m126 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m127 | [0m[35m        search_check_response: httpx.Response = httpx.get([0m
[30;1m128 | [0m[35m            search_url,[0m
[30;1m129 | [0m[35m            headers=get_api_headers(self._token),[0m
[30;1m130 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_search.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        start : datetime, optional[0m
[30;1m51 | [0m[35m            The start time for the query, by default 90 days ago.[0m
[30;1m52 | [0m[35m        end : datetime, optional[0m
[30;1m53 | [0m[35m            The end time for the query, by default now.[0m
[30;1m54 | [0m[35m        search_name : str, optional[0m
[30;1m55 | [0m[35m            A name to apply to the search, by default a random GUID is generated.[0m
[30;1m56 | [0m[35m        timespan: Timespan, optional[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_search.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m        query : str[0m
[30;1m49 | [0m[35m            The KQL query to run as a job.[0m
[30;1m50 | [0m[35m        start : datetime, optional[0m
[30;1m51 | [0m[35m            The start time for the query, by default 90 days ago.[0m
[30;1m52 | [0m[35m        end : datetime, optional[0m
[30;1m53 | [0m[35m            The end time for the query, by default now.[0m
[30;1m54 | [0m[35m        search_name : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_bookmarks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        )[0m
[30;1m110 | [0m[35m        if response.is_success:[0m
[30;1m111 | [0m[35m            logger.info("Bookmark created.")[0m
[30;1m112 | [0m[35m            return response.json().get("name")[0m
[30;1m113 | [0m[35m        raise CloudError(response=response)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    def delete_bookmark([0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookupv3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1218 | [0m[35m    prov_settings: dict[str, ProviderSettings] = get_provider_settings("TIProviders")[0m
[30;1m1219 | [0m[35m    vt_settings: ProviderSettings | None = prov_settings.get("VirusTotal")[0m
[30;1m1220 | [0m[35m    if vt_settings:[0m
[30;1m1221 | [0m[35m        return vt_settings.args.get("AuthKey")[0m
[30;1m1222 | [0m[35m    return None[0m
[30;1m1223 | [0m[35m[0m
[30;1m1224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookupv3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1216 | [0m[35mdef _get_vt_api_key() -> str | None:[0m
[30;1m1217 | [0m[35m    """Retrieve the VT key from settings."""[0m
[30;1m1218 | [0m[35m    prov_settings: dict[str, ProviderSettings] = get_provider_settings("TIProviders")[0m
[30;1m1219 | [0m[35m    vt_settings: ProviderSettings | None = prov_settings.get("VirusTotal")[0m
[30;1m1220 | [0m[35m    if vt_settings:[0m
[30;1m1221 | [0m[35m        return vt_settings.args.get("AuthKey")[0m
[30;1m1222 | [0m[35m    return None[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookupv3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m887 | [0m[35m            )[0m
[30;1m888 | [0m[35m            attribs = pd.json_normalize(response.to_dict()["attributes"], max_level=0)[0m
[30;1m889 | [0m[35m            result_df = pd.concat([result_df, attribs], axis=1)[0m
[30;1m890 | [0m[35m            result_df["context_attributes"] = response.to_dict().get([0m
[30;1m891 | [0m[35m                "context_attributes",[0m
[30;1m892 | [0m[35m            )[0m
[30;1m893 | [0m[35m            return timestamps_to_utcdate(result_df)[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookupv3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m            else:[0m
[30;1m193 | [0m[35m                obj = attributes[0m
[30;1m194 | [0m[35m            vt_df: pd.DataFrame = pd.json_normalize(data=[obj], max_level=0)[0m
[30;1m195 | [0m[35m            last_analysis_stats: dict[str, Any] | None = attributes.get([0m
[30;1m196 | [0m[35m                VTObjectProperties.LAST_ANALYSIS_STATS.value,[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            if last_analysis_stats:[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookupv3.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1006 | [0m[35m        params: dict[0m
[30;1m1007 | [0m[35m            Additional parameters passed to the endpoint.[0m
[30;1m1008 | [0m[35m        cursor: str[0m
[30;1m1009 | [0m[35m            Cursor for resuming the iteration at the point it was left previously.[0m
[30;1m1010 | [0m[35m            A cursor can be obtained with Iterator.cursor(). This[0m
[30;1m1011 | [0m[35m            cursor is not the same one returned by the VirusTotal API.[0m
[30;1m1012 | [0m[35m        limit: int[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m            "threats": response.get("threats", []),[0m
[30;1m409 | [0m[35m            "last_seen": response.get("stamp_seen", ""),[0m
[30;1m410 | [0m[35m            "risk_factors": response.get("riskfactors", {}),[0m
[30;1m411 | [0m[35m            "comments": response.get("comments", {}),[0m
[30;1m412 | [0m[35m        }[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m        return LookupResult(status=True, severity=severity, details=details)[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m            "indicator_id": response.get("iid"),[0m
[30;1m408 | [0m[35m            "threats": response.get("threats", []),[0m
[30;1m409 | [0m[35m            "last_seen": response.get("stamp_seen", ""),[0m
[30;1m410 | [0m[35m            "risk_factors": response.get("riskfactors", {}),[0m
[30;1m411 | [0m[35m            "comments": response.get("comments", {}),[0m
[30;1m412 | [0m[35m        }[0m
[30;1m413 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m406 | [0m[35m        details: dict[str, Any] = {[0m
[30;1m407 | [0m[35m            "indicator_id": response.get("iid"),[0m
[30;1m408 | [0m[35m            "threats": response.get("threats", []),[0m
[30;1m409 | [0m[35m            "last_seen": response.get("stamp_seen", ""),[0m
[30;1m410 | [0m[35m            "risk_factors": response.get("riskfactors", {}),[0m
[30;1m411 | [0m[35m            "comments": response.get("comments", {}),[0m
[30;1m412 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m        details: dict[str, Any] = {[0m
[30;1m407 | [0m[35m            "indicator_id": response.get("iid"),[0m
[30;1m408 | [0m[35m            "threats": response.get("threats", []),[0m
[30;1m409 | [0m[35m            "last_seen": response.get("stamp_seen", ""),[0m
[30;1m410 | [0m[35m            "risk_factors": response.get("riskfactors", {}),[0m
[30;1m411 | [0m[35m            "comments": response.get("comments", {}),[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m404 | [0m[35m        severity: ResultSeverity = self._RISK_MAP[response.get("risk", "none")][0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m        details: dict[str, Any] = {[0m
[30;1m407 | [0m[35m            "indicator_id": response.get("iid"),[0m
[30;1m408 | [0m[35m            "threats": response.get("threats", []),[0m
[30;1m409 | [0m[35m            "last_seen": response.get("stamp_seen", ""),[0m
[30;1m410 | [0m[35m            "risk_factors": response.get("riskfactors", {}),[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m401 | [0m[35m                severity=ResultSeverity.information,[0m
[30;1m402 | [0m[35m                details={"status": "Not found."},[0m
[30;1m403 | [0m[35m            )[0m
[30;1m404 | [0m[35m        severity: ResultSeverity = self._RISK_MAP[response.get("risk", "none")][0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m        details: dict[str, Any] = {[0m
[30;1m407 | [0m[35m            "indicator_id": response.get("iid"),[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    def _get_pd_api_key(self: Self) -> str | None:[0m
[30;1m299 | [0m[35m        """Return Pulsedive api key from configuration."""[0m
[30;1m300 | [0m[35m        pd_settings: ProviderSettings | None = get_provider_settings("TIProviders").get([0m
[30;1m301 | [0m[35m            "Pulsedive",[0m
[30;1m302 | [0m[35m        )[0m
[30;1m303 | [0m[35m        if pd_settings and "AuthKey" in pd_settings.args:[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        status: str = resp.json()["status"][0m
[30;1m291 | [0m[35m        while status == "processing":[0m
[30;1m292 | [0m[35m            sleep(0.5)  # wait a little to avoid hammering UI[0m
[30;1m293 | [0m[35m            resp = httpx.get(url, params=params, headers=headers, timeout=timeout)[0m
[30;1m294 | [0m[35m            status = resp.json()["status"][0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        return json_normalize(resp.json()["data"])[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m281 | [0m[35m        headers: dict[str, str] = mp_ua_header()[0m
[30;1m282 | [0m[35m        timeout: httpx.Timeout = get_http_timeout()[0m
[30;1m283 | [0m[35m        url: str = f"{_BASE_URL}analyze.php"[0m
[30;1m284 | [0m[35m        resp = httpx.get([0m
[30;1m285 | [0m[35m            url,[0m
[30;1m286 | [0m[35m            params=params,[0m
[30;1m287 | [0m[35m            headers=headers,[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m            **self._get_default_params(),[0m
[30;1m252 | [0m[35m            pd_query.query_type: pd_query.data,[0m
[30;1m253 | [0m[35m        }[0m
[30;1m254 | [0m[35m        resp = httpx.get([0m
[30;1m255 | [0m[35m            query_url,[0m
[30;1m256 | [0m[35m            params=params,[0m
[30;1m257 | [0m[35m            headers=mp_ua_header(),[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m                "Content-Type": "application/x-www-form-urlencoded",[0m
[30;1m230 | [0m[35m                **mp_ua_header(),[0m
[30;1m231 | [0m[35m            }[0m
[30;1m232 | [0m[35m            resp: httpx.Response = httpx.post([0m
[30;1m233 | [0m[35m                f"{_BASE_URL}analyze.php",[0m
[30;1m234 | [0m[35m                data=data,[0m
[30;1m235 | [0m[35m                headers=headers,[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m.hostname[0m
[30;1m347 | [0m[35m    _BASE_URL = _BASE_URL[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    _QUERIES: ClassVar[dict[str, APILookupParams]] = {[0m
[30;1m350 | [0m[35m        ioc_type: _QUERY_DEF for ioc_type in ("ipv4", "ipv6", "dns", "hostname", "url")[0m
[30;1m351 | [0m[35m    }[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m    _REQUIRED_PARAMS: ClassVar[list[str]] = ["API_KEY"][0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/pulsedive.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mfrom __future__ import annotations[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom enum import Enum[0m
[30;1m11 | [0m[35mfrom time import sleep[0m
[30;1m12 | [0m[35mfrom typing import TYPE_CHECKING, Any, ClassVar, NamedTuple[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport httpx[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/alienvault_otx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m                    "pulse_count": pulse_count,[0m
[30;1m132 | [0m[35m                    "names": [p.get("name") for p in pulses],[0m
[30;1m133 | [0m[35m                    "tags": [p.get("tags") for p in pulses],[0m
[30;1m134 | [0m[35m                    "references": [p.get("references") for p in pulses],[0m
[30;1m135 | [0m[35m                },[0m
[30;1m136 | [0m[35m            )[0m
[30;1m137 | [0m[35m        return True, ResultSeverity.information, {}[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/alienvault_otx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m                {[0m
[30;1m131 | [0m[35m                    "pulse_count": pulse_count,[0m
[30;1m132 | [0m[35m                    "names": [p.get("name") for p in pulses],[0m
[30;1m133 | [0m[35m                    "tags": [p.get("tags") for p in pulses],[0m
[30;1m134 | [0m[35m                    "references": [p.get("references") for p in pulses],[0m
[30;1m135 | [0m[35m                },[0m
[30;1m136 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/alienvault_otx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m                severity,[0m
[30;1m130 | [0m[35m                {[0m
[30;1m131 | [0m[35m                    "pulse_count": pulse_count,[0m
[30;1m132 | [0m[35m                    "names": [p.get("name") for p in pulses],[0m
[30;1m133 | [0m[35m                    "tags": [p.get("tags") for p in pulses],[0m
[30;1m134 | [0m[35m                    "references": [p.get("references") for p in pulses],[0m
[30;1m135 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/alienvault_otx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        ):[0m
[30;1m110 | [0m[35m            return False, ResultSeverity.information, "Not found."[0m
[30;1m111 | [0m[35m        if "pulse_info" in response["RawResult"]:[0m
[30;1m112 | [0m[35m            pulses = response["RawResult"]["pulse_info"].get("pulses", {})[0m
[30;1m113 | [0m[35m            pulse_count = len(pulses)[0m
[30;1m114 | [0m[35m            if pulse_count == 0:[0m
[30;1m115 | [0m[35m                severity = ResultSeverity.information[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/alienvault_otx.py[0m
   Pattern: [32m.hostname[0m
[30;1m59 | [0m[35m            path="/api/v1/indicators/domain/{observable}/passive_dns",[0m
[30;1m60 | [0m[35m        ),[0m
[30;1m61 | [0m[35m        "dns-geo": _OTXParams(path="/api/v1/indicators/domain/{observable}/geo"),[0m
[30;1m62 | [0m[35m        "hostname": _OTXParams(path="/api/v1/indicators/hostname/{observable}/general"),[0m
[30;1m63 | [0m[35m        "file_hash": _OTXParams(path="/api/v1/indicators/file/{observable}/general"),[0m
[30;1m64 | [0m[35m        "url": _OTXParams(path="/api/v1/indicators/url/{observable}/general"),[0m
[30;1m65 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/alienvault_otx.py[0m
   Pattern: [32m.hostname[0m
[30;1m59 | [0m[35m            path="/api/v1/indicators/domain/{observable}/passive_dns",[0m
[30;1m60 | [0m[35m        ),[0m
[30;1m61 | [0m[35m        "dns-geo": _OTXParams(path="/api/v1/indicators/domain/{observable}/geo"),[0m
[30;1m62 | [0m[35m        "hostname": _OTXParams(path="/api/v1/indicators/hostname/{observable}/general"),[0m
[30;1m63 | [0m[35m        "file_hash": _OTXParams(path="/api/v1/indicators/file/{observable}/general"),[0m
[30;1m64 | [0m[35m        "url": _OTXParams(path="/api/v1/indicators/url/{observable}/general"),[0m
[30;1m65 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m524 | [0m[35m        if not response.is_success:[0m
[30;1m525 | [0m[35m            raise CloudError(response=response)[0m
[30;1m526 | [0m[35m        logger.info("Bookmark added to incident.")[0m
[30;1m527 | [0m[35m        return response.json().get("name")[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m    def list_incidents(self: Self, params: dict | None = None) -> pd.DataFrame:[0m
[30;1m530 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m480 | [0m[35m        if not response.is_success:[0m
[30;1m481 | [0m[35m            raise CloudError(response=response)[0m
[30;1m482 | [0m[35m        logger.info("Comment posted.")[0m
[30;1m483 | [0m[35m        return response.json().get("name")[0m
[30;1m484 | [0m[35m[0m
[30;1m485 | [0m[35m    def add_bookmark_to_incident(self: Self, incident: str, bookmark: str) -> str:[0m
[30;1m486 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m                    timeout=get_http_timeout(),[0m
[30;1m399 | [0m[35m                )[0m
[30;1m400 | [0m[35m        logger.info("Incident created.")[0m
[30;1m401 | [0m[35m        return response.json().get("name")[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m    def _get_incident_id(self: Self, incident: str) -> str:[0m
[30;1m404 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m        if response.status_code not in (200, 201):[0m
[30;1m300 | [0m[35m            raise CloudError(response=response)[0m
[30;1m301 | [0m[35m        logger.info("Incident updated.")[0m
[30;1m302 | [0m[35m        return response.json().get("name")[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m    def create_incident(  # pylint: disable=too-many-arguments, too-many-locals #noqa:PLR0913[0m
[30;1m305 | [0m[35m        self: Self,[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m        if not self._token:[0m
[30;1m156 | [0m[35m            err_msg = "Token not found, can't get incident alerts."[0m
[30;1m157 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m158 | [0m[35m        alerts_resp: httpx.Response = httpx.post([0m
[30;1m159 | [0m[35m            alerts_url,[0m
[30;1m160 | [0m[35m            headers=get_api_headers(self._token),[0m
[30;1m161 | [0m[35m            params=alerts_parameters,[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m        if not self._token:[0m
[30;1m122 | [0m[35m            err_msg = "Token not found, can't get entities."[0m
[30;1m123 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m124 | [0m[35m        ents: httpx.Response = httpx.post([0m
[30;1m125 | [0m[35m            entities_url,[0m
[30;1m126 | [0m[35m            headers=get_api_headers(self._token),[0m
[30;1m127 | [0m[35m            params=ent_parameters,[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m287 | [0m[35m            etag=incident_dets.iloc[0]["etag"],[0m
[30;1m288 | [0m[35m        )[0m
[30;1m289 | [0m[35m        if not self._token:[0m
[30;1m290 | [0m[35m            err_msg = "Token not found, can't update incident."[0m
[30;1m291 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m292 | [0m[35m        response: httpx.Response = httpx.put([0m
[30;1m293 | [0m[35m            incident_url,[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m263 | [0m[35m        incident_id : str[0m
[30;1m264 | [0m[35m            Incident ID GUID.[0m
[30;1m265 | [0m[35m        update_items : dict[0m
[30;1m266 | [0m[35m            Dictionary of properties to update and their values.[0m
[30;1m267 | [0m[35m            https://docs.microsoft.com/rest/api/securityinsights/[0m
[30;1m268 | [0m[35m            stable/incidents/create-or-update[0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m256 | [0m[35m        update_items: dict,[0m
[30;1m257 | [0m[35m    ) -> str:[0m
[30;1m258 | [0m[35m        """[0m
[30;1m259 | [0m[35m        Update properties of an incident.[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        Parameters[0m
[30;1m262 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m330 | [0m[35m        first_activity_time : datetime, optional[0m
[30;1m331 | [0m[35m            The start time of the incident activity, by default None[0m
[30;1m332 | [0m[35m        last_activity_time : datetime, optional[0m
[30;1m333 | [0m[35m            The end time of the incident activity, by default None[0m
[30;1m334 | [0m[35m        labels : List, optional[0m
[30;1m335 | [0m[35m            Any labels to apply to the incident, by default None[0m
[30;1m336 | [0m[35m        bookmarks : List, optional[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_incidents.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m328 | [0m[35m        description : str, optional[0m
[30;1m329 | [0m[35m            A description of the incident, by default None[0m
[30;1m330 | [0m[35m        first_activity_time : datetime, optional[0m
[30;1m331 | [0m[35m            The start time of the incident activity, by default None[0m
[30;1m332 | [0m[35m        last_activity_time : datetime, optional[0m
[30;1m333 | [0m[35m            The end time of the incident activity, by default None[0m
[30;1m334 | [0m[35m        labels : List, optional[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/mblookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    def _make_mb_request(self: Self, data: dict[str, Any]) -> pd.DataFrame:[0m
[30;1m86 | [0m[35m        """Request to the malware bazaar api."""[0m
[30;1m87 | [0m[35m        res: httpx.Response = httpx.post(_BASE_URL, data=data, timeout=None)[0m
[30;1m88 | [0m[35m        res.raise_for_status()[0m
[30;1m89 | [0m[35m        res_data: dict[str, Any] = res.json()[0m
[30;1m90 | [0m[35m        if res.is_success:[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/cyberint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        score: int = 0[0m
[30;1m104 | [0m[35m        if data.get("risk"):[0m
[30;1m105 | [0m[35m            score = (data.get("risk", {})).get("malicious_score", 0)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        if score > self.HIGH_SEVERITY:[0m
[30;1m108 | [0m[35m            result_severity = ResultSeverity.high[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/cyberint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        score: int = 0[0m
[30;1m104 | [0m[35m        if data.get("risk"):[0m
[30;1m105 | [0m[35m            score = (data.get("risk", {})).get("malicious_score", 0)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        if score > self.HIGH_SEVERITY:[0m
[30;1m108 | [0m[35m            result_severity = ResultSeverity.high[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/cyberint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m        data: dict[str, Any] = response["RawResult"].get("data", {})[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        score: int = 0[0m
[30;1m104 | [0m[35m        if data.get("risk"):[0m
[30;1m105 | [0m[35m            score = (data.get("risk", {})).get("malicious_score", 0)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        if score > self.HIGH_SEVERITY:[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/cyberint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m        ):[0m
[30;1m99 | [0m[35m            return False, ResultSeverity.information, "Not found."[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        data: dict[str, Any] = response["RawResult"].get("data", {})[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        score: int = 0[0m
[30;1m104 | [0m[35m        if data.get("risk"):[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/virustotal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        ]:[0m
[30;1m115 | [0m[35m            result_dict["resource"] = response["RawResult"].get("resource", None)[0m
[30;1m116 | [0m[35m            result_dict["permalink"] = response["RawResult"].get("permalink", None)[0m
[30;1m117 | [0m[35m            result_dict["positives"] = response["RawResult"].get("positives", 0)[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        else:[0m
[30;1m120 | [0m[35m            for hit_type, params in self._VT_DETECT_RESULTS.items():[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/virustotal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m            "file_hash",[0m
[30;1m114 | [0m[35m        ]:[0m
[30;1m115 | [0m[35m            result_dict["resource"] = response["RawResult"].get("resource", None)[0m
[30;1m116 | [0m[35m            result_dict["permalink"] = response["RawResult"].get("permalink", None)[0m
[30;1m117 | [0m[35m            result_dict["positives"] = response["RawResult"].get("positives", 0)[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/virustotal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m            "sha256_hash",[0m
[30;1m113 | [0m[35m            "file_hash",[0m
[30;1m114 | [0m[35m        ]:[0m
[30;1m115 | [0m[35m            result_dict["resource"] = response["RawResult"].get("resource", None)[0m
[30;1m116 | [0m[35m            result_dict["permalink"] = response["RawResult"].get("permalink", None)[0m
[30;1m117 | [0m[35m            result_dict["positives"] = response["RawResult"].get("positives", 0)[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/virustotal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        result_dict = {[0m
[30;1m103 | [0m[35m            "verbose_msg": response["RawResult"].get("verbose_msg", None),[0m
[30;1m104 | [0m[35m            "response_code": response["RawResult"].get("response_code", None),[0m
[30;1m105 | [0m[35m            "positives": 0,[0m
[30;1m106 | [0m[35m        }[0m
[30;1m107 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/virustotal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m            return False, ResultSeverity.information, "Not found."[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        result_dict = {[0m
[30;1m103 | [0m[35m            "verbose_msg": response["RawResult"].get("verbose_msg", None),[0m
[30;1m104 | [0m[35m            "response_code": response["RawResult"].get("response_code", None),[0m
[30;1m105 | [0m[35m            "positives": 0,[0m
[30;1m106 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m698 | [0m[35m    def _check_cmd_type(self):[0m
[30;1m699 | [0m[35m        """Check whether the Cmd datatype has the expected attributes."""[0m
[30;1m700 | [0m[35m        session = self.sessions[0][0m
[30;1m701 | [0m[35m        cmd = session[0][0m
[30;1m702 | [0m[35m        if "name" in dir(cmd) and "params" in dir(cmd):[0m
[30;1m703 | [0m[35m            return True[0m
[30;1m704 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m696 | [0m[35m            )[0m
[30;1m697 | [0m[35m[0m
[30;1m698 | [0m[35m    def _check_cmd_type(self):[0m
[30;1m699 | [0m[35m        """Check whether the Cmd datatype has the expected attributes."""[0m
[30;1m700 | [0m[35m        session = self.sessions[0][0m
[30;1m701 | [0m[35m        cmd = session[0][0m
[30;1m702 | [0m[35m        if "name" in dir(cmd) and "params" in dir(cmd):[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m692 | [0m[35m        else:[0m
[30;1m693 | [0m[35m            raise MsticpyException([0m
[30;1m694 | [0m[35m                "Each element of 'sessions' should be a list of either "[0m
[30;1m695 | [0m[35m                + "strings, or Cmd data types"[0m
[30;1m696 | [0m[35m            )[0m
[30;1m697 | [0m[35m[0m
[30;1m698 | [0m[35m    def _check_cmd_type(self):[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m686 | [0m[35m                self.session_type = SessionType.cmds_params_values[0m
[30;1m687 | [0m[35m            else:[0m
[30;1m688 | [0m[35m                raise MsticpyException([0m
[30;1m689 | [0m[35m                    "Params attribute of Cmd data structure should "[0m
[30;1m690 | [0m[35m                    + "be either a set or a dict"[0m
[30;1m691 | [0m[35m                )[0m
[30;1m692 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m676 | [0m[35m[0m
[30;1m677 | [0m[35m        """[0m
[30;1m678 | [0m[35m        session = self.sessions[0][0m
[30;1m679 | [0m[35m        cmd = session[0][0m
[30;1m680 | [0m[35m        if isinstance(cmd, str):[0m
[30;1m681 | [0m[35m            self.session_type = SessionType.cmds_only[0m
[30;1m682 | [0m[35m        elif self._check_cmd_type():[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m672 | [0m[35m        In particular, assess the input `self.sessions` to see whether each[0m
[30;1m673 | [0m[35m        session is a list of strings, or list of the Cmd datatype. And if each[0m
[30;1m674 | [0m[35m        session is a list of the Cmd datatype, it will assess whether the params[0m
[30;1m675 | [0m[35m        attribute of the Cmd datatype is a set or a dict.[0m
[30;1m676 | [0m[35m[0m
[30;1m677 | [0m[35m        """[0m
[30;1m678 | [0m[35m        session = self.sessions[0][0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m671 | [0m[35m[0m
[30;1m672 | [0m[35m        In particular, assess the input `self.sessions` to see whether each[0m
[30;1m673 | [0m[35m        session is a list of strings, or list of the Cmd datatype. And if each[0m
[30;1m674 | [0m[35m        session is a list of the Cmd datatype, it will assess whether the params[0m
[30;1m675 | [0m[35m        attribute of the Cmd datatype is a set or a dict.[0m
[30;1m676 | [0m[35m[0m
[30;1m677 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m670 | [0m[35m        Determine what type of sessions we have.[0m
[30;1m671 | [0m[35m[0m
[30;1m672 | [0m[35m        In particular, assess the input `self.sessions` to see whether each[0m
[30;1m673 | [0m[35m        session is a list of strings, or list of the Cmd datatype. And if each[0m
[30;1m674 | [0m[35m        session is a list of the Cmd datatype, it will assess whether the params[0m
[30;1m675 | [0m[35m        attribute of the Cmd datatype is a set or a dict.[0m
[30;1m676 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m398 | [0m[35m        else:[0m
[30;1m399 | [0m[35m            result = defaultdict(lambda: defaultdict(lambda: 0))[0m
[30;1m400 | [0m[35m            for ses in self.sessions:[0m
[30;1m401 | [0m[35m                for cmd in ses:[0m
[30;1m402 | [0m[35m                    c_name = cmd.name[0m
[30;1m403 | [0m[35m                    params = cmd.params[0m
[30;1m404 | [0m[35m                    pars = set(cmd.params.keys())[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m384 | [0m[35m        if self.session_type == SessionType.cmds_params_only:[0m
[30;1m385 | [0m[35m            result = defaultdict(lambda: defaultdict(lambda: 0))[0m
[30;1m386 | [0m[35m            for ses in self.sessions:[0m
[30;1m387 | [0m[35m                for cmd in ses:[0m
[30;1m388 | [0m[35m                    c_name = cmd.name[0m
[30;1m389 | [0m[35m                    params = cmd.params[0m
[30;1m390 | [0m[35m                    prob = cmds_params_only.compute_prob_setofparams_given_cmd([0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m365 | [0m[35m                for the given cmd across all the sessions.[0m
[30;1m366 | [0m[35m            case2: we have params and values:[0m
[30;1m367 | [0m[35m                Then K is the number of distinct params which appeared[0m
[30;1m368 | [0m[35m                for the given cmd across all the sessions + the number[0m
[30;1m369 | [0m[35m                of values which we included in the modelling for this cmd.[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m            case1: we have only params:[0m
[30;1m364 | [0m[35m                Then K is the number of distinct params which appeared[0m
[30;1m365 | [0m[35m                for the given cmd across all the sessions.[0m
[30;1m366 | [0m[35m            case2: we have params and values:[0m
[30;1m367 | [0m[35m                Then K is the number of distinct params which appeared[0m
[30;1m368 | [0m[35m                for the given cmd across all the sessions + the number[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m351 | [0m[35m        (and values if provided) for each distinct command.[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m        Note, this method is only available if each session is a list[0m
[30;1m354 | [0m[35m        of the Cmd datatype. It will result in an Exception if you[0m
[30;1m355 | [0m[35m        try and use it when each session is a list of strings.[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m        Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m69 | [0m[35m            if len(ses) == 0:[0m
[30;1m70 | [0m[35m                raise MsticpyException([0m
[30;1m71 | [0m[35m                    f"session at index {i} of `sessions` is empty. Each session "[0m
[30;1m72 | [0m[35m                    "should contain at least one command"[0m
[30;1m73 | [0m[35m                )[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m        self.start_token = "##START##"  # nosec B105[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m68 | [0m[35m                raise MsticpyException("each session in `sessions` should be a list")[0m
[30;1m69 | [0m[35m            if len(ses) == 0:[0m
[30;1m70 | [0m[35m                raise MsticpyException([0m
[30;1m71 | [0m[35m                    f"session at index {i} of `sessions` is empty. Each session "[0m
[30;1m72 | [0m[35m                    "should contain at least one command"[0m
[30;1m73 | [0m[35m                )[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m            list of sessions, where each session is a list of either[0m
[30;1m37 | [0m[35m            strings or a list of the Cmd datatype.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m            The Cmd datatype should have "name" and "params" as attributes[0m
[30;1m40 | [0m[35m            where "name" is the name of the command (string) and "params"[0m
[30;1m41 | [0m[35m            is either a set of accompanying params or a dict of[0m
[30;1m42 | [0m[35m            accompanying params and values.[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35m        ----------[0m
[30;1m35 | [0m[35m        sessions: List[List[Union[str, Cmd]]][0m
[30;1m36 | [0m[35m            list of sessions, where each session is a list of either[0m
[30;1m37 | [0m[35m            strings or a list of the Cmd datatype.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m            The Cmd datatype should have "name" and "params" as attributes[0m
[30;1m40 | [0m[35m            where "name" is the name of the command (string) and "params"[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom ...common.exceptions import MsticpyException[0m
[30;1m12 | [0m[35mfrom .utils import cmds_only, cmds_params_only, cmds_params_values, probabilities[0m
[30;1m13 | [0m[35mfrom .utils.data_structures import Cmd[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# pylint: disable=too-many-instance-attributes[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m523 | [0m[35m        """[0m
[30;1m524 | [0m[35m        Find the rarest window and corresponding likelihood for each session.[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m        In particular, uses a sliding window approach to find the rarest window[0m
[30;1m527 | [0m[35m        and corresponding likelihood for that window for each session.[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m        If we have a long session filled with benign activity except for a small[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m521 | [0m[35m        use_geo_mean: bool = False,[0m
[30;1m522 | [0m[35m    ):[0m
[30;1m523 | [0m[35m        """[0m
[30;1m524 | [0m[35m        Find the rarest window and corresponding likelihood for each session.[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m        In particular, uses a sliding window approach to find the rarest window[0m
[30;1m527 | [0m[35m        and corresponding likelihood for that window for each session.[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m        session is a sequence of commands. We use a sliding window[0m
[30;1m29 | [0m[35m        approach to calculate the rarest part of each session. We[0m
[30;1m30 | [0m[35m        can view the sessions in ascending order of this metric to[0m
[30;1m31 | [0m[35m        see if the top sessions are anomalous/malicious.[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        Parameters[0m
[30;1m34 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m            "QuerySubtype"[0m
[30;1m154 | [0m[35m        ] in ["info", "passivedns", "whois"]:[0m
[30;1m155 | [0m[35m            records: int = response["RawResult"].get("total_rows", 0)[0m
[30;1m156 | [0m[35m            contact: int = response["RawResult"].get("contact", 0)[0m
[30;1m157 | [0m[35m            if records:[0m
[30;1m158 | [0m[35m                result_dict["records"] = records[0m
[30;1m159 | [0m[35m            elif contact:[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        if response["IocType"] in ["dns", "ipv4", "ipv6", "hostname"] and response[[0m
[30;1m153 | [0m[35m            "QuerySubtype"[0m
[30;1m154 | [0m[35m        ] in ["info", "passivedns", "whois"]:[0m
[30;1m155 | [0m[35m            records: int = response["RawResult"].get("total_rows", 0)[0m
[30;1m156 | [0m[35m            contact: int = response["RawResult"].get("contact", 0)[0m
[30;1m157 | [0m[35m            if records:[0m
[30;1m158 | [0m[35m                result_dict["records"] = records[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m                    {[0m
[30;1m143 | [0m[35m                        "risk": malware.get("risk"),[0m
[30;1m144 | [0m[35m                        "family": malware.get("family"),[0m
[30;1m145 | [0m[35m                        "reasonDescription": response["RawResult"].get([0m
[30;1m146 | [0m[35m                            "reasonDescription",[0m
[30;1m147 | [0m[35m                            0,[0m
[30;1m148 | [0m[35m                        ),[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                result_dict.update([0m
[30;1m142 | [0m[35m                    {[0m
[30;1m143 | [0m[35m                        "risk": malware.get("risk"),[0m
[30;1m144 | [0m[35m                        "family": malware.get("family"),[0m
[30;1m145 | [0m[35m                        "reasonDescription": response["RawResult"].get([0m
[30;1m146 | [0m[35m                            "reasonDescription",[0m
[30;1m147 | [0m[35m                            0,[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m            if malware:[0m
[30;1m141 | [0m[35m                result_dict.update([0m
[30;1m142 | [0m[35m                    {[0m
[30;1m143 | [0m[35m                        "risk": malware.get("risk"),[0m
[30;1m144 | [0m[35m                        "family": malware.get("family"),[0m
[30;1m145 | [0m[35m                        "reasonDescription": response["RawResult"].get([0m
[30;1m146 | [0m[35m                            "reasonDescription",[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m            response["IocType"] in ["file_hash", "md5_hash", "sha1_hash", "sha256_hash"][0m
[30;1m137 | [0m[35m            or response["QuerySubtype"] == "malware"[0m
[30;1m138 | [0m[35m        ):[0m
[30;1m139 | [0m[35m            malware: dict[str, Any] | None = response["RawResult"].get("malware")[0m
[30;1m140 | [0m[35m            if malware:[0m
[30;1m141 | [0m[35m                result_dict.update([0m
[30;1m142 | [0m[35m                    {[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m                    "categoryDescriptions": report.get("categoryDescriptions"),[0m
[30;1m121 | [0m[35m                    "reason": report.get("reason"),[0m
[30;1m122 | [0m[35m                    "reasonDescription": report.get("reasonDescription", 0),[0m
[30;1m123 | [0m[35m                    "tags": report.get("tags", 0),[0m
[30;1m124 | [0m[35m                },[0m
[30;1m125 | [0m[35m            )[0m
[30;1m126 | [0m[35m            severity = ([0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m                    "cats": report.get("cats"),[0m
[30;1m120 | [0m[35m                    "categoryDescriptions": report.get("categoryDescriptions"),[0m
[30;1m121 | [0m[35m                    "reason": report.get("reason"),[0m
[30;1m122 | [0m[35m                    "reasonDescription": report.get("reasonDescription", 0),[0m
[30;1m123 | [0m[35m                    "tags": report.get("tags", 0),[0m
[30;1m124 | [0m[35m                },[0m
[30;1m125 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m                    "score": report.get("score", 0),[0m
[30;1m119 | [0m[35m                    "cats": report.get("cats"),[0m
[30;1m120 | [0m[35m                    "categoryDescriptions": report.get("categoryDescriptions"),[0m
[30;1m121 | [0m[35m                    "reason": report.get("reason"),[0m
[30;1m122 | [0m[35m                    "reasonDescription": report.get("reasonDescription", 0),[0m
[30;1m123 | [0m[35m                    "tags": report.get("tags", 0),[0m
[30;1m124 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m                {[0m
[30;1m118 | [0m[35m                    "score": report.get("score", 0),[0m
[30;1m119 | [0m[35m                    "cats": report.get("cats"),[0m
[30;1m120 | [0m[35m                    "categoryDescriptions": report.get("categoryDescriptions"),[0m
[30;1m121 | [0m[35m                    "reason": report.get("reason"),[0m
[30;1m122 | [0m[35m                    "reasonDescription": report.get("reasonDescription", 0),[0m
[30;1m123 | [0m[35m                    "tags": report.get("tags", 0),[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m            result_dict.update([0m
[30;1m117 | [0m[35m                {[0m
[30;1m118 | [0m[35m                    "score": report.get("score", 0),[0m
[30;1m119 | [0m[35m                    "cats": report.get("cats"),[0m
[30;1m120 | [0m[35m                    "categoryDescriptions": report.get("categoryDescriptions"),[0m
[30;1m121 | [0m[35m                    "reason": report.get("reason"),[0m
[30;1m122 | [0m[35m                    "reasonDescription": report.get("reasonDescription", 0),[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m                score = 0[0m
[30;1m116 | [0m[35m            result_dict.update([0m
[30;1m117 | [0m[35m                {[0m
[30;1m118 | [0m[35m                    "score": report.get("score", 0),[0m
[30;1m119 | [0m[35m                    "cats": report.get("cats"),[0m
[30;1m120 | [0m[35m                    "categoryDescriptions": report.get("categoryDescriptions"),[0m
[30;1m121 | [0m[35m                    "reason": report.get("reason"),[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m                "result",[0m
[30;1m111 | [0m[35m                response["RawResult"],[0m
[30;1m112 | [0m[35m            )[0m
[30;1m113 | [0m[35m            score: int = report.get("score", 0)[0m
[30;1m114 | [0m[35m            if score is None:[0m
[30;1m115 | [0m[35m                score = 0[0m
[30;1m116 | [0m[35m            result_dict.update([0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m            and not response["QuerySubtype"][0m
[30;1m107 | [0m[35m        ):[0m
[30;1m108 | [0m[35m            # For some IocTypes "dns" and "url", the response structure differs[0m
[30;1m109 | [0m[35m            report: dict[str, Any] = response["RawResult"].get([0m
[30;1m110 | [0m[35m                "result",[0m
[30;1m111 | [0m[35m                response["RawResult"],[0m
[30;1m112 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m.hostname[0m
[30;1m149 | [0m[35m                    },[0m
[30;1m150 | [0m[35m                )[0m
[30;1m151 | [0m[35m                severity = ResultSeverity.high[0m
[30;1m152 | [0m[35m        if response["IocType"] in ["dns", "ipv4", "ipv6", "hostname"] and response[[0m
[30;1m153 | [0m[35m            "QuerySubtype"[0m
[30;1m154 | [0m[35m        ] in ["info", "passivedns", "whois"]:[0m
[30;1m155 | [0m[35m            records: int = response["RawResult"].get("total_rows", 0)[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m.hostname[0m
[30;1m68 | [0m[35m    _QUERIES["dns-malware"] = _QUERIES["url-malware"][0m
[30;1m69 | [0m[35m    _QUERIES["ipv4-passivedns"] = _QUERIES["dns-passivedns"][0m
[30;1m70 | [0m[35m    _QUERIES["ipv6-passivedns"] = _QUERIES["dns-passivedns"][0m
[30;1m71 | [0m[35m    _QUERIES["hostname-whois"] = _QUERIES["ipv4-whois"][0m
[30;1m72 | [0m[35m    _QUERIES["dns-whois"] = _QUERIES["ipv4-whois"][0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    _REQUIRED_PARAMS: ClassVar[list[str]] = ["ApiID", "AuthKey"][0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ibm_xforce.py[0m
   Pattern: [32m.hostname[0m
[30;1m50 | [0m[35m        "ipv4-malware": _XForceParams(path="/ipr/malware/{observable}"),[0m
[30;1m51 | [0m[35m        "ipv4-whois": _XForceParams(path="/whois/{observable}"),[0m
[30;1m52 | [0m[35m        "dns-passivedns": _XForceParams(path="/resolve/{observable}"),[0m
[30;1m53 | [0m[35m        "hostname-whois": _XForceParams(path="/whois/{observable}"),[0m
[30;1m54 | [0m[35m        "file_hash": _XForceParams(path="/malware/{observable}"),[0m
[30;1m55 | [0m[35m        "url": _XForceParams(path="/url/{observable}"),[0m
[30;1m56 | [0m[35m        "url-malware": _XForceParams(path="/url/malware/{observable}"),[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m                "IsTor": response["RawResult"].get("active_tor"),[0m
[30;1m82 | [0m[35m                "IsVPN": response["RawResult"].get("active_vpn"),[0m
[30;1m83 | [0m[35m                "IsBot": response["RawResult"].get("bot_status"),[0m
[30;1m84 | [0m[35m                "AbuseStatus": response["RawResult"].get("recent_abuse"),[0m
[30;1m85 | [0m[35m            },[0m
[30;1m86 | [0m[35m        )[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m                "IsProxy": response["RawResult"].get("proxy"),[0m
[30;1m81 | [0m[35m                "IsTor": response["RawResult"].get("active_tor"),[0m
[30;1m82 | [0m[35m                "IsVPN": response["RawResult"].get("active_vpn"),[0m
[30;1m83 | [0m[35m                "IsBot": response["RawResult"].get("bot_status"),[0m
[30;1m84 | [0m[35m                "AbuseStatus": response["RawResult"].get("recent_abuse"),[0m
[30;1m85 | [0m[35m            },[0m
[30;1m86 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m                "IsMobile": response["RawResult"].get("mobile"),[0m
[30;1m80 | [0m[35m                "IsProxy": response["RawResult"].get("proxy"),[0m
[30;1m81 | [0m[35m                "IsTor": response["RawResult"].get("active_tor"),[0m
[30;1m82 | [0m[35m                "IsVPN": response["RawResult"].get("active_vpn"),[0m
[30;1m83 | [0m[35m                "IsBot": response["RawResult"].get("bot_status"),[0m
[30;1m84 | [0m[35m                "AbuseStatus": response["RawResult"].get("recent_abuse"),[0m
[30;1m85 | [0m[35m            },[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m                "Longitude": response["RawResult"].get("longitude"),[0m
[30;1m79 | [0m[35m                "IsMobile": response["RawResult"].get("mobile"),[0m
[30;1m80 | [0m[35m                "IsProxy": response["RawResult"].get("proxy"),[0m
[30;1m81 | [0m[35m                "IsTor": response["RawResult"].get("active_tor"),[0m
[30;1m82 | [0m[35m                "IsVPN": response["RawResult"].get("active_vpn"),[0m
[30;1m83 | [0m[35m                "IsBot": response["RawResult"].get("bot_status"),[0m
[30;1m84 | [0m[35m                "AbuseStatus": response["RawResult"].get("recent_abuse"),[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m                "Latitude": response["RawResult"].get("latitude"),[0m
[30;1m78 | [0m[35m                "Longitude": response["RawResult"].get("longitude"),[0m
[30;1m79 | [0m[35m                "IsMobile": response["RawResult"].get("mobile"),[0m
[30;1m80 | [0m[35m                "IsProxy": response["RawResult"].get("proxy"),[0m
[30;1m81 | [0m[35m                "IsTor": response["RawResult"].get("active_tor"),[0m
[30;1m82 | [0m[35m                "IsVPN": response["RawResult"].get("active_vpn"),[0m
[30;1m83 | [0m[35m                "IsBot": response["RawResult"].get("bot_status"),[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m                "Organization": response["RawResult"].get("organization"),[0m
[30;1m77 | [0m[35m                "Latitude": response["RawResult"].get("latitude"),[0m
[30;1m78 | [0m[35m                "Longitude": response["RawResult"].get("longitude"),[0m
[30;1m79 | [0m[35m                "IsMobile": response["RawResult"].get("mobile"),[0m
[30;1m80 | [0m[35m                "IsProxy": response["RawResult"].get("proxy"),[0m
[30;1m81 | [0m[35m                "IsTor": response["RawResult"].get("active_tor"),[0m
[30;1m82 | [0m[35m                "IsVPN": response["RawResult"].get("active_vpn"),[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m                "City": response["RawResult"].get("region"),[0m
[30;1m76 | [0m[35m                "Organization": response["RawResult"].get("organization"),[0m
[30;1m77 | [0m[35m                "Latitude": response["RawResult"].get("latitude"),[0m
[30;1m78 | [0m[35m                "Longitude": response["RawResult"].get("longitude"),[0m
[30;1m79 | [0m[35m                "IsMobile": response["RawResult"].get("mobile"),[0m
[30;1m80 | [0m[35m                "IsProxy": response["RawResult"].get("proxy"),[0m
[30;1m81 | [0m[35m                "IsTor": response["RawResult"].get("active_tor"),[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m                "Region": response["RawResult"].get("city"),[0m
[30;1m75 | [0m[35m                "City": response["RawResult"].get("region"),[0m
[30;1m76 | [0m[35m                "Organization": response["RawResult"].get("organization"),[0m
[30;1m77 | [0m[35m                "Latitude": response["RawResult"].get("latitude"),[0m
[30;1m78 | [0m[35m                "Longitude": response["RawResult"].get("longitude"),[0m
[30;1m79 | [0m[35m                "IsMobile": response["RawResult"].get("mobile"),[0m
[30;1m80 | [0m[35m                "IsProxy": response["RawResult"].get("proxy"),[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m                "CountryOrRegion": response["RawResult"].get("country_code"),[0m
[30;1m74 | [0m[35m                "Region": response["RawResult"].get("city"),[0m
[30;1m75 | [0m[35m                "City": response["RawResult"].get("region"),[0m
[30;1m76 | [0m[35m                "Organization": response["RawResult"].get("organization"),[0m
[30;1m77 | [0m[35m                "Latitude": response["RawResult"].get("latitude"),[0m
[30;1m78 | [0m[35m                "Longitude": response["RawResult"].get("longitude"),[0m
[30;1m79 | [0m[35m                "IsMobile": response["RawResult"].get("mobile"),[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m                "ASN": response["RawResult"].get("ASN"),[0m
[30;1m73 | [0m[35m                "CountryOrRegion": response["RawResult"].get("country_code"),[0m
[30;1m74 | [0m[35m                "Region": response["RawResult"].get("city"),[0m
[30;1m75 | [0m[35m                "City": response["RawResult"].get("region"),[0m
[30;1m76 | [0m[35m                "Organization": response["RawResult"].get("organization"),[0m
[30;1m77 | [0m[35m                "Latitude": response["RawResult"].get("latitude"),[0m
[30;1m78 | [0m[35m                "Longitude": response["RawResult"].get("longitude"),[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m                "ISP": response["RawResult"].get("ISP"),[0m
[30;1m72 | [0m[35m                "ASN": response["RawResult"].get("ASN"),[0m
[30;1m73 | [0m[35m                "CountryOrRegion": response["RawResult"].get("country_code"),[0m
[30;1m74 | [0m[35m                "Region": response["RawResult"].get("city"),[0m
[30;1m75 | [0m[35m                "City": response["RawResult"].get("region"),[0m
[30;1m76 | [0m[35m                "Organization": response["RawResult"].get("organization"),[0m
[30;1m77 | [0m[35m                "Latitude": response["RawResult"].get("latitude"),[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m                "FraudScore": response["RawResult"].get("fraud_score"),[0m
[30;1m71 | [0m[35m                "ISP": response["RawResult"].get("ISP"),[0m
[30;1m72 | [0m[35m                "ASN": response["RawResult"].get("ASN"),[0m
[30;1m73 | [0m[35m                "CountryOrRegion": response["RawResult"].get("country_code"),[0m
[30;1m74 | [0m[35m                "Region": response["RawResult"].get("city"),[0m
[30;1m75 | [0m[35m                "City": response["RawResult"].get("region"),[0m
[30;1m76 | [0m[35m                "Organization": response["RawResult"].get("organization"),[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m            {[0m
[30;1m70 | [0m[35m                "FraudScore": response["RawResult"].get("fraud_score"),[0m
[30;1m71 | [0m[35m                "ISP": response["RawResult"].get("ISP"),[0m
[30;1m72 | [0m[35m                "ASN": response["RawResult"].get("ASN"),[0m
[30;1m73 | [0m[35m                "CountryOrRegion": response["RawResult"].get("country_code"),[0m
[30;1m74 | [0m[35m                "Region": response["RawResult"].get("city"),[0m
[30;1m75 | [0m[35m                "City": response["RawResult"].get("region"),[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        result_dict.update([0m
[30;1m69 | [0m[35m            {[0m
[30;1m70 | [0m[35m                "FraudScore": response["RawResult"].get("fraud_score"),[0m
[30;1m71 | [0m[35m                "ISP": response["RawResult"].get("ISP"),[0m
[30;1m72 | [0m[35m                "ASN": response["RawResult"].get("ASN"),[0m
[30;1m73 | [0m[35m                "CountryOrRegion": response["RawResult"].get("country_code"),[0m
[30;1m74 | [0m[35m                "Region": response["RawResult"].get("city"),[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        result_dict: dict[str, Any] = {}[0m
[30;1m68 | [0m[35m        result_dict.update([0m
[30;1m69 | [0m[35m            {[0m
[30;1m70 | [0m[35m                "FraudScore": response["RawResult"].get("fraud_score"),[0m
[30;1m71 | [0m[35m                "ISP": response["RawResult"].get("ISP"),[0m
[30;1m72 | [0m[35m                "ASN": response["RawResult"].get("ASN"),[0m
[30;1m73 | [0m[35m                "CountryOrRegion": response["RawResult"].get("country_code"),[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ip_quality_score.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35mIPQualityScore Provider.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mThis provider offers contextual lookup services and fraud scoring for IP addresses.[0m
[30;1m10 | [0m[35mhttps://www.ipqualityscore.com/[0m
[30;1m11 | [0m[35m"""[0m
[30;1m12 | [0m[35mfrom __future__ import annotations[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/tor_exit_nodes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m        if result["Status"]:[0m
[30;1m147 | [0m[35m            return pd.DataFrame([result])[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        tor_node = self._nodelist.get(ioc)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        if tor_node:[0m
[30;1m152 | [0m[35m            result["Severity"] = ResultSeverity.warning.name[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/tor_exit_nodes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m                    cls._last_cached = datetime.now(timezone.utc)[0m
[30;1m68 | [0m[35m        if not cls._nodelist:[0m
[30;1m69 | [0m[35m            with contextlib.suppress(ConnectionError):[0m
[30;1m70 | [0m[35m                resp = httpx.get([0m
[30;1m71 | [0m[35m                    cls._ALT_URL,[0m
[30;1m72 | [0m[35m                    timeout=get_http_timeout(),[0m
[30;1m73 | [0m[35m                    headers=mp_ua_header(),[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/tor_exit_nodes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m        now: datetime = datetime.now(timezone.utc)[0m
[30;1m57 | [0m[35m        if not cls._nodelist or (now - cls._last_cached).days > 1:[0m
[30;1m58 | [0m[35m            with contextlib.suppress(ConnectionError):[0m
[30;1m59 | [0m[35m                resp: httpx.Response = httpx.get([0m
[30;1m60 | [0m[35m                    cls._BASE_URL,[0m
[30;1m61 | [0m[35m                    timeout=get_http_timeout(),[0m
[30;1m62 | [0m[35m                    headers=mp_ua_header(),[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/tor_exit_nodes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m                with cls._cache_lock:[0m
[30;1m77 | [0m[35m                    node_dict: dict[str, Any] = {"ExitNode": True, "LastStatus": now}[0m
[30;1m78 | [0m[35m                    cls._nodelist = {[0m
[30;1m79 | [0m[35m                        node: node_dict for node in tor_raw_list.split("\n")[0m
[30;1m80 | [0m[35m                    }[0m
[30;1m81 | [0m[35m                    cls._last_cached = datetime.now(timezone.utc)[0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/tor_exit_nodes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    @classmethod[0m
[30;1m52 | [0m[35m    def _check_and_get_nodelist(cls: type[Self]) -> None:[0m
[30;1m53 | [0m[35m        """Pull down Tor exit node list and save to internal attribute."""[0m
[30;1m54 | [0m[35m        if cls._cache_lock.locked():[0m
[30;1m55 | [0m[35m            return[0m
[30;1m56 | [0m[35m        now: datetime = datetime.now(timezone.utc)[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/sumologic/sumologic_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m      | format(_messagetime, "yyyy-MM-ddTHH:mm:ss") as date[0m
[30;1m45 | [0m[35m      | first(date), last(date) by _sourceCategory[0m
[30;1m46 | [0m[35m      | count _sourceCategory[0m
[30;1m47 | [0m[35m      | sort -_count[0m
[30;1m48 | [0m[35m      '[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/sumologic/sumologic_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    add_query_items:[0m
[30;1m30 | [0m[35m      description: Additional query clauses[0m
[30;1m31 | [0m[35m      type: str[0m
[30;1m32 | [0m[35m      default: '| top 100'[0m
[30;1m33 | [0m[35m    timeformat:[0m
[30;1m34 | [0m[35m      description: 'Datetime format to use in Sumologic query'[0m
[30;1m35 | [0m[35m      type: str[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/sumologic/sumologic_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m      description: Query start time[0m
[30;1m21 | [0m[35m      type: datetime[0m
[30;1m22 | [0m[35m    end:[0m
[30;1m23 | [0m[35m      description: Query end time[0m
[30;1m24 | [0m[35m      type: datetime[0m
[30;1m25 | [0m[35m    project_fields:[0m
[30;1m26 | [0m[35m      description: Project Field names[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/sumologic/sumologic_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m      type: str[0m
[30;1m18 | [0m[35m      default: '*'[0m
[30;1m19 | [0m[35m    start:[0m
[30;1m20 | [0m[35m      description: Query start time[0m
[30;1m21 | [0m[35m      type: datetime[0m
[30;1m22 | [0m[35m    end:[0m
[30;1m23 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m123 | [0m[35m    Parameters[0m
[30;1m124 | [0m[35m    ----------[0m
[30;1m125 | [0m[35m    data: pd.DataFrame[0m
[30;1m126 | [0m[35m        This dataframe should contain at least the following columns:[0m
[30;1m127 | [0m[35m        - time stamp column[0m
[30;1m128 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m129 | [0m[35m    user_identifier_cols: List[str][0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m    Parameters[0m
[30;1m37 | [0m[35m    ----------[0m
[30;1m38 | [0m[35m    data: pd.DataFrame[0m
[30;1m39 | [0m[35m        This dataframe should contain at least the following columns:[0m
[30;1m40 | [0m[35m        - time stamp column[0m
[30;1m41 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m42 | [0m[35m        - column containing an event[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m
[30;1m131 | [0m[35m        Each time the value of one of these columns changes, a new session will be started.[0m
[30;1m132 | [0m[35m    time_col: str[0m
[30;1m133 | [0m[35m        Name of the column which contains a time stamp.[0m
[30;1m134 | [0m[35m        If this column is not already in datetime64[ns, UTC] format, it will be casted to it.[0m
[30;1m135 | [0m[35m    max_session_time_mins: int[0m
[30;1m136 | [0m[35m        The maximum length of a session in minutes. If a sequence of events for the same[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m128 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m129 | [0m[35m    user_identifier_cols: List[str][0m
[30;1m130 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m
[30;1m131 | [0m[35m        Each time the value of one of these columns changes, a new session will be started.[0m
[30;1m132 | [0m[35m    time_col: str[0m
[30;1m133 | [0m[35m        Name of the column which contains a time stamp.[0m
[30;1m134 | [0m[35m        If this column is not already in datetime64[ns, UTC] format, it will be casted to it.[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m        - time stamp column[0m
[30;1m128 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m129 | [0m[35m    user_identifier_cols: List[str][0m
[30;1m130 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m
[30;1m131 | [0m[35m        Each time the value of one of these columns changes, a new session will be started.[0m
[30;1m132 | [0m[35m    time_col: str[0m
[30;1m133 | [0m[35m        Name of the column which contains a time stamp.[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m    data: pd.DataFrame[0m
[30;1m126 | [0m[35m        This dataframe should contain at least the following columns:[0m
[30;1m127 | [0m[35m        - time stamp column[0m
[30;1m128 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m129 | [0m[35m    user_identifier_cols: List[str][0m
[30;1m130 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m
[30;1m131 | [0m[35m        Each time the value of one of these columns changes, a new session will be started.[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m    ----------[0m
[30;1m125 | [0m[35m    data: pd.DataFrame[0m
[30;1m126 | [0m[35m        This dataframe should contain at least the following columns:[0m
[30;1m127 | [0m[35m        - time stamp column[0m
[30;1m128 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m129 | [0m[35m    user_identifier_cols: List[str][0m
[30;1m130 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    """[0m
[30;1m118 | [0m[35m    Create a "session_ind" column in the dataframe.[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    In particular, the session_ind column will be incremented each time a new session[0m
[30;1m121 | [0m[35m    starts.[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m
[30;1m45 | [0m[35m        Each time the value of one of these columns changes, a new session will be started.[0m
[30;1m46 | [0m[35m    time_col: str[0m
[30;1m47 | [0m[35m        Name of the column which contains a time stamp.[0m
[30;1m48 | [0m[35m        If this column is not already in datetime64[ns, UTC] format, it will be casted to it.[0m
[30;1m49 | [0m[35m    max_session_time_mins: int[0m
[30;1m50 | [0m[35m        The maximum length of a session in minutes. If a sequence of events for the same[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m        - column containing an event[0m
[30;1m43 | [0m[35m    user_identifier_cols: List[str][0m
[30;1m44 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m
[30;1m45 | [0m[35m        Each time the value of one of these columns changes, a new session will be started.[0m
[30;1m46 | [0m[35m    time_col: str[0m
[30;1m47 | [0m[35m        Name of the column which contains a time stamp.[0m
[30;1m48 | [0m[35m        If this column is not already in datetime64[ns, UTC] format, it will be casted to it.[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m42 | [0m[35m        - column containing an event[0m
[30;1m43 | [0m[35m    user_identifier_cols: List[str][0m
[30;1m44 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m
[30;1m45 | [0m[35m        Each time the value of one of these columns changes, a new session will be started.[0m
[30;1m46 | [0m[35m    time_col: str[0m
[30;1m47 | [0m[35m        Name of the column which contains a time stamp.[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    data: pd.DataFrame[0m
[30;1m39 | [0m[35m        This dataframe should contain at least the following columns:[0m
[30;1m40 | [0m[35m        - time stamp column[0m
[30;1m41 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m42 | [0m[35m        - column containing an event[0m
[30;1m43 | [0m[35m    user_identifier_cols: List[str][0m
[30;1m44 | [0m[35m        Name of the columns which contain username and/or computer name and/or ip address etc.[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/sessionize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    ----------[0m
[30;1m38 | [0m[35m    data: pd.DataFrame[0m
[30;1m39 | [0m[35m        This dataframe should contain at least the following columns:[0m
[30;1m40 | [0m[35m        - time stamp column[0m
[30;1m41 | [0m[35m        - columns related to user name and/or computer name and/or ip address etc[0m
[30;1m42 | [0m[35m        - column containing an event[0m
[30;1m43 | [0m[35m    user_identifier_cols: List[str][0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_network.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m52 | [0m[35m        description: Name of host[0m
[30;1m53 | [0m[35m        type: str[0m
[30;1m54 | [0m[35m        aliases:[0m
[30;1m55 | [0m[35m          - hostname[0m
[30;1m56 | [0m[35m  ip_connections:[0m
[30;1m57 | [0m[35m    description: Returns network connections associated with a specified remote IP[0m
[30;1m58 | [0m[35m    metadata:[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_network.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m38 | [0m[35m        {add_query_items}"[0m
[30;1m39 | [0m[35m      uri: None[0m
[30;1m40 | [0m[35m  host_connections:[0m
[30;1m41 | [0m[35m    description: Returns connections by a specified hostname[0m
[30;1m42 | [0m[35m    metadata:[0m
[30;1m43 | [0m[35m    args:[0m
[30;1m44 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        {add_query_items}'[0m
[30;1m66 | [0m[35m    parameters:[0m
[30;1m67 | [0m[35m      ip_address:[0m
[30;1m68 | [0m[35m        description: Remote IP Address[0m
[30;1m69 | [0m[35m        type: str[0m
[30;1m70 | [0m[35m  url_connections:[0m
[30;1m71 | [0m[35m    description: Returns connections associated with a specified URL[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        aliases:[0m
[30;1m55 | [0m[35m          - hostname[0m
[30;1m56 | [0m[35m  ip_connections:[0m
[30;1m57 | [0m[35m    description: Returns network connections associated with a specified remote IP[0m
[30;1m58 | [0m[35m    metadata:[0m
[30;1m59 | [0m[35m    args:[0m
[30;1m60 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m      type: str[0m
[30;1m24 | [0m[35m      default: ""[0m
[30;1m25 | [0m[35m    time_column:[0m
[30;1m26 | [0m[35m      description: The name of the column detailing the time the event was generated.[0m
[30;1m27 | [0m[35m      type: str[0m
[30;1m28 | [0m[35m      default: "Timestamp"[0m
[30;1m29 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m
[30;1m20 | [0m[35m      type: datetime[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m      type: str[0m
[30;1m14 | [0m[35m      default: "DeviceNetworkEvents"[0m
[30;1m15 | [0m[35m    start:[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/soc/sentinel_alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m    def _add_sentinel_items(self, src_event):[0m
[30;1m113 | [0m[35m        for feature in _FEATURES:[0m
[30;1m114 | [0m[35m            if feature not in self.__dict__:[0m
[30;1m115 | [0m[35m                self.__dict__.update({feature: src_event.get(feature, "")})[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    @property[0m
[30;1m118 | [0m[35m    def ids(self) -> Dict[str, str]:[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/soc/sentinel_alert.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m    "Data Sources",[0m
[30;1m50 | [0m[35m    "Query",[0m
[30;1m51 | [0m[35m    "Query Start Time UTC",[0m
[30;1m52 | [0m[35m    "Query End Time UTC",[0m
[30;1m53 | [0m[35m    "Analytic Rule Ids",[0m
[30;1m54 | [0m[35m    "Event Grouping",[0m
[30;1m55 | [0m[35m    "Analytic Rule Name",[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/soc/sentinel_alert.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    "Search Query Results Overall Count",[0m
[30;1m49 | [0m[35m    "Data Sources",[0m
[30;1m50 | [0m[35m    "Query",[0m
[30;1m51 | [0m[35m    "Query Start Time UTC",[0m
[30;1m52 | [0m[35m    "Query End Time UTC",[0m
[30;1m53 | [0m[35m    "Analytic Rule Ids",[0m
[30;1m54 | [0m[35m    "Event Grouping",[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m251 | [0m[35m        type: str[0m
[30;1m252 | [0m[35m        default: VMComputer[0m
[30;1m253 | [0m[35m      ip_address:[0m
[30;1m254 | [0m[35m        description: The IP Address of the VM[0m
[30;1m255 | [0m[35m        type: str[0m
[30;1m256 | [0m[35m  get_vmcomputer_for_host:[0m
[30;1m257 | [0m[35m    description: Returns most recent VMComputer record for Host[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m        type: str[0m
[30;1m201 | [0m[35m        default: StorageFileLogs[0m
[30;1m202 | [0m[35m      ip_address:[0m
[30;1m203 | [0m[35m        description: Client IP Address[0m
[30;1m204 | [0m[35m        type: str[0m
[30;1m205 | [0m[35m  list_storage_ops_for_hash:[0m
[30;1m206 | [0m[35m    description: Returns Azure Storage Operations for an MD5 file hash[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m        type: str[0m
[30;1m171 | [0m[35m        default: SigninLogs[0m
[30;1m172 | [0m[35m  list_storage_ops_for_ip:[0m
[30;1m173 | [0m[35m    description: Returns Storage Operations for an IP Address[0m
[30;1m174 | [0m[35m    metadata:[0m
[30;1m175 | [0m[35m      pivot:[0m
[30;1m176 | [0m[35m        short_name: storage_ops[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m        type: str[0m
[30;1m127 | [0m[35m        default: AzureActivity[0m
[30;1m128 | [0m[35m      ip_address_list:[0m
[30;1m129 | [0m[35m        description: The IP Address or list of Addresses[0m
[30;1m130 | [0m[35m        type: list[0m
[30;1m131 | [0m[35m  list_azure_activity_for_resource:[0m
[30;1m132 | [0m[35m    description: Returns Azure Activity for an Azure Resource ID[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m        description: The account name to find[0m
[30;1m108 | [0m[35m        type: str[0m
[30;1m109 | [0m[35m  list_azure_activity_for_ip:[0m
[30;1m110 | [0m[35m    description: Returns Azure Activity for Caller IP Address(es)[0m
[30;1m111 | [0m[35m    metadata:[0m
[30;1m112 | [0m[35m      pivot:[0m
[30;1m113 | [0m[35m        short_name: activity[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        type: str[0m
[30;1m105 | [0m[35m        default: AzureActivity[0m
[30;1m106 | [0m[35m      account_name:[0m
[30;1m107 | [0m[35m        description: The account name to find[0m
[30;1m108 | [0m[35m        type: str[0m
[30;1m109 | [0m[35m  list_azure_activity_for_ip:[0m
[30;1m110 | [0m[35m    description: Returns Azure Activity for Caller IP Address(es)[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        type: str[0m
[30;1m77 | [0m[35m        default: SigninLogs[0m
[30;1m78 | [0m[35m      ip_address_list:[0m
[30;1m79 | [0m[35m        description: The IP Address or list of Addresses[0m
[30;1m80 | [0m[35m        type: list[0m
[30;1m81 | [0m[35m  list_azure_activity_for_account:[0m
[30;1m82 | [0m[35m    description: Returns Azure Activity for Account[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m        type: str[0m
[30;1m58 | [0m[35m        default: "!!DEFAULT!!"[0m
[30;1m59 | [0m[35m  list_aad_signins_for_ip:[0m
[30;1m60 | [0m[35m    description: Returns Azure AD Signins for an IP Address[0m
[30;1m61 | [0m[35m    metadata:[0m
[30;1m62 | [0m[35m      pivot:[0m
[30;1m63 | [0m[35m        short_name: signins[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m        type: str[0m
[30;1m54 | [0m[35m        default: "!!DEFAULT!!"[0m
[30;1m55 | [0m[35m      account_id:[0m
[30;1m56 | [0m[35m        description: Azure user ID to find[0m
[30;1m57 | [0m[35m        type: str[0m
[30;1m58 | [0m[35m        default: "!!DEFAULT!!"[0m
[30;1m59 | [0m[35m  list_aad_signins_for_ip:[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m        type: str[0m
[30;1m50 | [0m[35m        default: SigninLogs[0m
[30;1m51 | [0m[35m      account_name:[0m
[30;1m52 | [0m[35m        description: The account name to find[0m
[30;1m53 | [0m[35m        type: str[0m
[30;1m54 | [0m[35m        default: "!!DEFAULT!!"[0m
[30;1m55 | [0m[35m      account_id:[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m
[30;1m16 | [0m[35m      type: datetime[0m
[30;1m17 | [0m[35m    add_query_items:[0m
[30;1m18 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    data_source: "Azure"[0m
[30;1m10 | [0m[35m  parameters:[0m
[30;1m11 | [0m[35m    start:[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/host.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m        self.NetBiosName = self.HostName[0m
[30;1m139 | [0m[35m        self.AzureID = src_event.get("AzureID")[0m
[30;1m140 | [0m[35m        self.DeviceId = src_event.get("DeviceId")[0m
[30;1m141 | [0m[35m        self.DeviceName = src_event.get("DeviceName")[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    _entity_schema = {[0m
[30;1m144 | [0m[35m        # DnsDomain (type System.String)[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/host.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m                self.DnsDomain = src_event["DnsDomain"][0m
[30;1m138 | [0m[35m        self.NetBiosName = self.HostName[0m
[30;1m139 | [0m[35m        self.AzureID = src_event.get("AzureID")[0m
[30;1m140 | [0m[35m        self.DeviceId = src_event.get("DeviceId")[0m
[30;1m141 | [0m[35m        self.DeviceName = src_event.get("DeviceName")[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    _entity_schema = {[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/host.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m            if "DnsDomain" in src_event:[0m
[30;1m137 | [0m[35m                self.DnsDomain = src_event["DnsDomain"][0m
[30;1m138 | [0m[35m        self.NetBiosName = self.HostName[0m
[30;1m139 | [0m[35m        self.AzureID = src_event.get("AzureID")[0m
[30;1m140 | [0m[35m        self.DeviceId = src_event.get("DeviceId")[0m
[30;1m141 | [0m[35m        self.DeviceName = src_event.get("DeviceName")[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_alerts.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m34 | [0m[35m        {add_query_items}"[0m
[30;1m35 | [0m[35m      uri: None[0m
[30;1m36 | [0m[35m  host_alerts:[0m
[30;1m37 | [0m[35m    description: Lists alerts by for a specified hostname[0m
[30;1m38 | [0m[35m    metadata:[0m
[30;1m39 | [0m[35m      pivot:[0m
[30;1m40 | [0m[35m        short_name: alerts[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m        {add_query_items}'[0m
[30;1m64 | [0m[35m    parameters:[0m
[30;1m65 | [0m[35m      ip_address:[0m
[30;1m66 | [0m[35m        description: Remote IP Address[0m
[30;1m67 | [0m[35m        type: str[0m
[30;1m68 | [0m[35m  url_alerts:[0m
[30;1m69 | [0m[35m    description: Returns alerts associated with a specified URL[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        description: Name of host[0m
[30;1m51 | [0m[35m        type: str[0m
[30;1m52 | [0m[35m  ip_alerts:[0m
[30;1m53 | [0m[35m    description: Returns alerts associated with a specified remote IP[0m
[30;1m54 | [0m[35m    metadata:[0m
[30;1m55 | [0m[35m      pivot:[0m
[30;1m56 | [0m[35m        short_name: alerts[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m      default: ""[0m
[30;1m25 | [0m[35msources:[0m
[30;1m26 | [0m[35m  list_alerts:[0m
[30;1m27 | [0m[35m    description: Returns list of alerts for a specified time range[0m
[30;1m28 | [0m[35m    metadata:[0m
[30;1m29 | [0m[35m    args:[0m
[30;1m30 | [0m[35m      query: "[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m
[30;1m20 | [0m[35m      type: datetime[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_alerts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m      type: str[0m
[30;1m14 | [0m[35m      default: "DeviceAlertEvents"[0m
[30;1m15 | [0m[35m    start:[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m88 | [0m[35m        self.ConfigId = src_event.get("ConfigId")[0m
[30;1m89 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m
[30;1m90 | [0m[35m        self.ConfigType = src_event.get("ConfigType")[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    @property[0m
[30;1m93 | [0m[35m    def description_str(self):[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m87 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m88 | [0m[35m        self.ConfigId = src_event.get("ConfigId")[0m
[30;1m89 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m
[30;1m90 | [0m[35m        self.ConfigType = src_event.get("ConfigType")[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        self.MailboxPrimaryAddress = src_event.get("MailboxPrimaryAddress")[0m
[30;1m86 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m87 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m88 | [0m[35m        self.ConfigId = src_event.get("ConfigId")[0m
[30;1m89 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m
[30;1m90 | [0m[35m        self.ConfigType = src_event.get("ConfigType")[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m85 | [0m[35m        self.MailboxPrimaryAddress = src_event.get("MailboxPrimaryAddress")[0m
[30;1m86 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m87 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m88 | [0m[35m        self.ConfigId = src_event.get("ConfigId")[0m
[30;1m89 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m
[30;1m90 | [0m[35m        self.ConfigType = src_event.get("ConfigType")[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m85 | [0m[35m        self.MailboxPrimaryAddress = src_event.get("MailboxPrimaryAddress")[0m
[30;1m86 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m87 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m88 | [0m[35m        self.ConfigId = src_event.get("ConfigId")[0m
[30;1m89 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m            self._create_from_event(src_event)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m85 | [0m[35m        self.MailboxPrimaryAddress = src_event.get("MailboxPrimaryAddress")[0m
[30;1m86 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m87 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m88 | [0m[35m        self.ConfigId = src_event.get("ConfigId")[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_network.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m50 | [0m[35m        description: Name of host[0m
[30;1m51 | [0m[35m        type: str[0m
[30;1m52 | [0m[35m        aliases:[0m
[30;1m53 | [0m[35m          - hostname[0m
[30;1m54 | [0m[35m  ip_connections:[0m
[30;1m55 | [0m[35m    description: Returns network connections associated with a specified remote IP[0m
[30;1m56 | [0m[35m    metadata:[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_network.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m34 | [0m[35m        {add_query_items}"[0m
[30;1m35 | [0m[35m      uri: None[0m
[30;1m36 | [0m[35m  host_connections:[0m
[30;1m37 | [0m[35m    description: Returns network connections a specified hostname/device name[0m
[30;1m38 | [0m[35m    metadata:[0m
[30;1m39 | [0m[35m      pivot:[0m
[30;1m40 | [0m[35m        short_name: net_connections[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        {add_query_items}'[0m
[30;1m66 | [0m[35m    parameters:[0m
[30;1m67 | [0m[35m      ip_address:[0m
[30;1m68 | [0m[35m        description: Remote IP Address[0m
[30;1m69 | [0m[35m        type: str[0m
[30;1m70 | [0m[35m  url_connections:[0m
[30;1m71 | [0m[35m    description: Returns network connections associated with a specified URL[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m        aliases:[0m
[30;1m53 | [0m[35m          - hostname[0m
[30;1m54 | [0m[35m  ip_connections:[0m
[30;1m55 | [0m[35m    description: Returns network connections associated with a specified remote IP[0m
[30;1m56 | [0m[35m    metadata:[0m
[30;1m57 | [0m[35m      pivot:[0m
[30;1m58 | [0m[35m        short_name: net_connections[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m      default: ""[0m
[30;1m25 | [0m[35msources:[0m
[30;1m26 | [0m[35m  list_connections:[0m
[30;1m27 | [0m[35m    description: Returns list of network connections for a specified time range[0m
[30;1m28 | [0m[35m    metadata:[0m
[30;1m29 | [0m[35m    args:[0m
[30;1m30 | [0m[35m      query: "[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m
[30;1m20 | [0m[35m      type: datetime[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m      type: str[0m
[30;1m14 | [0m[35m      default: "DeviceNetworkEvents"[0m
[30;1m15 | [0m[35m    start:[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m297 | [0m[35m        description: hostname of computer to focus query on[0m
[30;1m298 | [0m[35m        type: str[0m
[30;1m299 | [0m[35m        aliases:[0m
[30;1m300 | [0m[35m          - hostname[0m
[30;1m301 | [0m[35m      timestamp:[0m
[30;1m302 | [0m[35m        description: timestamp to base investigation scope on[0m
[30;1m303 | [0m[35m        type: str[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m294 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Po[0m
[30;1m295 | [0m[35m    parameters:[0m
[30;1m296 | [0m[35m      host_name:[0m
[30;1m297 | [0m[35m        description: hostname of computer to focus query on[0m
[30;1m298 | [0m[35m        type: str[0m
[30;1m299 | [0m[35m        aliases:[0m
[30;1m300 | [0m[35m          - hostname[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m21 | [0m[35m        let minTimeRange = ago(7d);[0m
[30;1m22 | [0m[35m        let wordLinks =[0m
[30;1m23 | [0m[35m          DeviceEvents[0m
[30;1m24 | [0m[35m          // Filter on click on links from WinWord[0m
[30;1m25 | [0m[35m          | where Timestamp > minTimeRange and ActionType == "BrowserLaunchedToOpenUrl" and isnotemp[0m
[30;1m26 | [0m[35m          | project ClickTime=Timestamp, DeviceId, DeviceName, ClickUrl=RemoteUrl;[0m
[30;1m27 | [0m[35m        let docAttachments =[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m362 | [0m[35m        {add_query_items}'[0m
[30;1m363 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Lateral%20Mo[0m
[30;1m364 | [0m[35m  service_account_powershell:[0m
[30;1m365 | [0m[35m    description: Service Accounts Performing Remote PowerShell[0m
[30;1m366 | [0m[35m    metadata:[0m
[30;1m367 | [0m[35m    args:[0m
[30;1m368 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m341 | [0m[35m        {add_query_items}'[0m
[30;1m342 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Exploits/Lin[0m
[30;1m343 | [0m[35m  brute_force:[0m
[30;1m344 | [0m[35m    description: Look for public IP addresses that failed to logon to a computer multiple times, usi[0m
[30;1m345 | [0m[35m    metadata:[0m
[30;1m346 | [0m[35m    args:[0m
[30;1m347 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m324 | [0m[35m        | where InitiatingProcessFileName =~ "cmd.exe" and InitiatingProcessParentFileName =~ "excel[0m
[30;1m325 | [0m[35m        | where RemoteUrl endswith ".kr"[0m
[30;1m326 | [0m[35m        | project Timestamp, DeviceName, RemoteIP, RemoteUrl[0m
[30;1m327 | [0m[35m        | top 100 by Timestamp[0m
[30;1m328 | [0m[35m        {add_query_items}'[0m
[30;1m329 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Exploits/Fla[0m
[30;1m330 | [0m[35m  cve_2018_1111:[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m287 | [0m[35mon("$.Command", AdditionalFields, typeof(string)), InitiatingProcessCommandLine, InitiatingProcessPa[0m
[30;1m288 | [0m[35m            | where PowershellCommand !endswith ".ps1" and PowershellCommand !endswith ".exe";[0m
[30;1m289 | [0m[35m        // Filter Powershell cmdlets executed on relevant machine and time period[0m
[30;1m290 | [0m[35m        powershellCommands | where DeviceId == DeviceId and Timestamp between ((timestamp-5min) .. 1[0m
[30;1m291 | [0m[35m        // Filter out common powershell cmdlets[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m274 | [0m[35m        {add_query_items}'[0m
[30;1m275 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Po[0m
[30;1m276 | [0m[35m  uncommon_powershell:[0m
[30;1m277 | [0m[35m    description: Find which uncommon Powershell Cmdlets were executed on that machine in a certain t[0m
[30;1m278 | [0m[35m    metadata:[0m
[30;1m279 | [0m[35m    args:[0m
[30;1m280 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m274 | [0m[35m        {add_query_items}'[0m
[30;1m275 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Po[0m
[30;1m276 | [0m[35m  uncommon_powershell:[0m
[30;1m277 | [0m[35m    description: Find which uncommon Powershell Cmdlets were executed on that machine in a certain t[0m
[30;1m278 | [0m[35m    metadata:[0m
[30;1m279 | [0m[35m    args:[0m
[30;1m280 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m          or ProcessCommandLine has "Start-BitsTransfer"[0m
[30;1m271 | [0m[35m          or ProcessCommandLine has "mpcmdrun.exe"[0m
[30;1m272 | [0m[35m        | project Timestamp, DeviceName, InitiatingProcessFileName, FileName, ProcessCommandLine[0m
[30;1m273 | [0m[35m        | top 100 by Timestamp[0m
[30;1m274 | [0m[35m        {add_query_items}'[0m
[30;1m275 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Po[0m
[30;1m276 | [0m[35m  uncommon_powershell:[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35m        DeviceProcessEvents[0m
[30;1m239 | [0m[35m        | where Timestamp > ago(7d)[0m
[30;1m240 | [0m[35m        | where ProcessCommandLine contains "TVqQAAMAAAAEAAA"[0m
[30;1m241 | [0m[35m        | top 1000 by Timestamp[0m
[30;1m242 | [0m[35m        {add_query_items}'[0m
[30;1m243 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Ba[0m
[30;1m244 | [0m[35m  malware_recycle:[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m        {add_query_items}'[0m
[30;1m232 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Discovery/SM[0m
[30;1m233 | [0m[35m  b64_pe:[0m
[30;1m234 | [0m[35m    description: Finding base64 encoded PE files header seen in the command line parameters[0m
[30;1m235 | [0m[35m    metadata:[0m
[30;1m236 | [0m[35m    args:[0m
[30;1m237 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m        {add_query_items}'[0m
[30;1m219 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Discovery/En[0m
[30;1m220 | [0m[35m  smb_discovery:[0m
[30;1m221 | [0m[35m    description: Query for processes that accessed more than 10 IP addresses over port 445 (SMB) - p[0m
[30;1m222 | [0m[35m    metadata:[0m
[30;1m223 | [0m[35m    args:[0m
[30;1m224 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35mand (ProcessCommandLine contains " /do" or ProcessCommandLine contains " /domain")[0m
[30;1m215 | [0m[35m        | extend Target = extract("(?i)[user|group] (\"*[a-zA-Z0-9-_ ]+\"*)", 1, ProcessCommandLine)[0m
[30;1m216 | [0m[35m        | project AccountName, Target, ProcessCommandLine, DeviceName, Timestamp[0m
[30;1m217 | [0m[35m        | sort by AccountName, Target[0m
[30;1m218 | [0m[35m        {add_query_items}'[0m
[30;1m219 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Discovery/En[0m
[30;1m220 | [0m[35m  smb_discovery:[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m        let alerts =[0m
[30;1m125 | [0m[35m            AlertInfo | join AlertEvidence on AlertId[0m
[30;1m126 | [0m[35m            | summarize (FirstDetectedActivity, Title)=argmin(Timestamp, Title) by AlertId, DeviceId[0m
[30;1m127 | [0m[35m            // Filter alerts that include events from before the queried time period[0m
[30;1m128 | [0m[35m            | where FirstDetectedActivity > minTimeRange;[0m
[30;1m129 | [0m[35m        // Join the two together - looking for alerts that are right after an abnormal network logon[0m
[30;1m130 | [0m[35m        alerts | join kind=inner (outlookLinks) on DeviceId | where FirstDetectedActivity - Timestam[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m          | where[0m
[30;1m114 | [0m[35m              // outlook.exe is the Office Outlook app[0m
[30;1m115 | [0m[35m              InitiatingProcessFileName =~ "outlook.exe"[0m
[30;1m116 | [0m[35m              // RuntimeBroker.exe opens links for all apps from the Windows store, including the Wi[0m
[30;1m117 | [0m[35m              // However, it will also include some links opened from other apps.[0m
[30;1m118 | [0m[35m                  or InitiatingProcessFileName =~ "runtimebroker.exe"[0m
[30;1m119 | [0m[35m            | project Timestamp, DeviceId, DeviceName, RemoteUrl, InitiatingProcessFileName, ParsedU[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m        {add_query_items}'[0m
[30;1m102 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Delivery/Ema[0m
[30;1m103 | [0m[35m  email_link:[0m
[30;1m104 | [0m[35m    description: Look for links opened from mail apps – if a detection occurred right afterwards[0m
[30;1m105 | [0m[35m    metadata:[0m
[30;1m106 | [0m[35m    args:[0m
[30;1m107 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m                    | project DeviceName, ActivityId=extractjson("$.ActivityId", AdditionalFields, t[0m
[30;1m83 | [0m[35m                on DeviceName, ActivityId[0m
[30;1m84 | [0m[35m          | project-away ActivityId;[0m
[30;1m85 | [0m[35m        // Query for links opened from outlook, that are close in time to a SmartScreen warning[0m
[30;1m86 | [0m[35m        let emailLinksNearSmartScreenWarnings =[0m
[30;1m87 | [0m[35m            DeviceEvents[0m
[30;1m88 | [0m[35m            | where ActionType == "BrowserLaunchedToOpenUrl" and isnotempty(RemoteUrl) and Initiatin[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m          | where Timestamp > minTimeRange[0m
[30;1m30 | [0m[35m			    // Query for common document file extensions[0m
[30;1m31 | [0m[35m            and (FileName endswith ".docx" or FileName endswith ".docm" or FileName endswith ".doc")[0m
[30;1m32 | [0m[35m			    // Query for files saved from email clients such as the Office Outlook app or the Windows Mai[0m
[30;1m33 | [0m[35m            and InitiatingProcessFileName in~ ("outlook.exe", "hxoutlook.exe")[0m
[30;1m34 | [0m[35m          | summarize AttachmentSaveTime=min(Timestamp) by AttachmentName=FileName, DeviceId;[0m
[30;1m35 | [0m[35m        let browserDownloads =[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/graph_property.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m        if not hasattr(self, storage_name):[0m
[30;1m59 | [0m[35m            return[0m
[30;1m60 | [0m[35m        for edge in self.edges:[0m
[30;1m61 | [0m[35m            if edge.attrs.get("name") == name:[0m
[30;1m62 | [0m[35m                self.edges.remove(edge)[0m
[30;1m63 | [0m[35m                break[0m
[30;1m64 | [0m[35m        delattr(self, storage_name)[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/graph_property.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m        if hasattr(self, storage_name):[0m
[30;1m47 | [0m[35m            delattr(self, storage_name)[0m
[30;1m48 | [0m[35m            for edge in self.edges:[0m
[30;1m49 | [0m[35m                if edge.attrs.get("name") == name:[0m
[30;1m50 | [0m[35m                    self.edges.remove(edge)[0m
[30;1m51 | [0m[35m                    break[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    Subject : str[0m
[30;1m44 | [0m[35m        Subject of the submission mail[0m
[30;1m45 | [0m[35m    ReportType : str[0m
[30;1m46 | [0m[35m        ReportType of the submission mail[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    """[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    SenderIp : str[0m
[30;1m42 | [0m[35m        SenderIp of the submission mail[0m
[30;1m43 | [0m[35m    Subject : str[0m
[30;1m44 | [0m[35m        Subject of the submission mail[0m
[30;1m45 | [0m[35m    ReportType : str[0m
[30;1m46 | [0m[35m        ReportType of the submission mail[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    Sender : str[0m
[30;1m40 | [0m[35m        Sender of the submission mail[0m
[30;1m41 | [0m[35m    SenderIp : str[0m
[30;1m42 | [0m[35m        SenderIp of the submission mail[0m
[30;1m43 | [0m[35m    Subject : str[0m
[30;1m44 | [0m[35m        Subject of the submission mail[0m
[30;1m45 | [0m[35m    ReportType : str[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    Recipient : str[0m
[30;1m38 | [0m[35m        Recipient of the submission mail[0m
[30;1m39 | [0m[35m    Sender : str[0m
[30;1m40 | [0m[35m        Sender of the submission mail[0m
[30;1m41 | [0m[35m    SenderIp : str[0m
[30;1m42 | [0m[35m        SenderIp of the submission mail[0m
[30;1m43 | [0m[35m    Subject : str[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    Timestamp : datetime[0m
[30;1m36 | [0m[35m        The Time stamp when the message is received[0m
[30;1m37 | [0m[35m    Recipient : str[0m
[30;1m38 | [0m[35m        Recipient of the submission mail[0m
[30;1m39 | [0m[35m    Sender : str[0m
[30;1m40 | [0m[35m        Sender of the submission mail[0m
[30;1m41 | [0m[35m    SenderIp : str[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m    NetworkMessageId : str[0m
[30;1m34 | [0m[35m        NetworkMessageId of the submission mail[0m
[30;1m35 | [0m[35m    Timestamp : datetime[0m
[30;1m36 | [0m[35m        The Time stamp when the message is received[0m
[30;1m37 | [0m[35m    Recipient : str[0m
[30;1m38 | [0m[35m        Recipient of the submission mail[0m
[30;1m39 | [0m[35m    Sender : str[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    Submitter : str[0m
[30;1m32 | [0m[35m        Submitter email of the submission mail[0m
[30;1m33 | [0m[35m    NetworkMessageId : str[0m
[30;1m34 | [0m[35m        NetworkMessageId of the submission mail[0m
[30;1m35 | [0m[35m    Timestamp : datetime[0m
[30;1m36 | [0m[35m        The Time stamp when the message is received[0m
[30;1m37 | [0m[35m    Recipient : str[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    SubmissionDate : datetime[0m
[30;1m30 | [0m[35m        SubmissionDate of the submission mail[0m
[30;1m31 | [0m[35m    Submitter : str[0m
[30;1m32 | [0m[35m        Submitter email of the submission mail[0m
[30;1m33 | [0m[35m    NetworkMessageId : str[0m
[30;1m34 | [0m[35m        NetworkMessageId of the submission mail[0m
[30;1m35 | [0m[35m    Timestamp : datetime[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    SubmissionId : str[0m
[30;1m28 | [0m[35m        SubmissionId of the submission mail[0m
[30;1m29 | [0m[35m    SubmissionDate : datetime[0m
[30;1m30 | [0m[35m        SubmissionDate of the submission mail[0m
[30;1m31 | [0m[35m    Submitter : str[0m
[30;1m32 | [0m[35m        Submitter email of the submission mail[0m
[30;1m33 | [0m[35m    NetworkMessageId : str[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m    Attributes[0m
[30;1m26 | [0m[35m    ----------[0m
[30;1m27 | [0m[35m    SubmissionId : str[0m
[30;1m28 | [0m[35m        SubmissionId of the submission mail[0m
[30;1m29 | [0m[35m    SubmissionDate : datetime[0m
[30;1m30 | [0m[35m        SubmissionDate of the submission mail[0m
[30;1m31 | [0m[35m    Submitter : str[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/submission_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m# Licensed under the MIT License. See License.txt in the project root for[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""Submission mail Entity class."""[0m
[30;1m7 | [0m[35mfrom typing import Any, Mapping, Optional[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom ..._version import VERSION[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m        if not filter_value:[0m
[30;1m394 | [0m[35m            continue[0m
[30;1m395 | [0m[35m        source_name = "data_source" if item_name == "data_sources" else item_name[0m
[30;1m396 | [0m[35m        source_val = query_source.metadata.get(source_name)[0m
[30;1m397 | [0m[35m        if isinstance(source_val, list):[0m
[30;1m398 | [0m[35m            match &= bool(filter_value & set(source_val))[0m
[30;1m399 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m        """[0m
[30;1m380 | [0m[35m        return {[0m
[30;1m381 | [0m[35m            query_dict.get(query_name)[0m
[30;1m382 | [0m[35m            for family, query_dict in self.data_families.items()[0m
[30;1m383 | [0m[35m            if query_name in query_dict[0m
[30;1m384 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m                )[0m
[30;1m358 | [0m[35m                if query_container in self.data_families:[0m
[30;1m359 | [0m[35m                    query_path = query_container[0m
[30;1m360 | [0m[35m        query = self.data_families.get(query_path, {}).get(query_name)  # type: ignore[0m
[30;1m361 | [0m[35m        if not query:[0m
[30;1m362 | [0m[35m            raise LookupError(f"Could not find {query_name} in path {query_path}.")[0m
[30;1m363 | [0m[35m        return query[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m                )[0m
[30;1m358 | [0m[35m                if query_container in self.data_families:[0m
[30;1m359 | [0m[35m                    query_path = query_container[0m
[30;1m360 | [0m[35m        query = self.data_families.get(query_path, {}).get(query_name)  # type: ignore[0m
[30;1m361 | [0m[35m        if not query:[0m
[30;1m362 | [0m[35m            raise LookupError(f"Could not find {query_name} in path {query_path}.")[0m
[30;1m363 | [0m[35m        return query[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m                    )[0m
[30;1m300 | [0m[35m                    continue[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m                for env_value in metadata.get("data_environments", []):[0m
[30;1m303 | [0m[35m                    if "." in env_value:[0m
[30;1m304 | [0m[35m                        env_value = env_value.split(".")[1][0m
[30;1m305 | [0m[35m                    environment = DataEnvironment.parse(env_value)[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m                    "name": query_source.name,[0m
[30;1m125 | [0m[35m                    "description": query_source.description,[0m
[30;1m126 | [0m[35m                    "params": " ".join(query_source.params.keys()),[0m
[30;1m127 | [0m[35m                    "table": query_source.params.get("table", {}).get("default", ""),[0m
[30;1m128 | [0m[35m                    "query": query_source.query,[0m
[30;1m129 | [0m[35m                }[0m
[30;1m130 | [0m[35m        return search_props[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m                    "name": query_source.name,[0m
[30;1m125 | [0m[35m                    "description": query_source.description,[0m
[30;1m126 | [0m[35m                    "params": " ".join(query_source.params.keys()),[0m
[30;1m127 | [0m[35m                    "table": query_source.params.get("table", {}).get("default", ""),[0m
[30;1m128 | [0m[35m                    "query": query_source.query,[0m
[30;1m129 | [0m[35m                }[0m
[30;1m130 | [0m[35m        return search_props[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        return data_map[elem_path][0m
[30;1m54 | [0m[35m    # otherwise partition into prefix and name[0m
[30;1m55 | [0m[35m    prefix, _, name = elem_path.rpartition(".")[0m
[30;1m56 | [0m[35m    attrib = data_map.get(prefix)[0m
[30;1m57 | [0m[35m    if isinstance(attrib, dict) and name in attrib:[0m
[30;1m58 | [0m[35m        return attrib[name][0m
[30;1m59 | [0m[35m    raise KeyError(f"'{elem_path}' not found")[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m        self._all_sources.append(source)[0m
[30;1m145 | [0m[35m        for family in source.data_families:[0m
[30;1m146 | [0m[35m            self.data_families[family][source.name] = source[0m
[30;1m147 | [0m[35m            # we want to update any new defaults for the data family[0m
[30;1m148 | [0m[35m            self.data_family_defaults[family].update(source.defaults)[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m            # we also replace the defaults dict in each source with[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m359 | [0m[35m                    query_path = query_container[0m
[30;1m360 | [0m[35m        query = self.data_families.get(query_path, {}).get(query_name)  # type: ignore[0m
[30;1m361 | [0m[35m        if not query:[0m
[30;1m362 | [0m[35m            raise LookupError(f"Could not find {query_name} in path {query_path}.")[0m
[30;1m363 | [0m[35m        return query[0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m    def find_query(self: Self, query_name: str) -> set[QuerySource | None]:[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_store.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m            The folder containing the yaml definition files.[0m
[30;1m268 | [0m[35m        recursive : bool, optional[0m
[30;1m269 | [0m[35m            True to recurse sub-directories[0m
[30;1m270 | [0m[35m            (the default is False, which only reads from the top level)[0m
[30;1m271 | [0m[35m        driver_query_filter : dict[str, Set[str]][0m
[30;1m272 | [0m[35m            A dictionary of query metadata keys and values. This is used[0m
[30;1m273 | [0m[35m            to test each read query to see if it is relevant to the driver[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m630 | [0m[35m        if not val:[0m
[30;1m631 | [0m[35m            continue[0m
[30;1m632 | [0m[35m        if isinstance(val, dict) and "EnvironmentVar" in val:[0m
[30;1m633 | [0m[35m            env_name = val.get("EnvironmentVar")[0m
[30;1m634 | [0m[35m            if not env_name:[0m
[30;1m635 | [0m[35m                mp_errs.append(f"{section}: No environment variable name specified.")[0m
[30;1m636 | [0m[35m            elif env_name not in os.environ:[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35mdef _check_required_key(conf_section, key, sec_path):[0m
[30;1m604 | [0m[35m    if key not in conf_section or not conf_section.get(key):[0m
[30;1m605 | [0m[35m        return f"{sec_path}: Missing or invalid {key}."[0m
[30;1m606 | [0m[35m    return None[0m
[30;1m607 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m549 | [0m[35m        )[0m
[30;1m550 | [0m[35m[0m
[30;1m551 | [0m[35m        mp_errors.extend([0m
[30;1m552 | [0m[35m            _check_env_vars(args_key=p_setting.get("Args"), section=sec_path)[0m
[30;1m553 | [0m[35m        )[0m
[30;1m554 | [0m[35m    return mp_errors, mp_warnings[0m
[30;1m555 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m536 | [0m[35m            continue[0m
[30;1m537 | [0m[35m        if "Args" not in p_setting:[0m
[30;1m538 | [0m[35m            continue[0m
[30;1m539 | [0m[35m        sec_args = p_setting.get("Args")[0m
[30;1m540 | [0m[35m        if not sec_args or not isinstance(sec_args, dict):[0m
[30;1m541 | [0m[35m            mp_errors.append([0m
[30;1m542 | [0m[35m                f"'{section}/{p_name}/{sec_args}' key has no settings or "[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m        ws_id = ws_settings.get("WorkspaceId")[0m
[30;1m518 | [0m[35m        if not (ws_id and is_valid_uuid(ws_id)):[0m
[30;1m519 | [0m[35m            mp_errors.append(f"Invalid GUID for WorkspaceId in {ws} section")[0m
[30;1m520 | [0m[35m        ten_id = ws_settings.get("TenantId")[0m
[30;1m521 | [0m[35m        if not (ten_id and is_valid_uuid(ten_id)):[0m
[30;1m522 | [0m[35m            mp_errors.append(f"Invalid GUID for TenantId in {ws} section")[0m
[30;1m523 | [0m[35m    mp_warnings = ["No default workspace set"] if no_default else [][0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m514 | [0m[35m    for ws, ws_settings in ws_settings.items():[0m
[30;1m515 | [0m[35m        if ws == "Default":[0m
[30;1m516 | [0m[35m            no_default = False[0m
[30;1m517 | [0m[35m        ws_id = ws_settings.get("WorkspaceId")[0m
[30;1m518 | [0m[35m        if not (ws_id and is_valid_uuid(ws_id)):[0m
[30;1m519 | [0m[35m            mp_errors.append(f"Invalid GUID for WorkspaceId in {ws} section")[0m
[30;1m520 | [0m[35m        ten_id = ws_settings.get("TenantId")[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m506 | [0m[35m    if not as_settings:[0m
[30;1m507 | [0m[35m        mp_errors.append("Missing or empty 'AzureSentinel' section")[0m
[30;1m508 | [0m[35m        return mp_errors, mp_warnings[0m
[30;1m509 | [0m[35m    ws_settings = as_settings.get("Workspaces", {})[0m
[30;1m510 | [0m[35m    if not ws_settings:[0m
[30;1m511 | [0m[35m        mp_errors.append("Missing or empty 'Workspaces' key in 'AzureSentinel' section")[0m
[30;1m512 | [0m[35m        return mp_errors, mp_warnings[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m502 | [0m[35mdef _validate_azure_sentinel(mp_config):[0m
[30;1m503 | [0m[35m    mp_errors = [][0m
[30;1m504 | [0m[35m    mp_warnings = [][0m
[30;1m505 | [0m[35m    as_settings = mp_config.get(_AZ_SENTINEL, {})[0m
[30;1m506 | [0m[35m    if not as_settings:[0m
[30;1m507 | [0m[35m        mp_errors.append("Missing or empty 'AzureSentinel' section")[0m
[30;1m508 | [0m[35m        return mp_errors, mp_warnings[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m466 | [0m[35m            section=conf_section,[0m
[30;1m467 | [0m[35m            key_provs=auth_key_providers,[0m
[30;1m468 | [0m[35m        )[0m
[30;1m469 | [0m[35m        if conf_section == _DP_KEY and mp_config.get(conf_section) is None:[0m
[30;1m470 | [0m[35m            continue[0m
[30;1m471 | [0m[35m        mp_errors.extend(prov_errors)[0m
[30;1m472 | [0m[35m        mp_warn.extend(prov_warn)[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m462 | [0m[35m    ][0m
[30;1m463 | [0m[35m    for conf_section in ["TIProviders", "OtherProviders", _DP_KEY]:[0m
[30;1m464 | [0m[35m        prov_errors, prov_warn = _check_provider_settings([0m
[30;1m465 | [0m[35m            mp_config=mp_config.get(conf_section, {}),[0m
[30;1m466 | [0m[35m            section=conf_section,[0m
[30;1m467 | [0m[35m            key_provs=auth_key_providers,[0m
[30;1m468 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m            if sec_name in data_providers:[0m
[30;1m368 | [0m[35m                continue[0m
[30;1m369 | [0m[35m            data_providers[sec_name] = {"Args": prov_settings}[0m
[30;1m370 | [0m[35m    az_cli_config = mp_config.get(_AZ_CLI)[0m
[30;1m371 | [0m[35m    if az_cli_config and _AZ_CLI not in data_providers:[0m
[30;1m372 | [0m[35m        data_providers[_AZ_CLI] = mp_config[_AZ_CLI][0m
[30;1m373 | [0m[35m    return mp_config[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m    data_providers = mp_config[_DP_KEY][0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m    az_sent_config = mp_config.get(_AZ_SENTINEL)[0m
[30;1m364 | [0m[35m    if az_sent_config and az_sent_config.get("Workspaces"):[0m
[30;1m365 | [0m[35m        for section, prov_settings in mp_config[_AZ_SENTINEL]["Workspaces"].items():[0m
[30;1m366 | [0m[35m            sec_name = f"{_AZ_SENTINEL}_{section}"[0m
[30;1m367 | [0m[35m            if sec_name in data_providers:[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m        mp_config[_DP_KEY] = {}[0m
[30;1m361 | [0m[35m    data_providers = mp_config[_DP_KEY][0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m    az_sent_config = mp_config.get(_AZ_SENTINEL)[0m
[30;1m364 | [0m[35m    if az_sent_config and az_sent_config.get("Workspaces"):[0m
[30;1m365 | [0m[35m        for section, prov_settings in mp_config[_AZ_SENTINEL]["Workspaces"].items():[0m
[30;1m366 | [0m[35m            sec_name = f"{_AZ_SENTINEL}_{section}"[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35mdef _create_data_providers(mp_config: Dict[str, Any]) -> Dict[str, Any]:[0m
[30;1m359 | [0m[35m    if mp_config.get(_DP_KEY) is None:[0m
[30;1m360 | [0m[35m        mp_config[_DP_KEY] = {}[0m
[30;1m361 | [0m[35m    data_providers = mp_config[_DP_KEY][0m
[30;1m362 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35mdef _get_custom_config():[0m
[30;1m333 | [0m[35m    config_path = os.environ.get(_CONFIG_ENV_VAR, None)[0m
[30;1m334 | [0m[35m    if config_path and Path(config_path).is_file():[0m
[30;1m335 | [0m[35m        _CURRENT_CONF_FILE(str(Path(config_path).resolve()))[0m
[30;1m336 | [0m[35m        return _read_config_file(current_config_path())[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m    for c_key, c_item in new_config.items():[0m
[30;1m287 | [0m[35m        if c_item is None:[0m
[30;1m288 | [0m[35m            continue[0m
[30;1m289 | [0m[35m        if isinstance(base_config.get(c_key), (dict, SettingsDict)):[0m
[30;1m290 | [0m[35m            _override_config(base_config[c_key], new_config[c_key])[0m
[30;1m291 | [0m[35m        else:[0m
[30;1m292 | [0m[35m            base_config[c_key] = new_config[c_key][0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m            current_value = cur_node[elem][0m
[30;1m237 | [0m[35m            del cur_node[elem][0m
[30;1m238 | [0m[35m            break[0m
[30;1m239 | [0m[35m        cur_node = cur_node.get(elem, None)[0m
[30;1m240 | [0m[35m        if cur_node is None:[0m
[30;1m241 | [0m[35m            raise KeyError(f"{elem} value of {setting_path} is not a valid path")[0m
[30;1m242 | [0m[35m    return current_value[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m    # if there are any intermediate missing paths[0m
[30;1m214 | [0m[35m    # and create_path is true, add these.[0m
[30;1m215 | [0m[35m    for elem in path_elems[:-1]:[0m
[30;1m216 | [0m[35m        next_node = cur_node.get(elem)[0m
[30;1m217 | [0m[35m        if next_node is None:[0m
[30;1m218 | [0m[35m            if create_path:[0m
[30;1m219 | [0m[35m                cur_node[elem] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m    path_elems = setting_path.split(".")[0m
[30;1m165 | [0m[35m    cur_node = settings_dict[0m
[30;1m166 | [0m[35m    for elem in path_elems:[0m
[30;1m167 | [0m[35m        cur_node = cur_node.get(elem, None)[0m
[30;1m168 | [0m[35m        if cur_node is None:[0m
[30;1m169 | [0m[35m            raise KeyError(f"{elem} value of {setting_path} is not a valid path")[0m
[30;1m170 | [0m[35m    return cur_node[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m    def get(self, key, default=None):[0m
[30;1m61 | [0m[35m        """Get item with aliasing."""[0m
[30;1m62 | [0m[35m        key = self._ALIASES.get(key, key)[0m
[30;1m63 | [0m[35m        return super().get(key, default)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m# pylint: disable=invalid-name[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    def get(self, key, default=None):[0m
[30;1m61 | [0m[35m        """Get item with aliasing."""[0m
[30;1m62 | [0m[35m        key = self._ALIASES.get(key, key)[0m
[30;1m63 | [0m[35m        return super().get(key, default)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def __setitem__(self, key, value):[0m
[30;1m56 | [0m[35m        """Set item with aliasing."""[0m
[30;1m57 | [0m[35m        key = self._ALIASES.get(key, key)[0m
[30;1m58 | [0m[35m        super().__setitem__(key, value)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    def get(self, key, default=None):[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    def __getitem__(self, key):[0m
[30;1m51 | [0m[35m        """Get item with aliasing."""[0m
[30;1m52 | [0m[35m        key = self._ALIASES.get(key, key)[0m
[30;1m53 | [0m[35m        return super().__getitem__(key)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def __setitem__(self, key, value):[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m142 | [0m[35m    Returns[0m
[30;1m143 | [0m[35m    -------[0m
[30;1m144 | [0m[35m    Any[0m
[30;1m145 | [0m[35m        The item at the path location.[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    Exceptions[0m
[30;1m148 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m636 | [0m[35m            elif env_name not in os.environ:[0m
[30;1m637 | [0m[35m                mp_errs.append(f"{section}: Env variable {env_name} not set.")[0m
[30;1m638 | [0m[35m            elif not os.environ[env_name]:[0m
[30;1m639 | [0m[35m                mp_errs.append(f"{section}: Env variable {env_name} value is not set.")[0m
[30;1m640 | [0m[35m    return mp_errs[0m
[30;1m641 | [0m[35m[0m
[30;1m642 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m634 | [0m[35m            if not env_name:[0m
[30;1m635 | [0m[35m                mp_errs.append(f"{section}: No environment variable name specified.")[0m
[30;1m636 | [0m[35m            elif env_name not in os.environ:[0m
[30;1m637 | [0m[35m                mp_errs.append(f"{section}: Env variable {env_name} not set.")[0m
[30;1m638 | [0m[35m            elif not os.environ[env_name]:[0m
[30;1m639 | [0m[35m                mp_errs.append(f"{section}: Env variable {env_name} value is not set.")[0m
[30;1m640 | [0m[35m    return mp_errs[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m389 | [0m[35m        "msticpy.http_timeout", get_config("http_timeout", None)[0m
[30;1m390 | [0m[35m    )[0m
[30;1m391 | [0m[35m    timeout_params: Union[int, Dict, httpx.Timeout, List[Union[float, None]], Tuple] = ([0m
[30;1m392 | [0m[35m        timeout or def_timeout or config_timeout[0m
[30;1m393 | [0m[35m    )[0m
[30;1m394 | [0m[35m    if isinstance(timeout_params, dict):[0m
[30;1m395 | [0m[35m        timeout_params = {[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m383 | [0m[35m    def_timeout: Optional[int] = None,[0m
[30;1m384 | [0m[35m    **kwargs,[0m
[30;1m385 | [0m[35m) -> httpx.Timeout:[0m
[30;1m386 | [0m[35m    """Return timeout from settings or overridden in `kwargs`."""[0m
[30;1m387 | [0m[35m    del kwargs[0m
[30;1m388 | [0m[35m    config_timeout: Union[int, Dict, httpx.Timeout, List, Tuple] = get_config([0m
[30;1m389 | [0m[35m        "msticpy.http_timeout", get_config("http_timeout", None)[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m317 | [0m[35m            return _read_config_file(config_path) if config_path.exists() else {}[0m
[30;1m318 | [0m[35m    except ModuleNotFoundError as mod_err:[0m
[30;1m319 | [0m[35m        # if all else fails we try to find the package default config somewhere[0m
[30;1m320 | [0m[35m        # in the package tree - we use the first one we find[0m
[30;1m321 | [0m[35m        pkg_root: Optional[Path] = _get_pkg_path("msticpy")[0m
[30;1m322 | [0m[35m        if not pkg_root:[0m
[30;1m323 | [0m[35m            raise MsticpyUserConfigError([0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m316 | [0m[35m        with package_path as config_path:[0m
[30;1m317 | [0m[35m            return _read_config_file(config_path) if config_path.exists() else {}[0m
[30;1m318 | [0m[35m    except ModuleNotFoundError as mod_err:[0m
[30;1m319 | [0m[35m        # if all else fails we try to find the package default config somewhere[0m
[30;1m320 | [0m[35m        # in the package tree - we use the first one we find[0m
[30;1m321 | [0m[35m        pkg_root: Optional[Path] = _get_pkg_path("msticpy")[0m
[30;1m322 | [0m[35m        if not pkg_root:[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/pkg_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m    Returns[0m
[30;1m189 | [0m[35m    -------[0m
[30;1m190 | [0m[35m    Any :[0m
[30;1m191 | [0m[35m        The current settings node with new value.[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    Exceptions[0m
[30;1m194 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/exceptions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m            kw_val for kw_arg, kw_val in kwargs.items() if kw_arg.endswith("_uri")[0m
[30;1m115 | [0m[35m        ][0m
[30;1m116 | [0m[35m        if help_args:[0m
[30;1m117 | [0m[35m            self._output.append("You can find other related help here:")[0m
[30;1m118 | [0m[35m            self._output.extend((uri, "uri") for uri in help_args)[0m
[30;1m119 | [0m[35m        self._context: list[str] = self._format_exception_context([0m
[30;1m120 | [0m[35m            stack=traceback.format_stack(limit=5),[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m553 | [0m[35m            }[0m
[30;1m554 | [0m[35m        for key in replace_keys:[0m
[30;1m555 | [0m[35m            if key in replace_keys:[0m
[30;1m556 | [0m[35m                replacement = replace_values.get(key, "")[0m
[30;1m557 | [0m[35m                self._query = self._query.replace(f"$<{key}>$", replacement)[0m
[30;1m558 | [0m[35m        self._query = re.sub("\n{2,}", "\n", self._query)[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m548 | [0m[35m        replace_values = {}[0m
[30;1m549 | [0m[35m        if "query_macros" in self._source:[0m
[30;1m550 | [0m[35m            replace_values = {[0m
[30;1m551 | [0m[35m                name: properties.get("value", "")[0m
[30;1m552 | [0m[35m                for name, properties in self["query_macros"].items()[0m
[30;1m553 | [0m[35m            }[0m
[30;1m554 | [0m[35m        for key in replace_keys:[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m458 | [0m[35m            param_block.extend([0m
[30;1m459 | [0m[35m                ([0m
[30;1m460 | [0m[35m                    f'{p_name}: {p_props.get("type", "Any")}{optional}',[0m
[30;1m461 | [0m[35m                    f'    {p_props.get("description", "no description")}',[0m
[30;1m462 | [0m[35m                )[0m
[30;1m463 | [0m[35m            )[0m
[30;1m464 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m457 | [0m[35m                def_value = None[0m
[30;1m458 | [0m[35m            param_block.extend([0m
[30;1m459 | [0m[35m                ([0m
[30;1m460 | [0m[35m                    f'{p_name}: {p_props.get("type", "Any")}{optional}',[0m
[30;1m461 | [0m[35m                    f'    {p_props.get("description", "no description")}',[0m
[30;1m462 | [0m[35m                )[0m
[30;1m463 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m        )[0m
[30;1m398 | [0m[35m        # Use relative delta to build the timedelta based on the units[0m
[30;1m399 | [0m[35m        # in the time range expression[0m
[30;1m400 | [0m[35m        unit_param = RD_UNIT_MAP.get(tm_unit, "days")[0m
[30;1m401 | [0m[35m        # expand dict to args for relativedelta[0m
[30;1m402 | [0m[35m        return relativedelta(**({unit_param: tm_val}))  # type: ignore[0m
[30;1m403 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m376 | [0m[35m            if not round_down:[0m
[30;1m377 | [0m[35m                # Use dateutil relativedelta to add one to whatever rounding[0m
[30;1m378 | [0m[35m                # unit was specified[0m
[30;1m379 | [0m[35m                units = RD_UNIT_MAP.get(round_item or "d", "days")[0m
[30;1m380 | [0m[35m                # expand dict to args for relativedelta[0m
[30;1m381 | [0m[35m                result_date = result_date + relativedelta([0m
[30;1m382 | [0m[35m                    **({units: +1})  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m    def _format_parameter(self, p_name, param_dict, param_settings, formatters):[0m
[30;1m277 | [0m[35m        # The parameter may need custom formatting[0m
[30;1m278 | [0m[35m        fmt_template = param_settings.get("format", None)[0m
[30;1m279 | [0m[35m        if fmt_template:[0m
[30;1m280 | [0m[35m            # custom formatting template in the query definition[0m
[30;1m281 | [0m[35m            param_dict[p_name] = fmt_template.format(param_dict[p_name])[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m        """[0m
[30;1m243 | [0m[35m        param_dict = {[0m
[30;1m244 | [0m[35m            name: value.get("default", None) for name, value in self.params.items()[0m
[30;1m245 | [0m[35m        }[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m        param_dict.update(self.resolve_param_aliases(kwargs))[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m        path_elems = key.split(".")[0m
[30;1m127 | [0m[35m        cur_node = self._source[0m
[30;1m128 | [0m[35m        for elem in path_elems:[0m
[30;1m129 | [0m[35m            cur_node = cur_node.get(elem, None)[0m
[30;1m130 | [0m[35m            if cur_node is None:[0m
[30;1m131 | [0m[35m                raise KeyError(f"{elem} value of {key} is not a valid path")[0m
[30;1m132 | [0m[35m        return cur_node[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m        # add an empty dict in case neither has defined params[0m
[30;1m108 | [0m[35m        self.params = collapse_dicts([0m
[30;1m109 | [0m[35m            self.defaults.get("parameters", {}),[0m
[30;1m110 | [0m[35m            self._source.get("parameters", {}),[0m
[30;1m111 | [0m[35m        )[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        self._query: str = self["args.query"][0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m        # higher priority than default[0m
[30;1m107 | [0m[35m        # add an empty dict in case neither has defined params[0m
[30;1m108 | [0m[35m        self.params = collapse_dicts([0m
[30;1m109 | [0m[35m            self.defaults.get("parameters", {}),[0m
[30;1m110 | [0m[35m            self._source.get("parameters", {}),[0m
[30;1m111 | [0m[35m        )[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m        self.metadata = collapse_dicts([0m
[30;1m101 | [0m[35m            self._global_metadata,[0m
[30;1m102 | [0m[35m            self.defaults.get("metadata", {}),[0m
[30;1m103 | [0m[35m            self._source.get("metadata", {}),[0m
[30;1m104 | [0m[35m        )[0m
[30;1m105 | [0m[35m        # make ChainMap for parameters from with source[0m
[30;1m106 | [0m[35m        # higher priority than default[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m        # add an empty dict in case neither has defined params[0m
[30;1m100 | [0m[35m        self.metadata = collapse_dicts([0m
[30;1m101 | [0m[35m            self._global_metadata,[0m
[30;1m102 | [0m[35m            self.defaults.get("metadata", {}),[0m
[30;1m103 | [0m[35m            self._source.get("metadata", {}),[0m
[30;1m104 | [0m[35m        )[0m
[30;1m105 | [0m[35m        # make ChainMap for parameters from with source[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mdef _value_or_default(src_dict: Dict, prop_name: str, default: Dict):[0m
[30;1m28 | [0m[35m    """Return value from dict or emtpy dict."""[0m
[30;1m29 | [0m[35m    src_value = src_dict.get(prop_name)[0m
[30;1m30 | [0m[35m    return src_value if src_value is not None else default[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m398 | [0m[35m        # Use relative delta to build the timedelta based on the units[0m
[30;1m399 | [0m[35m        # in the time range expression[0m
[30;1m400 | [0m[35m        unit_param = RD_UNIT_MAP.get(tm_unit, "days")[0m
[30;1m401 | [0m[35m        # expand dict to args for relativedelta[0m
[30;1m402 | [0m[35m        return relativedelta(**({unit_param: tm_val}))  # type: ignore[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m377 | [0m[35m                # Use dateutil relativedelta to add one to whatever rounding[0m
[30;1m378 | [0m[35m                # unit was specified[0m
[30;1m379 | [0m[35m                units = RD_UNIT_MAP.get(round_item or "d", "days")[0m
[30;1m380 | [0m[35m                # expand dict to args for relativedelta[0m
[30;1m381 | [0m[35m                result_date = result_date + relativedelta([0m
[30;1m382 | [0m[35m                    **({units: +1})  # type: ignore[0m
[30;1m383 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m398 | [0m[35m        # Use relative delta to build the timedelta based on the units[0m
[30;1m399 | [0m[35m        # in the time range expression[0m
[30;1m400 | [0m[35m        unit_param = RD_UNIT_MAP.get(tm_unit, "days")[0m
[30;1m401 | [0m[35m        # expand dict to args for relativedelta[0m
[30;1m402 | [0m[35m        return relativedelta(**({unit_param: tm_val}))  # type: ignore[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m396 | [0m[35m            m_time.groupdict()["unit"].lower() if m_time.groupdict()["unit"] else "d"[0m
[30;1m397 | [0m[35m        )[0m
[30;1m398 | [0m[35m        # Use relative delta to build the timedelta based on the units[0m
[30;1m399 | [0m[35m        # in the time range expression[0m
[30;1m400 | [0m[35m        unit_param = RD_UNIT_MAP.get(tm_unit, "days")[0m
[30;1m401 | [0m[35m        # expand dict to args for relativedelta[0m
[30;1m402 | [0m[35m        return relativedelta(**({unit_param: tm_val}))  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m    @staticmethod[0m
[30;1m387 | [0m[35m    def _parse_timedelta(time_range: str = "0") -> timedelta:[0m
[30;1m388 | [0m[35m        """Parse time period string and return equivalent timedelta."""[0m
[30;1m389 | [0m[35m        tr_regex = r"(?P<sign>[+\-]?)\s*(?P<value>[\d]+)\s*(?P<unit>([ywdhms]?|mon))"[0m
[30;1m390 | [0m[35m        m_time = re.match(tr_regex, time_range, re.IGNORECASE)[0m
[30;1m391 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m377 | [0m[35m                # Use dateutil relativedelta to add one to whatever rounding[0m
[30;1m378 | [0m[35m                # unit was specified[0m
[30;1m379 | [0m[35m                units = RD_UNIT_MAP.get(round_item or "d", "days")[0m
[30;1m380 | [0m[35m                # expand dict to args for relativedelta[0m
[30;1m381 | [0m[35m                result_date = result_date + relativedelta([0m
[30;1m382 | [0m[35m                    **({units: +1})  # type: ignore[0m
[30;1m383 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m            # Try to parse datetime with dateutil parser[0m
[30;1m315 | [0m[35m            return parse(param_value)[0m
[30;1m316 | [0m[35m        except ParserError:[0m
[30;1m317 | [0m[35m            # If none of these, assume a time delta[0m
[30;1m318 | [0m[35m            return self._calc_timeoffset(str(param_value))[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    def resolve_param_aliases(self, param_dict: Dict[str, Any]) -> Dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m        self._label = kwargs.pop([0m
[30;1m118 | [0m[35m            "description", kwargs.pop("label", "Set query time boundaries")[0m
[30;1m119 | [0m[35m        )[0m
[30;1m120 | [0m[35m        self._time_unit = parse_time_unit(kwargs.get("units", "min"))[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        self.before = kwargs.pop("before", None)[0m
[30;1m123 | [0m[35m        self.after = kwargs.pop("after", None)[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m375 | [0m[35m        self._w_tm_range.min = -self.max_before[0m
[30;1m376 | [0m[35m        self._w_tm_range.max = self.max_after[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m    # end control updates from attributes[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35m    @property[0m
[30;1m381 | [0m[35m    def start(self):[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m354 | [0m[35m[0m
[30;1m355 | [0m[35m    # end - event handlers[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m    # control updates from attributes[0m
[30;1m358 | [0m[35m    def _update_ui_controls(self):[0m
[30;1m359 | [0m[35m        """Update UI controls from attributes."""[0m
[30;1m360 | [0m[35m        self._disable_handlers()[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m335 | [0m[35m            self._w_origin_tm.value = self.origin_time.time().isoformat()[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m    def _time_range_change(self, change):[0m
[30;1m338 | [0m[35m        """Handle change event for time slider control."""[0m
[30;1m339 | [0m[35m        del change[0m
[30;1m340 | [0m[35m        self._update_start_and_end_from_slider()[0m
[30;1m341 | [0m[35m        self.before = abs(self._w_tm_range.value[0])[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m323 | [0m[35m        self._update_start_and_end_from_slider()[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    def _update_origin(self, change):[0m
[30;1m326 | [0m[35m        """Handle change events for origin date and time controls."""[0m
[30;1m327 | [0m[35m        del change[0m
[30;1m328 | [0m[35m        try:[0m
[30;1m329 | [0m[35m            tm_value = datetime.strptime(self._w_origin_tm.value, "%H:%M:%S.%f").time()[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m312 | [0m[35m        self._w_time_unit.unobserve_all()[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m    def _change_time_unit(self, change):[0m
[30;1m315 | [0m[35m        """Handle change event from time unit control."""[0m
[30;1m316 | [0m[35m        # Reset before/after and max buffers to defaults.[0m
[30;1m317 | [0m[35m        unit = change["new"][0m
[30;1m318 | [0m[35m        self._time_unit = parse_time_unit(unit)[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m281 | [0m[35m    # Utility functions[0m
[30;1m282 | [0m[35m    def _infer_time_units(self):[0m
[30;1m283 | [0m[35m        """Infer reasonable time unit from current timespan."""[0m
[30;1m284 | [0m[35m        # If time units not set explicitly, set to something sensible,[0m
[30;1m285 | [0m[35m        # based on start/end times[0m
[30;1m286 | [0m[35m        if abs(self.timespan.period.days) > 1:[0m
[30;1m287 | [0m[35m            self._time_unit = TimeUnit.DAY[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m    # Utility functions[0m
[30;1m282 | [0m[35m    def _infer_time_units(self):[0m
[30;1m283 | [0m[35m        """Infer reasonable time unit from current timespan."""[0m
[30;1m284 | [0m[35m        # If time units not set explicitly, set to something sensible,[0m
[30;1m285 | [0m[35m        # based on start/end times[0m
[30;1m286 | [0m[35m        if abs(self.timespan.period.days) > 1:[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m261 | [0m[35m        else:[0m
[30;1m262 | [0m[35m            self.before = default_before_after(self.before, self._time_unit)[0m
[30;1m263 | [0m[35m            self.after = default_before_after(self.after, self._time_unit)[0m
[30;1m264 | [0m[35m            # Calculate time offsets from origin[0m
[30;1m265 | [0m[35m            self._query_start = self.origin_time - timedelta([0m
[30;1m266 | [0m[35m                0, self.before * self._time_unit.value[0m
[30;1m267 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m        )[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    def _get_time_parameters(self, **kwargs):[0m
[30;1m250 | [0m[35m        """Process different init time parameters from kwargs."""[0m
[30;1m251 | [0m[35m        timespan: TimeSpan = kwargs.pop("timespan", None)[0m
[30;1m252 | [0m[35m        start = kwargs.pop("start", None)[0m
[30;1m253 | [0m[35m        end = kwargs.pop("end", None)[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m        start : Union[datetime, str][0m
[30;1m219 | [0m[35m            Start time - (must specify `end`)[0m
[30;1m220 | [0m[35m        end : Union[datetime, str][0m
[30;1m221 | [0m[35m            Start time - (must also specify `end`)[0m
[30;1m222 | [0m[35m        timespan : TimeSpan[0m
[30;1m223 | [0m[35m            TimeSpan for query time.[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m        Parameters[0m
[30;1m217 | [0m[35m        ----------[0m
[30;1m218 | [0m[35m        start : Union[datetime, str][0m
[30;1m219 | [0m[35m            Start time - (must specify `end`)[0m
[30;1m220 | [0m[35m        end : Union[datetime, str][0m
[30;1m221 | [0m[35m            Start time - (must also specify `end`)[0m
[30;1m222 | [0m[35m        timespan : TimeSpan[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m        end: Union[datetime, str, None] = None,[0m
[30;1m212 | [0m[35m    ):[0m
[30;1m213 | [0m[35m        """[0m
[30;1m214 | [0m[35m        Change the time attributes.[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m        Parameters[0m
[30;1m217 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m        )[0m
[30;1m192 | [0m[35m        self._w_end_time_txt = widgets.Text([0m
[30;1m193 | [0m[35m            value=self._query_end.isoformat(sep=" "),[0m
[30;1m194 | [0m[35m            description="Query end time (UTC) :  ",[0m
[30;1m195 | [0m[35m            layout=Layout(width="50%"),[0m
[30;1m196 | [0m[35m            style=self._label_style,[0m
[30;1m197 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m        self._w_start_time_txt = widgets.Text([0m
[30;1m187 | [0m[35m            value=self._query_start.isoformat(sep=" "),[0m
[30;1m188 | [0m[35m            description="Query start time (UTC):",[0m
[30;1m189 | [0m[35m            layout=Layout(width="50%"),[0m
[30;1m190 | [0m[35m            style=self._label_style,[0m
[30;1m191 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m        """[0m
[30;1m116 | [0m[35m        check_kwargs(kwargs, self._ALLOWED_KWARGS)[0m
[30;1m117 | [0m[35m        self._label = kwargs.pop([0m
[30;1m118 | [0m[35m            "description", kwargs.pop("label", "Set query time boundaries")[0m
[30;1m119 | [0m[35m        )[0m
[30;1m120 | [0m[35m        self._time_unit = parse_time_unit(kwargs.get("units", "min"))[0m
[30;1m121 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        max_after : int, optional[0m
[30;1m105 | [0m[35m            The largest value for `after` (the default varies based on the unit)[0m
[30;1m106 | [0m[35m        units : str, optional[0m
[30;1m107 | [0m[35m            Time unit (the default is 'hour')[0m
[30;1m108 | [0m[35m            Permissable values are 'day', 'hour', 'minute', 'second',[0m
[30;1m109 | [0m[35m            'week'[0m
[30;1m110 | [0m[35m            These can all be abbreviated down to initial characters[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m            End of query time - alternative to specifying origin,[0m
[30;1m98 | [0m[35m            before, after[0m
[30;1m99 | [0m[35m        timespan : TimeSpan[0m
[30;1m100 | [0m[35m            TimeSpan of query time - alternative to specifying origin,[0m
[30;1m101 | [0m[35m            before, after[0m
[30;1m102 | [0m[35m        max_before : int, optional[0m
[30;1m103 | [0m[35m            The largest value for `before` (the default varies based on the unit)[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m            Start of query time - alternative to specifying origin,[0m
[30;1m95 | [0m[35m            before, after[0m
[30;1m96 | [0m[35m        end : Union[datetime, str][0m
[30;1m97 | [0m[35m            End of query time - alternative to specifying origin,[0m
[30;1m98 | [0m[35m            before, after[0m
[30;1m99 | [0m[35m        timespan : TimeSpan[0m
[30;1m100 | [0m[35m            TimeSpan of query time - alternative to specifying origin,[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m            The default number of `units` after the `origin_time`[0m
[30;1m92 | [0m[35m            (the default varies based on the unit)[0m
[30;1m93 | [0m[35m        start : Union[datetime, str][0m
[30;1m94 | [0m[35m            Start of query time - alternative to specifying origin,[0m
[30;1m95 | [0m[35m            before, after[0m
[30;1m96 | [0m[35m        end : Union[datetime, str][0m
[30;1m97 | [0m[35m            End of query time - alternative to specifying origin,[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m            The origin time (the default is `datetime.utcnow()`)[0m
[30;1m83 | [0m[35m        description : str, optional[0m
[30;1m84 | [0m[35m            The description to display[0m
[30;1m85 | [0m[35m            (the default is 'Select time ({units}) to look back')[0m
[30;1m86 | [0m[35m            label is an alias for this parameter[0m
[30;1m87 | [0m[35m        before : int, optional[0m
[30;1m88 | [0m[35m            The default number of `units` before the `origin_time`[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m        Parameters[0m
[30;1m80 | [0m[35m        ----------[0m
[30;1m81 | [0m[35m        origin_time : datetime, optional[0m
[30;1m82 | [0m[35m            The origin time (the default is `datetime.utcnow()`)[0m
[30;1m83 | [0m[35m        description : str, optional[0m
[30;1m84 | [0m[35m            The description to display[0m
[30;1m85 | [0m[35m            (the default is 'Select time ({units}) to look back')[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/query_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    """[0m
[30;1m32 | [0m[35m    QueryTime.[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    Composite widget to capture date and time origin[0m
[30;1m35 | [0m[35m    and set start and end times for queries.[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    See Also[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m        )[0m
[30;1m331 | [0m[35m        raise NotImplementedError(err_msg)[0m
[30;1m332 | [0m[35m    if "EnvironmentVar" in config_setting:[0m
[30;1m333 | [0m[35m        env_value: str | None = os.environ.get(config_setting["EnvironmentVar"])[0m
[30;1m334 | [0m[35m        if not env_value:[0m
[30;1m335 | [0m[35m            warnings.warn([0m
[30;1m336 | [0m[35m                f"Environment variable {config_setting['EnvironmentVar']}"[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m    for arg_name, arg_value in section_settings.items():[0m
[30;1m283 | [0m[35m        target_name: str = arg_name[0m
[30;1m284 | [0m[35m        if name_map:[0m
[30;1m285 | [0m[35m            target_name = name_map.get(target_name.casefold(), target_name)[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m        try:[0m
[30;1m288 | [0m[35m            setting_dict[target_name] = _fetch_secret_setting([0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m    """Return a potentially protected setting value."""[0m
[30;1m229 | [0m[35m    config_settings = get_config(config_path)[0m
[30;1m230 | [0m[35m    prov_args = _get_protected_settings(config_path, config_settings)[0m
[30;1m231 | [0m[35m    return prov_args.get(setting_name)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35mdef _get_setting_args([0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m                prov_args=prov_args,[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            primary=item_settings.get("Primary", False),[0m
[30;1m152 | [0m[35m            provider=item_settings.get("Provider", provider),[0m
[30;1m153 | [0m[35m        )[0m
[30;1m154 | [0m[35m        settings[provider] = prov_settings[0m
[30;1m155 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m                provider_name=provider,[0m
[30;1m149 | [0m[35m                prov_args=prov_args,[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            primary=item_settings.get("Primary", False),[0m
[30;1m152 | [0m[35m            provider=item_settings.get("Provider", provider),[0m
[30;1m153 | [0m[35m        )[0m
[30;1m154 | [0m[35m        settings[provider] = prov_settings[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m        prov_args = item_settings.get("Args")[0m
[30;1m143 | [0m[35m        prov_settings = ProviderSettings(  # type: ignore[call-arg][0m
[30;1m144 | [0m[35m            name=provider,[0m
[30;1m145 | [0m[35m            description=item_settings.get("Description"),[0m
[30;1m146 | [0m[35m            args=_get_setting_args([0m
[30;1m147 | [0m[35m                config_path=config_section,[0m
[30;1m148 | [0m[35m                provider_name=provider,[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m    settings = {}[0m
[30;1m141 | [0m[35m    for provider, item_settings in section_settings.items():[0m
[30;1m142 | [0m[35m        prov_args = item_settings.get("Args")[0m
[30;1m143 | [0m[35m        prov_settings = ProviderSettings(  # type: ignore[call-arg][0m
[30;1m144 | [0m[35m            name=provider,[0m
[30;1m145 | [0m[35m            description=item_settings.get("Description"),[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/provider_settings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m        Possible options are:[0m
[30;1m190 | [0m[35m        - "env" - to get authentication details from environment variables[0m
[30;1m191 | [0m[35m        - "cli" - to use Azure CLI authentication details[0m
[30;1m192 | [0m[35m        - "msi" - to user Managed Service Identity details[0m
[30;1m193 | [0m[35m        - "interactive" - to prompt for interactive login[0m
[30;1m194 | [0m[35m        - "vscode" - to use VSCode credentials[0m
[30;1m195 | [0m[35m        - "powershell" - to use PowerShell credentials[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/security_graph_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m        }[0m
[30;1m47 | [0m[35m        login_endpoint = az_cloud_config.authority_uri[0m
[30;1m48 | [0m[35m        self.oauth_url = f"{login_endpoint}{{tenantId}}/oauth2/v2.0/token"[0m
[30;1m49 | [0m[35m        self.api_ver = kwargs.get("api_ver", "v1.0")[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        if connection_str:[0m
[30;1m52 | [0m[35m            self.current_connection = connection_str[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/security_graph_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m38 | [0m[35m        az_cloud_config = AzureCloudConfig(cloud=kwargs.pop("cloud", None))[0m
[30;1m39 | [0m[35m        self.scopes = ["User.Read"][0m
[30;1m40 | [0m[35m        self.api_root = az_cloud_config.endpoints.get("microsoftGraphResourceId")[0m
[30;1m41 | [0m[35m        self.req_body = {[0m
[30;1m42 | [0m[35m            "client_id": None,[0m
[30;1m43 | [0m[35m            "client_secret": None,[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/progress.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m        new_total : int, optional[0m
[30;1m81 | [0m[35m            New total, by default 0[0m
[30;1m82 | [0m[35m        delta : int, optional[0m
[30;1m83 | [0m[35m            Increment to update current total, by default 0[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        """[0m
[30;1m86 | [0m[35m        if new_total:[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/progress.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    def update_progress(self, new_total: int = 0, delta: int = 0):[0m
[30;1m75 | [0m[35m        """[0m
[30;1m76 | [0m[35m        Update progress UI by increment or new total.[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        Parameters[0m
[30;1m79 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1104 | [0m[35m        query_text = qm.get("query_by_user") if "query_by_user" in qm else None[0m
[30;1m1105 | [0m[35m        if query_text is None:[0m
[30;1m1106 | [0m[35m            raise ValueError("Missing required 'query_by_user' in query metadata.")[0m
[30;1m1107 | [0m[35m        query_endpoint = qm.get("endpoint") if "endpoint" in qm else None[0m
[30;1m1108 | [0m[35m        if query_endpoint:[0m
[30;1m1109 | [0m[35m            kwargs.update([0m
[30;1m1110 | [0m[35m                {[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1101 | [0m[35m        amount = qm.get("amount") if "amount" in qm else None[0m
[30;1m1102 | [0m[35m        start_abs = qm.get("start_time") if "start_time" in qm else None[0m
[30;1m1103 | [0m[35m        end_abs = qm.get("end_time") if "end_time" in qm else None[0m
[30;1m1104 | [0m[35m        query_text = qm.get("query_by_user") if "query_by_user" in qm else None[0m
[30;1m1105 | [0m[35m        if query_text is None:[0m
[30;1m1106 | [0m[35m            raise ValueError("Missing required 'query_by_user' in query metadata.")[0m
[30;1m1107 | [0m[35m        query_endpoint = qm.get("endpoint") if "endpoint" in qm else None[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1100 | [0m[35m        unit = qm.get("unit") if "unit" in qm else None[0m
[30;1m1101 | [0m[35m        amount = qm.get("amount") if "amount" in qm else None[0m
[30;1m1102 | [0m[35m        start_abs = qm.get("start_time") if "start_time" in qm else None[0m
[30;1m1103 | [0m[35m        end_abs = qm.get("end_time") if "end_time" in qm else None[0m
[30;1m1104 | [0m[35m        query_text = qm.get("query_by_user") if "query_by_user" in qm else None[0m
[30;1m1105 | [0m[35m        if query_text is None:[0m
[30;1m1106 | [0m[35m            raise ValueError("Missing required 'query_by_user' in query metadata.")[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1099 | [0m[35m        # Explicitly check for each key; if present, retrieve the value, otherwise assign None.[0m
[30;1m1100 | [0m[35m        unit = qm.get("unit") if "unit" in qm else None[0m
[30;1m1101 | [0m[35m        amount = qm.get("amount") if "amount" in qm else None[0m
[30;1m1102 | [0m[35m        start_abs = qm.get("start_time") if "start_time" in qm else None[0m
[30;1m1103 | [0m[35m        end_abs = qm.get("end_time") if "end_time" in qm else None[0m
[30;1m1104 | [0m[35m        query_text = qm.get("query_by_user") if "query_by_user" in qm else None[0m
[30;1m1105 | [0m[35m        if query_text is None:[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1098 | [0m[35m        qm = query_obj.get("querymetadata", {})[0m
[30;1m1099 | [0m[35m        # Explicitly check for each key; if present, retrieve the value, otherwise assign None.[0m
[30;1m1100 | [0m[35m        unit = qm.get("unit") if "unit" in qm else None[0m
[30;1m1101 | [0m[35m        amount = qm.get("amount") if "amount" in qm else None[0m
[30;1m1102 | [0m[35m        start_abs = qm.get("start_time") if "start_time" in qm else None[0m
[30;1m1103 | [0m[35m        end_abs = qm.get("end_time") if "end_time" in qm else None[0m
[30;1m1104 | [0m[35m        query_text = qm.get("query_by_user") if "query_by_user" in qm else None[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1097 | [0m[35m            return pd.DataFrame()[0m
[30;1m1098 | [0m[35m        qm = query_obj.get("querymetadata", {})[0m
[30;1m1099 | [0m[35m        # Explicitly check for each key; if present, retrieve the value, otherwise assign None.[0m
[30;1m1100 | [0m[35m        unit = qm.get("unit") if "unit" in qm else None[0m
[30;1m1101 | [0m[35m        amount = qm.get("amount") if "amount" in qm else None[0m
[30;1m1102 | [0m[35m        start_abs = qm.get("start_time") if "start_time" in qm else None[0m
[30;1m1103 | [0m[35m        end_abs = qm.get("end_time") if "end_time" in qm else None[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1095 | [0m[35m        except json.JSONDecodeError as err:[0m
[30;1m1096 | [0m[35m            logger.error("Failed to parse query as JSON: %s", err)[0m
[30;1m1097 | [0m[35m            return pd.DataFrame()[0m
[30;1m1098 | [0m[35m        qm = query_obj.get("querymetadata", {})[0m
[30;1m1099 | [0m[35m        # Explicitly check for each key; if present, retrieve the value, otherwise assign None.[0m
[30;1m1100 | [0m[35m        unit = qm.get("unit") if "unit" in qm else None[0m
[30;1m1101 | [0m[35m        amount = qm.get("amount") if "amount" in qm else None[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1034 | [0m[35m[0m
[30;1m1035 | [0m[35m        # Fetch function from dictionary and execute it[0m
[30;1m1036 | [0m[35m[0m
[30;1m1037 | [0m[35m        query_function = query_methods.get(endpoint)[0m
[30;1m1038 | [0m[35m        if query_function:[0m
[30;1m1039 | [0m[35m            return query_function(query, endpoint, **kwargs)[0m
[30;1m1040 | [0m[35m        # If endpoint is not recognized, raise an error[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m930 | [0m[35m        logger.info("Executing configuration search with query: %s", query)[0m
[30;1m931 | [0m[35m        payload = {"query": query, "limit": 1000, "withResourceJson": True, **kwargs}[0m
[30;1m932 | [0m[35m        data = self._fetch_prisma_data(endpoint, payload, timeout, max_retries)[0m
[30;1m933 | [0m[35m        items = data.get("items", [])[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m        logger.info("Retrieved %d configuration results.", len(items))[0m
[30;1m936 | [0m[35m        return pd.DataFrame(items) if items else pd.DataFrame()[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m925 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m926 | [0m[35m        """[0m
[30;1m927 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m928 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m929 | [0m[35m[0m
[30;1m930 | [0m[35m        logger.info("Executing configuration search with query: %s", query)[0m
[30;1m931 | [0m[35m        payload = {"query": query, "limit": 1000, "withResourceJson": True, **kwargs}[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m924 | [0m[35m            A DataFrame containing the retrieved configuration data.[0m
[30;1m925 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m926 | [0m[35m        """[0m
[30;1m927 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m928 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m929 | [0m[35m[0m
[30;1m930 | [0m[35m        logger.info("Executing configuration search with query: %s", query)[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m860 | [0m[35m        logger.info("Sending request with payload: %s", payload)[0m
[30;1m861 | [0m[35m        data = self._fetch_prisma_data(endpoint, payload, timeout, max_retries)[0m
[30;1m862 | [0m[35m[0m
[30;1m863 | [0m[35m        items = data.get("data", {}).get("items", [])[0m
[30;1m864 | [0m[35m        logger.info("Retrieved %d event records.", len(items))[0m
[30;1m865 | [0m[35m        return pd.DataFrame(items) if items else pd.DataFrame()[0m
[30;1m866 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m860 | [0m[35m        logger.info("Sending request with payload: %s", payload)[0m
[30;1m861 | [0m[35m        data = self._fetch_prisma_data(endpoint, payload, timeout, max_retries)[0m
[30;1m862 | [0m[35m[0m
[30;1m863 | [0m[35m        items = data.get("data", {}).get("items", [])[0m
[30;1m864 | [0m[35m        logger.info("Retrieved %d event records.", len(items))[0m
[30;1m865 | [0m[35m        return pd.DataFrame(items) if items else pd.DataFrame()[0m
[30;1m866 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m843 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m844 | [0m[35m        unit = str(kwargs.get("unit", "day"))[0m
[30;1m845 | [0m[35m        amount = int(kwargs.get("amount", 1))  # type: ignore[arg-type][0m
[30;1m846 | [0m[35m        limit = int(kwargs.get("limit", 5000))  # type: ignore[arg-type][0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m        logger.info("Executing event search with query: %s", query)[0m
[30;1m849 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m842 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m843 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m844 | [0m[35m        unit = str(kwargs.get("unit", "day"))[0m
[30;1m845 | [0m[35m        amount = int(kwargs.get("amount", 1))  # type: ignore[arg-type][0m
[30;1m846 | [0m[35m        limit = int(kwargs.get("limit", 5000))  # type: ignore[arg-type][0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m        logger.info("Executing event search with query: %s", query)[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m841 | [0m[35m        """[0m
[30;1m842 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m843 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m844 | [0m[35m        unit = str(kwargs.get("unit", "day"))[0m
[30;1m845 | [0m[35m        amount = int(kwargs.get("amount", 1))  # type: ignore[arg-type][0m
[30;1m846 | [0m[35m        limit = int(kwargs.get("limit", 5000))  # type: ignore[arg-type][0m
[30;1m847 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m840 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m841 | [0m[35m        """[0m
[30;1m842 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m843 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m844 | [0m[35m        unit = str(kwargs.get("unit", "day"))[0m
[30;1m845 | [0m[35m        amount = int(kwargs.get("amount", 1))  # type: ignore[arg-type][0m
[30;1m846 | [0m[35m        limit = int(kwargs.get("limit", 5000))  # type: ignore[arg-type][0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m839 | [0m[35m            A DataFrame containing the retrieved event data.[0m
[30;1m840 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m841 | [0m[35m        """[0m
[30;1m842 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m843 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m844 | [0m[35m        unit = str(kwargs.get("unit", "day"))[0m
[30;1m845 | [0m[35m        amount = int(kwargs.get("amount", 1))  # type: ignore[arg-type][0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m752 | [0m[35m        limitresult = int(kwargs.get("limit", 10000))  # type: ignore[arg-type][0m
[30;1m753 | [0m[35m        limitpage: int = 1000[0m
[30;1m754 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m
[30;1m755 | [0m[35m        amount = int(kwargs.get("amount", 4))  # type: ignore[arg-type][0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m        logger.info("Executing asset search with query: %s", query)[0m
[30;1m758 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m751 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m752 | [0m[35m        limitresult = int(kwargs.get("limit", 10000))  # type: ignore[arg-type][0m
[30;1m753 | [0m[35m        limitpage: int = 1000[0m
[30;1m754 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m
[30;1m755 | [0m[35m        amount = int(kwargs.get("amount", 4))  # type: ignore[arg-type][0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m        logger.info("Executing asset search with query: %s", query)[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m749 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m750 | [0m[35m        """[0m
[30;1m751 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m752 | [0m[35m        limitresult = int(kwargs.get("limit", 10000))  # type: ignore[arg-type][0m
[30;1m753 | [0m[35m        limitpage: int = 1000[0m
[30;1m754 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m
[30;1m755 | [0m[35m        amount = int(kwargs.get("amount", 4))  # type: ignore[arg-type][0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m748 | [0m[35m            A DataFrame containing the retrieved asset data.[0m
[30;1m749 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m750 | [0m[35m        """[0m
[30;1m751 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m752 | [0m[35m        limitresult = int(kwargs.get("limit", 10000))  # type: ignore[arg-type][0m
[30;1m753 | [0m[35m        limitpage: int = 1000[0m
[30;1m754 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m664 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m665 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m
[30;1m666 | [0m[35m        amount = int(kwargs.get("amount", 4))  # type: ignore[arg-type][0m
[30;1m667 | [0m[35m        cloudtype = str(kwargs.get("cloudtype", "aws"))[0m
[30;1m668 | [0m[35m        base_payload = {[0m
[30;1m669 | [0m[35m            "query": query,[0m
[30;1m670 | [0m[35m            "limit": limitpage,[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m663 | [0m[35m        """[0m
[30;1m664 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m665 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m
[30;1m666 | [0m[35m        amount = int(kwargs.get("amount", 4))  # type: ignore[arg-type][0m
[30;1m667 | [0m[35m        cloudtype = str(kwargs.get("cloudtype", "aws"))[0m
[30;1m668 | [0m[35m        base_payload = {[0m
[30;1m669 | [0m[35m            "query": query,[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m662 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m663 | [0m[35m        """[0m
[30;1m664 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m665 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m
[30;1m666 | [0m[35m        amount = int(kwargs.get("amount", 4))  # type: ignore[arg-type][0m
[30;1m667 | [0m[35m        cloudtype = str(kwargs.get("cloudtype", "aws"))[0m
[30;1m668 | [0m[35m        base_payload = {[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m661 | [0m[35m            A DataFrame containing the retrieved network data.[0m
[30;1m662 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m663 | [0m[35m        """[0m
[30;1m664 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m665 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m
[30;1m666 | [0m[35m        amount = int(kwargs.get("amount", 4))  # type: ignore[arg-type][0m
[30;1m667 | [0m[35m        cloudtype = str(kwargs.get("cloudtype", "aws"))[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m587 | [0m[35m            results.extend(items)[0m
[30;1m588 | [0m[35m            logger.info("📊 Retrieved %d records so far.", len(results))[0m
[30;1m589 | [0m[35m[0m
[30;1m590 | [0m[35m            next_token = data.get("nextPageToken")[0m
[30;1m591 | [0m[35m            if not next_token or len(results) >= limitresult or not items:[0m
[30;1m592 | [0m[35m                logger.info(" No more pages left to fetch.")[0m
[30;1m593 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m509 | [0m[35m        """[0m
[30;1m510 | [0m[35m        items = data[0m
[30;1m511 | [0m[35m        for key in data_key.split("."):[0m
[30;1m512 | [0m[35m            items = items.get(key, {})[0m
[30;1m513 | [0m[35m        return items if isinstance(items, list) else [][0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m    def _paginate_prisma_search([0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m        retries = 0[0m
[30;1m462 | [0m[35m        while retries < max_retries:[0m
[30;1m463 | [0m[35m            try:[0m
[30;1m464 | [0m[35m                response = self.client.post(endpoint, json=payload, timeout=timeout)[0m
[30;1m465 | [0m[35m                response.raise_for_status()[0m
[30;1m466 | [0m[35m                return self._parse_json(response)[0m
[30;1m467 | [0m[35m            except httpx.HTTPStatusError as err:[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m389 | [0m[35m            response.raise_for_status()[0m
[30;1m390 | [0m[35m            result = self._parse_json(response)[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m            if result.get("message") == "login_successful":[0m
[30;1m393 | [0m[35m                self.client.headers["X-Redlock-Auth"] = result["token"][0m
[30;1m394 | [0m[35m                logger.info("Token refreshed successfully.")[0m
[30;1m395 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m        """Refresh the authentication token."""[0m
[30;1m386 | [0m[35m        logger.info("Refreshing authentication token...")[0m
[30;1m387 | [0m[35m        try:[0m
[30;1m388 | [0m[35m            response = self.client.post("/auth_token/extend")[0m
[30;1m389 | [0m[35m            response.raise_for_status()[0m
[30;1m390 | [0m[35m            result = self._parse_json(response)[0m
[30;1m391 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m                    )[0m
[30;1m374 | [0m[35m                return self[0m
[30;1m375 | [0m[35m            logger.error("Login failed: %s", result.get("message", "Unknown error"))[0m
[30;1m376 | [0m[35m            msg = f"Login failed: {result.get('message', 'Unknown error')}"[0m
[30;1m377 | [0m[35m            raise PrismaCloudAuthError(msg)[0m
[30;1m378 | [0m[35m        except httpx.HTTPStatusError as http_err:[0m
[30;1m379 | [0m[35m            self._handle_http_error(http_err)[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m                        "X-Redlock-Auth not in self.client.headers did not match"[0m
[30;1m373 | [0m[35m                    )[0m
[30;1m374 | [0m[35m                return self[0m
[30;1m375 | [0m[35m            logger.error("Login failed: %s", result.get("message", "Unknown error"))[0m
[30;1m376 | [0m[35m            msg = f"Login failed: {result.get('message', 'Unknown error')}"[0m
[30;1m377 | [0m[35m            raise PrismaCloudAuthError(msg)[0m
[30;1m378 | [0m[35m        except httpx.HTTPStatusError as http_err:[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m            result = self._parse_json(response)[0m
[30;1m362 | [0m[35m            logger.debug(result)[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m            if result.get("message") == "login_successful":[0m
[30;1m365 | [0m[35m                logger.debug("manupulating client")[0m
[30;1m366 | [0m[35m                self.client.headers["X-Redlock-Auth"] = result["token"][0m
[30;1m367 | [0m[35m                self._connected = True[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m            logger.debug(msg)[0m
[30;1m354 | [0m[35m        logger.debug("Attempting to authenticate with username=[REDACTED]")[0m
[30;1m355 | [0m[35m        try:[0m
[30;1m356 | [0m[35m            response = self.client.post([0m
[30;1m357 | [0m[35m                "/login",[0m
[30;1m358 | [0m[35m                json={"username": username, "password": password},[0m
[30;1m359 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m            )[0m
[30;1m346 | [0m[35m        if not username or not password:[0m
[30;1m347 | [0m[35m            username = self.config.get("username")[0m
[30;1m348 | [0m[35m            password = self.config.get("password")[0m
[30;1m349 | [0m[35m            if not username or not password:[0m
[30;1m350 | [0m[35m                msg = "Both 'username' and 'password' must be provided."[0m
[30;1m351 | [0m[35m                raise PrismaCloudAuthError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m                else None[0m
[30;1m345 | [0m[35m            )[0m
[30;1m346 | [0m[35m        if not username or not password:[0m
[30;1m347 | [0m[35m            username = self.config.get("username")[0m
[30;1m348 | [0m[35m            password = self.config.get("password")[0m
[30;1m349 | [0m[35m            if not username or not password:[0m
[30;1m350 | [0m[35m                msg = "Both 'username' and 'password' must be provided."[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        self.headers: dict[str, str] = dict([0m
[30;1m214 | [0m[35m            cast([0m
[30;1m215 | [0m[35m                dict[str, str],[0m
[30;1m216 | [0m[35m                kwargs.get([0m
[30;1m217 | [0m[35m                    "headers",[0m
[30;1m218 | [0m[35m                    {[0m
[30;1m219 | [0m[35m                        "User-Agent": "PrismaCloudDriver/1.0",[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        else:[0m
[30;1m209 | [0m[35m            self.base_url = kwargs.get("base_url", BASE_URL_API)  # type: ignore[assignment][0m
[30;1m210 | [0m[35m        self.debug: bool = bool(kwargs.get("debug", False))[0m
[30;1m211 | [0m[35m        self.max_retries: int = int(kwargs.get("max_retries", 3))  # type: ignore[arg-type][0m
[30;1m212 | [0m[35m        self._connected: bool = False[0m
[30;1m213 | [0m[35m        self.headers: dict[str, str] = dict([0m
[30;1m214 | [0m[35m            cast([0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m            )  # type: ignore[assignment][0m
[30;1m208 | [0m[35m        else:[0m
[30;1m209 | [0m[35m            self.base_url = kwargs.get("base_url", BASE_URL_API)  # type: ignore[assignment][0m
[30;1m210 | [0m[35m        self.debug: bool = bool(kwargs.get("debug", False))[0m
[30;1m211 | [0m[35m        self.max_retries: int = int(kwargs.get("max_retries", 3))  # type: ignore[arg-type][0m
[30;1m212 | [0m[35m        self._connected: bool = False[0m
[30;1m213 | [0m[35m        self.headers: dict[str, str] = dict([0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m                cast(str, self.config.get("base_url")) or BASE_URL_API[0m
[30;1m207 | [0m[35m            )  # type: ignore[assignment][0m
[30;1m208 | [0m[35m        else:[0m
[30;1m209 | [0m[35m            self.base_url = kwargs.get("base_url", BASE_URL_API)  # type: ignore[assignment][0m
[30;1m210 | [0m[35m        self.debug: bool = bool(kwargs.get("debug", False))[0m
[30;1m211 | [0m[35m        self.max_retries: int = int(kwargs.get("max_retries", 3))  # type: ignore[arg-type][0m
[30;1m212 | [0m[35m        self._connected: bool = False[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m        # preference 1 as argument , preference 2 from config file , third default value[0m
[30;1m204 | [0m[35m        if not kwargs.get("base_url"):[0m
[30;1m205 | [0m[35m            self.base_url = ([0m
[30;1m206 | [0m[35m                cast(str, self.config.get("base_url")) or BASE_URL_API[0m
[30;1m207 | [0m[35m            )  # type: ignore[assignment][0m
[30;1m208 | [0m[35m        else:[0m
[30;1m209 | [0m[35m            self.base_url = kwargs.get("base_url", BASE_URL_API)  # type: ignore[assignment][0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m        self.timeout: int = int(kwargs.get("timeout", 300))  # type: ignore[arg-type][0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m        # preference 1 as argument , preference 2 from config file , third default value[0m
[30;1m204 | [0m[35m        if not kwargs.get("base_url"):[0m
[30;1m205 | [0m[35m            self.base_url = ([0m
[30;1m206 | [0m[35m                cast(str, self.config.get("base_url")) or BASE_URL_API[0m
[30;1m207 | [0m[35m            )  # type: ignore[assignment][0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m        unknown_keys = set(kwargs) - valid_keys[0m
[30;1m199 | [0m[35m        if unknown_keys:[0m
[30;1m200 | [0m[35m            logger.warning("Unknown configuration keys provided: %s", unknown_keys)[0m
[30;1m201 | [0m[35m        self.timeout: int = int(kwargs.get("timeout", 300))  # type: ignore[arg-type][0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m        # preference 1 as argument , preference 2 from config file , third default value[0m
[30;1m204 | [0m[35m        if not kwargs.get("base_url"):[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m530 | [0m[35m        results into a single list.[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        The method extracts the relevant data using `_process_prisma_response()`[0m
[30;1m533 | [0m[35m        and logs progress at each iteration.[0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m        Parameters[0m
[30;1m536 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1081 | [0m[35m            - "unit": The time unit for the query (e.g., "minute", "hour").[0m
[30;1m1082 | [0m[35m            - "amount": The quantity of the time unit.[0m
[30;1m1083 | [0m[35m            - "start_time": The start of the time range in ISO 8601 format.[0m
[30;1m1084 | [0m[35m            - "end_time": The end of the time range in ISO 8601 format.[0m
[30;1m1085 | [0m[35m            - "query_by_user": The actual query to execute.[0m
[30;1m1086 | [0m[35m            - "endpoint": The target API endpoint for the query.[0m
[30;1m1087 | [0m[35m        - If an error occurs during JSON parsing (a broad exception is caught),[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1080 | [0m[35m        - The method expects the query string to include a "querymetadata" with the following keys:[0m
[30;1m1081 | [0m[35m            - "unit": The time unit for the query (e.g., "minute", "hour").[0m
[30;1m1082 | [0m[35m            - "amount": The quantity of the time unit.[0m
[30;1m1083 | [0m[35m            - "start_time": The start of the time range in ISO 8601 format.[0m
[30;1m1084 | [0m[35m            - "end_time": The end of the time range in ISO 8601 format.[0m
[30;1m1085 | [0m[35m            - "query_by_user": The actual query to execute.[0m
[30;1m1086 | [0m[35m            - "endpoint": The target API endpoint for the query.[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1079 | [0m[35m        -----[0m
[30;1m1080 | [0m[35m        - The method expects the query string to include a "querymetadata" with the following keys:[0m
[30;1m1081 | [0m[35m            - "unit": The time unit for the query (e.g., "minute", "hour").[0m
[30;1m1082 | [0m[35m            - "amount": The quantity of the time unit.[0m
[30;1m1083 | [0m[35m            - "start_time": The start of the time range in ISO 8601 format.[0m
[30;1m1084 | [0m[35m            - "end_time": The end of the time range in ISO 8601 format.[0m
[30;1m1085 | [0m[35m            - "query_by_user": The actual query to execute.[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1078 | [0m[35m        Notes[0m
[30;1m1079 | [0m[35m        -----[0m
[30;1m1080 | [0m[35m        - The method expects the query string to include a "querymetadata" with the following keys:[0m
[30;1m1081 | [0m[35m            - "unit": The time unit for the query (e.g., "minute", "hour").[0m
[30;1m1082 | [0m[35m            - "amount": The quantity of the time unit.[0m
[30;1m1083 | [0m[35m            - "start_time": The start of the time range in ISO 8601 format.[0m
[30;1m1084 | [0m[35m            - "end_time": The end of the time range in ISO 8601 format.[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1055 | [0m[35m[0m
[30;1m1056 | [0m[35m        The method parses the JSON query string and extracts the necessary parameters. If an[0m
[30;1m1057 | [0m[35m        "endpoint" is provided in the query metadata, it updates the keyword arguments with[0m
[30;1m1058 | [0m[35m        the extracted time range values and calls the `direct_execute_query()` method to perform[0m
[30;1m1059 | [0m[35m        the query. If the query string cannot be parsed as valid JSON or the "endpoint" is missing,[0m
[30;1m1060 | [0m[35m        an empty DataFrame is returned.[0m
[30;1m1061 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1019 | [0m[35m        if not query_endpoint or query_endpoint not in self.ENDPOINT_MAP:[0m
[30;1m1020 | [0m[35m            msg = f"Invalid or missing query endpoint: {query_endpoint}"[0m
[30;1m1021 | [0m[35m            raise MsticpyUserError(msg)[0m
[30;1m1022 | [0m[35m        # Find the API endpoint for the given query_source[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m        endpoint: str = self.ENDPOINT_MAP[query_endpoint][0m
[30;1m1025 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m965 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m966 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m967 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`, `"day"`).[0m
[30;1m968 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m969 | [0m[35m[0m
[30;1m970 | [0m[35m        Behavior[0m
[30;1m971 | [0m[35m        --------[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m964 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m965 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m966 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m967 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`, `"day"`).[0m
[30;1m968 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m969 | [0m[35m[0m
[30;1m970 | [0m[35m        Behavior[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m961 | [0m[35m            Options: `"config_resource"`, `"assets"`, `"events"`, `"network"`.[0m
[30;1m962 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m963 | [0m[35m            Additional optional query parameters, such as:[0m
[30;1m964 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m965 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m966 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m967 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`, `"day"`).[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m961 | [0m[35m            Options: `"config_resource"`, `"assets"`, `"events"`, `"network"`.[0m
[30;1m962 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m963 | [0m[35m            Additional optional query parameters, such as:[0m
[30;1m964 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m965 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m966 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m967 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`, `"day"`).[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m924 | [0m[35m            A DataFrame containing the retrieved configuration data.[0m
[30;1m925 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m926 | [0m[35m        """[0m
[30;1m927 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m928 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m929 | [0m[35m[0m
[30;1m930 | [0m[35m        logger.info("Executing configuration search with query: %s", query)[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m888 | [0m[35m            The API endpoint to send the query to.[0m
[30;1m889 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m890 | [0m[35m            Additional optional query parameters:[0m
[30;1m891 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m892 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m893 | [0m[35m            - limit (int): Maximum number of results to retrieve (default: 1000).[0m
[30;1m894 | [0m[35m            - withResourceJson (bool): Whether to include resource JSON details.[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m888 | [0m[35m            The API endpoint to send the query to.[0m
[30;1m889 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m890 | [0m[35m            Additional optional query parameters:[0m
[30;1m891 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m892 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m893 | [0m[35m            - limit (int): Maximum number of results to retrieve (default: 1000).[0m
[30;1m894 | [0m[35m            - withResourceJson (bool): Whether to include resource JSON details.[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m839 | [0m[35m            A DataFrame containing the retrieved event data.[0m
[30;1m840 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m841 | [0m[35m        """[0m
[30;1m842 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m843 | [0m[35m        max_retries = int(kwargs.get("max_retries", self.max_retries))  # type: ignore[arg-type][0m
[30;1m844 | [0m[35m        unit = str(kwargs.get("unit", "day"))[0m
[30;1m845 | [0m[35m        amount = int(kwargs.get("amount", 1))  # type: ignore[arg-type][0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m808 | [0m[35m[0m
[30;1m809 | [0m[35m        Behavior[0m
[30;1m810 | [0m[35m        --------[0m
[30;1m811 | [0m[35m        - Constructs a search payload with the query, time range, and limit.[0m
[30;1m812 | [0m[35m        - Calls `_fetch_prisma_data()` to send the request and retrieve the data.[0m
[30;1m813 | [0m[35m        - Extracts event records from the response and converts them into a Pandas DataFrame.[0m
[30;1m814 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m803 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m804 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m805 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`, `"day"`).[0m
[30;1m806 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m807 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m808 | [0m[35m[0m
[30;1m809 | [0m[35m        Behavior[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m802 | [0m[35m            Additional optional query parameters:[0m
[30;1m803 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m804 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m805 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`, `"day"`).[0m
[30;1m806 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m807 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m808 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m800 | [0m[35m            The API endpoint to send the query to.[0m
[30;1m801 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m802 | [0m[35m            Additional optional query parameters:[0m
[30;1m803 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m804 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m805 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`, `"day"`).[0m
[30;1m806 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m800 | [0m[35m            The API endpoint to send the query to.[0m
[30;1m801 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m802 | [0m[35m            Additional optional query parameters:[0m
[30;1m803 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m804 | [0m[35m            - max_retries (int): Maximum retry attempts for failed requests.[0m
[30;1m805 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`, `"day"`).[0m
[30;1m806 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m        This method retrieves event-related data from Prisma Cloud by executing the[0m
[30;1m789 | [0m[35m        given query against the specified API endpoint. It allows customization of[0m
[30;1m790 | [0m[35m        time range, result limits, and other search parameters.[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m        The function constructs a request payload, sends the API request, and[0m
[30;1m793 | [0m[35m        processes the response into a Pandas DataFrame.[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m748 | [0m[35m            A DataFrame containing the retrieved asset data.[0m
[30;1m749 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m750 | [0m[35m        """[0m
[30;1m751 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m752 | [0m[35m        limitresult = int(kwargs.get("limit", 10000))  # type: ignore[arg-type][0m
[30;1m753 | [0m[35m        limitpage: int = 1000[0m
[30;1m754 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m        Behavior[0m
[30;1m720 | [0m[35m        --------[0m
[30;1m721 | [0m[35m        - Constructs a search payload including query and time range.[0m
[30;1m722 | [0m[35m        - Calls `_paginate_prisma_search()` to retrieve results in multiple pages.[0m
[30;1m723 | [0m[35m        - Converts the retrieved data into a Pandas DataFrame.[0m
[30;1m724 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m714 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m715 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m716 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`).[0m
[30;1m717 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m        Behavior[0m
[30;1m720 | [0m[35m        --------[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m713 | [0m[35m            Additional optional query parameters:[0m
[30;1m714 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m715 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m716 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`).[0m
[30;1m717 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m        Behavior[0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m711 | [0m[35m            The API endpoint to send the query to.[0m
[30;1m712 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m713 | [0m[35m            Additional optional query parameters:[0m
[30;1m714 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m715 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m716 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`).[0m
[30;1m717 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m711 | [0m[35m            The API endpoint to send the query to.[0m
[30;1m712 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m713 | [0m[35m            Additional optional query parameters:[0m
[30;1m714 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m715 | [0m[35m            - limit (int): Maximum number of results to retrieve.[0m
[30;1m716 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`).[0m
[30;1m717 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m700 | [0m[35m        given query against the specified API endpoint. It supports pagination to[0m
[30;1m701 | [0m[35m        efficiently handle large datasets.[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m        The function allows customization of search parameters, such as time range[0m
[30;1m704 | [0m[35m        and request limits, by accepting additional keyword arguments.[0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m        Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m661 | [0m[35m            A DataFrame containing the retrieved network data.[0m
[30;1m662 | [0m[35m            Returns an empty DataFrame if no results are found.[0m
[30;1m663 | [0m[35m        """[0m
[30;1m664 | [0m[35m        timeout = int(kwargs.get("timeout", self.timeout))  # type: ignore[arg-type][0m
[30;1m665 | [0m[35m        unit = str(kwargs.get("unit", "hour"))[0m
[30;1m666 | [0m[35m        amount = int(kwargs.get("amount", 4))  # type: ignore[arg-type][0m
[30;1m667 | [0m[35m        cloudtype = str(kwargs.get("cloudtype", "aws"))[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m631 | [0m[35m[0m
[30;1m632 | [0m[35m        Behavior[0m
[30;1m633 | [0m[35m        --------[0m
[30;1m634 | [0m[35m        - Constructs a search payload including query, time range, and cloud provider filter.[0m
[30;1m635 | [0m[35m        - Calls `_paginate_prisma_search()` to retrieve results in multiple pages.[0m
[30;1m636 | [0m[35m        - Converts the retrieved data into a Pandas DataFrame.[0m
[30;1m637 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m626 | [0m[35m            Additional optional query parameters:[0m
[30;1m627 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m628 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`).[0m
[30;1m629 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m630 | [0m[35m            - cloudtype (str): Cloud provider filter (`"aws"`, `"gcp"`, `"azure"`).[0m
[30;1m631 | [0m[35m[0m
[30;1m632 | [0m[35m        Behavior[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m625 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m626 | [0m[35m            Additional optional query parameters:[0m
[30;1m627 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m628 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`).[0m
[30;1m629 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m630 | [0m[35m            - cloudtype (str): Cloud provider filter (`"aws"`, `"gcp"`, `"azure"`).[0m
[30;1m631 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m624 | [0m[35m            The number of results per page. Defaults to 100.[0m
[30;1m625 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m626 | [0m[35m            Additional optional query parameters:[0m
[30;1m627 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m628 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`).[0m
[30;1m629 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m630 | [0m[35m            - cloudtype (str): Cloud provider filter (`"aws"`, `"gcp"`, `"azure"`).[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m624 | [0m[35m            The number of results per page. Defaults to 100.[0m
[30;1m625 | [0m[35m        **kwargs : QueryArgs[0m
[30;1m626 | [0m[35m            Additional optional query parameters:[0m
[30;1m627 | [0m[35m            - timeout (int): API request timeout in seconds.[0m
[30;1m628 | [0m[35m            - unit (str): Time unit for the query (e.g., `"minute"`, `"hour"`).[0m
[30;1m629 | [0m[35m            - amount (int): Time range quantity in the specified unit.[0m
[30;1m630 | [0m[35m            - cloudtype (str): Cloud provider filter (`"aws"`, `"gcp"`, `"azure"`).[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m609 | [0m[35m        given query against the specified API endpoint. It supports pagination and[0m
[30;1m610 | [0m[35m        processes large datasets efficiently.[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m        The function allows customization of search parameters, such as time range,[0m
[30;1m613 | [0m[35m        cloud provider type, and request limits, by accepting additional keyword arguments.[0m
[30;1m614 | [0m[35m[0m
[30;1m615 | [0m[35m        Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m543 | [0m[35m        limitpage : int[0m
[30;1m544 | [0m[35m            The maximum number of results per request.[0m
[30;1m545 | [0m[35m        timeout : int[0m
[30;1m546 | [0m[35m            The timeout duration for each API request in seconds.[0m
[30;1m547 | [0m[35m        data_key : str[0m
[30;1m548 | [0m[35m            The key path in the API response that contains the relevant data[0m
[30;1m549 | [0m[35m            (e.g., `"data.nodes"`).[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m542 | [0m[35m            The total number of results to retrieve.[0m
[30;1m543 | [0m[35m        limitpage : int[0m
[30;1m544 | [0m[35m            The maximum number of results per request.[0m
[30;1m545 | [0m[35m        timeout : int[0m
[30;1m546 | [0m[35m            The timeout duration for each API request in seconds.[0m
[30;1m547 | [0m[35m        data_key : str[0m
[30;1m548 | [0m[35m            The key path in the API response that contains the relevant data[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m450 | [0m[35m        Behavior[0m
[30;1m451 | [0m[35m        --------[0m
[30;1m452 | [0m[35m        - Sends a POST request to the specified endpoint with the payload.[0m
[30;1m453 | [0m[35m        - Waits for a response within the provided timeout period.[0m
[30;1m454 | [0m[35m        - If the response is successful (status code 200), it parses and returns the JSON data.[0m
[30;1m455 | [0m[35m        - If an HTTP error occurs:[0m
[30;1m456 | [0m[35m            - Retries the request up to `max_retries` times.[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m443 | [0m[35m        payload : dict[str, Any][0m
[30;1m444 | [0m[35m            The request body, typically containing query parameters.[0m
[30;1m445 | [0m[35m        timeout : int[0m
[30;1m446 | [0m[35m            The maximum time (in seconds) to wait for a response.[0m
[30;1m447 | [0m[35m        max_retries : int[0m
[30;1m448 | [0m[35m            The number of times to retry the request in case of failure.[0m
[30;1m449 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m442 | [0m[35m            The Prisma Cloud API endpoint for the request.[0m
[30;1m443 | [0m[35m        payload : dict[str, Any][0m
[30;1m444 | [0m[35m            The request body, typically containing query parameters.[0m
[30;1m445 | [0m[35m        timeout : int[0m
[30;1m446 | [0m[35m            The maximum time (in seconds) to wait for a response.[0m
[30;1m447 | [0m[35m        max_retries : int[0m
[30;1m448 | [0m[35m            The number of times to retry the request in case of failure.[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m    ----------[0m
[30;1m105 | [0m[35m      ENDPOINT_MAP (ClassVar[dict[str, str]]): Maps query sources to their[0m
[30;1m106 | [0m[35m          respective API endpoints.[0m
[30;1m107 | [0m[35m      timeout (int): Timeout for API requests in seconds (default: 300).[0m
[30;1m108 | [0m[35m      base_url (str): Base URL for Prisma Cloud API.[0m
[30;1m109 | [0m[35m      debug (bool): Enables or disables debug logging (default: False).[0m
[30;1m110 | [0m[35m      connected (bool): Tracks authentication status.[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m    ----------[0m
[30;1m105 | [0m[35m      ENDPOINT_MAP (ClassVar[dict[str, str]]): Maps query sources to their[0m
[30;1m106 | [0m[35m          respective API endpoints.[0m
[30;1m107 | [0m[35m      timeout (int): Timeout for API requests in seconds (default: 300).[0m
[30;1m108 | [0m[35m      base_url (str): Base URL for Prisma Cloud API.[0m
[30;1m109 | [0m[35m      debug (bool): Enables or disables debug logging (default: False).[0m
[30;1m110 | [0m[35m      connected (bool): Tracks authentication status.[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    Attributes[0m
[30;1m68 | [0m[35m    ----------[0m
[30;1m69 | [0m[35m        timeout (int, optional): Request timeout in seconds. Default is 300.[0m
[30;1m70 | [0m[35m        base_url (str, optional): Base API URL for Prisma Cloud.[0m
[30;1m71 | [0m[35m        debug (bool, optional): Enable or disable debug mode. Default is False.[0m
[30;1m72 | [0m[35m        max_retries (int, optional): Maximum number of retries for API requests.[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    Attributes[0m
[30;1m68 | [0m[35m    ----------[0m
[30;1m69 | [0m[35m        timeout (int, optional): Request timeout in seconds. Default is 300.[0m
[30;1m70 | [0m[35m        base_url (str, optional): Base API URL for Prisma Cloud.[0m
[30;1m71 | [0m[35m        debug (bool, optional): Enable or disable debug mode. Default is False.[0m
[30;1m72 | [0m[35m        max_retries (int, optional): Maximum number of retries for API requests.[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m    unit : str, optional[0m
[30;1m48 | [0m[35m        The unit of time for the range (e.g., "minute", "hour", "day").[0m
[30;1m49 | [0m[35m    amount : int, optional[0m
[30;1m50 | [0m[35m        The quantity of the time unit for the range.[0m
[30;1m51 | [0m[35m    limit : int, optional[0m
[30;1m52 | [0m[35m        Maximum number of results to return.[0m
[30;1m53 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    end_time : str, optional[0m
[30;1m46 | [0m[35m        End of the time range for the query, in ISO 8601 format.[0m
[30;1m47 | [0m[35m    unit : str, optional[0m
[30;1m48 | [0m[35m        The unit of time for the range (e.g., "minute", "hour", "day").[0m
[30;1m49 | [0m[35m    amount : int, optional[0m
[30;1m50 | [0m[35m        The quantity of the time unit for the range.[0m
[30;1m51 | [0m[35m    limit : int, optional[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    start_time : str, optional[0m
[30;1m44 | [0m[35m        Start of the time range for the query, in ISO 8601 format.[0m
[30;1m45 | [0m[35m    end_time : str, optional[0m
[30;1m46 | [0m[35m        End of the time range for the query, in ISO 8601 format.[0m
[30;1m47 | [0m[35m    unit : str, optional[0m
[30;1m48 | [0m[35m        The unit of time for the range (e.g., "minute", "hour", "day").[0m
[30;1m49 | [0m[35m    amount : int, optional[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/prismacloud_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    Attributes[0m
[30;1m42 | [0m[35m    ----------[0m
[30;1m43 | [0m[35m    start_time : str, optional[0m
[30;1m44 | [0m[35m        Start of the time range for the query, in ISO 8601 format.[0m
[30;1m45 | [0m[35m    end_time : str, optional[0m
[30;1m46 | [0m[35m        End of the time range for the query, in ISO 8601 format.[0m
[30;1m47 | [0m[35m    unit : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/lookback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        max_value : int, optional[0m
[30;1m55 | [0m[35m            Maximum value (the default is 240)[0m
[30;1m56 | [0m[35m        units : str, optional[0m
[30;1m57 | [0m[35m            Time unit (the default is 'hour')[0m
[30;1m58 | [0m[35m            Permissable values are 'day', 'hour', 'minute', 'second',[0m
[30;1m59 | [0m[35m            'week'[0m
[30;1m60 | [0m[35m            These can all be abbreviated down to initial characters[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/lookback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m            The description to display[0m
[30;1m49 | [0m[35m            (the default is 'Select time ({units}) to look back')[0m
[30;1m50 | [0m[35m        origin_time : datetime, optional[0m
[30;1m51 | [0m[35m            The origin time (the default is `datetime.utcnow()`)[0m
[30;1m52 | [0m[35m        min_value : int, optional[0m
[30;1m53 | [0m[35m            Minimum value (the default is 1)[0m
[30;1m54 | [0m[35m        max_value : int, optional[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/lookback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m            The default 'lookback' time (the default is 4)[0m
[30;1m47 | [0m[35m        description : str, optional[0m
[30;1m48 | [0m[35m            The description to display[0m
[30;1m49 | [0m[35m            (the default is 'Select time ({units}) to look back')[0m
[30;1m50 | [0m[35m        origin_time : datetime, optional[0m
[30;1m51 | [0m[35m            The origin time (the default is `datetime.utcnow()`)[0m
[30;1m52 | [0m[35m        min_value : int, optional[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/lookback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m        Parameters[0m
[30;1m44 | [0m[35m        ----------[0m
[30;1m45 | [0m[35m        default : int, optional[0m
[30;1m46 | [0m[35m            The default 'lookback' time (the default is 4)[0m
[30;1m47 | [0m[35m        description : str, optional[0m
[30;1m48 | [0m[35m            The description to display[0m
[30;1m49 | [0m[35m            (the default is 'Select time ({units}) to look back')[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/lookback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    def __init__([0m
[30;1m30 | [0m[35m        self,[0m
[30;1m31 | [0m[35m        default: Optional[int] = None,[0m
[30;1m32 | [0m[35m        description: str = "Select time ({units}) to look back",[0m
[30;1m33 | [0m[35m        origin_time: datetime = None,[0m
[30;1m34 | [0m[35m        min_value: Optional[int] = None,[0m
[30;1m35 | [0m[35m        max_value: Optional[int] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m@import_driver.register[0m
[30;1m78 | [0m[35mdef _(data_environment: str) -> type:[0m
[30;1m79 | [0m[35m    """Import custom driver class for a data environment."""[0m
[30;1m80 | [0m[35m    if plugin_cls := CUSTOM_PROVIDERS.get(data_environment):[0m
[30;1m81 | [0m[35m        return plugin_cls[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m@import_driver.register[0m
[30;1m60 | [0m[35mdef _(data_environment: DataEnvironment) -> type:[0m
[30;1m61 | [0m[35m    """Import driver class for a data environment."""[0m
[30;1m62 | [0m[35m    mod_name, cls_name = _ENVIRONMENT_DRIVERS.get(data_environment, (None, None))[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if not (mod_name and cls_name):[0m
[30;1m65 | [0m[35m        raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        raise ValueError([0m
[30;1m66 | [0m[35m            f"No driver available for environment {data_environment.name}.",[0m
[30;1m67 | [0m[35m            "Possible values are:",[0m
[30;1m68 | [0m[35m            ", ".join(env.name for env in _ENVIRONMENT_DRIVERS),[0m
[30;1m69 | [0m[35m        )[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    imp_module = importlib.import_module([0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/get_text.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m            description=description,[0m
[30;1m59 | [0m[35m            layout=Layout(width=kwargs.get("width", "50%")),[0m
[30;1m60 | [0m[35m            style={"description_width": kwargs.get("description_width", "initial")},[0m
[30;1m61 | [0m[35m            value=default or kwargs.get("value", ""),[0m
[30;1m62 | [0m[35m        )[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        # Call superclass to register[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/get_text.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        self._w_text = widgets.Text([0m
[30;1m58 | [0m[35m            description=description,[0m
[30;1m59 | [0m[35m            layout=Layout(width=kwargs.get("width", "50%")),[0m
[30;1m60 | [0m[35m            style={"description_width": kwargs.get("description_width", "initial")},[0m
[30;1m61 | [0m[35m            value=default or kwargs.get("value", ""),[0m
[30;1m62 | [0m[35m        )[0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/get_text.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        self._w_text = widgets.Text([0m
[30;1m58 | [0m[35m            description=description,[0m
[30;1m59 | [0m[35m            layout=Layout(width=kwargs.get("width", "50%")),[0m
[30;1m60 | [0m[35m            style={"description_width": kwargs.get("description_width", "initial")},[0m
[30;1m61 | [0m[35m            value=default or kwargs.get("value", ""),[0m
[30;1m62 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1034 | [0m[35m    ].to_dict(orient="records")[0m
[30;1m1035 | [0m[35m    return {[0m
[30;1m1036 | [0m[35m        row.get("EventTypeName", "Unknown_field"): json.loads([0m
[30;1m1037 | [0m[35m            row.get("Payload", "No Payload"),[0m
[30;1m1038 | [0m[35m        )[0m
[30;1m1039 | [0m[35m        for row in results[0m
[30;1m1040 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1033 | [0m[35m        ["EventTypeName", "Payload"][0m
[30;1m1034 | [0m[35m    ].to_dict(orient="records")[0m
[30;1m1035 | [0m[35m    return {[0m
[30;1m1036 | [0m[35m        row.get("EventTypeName", "Unknown_field"): json.loads([0m
[30;1m1037 | [0m[35m            row.get("Payload", "No Payload"),[0m
[30;1m1038 | [0m[35m        )[0m
[30;1m1039 | [0m[35m        for row in results[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1003 | [0m[35m                setting_name=key_name,[0m
[30;1m1004 | [0m[35m            )[0m
[30;1m1005 | [0m[35m            if isinstance(value, dict)[0m
[30;1m1006 | [0m[35m            and (value.get("EnvironmentVar") or value.get("KeyVault"))[0m
[30;1m1007 | [0m[35m            else value[0m
[30;1m1008 | [0m[35m        )[0m
[30;1m1009 | [0m[35m        for key_name, value in args.items()[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1003 | [0m[35m                setting_name=key_name,[0m
[30;1m1004 | [0m[35m            )[0m
[30;1m1005 | [0m[35m            if isinstance(value, dict)[0m
[30;1m1006 | [0m[35m            and (value.get("EnvironmentVar") or value.get("KeyVault"))[0m
[30;1m1007 | [0m[35m            else value[0m
[30;1m1008 | [0m[35m        )[0m
[30;1m1009 | [0m[35m        for key_name, value in args.items()[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m988 | [0m[35m) -> dict[str, Any]:[0m
[30;1m989 | [0m[35m    """Return a combined dictionary from the settings dictionary or the default."""[0m
[30;1m990 | [0m[35m    return {[0m
[30;1m991 | [0m[35m        key: settings.get(key, default.get(key))[0m
[30;1m992 | [0m[35m        for key in (settings.keys() | default.keys())[0m
[30;1m993 | [0m[35m    }[0m
[30;1m994 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m988 | [0m[35m) -> dict[str, Any]:[0m
[30;1m989 | [0m[35m    """Return a combined dictionary from the settings dictionary or the default."""[0m
[30;1m990 | [0m[35m    return {[0m
[30;1m991 | [0m[35m        key: settings.get(key, default.get(key))[0m
[30;1m992 | [0m[35m        for key in (settings.keys() | default.keys())[0m
[30;1m993 | [0m[35m    }[0m
[30;1m994 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m979 | [0m[35m    default: dict[str, Any],[0m
[30;1m980 | [0m[35m) -> Any:[0m
[30;1m981 | [0m[35m    """Return a setting from the settings dictionary or the default."""[0m
[30;1m982 | [0m[35m    return settings.get(name, default.get(name))[0m
[30;1m983 | [0m[35m[0m
[30;1m984 | [0m[35m[0m
[30;1m985 | [0m[35mdef _section_or_default([0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m979 | [0m[35m    default: dict[str, Any],[0m
[30;1m980 | [0m[35m) -> Any:[0m
[30;1m981 | [0m[35m    """Return a setting from the settings dictionary or the default."""[0m
[30;1m982 | [0m[35m    return settings.get(name, default.get(name))[0m
[30;1m983 | [0m[35m[0m
[30;1m984 | [0m[35m[0m
[30;1m985 | [0m[35mdef _section_or_default([0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m967 | [0m[35m            alias=name,[0m
[30;1m968 | [0m[35m            name=get_cluster_name(config[KFields.ARGS].get(KFields.CLUSTER)),[0m
[30;1m969 | [0m[35m            path=config["path"],[0m
[30;1m970 | [0m[35m            cluster_groups=config.get(KFields.CLUSTER_GROUPS),[0m
[30;1m971 | [0m[35m        )[0m
[30;1m972 | [0m[35m        for name, config in kusto_clusters.items()[0m
[30;1m973 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m965 | [0m[35m            ),[0m
[30;1m966 | [0m[35m            cluster=config[KFields.ARGS].get(KFields.CLUSTER),[0m
[30;1m967 | [0m[35m            alias=name,[0m
[30;1m968 | [0m[35m            name=get_cluster_name(config[KFields.ARGS].get(KFields.CLUSTER)),[0m
[30;1m969 | [0m[35m            path=config["path"],[0m
[30;1m970 | [0m[35m            cluster_groups=config.get(KFields.CLUSTER_GROUPS),[0m
[30;1m971 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m963 | [0m[35m                _section_or_default(config[KFields.ARGS], defaults),[0m
[30;1m964 | [0m[35m                config["path"],[0m
[30;1m965 | [0m[35m            ),[0m
[30;1m966 | [0m[35m            cluster=config[KFields.ARGS].get(KFields.CLUSTER),[0m
[30;1m967 | [0m[35m            alias=name,[0m
[30;1m968 | [0m[35m            name=get_cluster_name(config[KFields.ARGS].get(KFields.CLUSTER)),[0m
[30;1m969 | [0m[35m            path=config["path"],[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m946 | [0m[35m    """Return a dictionary of Kusto cluster settings from msticpyconfig.yaml."""[0m
[30;1m947 | [0m[35m    return {[0m
[30;1m948 | [0m[35m        config[KFields.ARGS][0m
[30;1m949 | [0m[35m        .get(KFields.CLUSTER)[0m
[30;1m950 | [0m[35m        .casefold(): KustoConfig([0m
[30;1m951 | [0m[35m            tenant_id=_setting_or_default([0m
[30;1m952 | [0m[35m                config[KFields.ARGS],[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m922 | [0m[35m        config_id: {**cluster_conf, "path": f"KustoClusters.{config_id}"}[0m
[30;1m923 | [0m[35m        for config_id, cluster_conf in get_config("KustoClusters", {}).items()[0m
[30;1m924 | [0m[35m    }[0m
[30;1m925 | [0m[35m    defaults: dict[str, Any] = kusto_new_conf.pop(KFields.DEFAULTS, {}).get([0m
[30;1m926 | [0m[35m        KFields.ARGS,[0m
[30;1m927 | [0m[35m        {},[0m
[30;1m928 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m890 | [0m[35m        """Get the database name from query source metadata."""[0m
[30;1m891 | [0m[35m        if database := query_source.metadata.get("database"):[0m
[30;1m892 | [0m[35m            return database[0m
[30;1m893 | [0m[35m        data_families: list[str] = query_source.metadata.get("data_families")[0m
[30;1m894 | [0m[35m        if not data_families:[0m
[30;1m895 | [0m[35m            logger.info("Could not find database name in query source metadata.")[0m
[30;1m896 | [0m[35m            _raise_no_db_error(query_source)[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m888 | [0m[35m    @staticmethod[0m
[30;1m889 | [0m[35m    def _get_db_from_query_source(query_source: QuerySource) -> str:[0m
[30;1m890 | [0m[35m        """Get the database name from query source metadata."""[0m
[30;1m891 | [0m[35m        if database := query_source.metadata.get("database"):[0m
[30;1m892 | [0m[35m            return database[0m
[30;1m893 | [0m[35m        data_families: list[str] = query_source.metadata.get("data_families")[0m
[30;1m894 | [0m[35m        if not data_families:[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m880 | [0m[35m            result |= bool(cluster_ids.intersection(query_source_clusters))[0m
[30;1m881 | [0m[35m            if result:[0m
[30;1m882 | [0m[35m                return result[0m
[30;1m883 | [0m[35m        source_cluster: str = query_source.metadata.get(QuerySourceFields.CLUSTER)[0m
[30;1m884 | [0m[35m        if source_cluster:[0m
[30;1m885 | [0m[35m            result |= source_cluster.casefold() in cluster_ids[0m
[30;1m886 | [0m[35m        return result[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m869 | [0m[35m            self.cluster_name.casefold(),[0m
[30;1m870 | [0m[35m            self.cluster_config_name.casefold(),[0m
[30;1m871 | [0m[35m        }[0m
[30;1m872 | [0m[35m        source_clusters: str | list[str] = query_source.metadata.get([0m
[30;1m873 | [0m[35m            QuerySourceFields.CLUSTERS,[0m
[30;1m874 | [0m[35m            [],[0m
[30;1m875 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m844 | [0m[35m[0m
[30;1m845 | [0m[35m    def _cluster_groups_match(self: Self, query_source: QuerySource) -> bool:[0m
[30;1m846 | [0m[35m        """Return True if query source cluster group is valid for current cluster."""[0m
[30;1m847 | [0m[35m        source_cluster_groups: str | list[str] = query_source.metadata.get([0m
[30;1m848 | [0m[35m            QuerySourceFields.CLUSTER_GROUPS,[0m
[30;1m849 | [0m[35m            [],[0m
[30;1m850 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m                QuerySourceFields.CLUSTERS,[0m
[30;1m640 | [0m[35m                "NA",[0m
[30;1m641 | [0m[35m            ),[0m
[30;1m642 | [0m[35m            QuerySourceFields.CLUSTER_GROUPS: query_source.metadata.get([0m
[30;1m643 | [0m[35m                QuerySourceFields.CLUSTER_GROUPS,[0m
[30;1m644 | [0m[35m                "NA",[0m
[30;1m645 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m                QuerySourceFields.CLUSTER,[0m
[30;1m636 | [0m[35m                "NA",[0m
[30;1m637 | [0m[35m            ),[0m
[30;1m638 | [0m[35m            QuerySourceFields.CLUSTERS: query_source.metadata.get([0m
[30;1m639 | [0m[35m                QuerySourceFields.CLUSTERS,[0m
[30;1m640 | [0m[35m                "NA",[0m
[30;1m641 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m    ) -> dict[str, str]:[0m
[30;1m632 | [0m[35m        """Return cluster details from query source."""[0m
[30;1m633 | [0m[35m        return {[0m
[30;1m634 | [0m[35m            QuerySourceFields.CLUSTER: query_source.metadata.get([0m
[30;1m635 | [0m[35m                QuerySourceFields.CLUSTER,[0m
[30;1m636 | [0m[35m                "NA",[0m
[30;1m637 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m            raise MsticpyParameterError(err_msg)[0m
[30;1m394 | [0m[35m        self.client = KustoClient(kusto_cs)[0m
[30;1m395 | [0m[35m        proxies = proxies or self._def_proxies[0m
[30;1m396 | [0m[35m        proxy_url: str | None = proxies.get("https") if proxies else None[0m
[30;1m397 | [0m[35m        if proxy_url:[0m
[30;1m398 | [0m[35m            logger.info([0m
[30;1m399 | [0m[35m                "Using proxy: %s",[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m    @property[0m
[30;1m102 | [0m[35m    def default_db(self: Self) -> str | None:[0m
[30;1m103 | [0m[35m        """Return default database for this cluster."""[0m
[30;1m104 | [0m[35m        return self.args.get("Database", self.args.get("DefaultDatabase"))[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    def __getattr__(self: Self, attrib: str) -> Any:[0m
[30;1m107 | [0m[35m        """Return attribute from args if not in self."""[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m    @property[0m
[30;1m102 | [0m[35m    def default_db(self: Self) -> str | None:[0m
[30;1m103 | [0m[35m        """Return default database for this cluster."""[0m
[30;1m104 | [0m[35m        return self.args.get("Database", self.args.get("DefaultDatabase"))[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    def __getattr__(self: Self, attrib: str) -> Any:[0m
[30;1m107 | [0m[35m        """Return attribute from args if not in self."""[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m892 | [0m[35m            return database[0m
[30;1m893 | [0m[35m        data_families: list[str] = query_source.metadata.get("data_families")[0m
[30;1m894 | [0m[35m        if not data_families:[0m
[30;1m895 | [0m[35m            logger.info("Could not find database name in query source metadata.")[0m
[30;1m896 | [0m[35m            _raise_no_db_error(query_source)[0m
[30;1m897 | [0m[35m[0m
[30;1m898 | [0m[35m        if "." in data_families[0]:[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m430 | [0m[35m        database : str, Optional[0m
[30;1m431 | [0m[35m            Supply or override the Kusto database name[0m
[30;1m432 | [0m[35m        timeout : int[0m
[30;1m433 | [0m[35m            Query timeout in seconds, default is 240 seconds (4 minutes)[0m
[30;1m434 | [0m[35m            Maximum is 3600 seconds (1 hour).[0m
[30;1m435 | [0m[35m[0m
[30;1m436 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m429 | [0m[35m        ----------------[0m
[30;1m430 | [0m[35m        database : str, Optional[0m
[30;1m431 | [0m[35m            Supply or override the Kusto database name[0m
[30;1m432 | [0m[35m        timeout : int[0m
[30;1m433 | [0m[35m            Query timeout in seconds, default is 240 seconds (4 minutes)[0m
[30;1m434 | [0m[35m            Maximum is 3600 seconds (1 hour).[0m
[30;1m435 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m        mp_az_tenant_id: str, optional[0m
[30;1m327 | [0m[35m            alias for `tenant_id`.[0m
[30;1m328 | [0m[35m        timeout : int[0m
[30;1m329 | [0m[35m            Query timeout in seconds, default is 240 seconds (4 minutes)[0m
[30;1m330 | [0m[35m            Maximum is 3600 seconds (1 hour).[0m
[30;1m331 | [0m[35m            (can be overridden in query methods)[0m
[30;1m332 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m            list[str]: list of acceptable auth methods[0m
[30;1m326 | [0m[35m        mp_az_tenant_id: str, optional[0m
[30;1m327 | [0m[35m            alias for `tenant_id`.[0m
[30;1m328 | [0m[35m        timeout : int[0m
[30;1m329 | [0m[35m            Query timeout in seconds, default is 240 seconds (4 minutes)[0m
[30;1m330 | [0m[35m            Maximum is 3600 seconds (1 hour).[0m
[30;1m331 | [0m[35m            (can be overridden in query methods)[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m        debug : bool[0m
[30;1m171 | [0m[35m            print out additional diagnostic information.[0m
[30;1m172 | [0m[35m        timeout : int[0m
[30;1m173 | [0m[35m            Query timeout in seconds, default is 240 seconds (4 minutes)[0m
[30;1m174 | [0m[35m            Maximum is 3600 seconds (1 hour).[0m
[30;1m175 | [0m[35m            (can be set here or in connect and overridden in query methods)[0m
[30;1m176 | [0m[35m        proxies : dict[str, str][0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m        ----------------[0m
[30;1m170 | [0m[35m        debug : bool[0m
[30;1m171 | [0m[35m            print out additional diagnostic information.[0m
[30;1m172 | [0m[35m        timeout : int[0m
[30;1m173 | [0m[35m            Query timeout in seconds, default is 240 seconds (4 minutes)[0m
[30;1m174 | [0m[35m            Maximum is 3600 seconds (1 hour).[0m
[30;1m175 | [0m[35m            (can be set here or in connect and overridden in query methods)[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_kusto_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m"""Kusto Driver subclass."""[0m
[30;1m7 | [0m[35mfrom __future__ import annotations[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport base64[0m
[30;1m10 | [0m[35mimport dataclasses[0m
[30;1m11 | [0m[35mimport json[0m
[30;1m12 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m652 | [0m[35m        self._db_folder = ([0m
[30;1m653 | [0m[35m            self._db_folder[0m
[30;1m654 | [0m[35m            if self._db_folder != self._UNSET_PATH[0m
[30;1m655 | [0m[35m            else self.settings.args.get("DBFolder", self._DB_HOME)[0m
[30;1m656 | [0m[35m        )[0m
[30;1m657 | [0m[35m        self._db_folder = str(Path(self._db_folder).expanduser())[0m
[30;1m658 | [0m[35m        self._check_and_update_db()[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m647 | [0m[35m[0m
[30;1m648 | [0m[35m        self.settings = _get_geoip_provider_settings("GeoIPLite")[0m
[30;1m649 | [0m[35m        self._api_key = self._api_key or self.settings.args.get("AuthKey")[0m
[30;1m650 | [0m[35m        self._account_id = self._account_id or self.settings.args.get("AccountID")[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m        self._db_folder = ([0m
[30;1m653 | [0m[35m            self._db_folder[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m646 | [0m[35m            return[0m
[30;1m647 | [0m[35m[0m
[30;1m648 | [0m[35m        self.settings = _get_geoip_provider_settings("GeoIPLite")[0m
[30;1m649 | [0m[35m        self._api_key = self._api_key or self.settings.args.get("AuthKey")[0m
[30;1m650 | [0m[35m        self._account_id = self._account_id or self.settings.args.get("AccountID")[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m        self._db_folder = ([0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m
[30;1m640 | [0m[35m        ip_entity.Location = geo_entity[0m
[30;1m641 | [0m[35m        return ip_entity[0m
[30;1m642 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m
[30;1m640 | [0m[35m        ip_entity.Location = geo_entity[0m
[30;1m641 | [0m[35m        return ip_entity[0m
[30;1m642 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m        if subdivs:[0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m
[30;1m640 | [0m[35m        ip_entity.Location = geo_entity[0m
[30;1m641 | [0m[35m        return ip_entity[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m        if subdivs:[0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m
[30;1m640 | [0m[35m        ip_entity.Location = geo_entity[0m
[30;1m641 | [0m[35m        return ip_entity[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m
[30;1m640 | [0m[35m        ip_entity.Location = geo_entity[0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m
[30;1m640 | [0m[35m        ip_entity.Location = geo_entity[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m
[30;1m640 | [0m[35m        ip_entity.Location = geo_entity[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m        )[0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m        )[0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m
[30;1m638 | [0m[35m        geo_entity.Longitude = geo_match.get("location", {}).get("longitude", None)[0m
[30;1m639 | [0m[35m        geo_entity.Latitude = geo_match.get("location", {}).get("latitude", None)[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m        geo_entity.CountryOrRegionName = ([0m
[30;1m632 | [0m[35m            geo_match.get("country", {}).get("names", {}).get("en", None)[0m
[30;1m633 | [0m[35m        )[0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m
[30;1m636 | [0m[35m            geo_entity.State = subdivs[0].get("names", {}).get("en", None)[0m
[30;1m637 | [0m[35m        geo_entity.City = geo_match.get("city", {}).get("names", {}).get("en", None)[0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m629 | [0m[35m        geo_entity: GeoLocation = GeoLocation()[0m
[30;1m630 | [0m[35m        geo_entity.CountryCode = geo_match.get("country", {}).get("iso_code", None)[0m
[30;1m631 | [0m[35m        geo_entity.CountryOrRegionName = ([0m
[30;1m632 | [0m[35m            geo_match.get("country", {}).get("names", {}).get("en", None)[0m
[30;1m633 | [0m[35m        )[0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m629 | [0m[35m        geo_entity: GeoLocation = GeoLocation()[0m
[30;1m630 | [0m[35m        geo_entity.CountryCode = geo_match.get("country", {}).get("iso_code", None)[0m
[30;1m631 | [0m[35m        geo_entity.CountryOrRegionName = ([0m
[30;1m632 | [0m[35m            geo_match.get("country", {}).get("names", {}).get("en", None)[0m
[30;1m633 | [0m[35m        )[0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m629 | [0m[35m        geo_entity: GeoLocation = GeoLocation()[0m
[30;1m630 | [0m[35m        geo_entity.CountryCode = geo_match.get("country", {}).get("iso_code", None)[0m
[30;1m631 | [0m[35m        geo_entity.CountryOrRegionName = ([0m
[30;1m632 | [0m[35m            geo_match.get("country", {}).get("names", {}).get("en", None)[0m
[30;1m633 | [0m[35m        )[0m
[30;1m634 | [0m[35m        subdivs: list[dict[str, Any]] = geo_match.get("subdivisions", [])[0m
[30;1m635 | [0m[35m        if subdivs:[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m627 | [0m[35m            ip_entity = IpAddress()[0m
[30;1m628 | [0m[35m            ip_entity.Address = ip_address[0m
[30;1m629 | [0m[35m        geo_entity: GeoLocation = GeoLocation()[0m
[30;1m630 | [0m[35m        geo_entity.CountryCode = geo_match.get("country", {}).get("iso_code", None)[0m
[30;1m631 | [0m[35m        geo_entity.CountryOrRegionName = ([0m
[30;1m632 | [0m[35m            geo_match.get("country", {}).get("names", {}).get("en", None)[0m
[30;1m633 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m627 | [0m[35m            ip_entity = IpAddress()[0m
[30;1m628 | [0m[35m            ip_entity.Address = ip_address[0m
[30;1m629 | [0m[35m        geo_entity: GeoLocation = GeoLocation()[0m
[30;1m630 | [0m[35m        geo_entity.CountryCode = geo_match.get("country", {}).get("iso_code", None)[0m
[30;1m631 | [0m[35m        geo_entity.CountryOrRegionName = ([0m
[30;1m632 | [0m[35m            geo_match.get("country", {}).get("names", {}).get("en", None)[0m
[30;1m633 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m                    iplist=ip_addr,[0m
[30;1m409 | [0m[35m                    access_key=self._api_key,[0m
[30;1m410 | [0m[35m                )[0m
[30;1m411 | [0m[35m                response: httpx.Response = client.get(submit_url)[0m
[30;1m412 | [0m[35m                if response.is_success:[0m
[30;1m413 | [0m[35m                    ip_loc_results.append((response.json(), response.status_code))[0m
[30;1m414 | [0m[35m                elif response:[0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m            iplist=",".join(ip_list),[0m
[30;1m373 | [0m[35m            access_key=self._api_key,[0m
[30;1m374 | [0m[35m        )[0m
[30;1m375 | [0m[35m        response: httpx.Response = httpx.get([0m
[30;1m376 | [0m[35m            submit_url,[0m
[30;1m377 | [0m[35m            timeout=get_http_timeout(),[0m
[30;1m378 | [0m[35m            headers=mp_ua_header(),[0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m            return True[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m        self.settings = _get_geoip_provider_settings("IPStack")[0m
[30;1m269 | [0m[35m        self._api_key = self.settings.args.get("AuthKey") if self.settings else None[0m
[30;1m270 | [0m[35m        if self._api_key:[0m
[30;1m271 | [0m[35m            return True[0m
[30;1m272 | [0m[35m        raise MsticpyUserConfigError([0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m849 | [0m[35m        -------[0m
[30;1m850 | [0m[35m        Optional[str][0m
[30;1m851 | [0m[35m            Returns the absolute path of local maxmind geolite city[0m
[30;1m852 | [0m[35m            database after control flow logic.[0m
[30;1m853 | [0m[35m[0m
[30;1m854 | [0m[35m        """[0m
[30;1m855 | [0m[35m        latest_db_path: Path = Path(self._db_folder or ".").joinpath(self._DB_FILE)[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m511 | [0m[35m            Force update can be set to true or false. depending on it,[0m
[30;1m512 | [0m[35m            new download request will be initiated.[0m
[30;1m513 | [0m[35m        auto_update: bool, optional[0m
[30;1m514 | [0m[35m            Auto update can be set to true or false. depending on it,[0m
[30;1m515 | [0m[35m            new download request will be initiated if age criteria is matched.[0m
[30;1m516 | [0m[35m        debug : bool, optional[0m
[30;1m517 | [0m[35m            Print additional debugging information, default is False.[0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m508 | [0m[35m            If no path provided, it is set to download to .msticpy/GeoLite2[0m
[30;1m509 | [0m[35m            under user`s home directory.[0m
[30;1m510 | [0m[35m        force_update : bool, optional[0m
[30;1m511 | [0m[35m            Force update can be set to true or false. depending on it,[0m
[30;1m512 | [0m[35m            new download request will be initiated.[0m
[30;1m513 | [0m[35m        auto_update: bool, optional[0m
[30;1m514 | [0m[35m            Auto update can be set to true or false. depending on it,[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m949 | [0m[35m@export[0m
[30;1m950 | [0m[35mdef entity_distance(ip_src: IpAddress, ip_dest: IpAddress) -> float:[0m
[30;1m951 | [0m[35m    """[0m
[30;1m952 | [0m[35m    Return distance between two IP Entities.[0m
[30;1m953 | [0m[35m[0m
[30;1m954 | [0m[35m    Parameters[0m
[30;1m955 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m743 | [0m[35m        )[0m
[30;1m744 | [0m[35m        self._pr_debug(f"Downloading GeoLite DB: {db_archive_path}")[0m
[30;1m745 | [0m[35m        try:[0m
[30;1m746 | [0m[35m            # wait a small rand amount of time in case multiple procs try[0m
[30;1m747 | [0m[35m            # to download simultaneously[0m
[30;1m748 | [0m[35m            sleep(rand_int / 500000)[0m
[30;1m749 | [0m[35m            if list(Path(self._db_folder).glob(self._DB_ARCHIVE.format(rand="*"))):[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m667 | [0m[35m[0m
[30;1m668 | [0m[35m    def _check_and_update_db(self: Self) -> None:[0m
[30;1m669 | [0m[35m        """[0m
[30;1m670 | [0m[35m        Check the age of geo ip database file and download if it older than 30 days.[0m
[30;1m671 | [0m[35m[0m
[30;1m672 | [0m[35m        User can set auto_update or force_update to True or False to[0m
[30;1m673 | [0m[35m        override auto-download behavior.[0m

[31m--[ [0m[34mMatch #[0m[33m882[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m    @staticmethod[0m
[30;1m610 | [0m[35m    def _get_geomatch_non_public(ip_type: str) -> dict[str, Any]:[0m
[30;1m611 | [0m[35m        """Return placeholder record for non-public IP Types."""[0m
[30;1m612 | [0m[35m        return {[0m
[30;1m613 | [0m[35m            "country": {[0m
[30;1m614 | [0m[35m                "iso_code": None,[0m

[31m--[ [0m[34mMatch #[0m[33m883[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m596 | [0m[35m                    else:[0m
[30;1m597 | [0m[35m                        geo_match = None[0m
[30;1m598 | [0m[35m                except (AddressNotFoundError, AttributeError, ValueError) as err:[0m
[30;1m599 | [0m[35m                    logger.warning("Error looking up IP %s - %s", ip_input, err)[0m
[30;1m600 | [0m[35m                    continue[0m
[30;1m601 | [0m[35m                if geo_match:[0m
[30;1m602 | [0m[35m                    output_raw.append(geo_match)[0m

[31m--[ [0m[34mMatch #[0m[33m884[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m583 | [0m[35m            try:[0m
[30;1m584 | [0m[35m                ip_type: str = get_ip_type(ip_input)[0m
[30;1m585 | [0m[35m            except ValueError:[0m
[30;1m586 | [0m[35m                ip_type = "Invalid IP Address"[0m
[30;1m587 | [0m[35m            if ip_type != "Public":[0m
[30;1m588 | [0m[35m                geo_match = self._get_geomatch_non_public(ip_type)[0m
[30;1m589 | [0m[35m            elif self._reader:[0m

[31m--[ [0m[34mMatch #[0m[33m885[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m550 | [0m[35m        ip_entity: IpAddress = None,[0m
[30;1m551 | [0m[35m    ) -> tuple[list[dict[str, Any]], list[IpAddress]]:[0m
[30;1m552 | [0m[35m        """[0m
[30;1m553 | [0m[35m        Lookup IP location from GeoLite2 data created by MaxMind.[0m
[30;1m554 | [0m[35m[0m
[30;1m555 | [0m[35m        Parameters[0m
[30;1m556 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m886[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m400 | [0m[35m        self: Self,[0m
[30;1m401 | [0m[35m        ip_list: list[str],[0m
[30;1m402 | [0m[35m    ) -> list[tuple[dict[str, str] | None, int]]:[0m
[30;1m403 | [0m[35m        """Lookup IP Addresses one-by-one."""[0m
[30;1m404 | [0m[35m        ip_loc_results: list[tuple[dict | None, int]] = [][0m
[30;1m405 | [0m[35m        with httpx.Client(timeout=get_http_timeout(), headers=mp_ua_header()) as client:[0m
[30;1m406 | [0m[35m            for ip_addr in ip_list:[0m

[31m--[ [0m[34mMatch #[0m[33m887[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m309 | [0m[35m        ConnectionError[0m
[30;1m310 | [0m[35m            Invalid status returned from http request[0m
[30;1m311 | [0m[35m        PermissionError[0m
[30;1m312 | [0m[35m            Service refused request (e.g. requesting batch of addresses[0m
[30;1m313 | [0m[35m            on free tier API key)[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m888[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m286 | [0m[35m        ip_entity: IpAddress = None,[0m
[30;1m287 | [0m[35m    ) -> tuple[list[Any], list[IpAddress]]:[0m
[30;1m288 | [0m[35m        """[0m
[30;1m289 | [0m[35m        Lookup IP location from IPStack web service.[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m        Parameters[0m
[30;1m292 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m889[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m184 | [0m[35m            return [str(ip).strip() for ip in ip_addr_list][0m
[30;1m185 | [0m[35m        if ip_entity:[0m
[30;1m186 | [0m[35m            return [ip_entity.Address][0m
[30;1m187 | [0m[35m        err_msg: str = "No valid ip addresses were passed as arguments."[0m
[30;1m188 | [0m[35m        raise ValueError(err_msg)[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    def print_license(self: Self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m890[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m            if isinstance(ip_address, IpAddress):[0m
[30;1m182 | [0m[35m                return [ip_address.Address][0m
[30;1m183 | [0m[35m        if ip_addr_list is not None and isinstance(ip_addr_list, abc.Iterable):[0m
[30;1m184 | [0m[35m            return [str(ip).strip() for ip in ip_addr_list][0m
[30;1m185 | [0m[35m        if ip_entity:[0m
[30;1m186 | [0m[35m            return [ip_entity.Address][0m
[30;1m187 | [0m[35m        err_msg: str = "No valid ip addresses were passed as arguments."[0m

[31m--[ [0m[34mMatch #[0m[33m891[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m            if isinstance(ip_address, str):[0m
[30;1m178 | [0m[35m                return [ip_address.strip()][0m
[30;1m179 | [0m[35m            if isinstance(ip_address, abc.Iterable):[0m
[30;1m180 | [0m[35m                return [str(ip).strip() for ip in ip_address][0m
[30;1m181 | [0m[35m            if isinstance(ip_address, IpAddress):[0m
[30;1m182 | [0m[35m                return [ip_address.Address][0m
[30;1m183 | [0m[35m        if ip_addr_list is not None and isinstance(ip_addr_list, abc.Iterable):[0m

[31m--[ [0m[34mMatch #[0m[33m892[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m        Returns[0m
[30;1m124 | [0m[35m        -------[0m
[30;1m125 | [0m[35m        pd.DataFrame[0m
[30;1m126 | [0m[35m            Copy of original dataframe with IP Location information columns[0m
[30;1m127 | [0m[35m            appended (where a location lookup was successful)[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m893[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m        ip_entity: IpAddress | None = None,[0m
[30;1m86 | [0m[35m    ) -> tuple[list[Any], list[IpAddress]]:[0m
[30;1m87 | [0m[35m        """[0m
[30;1m88 | [0m[35m        Lookup IP location abstract method.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        Parameters[0m
[30;1m91 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m894[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35mfrom datetime import datetime, timedelta, timezone[0m
[30;1m33 | [0m[35mfrom json import JSONDecodeError[0m
[30;1m34 | [0m[35mfrom pathlib import Path[0m
[30;1m35 | [0m[35mfrom time import sleep[0m
[30;1m36 | [0m[35mfrom typing import Any, ClassVar, Iterable, Mapping[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mimport geoip2.database[0m

[31m--[ [0m[34mMatch #[0m[33m895[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/geoip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35mGeoip Lookup module using IPStack and Maxmind GeoLite2.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mGeographic location lookup for IP addresses. This module has two classes[0m
[30;1m10 | [0m[35mfor different services:[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m-  GeoLiteLookup - Maxmind Geolite (see https://www.maxmind.com)[0m

[31m--[ [0m[34mMatch #[0m[33m896[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m        else:[0m
[30;1m59 | [0m[35m            style_str = _F_STYLES.get(styles, "")[0m
[30;1m60 | [0m[35m    if isinstance(styles, list):[0m
[30;1m61 | [0m[35m        style_str = ";".join(_F_STYLES.get(style, "") for style in styles)[0m
[30;1m62 | [0m[35m    content = HTML(f"<p style='{style_str}'>{string}</p>")[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if isinstance(disp_id, bool) and disp_id:[0m

[31m--[ [0m[34mMatch #[0m[33m897[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m        if "," in styles:[0m
[30;1m57 | [0m[35m            styles = [style.strip() for style in styles.split(",")][0m
[30;1m58 | [0m[35m        else:[0m
[30;1m59 | [0m[35m            style_str = _F_STYLES.get(styles, "")[0m
[30;1m60 | [0m[35m    if isinstance(styles, list):[0m
[30;1m61 | [0m[35m        style_str = ";".join(_F_STYLES.get(style, "") for style in styles)[0m
[30;1m62 | [0m[35m    content = HTML(f"<p style='{style_str}'>{string}</p>")[0m

[31m--[ [0m[34mMatch #[0m[33m898[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m        If True, the function will return a display handle that can be re-used[0m
[30;1m112 | [0m[35m        in subsequent calls to update the display object.[0m
[30;1m113 | [0m[35m        If this is previously-created display handle, this is used as the[0m
[30;1m114 | [0m[35m        target display object to update it with the content of this call,[0m
[30;1m115 | [0m[35m        by default None[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m899[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35m        The error message.[0m
[30;1m110 | [0m[35m    disp_id : Optional[Union[bool, DisplayHandle]], optional[0m
[30;1m111 | [0m[35m        If True, the function will return a display handle that can be re-used[0m
[30;1m112 | [0m[35m        in subsequent calls to update the display object.[0m
[30;1m113 | [0m[35m        If this is previously-created display handle, this is used as the[0m
[30;1m114 | [0m[35m        target display object to update it with the content of this call,[0m
[30;1m115 | [0m[35m        by default None[0m

[31m--[ [0m[34mMatch #[0m[33m900[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m    Returns[0m
[30;1m92 | [0m[35m    -------[0m
[30;1m93 | [0m[35m    DisplayHandle[0m
[30;1m94 | [0m[35m        A handle to the display object that can be used to update the[0m
[30;1m95 | [0m[35m        contents.[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m901[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m85 | [0m[35m        If True, the function will return a display handle that can be re-used[0m
[30;1m86 | [0m[35m        in subsequent calls to update the display object.[0m
[30;1m87 | [0m[35m        If this is previously-created display handle, this is used as the[0m
[30;1m88 | [0m[35m        target display object to update it with the content of this call,[0m
[30;1m89 | [0m[35m        by default None[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    Returns[0m

[31m--[ [0m[34mMatch #[0m[33m902[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m        The warning message.[0m
[30;1m84 | [0m[35m    disp_id : Optional[DisplayHandle], optional[0m
[30;1m85 | [0m[35m        If True, the function will return a display handle that can be re-used[0m
[30;1m86 | [0m[35m        in subsequent calls to update the display object.[0m
[30;1m87 | [0m[35m        If this is previously-created display handle, this is used as the[0m
[30;1m88 | [0m[35m        target display object to update it with the content of this call,[0m
[30;1m89 | [0m[35m        by default None[0m

[31m--[ [0m[34mMatch #[0m[33m903[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m47 | [0m[35m    Returns[0m
[30;1m48 | [0m[35m    -------[0m
[30;1m49 | [0m[35m    DisplayHandle[0m
[30;1m50 | [0m[35m        A handle to the display object that can be used to update the[0m
[30;1m51 | [0m[35m        contents.[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m904[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m        If True, the function will return a display handle that can be re-used[0m
[30;1m42 | [0m[35m        in subsequent calls to update the display object.[0m
[30;1m43 | [0m[35m        If this is previously-created display handle, this is used as the[0m
[30;1m44 | [0m[35m        target display object to update it with the content of this call,[0m
[30;1m45 | [0m[35m        by default None[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    Returns[0m

[31m--[ [0m[34mMatch #[0m[33m905[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m        string, by default None[0m
[30;1m40 | [0m[35m    disp_id : Optional[Union[bool, DisplayHandle]], optional[0m
[30;1m41 | [0m[35m        If True, the function will return a display handle that can be re-used[0m
[30;1m42 | [0m[35m        in subsequent calls to update the display object.[0m
[30;1m43 | [0m[35m        If this is previously-created display handle, this is used as the[0m
[30;1m44 | [0m[35m        target display object to update it with the content of this call,[0m
[30;1m45 | [0m[35m        by default None[0m

[31m--[ [0m[34mMatch #[0m[33m906[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35mfrom base64 import b64decode[0m
[30;1m165 | [0m[35mimport pickle[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m## Store dynamic summaries as base64 byte string[0m
[30;1m168 | [0m[35msummary_data = {encoded_bytes}[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m# decode and unpickle the summaries[0m

[31m--[ [0m[34mMatch #[0m[33m907[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m# the object "{var_name}"[0m
[30;1m162 | [0m[35m#########################################[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35mfrom base64 import b64decode[0m
[30;1m165 | [0m[35mimport pickle[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m## Store dynamic summaries as base64 byte string[0m

[31m--[ [0m[34mMatch #[0m[33m908[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m@export[0m
[30;1m102 | [0m[35mdef md_error(string: str, disp_id: Optional[DisplayHandle] = None):[0m
[30;1m103 | [0m[35m    """[0m
[30;1m104 | [0m[35m    Return string as an error - red text prefixed by "Error".[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    Parameters[0m
[30;1m107 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m909[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/ipython.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m"""Notebook utility functions."""[0m
[30;1m7 | [0m[35m# pickle only used here for storing data.[0m
[30;1m8 | [0m[35mimport pickle  # nosec[0m
[30;1m9 | [0m[35mfrom base64 import b64encode[0m
[30;1m10 | [0m[35mfrom typing import Any, Iterable, Optional, Union[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom IPython import get_ipython[0m

[31m--[ [0m[34mMatch #[0m[33m910[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m446 | [0m[35m### Event Timelines[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35mDisplay any log events on an interactive timeline. Using the[0m
[30;1m449 | [0m[35m[Bokeh Visualization Library](https://bokeh.org/) the timeline control enables[0m
[30;1m450 | [0m[35myou to visualize one or more event streams, interactively zoom into specific time[0m
[30;1m451 | [0m[35mslots and view event details for plotted events.[0m
[30;1m452 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m911[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m349 | [0m[35m[docs/notebooks](https://github.com/microsoft/msticpy/blob/master/docs/notebooks)[0m
[30;1m350 | [0m[35mfolder and accompanying notebooks.[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35mYou can also browse through the sample notebooks referenced at the end of this document[0m
[30;1m353 | [0m[35mto see some of the functionality used in context. You can play with some of the package[0m
[30;1m354 | [0m[35mfunctions in this interactive demo on mybinder.org.[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m912[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m## Documentation[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35mFull documentation is at [ReadTheDocs](https://msticpy.readthedocs.io/en/latest/)[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35mSample notebooks for many of the modules are in the[0m
[30;1m349 | [0m[35m[docs/notebooks](https://github.com/microsoft/msticpy/blob/master/docs/notebooks)[0m

[31m--[ [0m[34mMatch #[0m[33m913[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m`pip install --upgrade msticpy`[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35mNote it is good practice to copy your msticpyconfig.yaml and store it on your disk but outside of yo[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m## Documentation[0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m914[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m557 | [0m[35m[0m
[30;1m558 | [0m[35m<img src="./docs/source/visualization/_static/Widgets1.png"[0m
[30;1m559 | [0m[35m  alt="Time span Widget"[0m
[30;1m560 | [0m[35m  title="Query time setter" height="100" />[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m<img src="./docs/source/visualization/_static/Widgets4.png"[0m
[30;1m563 | [0m[35m  alt="Alert browser"[0m

[31m--[ [0m[34mMatch #[0m[33m915[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m553 | [0m[35m[0m
[30;1m554 | [0m[35mThese are built from the [Jupyter ipywidgets](https://ipywidgets.readthedocs.io/) collection[0m
[30;1m555 | [0m[35mand group common functionality useful in InfoSec tasks such as list pickers,[0m
[30;1m556 | [0m[35mquery time boundary settings and event display into an easy-to-use format.[0m
[30;1m557 | [0m[35m[0m
[30;1m558 | [0m[35m<img src="./docs/source/visualization/_static/Widgets1.png"[0m
[30;1m559 | [0m[35m  alt="Time span Widget"[0m

[31m--[ [0m[34mMatch #[0m[33m916[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m### iocextract[0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35mUses regular expressions to look for Indicator of Compromise (IoC) patterns - IP Addresses, URLs,[0m
[30;1m506 | [0m[35mDNS domains, Hashes, file paths.[0m
[30;1m507 | [0m[35mInput can be a single string or a pandas dataframe.[0m
[30;1m508 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m917[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m500 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m918[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m### base64unpack[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m919[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m492 | [0m[35m[Pivot Functions Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/PivotFunc[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m### base64unpack[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m497 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m498 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m499 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m920[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m482 | [0m[35mLets you use *MSTICPy* functionality in an "entity-centric" way.[0m
[30;1m483 | [0m[35mAll functions, queries and lookups that relate to a particular entity type[0m
[30;1m484 | [0m[35m(e.g. Host, IpAddress, Url) are collected together as methods of that[0m
[30;1m485 | [0m[35mentity class. So, if you want to do things with an IP address, just load[0m
[30;1m486 | [0m[35mthe IpAddress entity and browse its methods.[0m
[30;1m487 | [0m[35m[0m
[30;1m488 | [0m[35m[Pivot Functions](https://msticpy.readthedocs.io/en/latest/data_analysis/PivotFunctions.html)[0m

[31m--[ [0m[34mMatch #[0m[33m921[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35mDisplay any log events on an interactive timeline. Using the[0m
[30;1m449 | [0m[35m[Bokeh Visualization Library](https://bokeh.org/) the timeline control enables[0m
[30;1m450 | [0m[35myou to visualize one or more event streams, interactively zoom into specific time[0m
[30;1m451 | [0m[35mslots and view event details for plotted events.[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m<img src="./docs/source/visualization/_static/TimeLine-01.png"[0m

[31m--[ [0m[34mMatch #[0m[33m922[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m431 | [0m[35m[Anomalous Sequence Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Anomal[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m### Time Series Analysis[0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35mTime series analysis allows you to identify unusual patterns in your log data[0m
[30;1m436 | [0m[35mtaking into account normal seasonal variations (e.g. the regular ebb and flow of[0m
[30;1m437 | [0m[35mevents over hours of the day, days of the week, etc.). Using both analysis and[0m
[30;1m438 | [0m[35mvisualization highlights unusual traffic flows or event activity for any data[0m

[31m--[ [0m[34mMatch #[0m[33m923[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m428 | [0m[35mand[0m
[30;1m429 | [0m[35m[Anomalous Sequence Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Anomal[0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m### Time Series Analysis[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35mTime series analysis allows you to identify unusual patterns in your log data[0m
[30;1m434 | [0m[35mtaking into account normal seasonal variations (e.g. the regular ebb and flow of[0m

[31m--[ [0m[34mMatch #[0m[33m924[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m422 | [0m[35mDetect unusual sequences of events in your Office, Active Directory or other log data.[0m
[30;1m423 | [0m[35mYou can extract sessions (e.g. activity initiated by the same account) and identify and[0m
[30;1m424 | [0m[35mvisualize unusual sequences of activity. For example, detecting an attacker setting[0m
[30;1m425 | [0m[35ma mail forwarding rule on someone's mailbox.[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m[Anomalous Sessions](https://msticpy.readthedocs.io/en/latest/data_analysis/AnomalousSequence.html)[0m
[30;1m428 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m925[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m<img src="./docs/source/visualization/_static/folium_sf_zoom.png"[0m
[30;1m398 | [0m[35m  alt="Folium map"[0m
[30;1m399 | [0m[35m  title="Plotting Geo IP Location" height="200" />[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m[GeoIP Lookup](https://msticpy.readthedocs.io/en/latest/data_acquisition/GeoIPLookups.html)[0m
[30;1m402 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m926[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m### GeoLocation Data[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35mThe GeoIP lookup classes allow you to match the geo-locations of IP addresses[0m
[30;1m392 | [0m[35musing either:[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m- GeoLiteLookup - Maxmind Geolite (see <https://www.maxmind.com>)[0m

[31m--[ [0m[34mMatch #[0m[33m927[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m`pip install --upgrade msticpy`[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35mNote it is good practice to copy your msticpyconfig.yaml and store it on your disk but outside of yo[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m## Documentation[0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m928[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m  multi-dimensional Morph Charts[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35mIt also includes some time-saving notebook tools such as widgets to[0m
[30;1m292 | [0m[35mset query time boundaries, select and display items from lists, and[0m
[30;1m293 | [0m[35mconfigure the notebook environment.[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m<img src="./docs/source/visualization/_static/Timeline-08.png"[0m

[31m--[ [0m[34mMatch #[0m[33m929[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m284 | [0m[35m  resource data[0m
[30;1m285 | [0m[35m- extract Indicators of Activity (IoA) from logs and unpack encoded data[0m
[30;1m286 | [0m[35m- perform sophisticated analysis such as anomalous session detection and[0m
[30;1m287 | [0m[35m  time series decomposition[0m
[30;1m288 | [0m[35m- visualize data using interactive timelines, process trees and[0m
[30;1m289 | [0m[35m  multi-dimensional Morph Charts[0m
[30;1m290 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m930[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m9 | [0m[35mfrom .package import *  # noqa: F401, F403[0m
[30;1m10 | [0m[35mfrom .package import _MSTICPY_USER_AGENT[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m# All modules use the "export" decorator to control[0m
[30;1m13 | [0m[35m# pylint: disable=unused-import[0m
[30;1m14 | [0m[35mfrom .types import export, singleton  # noqa: F401[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m931[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m133 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m134 | [0m[35m        False or None (no sort)[0m
[30;1m135 | [0m[35m        True  - Sort ascending[0m
[30;1m136 | [0m[35m    hide : bool, optional[0m
[30;1m137 | [0m[35m        Creates and returns but does not display the plot, default[0m
[30;1m138 | [0m[35m        is False.[0m

[31m--[ [0m[34mMatch #[0m[33m932[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m        default is None.[0m
[30;1m131 | [0m[35m        Acceptable values are:[0m
[30;1m132 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m133 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m134 | [0m[35m        False or None (no sort)[0m
[30;1m135 | [0m[35m        True  - Sort ascending[0m
[30;1m136 | [0m[35m    hide : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m933[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m        Sorts the labels of the y axis (takes precedence over `sort`),[0m
[30;1m130 | [0m[35m        default is None.[0m
[30;1m131 | [0m[35m        Acceptable values are:[0m
[30;1m132 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m133 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m134 | [0m[35m        False or None (no sort)[0m
[30;1m135 | [0m[35m        True  - Sort ascending[0m

[31m--[ [0m[34mMatch #[0m[33m934[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m125 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m126 | [0m[35m        False or None (no sort)[0m
[30;1m127 | [0m[35m        True  - Sort ascending[0m
[30;1m128 | [0m[35m    sort_y : str, optional[0m
[30;1m129 | [0m[35m        Sorts the labels of the y axis (takes precedence over `sort`),[0m
[30;1m130 | [0m[35m        default is None.[0m

[31m--[ [0m[34mMatch #[0m[33m935[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m        default is None.[0m
[30;1m123 | [0m[35m        Acceptable values are:[0m
[30;1m124 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m125 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m126 | [0m[35m        False or None (no sort)[0m
[30;1m127 | [0m[35m        True  - Sort ascending[0m
[30;1m128 | [0m[35m    sort_y : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m936[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m        Sorts the labels of the x axis (takes precedence over `sort`),[0m
[30;1m122 | [0m[35m        default is None.[0m
[30;1m123 | [0m[35m        Acceptable values are:[0m
[30;1m124 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m125 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m126 | [0m[35m        False or None (no sort)[0m
[30;1m127 | [0m[35m        True  - Sort ascending[0m

[31m--[ [0m[34mMatch #[0m[33m937[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m117 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m118 | [0m[35m        False or None (no sort)[0m
[30;1m119 | [0m[35m        True  - Sort ascending[0m
[30;1m120 | [0m[35m    sort_x : str, optional[0m
[30;1m121 | [0m[35m        Sorts the labels of the x axis (takes precedence over `sort`),[0m
[30;1m122 | [0m[35m        default is None.[0m

[31m--[ [0m[34mMatch #[0m[33m938[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m        Sorts the labels of both axes, default is None.[0m
[30;1m115 | [0m[35m        Acceptable values are:[0m
[30;1m116 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m117 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m118 | [0m[35m        False or None (no sort)[0m
[30;1m119 | [0m[35m        True  - Sort ascending[0m
[30;1m120 | [0m[35m    sort_x : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m939[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m    sort : Union[str, bool], optional[0m
[30;1m114 | [0m[35m        Sorts the labels of both axes, default is None.[0m
[30;1m115 | [0m[35m        Acceptable values are:[0m
[30;1m116 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m117 | [0m[35m        'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m118 | [0m[35m        False or None (no sort)[0m
[30;1m119 | [0m[35m        True  - Sort ascending[0m

[31m--[ [0m[34mMatch #[0m[33m940[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/matrix_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m        The plot width. Default is 900[0m
[30;1m111 | [0m[35m    color : str[0m
[30;1m112 | [0m[35m        The color of the plotted points, default is "red"[0m
[30;1m113 | [0m[35m    sort : Union[str, bool], optional[0m
[30;1m114 | [0m[35m        Sorts the labels of both axes, default is None.[0m
[30;1m115 | [0m[35m        Acceptable values are:[0m
[30;1m116 | [0m[35m        'asc' (or string starting with 'asc') - Sort ascending[0m

[31m--[ [0m[34mMatch #[0m[33m941[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/package.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m299 | [0m[35m@export[0m
[30;1m300 | [0m[35mdef set_unit_testing(on: bool = True):[0m
[30;1m301 | [0m[35m    """[0m
[30;1m302 | [0m[35m    Set flag env var to indicated that code is being unit-tested.[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m    Parameters[0m
[30;1m305 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m942[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/package.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m        Boolean value to toggle user flag while installing pip packages,[0m
[30;1m110 | [0m[35m        by default False[0m
[30;1m111 | [0m[35m    upgrade: bool, option[0m
[30;1m112 | [0m[35m        If true supply `--upgrade` flag to pip to install the latest[0m
[30;1m113 | [0m[35m        version (applies to all package in `required_packages`)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    Returns[0m

[31m--[ [0m[34mMatch #[0m[33m943[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/utility/package.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m        Boolean value to force notebook version of progress bar,[0m
[30;1m107 | [0m[35m        by default False (autodetect)[0m
[30;1m108 | [0m[35m    user : bool, optional[0m
[30;1m109 | [0m[35m        Boolean value to toggle user flag while installing pip packages,[0m
[30;1m110 | [0m[35m        by default False[0m
[30;1m111 | [0m[35m    upgrade: bool, option[0m
[30;1m112 | [0m[35m        If true supply `--upgrade` flag to pip to install the latest[0m

[31m--[ [0m[34mMatch #[0m[33m944[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m944 | [0m[35m    """Return folium Icon from mapping or defaults."""[0m
[30;1m945 | [0m[35m    icon_kwargs: dict[str, Any] = {}[0m
[30;1m946 | [0m[35m    if isinstance(icon_map, dict):[0m
[30;1m947 | [0m[35m        icon_kwargs = icon_map.get(row[icon_column], icon_map.get("default", {}))[0m
[30;1m948 | [0m[35m    elif callable(icon_map):[0m
[30;1m949 | [0m[35m        icon_kwargs = icon_map(row[icon_column])[0m
[30;1m950 | [0m[35m    elif icon_column:[0m

[31m--[ [0m[34mMatch #[0m[33m945[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m944 | [0m[35m    """Return folium Icon from mapping or defaults."""[0m
[30;1m945 | [0m[35m    icon_kwargs: dict[str, Any] = {}[0m
[30;1m946 | [0m[35m    if isinstance(icon_map, dict):[0m
[30;1m947 | [0m[35m        icon_kwargs = icon_map.get(row[icon_column], icon_map.get("default", {}))[0m
[30;1m948 | [0m[35m    elif callable(icon_map):[0m
[30;1m949 | [0m[35m        icon_kwargs = icon_map(row[icon_column])[0m
[30;1m950 | [0m[35m    elif icon_column:[0m

[31m--[ [0m[34mMatch #[0m[33m946[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m771 | [0m[35m                }[0m
[30;1m772 | [0m[35m[0m
[30;1m773 | [0m[35m    FontAwesome icon (prefix "fa") names are available at https://fontawesome.com/[0m
[30;1m774 | [0m[35m    GlyphIcons icons (prefix "glyphicon") are available at https://www.glyphicons.com/[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m    """[0m
[30;1m777 | [0m[35m    folium_map = FoliumMap(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m947[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m770 | [0m[35m                    "icon": "info-sign",[0m
[30;1m771 | [0m[35m                }[0m
[30;1m772 | [0m[35m[0m
[30;1m773 | [0m[35m    FontAwesome icon (prefix "fa") names are available at https://fontawesome.com/[0m
[30;1m774 | [0m[35m    GlyphIcons icons (prefix "glyphicon") are available at https://www.glyphicons.com/[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m948[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m485 | [0m[35m        Returns[0m
[30;1m486 | [0m[35m        -------[0m
[30;1m487 | [0m[35m        Marker[0m
[30;1m488 | [0m[35m            A Folium Marker at the given location coordinates[0m
[30;1m489 | [0m[35m[0m
[30;1m490 | [0m[35m        """[0m
[30;1m491 | [0m[35m        return folium.Marker([0m

[31m--[ [0m[34mMatch #[0m[33m949[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m471 | [0m[35m        **kwargs,[0m
[30;1m472 | [0m[35m    ) -> folium.Marker:[0m
[30;1m473 | [0m[35m        """[0m
[30;1m474 | [0m[35m        Create and return a Folium Marker at a given location.[0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m        Parameters[0m
[30;1m477 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m950[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m    def enable_layer_control(self: Self) -> None:[0m
[30;1m406 | [0m[35m        """[0m
[30;1m407 | [0m[35m        Enable Layer Control on the map.[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m        Parameters[0m
[30;1m410 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m951[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1041 | [0m[35m    mode: str = "median",[0m
[30;1m1042 | [0m[35m) -> tuple[float, float]:[0m
[30;1m1043 | [0m[35m    """[0m
[30;1m1044 | [0m[35m    Return the geographical center of the IP address locations.[0m
[30;1m1045 | [0m[35m[0m
[30;1m1046 | [0m[35m    Parameters[0m
[30;1m1047 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m952[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1027 | [0m[35m) -> list[GeoLocation]:[0m
[30;1m1028 | [0m[35m    """Return the list of IP entities that have a Location property."""[0m
[30;1m1029 | [0m[35m    locations: list[GeoLocation] = [][0m
[30;1m1030 | [0m[35m    for ip in ip_entities:[0m
[30;1m1031 | [0m[35m        if isinstance(ip, list) and len(ip) > 0 and ip[0].Location is not None:[0m
[30;1m1032 | [0m[35m            locations.append(ip[0].Location)[0m
[30;1m1033 | [0m[35m        elif isinstance(ip, IpAddress) and ip.Location is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m953[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1025 | [0m[35mdef _extract_locs_ip_entities([0m
[30;1m1026 | [0m[35m    ip_entities: Iterable[IpAddress] | Iterable[list[IpAddress]],[0m
[30;1m1027 | [0m[35m) -> list[GeoLocation]:[0m
[30;1m1028 | [0m[35m    """Return the list of IP entities that have a Location property."""[0m
[30;1m1029 | [0m[35m    locations: list[GeoLocation] = [][0m
[30;1m1030 | [0m[35m    for ip in ip_entities:[0m
[30;1m1031 | [0m[35m        if isinstance(ip, list) and len(ip) > 0 and ip[0].Location is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m954[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m972 | [0m[35m@export[0m
[30;1m973 | [0m[35mdef get_map_center(entities: Iterable[Entity], mode: str = "modal"):[0m
[30;1m974 | [0m[35m    """[0m
[30;1m975 | [0m[35m    Calculate median point between Entity IP locations.[0m
[30;1m976 | [0m[35m[0m
[30;1m977 | [0m[35m    Parameters[0m
[30;1m978 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m955[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m776 | [0m[35m    """[0m
[30;1m777 | [0m[35m    folium_map = FoliumMap(**kwargs)[0m
[30;1m778 | [0m[35m    if ip_column and not (lat_column and long_column):[0m
[30;1m779 | [0m[35m        # resolve IP location and merge with input data.[0m
[30;1m780 | [0m[35m        data = data.merge([0m
[30;1m781 | [0m[35m            # pylint: disable=no-member[0m
[30;1m782 | [0m[35m            _GEO_LITE.lookup_ips(data, column=ip_column),[0m

[31m--[ [0m[34mMatch #[0m[33m956[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m661 | [0m[35m        The input DataFrame, must have either an IP address[0m
[30;1m662 | [0m[35m        column or latitude and longitude columns.[0m
[30;1m663 | [0m[35m    ip_column : str|None, optional[0m
[30;1m664 | [0m[35m        The name of the IP Address column, by default None[0m
[30;1m665 | [0m[35m    lat_column : str|None, optional[0m
[30;1m666 | [0m[35m        The name of the location 'latitude' column, by default None[0m
[30;1m667 | [0m[35m    long_column : str|None, optional[0m

[31m--[ [0m[34mMatch #[0m[33m957[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m658 | [0m[35m    Parameters[0m
[30;1m659 | [0m[35m    ----------[0m
[30;1m660 | [0m[35m    data : pd.DataFrame[0m
[30;1m661 | [0m[35m        The input DataFrame, must have either an IP address[0m
[30;1m662 | [0m[35m        column or latitude and longitude columns.[0m
[30;1m663 | [0m[35m    ip_column : str|None, optional[0m
[30;1m664 | [0m[35m        The name of the IP Address column, by default None[0m

[31m--[ [0m[34mMatch #[0m[33m958[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m        Parameters[0m
[30;1m166 | [0m[35m        ----------[0m
[30;1m167 | [0m[35m        ip_addresses : Iterable[str][0m
[30;1m168 | [0m[35m            Iterable of ip strings.[0m
[30;1m169 | [0m[35m        layer : str, optional[0m
[30;1m170 | [0m[35m            If not none, it will add the entities to a new layer.[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m959[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/foliummap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m        **kwargs,[0m
[30;1m106 | [0m[35m    ) -> None:[0m
[30;1m107 | [0m[35m        """[0m
[30;1m108 | [0m[35m        Add a collection of IP Entities to the map.[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        Parameters[0m
[30;1m111 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m960[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_register.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m        if len(col_keys) == 1:[0m
[30;1m259 | [0m[35m            # Only one input param so assume this is the src/left[0m
[30;1m260 | [0m[35m            # join key[0m
[30;1m261 | [0m[35m            left_on = func_kwargs.get(col_keys[0])[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    if right_on and not left_on:[0m
[30;1m264 | [0m[35m        warnings.warn([0m

[31m--[ [0m[34mMatch #[0m[33m961[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_register.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m            ent_name: str = entity.__class__.__name__[0m
[30;1m125 | [0m[35m        else:[0m
[30;1m126 | [0m[35m            ent_name = entity[0m
[30;1m127 | [0m[35m        return self.entity_map.get(ent_name)[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35mdef create_pivot_func([0m

[31m--[ [0m[34mMatch #[0m[33m962[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_register.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m437 | [0m[35m[0m
[30;1m438 | [0m[35m    if isinstance(input_value, pd.DataFrame):[0m
[30;1m439 | [0m[35m        # If the original input_value is a DataFrame[0m
[30;1m440 | [0m[35m        # try to find the column name specification in kwargs[0m
[30;1m441 | [0m[35m        for col_param in ([0m
[30;1m442 | [0m[35m            pivot_reg.func_df_col_param_name,[0m
[30;1m443 | [0m[35m            pivot_reg.func_input_value_arg,[0m

[31m--[ [0m[34mMatch #[0m[33m963[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_duration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m264 | [0m[35m        start_time=pd.NamedAgg(time_column, "min"),[0m
[30;1m265 | [0m[35m        end_time=pd.NamedAgg(end_time_column, "max"),[0m
[30;1m266 | [0m[35m    )[0m
[30;1m267 | [0m[35m    # If we don't have an endtime for certain types just consider them to be single time events[0m
[30;1m268 | [0m[35m    for row in grouped_data.iterrows():[0m
[30;1m269 | [0m[35m        if pd.isnull(row[1]["end_time"]):[0m
[30;1m270 | [0m[35m            grouped_data.at[row[0], "end_time"] = row[1]["start_time"][0m

[31m--[ [0m[34mMatch #[0m[33m964[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_duration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        If `end_time_column` is not specified it will also be used to[0m
[30;1m105 | [0m[35m        calculate the end time.[0m
[30;1m106 | [0m[35m    end_time_column : Optional[str][0m
[30;1m107 | [0m[35m        If supplied, it will be used to calculate the end time[0m
[30;1m108 | [0m[35m        of the duration for each group.[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    Other Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m965[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_duration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m        The column name or iterable of column names to group the data by.[0m
[30;1m101 | [0m[35m    time_column : str[0m
[30;1m102 | [0m[35m        Primary time column - will be used to calculate the[0m
[30;1m103 | [0m[35m        start time of the duration for each group.[0m
[30;1m104 | [0m[35m        If `end_time_column` is not specified it will also be used to[0m
[30;1m105 | [0m[35m        calculate the end time.[0m
[30;1m106 | [0m[35m    end_time_column : Optional[str][0m

[31m--[ [0m[34mMatch #[0m[33m966[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_duration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m    group_by : Union[Iterable[str], str][0m
[30;1m100 | [0m[35m        The column name or iterable of column names to group the data by.[0m
[30;1m101 | [0m[35m    time_column : str[0m
[30;1m102 | [0m[35m        Primary time column - will be used to calculate the[0m
[30;1m103 | [0m[35m        start time of the duration for each group.[0m
[30;1m104 | [0m[35m        If `end_time_column` is not specified it will also be used to[0m
[30;1m105 | [0m[35m        calculate the end time.[0m

[31m--[ [0m[34mMatch #[0m[33m967[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m# Licensed under the MIT License. See License.txt in the project root for[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""Setup script for msticpy."""[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport re[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m968[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_register_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m        # use safe_load instead load[0m
[30;1m151 | [0m[35m        pivot_regs = yaml.safe_load(f_handle)[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    for entry_name, settings in pivot_regs.get("pivot_providers").items():[0m
[30;1m154 | [0m[35m        try:[0m
[30;1m155 | [0m[35m            yield PivotRegistration(  # type: ignore[call-arg][0m
[30;1m156 | [0m[35m                src_config_path=file_path, src_config_entry=entry_name, **settings[0m

[31m--[ [0m[34mMatch #[0m[33m969[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_register_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        if not func:[0m
[30;1m97 | [0m[35m            raise ValueError([0m
[30;1m98 | [0m[35m                f"Could not find function {piv_reg.src_func_name}",[0m
[30;1m99 | [0m[35m                piv_reg.src_config_entry,[0m
[30;1m100 | [0m[35m                piv_reg.src_config_path,[0m
[30;1m101 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m970[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_register_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m            continue[0m
[30;1m76 | [0m[35m        if piv_reg.src_class:[0m
[30;1m77 | [0m[35m            # if we need to get this from a class/object we need[0m
[30;1m78 | [0m[35m            # to find or create one.[0m
[30;1m79 | [0m[35m            func = None[0m
[30;1m80 | [0m[35m            # Suppress Msticpy exception display when instantiating classes.[0m
[30;1m81 | [0m[35m            with MsticpyUserError.no_display_exceptions():[0m

[31m--[ [0m[34mMatch #[0m[33m971[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/preprocess_observable.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m        """[0m
[30;1m302 | [0m[35m        proc_value: str | None = value.strip()[0m
[30;1m303 | [0m[35m        result: SanitizedObservable = SanitizedObservable(proc_value, "ok")[0m
[30;1m304 | [0m[35m        for processor in self._processors.get(value_type, []):[0m
[30;1m305 | [0m[35m            if processor == self._TYPE_CHECK:[0m
[30;1m306 | [0m[35m                result = _validate_ioc_type(proc_value, value_type)[0m
[30;1m307 | [0m[35m            elif isinstance(processor, str):[0m

[31m--[ [0m[34mMatch #[0m[33m972[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/preprocess_observable.py[0m
   Pattern: [32m.hostname[0m
[30;1m248 | [0m[35m        ({"url"}, [_TYPE_CHECK, _preprocess_url]),[0m
[30;1m249 | [0m[35m        ({"ipv4"}, [_TYPE_CHECK, _preprocess_ip]),[0m
[30;1m250 | [0m[35m        ({"ipv6"}, [_TYPE_CHECK, partial(_preprocess_ip, version=6)]),[0m
[30;1m251 | [0m[35m        ({"dns", "hostname"}, [_TYPE_CHECK, _preprocess_dns]),[0m
[30;1m252 | [0m[35m        ([0m
[30;1m253 | [0m[35m            {"md5_hash", "sha1_hash", "sha256_hash", "file_hash"},[0m
[30;1m254 | [0m[35m            [_TYPE_CHECK, _preprocess_hash],[0m

[31m--[ [0m[34mMatch #[0m[33m973[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/preprocess_observable.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m        return SanitizedObservable(None, "Domain is unqualified domain name")[0m
[30;1m210 | [0m[35m    with contextlib.suppress(ValueError):[0m
[30;1m211 | [0m[35m        _: IPv4Address | IPv6Address = ip_address(domain)[0m
[30;1m212 | [0m[35m        return SanitizedObservable(None, "Domain is an IP address")[0m
[30;1m213 | [0m[35m    return SanitizedObservable(domain, "ok")[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m974[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/preprocess_observable.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35mdef _preprocess_ip(ipaddress: str, version: int = 4) -> SanitizedObservable:[0m
[30;1m187 | [0m[35m    """Ensure Ip address is a valid public IPv4 address."""[0m
[30;1m188 | [0m[35m    ipaddress = refang_ioc(ioc=ipaddress, ioc_type="ipv4")[0m
[30;1m189 | [0m[35m    try:[0m
[30;1m190 | [0m[35m        addr: IPv4Address | IPv6Address = ip_address(ipaddress)[0m

[31m--[ [0m[34mMatch #[0m[33m975[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/preprocess_observable.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m        if addr.is_loopback:[0m
[30;1m97 | [0m[35m            return SanitizedObservable([0m
[30;1m98 | [0m[35m                None,[0m
[30;1m99 | [0m[35m                "Host part of URL is a loopback IP address",[0m
[30;1m100 | [0m[35m            )[0m
[30;1m101 | [0m[35m    if "." not in host:[0m
[30;1m102 | [0m[35m        return SanitizedObservable(None, "Host is unqualified domain name")[0m

[31m--[ [0m[34mMatch #[0m[33m976[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/preprocess_observable.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m    with contextlib.suppress(ValueError):[0m
[30;1m93 | [0m[35m        addr: IPv4Address | IPv6Address = ip_address(host)[0m
[30;1m94 | [0m[35m        if addr.is_private:[0m
[30;1m95 | [0m[35m            return SanitizedObservable(None, "Host part of URL is a private IP address")[0m
[30;1m96 | [0m[35m        if addr.is_loopback:[0m
[30;1m97 | [0m[35m            return SanitizedObservable([0m
[30;1m98 | [0m[35m                None,[0m

[31m--[ [0m[34mMatch #[0m[33m977[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pipeline.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m            Iterable of pipeline instances[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        """[0m
[30;1m232 | [0m[35m        for p_name, pipeline in pipelines.get("pipelines", {}).items():[0m
[30;1m233 | [0m[35m            yield Pipeline.parse_pipeline({p_name: pipeline})[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m978[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pipeline.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        if pl_dict and isinstance(pl_dict, dict):[0m
[30;1m210 | [0m[35m            steps = [PipelineStep(**step) for step in pl_dict.get("steps", [])][0m
[30;1m211 | [0m[35m            return cls([0m
[30;1m212 | [0m[35m                name=pl_name, description=pl_dict.get("description"), steps=steps[0m
[30;1m213 | [0m[35m            )[0m
[30;1m214 | [0m[35m        raise ValueError("Dictionary could not be parsed.")[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m979[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_pipeline.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m        """[0m
[30;1m208 | [0m[35m        pl_name, pl_dict = next(iter(pipeline.items()))[0m
[30;1m209 | [0m[35m        if pl_dict and isinstance(pl_dict, dict):[0m
[30;1m210 | [0m[35m            steps = [PipelineStep(**step) for step in pl_dict.get("steps", [])][0m
[30;1m211 | [0m[35m            return cls([0m
[30;1m212 | [0m[35m                name=pl_name, description=pl_dict.get("description"), steps=steps[0m
[30;1m213 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m980[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mordor_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m    def _select_ds_item(self, change):  # noqa: MC0001[0m
[30;1m219 | [0m[35m        """Handle change of dataset selection."""[0m
[30;1m220 | [0m[35m        item_id = change.get("new")[0m
[30;1m221 | [0m[35m        mdr_item = self.mdr_metadata.get(item_id)[0m
[30;1m222 | [0m[35m        if not mdr_item:[0m
[30;1m223 | [0m[35m            self._clear_fields()[0m
[30;1m224 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m981[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mordor_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    def _select_ds_item(self, change):  # noqa: MC0001[0m
[30;1m219 | [0m[35m        """Handle change of dataset selection."""[0m
[30;1m220 | [0m[35m        item_id = change.get("new")[0m
[30;1m221 | [0m[35m        mdr_item = self.mdr_metadata.get(item_id)[0m
[30;1m222 | [0m[35m        if not mdr_item:[0m
[30;1m223 | [0m[35m            self._clear_fields()[0m

[31m--[ [0m[34mMatch #[0m[33m982[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mordor_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        """[0m
[30;1m45 | [0m[35m        mdr_settings = get_config("DataProviders.Mordor", {})[0m
[30;1m46 | [0m[35m        self._save_folder = save_folder or mdr_settings.get("save_folder", ".")[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        self._use_cached = use_cached[0m
[30;1m49 | [0m[35m        self.mordor_driver = MordorDriver()[0m

[31m--[ [0m[34mMatch #[0m[33m983[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m710 | [0m[35m    matches: re.Match[str] | None = re.match(param_regex, parameters)[0m
[30;1m711 | [0m[35m    if matches:[0m
[30;1m712 | [0m[35m        result: list[str] = [[0m
[30;1m713 | [0m[35m            param_dict.get(match, parameters) for match in matches.groups()[0m
[30;1m714 | [0m[35m        ][0m
[30;1m715 | [0m[35m        if len(result) == 1:[0m
[30;1m716 | [0m[35m            return result[0][0m

[31m--[ [0m[34mMatch #[0m[33m984[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m641 | [0m[35m        config_key: str = f"{config_name}-{instance}" if instance else config_name[0m
[30;1m642 | [0m[35m        drv_config: ProviderSettings | None = get_provider_settings([0m
[30;1m643 | [0m[35m            "DataProviders",[0m
[30;1m644 | [0m[35m        ).get(config_key)[0m
[30;1m645 | [0m[35m        app_config: dict[str, str] = {}[0m
[30;1m646 | [0m[35m        if drv_config:[0m
[30;1m647 | [0m[35m            app_config = dict(drv_config.args)[0m

[31m--[ [0m[34mMatch #[0m[33m985[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m482 | [0m[35m        status: str | None = None[0m
[30;1m483 | [0m[35m        cur_try: int = 0[0m
[30;1m484 | [0m[35m        while status != "SUCCESS" and cur_try < max_retry:[0m
[30;1m485 | [0m[35m            response: httpx.Response = self.client.post([0m
[30;1m486 | [0m[35m                self.search_endpoint,[0m
[30;1m487 | [0m[35m                json={**body, **pagination},[0m
[30;1m488 | [0m[35m                headers=headers,[0m

[31m--[ [0m[34mMatch #[0m[33m986[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m        simple_values: dict[str, Any] = entry.get("simpleValues", {})[0m
[30;1m339 | [0m[35m        result = CybereasonDriver._flatten_simple_values(simple_values)[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m        elt_value: list[dict[str, Any]] | dict[str, Any] = entry.get([0m
[30;1m342 | [0m[35m            "elementValues",[0m
[30;1m343 | [0m[35m            {},[0m
[30;1m344 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m987[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m335 | [0m[35m        """[0m
[30;1m336 | [0m[35m        result: dict[str, Any] = {}[0m
[30;1m337 | [0m[35m        # Retrieve simpleValues and add them to the output[0m
[30;1m338 | [0m[35m        simple_values: dict[str, Any] = entry.get("simpleValues", {})[0m
[30;1m339 | [0m[35m        result = CybereasonDriver._flatten_simple_values(simple_values)[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m        elt_value: list[dict[str, Any]] | dict[str, Any] = entry.get([0m

[31m--[ [0m[34mMatch #[0m[33m988[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m        }[0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m        # Authenticate and obtain cookie for future calls[0m
[30;1m314 | [0m[35m        response = self.client.post(self.auth_endpoint, data=req_body)[0m
[30;1m315 | [0m[35m        response.raise_for_status()[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m        logger.info("Connected.")[0m

[31m--[ [0m[34mMatch #[0m[33m989[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m        self.set_driver_property(DriverProps.SUPPORTS_THREADING, value=True)[0m
[30;1m114 | [0m[35m        self.set_driver_property([0m
[30;1m115 | [0m[35m            DriverProps.MAX_PARALLEL,[0m
[30;1m116 | [0m[35m            value=kwargs.get("max_threads", 4),[0m
[30;1m117 | [0m[35m        )[0m
[30;1m118 | [0m[35m        self._debug: bool = debug[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m990[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m198 | [0m[35m        page_size: int[0m
[30;1m199 | [0m[35m            number of results to return per page[0m
[30;1m200 | [0m[35m        pagination_token: str[0m
[30;1m201 | [0m[35m            Cybereason built-in pagination tracker[0m
[30;1m202 | [0m[35m        total_results: int[0m
[30;1m203 | [0m[35m            Number of results for the executed query.[0m
[30;1m204 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m991[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m153 | [0m[35m        json_query: dict[str, Any] = json.loads(query)[0m
[30;1m154 | [0m[35m        body: dict[str, Any] = {**self.req_body, **json_query}[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m        # The query must be executed at least once to retrieve the number[0m
[30;1m157 | [0m[35m        # of results and the pagination token.[0m
[30;1m158 | [0m[35m        response: dict[str, Any] = self.__execute_query(body, page_size=page_size)[0m
[30;1m159 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m992[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m@_recursive_find_and_replace.register(str)[0m
[30;1m707 | [0m[35mdef _(parameters: str, param_dict: dict[str, Any]) -> str | list[str]:[0m
[30;1m708 | [0m[35m    """Recursively find and replace parameters from query."""[0m
[30;1m709 | [0m[35m    param_regex: str = r"{([^}]+)}"[0m
[30;1m710 | [0m[35m    matches: re.Match[str] | None = re.match(param_regex, parameters)[0m
[30;1m711 | [0m[35m    if matches:[0m

[31m--[ [0m[34mMatch #[0m[33m993[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m664 | [0m[35m    parameters: str | dict[str, Any] | list[str] | list[dict[str, Any]],[0m
[30;1m665 | [0m[35m    param_dict: dict[str, Any],[0m
[30;1m666 | [0m[35m) -> str | dict[str, Any] | list[str] | list[dict[str, Any]]:[0m
[30;1m667 | [0m[35m    """Recursively find and replace parameters from query."""[0m
[30;1m668 | [0m[35m    if isinstance(parameters, (list, str, dict)):[0m
[30;1m669 | [0m[35m        return _recursive_find_and_replace(parameters, param_dict)[0m
[30;1m670 | [0m[35m    return parameters[0m

[31m--[ [0m[34mMatch #[0m[33m994[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m555 | [0m[35m                            query_id,[0m
[30;1m556 | [0m[35m                            exc_info=True,[0m
[30;1m557 | [0m[35m                        )[0m
[30;1m558 | [0m[35m            # Sort the results by the order of the tasks[0m
[30;1m559 | [0m[35m            results = [result for _, result in sorted(zip(thread_tasks, results))][0m
[30;1m560 | [0m[35m        return pd.concat(results, ignore_index=True)[0m
[30;1m561 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m995[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m            "perGroupLimit": 100,[0m
[30;1m92 | [0m[35m            "perFeatureLimit": 100,[0m
[30;1m93 | [0m[35m            "templateContext": "SPECIFIC",[0m
[30;1m94 | [0m[35m            "queryTimeout": timeout * 1000,[0m
[30;1m95 | [0m[35m            "customFields": [],[0m
[30;1m96 | [0m[35m        }[0m
[30;1m97 | [0m[35m        self.search_endpoint: str = "/rest/visualsearch/query/simple"[0m

[31m--[ [0m[34mMatch #[0m[33m996[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        """[0m
[30;1m82 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m83 | [0m[35m        logger.debug("Set timeout to %d", timeout)[0m
[30;1m84 | [0m[35m        max_results = min(max_results, 100000)[0m
[30;1m85 | [0m[35m        logger.debug("Set maximum results to %d", max_results)[0m
[30;1m86 | [0m[35m        self.base_url: str = "https://{tenant_id}.cybereason.net"[0m

[31m--[ [0m[34mMatch #[0m[33m997[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m        Additional Parameters[0m
[30;1m68 | [0m[35m        ---------------------[0m
[30;1m69 | [0m[35m        timeout : int[0m
[30;1m70 | [0m[35m            Query timeout in seconds. Defaults to 120 seconds[0m
[30;1m71 | [0m[35m        max_results : int[0m
[30;1m72 | [0m[35m            Number of total results to return. Defaults to 1000[0m
[30;1m73 | [0m[35m            Max is 10,000.[0m

[31m--[ [0m[34mMatch #[0m[33m998[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/cybereason_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        Additional Parameters[0m
[30;1m68 | [0m[35m        ---------------------[0m
[30;1m69 | [0m[35m        timeout : int[0m
[30;1m70 | [0m[35m            Query timeout in seconds. Defaults to 120 seconds[0m
[30;1m71 | [0m[35m        max_results : int[0m
[30;1m72 | [0m[35m            Number of total results to return. Defaults to 1000[0m

[31m--[ [0m[34mMatch #[0m[33m999[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_velociraptor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m                "VelociraptorLogs"[0m
[30;1m66 | [0m[35m            )[0m
[30;1m67 | [0m[35m            if prov_settings:[0m
[30;1m68 | [0m[35m                self._paths = prov_settings.args.get("data_paths", []) or self._paths[0m
[30;1m69 | [0m[35m                logger.info("data paths read from config %s", str(self._paths))[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m        self.data_files: Dict[str, List[Path]] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m1000[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_velociraptor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m            self._paths = [path.strip() for path in data_paths][0m
[30;1m62 | [0m[35m            logger.info("data paths read from param %s", str(self._paths))[0m
[30;1m63 | [0m[35m        else:[0m
[30;1m64 | [0m[35m            prov_settings = get_provider_settings(config_section="DataProviders").get([0m
[30;1m65 | [0m[35m                "VelociraptorLogs"[0m
[30;1m66 | [0m[35m            )[0m
[30;1m67 | [0m[35m            if prov_settings:[0m

[31m--[ [0m[34mMatch #[0m[33m1001[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_velociraptor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        self._paths: List[str] = ["."][0m
[30;1m58 | [0m[35m        # If data paths specified, use these[0m
[30;1m59 | [0m[35m        # from kwargs or settings[0m
[30;1m60 | [0m[35m        if data_paths := kwargs.get("data_paths"):[0m
[30;1m61 | [0m[35m            self._paths = [path.strip() for path in data_paths][0m
[30;1m62 | [0m[35m            logger.info("data paths read from param %s", str(self._paths))[0m
[30;1m63 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1002[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_velociraptor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        """[0m
[30;1m52 | [0m[35m        del connection_str[0m
[30;1m53 | [0m[35m        if kwargs.get("debug", False):[0m
[30;1m54 | [0m[35m            logger.setLevel(logging.DEBUG)[0m
[30;1m55 | [0m[35m        super().__init__()[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1003[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/timespan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m            if isinstance(time_val, str):[0m
[30;1m190 | [0m[35m                return pd.Timedelta(time_val).to_pytimedelta()[0m
[30;1m191 | [0m[35m        raise ValueError([0m
[30;1m192 | [0m[35m            "'period' must be a pandas-compatible time period string",[0m
[30;1m193 | [0m[35m            " or Python timedelta.",[0m
[30;1m194 | [0m[35m        )[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1004[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/timespan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m        start : Optional[Union[datetime, str]], optional[0m
[30;1m47 | [0m[35m            datetime of the start of the time period, by default None[0m
[30;1m48 | [0m[35m        end : Optional[Union[datetime, str]], optional[0m
[30;1m49 | [0m[35m            datetime of the end of the time period, by default utcnow[0m
[30;1m50 | [0m[35m        period : Optional[Union[timedelta, str]], optional[0m
[30;1m51 | [0m[35m            duration of the period, by default None[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1005[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/timespan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m            `period` date_time-like attributes.[0m
[30;1m45 | [0m[35m            By default None[0m
[30;1m46 | [0m[35m        start : Optional[Union[datetime, str]], optional[0m
[30;1m47 | [0m[35m            datetime of the start of the time period, by default None[0m
[30;1m48 | [0m[35m        end : Optional[Union[datetime, str]], optional[0m
[30;1m49 | [0m[35m            datetime of the end of the time period, by default utcnow[0m
[30;1m50 | [0m[35m        period : Optional[Union[timedelta, str]], optional[0m

[31m--[ [0m[34mMatch #[0m[33m1006[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/option_buttons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m                self._timer_label.value = f"Option selected: '{self.value}'"[0m
[30;1m145 | [0m[35m                return[0m
[30;1m146 | [0m[35m            await asyncio.sleep(1)[0m
[30;1m147 | [0m[35m            timeout -= 1[0m
[30;1m148 | [0m[35m        self.value = self.default[0m
[30;1m149 | [0m[35m        self._timer_label.value = f"Timed out. Defaulted to '{self.value}'"[0m
[30;1m150 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1007[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/option_buttons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    async def _await_timer(self, timeout: int = 5):[0m
[30;1m140 | [0m[35m        timeout = max(timeout, 0)[0m
[30;1m141 | [0m[35m        while timeout > 0:[0m
[30;1m142 | [0m[35m            self._timer_label.value = f"Waiting {timeout} sec..."[0m
[30;1m143 | [0m[35m            if self.value:[0m
[30;1m144 | [0m[35m                self._timer_label.value = f"Option selected: '{self.value}'"[0m

[31m--[ [0m[34mMatch #[0m[33m1008[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/option_buttons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m                self._debug_out("*")[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    async def _await_timer(self, timeout: int = 5):[0m
[30;1m140 | [0m[35m        timeout = max(timeout, 0)[0m
[30;1m141 | [0m[35m        while timeout > 0:[0m
[30;1m142 | [0m[35m            self._timer_label.value = f"Waiting {timeout} sec..."[0m
[30;1m143 | [0m[35m            if self.value:[0m

[31m--[ [0m[34mMatch #[0m[33m1009[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/option_buttons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m        self._timer_label = widgets.Label(layout=widgets.Layout(left="10px"))[0m
[30;1m81 | [0m[35m        self.default = default or next(iter(buttons)).casefold()[0m
[30;1m82 | [0m[35m        self.value: Optional[str] = None[0m
[30;1m83 | [0m[35m        self.timeout = timeout[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        self._completion: Any = None[0m
[30;1m86 | [0m[35m        self._fut_val: Any = None[0m

[31m--[ [0m[34mMatch #[0m[33m1010[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/option_buttons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m            The default value to use on timeout, by default the[0m
[30;1m67 | [0m[35m            first value in the `buttons` list[0m
[30;1m68 | [0m[35m        timeout : int, optional[0m
[30;1m69 | [0m[35m            Timeout in seconds, by default 0[0m
[30;1m70 | [0m[35m        debug : bool, optional[0m
[30;1m71 | [0m[35m            Adds some debug information to an Output controle,[0m
[30;1m72 | [0m[35m            by default False[0m

[31m--[ [0m[34mMatch #[0m[33m1011[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/option_buttons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        default : Optional[str], optional[0m
[30;1m66 | [0m[35m            The default value to use on timeout, by default the[0m
[30;1m67 | [0m[35m            first value in the `buttons` list[0m
[30;1m68 | [0m[35m        timeout : int, optional[0m
[30;1m69 | [0m[35m            Timeout in seconds, by default 0[0m
[30;1m70 | [0m[35m        debug : bool, optional[0m
[30;1m71 | [0m[35m            Adds some debug information to an Output controle,[0m

[31m--[ [0m[34mMatch #[0m[33m1012[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/option_buttons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    The widget can be run in synchronous mode as a simple option[0m
[30;1m25 | [0m[35m    selector or in async mode with a timeout.[0m
[30;1m26 | [0m[35m    In the latter mode, after the timeout has expired the widget[0m
[30;1m27 | [0m[35m    value is set to the default option button value.[0m
[30;1m28 | [0m[35m    To use the async mode you must call `widget.display_async()` with[0m
[30;1m29 | [0m[35m    the async keyword.[0m

[31m--[ [0m[34mMatch #[0m[33m1013[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m562 | [0m[35m        ):[0m
[30;1m563 | [0m[35m            bearer_token = raw_token[0][2][0m
[30;1m564 | [0m[35m            if ([0m
[30;1m565 | [0m[35m                parser.parse(bearer_token.get("expiresOn", datetime.min))[0m
[30;1m566 | [0m[35m                < datetime.now()[0m
[30;1m567 | [0m[35m            ):[0m
[30;1m568 | [0m[35m                raise ValueError("AADSTS70043: The refresh token has expired")[0m

[31m--[ [0m[34mMatch #[0m[33m1014[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m) -> ManagedIdentityCredential:[0m
[30;1m178 | [0m[35m    """Build a credential from Managed Identity."""[0m
[30;1m179 | [0m[35m    msi_kwargs: dict[str, Any] = kwargs.copy()[0m
[30;1m180 | [0m[35m    client_id = client_id or os.environ.get(AzureCredEnvNames.AZURE_CLIENT_ID)[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    try:[0m
[30;1m183 | [0m[35m        cred = ManagedIdentityCredential(client_id=client_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1015[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m    sources:[0m
[30;1m372 | [0m[35m    - Azure Auth Environment variables[0m
[30;1m373 | [0m[35m    - Azure CLI (if an active session is logged on)[0m
[30;1m374 | [0m[35m    - Managed Service Identity[0m
[30;1m375 | [0m[35m    - Interactive browser logon[0m
[30;1m376 | [0m[35m    - and others - see list_auth_methods for full list.[0m
[30;1m377 | [0m[35m    If the authentication is successful both ADAL (legacy) and[0m

[31m--[ [0m[34mMatch #[0m[33m1016[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m            return EnvironmentCredential(authority=aad_uri)[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    # avoid creating env credential if require envs not set.[0m
[30;1m145 | [0m[35m    logger.info("'env' credential requested but required env vars not set")[0m
[30;1m146 | [0m[35m    return None[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1017[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m        if all(var in os.environ for var in env_vars):[0m
[30;1m142 | [0m[35m            return EnvironmentCredential(authority=aad_uri)[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    # avoid creating env credential if require envs not set.[0m
[30;1m145 | [0m[35m    logger.info("'env' credential requested but required env vars not set")[0m
[30;1m146 | [0m[35m    return None[0m
[30;1m147 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1018[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m    # [SuppressMessage([0m
[30;1m107 | [0m[35m    #   "Microsoft.Security",[0m
[30;1m108 | [0m[35m    #   "CS002:SecretInNextLine",[0m
[30;1m109 | [0m[35m    #   Justification="This is an enum of env variable names"[0m
[30;1m110 | [0m[35m    # )][0m
[30;1m111 | [0m[35m    AZURE_PASSWORD: ClassVar[str] = "AZURE_PASSWORD"  # User password  # nosec  # noqa[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1019[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m    # [SuppressMessage([0m
[30;1m81 | [0m[35m    #   "Microsoft.Security",[0m
[30;1m82 | [0m[35m    #   "CS002:SecretInNextLine",[0m
[30;1m83 | [0m[35m    #   Justification="This is an enum of env variable names"[0m
[30;1m84 | [0m[35m    # )][0m
[30;1m85 | [0m[35m    AZURE_CLIENT_SECRET: ClassVar[str] = "AZURE_CLIENT_SECRET"  # nosec  # noqa[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1020[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m        "AZURE_CLIENT_ID"  # The app ID for the service principal[0m
[30;1m76 | [0m[35m    )[0m
[30;1m77 | [0m[35m    AZURE_TENANT_ID: ClassVar[str] = ([0m
[30;1m78 | [0m[35m        "AZURE_TENANT_ID"  # The service principal's Azure AD tenant ID[0m
[30;1m79 | [0m[35m    )[0m
[30;1m80 | [0m[35m    # [SuppressMessage([0m
[30;1m81 | [0m[35m    #   "Microsoft.Security",[0m

[31m--[ [0m[34mMatch #[0m[33m1021[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m    """Enumeration of Azure environment credential names."""[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    AZURE_CLIENT_ID: ClassVar[str] = ([0m
[30;1m75 | [0m[35m        "AZURE_CLIENT_ID"  # The app ID for the service principal[0m
[30;1m76 | [0m[35m    )[0m
[30;1m77 | [0m[35m    AZURE_TENANT_ID: ClassVar[str] = ([0m
[30;1m78 | [0m[35m        "AZURE_TENANT_ID"  # The service principal's Azure AD tenant ID[0m

[31m--[ [0m[34mMatch #[0m[33m1022[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m694 | [0m[35m            continue[0m
[30;1m695 | [0m[35m        if ([0m
[30;1m696 | [0m[35m            arg not in src_df.columns[0m
[30;1m697 | [0m[35m            or not isinstance(func_kwargs.get(kw_name), str)[0m
[30;1m698 | [0m[35m            or kw_name not in func_params[0m
[30;1m699 | [0m[35m        ):[0m
[30;1m700 | [0m[35m            # Not intended/usable as a column specification[0m

[31m--[ [0m[34mMatch #[0m[33m1023[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m485 | [0m[35mdef _format_func_name(name, family, func_params, q_piv_settings):[0m
[30;1m486 | [0m[35m    # To help disambiguation we prefix the function name with[0m
[30;1m487 | [0m[35m    # the table name (or short version)[0m
[30;1m488 | [0m[35m    table_name = func_params.table.get("default", "")[0m
[30;1m489 | [0m[35m    t_prefix = _get_query_prefix(table_name, family)[0m
[30;1m490 | [0m[35m    if t_prefix and not t_prefix.endswith("_"):[0m
[30;1m491 | [0m[35m        t_prefix = f"{t_prefix}_"[0m

[31m--[ [0m[34mMatch #[0m[33m1024[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m        set of parameter attributes will be returned for each query.[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m        """[0m
[30;1m327 | [0m[35m        return self.param_usage.get(param_name, [])[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m# Map of query parameter names to entities and the entity attrib[0m

[31m--[ [0m[34mMatch #[0m[33m1025[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m            (all, required, full_required, param_attrs, table)[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m        """[0m
[30;1m304 | [0m[35m        return self.query_params.get(query_func_name)[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m    def get_param_attrs(self, param_name: str) -> List[ParamAttrs]:[0m
[30;1m307 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1026[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m            (query_name, query_family, getattr(self._provider, query_func_name))[0m
[30;1m281 | [0m[35m            for query_name, query_family, query_func_name in ([0m
[30;1m282 | [0m[35m                (param.query, param.family, f"{param.family}.{param.query}")[0m
[30;1m283 | [0m[35m                for param in self.param_usage.get(param)  # type:ignore[0m
[30;1m284 | [0m[35m            )[0m
[30;1m285 | [0m[35m        ][0m
[30;1m286 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1027[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m            query_name, query_func[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m        """[0m
[30;1m276 | [0m[35m        param_usage = self.param_usage.get(param)[0m
[30;1m277 | [0m[35m        if not param_usage:[0m
[30;1m278 | [0m[35m            return [][0m
[30;1m279 | [0m[35m        return [[0m

[31m--[ [0m[34mMatch #[0m[33m1028[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m            query_name, param_type, query_func[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        """[0m
[30;1m246 | [0m[35m        param_usage = self.param_usage.get(param)[0m
[30;1m247 | [0m[35m        if param_usage is None:[0m
[30;1m248 | [0m[35m            return [][0m
[30;1m249 | [0m[35m        get_param_props = ([0m

[31m--[ [0m[34mMatch #[0m[33m1029[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        return PivQuerySettings([0m
[30;1m223 | [0m[35m            short_name=qs_pivot.get("short_name"),[0m
[30;1m224 | [0m[35m            direct_func_entities=qs_pivot.get("direct_func_entities"),[0m
[30;1m225 | [0m[35m            assigned_entities=qs_pivot.get("assigned_entities"),[0m
[30;1m226 | [0m[35m        )[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m    def get_queries_and_types_for_param([0m

[31m--[ [0m[34mMatch #[0m[33m1030[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        qs_pivot = self.get_query_settings(family, query).metadata.get("pivot", {})[0m
[30;1m222 | [0m[35m        return PivQuerySettings([0m
[30;1m223 | [0m[35m            short_name=qs_pivot.get("short_name"),[0m
[30;1m224 | [0m[35m            direct_func_entities=qs_pivot.get("direct_func_entities"),[0m
[30;1m225 | [0m[35m            assigned_entities=qs_pivot.get("assigned_entities"),[0m
[30;1m226 | [0m[35m        )[0m
[30;1m227 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1031[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m        """[0m
[30;1m221 | [0m[35m        qs_pivot = self.get_query_settings(family, query).metadata.get("pivot", {})[0m
[30;1m222 | [0m[35m        return PivQuerySettings([0m
[30;1m223 | [0m[35m            short_name=qs_pivot.get("short_name"),[0m
[30;1m224 | [0m[35m            direct_func_entities=qs_pivot.get("direct_func_entities"),[0m
[30;1m225 | [0m[35m            assigned_entities=qs_pivot.get("assigned_entities"),[0m
[30;1m226 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1032[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m              mapping is not applicable).[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m        """[0m
[30;1m221 | [0m[35m        qs_pivot = self.get_query_settings(family, query).metadata.get("pivot", {})[0m
[30;1m222 | [0m[35m        return PivQuerySettings([0m
[30;1m223 | [0m[35m            short_name=qs_pivot.get("short_name"),[0m
[30;1m224 | [0m[35m            direct_func_entities=qs_pivot.get("direct_func_entities"),[0m

[31m--[ [0m[34mMatch #[0m[33m1033[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            If `family`.`query` could not be found.[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        """[0m
[30;1m194 | [0m[35m        q_source = self._provider.query_store.data_families.get(family, {}).get(query)[0m
[30;1m195 | [0m[35m        if not q_source:[0m
[30;1m196 | [0m[35m            raise KeyError(f"No query found for {family}.{query}")[0m
[30;1m197 | [0m[35m        return q_source[0m

[31m--[ [0m[34mMatch #[0m[33m1034[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            If `family`.`query` could not be found.[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        """[0m
[30;1m194 | [0m[35m        q_source = self._provider.query_store.data_families.get(family, {}).get(query)[0m
[30;1m195 | [0m[35m        if not q_source:[0m
[30;1m196 | [0m[35m            raise KeyError(f"No query found for {family}.{query}")[0m
[30;1m197 | [0m[35m        return q_source[0m

[31m--[ [0m[34mMatch #[0m[33m1035[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m                        )[0m
[30;1m151 | [0m[35m                        for param, p_attrs in q_source.params.items()[0m
[30;1m152 | [0m[35m                    },[0m
[30;1m153 | [0m[35m                    table=q_source.params.get("table", {}),[0m
[30;1m154 | [0m[35m                )[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1036[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        return family[0m
[30;1m87 | [0m[35m    if _use_v1_query_naming():[0m
[30;1m88 | [0m[35m        return _V1_TABLE_SHORT_NAMES.get(table, table)[0m
[30;1m89 | [0m[35m    return _V2_TABLE_SHORT_NAMES.get(table, table)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mclass PivotQueryFunctions:[0m

[31m--[ [0m[34mMatch #[0m[33m1037[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m    if _use_query_family_prefix():[0m
[30;1m86 | [0m[35m        return family[0m
[30;1m87 | [0m[35m    if _use_v1_query_naming():[0m
[30;1m88 | [0m[35m        return _V1_TABLE_SHORT_NAMES.get(table, table)[0m
[30;1m89 | [0m[35m    return _V2_TABLE_SHORT_NAMES.get(table, table)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1038[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m546 | [0m[35m    # the call to the query function.[0m
[30;1m547 | [0m[35m    exec_query_func = _create_data_func_exec(func, func_params)[0m
[30;1m548 | [0m[35m[0m
[30;1m549 | [0m[35m    # The outer wrapper handles instantiating query parameters at runtime[0m
[30;1m550 | [0m[35m    @wraps(func)[0m
[30;1m551 | [0m[35m    def wrapped_query_func(*args, **kwargs):[0m
[30;1m552 | [0m[35m        """Wrap function to extract and map parameters."""[0m

[31m--[ [0m[34mMatch #[0m[33m1039[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m550 | [0m[35m    @wraps(func)[0m
[30;1m551 | [0m[35m    def wrapped_query_func(*args, **kwargs):[0m
[30;1m552 | [0m[35m        """Wrap function to extract and map parameters."""[0m
[30;1m553 | [0m[35m        # If time params not specified, add the global ones.[0m
[30;1m554 | [0m[35m        time_params = {[0m
[30;1m555 | [0m[35m            "start": kwargs.pop("start", get_timespan().start),[0m
[30;1m556 | [0m[35m            "end": kwargs.pop("end", get_timespan().end),[0m

[31m--[ [0m[34mMatch #[0m[33m1040[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m412 | [0m[35m        The name of the container to add query functions to[0m
[30;1m413 | [0m[35m    get_timespan : Optional[Callable[[], TimeSpan]][0m
[30;1m414 | [0m[35m        Function to get the current timespan. If None[0m
[30;1m415 | [0m[35m        it will use the Pivot built-in time range.[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m    """[0m
[30;1m418 | [0m[35m    if get_timespan is None or _use_pivot_time():[0m

[31m--[ [0m[34mMatch #[0m[33m1041[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m        Query provider[0m
[30;1m372 | [0m[35m    get_timespan : Optional[Callable[[], TimeSpan]][0m
[30;1m373 | [0m[35m        Callback to get time span. If None[0m
[30;1m374 | [0m[35m        it will use the Pivot built-in time range.[0m
[30;1m375 | [0m[35m[0m
[30;1m376 | [0m[35m    """[0m
[30;1m377 | [0m[35m    q_funcs = PivotQueryFunctions(provider)[0m

[31m--[ [0m[34mMatch #[0m[33m1042[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m370 | [0m[35m    provider : QueryProvider[0m
[30;1m371 | [0m[35m        Query provider[0m
[30;1m372 | [0m[35m    get_timespan : Optional[Callable[[], TimeSpan]][0m
[30;1m373 | [0m[35m        Callback to get time span. If None[0m
[30;1m374 | [0m[35m        it will use the Pivot built-in time range.[0m
[30;1m375 | [0m[35m[0m
[30;1m376 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1043[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m            Named tuple:[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m            - short_name - short name for the query[0m
[30;1m216 | [0m[35m            - direct_func_entities - the entities to add a top level function to[0m
[30;1m217 | [0m[35m            - assigned_entities - entities to assign the query to (if parameter[0m
[30;1m218 | [0m[35m              mapping is not applicable).[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1044[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_init/pivot_data_queries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mdef _use_pivot_time() -> bool:[0m
[30;1m47 | [0m[35m    """If user setting specifies use QP time setting."""[0m
[30;1m48 | [0m[35m    return not get_config("Pivots.UseQueryProviderTimeSpans", False)[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1045[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m    progress.value = max_progress[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    # Once ready or timed out get the screenshot[0m
[30;1m150 | [0m[35m    image_data: httpx.Response = httpx.get(image_string, timeout=get_http_timeout())[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    if not image_data.is_success:[0m
[30;1m153 | [0m[35m        logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1046[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m    ready = False[0m
[30;1m135 | [0m[35m    while not ready and progress.value < max_progress:[0m
[30;1m136 | [0m[35m        progress.value += 1[0m
[30;1m137 | [0m[35m        status_data: httpx.Response = httpx.get([0m
[30;1m138 | [0m[35m            status_string,[0m
[30;1m139 | [0m[35m            timeout=get_http_timeout(),[0m
[30;1m140 | [0m[35m            headers=mp_ua_header(),[0m

[31m--[ [0m[34mMatch #[0m[33m1047[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        f"https://api.browshot.com/api/v1/screenshot/create?url={url}/"[0m
[30;1m115 | [0m[35m        f"&instance_id=26&size=screen&cache=0&key={bs_api_key}"[0m
[30;1m116 | [0m[35m    )[0m
[30;1m117 | [0m[35m    id_data: httpx.Response = httpx.get([0m
[30;1m118 | [0m[35m        id_string,[0m
[30;1m119 | [0m[35m        timeout=get_http_timeout(),[0m
[30;1m120 | [0m[35m        headers=mp_ua_header(),[0m

[31m--[ [0m[34mMatch #[0m[33m1048[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m        )[0m
[30;1m93 | [0m[35m        bs_api_key = None[0m
[30;1m94 | [0m[35m        if bs_conf is not None:[0m
[30;1m95 | [0m[35m            bs_api_key = bs_conf.get("Args", {}).get("AuthKey")[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    if bs_api_key is None:[0m
[30;1m98 | [0m[35m        err_msg: str = ([0m

[31m--[ [0m[34mMatch #[0m[33m1049[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m        )[0m
[30;1m93 | [0m[35m        bs_api_key = None[0m
[30;1m94 | [0m[35m        if bs_conf is not None:[0m
[30;1m95 | [0m[35m            bs_api_key = bs_conf.get("Args", {}).get("AuthKey")[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    if bs_api_key is None:[0m
[30;1m98 | [0m[35m        err_msg: str = ([0m

[31m--[ [0m[34mMatch #[0m[33m1050[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m399 | [0m[35m    Parameters[0m
[30;1m400 | [0m[35m    ----------[0m
[30;1m401 | [0m[35m    ip_address : str[0m
[30;1m402 | [0m[35m        The IP address to query.[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m    Returns[0m
[30;1m405 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m1051[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m394 | [0m[35m@export[0m
[30;1m395 | [0m[35mdef ip_rev_resolve_df(ip_address: str) -> pd.DataFrame:[0m
[30;1m396 | [0m[35m    """[0m
[30;1m397 | [0m[35m    Reverse lookup for IP Address.[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m    Parameters[0m
[30;1m400 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1052[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m373 | [0m[35m    Parameters[0m
[30;1m374 | [0m[35m    ----------[0m
[30;1m375 | [0m[35m    ip_address : str[0m
[30;1m376 | [0m[35m        The IP address to query.[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m    Returns[0m
[30;1m379 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m1053[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m368 | [0m[35m@export[0m
[30;1m369 | [0m[35mdef ip_rev_resolve(ip_address: str) -> dict[str, Any]:[0m
[30;1m370 | [0m[35m    """[0m
[30;1m371 | [0m[35m    Reverse lookup for IP Address.[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    Parameters[0m
[30;1m374 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1054[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m343 | [0m[35m@export[0m
[30;1m344 | [0m[35mdef dns_resolve_df(url_domain: str, rec_type: str = "A") -> pd.DataFrame:[0m
[30;1m345 | [0m[35m    """[0m
[30;1m346 | [0m[35m    Validate if a domain or URL be be resolved to an IP address.[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m    Parameters[0m
[30;1m349 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1055[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m311 | [0m[35m@export[0m
[30;1m312 | [0m[35mdef dns_resolve(url_domain: str, rec_type: str = "A") -> dict[str, Any]:[0m
[30;1m313 | [0m[35m    """[0m
[30;1m314 | [0m[35m    Validate if a domain or URL be be resolved to an IP address.[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m    Parameters[0m
[30;1m317 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1056[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m    @staticmethod[0m
[30;1m216 | [0m[35m    def is_resolvable(url_domain: str) -> bool:[0m
[30;1m217 | [0m[35m        """[0m
[30;1m218 | [0m[35m        Validate if a domain or URL be be resolved to an IP address.[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m        Parameters[0m
[30;1m221 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1057[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m    api_key : str (optional)[0m
[30;1m70 | [0m[35m        Browshot API key. If not set msticpyconfig checked for this.[0m
[30;1m71 | [0m[35m    sleep: int (optional)[0m
[30;1m72 | [0m[35m        Time to sleep between calls. Defaults to 0.05 seconds[0m
[30;1m73 | [0m[35m    max_progress: int (optional)[0m
[30;1m74 | [0m[35m        Set the maximum value for the progress bar. Defaults to 100.[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1058[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/domain_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35mimport json[0m
[30;1m17 | [0m[35mimport logging[0m
[30;1m18 | [0m[35mimport ssl[0m
[30;1m19 | [0m[35mimport time[0m
[30;1m20 | [0m[35mfrom dataclasses import asdict[0m
[30;1m21 | [0m[35mfrom enum import Enum[0m
[30;1m22 | [0m[35mfrom typing import TYPE_CHECKING, Any, Callable[0m

[31m--[ [0m[34mMatch #[0m[33m1059[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/aiagents/rag_agents.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    if not default_model:[0m
[30;1m112 | [0m[35m        raise MsticpyUserConfigError([0m
[30;1m113 | [0m[35m            "Could not find a valid default Autogen model in msticpyconfig.yaml configuration!"[0m
[30;1m114 | [0m[35m        )[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    return RetrieveUserProxyAgent([0m

[31m--[ [0m[34mMatch #[0m[33m1060[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/aiagents/rag_agents.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m    mp_resources = pkg_resources.files("msticpy")[0m
[30;1m43 | [0m[35m    docs_path = Path(mp_resources).parent / "docs" / "source"  # type: ignore[arg-type][0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    # Find all .rst files in the docs/source directory[0m
[30;1m46 | [0m[35m    rst_files = list(str(fp) for fp in docs_path.rglob("*.rst"))[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    return rst_files[0m

[31m--[ [0m[34mMatch #[0m[33m1061[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/aiagents/rag_agents.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mdef find_rst_files() -> List[str]:[0m
[30;1m32 | [0m[35m    """[0m
[30;1m33 | [0m[35m    Find all .rst files in the docs/source directory of 'msticpy' package.[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    Returns[0m
[30;1m36 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m1062[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/aiagents/rag_agents.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35mModule for MSTICpy documentation utilities and retrieval agent configuration.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mIncludes functions to find documentation files and to set up retrieval[0m
[30;1m10 | [0m[35magents that assist security analysts by answering questions based on MSTICpy documentation.[0m
[30;1m11 | [0m[35m"""[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1063[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m412 | [0m[35m    else:[0m
[30;1m413 | [0m[35m        ref_time = kwargs.get("ref_time", None)[0m
[30;1m414 | [0m[35m        ref_label = "Ref time"[0m
[30;1m415 | [0m[35m    return ref_time, kwargs.get("ref_label", ref_label)  # type: ignore[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35mdef get_tick_formatter() -> DatetimeTickFormatter:[0m

[31m--[ [0m[34mMatch #[0m[33m1064[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m        if not ref_time:[0m
[30;1m411 | [0m[35m            ref_time = getattr(ref_event, "TimeGenerated", None)[0m
[30;1m412 | [0m[35m    else:[0m
[30;1m413 | [0m[35m        ref_time = kwargs.get("ref_time", None)[0m
[30;1m414 | [0m[35m        ref_label = "Ref time"[0m
[30;1m415 | [0m[35m    return ref_time, kwargs.get("ref_label", ref_label)  # type: ignore[0m
[30;1m416 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1065[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m        ref_event = ref_alert[0m
[30;1m401 | [0m[35m        ref_label = "Alert time"[0m
[30;1m402 | [0m[35m    else:[0m
[30;1m403 | [0m[35m        ref_event = kwargs.get("ref_event", None)[0m
[30;1m404 | [0m[35m        ref_label = "Event time"[0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m    if ref_event is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1066[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35mdef get_ref_event_time(**kwargs) -> Tuple[Optional[Any], Union[Any, str]]:[0m
[30;1m397 | [0m[35m    """Extract the reference time from kwargs."""[0m
[30;1m398 | [0m[35m    ref_alert = kwargs.get("alert", None)[0m
[30;1m399 | [0m[35m    if ref_alert is not None:[0m
[30;1m400 | [0m[35m        ref_event = ref_alert[0m
[30;1m401 | [0m[35m        ref_label = "Alert time"[0m

[31m--[ [0m[34mMatch #[0m[33m1067[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m    if isinstance(data, dict):[0m
[30;1m220 | [0m[35m        tool_tip_dict = {}[0m
[30;1m221 | [0m[35m        for data_set in data.values():[0m
[30;1m222 | [0m[35m            data_df = data_set.get("data", {})  # type: ignore[0m
[30;1m223 | [0m[35m            for col in columns:[0m
[30;1m224 | [0m[35m                disp_col, col_tooltip, col_fmt = _get_datetime_tooltip(col, data_df)  # type: ignore[0m
[30;1m225 | [0m[35m                tool_tip_dict[disp_col] = col_tooltip[0m

[31m--[ [0m[34mMatch #[0m[33m1068[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m328 | [0m[35m    series_count: int = 1,[0m
[30;1m329 | [0m[35m    index: int = 0,[0m
[30;1m330 | [0m[35m):[0m
[30;1m331 | [0m[35m    """Add a reference marker line and label at `ref_time`."""[0m
[30;1m332 | [0m[35m    ref_label_tm = pd.Timestamp(ref_time)[0m
[30;1m333 | [0m[35m    index = min(index, series_count)[0m
[30;1m334 | [0m[35m    plot.line([0m

[31m--[ [0m[34mMatch #[0m[33m1069[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35mdef get_ref_event_time(**kwargs) -> Tuple[Optional[Any], Union[Any, str]]:[0m
[30;1m397 | [0m[35m    """Extract the reference time from kwargs."""[0m
[30;1m398 | [0m[35m    ref_alert = kwargs.get("alert", None)[0m
[30;1m399 | [0m[35m    if ref_alert is not None:[0m
[30;1m400 | [0m[35m        ref_event = ref_alert[0m

[31m--[ [0m[34mMatch #[0m[33m1070[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    """[0m
[30;1m120 | [0m[35m    data_columns = get_def_source_cols(data, source_columns)[0m
[30;1m121 | [0m[35m    # If the time column not explicitly specified in source_columns, add it[0m
[30;1m122 | [0m[35m    data_columns.add(time_column)[0m
[30;1m123 | [0m[35m    tool_tip_columns = data_columns.copy()[0m
[30;1m124 | [0m[35m    # create group frame so that we can color each group separately[0m

[31m--[ [0m[34mMatch #[0m[33m1071[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m    source_columns : List[str][0m
[30;1m105 | [0m[35m        Tooltip columns[0m
[30;1m106 | [0m[35m    time_column : str[0m
[30;1m107 | [0m[35m        Name of the time column[0m
[30;1m108 | [0m[35m    group_by : str[0m
[30;1m109 | [0m[35m        Name of the group_by column[0m
[30;1m110 | [0m[35m    color : str[0m

[31m--[ [0m[34mMatch #[0m[33m1072[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/process_tree.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m713 | [0m[35m            procs=self._df,[0m
[30;1m714 | [0m[35m            schema=schema,[0m
[30;1m715 | [0m[35m            show_summary=kwargs.get("show_summary", kwargs.get("show_progress", False)),[0m
[30;1m716 | [0m[35m            debug=kwargs.get("debug", False),[0m
[30;1m717 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1073[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/process_tree.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m712 | [0m[35m        return build_process_tree([0m
[30;1m713 | [0m[35m            procs=self._df,[0m
[30;1m714 | [0m[35m            schema=schema,[0m
[30;1m715 | [0m[35m            show_summary=kwargs.get("show_summary", kwargs.get("show_progress", False)),[0m
[30;1m716 | [0m[35m            debug=kwargs.get("debug", False),[0m
[30;1m717 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1074[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/process_tree.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m712 | [0m[35m        return build_process_tree([0m
[30;1m713 | [0m[35m            procs=self._df,[0m
[30;1m714 | [0m[35m            schema=schema,[0m
[30;1m715 | [0m[35m            show_summary=kwargs.get("show_summary", kwargs.get("show_progress", False)),[0m
[30;1m716 | [0m[35m            debug=kwargs.get("debug", False),[0m
[30;1m717 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1075[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/process_tree.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m413 | [0m[35m    proc_tree.loc[long_cmd, "__cmd_line$$"] = ([0m
[30;1m414 | [0m[35m        proc_tree[long_cmd][schema.cmd_line].str[:max_cmd_len] + "..."[0m
[30;1m415 | [0m[35m    )[0m
[30;1m416 | [0m[35m    # replace missing cmd lines[0m
[30;1m417 | [0m[35m    proc_tree.loc[~long_cmd, "__cmd_line$$"] = proc_tree[~long_cmd][[0m
[30;1m418 | [0m[35m        schema.cmd_line[0m
[30;1m419 | [0m[35m    ].fillna("cmdline unknown")[0m

[31m--[ [0m[34mMatch #[0m[33m1076[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/http_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m        req_params: dict[str, str] = {"observable": value}[0m
[30;1m241 | [0m[35m        req_params.update(self._request_params)[0m
[30;1m242 | [0m[35m        value_key: str = f"{value_type}-{query_type}" if query_type else value_type[0m
[30;1m243 | [0m[35m        src: APILookupParams | None = self.item_query_defs.get(value_key, None)[0m
[30;1m244 | [0m[35m        if not src:[0m
[30;1m245 | [0m[35m            error_msg: str = f"Provider does not support this type {value_key}."[0m
[30;1m246 | [0m[35m            raise LookupError(error_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1077[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/http_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    """[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    # Base URL of the service[0m
[30;1m122 | [0m[35m    _BASE_URL: ClassVar[str] = ""[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    # Define query parameters for different item types (keys)[0m

[31m--[ [0m[34mMatch #[0m[33m1078[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/http_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    For subclasses:[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    Define Base URL of the service[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    .. code:: python[0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1079[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35m        workspace_name = res_id_parts.get("name")[0m
[30;1m351 | [0m[35m    return {[0m
[30;1m352 | [0m[35m        "subscription_id": res_id_parts.get("subscription"),[0m
[30;1m353 | [0m[35m        "resource_group": res_id_parts.get("resource_group"),[0m
[30;1m354 | [0m[35m        "workspace_name": workspace_name,[0m
[30;1m355 | [0m[35m    }[0m
[30;1m356 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1080[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m    ):[0m
[30;1m350 | [0m[35m        workspace_name = res_id_parts.get("name")[0m
[30;1m351 | [0m[35m    return {[0m
[30;1m352 | [0m[35m        "subscription_id": res_id_parts.get("subscription"),[0m
[30;1m353 | [0m[35m        "resource_group": res_id_parts.get("resource_group"),[0m
[30;1m354 | [0m[35m        "workspace_name": workspace_name,[0m
[30;1m355 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m1081[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m        res_id_parts.get("namespace") == "Microsoft.OperationalInsights"[0m
[30;1m348 | [0m[35m        and res_id_parts.get("type") == "workspaces"[0m
[30;1m349 | [0m[35m    ):[0m
[30;1m350 | [0m[35m        workspace_name = res_id_parts.get("name")[0m
[30;1m351 | [0m[35m    return {[0m
[30;1m352 | [0m[35m        "subscription_id": res_id_parts.get("subscription"),[0m
[30;1m353 | [0m[35m        "resource_group": res_id_parts.get("resource_group"),[0m

[31m--[ [0m[34mMatch #[0m[33m1082[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m    workspace_name: str | None = None[0m
[30;1m346 | [0m[35m    if ([0m
[30;1m347 | [0m[35m        res_id_parts.get("namespace") == "Microsoft.OperationalInsights"[0m
[30;1m348 | [0m[35m        and res_id_parts.get("type") == "workspaces"[0m
[30;1m349 | [0m[35m    ):[0m
[30;1m350 | [0m[35m        workspace_name = res_id_parts.get("name")[0m
[30;1m351 | [0m[35m    return {[0m

[31m--[ [0m[34mMatch #[0m[33m1083[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m    )[0m
[30;1m345 | [0m[35m    workspace_name: str | None = None[0m
[30;1m346 | [0m[35m    if ([0m
[30;1m347 | [0m[35m        res_id_parts.get("namespace") == "Microsoft.OperationalInsights"[0m
[30;1m348 | [0m[35m        and res_id_parts.get("type") == "workspaces"[0m
[30;1m349 | [0m[35m    ):[0m
[30;1m350 | [0m[35m        workspace_name = res_id_parts.get("name")[0m

[31m--[ [0m[34mMatch #[0m[33m1084[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        if not self._token:[0m
[30;1m79 | [0m[35m            err_msg = "Token not found, can't get items."[0m
[30;1m80 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m81 | [0m[35m        return httpx.get([0m
[30;1m82 | [0m[35m            url,[0m
[30;1m83 | [0m[35m            headers=get_api_headers(self._token),[0m
[30;1m84 | [0m[35m            params=params,[0m

[31m--[ [0m[34mMatch #[0m[33m1085[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_values.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m266 | [0m[35m        if "line" in plot_kinds:[0m
[30;1m267 | [0m[35m            plot.line(y=value_col, line_width=2, **plot_args)[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    # if we have a reference, plot the time as a line[0m
[30;1m270 | [0m[35m    if ref_time is not None:[0m
[30;1m271 | [0m[35m        plot_ref_line(plot, ref_time, ref_label, data[value_col].max())[0m
[30;1m272 | [0m[35m    elif param.ref_events is not None or param.ref_times is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1086[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_values.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m150 | [0m[35m        (the default is None)[0m
[30;1m151 | [0m[35m    ref_time_col : str, optional[0m
[30;1m152 | [0m[35m        Add references line/label using the this column in `ref_events`[0m
[30;1m153 | [0m[35m        for the time value (x-axis).[0m
[30;1m154 | [0m[35m        (this defaults the value of the `time_column` parameter or 'TimeGenerated'[0m
[30;1m155 | [0m[35m        `time_column` is None)[0m
[30;1m156 | [0m[35m    ref_col : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1087[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_values.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m    title : str, optional[0m
[30;1m116 | [0m[35m        Title to display (the default is None)[0m
[30;1m117 | [0m[35m    ref_event : Any, optional[0m
[30;1m118 | [0m[35m        Add a reference line/label using the alert time (the default is None)[0m
[30;1m119 | [0m[35m    ref_time : datetime, optional[0m
[30;1m120 | [0m[35m        Add a reference line/label using `ref_time` (the default is None)[0m
[30;1m121 | [0m[35m    ref_label : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1088[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_analytics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m        if not response.is_success:[0m
[30;1m255 | [0m[35m            raise CloudError(response=response)[0m
[30;1m256 | [0m[35m        logger.info("Analytic Created.")[0m
[30;1m257 | [0m[35m        return response.json().get("name")[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m    def _get_analytic_id(self: Self, analytic: str) -> str:[0m
[30;1m260 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1089[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/polling_detection.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m            Estimate of the power spectral density[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        exclude_pi: bool[0m
[30;1m85 | [0m[35m            A bool to indicate whether the frequnecy located at pi should be removed.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        Returns[0m
[30;1m88 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1090[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/polling_detection.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m69 | [0m[35m        Fisher's g test tests the null hypothesis that the time series is gaussian white noise[0m
[30;1m70 | [0m[35m        against the alternative that there is a deterministic periodic component[1][0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        If the length of the time series is even then the intensity at pi should be excluded[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        If the length of the power spectral density estimate is larger than 700 then an approximate[0m
[30;1m75 | [0m[35m        p value is calculated otherwise the exact p value is calculate.[0m

[31m--[ [0m[34mMatch #[0m[33m1091[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/polling_detection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m        self, time_column: str, groupby: Optional[Union[List[str], str]] = None[0m
[30;1m189 | [0m[35m    ) -> None:[0m
[30;1m190 | [0m[35m        """[0m
[30;1m191 | [0m[35m        Detect the time interval which is highly periodic.[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        Runs PeriodogramPollingDetector._detect_polling_arr on the time_column and populates a[0m
[30;1m194 | [0m[35m        p_value column, dominant_frequency column and dominant_interval column.[0m

[31m--[ [0m[34mMatch #[0m[33m1092[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/polling_detection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m        References[0m
[30;1m94 | [0m[35m        ----------[0m
[30;1m95 | [0m[35m        [1] M. Ahdesmaki, H. Lahdesmaki and O. Yli-Harja, "Robust Fisher's Test for Periodicity[0m
[30;1m96 | [0m[35m        Detection in Noisy Biological Time Series," 2007 IEEE International Workshop on Genomic[0m
[30;1m97 | [0m[35m        Signal Processing and Statistics, 2007, pp. 1-4, doi: 10.1109/GENSIPS.2007.4365817.[0m
[30;1m98 | [0m[35m        [2] https://github.com/cran/GeneCycle/blob/master/R/fisher.g.test.R[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1093[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/polling_detection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m        Fisher's g test tests the null hypothesis that the time series is gaussian white noise[0m
[30;1m70 | [0m[35m        against the alternative that there is a deterministic periodic component[1][0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        If the length of the time series is even then the intensity at pi should be excluded[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        If the length of the power spectral density estimate is larger than 700 then an approximate[0m
[30;1m75 | [0m[35m        p value is calculated otherwise the exact p value is calculate.[0m

[31m--[ [0m[34mMatch #[0m[33m1094[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/polling_detection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m        """[0m
[30;1m67 | [0m[35m        Carry out fishers g test for periodicity.[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        Fisher's g test tests the null hypothesis that the time series is gaussian white noise[0m
[30;1m70 | [0m[35m        against the alternative that there is a deterministic periodic component[1][0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        If the length of the time series is even then the intensity at pi should be excluded[0m

[31m--[ [0m[34mMatch #[0m[33m1095[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        # If an explicit resource ID is provided, parse it and set the defaults[0m
[30;1m533 | [0m[35m        # This overrides any other settings.[0m
[30;1m534 | [0m[35m        if resource_id := non_null_kwargs.get(_RES_ID):[0m
[30;1m535 | [0m[35m            create_defaults_func = partial([0m
[30;1m536 | [0m[35m                create_defaults_func,[0m
[30;1m537 | [0m[35m                **parse_resource_id(resource_id),[0m

[31m--[ [0m[34mMatch #[0m[33m1096[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m526 | [0m[35m        # If any of the individual settings args are provided, set them as defaults[0m
[30;1m527 | [0m[35m        # Even if they override the config values.[0m
[30;1m528 | [0m[35m        for arg_name in _CORE_WS_PARAMETERS:[0m
[30;1m529 | [0m[35m            if arg := non_null_kwargs.get(arg_name):[0m
[30;1m530 | [0m[35m                create_defaults_func = partial(create_defaults_func, **{arg_name: arg})[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        # If an explicit resource ID is provided, parse it and set the defaults[0m

[31m--[ [0m[34mMatch #[0m[33m1097[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m518 | [0m[35m            config_values: dict[str, Any] = {[0m
[30;1m519 | [0m[35m                _SUB_ID: workspace_config.get(WorkspaceConfig.CONF_SUB_ID),[0m
[30;1m520 | [0m[35m                _RES_GRP: workspace_config.get(WorkspaceConfig.CONF_RES_GROUP),[0m
[30;1m521 | [0m[35m                _WS_NAME: workspace_config.get(WorkspaceConfig.CONF_WS_NAME),[0m
[30;1m522 | [0m[35m            }[0m
[30;1m523 | [0m[35m            logger.info("Workspace settings found for %s", workspace_name)[0m
[30;1m524 | [0m[35m            create_defaults_func = partial(create_defaults_func, **config_values)[0m

[31m--[ [0m[34mMatch #[0m[33m1098[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m        if workspace_config:[0m
[30;1m518 | [0m[35m            config_values: dict[str, Any] = {[0m
[30;1m519 | [0m[35m                _SUB_ID: workspace_config.get(WorkspaceConfig.CONF_SUB_ID),[0m
[30;1m520 | [0m[35m                _RES_GRP: workspace_config.get(WorkspaceConfig.CONF_RES_GROUP),[0m
[30;1m521 | [0m[35m                _WS_NAME: workspace_config.get(WorkspaceConfig.CONF_WS_NAME),[0m
[30;1m522 | [0m[35m            }[0m
[30;1m523 | [0m[35m            logger.info("Workspace settings found for %s", workspace_name)[0m

[31m--[ [0m[34mMatch #[0m[33m1099[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m516 | [0m[35m            workspace_config = WorkspaceConfig(workspace=workspace_name)[0m
[30;1m517 | [0m[35m        if workspace_config:[0m
[30;1m518 | [0m[35m            config_values: dict[str, Any] = {[0m
[30;1m519 | [0m[35m                _SUB_ID: workspace_config.get(WorkspaceConfig.CONF_SUB_ID),[0m
[30;1m520 | [0m[35m                _RES_GRP: workspace_config.get(WorkspaceConfig.CONF_RES_GROUP),[0m
[30;1m521 | [0m[35m                _WS_NAME: workspace_config.get(WorkspaceConfig.CONF_WS_NAME),[0m
[30;1m522 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m1100[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m        non_null_kwargs: dict[str, Any] = {[0m
[30;1m505 | [0m[35m            key: value for key, value in kwargs.items() if value[0m
[30;1m506 | [0m[35m        }[0m
[30;1m507 | [0m[35m        workspace_name: str | None = non_null_kwargs.get(_WS_NAME)[0m
[30;1m508 | [0m[35m        workspace_config: WorkspaceConfig | None = None[0m
[30;1m509 | [0m[35m        if not any(ws_param in non_null_kwargs for ws_param in _WS_PARAMETERS):[0m
[30;1m510 | [0m[35m            # if we can't build a resource ID from the parameters, try to get the[0m

[31m--[ [0m[34mMatch #[0m[33m1101[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m428 | [0m[35m            _create_ws_defaults,[0m
[30;1m429 | [0m[35m            subscription_id=workspace_config.get(WorkspaceConfig.CONF_SUB_ID_KEY),[0m
[30;1m430 | [0m[35m            resource_group=workspace_config.get(WorkspaceConfig.CONF_RES_GROUP_KEY),[0m
[30;1m431 | [0m[35m            workspace_name=workspace_config.get(WorkspaceConfig.CONF_WS_NAME_KEY),[0m
[30;1m432 | [0m[35m        )[0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1102[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m427 | [0m[35m        self._default_settings = self._set_ws_defaults([0m
[30;1m428 | [0m[35m            _create_ws_defaults,[0m
[30;1m429 | [0m[35m            subscription_id=workspace_config.get(WorkspaceConfig.CONF_SUB_ID_KEY),[0m
[30;1m430 | [0m[35m            resource_group=workspace_config.get(WorkspaceConfig.CONF_RES_GROUP_KEY),[0m
[30;1m431 | [0m[35m            workspace_name=workspace_config.get(WorkspaceConfig.CONF_WS_NAME_KEY),[0m
[30;1m432 | [0m[35m        )[0m
[30;1m433 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1103[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m        # set these as defaults[0m
[30;1m427 | [0m[35m        self._default_settings = self._set_ws_defaults([0m
[30;1m428 | [0m[35m            _create_ws_defaults,[0m
[30;1m429 | [0m[35m            subscription_id=workspace_config.get(WorkspaceConfig.CONF_SUB_ID_KEY),[0m
[30;1m430 | [0m[35m            resource_group=workspace_config.get(WorkspaceConfig.CONF_RES_GROUP_KEY),[0m
[30;1m431 | [0m[35m            workspace_name=workspace_config.get(WorkspaceConfig.CONF_WS_NAME_KEY),[0m
[30;1m432 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1104[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m                "Azure resource ID during initialization.",[0m
[30;1m406 | [0m[35m                stacklevel=1,[0m
[30;1m407 | [0m[35m            )[0m
[30;1m408 | [0m[35m        workspace = adjust_kwargs.get(_WS_NAME, workspace)[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m        if resource_id:[0m
[30;1m411 | [0m[35m            self._default_settings = self._set_ws_defaults([0m

[31m--[ [0m[34mMatch #[0m[33m1105[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m298 | [0m[35m        else:[0m
[30;1m299 | [0m[35m            try:[0m
[30;1m300 | [0m[35m                sentinel_instance = SentinelInstanceDetails.from_resource_id([0m
[30;1m301 | [0m[35m                    connect_kwargs.get(_RES_ID) or self.default_resource_id,[0m
[30;1m302 | [0m[35m                )[0m
[30;1m303 | [0m[35m            except TypeError as err:[0m
[30;1m304 | [0m[35m                raise MsticpyUserConfigError([0m

[31m--[ [0m[34mMatch #[0m[33m1106[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m                    or self.default_subscription_id,[0m
[30;1m288 | [0m[35m                    resource_group=connect_kwargs.get(_RES_GRP)[0m
[30;1m289 | [0m[35m                    or self.default_resource_group,[0m
[30;1m290 | [0m[35m                    workspace_name=connect_kwargs.get(_WS_NAME)[0m
[30;1m291 | [0m[35m                    or self.default_workspace_name,[0m
[30;1m292 | [0m[35m                )[0m
[30;1m293 | [0m[35m            except TypeError as err:[0m

[31m--[ [0m[34mMatch #[0m[33m1107[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m                sentinel_instance: SentinelInstanceDetails = SentinelInstanceDetails([0m
[30;1m286 | [0m[35m                    subscription_id=connect_kwargs.get(_SUB_ID)[0m
[30;1m287 | [0m[35m                    or self.default_subscription_id,[0m
[30;1m288 | [0m[35m                    resource_group=connect_kwargs.get(_RES_GRP)[0m
[30;1m289 | [0m[35m                    or self.default_resource_group,[0m
[30;1m290 | [0m[35m                    workspace_name=connect_kwargs.get(_WS_NAME)[0m
[30;1m291 | [0m[35m                    or self.default_workspace_name,[0m

[31m--[ [0m[34mMatch #[0m[33m1108[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m        if any(connect_kwargs.get(ws_param) for ws_param in _CORE_WS_PARAMETERS):[0m
[30;1m284 | [0m[35m            try:[0m
[30;1m285 | [0m[35m                sentinel_instance: SentinelInstanceDetails = SentinelInstanceDetails([0m
[30;1m286 | [0m[35m                    subscription_id=connect_kwargs.get(_SUB_ID)[0m
[30;1m287 | [0m[35m                    or self.default_subscription_id,[0m
[30;1m288 | [0m[35m                    resource_group=connect_kwargs.get(_RES_GRP)[0m
[30;1m289 | [0m[35m                    or self.default_resource_group,[0m

[31m--[ [0m[34mMatch #[0m[33m1109[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m        """[0m
[30;1m282 | [0m[35m        connect_kwargs: dict[str, Any] = _map_legacy_param_names(**kwargs)[0m
[30;1m283 | [0m[35m        if any(connect_kwargs.get(ws_param) for ws_param in _CORE_WS_PARAMETERS):[0m
[30;1m284 | [0m[35m            try:[0m
[30;1m285 | [0m[35m                sentinel_instance: SentinelInstanceDetails = SentinelInstanceDetails([0m
[30;1m286 | [0m[35m                    subscription_id=connect_kwargs.get(_SUB_ID)[0m

[31m--[ [0m[34mMatch #[0m[33m1110[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    """[0m
[30;1m115 | [0m[35m    return {_LEGACY_PARAM_NAMES.get(key, key): value for key, value in kwargs.items()}[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m# pylint: disable=too-many-ancestors, too-many-instance-attributes[0m

[31m--[ [0m[34mMatch #[0m[33m1111[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m314 | [0m[35m            )[0m
[30;1m315 | [0m[35m            raise MsticpyUserConfigError([0m
[30;1m316 | [0m[35m                err_msg,[0m
[30;1m317 | [0m[35m                title="Cannot switch cloud at connect time",[0m
[30;1m318 | [0m[35m            )[0m
[30;1m319 | [0m[35m        logger.info("Using tenant id %s", tenant_id)[0m
[30;1m320 | [0m[35m        az_connect_kwargs: dict[str, Any] = {[0m

[31m--[ [0m[34mMatch #[0m[33m1112[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m446 | [0m[35m### Event Timelines[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35mDisplay any log events on an interactive timeline. Using the[0m
[30;1m449 | [0m[35m[Bokeh Visualization Library](https://bokeh.org/) the timeline control enables[0m
[30;1m450 | [0m[35myou to visualize one or more event streams, interactively zoom into specific time[0m
[30;1m451 | [0m[35mslots and view event details for plotted events.[0m
[30;1m452 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1113[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m349 | [0m[35m[docs/notebooks](https://github.com/microsoft/msticpy/blob/master/docs/notebooks)[0m
[30;1m350 | [0m[35mfolder and accompanying notebooks.[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35mYou can also browse through the sample notebooks referenced at the end of this document[0m
[30;1m353 | [0m[35mto see some of the functionality used in context. You can play with some of the package[0m
[30;1m354 | [0m[35mfunctions in this interactive demo on mybinder.org.[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1114[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m## Documentation[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35mFull documentation is at [ReadTheDocs](https://msticpy.readthedocs.io/en/latest/)[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35mSample notebooks for many of the modules are in the[0m
[30;1m349 | [0m[35m[docs/notebooks](https://github.com/microsoft/msticpy/blob/master/docs/notebooks)[0m

[31m--[ [0m[34mMatch #[0m[33m1115[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m`pip install --upgrade msticpy`[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35mNote it is good practice to copy your msticpyconfig.yaml and store it on your disk but outside of yo[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m## Documentation[0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1116[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m557 | [0m[35m[0m
[30;1m558 | [0m[35m<img src="./docs/source/visualization/_static/Widgets1.png"[0m
[30;1m559 | [0m[35m  alt="Time span Widget"[0m
[30;1m560 | [0m[35m  title="Query time setter" height="100" />[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m<img src="./docs/source/visualization/_static/Widgets4.png"[0m
[30;1m563 | [0m[35m  alt="Alert browser"[0m

[31m--[ [0m[34mMatch #[0m[33m1117[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m553 | [0m[35m[0m
[30;1m554 | [0m[35mThese are built from the [Jupyter ipywidgets](https://ipywidgets.readthedocs.io/) collection[0m
[30;1m555 | [0m[35mand group common functionality useful in InfoSec tasks such as list pickers,[0m
[30;1m556 | [0m[35mquery time boundary settings and event display into an easy-to-use format.[0m
[30;1m557 | [0m[35m[0m
[30;1m558 | [0m[35m<img src="./docs/source/visualization/_static/Widgets1.png"[0m
[30;1m559 | [0m[35m  alt="Time span Widget"[0m

[31m--[ [0m[34mMatch #[0m[33m1118[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m### iocextract[0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35mUses regular expressions to look for Indicator of Compromise (IoC) patterns - IP Addresses, URLs,[0m
[30;1m506 | [0m[35mDNS domains, Hashes, file paths.[0m
[30;1m507 | [0m[35mInput can be a single string or a pandas dataframe.[0m
[30;1m508 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1119[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m500 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m1120[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m### base64unpack[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m495 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m496 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m497 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m1121[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m492 | [0m[35m[Pivot Functions Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/PivotFunc[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m### base64unpack[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m497 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m498 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m499 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m1122[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m482 | [0m[35mLets you use *MSTICPy* functionality in an "entity-centric" way.[0m
[30;1m483 | [0m[35mAll functions, queries and lookups that relate to a particular entity type[0m
[30;1m484 | [0m[35m(e.g. Host, IpAddress, Url) are collected together as methods of that[0m
[30;1m485 | [0m[35mentity class. So, if you want to do things with an IP address, just load[0m
[30;1m486 | [0m[35mthe IpAddress entity and browse its methods.[0m
[30;1m487 | [0m[35m[0m
[30;1m488 | [0m[35m[Pivot Functions](https://msticpy.readthedocs.io/en/latest/data_analysis/PivotFunctions.html)[0m

[31m--[ [0m[34mMatch #[0m[33m1123[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35mDisplay any log events on an interactive timeline. Using the[0m
[30;1m449 | [0m[35m[Bokeh Visualization Library](https://bokeh.org/) the timeline control enables[0m
[30;1m450 | [0m[35myou to visualize one or more event streams, interactively zoom into specific time[0m
[30;1m451 | [0m[35mslots and view event details for plotted events.[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m<img src="./docs/source/visualization/_static/TimeLine-01.png"[0m

[31m--[ [0m[34mMatch #[0m[33m1124[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m431 | [0m[35m[Anomalous Sequence Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Anomal[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m### Time Series Analysis[0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35mTime series analysis allows you to identify unusual patterns in your log data[0m
[30;1m436 | [0m[35mtaking into account normal seasonal variations (e.g. the regular ebb and flow of[0m
[30;1m437 | [0m[35mevents over hours of the day, days of the week, etc.). Using both analysis and[0m
[30;1m438 | [0m[35mvisualization highlights unusual traffic flows or event activity for any data[0m

[31m--[ [0m[34mMatch #[0m[33m1125[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m428 | [0m[35mand[0m
[30;1m429 | [0m[35m[Anomalous Sequence Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Anomal[0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m### Time Series Analysis[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35mTime series analysis allows you to identify unusual patterns in your log data[0m
[30;1m434 | [0m[35mtaking into account normal seasonal variations (e.g. the regular ebb and flow of[0m

[31m--[ [0m[34mMatch #[0m[33m1126[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m422 | [0m[35mDetect unusual sequences of events in your Office, Active Directory or other log data.[0m
[30;1m423 | [0m[35mYou can extract sessions (e.g. activity initiated by the same account) and identify and[0m
[30;1m424 | [0m[35mvisualize unusual sequences of activity. For example, detecting an attacker setting[0m
[30;1m425 | [0m[35ma mail forwarding rule on someone's mailbox.[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m[Anomalous Sessions](https://msticpy.readthedocs.io/en/latest/data_analysis/AnomalousSequence.html)[0m
[30;1m428 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m1127[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m<img src="./docs/source/visualization/_static/folium_sf_zoom.png"[0m
[30;1m398 | [0m[35m  alt="Folium map"[0m
[30;1m399 | [0m[35m  title="Plotting Geo IP Location" height="200" />[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m[GeoIP Lookup](https://msticpy.readthedocs.io/en/latest/data_acquisition/GeoIPLookups.html)[0m
[30;1m402 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m1128[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m### GeoLocation Data[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35mThe GeoIP lookup classes allow you to match the geo-locations of IP addresses[0m
[30;1m392 | [0m[35musing either:[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m- GeoLiteLookup - Maxmind Geolite (see <https://www.maxmind.com>)[0m

[31m--[ [0m[34mMatch #[0m[33m1129[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m`pip install --upgrade msticpy`[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35mNote it is good practice to copy your msticpyconfig.yaml and store it on your disk but outside of yo[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m## Documentation[0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1130[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m  multi-dimensional Morph Charts[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35mIt also includes some time-saving notebook tools such as widgets to[0m
[30;1m292 | [0m[35mset query time boundaries, select and display items from lists, and[0m
[30;1m293 | [0m[35mconfigure the notebook environment.[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m<img src="./docs/source/visualization/_static/Timeline-08.png"[0m

[31m--[ [0m[34mMatch #[0m[33m1131[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m284 | [0m[35m  resource data[0m
[30;1m285 | [0m[35m- extract Indicators of Activity (IoA) from logs and unpack encoded data[0m
[30;1m286 | [0m[35m- perform sophisticated analysis such as anomalous session detection and[0m
[30;1m287 | [0m[35m  time series decomposition[0m
[30;1m288 | [0m[35m- visualize data using interactive timelines, process trees and[0m
[30;1m289 | [0m[35m  multi-dimensional Morph Charts[0m
[30;1m290 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1132[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m810 | [0m[35m    """Convert a type based on dictionary of converters."""[0m
[30;1m811 | [0m[35m    type_convert = type_convert or {}[0m
[30;1m812 | [0m[35m    type_convert.update(_TYPE_CONVERTER)[0m
[30;1m813 | [0m[35m    converter: Callable | None = type_convert.get(type(value))[0m
[30;1m814 | [0m[35m    return converter(value) if converter else value[0m
[30;1m815 | [0m[35m[0m
[30;1m816 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1133[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m    def to_json(self: Self) -> str:[0m
[30;1m585 | [0m[35m        """Return JSON representation of DynamicSummary."""[0m
[30;1m586 | [0m[35m        summary_properties: dict[str, Any] = {[0m
[30;1m587 | [0m[35m            _CLS_TO_API_MAP.get(prop_name, prop_name): prop_value[0m
[30;1m588 | [0m[35m            for prop_name, prop_value in self.__dict__.items()[0m
[30;1m589 | [0m[35m            if prop_name in _CLS_TO_API_MAP and prop_value is not None[0m
[30;1m590 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m1134[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m543 | [0m[35m                and "search_key" not in properties[0m
[30;1m544 | [0m[35m                and self.search_key in properties.get("packed_content", {})[0m
[30;1m545 | [0m[35m            ):[0m
[30;1m546 | [0m[35m                search_key_value: str = properties.get("packed_content", {}).get([0m
[30;1m547 | [0m[35m                    self.search_key,[0m
[30;1m548 | [0m[35m                )[0m
[30;1m549 | [0m[35m                if search_key_value:[0m

[31m--[ [0m[34mMatch #[0m[33m1135[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m543 | [0m[35m                and "search_key" not in properties[0m
[30;1m544 | [0m[35m                and self.search_key in properties.get("packed_content", {})[0m
[30;1m545 | [0m[35m            ):[0m
[30;1m546 | [0m[35m                search_key_value: str = properties.get("packed_content", {}).get([0m
[30;1m547 | [0m[35m                    self.search_key,[0m
[30;1m548 | [0m[35m                )[0m
[30;1m549 | [0m[35m                if search_key_value:[0m

[31m--[ [0m[34mMatch #[0m[33m1136[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m541 | [0m[35m            if ([0m
[30;1m542 | [0m[35m                self.search_key[0m
[30;1m543 | [0m[35m                and "search_key" not in properties[0m
[30;1m544 | [0m[35m                and self.search_key in properties.get("packed_content", {})[0m
[30;1m545 | [0m[35m            ):[0m
[30;1m546 | [0m[35m                search_key_value: str = properties.get("packed_content", {}).get([0m
[30;1m547 | [0m[35m                    self.search_key,[0m

[31m--[ [0m[34mMatch #[0m[33m1137[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m                    "TimeGenerated",[0m
[30;1m506 | [0m[35m                )[0m
[30;1m507 | [0m[35m            search_key_value: str | None = ([0m
[30;1m508 | [0m[35m                row.get(self.search_key) if self.search_key else None[0m
[30;1m509 | [0m[35m            )[0m
[30;1m510 | [0m[35m            if search_key_value and not search_key:[0m
[30;1m511 | [0m[35m                search_key = search_key_value[0m

[31m--[ [0m[34mMatch #[0m[33m1138[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m            # if event time not in summary_fields, try to get from[0m
[30;1m502 | [0m[35m            # kwargs or from data[0m
[30;1m503 | [0m[35m            if "event_time_utc" not in summary_params:[0m
[30;1m504 | [0m[35m                summary_params["event_time_utc"] = event_time_utc or row.get([0m
[30;1m505 | [0m[35m                    "TimeGenerated",[0m
[30;1m506 | [0m[35m                )[0m
[30;1m507 | [0m[35m            search_key_value: str | None = ([0m

[31m--[ [0m[34mMatch #[0m[33m1139[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m                # if summary fields to map to dynamic summary item properties[0m
[30;1m496 | [0m[35m                # extract these from the row dictionary first[0m
[30;1m497 | [0m[35m                summary_params = {[0m
[30;1m498 | [0m[35m                    field_name: row.get(column_name)[0m
[30;1m499 | [0m[35m                    for field_name, column_name in summary_fields.items()[0m
[30;1m500 | [0m[35m                }[0m
[30;1m501 | [0m[35m            # if event time not in summary_fields, try to get from[0m

[31m--[ [0m[34mMatch #[0m[33m1140[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m            raise MsticpyUserError(err_msg) from json_err[0m
[30;1m285 | [0m[35m        for raw_item in raw_content:[0m
[30;1m286 | [0m[35m            summary_item_props: dict[str, Any] = {[0m
[30;1m287 | [0m[35m                _API_TO_CLS_MAP.get(name, name): ([0m
[30;1m288 | [0m[35m                    pd.to_datetime(value) if name == "eventTimeUTC" else value[0m
[30;1m289 | [0m[35m                )[0m
[30;1m290 | [0m[35m                for name, value in raw_item.items()[0m

[31m--[ [0m[34mMatch #[0m[33m1141[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m        summary = cls(**summary_props)[0m
[30;1m278 | [0m[35m        summary_items: list[DynamicSummaryItem] = [][0m
[30;1m279 | [0m[35m        try:[0m
[30;1m280 | [0m[35m            raw_content_data: str = data.get("rawContent", "[]")[0m
[30;1m281 | [0m[35m            raw_content: list[dict[str, Any]] = json.loads(raw_content_data)[0m
[30;1m282 | [0m[35m        except json.JSONDecodeError as json_err:[0m
[30;1m283 | [0m[35m            err_msg = "JSON Error decoding dynamic summary item data"[0m

[31m--[ [0m[34mMatch #[0m[33m1142[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m            return cls.from_json(data)[0m
[30;1m271 | [0m[35m        properties: dict[str, Any] = data.get("properties", data)[0m
[30;1m272 | [0m[35m        summary_props: dict[str, Any] = {[0m
[30;1m273 | [0m[35m            _API_TO_CLS_MAP.get(name, name): value[0m
[30;1m274 | [0m[35m            for name, value in properties.items()[0m
[30;1m275 | [0m[35m            if name != "rawContent"[0m
[30;1m276 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m1143[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m                err_msg: str = "JSON Error decoding dynamic summary data"[0m
[30;1m269 | [0m[35m                raise MsticpyUserError(err_msg) from json_err[0m
[30;1m270 | [0m[35m            return cls.from_json(data)[0m
[30;1m271 | [0m[35m        properties: dict[str, Any] = data.get("properties", data)[0m
[30;1m272 | [0m[35m        summary_props: dict[str, Any] = {[0m
[30;1m273 | [0m[35m            _API_TO_CLS_MAP.get(name, name): value[0m
[30;1m274 | [0m[35m            for name, value in properties.items()[0m

[31m--[ [0m[34mMatch #[0m[33m1144[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m    def to_api_dict(self: Self) -> dict[str, Any]:[0m
[30;1m136 | [0m[35m        """Return attributes as a JSON-serializable dictionary."""[0m
[30;1m137 | [0m[35m        return {[0m
[30;1m138 | [0m[35m            _CLS_TO_API_MAP.get(name, name): _convert_data_types(value)[0m
[30;1m139 | [0m[35m            for name, value in dataclasses.asdict(self).items()[0m
[30;1m140 | [0m[35m            if value is not None[0m
[30;1m141 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m1145[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m498 | [0m[35m                    field_name: row.get(column_name)[0m
[30;1m499 | [0m[35m                    for field_name, column_name in summary_fields.items()[0m
[30;1m500 | [0m[35m                }[0m
[30;1m501 | [0m[35m            # if event time not in summary_fields, try to get from[0m
[30;1m502 | [0m[35m            # kwargs or from data[0m
[30;1m503 | [0m[35m            if "event_time_utc" not in summary_params:[0m
[30;1m504 | [0m[35m                summary_params["event_time_utc"] = event_time_utc or row.get([0m

[31m--[ [0m[34mMatch #[0m[33m1146[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m479 | [0m[35m            For example: {"col_a": "tactics", "col_b": "relation_name"}[0m
[30;1m480 | [0m[35m            See DynamicSummaryItem for a list of available properties.[0m
[30;1m481 | [0m[35m        event_time_utc: Optional[datetime] = None[0m
[30;1m482 | [0m[35m            Event time for the summary item[0m
[30;1m483 | [0m[35m        search_key: Optional[str] = None[0m
[30;1m484 | [0m[35m            Searchable key value for summary item[0m
[30;1m485 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1147[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_dynamic_summary_types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m    techniques: Union[str, list[str], None] = None[0m
[30;1m102 | [0m[35m        Relevant MITRE techniques for the summary item[0m
[30;1m103 | [0m[35m    event_time_utc: Optional[datetime] = None[0m
[30;1m104 | [0m[35m        Event time for the summary item[0m
[30;1m105 | [0m[35m    observable_type: Optional[str] = None[0m
[30;1m106 | [0m[35m        Observable type of the summary item[0m
[30;1m107 | [0m[35m    observable_value: Optional[str] = None[0m

[31m--[ [0m[34mMatch #[0m[33m1148[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/vtobject_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m        <td>Names</td><td>{summary.get('names')}</td>[0m
[30;1m137 | [0m[35m    </tr>[0m
[30;1m138 | [0m[35m    <tr>[0m
[30;1m139 | [0m[35m        <td>File Type</td><td>{summary.get('magic')}</td>[0m
[30;1m140 | [0m[35m    </tr>[0m
[30;1m141 | [0m[35m    </table>[0m
[30;1m142 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1149[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/vtobject_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m        <td>ID</td><td>{summary.get('sha256')}</td>[0m
[30;1m134 | [0m[35m    </tr>[0m
[30;1m135 | [0m[35m    <tr>[0m
[30;1m136 | [0m[35m        <td>Names</td><td>{summary.get('names')}</td>[0m
[30;1m137 | [0m[35m    </tr>[0m
[30;1m138 | [0m[35m    <tr>[0m
[30;1m139 | [0m[35m        <td>File Type</td><td>{summary.get('magic')}</td>[0m

[31m--[ [0m[34mMatch #[0m[33m1150[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/vtobject_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m    <h3>{title}</h3>[0m
[30;1m131 | [0m[35m    <table>[0m
[30;1m132 | [0m[35m    <tr>[0m
[30;1m133 | [0m[35m        <td>ID</td><td>{summary.get('sha256')}</td>[0m
[30;1m134 | [0m[35m    </tr>[0m
[30;1m135 | [0m[35m    <tr>[0m
[30;1m136 | [0m[35m        <td>Names</td><td>{summary.get('names')}</td>[0m

[31m--[ [0m[34mMatch #[0m[33m1151[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/vtobject_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def _display_attribute(self, change):[0m
[30;1m87 | [0m[35m        """Display selected attribute in TextArea."""[0m
[30;1m88 | [0m[35m        item = change.get("new")[0m
[30;1m89 | [0m[35m        if item in self._current_data.columns:[0m
[30;1m90 | [0m[35m            data = self._current_data.iloc[0][item][0m
[30;1m91 | [0m[35m            self.data_view.value = pprint.pformat(data)[0m

[31m--[ [0m[34mMatch #[0m[33m1152[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m813 | [0m[35m            and details.network_security_group.id is not None[0m
[30;1m814 | [0m[35m        ):[0m
[30;1m815 | [0m[35m            # Get NSG details and parse relevant elements into a dataframe[0m
[30;1m816 | [0m[35m            nsg_details = self.network_client.network_security_groups.get([0m
[30;1m817 | [0m[35m                details.network_security_group.id.split("/")[4],[0m
[30;1m818 | [0m[35m                details.network_security_group.id.split("/")[8],[0m
[30;1m819 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1153[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m765 | [0m[35m            )[0m
[30;1m766 | [0m[35m        except AttributeError:[0m
[30;1m767 | [0m[35m            self._legacy_auth("network_client", sub_id)[0m
[30;1m768 | [0m[35m            details = self.network_client.network_interfaces.get([0m
[30;1m769 | [0m[35m                network_id.split("/")[4],[0m
[30;1m770 | [0m[35m                network_id.split("/")[8],[0m
[30;1m771 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1154[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m759 | [0m[35m[0m
[30;1m760 | [0m[35m        # Get interface details and parse relevant elements into a dataframe[0m
[30;1m761 | [0m[35m        try:[0m
[30;1m762 | [0m[35m            details: NetworkInterface = self.network_client.network_interfaces.get([0m
[30;1m763 | [0m[35m                network_id.split("/")[4],[0m
[30;1m764 | [0m[35m                network_id.split("/")[8],[0m
[30;1m765 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1155[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m699 | [0m[35m            provider = self.resource_client.providers.get(namespace)[0m
[30;1m700 | [0m[35m        except AttributeError:[0m
[30;1m701 | [0m[35m            self._legacy_auth("resource_client", sub_id)[0m
[30;1m702 | [0m[35m            provider = self.resource_client.providers.get(namespace)[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m        if not provider.resource_types:[0m
[30;1m705 | [0m[35m            resource_types = None[0m

[31m--[ [0m[34mMatch #[0m[33m1156[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m693 | [0m[35m[0m
[30;1m694 | [0m[35m        # Get list of API versions for the service[0m
[30;1m695 | [0m[35m        try:[0m
[30;1m696 | [0m[35m            provider = self.resource_client.providers.get(namespace)[0m
[30;1m697 | [0m[35m        except AttributeError:[0m
[30;1m698 | [0m[35m            self._legacy_auth("resource_client", sub_id)[0m
[30;1m699 | [0m[35m            provider = self.resource_client.providers.get(namespace)[0m

[31m--[ [0m[34mMatch #[0m[33m1157[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m570 | [0m[35m                )[0m
[30;1m571 | [0m[35m            except AttributeError:[0m
[30;1m572 | [0m[35m                self._legacy_auth("resource_client", sub_id)[0m
[30;1m573 | [0m[35m                resource = self.resource_client.resources.get([0m
[30;1m574 | [0m[35m                    resource_details["resource_group_name"],[0m
[30;1m575 | [0m[35m                    resource_details["resource_provider_namespace"],[0m
[30;1m576 | [0m[35m                    resource_details["parent_resource_path"],[0m

[31m--[ [0m[34mMatch #[0m[33m1158[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m553 | [0m[35m        # If resource details are provided use get to get details[0m
[30;1m554 | [0m[35m        elif resource_details is not None:[0m
[30;1m555 | [0m[35m            try:[0m
[30;1m556 | [0m[35m                resource = self.resource_client.resources.get([0m
[30;1m557 | [0m[35m                    resource_details["resource_group_name"],[0m
[30;1m558 | [0m[35m                    resource_details["resource_provider_namespace"],[0m
[30;1m559 | [0m[35m                    resource_details["parent_resource_path"],[0m

[31m--[ [0m[34mMatch #[0m[33m1159[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m323 | [0m[35m            sub: Subscription = self.sub_client.subscriptions.get(sub_id)[0m
[30;1m324 | [0m[35m        except AttributeError:[0m
[30;1m325 | [0m[35m            self._legacy_auth("sub_client")[0m
[30;1m326 | [0m[35m            sub = self.sub_client.subscriptions.get(sub_id)[0m
[30;1m327 | [0m[35m        sub_loc: dict[str, Any] | None = None[0m
[30;1m328 | [0m[35m        quota_id: dict[str, Any] | None = None[0m
[30;1m329 | [0m[35m        spending_limit: dict[str, Any] | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m1160[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m        try:[0m
[30;1m323 | [0m[35m            sub: Subscription = self.sub_client.subscriptions.get(sub_id)[0m
[30;1m324 | [0m[35m        except AttributeError:[0m
[30;1m325 | [0m[35m            self._legacy_auth("sub_client")[0m
[30;1m326 | [0m[35m            sub = self.sub_client.subscriptions.get(sub_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1161[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m951 | [0m[35m        """[0m
[30;1m952 | [0m[35m        if self.connected is False:[0m
[30;1m953 | [0m[35m            err_msg: str = ([0m
[30;1m954 | [0m[35m                "You need to connect to the service before using this function."[0m
[30;1m955 | [0m[35m            )[0m
[30;1m956 | [0m[35m            raise MsticpyNotConnectedError([0m
[30;1m957 | [0m[35m                err_msg,[0m

[31m--[ [0m[34mMatch #[0m[33m1162[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m919 | [0m[35m        for metric in mon_details.value:[0m
[30;1m920 | [0m[35m            times: list = [][0m
[30;1m921 | [0m[35m            output = [][0m
[30;1m922 | [0m[35m            for time in metric.timeseries:[0m
[30;1m923 | [0m[35m                for data in time.data:[0m
[30;1m924 | [0m[35m                    times.append(data.time_stamp)[0m
[30;1m925 | [0m[35m                    output.append(data.total)[0m

[31m--[ [0m[34mMatch #[0m[33m1163[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m881 | [0m[35m[0m
[30;1m882 | [0m[35m        # Check if connection and client required are already present[0m
[30;1m883 | [0m[35m        if self.connected is False:[0m
[30;1m884 | [0m[35m            err_msg = "You need to connect to the service before using this function."[0m
[30;1m885 | [0m[35m            raise MsticpyNotConnectedError([0m
[30;1m886 | [0m[35m                err_msg,[0m
[30;1m887 | [0m[35m                help_uri=MsticpyAzureConfigError.DEF_HELP_URI,[0m

[31m--[ [0m[34mMatch #[0m[33m1164[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m853 | [0m[35m        Parameters[0m
[30;1m854 | [0m[35m        ----------[0m
[30;1m855 | [0m[35m        metrics: str[0m
[30;1m856 | [0m[35m            A string list of metrics you wish to collect[0m
[30;1m857 | [0m[35m            (https://docs.microsoft.com/en-us/azure/azure-monitor/platform/metrics-supported)[0m
[30;1m858 | [0m[35m        resource_id: str[0m
[30;1m859 | [0m[35m            The resource ID of the resource to collet the metrics from[0m

[31m--[ [0m[34mMatch #[0m[33m1165[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m744 | [0m[35m        # Check if connection and client required are already present[0m
[30;1m745 | [0m[35m        if self.connected is False:[0m
[30;1m746 | [0m[35m            err_msg: str = ([0m
[30;1m747 | [0m[35m                "You need to connect to the service before using this function."[0m
[30;1m748 | [0m[35m            )[0m
[30;1m749 | [0m[35m            raise MsticpyNotConnectedError([0m
[30;1m750 | [0m[35m                err_msg,[0m

[31m--[ [0m[34mMatch #[0m[33m1166[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m691 | [0m[35m            resource_provider=resource_provider,[0m
[30;1m692 | [0m[35m        )[0m
[30;1m693 | [0m[35m[0m
[30;1m694 | [0m[35m        # Get list of API versions for the service[0m
[30;1m695 | [0m[35m        try:[0m
[30;1m696 | [0m[35m            provider = self.resource_client.providers.get(namespace)[0m
[30;1m697 | [0m[35m        except AttributeError:[0m

[31m--[ [0m[34mMatch #[0m[33m1167[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m686 | [0m[35m            err_msg = "Resource client must be set to get api."[0m
[30;1m687 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m688 | [0m[35m[0m
[30;1m689 | [0m[35m        namespace, service = AzureData._normalize_resources([0m
[30;1m690 | [0m[35m            resource_id=resource_id,[0m
[30;1m691 | [0m[35m            resource_provider=resource_provider,[0m
[30;1m692 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1168[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m673 | [0m[35m        # Check if connection and client required are already present[0m
[30;1m674 | [0m[35m        if self.connected is False:[0m
[30;1m675 | [0m[35m            err_msg: str = ([0m
[30;1m676 | [0m[35m                "You need to connect to the service before using this function."[0m
[30;1m677 | [0m[35m            )[0m
[30;1m678 | [0m[35m            raise MsticpyNotConnectedError([0m
[30;1m679 | [0m[35m                err_msg,[0m

[31m--[ [0m[34mMatch #[0m[33m1169[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m662 | [0m[35m        sub_id: str, optional[0m
[30;1m663 | [0m[35m            The ID of the subscription to get details from[0m
[30;1m664 | [0m[35m        resource_provider: str, optional[0m
[30;1m665 | [0m[35m            The resource provider namespace and service to get an API version for[0m
[30;1m666 | [0m[35m[0m
[30;1m667 | [0m[35m        Returns[0m
[30;1m668 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1170[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m521 | [0m[35m        # Check if connection and client required are already present[0m
[30;1m522 | [0m[35m        if self.connected is False:[0m
[30;1m523 | [0m[35m            err_msg: str = ([0m
[30;1m524 | [0m[35m                "You need to connect to the service before using this function."[0m
[30;1m525 | [0m[35m            )[0m
[30;1m526 | [0m[35m            raise MsticpyNotConnectedError([0m
[30;1m527 | [0m[35m                err_msg,[0m

[31m--[ [0m[34mMatch #[0m[33m1171[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m414 | [0m[35m        # Check if connection and client required are already present[0m
[30;1m415 | [0m[35m        if self.connected is False:[0m
[30;1m416 | [0m[35m            err_msg: str = ([0m
[30;1m417 | [0m[35m                "You need to connect to the service before using this function."[0m
[30;1m418 | [0m[35m            )[0m
[30;1m419 | [0m[35m            raise MsticpyNotConnectedError([0m
[30;1m420 | [0m[35m                err_msg,[0m

[31m--[ [0m[34mMatch #[0m[33m1172[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m        """[0m
[30;1m309 | [0m[35m        if self.connected is False:[0m
[30;1m310 | [0m[35m            err_msg: str = ([0m
[30;1m311 | [0m[35m                "You need to connect to the service before using this function."[0m
[30;1m312 | [0m[35m            )[0m
[30;1m313 | [0m[35m            raise MsticpyNotConnectedError([0m
[30;1m314 | [0m[35m                err_msg,[0m

[31m--[ [0m[34mMatch #[0m[33m1173[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/azure_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        if self.connected is False:[0m
[30;1m253 | [0m[35m            err_msg: str = ([0m
[30;1m254 | [0m[35m                "You need to connect to the service before using this function."[0m
[30;1m255 | [0m[35m            )[0m
[30;1m256 | [0m[35m            raise MsticpyNotConnectedError([0m
[30;1m257 | [0m[35m                err_msg,[0m

[31m--[ [0m[34mMatch #[0m[33m1174[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m            az_cli_config.args.get("tenantId") or ""[0m
[30;1m105 | [0m[35m        )[0m
[30;1m106 | [0m[35m        os.environ[AzureCredEnvNames.AZURE_CLIENT_SECRET] = ([0m
[30;1m107 | [0m[35m            az_cli_config.args.get("clientSecret") or ""[0m
[30;1m108 | [0m[35m        )[0m
[30;1m109 | [0m[35m    credentials: AzCredentials = az_connect_core([0m
[30;1m110 | [0m[35m        auth_methods=auth_methods,[0m

[31m--[ [0m[34mMatch #[0m[33m1175[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m            az_cli_config.args.get("clientId") or ""[0m
[30;1m102 | [0m[35m        )[0m
[30;1m103 | [0m[35m        os.environ[AzureCredEnvNames.AZURE_TENANT_ID] = ([0m
[30;1m104 | [0m[35m            az_cli_config.args.get("tenantId") or ""[0m
[30;1m105 | [0m[35m        )[0m
[30;1m106 | [0m[35m        os.environ[AzureCredEnvNames.AZURE_CLIENT_SECRET] = ([0m
[30;1m107 | [0m[35m            az_cli_config.args.get("clientSecret") or ""[0m

[31m--[ [0m[34mMatch #[0m[33m1176[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m        and "env" in auth_methods[0m
[30;1m99 | [0m[35m    ):[0m
[30;1m100 | [0m[35m        os.environ[AzureCredEnvNames.AZURE_CLIENT_ID] = ([0m
[30;1m101 | [0m[35m            az_cli_config.args.get("clientId") or ""[0m
[30;1m102 | [0m[35m        )[0m
[30;1m103 | [0m[35m        os.environ[AzureCredEnvNames.AZURE_TENANT_ID] = ([0m
[30;1m104 | [0m[35m            az_cli_config.args.get("tenantId") or ""[0m

[31m--[ [0m[34mMatch #[0m[33m1177[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/azure_auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m    tenant_id = tenant_id or az_cloud_config.tenant_id[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    # Ignore AzCLI settings except for authentication creds for EnvCred[0m
[30;1m93 | [0m[35m    az_cli_config: ProviderSettings | None = data_provs.get("AzureCLI")[0m
[30;1m94 | [0m[35m    if ([0m
[30;1m95 | [0m[35m        az_cli_config[0m
[30;1m96 | [0m[35m        and az_cli_config.args[0m

[31m--[ [0m[34mMatch #[0m[33m1178[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m515 | [0m[35m        if not self._token:[0m
[30;1m516 | [0m[35m            err_msg = "Token not found, can't query indicators."[0m
[30;1m517 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m518 | [0m[35m        response: httpx.Response = httpx.post([0m
[30;1m519 | [0m[35m            ti_url,[0m
[30;1m520 | [0m[35m            headers=get_api_headers(self._token),[0m
[30;1m521 | [0m[35m            params=params,[0m

[31m--[ [0m[34mMatch #[0m[33m1179[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m        if not self._token:[0m
[30;1m288 | [0m[35m            err_msg = "Token not found, can't get indicator."[0m
[30;1m289 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m290 | [0m[35m        response: httpx.Response = httpx.get([0m
[30;1m291 | [0m[35m            ti_url,[0m
[30;1m292 | [0m[35m            headers=get_api_headers(self._token),[0m
[30;1m293 | [0m[35m            params=params,[0m

[31m--[ [0m[34mMatch #[0m[33m1180[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m        if not silent:[0m
[30;1m221 | [0m[35m            logger.info("Indicator created.")[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        return response.json().get("name")[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m    def bulk_create_indicators([0m
[30;1m226 | [0m[35m        self: Self,[0m

[31m--[ [0m[34mMatch #[0m[33m1181[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        if not self._token:[0m
[30;1m209 | [0m[35m            err_msg = "Token not found, can't create indicator."[0m
[30;1m210 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m211 | [0m[35m        response: httpx.Response = httpx.post([0m
[30;1m212 | [0m[35m            ti_url,[0m
[30;1m213 | [0m[35m            headers=get_api_headers(self._token),[0m
[30;1m214 | [0m[35m            params=params,[0m

[31m--[ [0m[34mMatch #[0m[33m1182[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m369 | [0m[35m        data["kind"] = "indicator"[0m
[30;1m370 | [0m[35m        params: dict[str, str] = {"api-version": "2021-10-01"}[0m
[30;1m371 | [0m[35m        if not self._token:[0m
[30;1m372 | [0m[35m            err_msg = "Token not found, can't update indicator."[0m
[30;1m373 | [0m[35m            raise ValueError(err_msg)[0m
[30;1m374 | [0m[35m        response: httpx.Response = httpx.put([0m
[30;1m375 | [0m[35m            ti_url,[0m

[31m--[ [0m[34mMatch #[0m[33m1183[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m317 | [0m[35m        Parameters[0m
[30;1m318 | [0m[35m        ----------[0m
[30;1m319 | [0m[35m        indicator_id : str[0m
[30;1m320 | [0m[35m            The GUID of the indicator to update[0m
[30;1m321 | [0m[35m        name : str, optional[0m
[30;1m322 | [0m[35m            A common name to give to the indicator default is 'TI Indicator'[0m
[30;1m323 | [0m[35m        confidence : int, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1184[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m312 | [0m[35m        valid_to: dt.datetime | None = None,[0m
[30;1m313 | [0m[35m    ) -> None:[0m
[30;1m314 | [0m[35m        """[0m
[30;1m315 | [0m[35m        Update an existing indicator within the Microsoft Sentinel workspace.[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m        Parameters[0m
[30;1m318 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1185[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m470 | [0m[35m        pattern_types : list, optional[0m
[30;1m471 | [0m[35m            A list of IoC types to include.[0m
[30;1m472 | [0m[35m        sort_by : List, optional[0m
[30;1m473 | [0m[35m            Columns to sort by and sorting order as:[0m
[30;1m474 | [0m[35m            [{"itemKey": COLUMN_NAME, "sortOrder": ascending/descending}][0m
[30;1m475 | [0m[35m        sources: list, optional[0m
[30;1m476 | [0m[35m            A list of indicator sources to include[0m

[31m--[ [0m[34mMatch #[0m[33m1186[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m464 | [0m[35m        min_confidence : int, optional[0m
[30;1m465 | [0m[35m            Minimum confidence.[0m
[30;1m466 | [0m[35m        min_valid_until : str, optional[0m
[30;1m467 | [0m[35m            Start time for ValidUntil filter.[0m
[30;1m468 | [0m[35m        page_size : int, optional[0m
[30;1m469 | [0m[35m            Maximum number of results to return in one page.[0m
[30;1m470 | [0m[35m        pattern_types : list, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1187[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m460 | [0m[35m        max_confidence : int, optional[0m
[30;1m461 | [0m[35m            Maximum confidence.[0m
[30;1m462 | [0m[35m        max_valid_until : str, optional[0m
[30;1m463 | [0m[35m            End time for ValidUntil filter.[0m
[30;1m464 | [0m[35m        min_confidence : int, optional[0m
[30;1m465 | [0m[35m            Minimum confidence.[0m
[30;1m466 | [0m[35m        min_valid_until : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1188[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m        Parameters[0m
[30;1m128 | [0m[35m        ----------[0m
[30;1m129 | [0m[35m        indicator : str[0m
[30;1m130 | [0m[35m            The indicator to create - i.e. IP address, domain name etc.[0m
[30;1m131 | [0m[35m        ioc_type : str[0m
[30;1m132 | [0m[35m            The type of indicator to create - can be:[0m
[30;1m133 | [0m[35m            "dns", "url", "ipv4", "ipv6", "md5_hash", "sha1_hash", "sha256_hash"[0m

[31m--[ [0m[34mMatch #[0m[33m1189[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/azure/sentinel_ti.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m        Parameters[0m
[30;1m69 | [0m[35m        ----------[0m
[30;1m70 | [0m[35m        limit: int, optional[0m
[30;1m71 | [0m[35m            If set returns top n results[0m
[30;1m72 | [0m[35m        orderby : Optional[str], optional[0m
[30;1m73 | [0m[35m            Order results by a specific column[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1190[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m  tools for dealing with tranforming data (e.g. auditd, process tree)[0m
[30;1m13 | [0m[35m  or extracting specific data formats (iocextract, b64, cmdline)[0m
[30;1m14 | [0m[35m- other items are miscellaneous analysis modules such anomalous[0m
[30;1m15 | [0m[35m  sequence, time series, eventcluster.[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m"""[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1191[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m                "AlertDisplayName",[0m
[30;1m89 | [0m[35m                self.properties.get("DisplayName", "no alert name"),[0m
[30;1m90 | [0m[35m            )[0m
[30;1m91 | [0m[35m            entity = self.properties.get("CompromisedEntity", "unknown")[0m
[30;1m92 | [0m[35m            title = f"""[0m
[30;1m93 | [0m[35m            <h3>Alert: '{name}'</h3>[0m
[30;1m94 | [0m[35m            <b>Alert_time:</b> {start},[0m

[31m--[ [0m[34mMatch #[0m[33m1192[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m            )[0m
[30;1m87 | [0m[35m            name = self.properties.get([0m
[30;1m88 | [0m[35m                "AlertDisplayName",[0m
[30;1m89 | [0m[35m                self.properties.get("DisplayName", "no alert name"),[0m
[30;1m90 | [0m[35m            )[0m
[30;1m91 | [0m[35m            entity = self.properties.get("CompromisedEntity", "unknown")[0m
[30;1m92 | [0m[35m            title = f"""[0m

[31m--[ [0m[34mMatch #[0m[33m1193[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m            start = self.properties.get([0m
[30;1m85 | [0m[35m                "StartTimeUtc", self.properties.get("StartTime", "no timestamp")[0m
[30;1m86 | [0m[35m            )[0m
[30;1m87 | [0m[35m            name = self.properties.get([0m
[30;1m88 | [0m[35m                "AlertDisplayName",[0m
[30;1m89 | [0m[35m                self.properties.get("DisplayName", "no alert name"),[0m
[30;1m90 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1194[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        """Return the item as HTML string."""[0m
[30;1m83 | [0m[35m        if self.properties:[0m
[30;1m84 | [0m[35m            start = self.properties.get([0m
[30;1m85 | [0m[35m                "StartTimeUtc", self.properties.get("StartTime", "no timestamp")[0m
[30;1m86 | [0m[35m            )[0m
[30;1m87 | [0m[35m            name = self.properties.get([0m
[30;1m88 | [0m[35m                "AlertDisplayName",[0m

[31m--[ [0m[34mMatch #[0m[33m1195[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    def to_html(self, show_entities=False) -> str:[0m
[30;1m82 | [0m[35m        """Return the item as HTML string."""[0m
[30;1m83 | [0m[35m        if self.properties:[0m
[30;1m84 | [0m[35m            start = self.properties.get([0m
[30;1m85 | [0m[35m                "StartTimeUtc", self.properties.get("StartTime", "no timestamp")[0m
[30;1m86 | [0m[35m            )[0m
[30;1m87 | [0m[35m            name = self.properties.get([0m

[31m--[ [0m[34mMatch #[0m[33m1196[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/azure_sent_byoti.py[0m
   Pattern: [32m.hostname[0m
[30;1m52 | [0m[35m    _QUERIES["sha1_hash"] = _QUERIES["file_hash"][0m
[30;1m53 | [0m[35m    _QUERIES["sha256_hash"] = _QUERIES["file_hash"][0m
[30;1m54 | [0m[35m    _QUERIES["linux_path"] = _QUERIES["windows_path"][0m
[30;1m55 | [0m[35m    _QUERIES["hostname"] = _QUERIES["dns"][0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    _REQUIRED_TABLES: ClassVar[list[str]] = ["ThreatIntelligenceIndicator"][0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1197[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/query_browser.py[0m
   Pattern: [32m.hostname[0m
[30;1m77 | [0m[35m    return f"""[0m
[30;1m78 | [0m[35m        <p><b>Example</b></p>[0m
[30;1m79 | [0m[35m        <p>{{QueryProvider}}[.QueryPath].QueryName(params...)</p>[0m
[30;1m80 | [0m[35m        <pre>qry_prov.{query}(start=start, end=end, hostname=host)</pre>[0m
[30;1m81 | [0m[35m    """[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1198[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m                    "Actor": response["RawResult"].get("actor"),[0m
[30;1m97 | [0m[35m                    "Tags": response["RawResult"].get("tags"),[0m
[30;1m98 | [0m[35m                    "VPN": response["RawResult"].get("vpn_service", False),[0m
[30;1m99 | [0m[35m                    "Metadata": response["RawResult"].get("metadata"),[0m
[30;1m100 | [0m[35m                },[0m
[30;1m101 | [0m[35m            )[0m
[30;1m102 | [0m[35m        # If enterprise quick lookup just return raw data is its so small[0m

[31m--[ [0m[34mMatch #[0m[33m1199[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m96 | [0m[35m                    "Actor": response["RawResult"].get("actor"),[0m
[30;1m97 | [0m[35m                    "Tags": response["RawResult"].get("tags"),[0m
[30;1m98 | [0m[35m                    "VPN": response["RawResult"].get("vpn_service", False),[0m
[30;1m99 | [0m[35m                    "Metadata": response["RawResult"].get("metadata"),[0m
[30;1m100 | [0m[35m                },[0m
[30;1m101 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1200[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m                    "First Seen": response["RawResult"].get("first_seen"),[0m
[30;1m95 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m96 | [0m[35m                    "Actor": response["RawResult"].get("actor"),[0m
[30;1m97 | [0m[35m                    "Tags": response["RawResult"].get("tags"),[0m
[30;1m98 | [0m[35m                    "VPN": response["RawResult"].get("vpn_service", False),[0m
[30;1m99 | [0m[35m                    "Metadata": response["RawResult"].get("metadata"),[0m
[30;1m100 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m1201[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m                    "Classification": response["RawResult"].get("classification"),[0m
[30;1m94 | [0m[35m                    "First Seen": response["RawResult"].get("first_seen"),[0m
[30;1m95 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m96 | [0m[35m                    "Actor": response["RawResult"].get("actor"),[0m
[30;1m97 | [0m[35m                    "Tags": response["RawResult"].get("tags"),[0m
[30;1m98 | [0m[35m                    "VPN": response["RawResult"].get("vpn_service", False),[0m
[30;1m99 | [0m[35m                    "Metadata": response["RawResult"].get("metadata"),[0m

[31m--[ [0m[34mMatch #[0m[33m1202[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m                {[0m
[30;1m93 | [0m[35m                    "Classification": response["RawResult"].get("classification"),[0m
[30;1m94 | [0m[35m                    "First Seen": response["RawResult"].get("first_seen"),[0m
[30;1m95 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m96 | [0m[35m                    "Actor": response["RawResult"].get("actor"),[0m
[30;1m97 | [0m[35m                    "Tags": response["RawResult"].get("tags"),[0m
[30;1m98 | [0m[35m                    "VPN": response["RawResult"].get("vpn_service", False),[0m

[31m--[ [0m[34mMatch #[0m[33m1203[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m            result_dict.update([0m
[30;1m92 | [0m[35m                {[0m
[30;1m93 | [0m[35m                    "Classification": response["RawResult"].get("classification"),[0m
[30;1m94 | [0m[35m                    "First Seen": response["RawResult"].get("first_seen"),[0m
[30;1m95 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m96 | [0m[35m                    "Actor": response["RawResult"].get("actor"),[0m
[30;1m97 | [0m[35m                    "Tags": response["RawResult"].get("tags"),[0m

[31m--[ [0m[34mMatch #[0m[33m1204[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m        if "actor" in response["RawResult"]:[0m
[30;1m91 | [0m[35m            result_dict.update([0m
[30;1m92 | [0m[35m                {[0m
[30;1m93 | [0m[35m                    "Classification": response["RawResult"].get("classification"),[0m
[30;1m94 | [0m[35m                    "First Seen": response["RawResult"].get("first_seen"),[0m
[30;1m95 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m96 | [0m[35m                    "Actor": response["RawResult"].get("actor"),[0m

[31m--[ [0m[34mMatch #[0m[33m1205[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m84 | [0m[35m                    "Message": response["RawResult"].get("message"),[0m
[30;1m85 | [0m[35m                    "Noise": response["RawResult"].get("noise"),[0m
[30;1m86 | [0m[35m                    "RIOT": response["RawResult"].get("riot"),[0m
[30;1m87 | [0m[35m                },[0m
[30;1m88 | [0m[35m            )[0m
[30;1m89 | [0m[35m        # If enterprise full lookup response extract key elements[0m

[31m--[ [0m[34mMatch #[0m[33m1206[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m                    "Name": response["RawResult"].get("name"),[0m
[30;1m83 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m84 | [0m[35m                    "Message": response["RawResult"].get("message"),[0m
[30;1m85 | [0m[35m                    "Noise": response["RawResult"].get("noise"),[0m
[30;1m86 | [0m[35m                    "RIOT": response["RawResult"].get("riot"),[0m
[30;1m87 | [0m[35m                },[0m
[30;1m88 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1207[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m                    "Classification": response["RawResult"].get("classification"),[0m
[30;1m82 | [0m[35m                    "Name": response["RawResult"].get("name"),[0m
[30;1m83 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m84 | [0m[35m                    "Message": response["RawResult"].get("message"),[0m
[30;1m85 | [0m[35m                    "Noise": response["RawResult"].get("noise"),[0m
[30;1m86 | [0m[35m                    "RIOT": response["RawResult"].get("riot"),[0m
[30;1m87 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m1208[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m                {[0m
[30;1m81 | [0m[35m                    "Classification": response["RawResult"].get("classification"),[0m
[30;1m82 | [0m[35m                    "Name": response["RawResult"].get("name"),[0m
[30;1m83 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m84 | [0m[35m                    "Message": response["RawResult"].get("message"),[0m
[30;1m85 | [0m[35m                    "Noise": response["RawResult"].get("noise"),[0m
[30;1m86 | [0m[35m                    "RIOT": response["RawResult"].get("riot"),[0m

[31m--[ [0m[34mMatch #[0m[33m1209[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m            result_dict.update([0m
[30;1m80 | [0m[35m                {[0m
[30;1m81 | [0m[35m                    "Classification": response["RawResult"].get("classification"),[0m
[30;1m82 | [0m[35m                    "Name": response["RawResult"].get("name"),[0m
[30;1m83 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m84 | [0m[35m                    "Message": response["RawResult"].get("message"),[0m
[30;1m85 | [0m[35m                    "Noise": response["RawResult"].get("noise"),[0m

[31m--[ [0m[34mMatch #[0m[33m1210[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/greynoise.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        if "riot" in response["RawResult"]:[0m
[30;1m79 | [0m[35m            result_dict.update([0m
[30;1m80 | [0m[35m                {[0m
[30;1m81 | [0m[35m                    "Classification": response["RawResult"].get("classification"),[0m
[30;1m82 | [0m[35m                    "Name": response["RawResult"].get("name"),[0m
[30;1m83 | [0m[35m                    "Last Seen": response["RawResult"].get("last_seen"),[0m
[30;1m84 | [0m[35m                    "Message": response["RawResult"].get("message"),[0m

[31m--[ [0m[34mMatch #[0m[33m1211[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35mget_config = settings.get_config[0m
[30;1m135 | [0m[35msetup_logging()[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35mif not os.environ.get("KQLMAGIC_EXTRAS_REQUIRES"):[0m
[30;1m138 | [0m[35m    os.environ["KQLMAGIC_EXTRAS_REQUIRES"] = "jupyter-basic"[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m_LAZY_IMPORTS = {[0m

[31m--[ [0m[34mMatch #[0m[33m1212[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/open_page_rank.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m        try:[0m
[30;1m253 | [0m[35m            _, req_params = self._substitute_parms("dummy", "dns", None)[0m
[30;1m254 | [0m[35m            response: httpx.Response = self._httpx_client.get([0m
[30;1m255 | [0m[35m                url=req_url,[0m
[30;1m256 | [0m[35m                headers=req_params["headers"],[0m
[30;1m257 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1213[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/open_page_rank.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m                ResultSeverity.warning,[0m
[30;1m226 | [0m[35m                {[0m
[30;1m227 | [0m[35m                    "rank": dom_record.get("rank", "0"),[0m
[30;1m228 | [0m[35m                    "error": dom_record.get("error", ""),[0m
[30;1m229 | [0m[35m                },[0m
[30;1m230 | [0m[35m            )[0m
[30;1m231 | [0m[35m        return False, ResultSeverity.information, {}[0m

[31m--[ [0m[34mMatch #[0m[33m1214[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/open_page_rank.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m                True,[0m
[30;1m225 | [0m[35m                ResultSeverity.warning,[0m
[30;1m226 | [0m[35m                {[0m
[30;1m227 | [0m[35m                    "rank": dom_record.get("rank", "0"),[0m
[30;1m228 | [0m[35m                    "error": dom_record.get("error", ""),[0m
[30;1m229 | [0m[35m                },[0m
[30;1m230 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1215[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/open_page_rank.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m                {[0m
[30;1m217 | [0m[35m                    "rank": dom_record.get("rank", "0"),[0m
[30;1m218 | [0m[35m                    "page_rank": dom_record.get("page_rank_decimal", 0),[0m
[30;1m219 | [0m[35m                    "error": dom_record.get("error", ""),[0m
[30;1m220 | [0m[35m                },[0m
[30;1m221 | [0m[35m            )[0m
[30;1m222 | [0m[35m        if record_status == httpx.codes.NOT_FOUND:[0m

[31m--[ [0m[34mMatch #[0m[33m1216[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/open_page_rank.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m                severity,[0m
[30;1m216 | [0m[35m                {[0m
[30;1m217 | [0m[35m                    "rank": dom_record.get("rank", "0"),[0m
[30;1m218 | [0m[35m                    "page_rank": dom_record.get("page_rank_decimal", 0),[0m
[30;1m219 | [0m[35m                    "error": dom_record.get("error", ""),[0m
[30;1m220 | [0m[35m                },[0m
[30;1m221 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1217[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/open_page_rank.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m                True,[0m
[30;1m215 | [0m[35m                severity,[0m
[30;1m216 | [0m[35m                {[0m
[30;1m217 | [0m[35m                    "rank": dom_record.get("rank", "0"),[0m
[30;1m218 | [0m[35m                    "page_rank": dom_record.get("page_rank_decimal", 0),[0m
[30;1m219 | [0m[35m                    "error": dom_record.get("error", ""),[0m
[30;1m220 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m1218[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/open_page_rank.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m    def _parse_one_record([0m
[30;1m208 | [0m[35m        dom_record: dict,[0m
[30;1m209 | [0m[35m    ) -> tuple[bool, ResultSeverity, dict[str, Any]]:[0m
[30;1m210 | [0m[35m        record_status: int = dom_record.get("status_code", 404)[0m
[30;1m211 | [0m[35m        severity = ResultSeverity.information[0m
[30;1m212 | [0m[35m        if record_status == httpx.codes.OK:[0m
[30;1m213 | [0m[35m            return ([0m

[31m--[ [0m[34mMatch #[0m[33m1219[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/figure_dimension.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m            )[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m            func_kwargs = {[0m
[30;1m80 | [0m[35m                param_mapper.get(param, param): value for param, value in kwargs.items()[0m
[30;1m81 | [0m[35m            }[0m
[30;1m82 | [0m[35m            return func(*args, **func_kwargs)[0m
[30;1m83 | [0m[35m        return func(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m1220[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/kql_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m        end: dt.datetime | None = None,[0m
[30;1m368 | [0m[35m    ) -> tuple[Callable, dict[str, Any]]:[0m
[30;1m369 | [0m[35m        ioc_key: str = f"{ioc_type}-{query_type}" if query_type else ioc_type[0m
[30;1m370 | [0m[35m        query_def: tuple | None = self._QUERIES.get(ioc_key, None)[0m
[30;1m371 | [0m[35m        if not query_def:[0m
[30;1m372 | [0m[35m            err_msg: str = f"Provider does not support IoC type {ioc_key}."[0m
[30;1m373 | [0m[35m            raise LookupError(err_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1221[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/kql_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m            "workspaceid": ["workspace_id", "workspaceid"],[0m
[30;1m352 | [0m[35m            "tenantid": ["tenant_id", "tenantid"],[0m
[30;1m353 | [0m[35m        }[0m
[30;1m354 | [0m[35m        variants: list[str] = variant_dict.get(name, [name.casefold()])[0m
[30;1m355 | [0m[35m        return next([0m
[30;1m356 | [0m[35m            (val for key, val in kwargs.items() if key.casefold() in variants),[0m
[30;1m357 | [0m[35m            None,[0m

[31m--[ [0m[34mMatch #[0m[33m1222[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/kql_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m            # If a config file or a workspace name is passed we'll use[0m
[30;1m322 | [0m[35m            # those in case there are multiple workspaces set globally.[0m
[30;1m323 | [0m[35m            config_file: str | None = kwargs.get("config_file")[0m
[30;1m324 | [0m[35m            workspace: str | None = kwargs.get("workspace")[0m
[30;1m325 | [0m[35m            ws_config: WorkspaceConfig = WorkspaceConfig([0m
[30;1m326 | [0m[35m                config_file=config_file,[0m
[30;1m327 | [0m[35m                workspace=workspace,[0m

[31m--[ [0m[34mMatch #[0m[33m1223[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/kql_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m            # WorkspaceConfig should be able to get these global values[0m
[30;1m321 | [0m[35m            # If a config file or a workspace name is passed we'll use[0m
[30;1m322 | [0m[35m            # those in case there are multiple workspaces set globally.[0m
[30;1m323 | [0m[35m            config_file: str | None = kwargs.get("config_file")[0m
[30;1m324 | [0m[35m            workspace: str | None = kwargs.get("workspace")[0m
[30;1m325 | [0m[35m            ws_config: WorkspaceConfig = WorkspaceConfig([0m
[30;1m326 | [0m[35m                config_file=config_file,[0m

[31m--[ [0m[34mMatch #[0m[33m1224[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/kql_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m            if not query_obj:[0m
[30;1m203 | [0m[35m                logger.info("No query found for %s", ioc_type)[0m
[30;1m204 | [0m[35m                warnings.warn([0m
[30;1m205 | [0m[35m                    f"Could not find query for {ioc_type}, {query_type}",[0m
[30;1m206 | [0m[35m                    stacklevel=1,[0m
[30;1m207 | [0m[35m                )[0m
[30;1m208 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m1225[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/secret_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m            return self._create_secret_func(self._keyring_client, secret_name)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        # If the secret is not in keyring, get the vault holding this secret[0m
[30;1m181 | [0m[35m        if not self.kv_secret_vault.get(secret_name):[0m
[30;1m182 | [0m[35m            self._add_key_vault(secret_name=secret_name, vault_name=vault_name)[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        vault = self.kv_vaults[vault_name][0m

[31m--[ [0m[34mMatch #[0m[33m1226[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/secret_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m            return None, str(setting_item)[0m
[30;1m150 | [0m[35m        if "KeyVault" in setting_item:[0m
[30;1m151 | [0m[35m            kv_val = setting_item.get("KeyVault")[0m
[30;1m152 | [0m[35m            def_vault_name = self._kv_settings.get("VaultName")[0m
[30;1m153 | [0m[35m            if not kv_val or kv_val.casefold() == "default":[0m
[30;1m154 | [0m[35m                # If no value, get the default VaultName from settings[0m
[30;1m155 | [0m[35m                # and use the setting path as the secret name[0m

[31m--[ [0m[34mMatch #[0m[33m1227[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/secret_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        if not isinstance(setting_item, dict):[0m
[30;1m149 | [0m[35m            return None, str(setting_item)[0m
[30;1m150 | [0m[35m        if "KeyVault" in setting_item:[0m
[30;1m151 | [0m[35m            kv_val = setting_item.get("KeyVault")[0m
[30;1m152 | [0m[35m            def_vault_name = self._kv_settings.get("VaultName")[0m
[30;1m153 | [0m[35m            if not kv_val or kv_val.casefold() == "default":[0m
[30;1m154 | [0m[35m                # If no value, get the default VaultName from settings[0m

[31m--[ [0m[34mMatch #[0m[33m1228[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/secret_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    def _add_key_vault(self, vault_name: str, secret_name: str):[0m
[30;1m130 | [0m[35m        """Add the KeyVault instance responsible for storing `secret_name`."""[0m
[30;1m131 | [0m[35m        vault = self.kv_vaults.get(vault_name)[0m
[30;1m132 | [0m[35m        if not vault:[0m
[30;1m133 | [0m[35m            vault = BHKeyVaultClient(self.tenant_id, vault_name=vault_name)[0m
[30;1m134 | [0m[35m            self.kv_vaults[vault_name] = vault[0m

[31m--[ [0m[34mMatch #[0m[33m1229[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/secret_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m        self._use_keyring = ([0m
[30;1m102 | [0m[35m            _KEYRING_INSTALLED[0m
[30;1m103 | [0m[35m            and KeyringClient.is_keyring_available()[0m
[30;1m104 | [0m[35m            and (use_keyring or self._kv_settings.get("UseKeyring", False))[0m
[30;1m105 | [0m[35m        )[0m
[30;1m106 | [0m[35m        if self._use_keyring:[0m
[30;1m107 | [0m[35m            self._keyring_client = KeyringClient("Providers")[0m

[31m--[ [0m[34mMatch #[0m[33m1230[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/secret_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        """[0m
[30;1m84 | [0m[35m        self._kv_settings = KeyVaultSettings()[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        self.tenant_id = tenant_id or self._kv_settings.get("tenantid")[0m
[30;1m87 | [0m[35m        self._auth_dict = {[0m
[30;1m88 | [0m[35m            "tenant_id": self.tenant_id,[0m
[30;1m89 | [0m[35m            "auth_methods": auth_methods,[0m

[31m--[ [0m[34mMatch #[0m[33m1231[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/secret_settings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m            Possible values are:[0m
[30;1m53 | [0m[35m            - "env" - to get authentication details from environment variables[0m
[30;1m54 | [0m[35m            - "cli" - to use Azure CLI authentication details[0m
[30;1m55 | [0m[35m            - "msi" - to user Managed Service Identity details[0m
[30;1m56 | [0m[35m            - "interactive" - to prompt for interactive login[0m
[30;1m57 | [0m[35m            - "vscode" - to use VSCode credentials[0m
[30;1m58 | [0m[35m            - "powershell" - to use PowerShell credentials[0m

[31m--[ [0m[34mMatch #[0m[33m1232[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ti_http_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        ) as err:[0m
[30;1m223 | [0m[35m            self._err_to_results(result, err)[0m
[30;1m224 | [0m[35m            if not isinstance(err, LookupError):[0m
[30;1m225 | [0m[35m                url: str | None = req_params.get("url") if req_params else None[0m
[30;1m226 | [0m[35m                result["Reference"] = url[0m
[30;1m227 | [0m[35m        return pd.DataFrame([result])[0m

[31m--[ [0m[34mMatch #[0m[33m1233[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ti_http_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m                timeout=get_http_timeout(timeout=timeout),[0m
[30;1m117 | [0m[35m            )[0m
[30;1m118 | [0m[35m        elif verb == "POST":[0m
[30;1m119 | [0m[35m            response = self._httpx_client.post([0m
[30;1m120 | [0m[35m                **req_params,[0m
[30;1m121 | [0m[35m                timeout=get_http_timeout(timeout=timeout),[0m
[30;1m122 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1234[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ti_http_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m            query_type,[0m
[30;1m112 | [0m[35m        )[0m
[30;1m113 | [0m[35m        if verb == "GET":[0m
[30;1m114 | [0m[35m            response: httpx.Response = self._httpx_client.get([0m
[30;1m115 | [0m[35m                **req_params,[0m
[30;1m116 | [0m[35m                timeout=get_http_timeout(timeout=timeout),[0m
[30;1m117 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1235[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ti_http_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m        provider_name : str, optional[0m
[30;1m177 | [0m[35m            Name of the provider to query for the lookup[0m
[30;1m178 | [0m[35m        timeout : str, optional[0m
[30;1m179 | [0m[35m            Timeout for lookup queries[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        Returns[0m
[30;1m182 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1236[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ti_http_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m            will be returned.[0m
[30;1m176 | [0m[35m        provider_name : str, optional[0m
[30;1m177 | [0m[35m            Name of the provider to query for the lookup[0m
[30;1m178 | [0m[35m        timeout : str, optional[0m
[30;1m179 | [0m[35m            Timeout for lookup queries[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m1237[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ti_http_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        provider_name : str, optional[0m
[30;1m82 | [0m[35m            Name of the provider to use for the lookup[0m
[30;1m83 | [0m[35m        timeout : int, optional[0m
[30;1m84 | [0m[35m            Timeout to use for lookups[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        Returns[0m
[30;1m87 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1238[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/ti_http_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m            will be returned.[0m
[30;1m81 | [0m[35m        provider_name : str, optional[0m
[30;1m82 | [0m[35m            Name of the provider to use for the lookup[0m
[30;1m83 | [0m[35m        timeout : int, optional[0m
[30;1m84 | [0m[35m            Timeout to use for lookups[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m1239[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/abuseipdb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m            "lastReportedAt": data.get("lastReportedAt"),[0m
[30;1m68 | [0m[35m        }[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        score: int = data.get("abuseConfidenceScore", 0)[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        if score > self.HIGH_SEVERITY:[0m
[30;1m73 | [0m[35m            result_severity = ResultSeverity.high[0m

[31m--[ [0m[34mMatch #[0m[33m1240[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/abuseipdb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m            "isp": data.get("isp"),[0m
[30;1m65 | [0m[35m            "domain": data.get("domain"),[0m
[30;1m66 | [0m[35m            "hostNames": data.get("hostnames"),[0m
[30;1m67 | [0m[35m            "lastReportedAt": data.get("lastReportedAt"),[0m
[30;1m68 | [0m[35m        }[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        score: int = data.get("abuseConfidenceScore", 0)[0m

[31m--[ [0m[34mMatch #[0m[33m1241[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/abuseipdb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m            "usage": data.get("usageType"),[0m
[30;1m64 | [0m[35m            "isp": data.get("isp"),[0m
[30;1m65 | [0m[35m            "domain": data.get("domain"),[0m
[30;1m66 | [0m[35m            "hostNames": data.get("hostnames"),[0m
[30;1m67 | [0m[35m            "lastReportedAt": data.get("lastReportedAt"),[0m
[30;1m68 | [0m[35m        }[0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1242[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/abuseipdb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m            "countryCode": data.get("countryCode"),[0m
[30;1m63 | [0m[35m            "usage": data.get("usageType"),[0m
[30;1m64 | [0m[35m            "isp": data.get("isp"),[0m
[30;1m65 | [0m[35m            "domain": data.get("domain"),[0m
[30;1m66 | [0m[35m            "hostNames": data.get("hostnames"),[0m
[30;1m67 | [0m[35m            "lastReportedAt": data.get("lastReportedAt"),[0m
[30;1m68 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m1243[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/abuseipdb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        result_dict: dict[str, Any] = {[0m
[30;1m62 | [0m[35m            "countryCode": data.get("countryCode"),[0m
[30;1m63 | [0m[35m            "usage": data.get("usageType"),[0m
[30;1m64 | [0m[35m            "isp": data.get("isp"),[0m
[30;1m65 | [0m[35m            "domain": data.get("domain"),[0m
[30;1m66 | [0m[35m            "hostNames": data.get("hostnames"),[0m
[30;1m67 | [0m[35m            "lastReportedAt": data.get("lastReportedAt"),[0m

[31m--[ [0m[34mMatch #[0m[33m1244[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/abuseipdb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m        data: dict[str, Any] = response["RawResult"]["data"][0m
[30;1m61 | [0m[35m        result_dict: dict[str, Any] = {[0m
[30;1m62 | [0m[35m            "countryCode": data.get("countryCode"),[0m
[30;1m63 | [0m[35m            "usage": data.get("usageType"),[0m
[30;1m64 | [0m[35m            "isp": data.get("isp"),[0m
[30;1m65 | [0m[35m            "domain": data.get("domain"),[0m
[30;1m66 | [0m[35m            "hostNames": data.get("hostnames"),[0m

[31m--[ [0m[34mMatch #[0m[33m1245[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/abuseipdb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        data: dict[str, Any] = response["RawResult"]["data"][0m
[30;1m61 | [0m[35m        result_dict: dict[str, Any] = {[0m
[30;1m62 | [0m[35m            "countryCode": data.get("countryCode"),[0m
[30;1m63 | [0m[35m            "usage": data.get("usageType"),[0m
[30;1m64 | [0m[35m            "isp": data.get("isp"),[0m
[30;1m65 | [0m[35m            "domain": data.get("domain"),[0m

[31m--[ [0m[34mMatch #[0m[33m1246[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1113 | [0m[35m    return QueryParameter([0m
[30;1m1114 | [0m[35m        description=param_data.get("description", ""),[0m
[30;1m1115 | [0m[35m        datatype=param_data.get("type", "str"),[0m
[30;1m1116 | [0m[35m        default=param_data.get("default"),[0m
[30;1m1117 | [0m[35m    )[0m
[30;1m1118 | [0m[35m[0m
[30;1m1119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1247[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1112 | [0m[35m    """Create a Parameter object."""[0m
[30;1m1113 | [0m[35m    return QueryParameter([0m
[30;1m1114 | [0m[35m        description=param_data.get("description", ""),[0m
[30;1m1115 | [0m[35m        datatype=param_data.get("type", "str"),[0m
[30;1m1116 | [0m[35m        default=param_data.get("default"),[0m
[30;1m1117 | [0m[35m    )[0m
[30;1m1118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1248[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1111 | [0m[35mdef _create_parameter(param_data: dict[str, Any]) -> QueryParameter:[0m
[30;1m1112 | [0m[35m    """Create a Parameter object."""[0m
[30;1m1113 | [0m[35m    return QueryParameter([0m
[30;1m1114 | [0m[35m        description=param_data.get("description", ""),[0m
[30;1m1115 | [0m[35m        datatype=param_data.get("type", "str"),[0m
[30;1m1116 | [0m[35m        default=param_data.get("default"),[0m
[30;1m1117 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1249[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1103 | [0m[35m    return Query([0m
[30;1m1104 | [0m[35m        description=query_data.get("description", ""),[0m
[30;1m1105 | [0m[35m        metadata=query_data.get("metadata", {}),[0m
[30;1m1106 | [0m[35m        args=QueryArgs(query=query_data.get("args", {}).get("query", "")),[0m
[30;1m1107 | [0m[35m        parameters=parameters,[0m
[30;1m1108 | [0m[35m    )[0m
[30;1m1109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1250[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1103 | [0m[35m    return Query([0m
[30;1m1104 | [0m[35m        description=query_data.get("description", ""),[0m
[30;1m1105 | [0m[35m        metadata=query_data.get("metadata", {}),[0m
[30;1m1106 | [0m[35m        args=QueryArgs(query=query_data.get("args", {}).get("query", "")),[0m
[30;1m1107 | [0m[35m        parameters=parameters,[0m
[30;1m1108 | [0m[35m    )[0m
[30;1m1109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1251[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1102 | [0m[35m        }[0m
[30;1m1103 | [0m[35m    return Query([0m
[30;1m1104 | [0m[35m        description=query_data.get("description", ""),[0m
[30;1m1105 | [0m[35m        metadata=query_data.get("metadata", {}),[0m
[30;1m1106 | [0m[35m        args=QueryArgs(query=query_data.get("args", {}).get("query", "")),[0m
[30;1m1107 | [0m[35m        parameters=parameters,[0m
[30;1m1108 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1252[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1101 | [0m[35m            name: _create_parameter(param) for name, param in parameters.items()[0m
[30;1m1102 | [0m[35m        }[0m
[30;1m1103 | [0m[35m    return Query([0m
[30;1m1104 | [0m[35m        description=query_data.get("description", ""),[0m
[30;1m1105 | [0m[35m        metadata=query_data.get("metadata", {}),[0m
[30;1m1106 | [0m[35m        args=QueryArgs(query=query_data.get("args", {}).get("query", "")),[0m
[30;1m1107 | [0m[35m        parameters=parameters,[0m

[31m--[ [0m[34mMatch #[0m[33m1253[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1095 | [0m[35m[0m
[30;1m1096 | [0m[35mdef _create_query(query_data: dict[str, Any]) -> Query:[0m
[30;1m1097 | [0m[35m    """Create a Query object."""[0m
[30;1m1098 | [0m[35m    parameters: dict[str, Any] = query_data.get("parameters", {})[0m
[30;1m1099 | [0m[35m    if parameters:[0m
[30;1m1100 | [0m[35m        parameters = {[0m
[30;1m1101 | [0m[35m            name: _create_parameter(param) for name, param in parameters.items()[0m

[31m--[ [0m[34mMatch #[0m[33m1254[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1041 | [0m[35m[0m
[30;1m1042 | [0m[35m    metadata = QueryMetadata(**yaml_data.get("metadata", {}))[0m
[30;1m1043 | [0m[35m    defaults: QueryDefaults = _create_query_defaults(yaml_data.get("defaults", {}))[0m
[30;1m1044 | [0m[35m    queries_dict: dict[str, Any] = yaml_data.get("sources", {})[0m
[30;1m1045 | [0m[35m    queries: dict[str, Query] = {[0m
[30;1m1046 | [0m[35m        name: _create_query(query) for name, query in queries_dict.items()[0m
[30;1m1047 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m1255[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1040 | [0m[35m        yaml_data: dict[str, Any] = yaml.safe_load(f_handle)[0m
[30;1m1041 | [0m[35m[0m
[30;1m1042 | [0m[35m    metadata = QueryMetadata(**yaml_data.get("metadata", {}))[0m
[30;1m1043 | [0m[35m    defaults: QueryDefaults = _create_query_defaults(yaml_data.get("defaults", {}))[0m
[30;1m1044 | [0m[35m    queries_dict: dict[str, Any] = yaml_data.get("sources", {})[0m
[30;1m1045 | [0m[35m    queries: dict[str, Query] = {[0m
[30;1m1046 | [0m[35m        name: _create_query(query) for name, query in queries_dict.items()[0m

[31m--[ [0m[34mMatch #[0m[33m1256[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1039 | [0m[35m    with open(yaml_file, "r", encoding="utf-8") as f_handle:[0m
[30;1m1040 | [0m[35m        yaml_data: dict[str, Any] = yaml.safe_load(f_handle)[0m
[30;1m1041 | [0m[35m[0m
[30;1m1042 | [0m[35m    metadata = QueryMetadata(**yaml_data.get("metadata", {}))[0m
[30;1m1043 | [0m[35m    defaults: QueryDefaults = _create_query_defaults(yaml_data.get("defaults", {}))[0m
[30;1m1044 | [0m[35m    queries_dict: dict[str, Any] = yaml_data.get("sources", {})[0m
[30;1m1045 | [0m[35m    queries: dict[str, Query] = {[0m

[31m--[ [0m[34mMatch #[0m[33m1257[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m990 | [0m[35m    def __enter__(self: Self) -> Self:[0m
[30;1m991 | [0m[35m        """Enter the context manager."""[0m
[30;1m992 | [0m[35m        # Save existing representer for str, if any[0m
[30;1m993 | [0m[35m        self.old_representer = self.dumper.yaml_representers.get(str)[0m
[30;1m994 | [0m[35m[0m
[30;1m995 | [0m[35m        def str_presenter(dumper: yaml.SafeDumper, data: str) -> yaml.ScalarNode:[0m
[30;1m996 | [0m[35m            if "\n" in data:[0m

[31m--[ [0m[34mMatch #[0m[33m1258[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m.hostname[0m
[30;1m681 | [0m[35m        )[0m
[30;1m682 | [0m[35m        self.clusters_widget: widgets.Textarea = widgets.Textarea([0m
[30;1m683 | [0m[35m            description="Kusto Clusters",[0m
[30;1m684 | [0m[35m            placeholder="URI, hostname or alias (one per line)",[0m
[30;1m685 | [0m[35m            **sel_fmt(width="70%", height="75px"),[0m
[30;1m686 | [0m[35m        )[0m
[30;1m687 | [0m[35m        self.cluster_groups_widget: widgets.Textarea = widgets.Textarea([0m

[31m--[ [0m[34mMatch #[0m[33m1259[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/query_editor.py[0m
   Pattern: [32m.hostname[0m
[30;1m676 | [0m[35m        )[0m
[30;1m677 | [0m[35m        self.cluster_widget: widgets.Text = widgets.Text([0m
[30;1m678 | [0m[35m            description="Kusto Cluster",[0m
[30;1m679 | [0m[35m            placeholder="URI, hostname or alias",[0m
[30;1m680 | [0m[35m            **txt_fmt(),[0m
[30;1m681 | [0m[35m        )[0m
[30;1m682 | [0m[35m        self.clusters_widget: widgets.Textarea = widgets.Textarea([0m

[31m--[ [0m[34mMatch #[0m[33m1260[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeseries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m    title: str = kwargs.pop("title", None)[0m
[30;1m141 | [0m[35m    time_column = kwargs.get("x", time_column)[0m
[30;1m142 | [0m[35m    show_range: bool = kwargs.pop("range_tool", True)[0m
[30;1m143 | [0m[35m    color: list = kwargs.get("color", ["navy", "green", "firebrick"])[0m
[30;1m144 | [0m[35m    color = [[0m
[30;1m145 | [0m[35m        col1 or col2[0m
[30;1m146 | [0m[35m        for col1, col2 in zip_longest(color[:3], ["navy", "green", "firebrick"])[0m

[31m--[ [0m[34mMatch #[0m[33m1261[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeseries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m    height: int = kwargs.pop("height", None)[0m
[30;1m139 | [0m[35m    width: int = kwargs.pop("width", 1200)[0m
[30;1m140 | [0m[35m    title: str = kwargs.pop("title", None)[0m
[30;1m141 | [0m[35m    time_column = kwargs.get("x", time_column)[0m
[30;1m142 | [0m[35m    show_range: bool = kwargs.pop("range_tool", True)[0m
[30;1m143 | [0m[35m    color: list = kwargs.get("color", ["navy", "green", "firebrick"])[0m
[30;1m144 | [0m[35m    color = [[0m

[31m--[ [0m[34mMatch #[0m[33m1262[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m258 | [0m[35m        time_column=time_column,[0m
[30;1m259 | [0m[35m    )[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    # if we have a reference timestamp, plot the time as a line[0m
[30;1m262 | [0m[35m    if ref_time is not None:[0m
[30;1m263 | [0m[35m        plot_ref_line(plot, ref_time, ref_label, data[value_column].max())[0m
[30;1m264 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1263[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m        functions. Dataframe must have columns specified in `y`, `time_column`[0m
[30;1m83 | [0m[35m        and `anomalies_column` parameters[0m
[30;1m84 | [0m[35m    value_column : str, optional[0m
[30;1m85 | [0m[35m        Name of column holding numeric values to plot against time series to[0m
[30;1m86 | [0m[35m        determine anomalies[0m
[30;1m87 | [0m[35m        (the default is 'Total')[0m
[30;1m88 | [0m[35m    y : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1264[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m    Parameters[0m
[30;1m79 | [0m[35m    ----------[0m
[30;1m80 | [0m[35m    data : pd.DataFrame[0m
[30;1m81 | [0m[35m        DataFrame as a time series data set retrieved from KQL time series[0m
[30;1m82 | [0m[35m        functions. Dataframe must have columns specified in `y`, `time_column`[0m
[30;1m83 | [0m[35m        and `anomalies_column` parameters[0m
[30;1m84 | [0m[35m    value_column : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1265[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m    Parameters[0m
[30;1m79 | [0m[35m    ----------[0m
[30;1m80 | [0m[35m    data : pd.DataFrame[0m
[30;1m81 | [0m[35m        DataFrame as a time series data set retrieved from KQL time series[0m
[30;1m82 | [0m[35m        functions. Dataframe must have columns specified in `y`, `time_column`[0m
[30;1m83 | [0m[35m        and `anomalies_column` parameters[0m
[30;1m84 | [0m[35m    value_column : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1266[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m    **kwargs,[0m
[30;1m74 | [0m[35m) -> LayoutDOM:[0m
[30;1m75 | [0m[35m    """[0m
[30;1m76 | [0m[35m    Display time series anomalies visualization.[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    Parameters[0m
[30;1m79 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1267[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/msal_auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        """[0m
[30;1m56 | [0m[35m        self.token_cache = None[0m
[30;1m57 | [0m[35m        self.location = kwargs.get("location", "token_cache.bin")[0m
[30;1m58 | [0m[35m        self.auth_type = kwargs.get("auth_type", "interactive")[0m
[30;1m59 | [0m[35m        self.username = username[0m
[30;1m60 | [0m[35m        self.scopes = scopes[0m
[30;1m61 | [0m[35m        self.result = None[0m

[31m--[ [0m[34mMatch #[0m[33m1268[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/msal_auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        """[0m
[30;1m56 | [0m[35m        self.token_cache = None[0m
[30;1m57 | [0m[35m        self.location = kwargs.get("location", "token_cache.bin")[0m
[30;1m58 | [0m[35m        self.auth_type = kwargs.get("auth_type", "interactive")[0m
[30;1m59 | [0m[35m        self.username = username[0m
[30;1m60 | [0m[35m        self.scopes = scopes[0m

[31m--[ [0m[34mMatch #[0m[33m1269[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m            result["Details"] = f"ERROR: unsupported query type {query_type}"[0m
[30;1m222 | [0m[35m            return pd.DataFrame([result])[0m
[30;1m223 | [0m[35m        else:[0m
[30;1m224 | [0m[35m            prop = self._QUERIES.get(f"{result['IocType']}-{query_type}", "ALL")[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m        try:[0m
[30;1m227 | [0m[35m            ptanalyzer.set_context("msticpy", "ti", VERSION, prop)[0m

[31m--[ [0m[34mMatch #[0m[33m1270[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m            "SUSPICIOUS": ResultSeverity.warning,[0m
[30;1m170 | [0m[35m            "UNKNOWN": ResultSeverity.information,[0m
[30;1m171 | [0m[35m            "GOOD": ResultSeverity.information,[0m
[30;1m172 | [0m[35m        }.get(classification, ResultSeverity.information)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m    def lookup_ioc([0m
[30;1m175 | [0m[35m        self: Self,[0m

[31m--[ [0m[34mMatch #[0m[33m1271[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m109 | [0m[35m    _QUERIES["dns-rep"] = _QUERIES["hostname-rep"][0m
[30;1m110 | [0m[35m    _QUERIES["dns-summary"] = _QUERIES["hostname-summary"][0m
[30;1m111 | [0m[35m    _QUERIES["dns-trackers"] = _QUERIES["hostname-trackers"][0m
[30;1m112 | [0m[35m    _QUERIES["dns-whois"] = _QUERIES["hostname-whois"][0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    _PIVOT_ENTITIES: ClassVar[dict[str, dict[str, str]]] = {[0m
[30;1m115 | [0m[35m        "services": {"IpAddress": "Address"},[0m

[31m--[ [0m[34mMatch #[0m[33m1272[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m108 | [0m[35m    _QUERIES["dns-malware"] = _QUERIES["hostname-malware"][0m
[30;1m109 | [0m[35m    _QUERIES["dns-rep"] = _QUERIES["hostname-rep"][0m
[30;1m110 | [0m[35m    _QUERIES["dns-summary"] = _QUERIES["hostname-summary"][0m
[30;1m111 | [0m[35m    _QUERIES["dns-trackers"] = _QUERIES["hostname-trackers"][0m
[30;1m112 | [0m[35m    _QUERIES["dns-whois"] = _QUERIES["hostname-whois"][0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    _PIVOT_ENTITIES: ClassVar[dict[str, dict[str, str]]] = {[0m

[31m--[ [0m[34mMatch #[0m[33m1273[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m107 | [0m[35m    _QUERIES["dns-projects"] = _QUERIES["hostname-projects"][0m
[30;1m108 | [0m[35m    _QUERIES["dns-malware"] = _QUERIES["hostname-malware"][0m
[30;1m109 | [0m[35m    _QUERIES["dns-rep"] = _QUERIES["hostname-rep"][0m
[30;1m110 | [0m[35m    _QUERIES["dns-summary"] = _QUERIES["hostname-summary"][0m
[30;1m111 | [0m[35m    _QUERIES["dns-trackers"] = _QUERIES["hostname-trackers"][0m
[30;1m112 | [0m[35m    _QUERIES["dns-whois"] = _QUERIES["hostname-whois"][0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1274[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m106 | [0m[35m    _QUERIES["dns-passivedns"] = _QUERIES["hostname-passivedns"][0m
[30;1m107 | [0m[35m    _QUERIES["dns-projects"] = _QUERIES["hostname-projects"][0m
[30;1m108 | [0m[35m    _QUERIES["dns-malware"] = _QUERIES["hostname-malware"][0m
[30;1m109 | [0m[35m    _QUERIES["dns-rep"] = _QUERIES["hostname-rep"][0m
[30;1m110 | [0m[35m    _QUERIES["dns-summary"] = _QUERIES["hostname-summary"][0m
[30;1m111 | [0m[35m    _QUERIES["dns-trackers"] = _QUERIES["hostname-trackers"][0m
[30;1m112 | [0m[35m    _QUERIES["dns-whois"] = _QUERIES["hostname-whois"][0m

[31m--[ [0m[34mMatch #[0m[33m1275[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m105 | [0m[35m    _QUERIES["dns-hostpairparents"] = _QUERIES["hostname-hostpairparents"][0m
[30;1m106 | [0m[35m    _QUERIES["dns-passivedns"] = _QUERIES["hostname-passivedns"][0m
[30;1m107 | [0m[35m    _QUERIES["dns-projects"] = _QUERIES["hostname-projects"][0m
[30;1m108 | [0m[35m    _QUERIES["dns-malware"] = _QUERIES["hostname-malware"][0m
[30;1m109 | [0m[35m    _QUERIES["dns-rep"] = _QUERIES["hostname-rep"][0m
[30;1m110 | [0m[35m    _QUERIES["dns-summary"] = _QUERIES["hostname-summary"][0m
[30;1m111 | [0m[35m    _QUERIES["dns-trackers"] = _QUERIES["hostname-trackers"][0m

[31m--[ [0m[34mMatch #[0m[33m1276[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m104 | [0m[35m    _QUERIES["dns-hostpairchildren"] = _QUERIES["hostname-hostpairchildren"][0m
[30;1m105 | [0m[35m    _QUERIES["dns-hostpairparents"] = _QUERIES["hostname-hostpairparents"][0m
[30;1m106 | [0m[35m    _QUERIES["dns-passivedns"] = _QUERIES["hostname-passivedns"][0m
[30;1m107 | [0m[35m    _QUERIES["dns-projects"] = _QUERIES["hostname-projects"][0m
[30;1m108 | [0m[35m    _QUERIES["dns-malware"] = _QUERIES["hostname-malware"][0m
[30;1m109 | [0m[35m    _QUERIES["dns-rep"] = _QUERIES["hostname-rep"][0m
[30;1m110 | [0m[35m    _QUERIES["dns-summary"] = _QUERIES["hostname-summary"][0m

[31m--[ [0m[34mMatch #[0m[33m1277[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m103 | [0m[35m    _QUERIES["dns-cookies"] = _QUERIES["hostname-cookies"][0m
[30;1m104 | [0m[35m    _QUERIES["dns-hostpairchildren"] = _QUERIES["hostname-hostpairchildren"][0m
[30;1m105 | [0m[35m    _QUERIES["dns-hostpairparents"] = _QUERIES["hostname-hostpairparents"][0m
[30;1m106 | [0m[35m    _QUERIES["dns-passivedns"] = _QUERIES["hostname-passivedns"][0m
[30;1m107 | [0m[35m    _QUERIES["dns-projects"] = _QUERIES["hostname-projects"][0m
[30;1m108 | [0m[35m    _QUERIES["dns-malware"] = _QUERIES["hostname-malware"][0m
[30;1m109 | [0m[35m    _QUERIES["dns-rep"] = _QUERIES["hostname-rep"][0m

[31m--[ [0m[34mMatch #[0m[33m1278[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m102 | [0m[35m    _QUERIES["dns-components"] = _QUERIES["hostname-components"][0m
[30;1m103 | [0m[35m    _QUERIES["dns-cookies"] = _QUERIES["hostname-cookies"][0m
[30;1m104 | [0m[35m    _QUERIES["dns-hostpairchildren"] = _QUERIES["hostname-hostpairchildren"][0m
[30;1m105 | [0m[35m    _QUERIES["dns-hostpairparents"] = _QUERIES["hostname-hostpairparents"][0m
[30;1m106 | [0m[35m    _QUERIES["dns-passivedns"] = _QUERIES["hostname-passivedns"][0m
[30;1m107 | [0m[35m    _QUERIES["dns-projects"] = _QUERIES["hostname-projects"][0m
[30;1m108 | [0m[35m    _QUERIES["dns-malware"] = _QUERIES["hostname-malware"][0m

[31m--[ [0m[34mMatch #[0m[33m1279[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m101 | [0m[35m    _QUERIES["dns-certificates"] = _QUERIES["hostname-certificates"][0m
[30;1m102 | [0m[35m    _QUERIES["dns-components"] = _QUERIES["hostname-components"][0m
[30;1m103 | [0m[35m    _QUERIES["dns-cookies"] = _QUERIES["hostname-cookies"][0m
[30;1m104 | [0m[35m    _QUERIES["dns-hostpairchildren"] = _QUERIES["hostname-hostpairchildren"][0m
[30;1m105 | [0m[35m    _QUERIES["dns-hostpairparents"] = _QUERIES["hostname-hostpairparents"][0m
[30;1m106 | [0m[35m    _QUERIES["dns-passivedns"] = _QUERIES["hostname-passivedns"][0m
[30;1m107 | [0m[35m    _QUERIES["dns-projects"] = _QUERIES["hostname-projects"][0m

[31m--[ [0m[34mMatch #[0m[33m1280[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m100 | [0m[35m    _QUERIES["dns-artifacts"] = _QUERIES["hostname-artifacts"][0m
[30;1m101 | [0m[35m    _QUERIES["dns-certificates"] = _QUERIES["hostname-certificates"][0m
[30;1m102 | [0m[35m    _QUERIES["dns-components"] = _QUERIES["hostname-components"][0m
[30;1m103 | [0m[35m    _QUERIES["dns-cookies"] = _QUERIES["hostname-cookies"][0m
[30;1m104 | [0m[35m    _QUERIES["dns-hostpairchildren"] = _QUERIES["hostname-hostpairchildren"][0m
[30;1m105 | [0m[35m    _QUERIES["dns-hostpairparents"] = _QUERIES["hostname-hostpairparents"][0m
[30;1m106 | [0m[35m    _QUERIES["dns-passivedns"] = _QUERIES["hostname-passivedns"][0m

[31m--[ [0m[34mMatch #[0m[33m1281[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m99 | [0m[35m    _QUERIES["dns-articles"] = _QUERIES["hostname-articles"][0m
[30;1m100 | [0m[35m    _QUERIES["dns-artifacts"] = _QUERIES["hostname-artifacts"][0m
[30;1m101 | [0m[35m    _QUERIES["dns-certificates"] = _QUERIES["hostname-certificates"][0m
[30;1m102 | [0m[35m    _QUERIES["dns-components"] = _QUERIES["hostname-components"][0m
[30;1m103 | [0m[35m    _QUERIES["dns-cookies"] = _QUERIES["hostname-cookies"][0m
[30;1m104 | [0m[35m    _QUERIES["dns-hostpairchildren"] = _QUERIES["hostname-hostpairchildren"][0m
[30;1m105 | [0m[35m    _QUERIES["dns-hostpairparents"] = _QUERIES["hostname-hostpairparents"][0m

[31m--[ [0m[34mMatch #[0m[33m1282[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m98 | [0m[35m    _QUERIES["dns"] = _QUERIES["hostname"][0m
[30;1m99 | [0m[35m    _QUERIES["dns-articles"] = _QUERIES["hostname-articles"][0m
[30;1m100 | [0m[35m    _QUERIES["dns-artifacts"] = _QUERIES["hostname-artifacts"][0m
[30;1m101 | [0m[35m    _QUERIES["dns-certificates"] = _QUERIES["hostname-certificates"][0m
[30;1m102 | [0m[35m    _QUERIES["dns-components"] = _QUERIES["hostname-components"][0m
[30;1m103 | [0m[35m    _QUERIES["dns-cookies"] = _QUERIES["hostname-cookies"][0m
[30;1m104 | [0m[35m    _QUERIES["dns-hostpairchildren"] = _QUERIES["hostname-hostpairchildren"][0m

[31m--[ [0m[34mMatch #[0m[33m1283[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m97 | [0m[35m    # Aliases[0m
[30;1m98 | [0m[35m    _QUERIES["dns"] = _QUERIES["hostname"][0m
[30;1m99 | [0m[35m    _QUERIES["dns-articles"] = _QUERIES["hostname-articles"][0m
[30;1m100 | [0m[35m    _QUERIES["dns-artifacts"] = _QUERIES["hostname-artifacts"][0m
[30;1m101 | [0m[35m    _QUERIES["dns-certificates"] = _QUERIES["hostname-certificates"][0m
[30;1m102 | [0m[35m    _QUERIES["dns-components"] = _QUERIES["hostname-components"][0m
[30;1m103 | [0m[35m    _QUERIES["dns-cookies"] = _QUERIES["hostname-cookies"][0m

[31m--[ [0m[34mMatch #[0m[33m1284[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    # Aliases[0m
[30;1m98 | [0m[35m    _QUERIES["dns"] = _QUERIES["hostname"][0m
[30;1m99 | [0m[35m    _QUERIES["dns-articles"] = _QUERIES["hostname-articles"][0m
[30;1m100 | [0m[35m    _QUERIES["dns-artifacts"] = _QUERIES["hostname-artifacts"][0m
[30;1m101 | [0m[35m    _QUERIES["dns-certificates"] = _QUERIES["hostname-certificates"][0m
[30;1m102 | [0m[35m    _QUERIES["dns-components"] = _QUERIES["hostname-components"][0m

[31m--[ [0m[34mMatch #[0m[33m1285[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m95 | [0m[35m    }[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    # Aliases[0m
[30;1m98 | [0m[35m    _QUERIES["dns"] = _QUERIES["hostname"][0m
[30;1m99 | [0m[35m    _QUERIES["dns-articles"] = _QUERIES["hostname-articles"][0m
[30;1m100 | [0m[35m    _QUERIES["dns-artifacts"] = _QUERIES["hostname-artifacts"][0m
[30;1m101 | [0m[35m    _QUERIES["dns-certificates"] = _QUERIES["hostname-certificates"][0m

[31m--[ [0m[34mMatch #[0m[33m1286[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m91 | [0m[35m        "hostname-rep": "reputation",[0m
[30;1m92 | [0m[35m        "hostname-summary": "summary",[0m
[30;1m93 | [0m[35m        "hostname-trackers": "trackers",[0m
[30;1m94 | [0m[35m        "hostname-whois": "whois",[0m
[30;1m95 | [0m[35m    }[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    # Aliases[0m

[31m--[ [0m[34mMatch #[0m[33m1287[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m90 | [0m[35m        "hostname-malware": "malware",[0m
[30;1m91 | [0m[35m        "hostname-rep": "reputation",[0m
[30;1m92 | [0m[35m        "hostname-summary": "summary",[0m
[30;1m93 | [0m[35m        "hostname-trackers": "trackers",[0m
[30;1m94 | [0m[35m        "hostname-whois": "whois",[0m
[30;1m95 | [0m[35m    }[0m
[30;1m96 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1288[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m89 | [0m[35m        "hostname-projects": "projects",[0m
[30;1m90 | [0m[35m        "hostname-malware": "malware",[0m
[30;1m91 | [0m[35m        "hostname-rep": "reputation",[0m
[30;1m92 | [0m[35m        "hostname-summary": "summary",[0m
[30;1m93 | [0m[35m        "hostname-trackers": "trackers",[0m
[30;1m94 | [0m[35m        "hostname-whois": "whois",[0m
[30;1m95 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m1289[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m88 | [0m[35m        "hostname-passivedns": "resolutions",[0m
[30;1m89 | [0m[35m        "hostname-projects": "projects",[0m
[30;1m90 | [0m[35m        "hostname-malware": "malware",[0m
[30;1m91 | [0m[35m        "hostname-rep": "reputation",[0m
[30;1m92 | [0m[35m        "hostname-summary": "summary",[0m
[30;1m93 | [0m[35m        "hostname-trackers": "trackers",[0m
[30;1m94 | [0m[35m        "hostname-whois": "whois",[0m

[31m--[ [0m[34mMatch #[0m[33m1290[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m87 | [0m[35m        "hostname-hostpairparents": "hostpair_parents",[0m
[30;1m88 | [0m[35m        "hostname-passivedns": "resolutions",[0m
[30;1m89 | [0m[35m        "hostname-projects": "projects",[0m
[30;1m90 | [0m[35m        "hostname-malware": "malware",[0m
[30;1m91 | [0m[35m        "hostname-rep": "reputation",[0m
[30;1m92 | [0m[35m        "hostname-summary": "summary",[0m
[30;1m93 | [0m[35m        "hostname-trackers": "trackers",[0m

[31m--[ [0m[34mMatch #[0m[33m1291[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m86 | [0m[35m        "hostname-hostpairchildren": "hostpair_children",[0m
[30;1m87 | [0m[35m        "hostname-hostpairparents": "hostpair_parents",[0m
[30;1m88 | [0m[35m        "hostname-passivedns": "resolutions",[0m
[30;1m89 | [0m[35m        "hostname-projects": "projects",[0m
[30;1m90 | [0m[35m        "hostname-malware": "malware",[0m
[30;1m91 | [0m[35m        "hostname-rep": "reputation",[0m
[30;1m92 | [0m[35m        "hostname-summary": "summary",[0m

[31m--[ [0m[34mMatch #[0m[33m1292[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m85 | [0m[35m        "hostname-cookies": "cookies",[0m
[30;1m86 | [0m[35m        "hostname-hostpairchildren": "hostpair_children",[0m
[30;1m87 | [0m[35m        "hostname-hostpairparents": "hostpair_parents",[0m
[30;1m88 | [0m[35m        "hostname-passivedns": "resolutions",[0m
[30;1m89 | [0m[35m        "hostname-projects": "projects",[0m
[30;1m90 | [0m[35m        "hostname-malware": "malware",[0m
[30;1m91 | [0m[35m        "hostname-rep": "reputation",[0m

[31m--[ [0m[34mMatch #[0m[33m1293[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m84 | [0m[35m        "hostname-components": "components",[0m
[30;1m85 | [0m[35m        "hostname-cookies": "cookies",[0m
[30;1m86 | [0m[35m        "hostname-hostpairchildren": "hostpair_children",[0m
[30;1m87 | [0m[35m        "hostname-hostpairparents": "hostpair_parents",[0m
[30;1m88 | [0m[35m        "hostname-passivedns": "resolutions",[0m
[30;1m89 | [0m[35m        "hostname-projects": "projects",[0m
[30;1m90 | [0m[35m        "hostname-malware": "malware",[0m

[31m--[ [0m[34mMatch #[0m[33m1294[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m83 | [0m[35m        "hostname-certificates": "certificates",[0m
[30;1m84 | [0m[35m        "hostname-components": "components",[0m
[30;1m85 | [0m[35m        "hostname-cookies": "cookies",[0m
[30;1m86 | [0m[35m        "hostname-hostpairchildren": "hostpair_children",[0m
[30;1m87 | [0m[35m        "hostname-hostpairparents": "hostpair_parents",[0m
[30;1m88 | [0m[35m        "hostname-passivedns": "resolutions",[0m
[30;1m89 | [0m[35m        "hostname-projects": "projects",[0m

[31m--[ [0m[34mMatch #[0m[33m1295[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m82 | [0m[35m        "hostname-artifacts": "artifacts",[0m
[30;1m83 | [0m[35m        "hostname-certificates": "certificates",[0m
[30;1m84 | [0m[35m        "hostname-components": "components",[0m
[30;1m85 | [0m[35m        "hostname-cookies": "cookies",[0m
[30;1m86 | [0m[35m        "hostname-hostpairchildren": "hostpair_children",[0m
[30;1m87 | [0m[35m        "hostname-hostpairparents": "hostpair_parents",[0m
[30;1m88 | [0m[35m        "hostname-passivedns": "resolutions",[0m

[31m--[ [0m[34mMatch #[0m[33m1296[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m81 | [0m[35m        "hostname-articles": "articles",[0m
[30;1m82 | [0m[35m        "hostname-artifacts": "artifacts",[0m
[30;1m83 | [0m[35m        "hostname-certificates": "certificates",[0m
[30;1m84 | [0m[35m        "hostname-components": "components",[0m
[30;1m85 | [0m[35m        "hostname-cookies": "cookies",[0m
[30;1m86 | [0m[35m        "hostname-hostpairchildren": "hostpair_children",[0m
[30;1m87 | [0m[35m        "hostname-hostpairparents": "hostpair_parents",[0m

[31m--[ [0m[34mMatch #[0m[33m1297[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m80 | [0m[35m        "hostname": "ALL",[0m
[30;1m81 | [0m[35m        "hostname-articles": "articles",[0m
[30;1m82 | [0m[35m        "hostname-artifacts": "artifacts",[0m
[30;1m83 | [0m[35m        "hostname-certificates": "certificates",[0m
[30;1m84 | [0m[35m        "hostname-components": "components",[0m
[30;1m85 | [0m[35m        "hostname-cookies": "cookies",[0m
[30;1m86 | [0m[35m        "hostname-hostpairchildren": "hostpair_children",[0m

[31m--[ [0m[34mMatch #[0m[33m1298[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m79 | [0m[35m        "ipv4-whois": "whois",[0m
[30;1m80 | [0m[35m        "hostname": "ALL",[0m
[30;1m81 | [0m[35m        "hostname-articles": "articles",[0m
[30;1m82 | [0m[35m        "hostname-artifacts": "artifacts",[0m
[30;1m83 | [0m[35m        "hostname-certificates": "certificates",[0m
[30;1m84 | [0m[35m        "hostname-components": "components",[0m
[30;1m85 | [0m[35m        "hostname-cookies": "cookies",[0m

[31m--[ [0m[34mMatch #[0m[33m1299[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m78 | [0m[35m        "ipv4-trackers": "trackers",[0m
[30;1m79 | [0m[35m        "ipv4-whois": "whois",[0m
[30;1m80 | [0m[35m        "hostname": "ALL",[0m
[30;1m81 | [0m[35m        "hostname-articles": "articles",[0m
[30;1m82 | [0m[35m        "hostname-artifacts": "artifacts",[0m
[30;1m83 | [0m[35m        "hostname-certificates": "certificates",[0m
[30;1m84 | [0m[35m        "hostname-components": "components",[0m

[31m--[ [0m[34mMatch #[0m[33m1300[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m77 | [0m[35m        "ipv4-summary": "summary",[0m
[30;1m78 | [0m[35m        "ipv4-trackers": "trackers",[0m
[30;1m79 | [0m[35m        "ipv4-whois": "whois",[0m
[30;1m80 | [0m[35m        "hostname": "ALL",[0m
[30;1m81 | [0m[35m        "hostname-articles": "articles",[0m
[30;1m82 | [0m[35m        "hostname-artifacts": "artifacts",[0m
[30;1m83 | [0m[35m        "hostname-certificates": "certificates",[0m

[31m--[ [0m[34mMatch #[0m[33m1301[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    if TYPE_CHECKING:[0m
[30;1m35 | [0m[35m        import requests[0m
[30;1m36 | [0m[35m        from passivetotal.analyzer.hostname import Hostname[0m
[30;1m37 | [0m[35m        from passivetotal.analyzer.ip import IPAddress[0m
[30;1m38 | [0m[35m        from passivetotal.analyzer.whois import WhoisRecords[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1302[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/riskiq.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m397 | [0m[35m        self._pivot_timespan_start = None[0m
[30;1m398 | [0m[35m        self._pivot_timespan_end = None[0m
[30;1m399 | [0m[35m        for prop, entity_map in self._PIVOT_ENTITIES.items():[0m
[30;1m400 | [0m[35m            reg = pivot_reg([0m
[30;1m401 | [0m[35m                func_new_name=prop,[0m
[30;1m402 | [0m[35m                func_static_params={"prop": prop},[0m
[30;1m403 | [0m[35m                input_type="value",[0m

[31m--[ [0m[34mMatch #[0m[33m1303[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35m            si_proc.IsBranch = True[0m
[30;1m351 | [0m[35m        else:[0m
[30;1m352 | [0m[35m            si_proc.IsRoot = True[0m
[30;1m353 | [0m[35m        child_procs_raw: list[dict[str, Any]] = process.get("children", [])[0m
[30;1m354 | [0m[35m        if child_procs_raw:[0m
[30;1m355 | [0m[35m            si_proc.children = _extract_processes([0m
[30;1m356 | [0m[35m                child_procs_raw,[0m

[31m--[ [0m[34mMatch #[0m[33m1304[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m        if "attributes" in self._file_behavior:[0m
[30;1m214 | [0m[35m            self.categories = self._file_behavior.get("attributes", {})[0m
[30;1m215 | [0m[35m            self.behavior_links = self._file_behavior.get("links", {})[0m
[30;1m216 | [0m[35m        else:[0m
[30;1m217 | [0m[35m            self.categories = self._file_behavior[0m
[30;1m218 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1305[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m            self._vt_client.close()[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m        if "attributes" in self._file_behavior:[0m
[30;1m214 | [0m[35m            self.categories = self._file_behavior.get("attributes", {})[0m
[30;1m215 | [0m[35m            self.behavior_links = self._file_behavior.get("links", {})[0m
[30;1m216 | [0m[35m        else:[0m
[30;1m217 | [0m[35m            self.categories = self._file_behavior[0m

[31m--[ [0m[34mMatch #[0m[33m1306[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m    @property[0m
[30;1m180 | [0m[35m    def has_pcap(self: Self) -> bool:[0m
[30;1m181 | [0m[35m        """Return True if PCAP data is available (Enterprise only)."""[0m
[30;1m182 | [0m[35m        return self.categories.get("has_pcap", False)[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    def get_file_behavior(self: Self, sandbox: str | None = None) -> None:[0m
[30;1m185 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1307[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m    @property[0m
[30;1m175 | [0m[35m    def has_memdump(self: Self) -> bool:[0m
[30;1m176 | [0m[35m        """Return True if memory dump data is available (Enterprise only)."""[0m
[30;1m177 | [0m[35m        return self.categories.get("has_memdump", False)[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    @property[0m
[30;1m180 | [0m[35m    def has_pcap(self: Self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1308[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m    @property[0m
[30;1m170 | [0m[35m    def has_evtx(self: Self) -> bool:[0m
[30;1m171 | [0m[35m        """Return True if EVTX data is available (Enterprise only)."""[0m
[30;1m172 | [0m[35m        return self.categories.get("has_evtx", False)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m    @property[0m
[30;1m175 | [0m[35m    def has_memdump(self: Self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1309[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m    @property[0m
[30;1m165 | [0m[35m    def sandbox_id(self: Self) -> str:[0m
[30;1m166 | [0m[35m        """Return sandbox ID of detonation."""[0m
[30;1m167 | [0m[35m        return self.categories.get("id", "")[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    @property[0m
[30;1m170 | [0m[35m    def has_evtx(self: Self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1310[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m        self.file_summary: pd.Series | dict[str, pd.Timestamp] | dict[str, Any] = ([0m
[30;1m150 | [0m[35m            file_summary or {}[0m
[30;1m151 | [0m[35m        )[0m
[30;1m152 | [0m[35m        self.file_id: str | Any | None = file_id or self.file_summary.get("id")[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m        self._file_behavior: dict[str, Any] = {}[0m
[30;1m155 | [0m[35m        self.categories: dict[str, Any] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m1311[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m418 | [0m[35m                and Path(row["name"]).stem.lower() in cmd.lower()[0m
[30;1m419 | [0m[35m            ):[0m
[30;1m420 | [0m[35m                weak_matches += 1[0m
[30;1m421 | [0m[35m                procs_cmd.loc[idx, "cmd_line"] = cmd  # type: ignore[0m
[30;1m422 | [0m[35m                break[0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35m    if weak_matches:[0m

[31m--[ [0m[34mMatch #[0m[33m1312[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m410 | [0m[35m            ):[0m
[30;1m411 | [0m[35m                procs_cmd.loc[idx, "cmd_line"] = cmd  # type: ignore[0m
[30;1m412 | [0m[35m                break[0m
[30;1m413 | [0m[35m    for cmd in command_executions:[0m
[30;1m414 | [0m[35m        for idx, row in procs_cmd.iterrows():[0m
[30;1m415 | [0m[35m            if ([0m
[30;1m416 | [0m[35m                not isinstance(row["cmd_line"], str)[0m

[31m--[ [0m[34mMatch #[0m[33m1313[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m408 | [0m[35m                and np.isnan(row["cmd_line"])[0m
[30;1m409 | [0m[35m                and row["name"] in cmd[0m
[30;1m410 | [0m[35m            ):[0m
[30;1m411 | [0m[35m                procs_cmd.loc[idx, "cmd_line"] = cmd  # type: ignore[0m
[30;1m412 | [0m[35m                break[0m
[30;1m413 | [0m[35m    for cmd in command_executions:[0m
[30;1m414 | [0m[35m        for idx, row in procs_cmd.iterrows():[0m

[31m--[ [0m[34mMatch #[0m[33m1314[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m406 | [0m[35m            if ([0m
[30;1m407 | [0m[35m                not isinstance(row["cmd_line"], str)[0m
[30;1m408 | [0m[35m                and np.isnan(row["cmd_line"])[0m
[30;1m409 | [0m[35m                and row["name"] in cmd[0m
[30;1m410 | [0m[35m            ):[0m
[30;1m411 | [0m[35m                procs_cmd.loc[idx, "cmd_line"] = cmd  # type: ignore[0m
[30;1m412 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m1315[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m401 | [0m[35m    procs_cmd["cmd_line"] = np.nan[0m
[30;1m402 | [0m[35m    procs_cmd["cmd_line"] = procs_cmd["cmd_line"].astype(object)  # Set dtype to object[0m
[30;1m403 | [0m[35m    weak_matches = 0[0m
[30;1m404 | [0m[35m    for cmd in command_executions:[0m
[30;1m405 | [0m[35m        for idx, row in procs_cmd.iterrows():[0m
[30;1m406 | [0m[35m            if ([0m
[30;1m407 | [0m[35m                not isinstance(row["cmd_line"], str)[0m

[31m--[ [0m[34mMatch #[0m[33m1316[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtfile_behavior.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m459 | [0m[35m# Process browser helper functions[0m
[30;1m460 | [0m[35mdef _extract_subcats(pattern: str, categs: set[str]) -> set:[0m
[30;1m461 | [0m[35m    """Extract the category names matching `pattern`."""[0m
[30;1m462 | [0m[35m    return {cat for cat in categs if re.match(pattern, cat)}[0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35mdef _format_widget_data(data_item: list[dict[str, Any] | str] | None) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1317[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/proc_tree_build_mde.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m369 | [0m[35m            plot_args[arg_name] = _SENTINEL_MDE_MAP[arg_value][0m
[30;1m370 | [0m[35m        if isinstance(arg_value, list):[0m
[30;1m371 | [0m[35m            plot_args[arg_name] = [[0m
[30;1m372 | [0m[35m                _SENTINEL_MDE_MAP.get(field, field) for field in arg_value[0m
[30;1m373 | [0m[35m            ][0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35m    return data.rename(columns=_SENTINEL_MDE_MAP)[0m

[31m--[ [0m[34mMatch #[0m[33m1318[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/proc_tree_build_mde.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m    proc_id_col : str[0m
[30;1m94 | [0m[35m        Process ID column[0m
[30;1m95 | [0m[35m    timestamp_col : str[0m
[30;1m96 | [0m[35m        Process time stamp column.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    Notes[0m
[30;1m99 | [0m[35m    -----[0m

[31m--[ [0m[34mMatch #[0m[33m1319[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m                    result["last_login_time"],[0m
[30;1m265 | [0m[35m                    "%Y-%m-%d %H:%M:%S",[0m
[30;1m266 | [0m[35m                ).replace(tzinfo=dt.timezone.utc)[0m
[30;1m267 | [0m[35m                if result.get("last_login_time")[0m
[30;1m268 | [0m[35m                else ""[0m
[30;1m269 | [0m[35m            ),[0m
[30;1m270 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m1320[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m                dt.datetime.strptime(result["last_login"], "%Y-%m-%d").replace([0m
[30;1m257 | [0m[35m                    tzinfo=dt.timezone.utc,[0m
[30;1m258 | [0m[35m                )[0m
[30;1m259 | [0m[35m                if result.get("last_login")[0m
[30;1m260 | [0m[35m                else ""[0m
[30;1m261 | [0m[35m            ),[0m
[30;1m262 | [0m[35m            "last_login_time": ([0m

[31m--[ [0m[34mMatch #[0m[33m1321[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m            "preferred_language": result.get("preferred_language", ""),[0m
[30;1m252 | [0m[35m            "title": result.get("title", ""),[0m
[30;1m253 | [0m[35m            "user_name": result.get("user_name", ""),[0m
[30;1m254 | [0m[35m            "vip": result.get("vip", "false"),[0m
[30;1m255 | [0m[35m            "last_login": ([0m
[30;1m256 | [0m[35m                dt.datetime.strptime(result["last_login"], "%Y-%m-%d").replace([0m
[30;1m257 | [0m[35m                    tzinfo=dt.timezone.utc,[0m

[31m--[ [0m[34mMatch #[0m[33m1322[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m            "phone": result.get("phone", "false"),[0m
[30;1m251 | [0m[35m            "preferred_language": result.get("preferred_language", ""),[0m
[30;1m252 | [0m[35m            "title": result.get("title", ""),[0m
[30;1m253 | [0m[35m            "user_name": result.get("user_name", ""),[0m
[30;1m254 | [0m[35m            "vip": result.get("vip", "false"),[0m
[30;1m255 | [0m[35m            "last_login": ([0m
[30;1m256 | [0m[35m                dt.datetime.strptime(result["last_login"], "%Y-%m-%d").replace([0m

[31m--[ [0m[34mMatch #[0m[33m1323[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m            "name": result.get("name", ""),[0m
[30;1m250 | [0m[35m            "phone": result.get("phone", "false"),[0m
[30;1m251 | [0m[35m            "preferred_language": result.get("preferred_language", ""),[0m
[30;1m252 | [0m[35m            "title": result.get("title", ""),[0m
[30;1m253 | [0m[35m            "user_name": result.get("user_name", ""),[0m
[30;1m254 | [0m[35m            "vip": result.get("vip", "false"),[0m
[30;1m255 | [0m[35m            "last_login": ([0m

[31m--[ [0m[34mMatch #[0m[33m1324[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m            "middle_name": result.get("middle_name", ""),[0m
[30;1m249 | [0m[35m            "name": result.get("name", ""),[0m
[30;1m250 | [0m[35m            "phone": result.get("phone", "false"),[0m
[30;1m251 | [0m[35m            "preferred_language": result.get("preferred_language", ""),[0m
[30;1m252 | [0m[35m            "title": result.get("title", ""),[0m
[30;1m253 | [0m[35m            "user_name": result.get("user_name", ""),[0m
[30;1m254 | [0m[35m            "vip": result.get("vip", "false"),[0m

[31m--[ [0m[34mMatch #[0m[33m1325[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m            "manager": result.get("manager", ""),[0m
[30;1m248 | [0m[35m            "middle_name": result.get("middle_name", ""),[0m
[30;1m249 | [0m[35m            "name": result.get("name", ""),[0m
[30;1m250 | [0m[35m            "phone": result.get("phone", "false"),[0m
[30;1m251 | [0m[35m            "preferred_language": result.get("preferred_language", ""),[0m
[30;1m252 | [0m[35m            "title": result.get("title", ""),[0m
[30;1m253 | [0m[35m            "user_name": result.get("user_name", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1326[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m            "last_name": result.get("last_name", ""),[0m
[30;1m247 | [0m[35m            "manager": result.get("manager", ""),[0m
[30;1m248 | [0m[35m            "middle_name": result.get("middle_name", ""),[0m
[30;1m249 | [0m[35m            "name": result.get("name", ""),[0m
[30;1m250 | [0m[35m            "phone": result.get("phone", "false"),[0m
[30;1m251 | [0m[35m            "preferred_language": result.get("preferred_language", ""),[0m
[30;1m252 | [0m[35m            "title": result.get("title", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1327[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m            "introduction": result.get("introduction", ""),[0m
[30;1m246 | [0m[35m            "last_name": result.get("last_name", ""),[0m
[30;1m247 | [0m[35m            "manager": result.get("manager", ""),[0m
[30;1m248 | [0m[35m            "middle_name": result.get("middle_name", ""),[0m
[30;1m249 | [0m[35m            "name": result.get("name", ""),[0m
[30;1m250 | [0m[35m            "phone": result.get("phone", "false"),[0m
[30;1m251 | [0m[35m            "preferred_language": result.get("preferred_language", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1328[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m            "first_name": result.get("first_name", ""),[0m
[30;1m245 | [0m[35m            "introduction": result.get("introduction", ""),[0m
[30;1m246 | [0m[35m            "last_name": result.get("last_name", ""),[0m
[30;1m247 | [0m[35m            "manager": result.get("manager", ""),[0m
[30;1m248 | [0m[35m            "middle_name": result.get("middle_name", ""),[0m
[30;1m249 | [0m[35m            "name": result.get("name", ""),[0m
[30;1m250 | [0m[35m            "phone": result.get("phone", "false"),[0m

[31m--[ [0m[34mMatch #[0m[33m1329[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m            "failed_attempts": result.get("failed_attempts", 0),[0m
[30;1m244 | [0m[35m            "first_name": result.get("first_name", ""),[0m
[30;1m245 | [0m[35m            "introduction": result.get("introduction", ""),[0m
[30;1m246 | [0m[35m            "last_name": result.get("last_name", ""),[0m
[30;1m247 | [0m[35m            "manager": result.get("manager", ""),[0m
[30;1m248 | [0m[35m            "middle_name": result.get("middle_name", ""),[0m
[30;1m249 | [0m[35m            "name": result.get("name", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1330[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m            "email": result.get("email", ""),[0m
[30;1m243 | [0m[35m            "failed_attempts": result.get("failed_attempts", 0),[0m
[30;1m244 | [0m[35m            "first_name": result.get("first_name", ""),[0m
[30;1m245 | [0m[35m            "introduction": result.get("introduction", ""),[0m
[30;1m246 | [0m[35m            "last_name": result.get("last_name", ""),[0m
[30;1m247 | [0m[35m            "manager": result.get("manager", ""),[0m
[30;1m248 | [0m[35m            "middle_name": result.get("middle_name", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1331[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m            "department": result.get("department", ""),[0m
[30;1m242 | [0m[35m            "email": result.get("email", ""),[0m
[30;1m243 | [0m[35m            "failed_attempts": result.get("failed_attempts", 0),[0m
[30;1m244 | [0m[35m            "first_name": result.get("first_name", ""),[0m
[30;1m245 | [0m[35m            "introduction": result.get("introduction", ""),[0m
[30;1m246 | [0m[35m            "last_name": result.get("last_name", ""),[0m
[30;1m247 | [0m[35m            "manager": result.get("manager", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1332[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m            "business_criticality": result.get("business_criticality", ""),[0m
[30;1m241 | [0m[35m            "department": result.get("department", ""),[0m
[30;1m242 | [0m[35m            "email": result.get("email", ""),[0m
[30;1m243 | [0m[35m            "failed_attempts": result.get("failed_attempts", 0),[0m
[30;1m244 | [0m[35m            "first_name": result.get("first_name", ""),[0m
[30;1m245 | [0m[35m            "introduction": result.get("introduction", ""),[0m
[30;1m246 | [0m[35m            "last_name": result.get("last_name", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1333[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m            "active": result.get("active", "false"),[0m
[30;1m240 | [0m[35m            "business_criticality": result.get("business_criticality", ""),[0m
[30;1m241 | [0m[35m            "department": result.get("department", ""),[0m
[30;1m242 | [0m[35m            "email": result.get("email", ""),[0m
[30;1m243 | [0m[35m            "failed_attempts": result.get("failed_attempts", 0),[0m
[30;1m244 | [0m[35m            "first_name": result.get("first_name", ""),[0m
[30;1m245 | [0m[35m            "introduction": result.get("introduction", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1334[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m            "account": result.get("employee_number", ""),[0m
[30;1m239 | [0m[35m            "active": result.get("active", "false"),[0m
[30;1m240 | [0m[35m            "business_criticality": result.get("business_criticality", ""),[0m
[30;1m241 | [0m[35m            "department": result.get("department", ""),[0m
[30;1m242 | [0m[35m            "email": result.get("email", ""),[0m
[30;1m243 | [0m[35m            "failed_attempts": result.get("failed_attempts", 0),[0m
[30;1m244 | [0m[35m            "first_name": result.get("first_name", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1335[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m        return {[0m
[30;1m238 | [0m[35m            "account": result.get("employee_number", ""),[0m
[30;1m239 | [0m[35m            "active": result.get("active", "false"),[0m
[30;1m240 | [0m[35m            "business_criticality": result.get("business_criticality", ""),[0m
[30;1m241 | [0m[35m            "department": result.get("department", ""),[0m
[30;1m242 | [0m[35m            "email": result.get("email", ""),[0m
[30;1m243 | [0m[35m            "failed_attempts": result.get("failed_attempts", 0),[0m

[31m--[ [0m[34mMatch #[0m[33m1336[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        """[0m
[30;1m237 | [0m[35m        return {[0m
[30;1m238 | [0m[35m            "account": result.get("employee_number", ""),[0m
[30;1m239 | [0m[35m            "active": result.get("active", "false"),[0m
[30;1m240 | [0m[35m            "business_criticality": result.get("business_criticality", ""),[0m
[30;1m241 | [0m[35m            "department": result.get("department", ""),[0m
[30;1m242 | [0m[35m            "email": result.get("email", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1337[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        """[0m
[30;1m237 | [0m[35m        return {[0m
[30;1m238 | [0m[35m            "account": result.get("employee_number", ""),[0m
[30;1m239 | [0m[35m            "active": result.get("active", "false"),[0m
[30;1m240 | [0m[35m            "business_criticality": result.get("business_criticality", ""),[0m
[30;1m241 | [0m[35m            "department": result.get("department", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1338[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m                dt.datetime.strptime(result["created_on"], "%Y-%m-%d %H:%M:%S").replace([0m
[30;1m214 | [0m[35m                    tzinfo=dt.timezone.utc,[0m
[30;1m215 | [0m[35m                )[0m
[30;1m216 | [0m[35m                if result.get("created_on")[0m
[30;1m217 | [0m[35m                else ""[0m
[30;1m218 | [0m[35m            ),[0m
[30;1m219 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m1339[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m                    result["install_date"],[0m
[30;1m207 | [0m[35m                    "%Y-%m-%d %H:%M:%S",[0m
[30;1m208 | [0m[35m                ).replace(tzinfo=dt.timezone.utc)[0m
[30;1m209 | [0m[35m                if result.get("install_date")[0m
[30;1m210 | [0m[35m                else ""[0m
[30;1m211 | [0m[35m            ),[0m
[30;1m212 | [0m[35m            "created_on": ([0m

[31m--[ [0m[34mMatch #[0m[33m1340[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m                    result["last_discovered"],[0m
[30;1m199 | [0m[35m                    "%Y-%m-%d %H:%M:%S",[0m
[30;1m200 | [0m[35m                ).replace(tzinfo=dt.timezone.utc)[0m
[30;1m201 | [0m[35m                if result.get("last_discovered")[0m
[30;1m202 | [0m[35m                else ""[0m
[30;1m203 | [0m[35m            ),[0m
[30;1m204 | [0m[35m            "install_date": ([0m

[31m--[ [0m[34mMatch #[0m[33m1341[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m
[30;1m193 | [0m[35m            "subcategory": result.get("subcategory"),[0m
[30;1m194 | [0m[35m            "support_group": result.get("support_group"),[0m
[30;1m195 | [0m[35m            "sys_class_name": result.get("sys_class_name", ""),[0m
[30;1m196 | [0m[35m            "last_discovered": ([0m
[30;1m197 | [0m[35m                dt.datetime.strptime([0m
[30;1m198 | [0m[35m                    result["last_discovered"],[0m

[31m--[ [0m[34mMatch #[0m[33m1342[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m
[30;1m193 | [0m[35m            "subcategory": result.get("subcategory"),[0m
[30;1m194 | [0m[35m            "support_group": result.get("support_group"),[0m
[30;1m195 | [0m[35m            "sys_class_name": result.get("sys_class_name", ""),[0m
[30;1m196 | [0m[35m            "last_discovered": ([0m
[30;1m197 | [0m[35m                dt.datetime.strptime([0m

[31m--[ [0m[34mMatch #[0m[33m1343[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m
[30;1m193 | [0m[35m            "subcategory": result.get("subcategory"),[0m
[30;1m194 | [0m[35m            "support_group": result.get("support_group"),[0m
[30;1m195 | [0m[35m            "sys_class_name": result.get("sys_class_name", ""),[0m
[30;1m196 | [0m[35m            "last_discovered": ([0m

[31m--[ [0m[34mMatch #[0m[33m1344[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m
[30;1m193 | [0m[35m            "subcategory": result.get("subcategory"),[0m
[30;1m194 | [0m[35m            "support_group": result.get("support_group"),[0m
[30;1m195 | [0m[35m            "sys_class_name": result.get("sys_class_name", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1345[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m
[30;1m193 | [0m[35m            "subcategory": result.get("subcategory"),[0m
[30;1m194 | [0m[35m            "support_group": result.get("support_group"),[0m

[31m--[ [0m[34mMatch #[0m[33m1346[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m
[30;1m193 | [0m[35m            "subcategory": result.get("subcategory"),[0m

[31m--[ [0m[34mMatch #[0m[33m1347[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m            "category": result.get("category"),[0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m

[31m--[ [0m[34mMatch #[0m[33m1348[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m            "busines_criticality": result.get("busines_criticality", ""),[0m
[30;1m186 | [0m[35m            "category": result.get("category"),[0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m

[31m--[ [0m[34mMatch #[0m[33m1349[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m            "assignment_group": result.get("assignment_group"),[0m
[30;1m185 | [0m[35m            "busines_criticality": result.get("busines_criticality", ""),[0m
[30;1m186 | [0m[35m            "category": result.get("category"),[0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1350[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m        return {[0m
[30;1m184 | [0m[35m            "assignment_group": result.get("assignment_group"),[0m
[30;1m185 | [0m[35m            "busines_criticality": result.get("busines_criticality", ""),[0m
[30;1m186 | [0m[35m            "category": result.get("category"),[0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m

[31m--[ [0m[34mMatch #[0m[33m1351[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        return {[0m
[30;1m184 | [0m[35m            "assignment_group": result.get("assignment_group"),[0m
[30;1m185 | [0m[35m            "busines_criticality": result.get("busines_criticality", ""),[0m
[30;1m186 | [0m[35m            "category": result.get("category"),[0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m

[31m--[ [0m[34mMatch #[0m[33m1352[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        return {[0m
[30;1m184 | [0m[35m            "assignment_group": result.get("assignment_group"),[0m
[30;1m185 | [0m[35m            "busines_criticality": result.get("busines_criticality", ""),[0m
[30;1m186 | [0m[35m            "category": result.get("category"),[0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m

[31m--[ [0m[34mMatch #[0m[33m1353[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m                        result["sys_created_on"],[0m
[30;1m153 | [0m[35m                        "%Y-%m-%d %H:%M:%S",[0m
[30;1m154 | [0m[35m                    ).replace(tzinfo=dt.timezone.utc)[0m
[30;1m155 | [0m[35m                    if result.get("sys_created_on")[0m
[30;1m156 | [0m[35m                    else ""[0m
[30;1m157 | [0m[35m                ),[0m
[30;1m158 | [0m[35m                **([0m

[31m--[ [0m[34mMatch #[0m[33m1354[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m                        result["sys_updated_on"],[0m
[30;1m145 | [0m[35m                        "%Y-%m-%d %H:%M:%S",[0m
[30;1m146 | [0m[35m                    ).replace(tzinfo=dt.timezone.utc)[0m
[30;1m147 | [0m[35m                    if result.get("sys_updated_on")[0m
[30;1m148 | [0m[35m                    else ""[0m
[30;1m149 | [0m[35m                ),[0m
[30;1m150 | [0m[35m                "sys_created_on": ([0m

[31m--[ [0m[34mMatch #[0m[33m1355[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m                "sys_id": result.get("sys_id", ""),[0m
[30;1m139 | [0m[35m                "sys_tags": result.get("sys_tags", ""),[0m
[30;1m140 | [0m[35m                "company": result.get("company", None),[0m
[30;1m141 | [0m[35m                "location": result.get("location", ""),[0m
[30;1m142 | [0m[35m                "sys_updated_on": ([0m
[30;1m143 | [0m[35m                    dt.datetime.strptime([0m
[30;1m144 | [0m[35m                        result["sys_updated_on"],[0m

[31m--[ [0m[34mMatch #[0m[33m1356[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m                "sys_class_name": result.get("sys_class_name", ""),[0m
[30;1m138 | [0m[35m                "sys_id": result.get("sys_id", ""),[0m
[30;1m139 | [0m[35m                "sys_tags": result.get("sys_tags", ""),[0m
[30;1m140 | [0m[35m                "company": result.get("company", None),[0m
[30;1m141 | [0m[35m                "location": result.get("location", ""),[0m
[30;1m142 | [0m[35m                "sys_updated_on": ([0m
[30;1m143 | [0m[35m                    dt.datetime.strptime([0m

[31m--[ [0m[34mMatch #[0m[33m1357[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                "permalink": f"{response['Reference']}/{result.get('sys_id')}",[0m
[30;1m137 | [0m[35m                "sys_class_name": result.get("sys_class_name", ""),[0m
[30;1m138 | [0m[35m                "sys_id": result.get("sys_id", ""),[0m
[30;1m139 | [0m[35m                "sys_tags": result.get("sys_tags", ""),[0m
[30;1m140 | [0m[35m                "company": result.get("company", None),[0m
[30;1m141 | [0m[35m                "location": result.get("location", ""),[0m
[30;1m142 | [0m[35m                "sys_updated_on": ([0m

[31m--[ [0m[34mMatch #[0m[33m1358[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m            {[0m
[30;1m136 | [0m[35m                "permalink": f"{response['Reference']}/{result.get('sys_id')}",[0m
[30;1m137 | [0m[35m                "sys_class_name": result.get("sys_class_name", ""),[0m
[30;1m138 | [0m[35m                "sys_id": result.get("sys_id", ""),[0m
[30;1m139 | [0m[35m                "sys_tags": result.get("sys_tags", ""),[0m
[30;1m140 | [0m[35m                "company": result.get("company", None),[0m
[30;1m141 | [0m[35m                "location": result.get("location", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1359[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m        result_dict: list[dict[str, Any]] = [[0m
[30;1m135 | [0m[35m            {[0m
[30;1m136 | [0m[35m                "permalink": f"{response['Reference']}/{result.get('sys_id')}",[0m
[30;1m137 | [0m[35m                "sys_class_name": result.get("sys_class_name", ""),[0m
[30;1m138 | [0m[35m                "sys_id": result.get("sys_id", ""),[0m
[30;1m139 | [0m[35m                "sys_tags": result.get("sys_tags", ""),[0m
[30;1m140 | [0m[35m                "company": result.get("company", None),[0m

[31m--[ [0m[34mMatch #[0m[33m1360[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        result_dict: list[dict[str, Any]] = [[0m
[30;1m135 | [0m[35m            {[0m
[30;1m136 | [0m[35m                "permalink": f"{response['Reference']}/{result.get('sys_id')}",[0m
[30;1m137 | [0m[35m                "sys_class_name": result.get("sys_class_name", ""),[0m
[30;1m138 | [0m[35m                "sys_id": result.get("sys_id", ""),[0m
[30;1m139 | [0m[35m                "sys_tags": result.get("sys_tags", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1361[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m                result[0m
[30;1m125 | [0m[35m                for result in response["RawResult"]["result"][0m
[30;1m126 | [0m[35m                if response["Observable"][0m
[30;1m127 | [0m[35m                in (result.get("ip_address", "").replace(" ", "").split(","))[0m
[30;1m128 | [0m[35m            ][0m
[30;1m129 | [0m[35m            if not response["RawResult"]["result"]:[0m
[30;1m130 | [0m[35m                return False, "Not found."[0m

[31m--[ [0m[34mMatch #[0m[33m1362[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m        """[0m
[30;1m113 | [0m[35m        if self._failed_response(response) or not isinstance([0m
[30;1m114 | [0m[35m            response.get("RawResult", {}),[0m
[30;1m115 | [0m[35m            dict,[0m
[30;1m116 | [0m[35m        ):[0m
[30;1m117 | [0m[35m            return False, "Not found."[0m

[31m--[ [0m[34mMatch #[0m[33m1363[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m.hostname[0m
[30;1m272 | [0m[35m    # Define aliases[0m
[30;1m273 | [0m[35m    _parse_result_ipv6 = _parse_result_ipv4[0m
[30;1m274 | [0m[35m    _parse_result_dns = _parse_result_ipv4[0m
[30;1m275 | [0m[35m    _parse_result_hostname = _parse_result_ipv4[0m
[30;1m276 | [0m[35m    _parse_result_email = _parse_result_user[0m

[31m--[ [0m[34mMatch #[0m[33m1364[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m.hostname[0m
[30;1m186 | [0m[35m            "category": result.get("category"),[0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m

[31m--[ [0m[34mMatch #[0m[33m1365[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m.hostname[0m
[30;1m186 | [0m[35m            "category": result.get("category"),[0m
[30;1m187 | [0m[35m            "comments": result.get("comments"),[0m
[30;1m188 | [0m[35m            "fqdn": result.get("fqdn"),[0m
[30;1m189 | [0m[35m            "hostname": result.get("hostname"),[0m
[30;1m190 | [0m[35m            "install_status": result.get("install_status", ""),[0m
[30;1m191 | [0m[35m            "internet_facing": result.get("internet_facing", False),[0m
[30;1m192 | [0m[35m            "ip_address": result.get("ip_address", "").split(","),[0m

[31m--[ [0m[34mMatch #[0m[33m1366[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m.hostname[0m
[30;1m75 | [0m[35m            },[0m
[30;1m76 | [0m[35m            headers=_DEF_HEADERS,[0m
[30;1m77 | [0m[35m        ),[0m
[30;1m78 | [0m[35m        "hostname": _ServiceNowParams([0m
[30;1m79 | [0m[35m            path="/cmdb_ci_computer",[0m
[30;1m80 | [0m[35m            params={**_SERVICE_NOW_PARAMS, "sysparm_query": "nameLIKE{observable}"},[0m
[30;1m81 | [0m[35m            headers=_DEF_HEADERS,[0m

[31m--[ [0m[34mMatch #[0m[33m1367[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m        Parameters[0m
[30;1m226 | [0m[35m        ----------[0m
[30;1m227 | [0m[35m        result : dict[str, Any][0m
[30;1m228 | [0m[35m            Entry returned by Service Now[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        Returns[0m
[30;1m231 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1368[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m    def _parse_result_user(self: Self, result: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m222 | [0m[35m        """[0m
[30;1m223 | [0m[35m        Return a dictionary of relevant fields for a "Computer" Service Now object.[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m        Parameters[0m
[30;1m226 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1369[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m        Parameters[0m
[30;1m172 | [0m[35m        ----------[0m
[30;1m173 | [0m[35m        result : dict[str, Any][0m
[30;1m174 | [0m[35m            Entry returned by Service Now[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m        Returns[0m
[30;1m177 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1370[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    def _parse_result_ipv4(self: Self, result: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m168 | [0m[35m        """[0m
[30;1m169 | [0m[35m        Return a dictionary of relevant fields for a "Computer" Service Now object.[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        Parameters[0m
[30;1m172 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1371[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        if response["ObservableType"] in ["ipv4", "ipv6"]:[0m
[30;1m120 | [0m[35m            # As Service Now IP field is a CSV-like string and not a list[0m
[30;1m121 | [0m[35m            # the IP returned might not be an exact match.[0m
[30;1m122 | [0m[35m            # Therefore, we must validate before returning it[0m
[30;1m123 | [0m[35m            response["RawResult"]["result"] = [[0m
[30;1m124 | [0m[35m                result[0m

[31m--[ [0m[34mMatch #[0m[33m1372[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m            return False, "Not found."[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        if response["ObservableType"] in ["ipv4", "ipv6"]:[0m
[30;1m120 | [0m[35m            # As Service Now IP field is a CSV-like string and not a list[0m
[30;1m121 | [0m[35m            # the IP returned might not be an exact match.[0m
[30;1m122 | [0m[35m            # Therefore, we must validate before returning it[0m
[30;1m123 | [0m[35m            response["RawResult"]["result"] = [[0m

[31m--[ [0m[34mMatch #[0m[33m1373[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m            return False, "Not found."[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        if response["ObservableType"] in ["ipv4", "ipv6"]:[0m
[30;1m120 | [0m[35m            # As Service Now IP field is a CSV-like string and not a list[0m
[30;1m121 | [0m[35m            # the IP returned might not be an exact match.[0m
[30;1m122 | [0m[35m            # Therefore, we must validate before returning it[0m
[30;1m123 | [0m[35m            response["RawResult"]["result"] = [[0m

[31m--[ [0m[34mMatch #[0m[33m1374[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/servicenow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m# Licensed under the MIT License. See License.txt in the project root for[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35mService Now Provider.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mInput can be a single IoC observable or a pandas DataFrame containing[0m
[30;1m10 | [0m[35mmultiple observables. Processing may require a an API key and[0m

[31m--[ [0m[34mMatch #[0m[33m1375[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/obfuscation_cols.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m  MailboxOwnerMasterAccountSid: '-'[0m
[30;1m52 | [0m[35m  MailboxOwnerSid: '-'[0m
[30;1m53 | [0m[35m  MailboxOwnerUPN: acct[0m
[30;1m54 | [0m[35m  ModifiedObjectResolvedName: ip[0m
[30;1m55 | [0m[35m  OfficeObjectId: '/:. '[0m
[30;1m56 | [0m[35m  OfficeTenantId: uuid[0m
[30;1m57 | [0m[35m  OfficeTenantId_: uuid[0m

[31m--[ [0m[34mMatch #[0m[33m1376[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/obfuscation_cols.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m  Folder: str[0m
[30;1m45 | [0m[35m  LogonUserDisplayName: ' '[0m
[30;1m46 | [0m[35m  LogonUserSid: '-'[0m
[30;1m47 | [0m[35m  Logon_Type: ip[0m
[30;1m48 | [0m[35m  MachineDomainInfo: str[0m
[30;1m49 | [0m[35m  MachineId: str[0m
[30;1m50 | [0m[35m  MailboxGuid: uuid[0m

[31m--[ [0m[34mMatch #[0m[33m1377[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/obfuscation_cols.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m  ClientIP_: ip[0m
[30;1m36 | [0m[35m  ClientInfoString: str[0m
[30;1m37 | [0m[35m  ClientMachineName: '@./:.'[0m
[30;1m38 | [0m[35m  Client_IPAddress: ip[0m
[30;1m39 | [0m[35m  DestMailboxId: str[0m
[30;1m40 | [0m[35m  DestMailboxOwnerUPN: acct[0m
[30;1m41 | [0m[35m  DestinationFileName: '@./:.'[0m

[31m--[ [0m[34mMatch #[0m[33m1378[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/obfuscation_cols.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35mO365:[0m
[30;1m33 | [0m[35m  AADGroupId: str[0m
[30;1m34 | [0m[35m  ClientIP: ip[0m
[30;1m35 | [0m[35m  ClientIP_: ip[0m
[30;1m36 | [0m[35m  ClientInfoString: str[0m
[30;1m37 | [0m[35m  ClientMachineName: '@./:.'[0m
[30;1m38 | [0m[35m  Client_IPAddress: ip[0m

[31m--[ [0m[34mMatch #[0m[33m1379[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/obfuscation_cols.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m  ResourceIdentity: str[0m
[30;1m32 | [0m[35mO365:[0m
[30;1m33 | [0m[35m  AADGroupId: str[0m
[30;1m34 | [0m[35m  ClientIP: ip[0m
[30;1m35 | [0m[35m  ClientIP_: ip[0m
[30;1m36 | [0m[35m  ClientInfoString: str[0m
[30;1m37 | [0m[35m  ClientMachineName: '@./:.'[0m

[31m--[ [0m[34mMatch #[0m[33m1380[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/obfuscation_cols.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mAAD:[0m
[30;1m24 | [0m[35m  AlternateSignInName: '@./:'[0m
[30;1m25 | [0m[35m  ConditionalAccessPolicies: list[0m
[30;1m26 | [0m[35m  IPAddress: ip[0m
[30;1m27 | [0m[35m  Id: uuid[0m
[30;1m28 | [0m[35m  Identity: str[0m
[30;1m29 | [0m[35m  ResourceDisplayName: str[0m

[31m--[ [0m[34mMatch #[0m[33m1381[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/obfuscation_cols.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m  Computer: '@./:.'[0m
[30;1m5 | [0m[35m  DeviceDetail: dict[0m
[30;1m6 | [0m[35m  Host: '@./:.'[0m
[30;1m7 | [0m[35m  IpAddress: ip[0m
[30;1m8 | [0m[35m  Location: str[0m
[30;1m9 | [0m[35m  LocationDetails: dict[0m
[30;1m10 | [0m[35m  ResourceId: '@./:'[0m

[31m--[ [0m[34mMatch #[0m[33m1382[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_asset_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        type: str[0m
[30;1m51 | [0m[35m  search_asset_relative_with_prismafindings:[0m
[30;1m52 | [0m[35m    description: |-[0m
[30;1m53 | [0m[35m      Retrieve asset data from Prisma Cloud using relative time using dynamic queries.[0m
[30;1m54 | [0m[35m      final_query_df = prismacloud_qp.Prismacloud.search_asset_relative_with_prismafindings(selectas[0m
[30;1m55 | [0m[35m    metadata:[0m
[30;1m56 | [0m[35m    args:[0m

[31m--[ [0m[34mMatch #[0m[33m1383[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_asset_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35msources:[0m
[30;1m34 | [0m[35m  search_asset_relative:[0m
[30;1m35 | [0m[35m    description: |-[0m
[30;1m36 | [0m[35m      Retrieve asset data from Prisma Cloud using relative time using dynamic queries.[0m
[30;1m37 | [0m[35m      final_query_df = prismacloud_qp.Prismacloud.search_asset_relative(query_condition="asset where[0m
[30;1m38 | [0m[35m      final_query_df = prismacloud_qp.Prismacloud.search_asset_relative_with_prismafindings(selectas[0m
[30;1m39 | [0m[35m    metadata:[0m

[31m--[ [0m[34mMatch #[0m[33m1384[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_asset_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m      type: str[0m
[30;1m28 | [0m[35m      default: minute[0m
[30;1m29 | [0m[35m    amount_value:[0m
[30;1m30 | [0m[35m      description: Field to use for time[0m
[30;1m31 | [0m[35m      type: int[0m
[30;1m32 | [0m[35m      default: 1440[0m
[30;1m33 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m1385[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_asset_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m    data_source: "Prismacloud"[0m
[30;1m24 | [0m[35m  parameters:[0m
[30;1m25 | [0m[35m    unit_type:[0m
[30;1m26 | [0m[35m      description: Field to use for time[0m
[30;1m27 | [0m[35m      type: str[0m
[30;1m28 | [0m[35m      default: minute[0m
[30;1m29 | [0m[35m    amount_value:[0m

[31m--[ [0m[34mMatch #[0m[33m1386[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_event_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m        description: enter query[0m
[30;1m67 | [0m[35m        type: str[0m
[30;1m68 | [0m[35m  search_event_absolute:[0m
[30;1m69 | [0m[35m    description: Retrieve event data from Prisma Cloud using relative time using dynamic queries.[0m
[30;1m70 | [0m[35m    metadata:[0m
[30;1m71 | [0m[35m    args:[0m
[30;1m72 | [0m[35m      query: *event_query_absolute[0m

[31m--[ [0m[34mMatch #[0m[33m1387[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_event_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m      default: 0[0m
[30;1m53 | [0m[35msources:[0m
[30;1m54 | [0m[35m  search_event_relative:[0m
[30;1m55 | [0m[35m    description: Retrieve event data from Prisma Cloud using relative time using dynamic queries.[0m
[30;1m56 | [0m[35m    metadata:[0m
[30;1m57 | [0m[35m    args:[0m
[30;1m58 | [0m[35m      query: *event_query_relative[0m

[31m--[ [0m[34mMatch #[0m[33m1388[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_event_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m      type: datetime[0m
[30;1m48 | [0m[35m      default: -7[0m
[30;1m49 | [0m[35m    end:[0m
[30;1m50 | [0m[35m      description: Query end time[0m
[30;1m51 | [0m[35m      type: datetime[0m
[30;1m52 | [0m[35m      default: 0[0m
[30;1m53 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m1389[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_event_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m      type: int[0m
[30;1m44 | [0m[35m      default: 60[0m
[30;1m45 | [0m[35m    start:[0m
[30;1m46 | [0m[35m      description: Query start time[0m
[30;1m47 | [0m[35m      type: datetime[0m
[30;1m48 | [0m[35m      default: -7[0m
[30;1m49 | [0m[35m    end:[0m

[31m--[ [0m[34mMatch #[0m[33m1390[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_event_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m      type: str[0m
[30;1m40 | [0m[35m      default: minute[0m
[30;1m41 | [0m[35m    amount_value:[0m
[30;1m42 | [0m[35m      description: Field to use for time[0m
[30;1m43 | [0m[35m      type: int[0m
[30;1m44 | [0m[35m      default: 60[0m
[30;1m45 | [0m[35m    start:[0m

[31m--[ [0m[34mMatch #[0m[33m1391[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/prismacloud/rql_event_search.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    data_source: "Prismacloud"[0m
[30;1m36 | [0m[35m  parameters:[0m
[30;1m37 | [0m[35m    unit_type:[0m
[30;1m38 | [0m[35m      description: Field to use for time[0m
[30;1m39 | [0m[35m      type: str[0m
[30;1m40 | [0m[35m      default: minute[0m
[30;1m41 | [0m[35m    amount_value:[0m

[31m--[ [0m[34mMatch #[0m[33m1392[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m    if prov_settings is None:[0m
[30;1m566 | [0m[35m        logger.warning("No provider settings to test Key Vault connection.")[0m
[30;1m567 | [0m[35m        return False[0m
[30;1m568 | [0m[35m    value = prov_settings.args.get("AuthKey")[0m
[30;1m569 | [0m[35m    return value is not None[0m
[30;1m570 | [0m[35m[0m
[30;1m571 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1393[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m544 | [0m[35m        )[0m
[30;1m545 | [0m[35m        logger.info("Added Azure configuration to config.")[0m
[30;1m546 | [0m[35m    else:[0m
[30;1m547 | [0m[35m        curr_methods = az_settings.get("auth_methods", [])[0m
[30;1m548 | [0m[35m        if auth_method in curr_methods:[0m
[30;1m549 | [0m[35m            curr_methods.remove(auth_method)[0m
[30;1m550 | [0m[35m        az_settings["auth_methods"] = [auth_method, *curr_methods][0m

[31m--[ [0m[34mMatch #[0m[33m1394[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m484 | [0m[35m        headers=req_headers,[0m
[30;1m485 | [0m[35m        timeout=get_http_timeout(),[0m
[30;1m486 | [0m[35m    )[0m
[30;1m487 | [0m[35m    return resp.json().get("value")[0m
[30;1m488 | [0m[35m[0m
[30;1m489 | [0m[35m[0m
[30;1m490 | [0m[35mdef _set_azure_env_creds(mp_spark: MPSparkUtils, tenant_id: Optional[str] = None):[0m

[31m--[ [0m[34mMatch #[0m[33m1395[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m479 | [0m[35m    token = mssparkutils.credentials.getToken("Synapse")[0m
[30;1m480 | [0m[35m    req_headers = {"Authorization": f"Bearer {token}", **mp_ua_header()}[0m
[30;1m481 | [0m[35m[0m
[30;1m482 | [0m[35m    resp = httpx.get([0m
[30;1m483 | [0m[35m        _LINKED_SERVICES_URL.format(ws_name=ws_name, synapse_endpoint=synapse_endpoint),[0m
[30;1m484 | [0m[35m        headers=req_headers,[0m
[30;1m485 | [0m[35m        timeout=get_http_timeout(),[0m

[31m--[ [0m[34mMatch #[0m[33m1396[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35mdef _fetch_linked_services(ws_name: str):[0m
[30;1m476 | [0m[35m    """Fetch list of linked services via Azure Synapse API."""[0m
[30;1m477 | [0m[35m    az_cloud_config = AzureCloudConfig()[0m
[30;1m478 | [0m[35m    synapse_endpoint = az_cloud_config.suffixes.get("synapseAnalytics")[0m
[30;1m479 | [0m[35m    token = mssparkutils.credentials.getToken("Synapse")[0m
[30;1m480 | [0m[35m    req_headers = {"Authorization": f"Bearer {token}", **mp_ua_header()}[0m
[30;1m481 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1397[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m462 | [0m[35m        self.application_id = decoded_token["appid"][0m
[30;1m463 | [0m[35m        self.tenant_id = decoded_token["tid"][0m
[30;1m464 | [0m[35m        self.object_id = decoded_token["oid"][0m
[30;1m465 | [0m[35m        self.resource_id = decoded_token.get("xms_mirid")[0m
[30;1m466 | [0m[35m        logger.info([0m
[30;1m467 | [0m[35m            "Workspace IDs retrieved: app_id: %s, tenant_id: %s, obj_id: %s, res_id: %s",[0m
[30;1m468 | [0m[35m            self.application_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1398[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        """Return Azure resource name."""[0m
[30;1m264 | [0m[35m        url = self.properties.get(self._TYPE_PROPS, {}).get("url")[0m
[30;1m265 | [0m[35m        if not url:[0m
[30;1m266 | [0m[35m            url = self.properties.get(self._TYPE_PROPS, {}).get("baseUrl")[0m
[30;1m267 | [0m[35m        if not url:[0m
[30;1m268 | [0m[35m            return None[0m
[30;1m269 | [0m[35m        az_name = re.search(_AZ_NAME_PATTERN, url)[0m

[31m--[ [0m[34mMatch #[0m[33m1399[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        """Return Azure resource name."""[0m
[30;1m264 | [0m[35m        url = self.properties.get(self._TYPE_PROPS, {}).get("url")[0m
[30;1m265 | [0m[35m        if not url:[0m
[30;1m266 | [0m[35m            url = self.properties.get(self._TYPE_PROPS, {}).get("baseUrl")[0m
[30;1m267 | [0m[35m        if not url:[0m
[30;1m268 | [0m[35m            return None[0m
[30;1m269 | [0m[35m        az_name = re.search(_AZ_NAME_PATTERN, url)[0m

[31m--[ [0m[34mMatch #[0m[33m1400[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m    @property[0m
[30;1m262 | [0m[35m    def azure_name(self):[0m
[30;1m263 | [0m[35m        """Return Azure resource name."""[0m
[30;1m264 | [0m[35m        url = self.properties.get(self._TYPE_PROPS, {}).get("url")[0m
[30;1m265 | [0m[35m        if not url:[0m
[30;1m266 | [0m[35m            url = self.properties.get(self._TYPE_PROPS, {}).get("baseUrl")[0m
[30;1m267 | [0m[35m        if not url:[0m

[31m--[ [0m[34mMatch #[0m[33m1401[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m    @property[0m
[30;1m262 | [0m[35m    def azure_name(self):[0m
[30;1m263 | [0m[35m        """Return Azure resource name."""[0m
[30;1m264 | [0m[35m        url = self.properties.get(self._TYPE_PROPS, {}).get("url")[0m
[30;1m265 | [0m[35m        if not url:[0m
[30;1m266 | [0m[35m            url = self.properties.get(self._TYPE_PROPS, {}).get("baseUrl")[0m
[30;1m267 | [0m[35m        if not url:[0m

[31m--[ [0m[34mMatch #[0m[33m1402[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m        if name in self.properties:[0m
[30;1m252 | [0m[35m            return self.properties[name][0m
[30;1m253 | [0m[35m        if name in self.properties.get(self._TYPE_PROPS, {}):[0m
[30;1m254 | [0m[35m            return self.properties.get(self._TYPE_PROPS, {})[name]  # type: ignore[0m
[30;1m255 | [0m[35m        raise AttributeError(f"Unknown attribute {name}")[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m    def __repr__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1403[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m        """Return sub property `name` from properties or typeProperties."""[0m
[30;1m251 | [0m[35m        if name in self.properties:[0m
[30;1m252 | [0m[35m            return self.properties[name][0m
[30;1m253 | [0m[35m        if name in self.properties.get(self._TYPE_PROPS, {}):[0m
[30;1m254 | [0m[35m            return self.properties.get(self._TYPE_PROPS, {})[name]  # type: ignore[0m
[30;1m255 | [0m[35m        raise AttributeError(f"Unknown attribute {name}")[0m
[30;1m256 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1404[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m    @property[0m
[30;1m245 | [0m[35m    def svc_type(self) -> str:[0m
[30;1m246 | [0m[35m        """Return type of linked service."""[0m
[30;1m247 | [0m[35m        return self.properties.get("type")  # type: ignore[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    def __getattr__(self, name: str):[0m
[30;1m250 | [0m[35m        """Return sub property `name` from properties or typeProperties."""[0m

[31m--[ [0m[34mMatch #[0m[33m1405[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m        self.entry_type: str = kwargs.get("type")[0m
[30;1m239 | [0m[35m        self.etag: str = kwargs.get("etag")[0m
[30;1m240 | [0m[35m        self.properties: Dict[str, Union[str, Dict[str, Union[Dict, str]]]] = ([0m
[30;1m241 | [0m[35m            kwargs.get("properties", {})[0m
[30;1m242 | [0m[35m        )[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1406[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        self.res_id: str = kwargs.get("id")[0m
[30;1m237 | [0m[35m        self.name: str = kwargs.get("name")[0m
[30;1m238 | [0m[35m        self.entry_type: str = kwargs.get("type")[0m
[30;1m239 | [0m[35m        self.etag: str = kwargs.get("etag")[0m
[30;1m240 | [0m[35m        self.properties: Dict[str, Union[str, Dict[str, Union[Dict, str]]]] = ([0m
[30;1m241 | [0m[35m            kwargs.get("properties", {})[0m
[30;1m242 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1407[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m        """Initialize Linked Service instance."""[0m
[30;1m236 | [0m[35m        self.res_id: str = kwargs.get("id")[0m
[30;1m237 | [0m[35m        self.name: str = kwargs.get("name")[0m
[30;1m238 | [0m[35m        self.entry_type: str = kwargs.get("type")[0m
[30;1m239 | [0m[35m        self.etag: str = kwargs.get("etag")[0m
[30;1m240 | [0m[35m        self.properties: Dict[str, Union[str, Dict[str, Union[Dict, str]]]] = ([0m
[30;1m241 | [0m[35m            kwargs.get("properties", {})[0m

[31m--[ [0m[34mMatch #[0m[33m1408[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m235 | [0m[35m        """Initialize Linked Service instance."""[0m
[30;1m236 | [0m[35m        self.res_id: str = kwargs.get("id")[0m
[30;1m237 | [0m[35m        self.name: str = kwargs.get("name")[0m
[30;1m238 | [0m[35m        self.entry_type: str = kwargs.get("type")[0m
[30;1m239 | [0m[35m        self.etag: str = kwargs.get("etag")[0m
[30;1m240 | [0m[35m        self.properties: Dict[str, Union[str, Dict[str, Union[Dict, str]]]] = ([0m

[31m--[ [0m[34mMatch #[0m[33m1409[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m235 | [0m[35m        """Initialize Linked Service instance."""[0m
[30;1m236 | [0m[35m        self.res_id: str = kwargs.get("id")[0m
[30;1m237 | [0m[35m        self.name: str = kwargs.get("name")[0m
[30;1m238 | [0m[35m        self.entry_type: str = kwargs.get("type")[0m
[30;1m239 | [0m[35m        self.etag: str = kwargs.get("etag")[0m

[31m--[ [0m[34mMatch #[0m[33m1410[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35mdef is_in_synapse():[0m
[30;1m56 | [0m[35m    """Return True if running in Synapse Pipeline."""[0m
[30;1m57 | [0m[35m    return os.environ.get("MMLSPARK_PLATFORM_INFO") == "synapse"[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35mIdentityType = Literal["managed", "service_principal"][0m

[31m--[ [0m[34mMatch #[0m[33m1411[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m        raise RuntimeError("Could not mount configuration data container.")[0m
[30;1m114 | [0m[35m    print(f"Mounted {storage_svc.url}/{mp_spark.container} at {mp_spark.config_path}")[0m
[30;1m115 | [0m[35m    logger.info([0m
[30;1m116 | [0m[35m        "Mounted %s/%s at %s", storage_svc.url, mp_spark.container, mp_spark.config_path[0m
[30;1m117 | [0m[35m    )[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    # Set msticpy settings[0m

[31m--[ [0m[34mMatch #[0m[33m1412[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m    )[0m
[30;1m112 | [0m[35m    if not mount_success:[0m
[30;1m113 | [0m[35m        raise RuntimeError("Could not mount configuration data container.")[0m
[30;1m114 | [0m[35m    print(f"Mounted {storage_svc.url}/{mp_spark.container} at {mp_spark.config_path}")[0m
[30;1m115 | [0m[35m    logger.info([0m
[30;1m116 | [0m[35m        "Mounted %s/%s at %s", storage_svc.url, mp_spark.container, mp_spark.config_path[0m
[30;1m117 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1413[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m525 | [0m[35m        tenant_id or mp_spark.tenant_id,[0m
[30;1m526 | [0m[35m    )[0m
[30;1m527 | [0m[35m    logger.info([0m
[30;1m528 | [0m[35m        "Setting authentication env var %s=%s",[0m
[30;1m529 | [0m[35m        AzureCredEnvNames.AZURE_CLIENT_ID,[0m
[30;1m530 | [0m[35m        mp_spark.application_id,[0m
[30;1m531 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1414[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m520 | [0m[35m    os.environ[AzureCredEnvNames.AZURE_TENANT_ID] = tenant_id or mp_spark.tenant_id[0m
[30;1m521 | [0m[35m    os.environ[AzureCredEnvNames.AZURE_CLIENT_ID] = mp_spark.application_id[0m
[30;1m522 | [0m[35m    logger.info([0m
[30;1m523 | [0m[35m        "Setting authentication env var %s=%s",[0m
[30;1m524 | [0m[35m        AzureCredEnvNames.AZURE_TENANT_ID,[0m
[30;1m525 | [0m[35m        tenant_id or mp_spark.tenant_id,[0m
[30;1m526 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1415[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m[0m
[30;1m518 | [0m[35mdef _set_msi_client_id(mp_spark: MPSparkUtils, tenant_id: Optional[str] = None):[0m
[30;1m519 | [0m[35m    """Publish Service Principal credentials to environment variables."""[0m
[30;1m520 | [0m[35m    os.environ[AzureCredEnvNames.AZURE_TENANT_ID] = tenant_id or mp_spark.tenant_id[0m
[30;1m521 | [0m[35m    os.environ[AzureCredEnvNames.AZURE_CLIENT_ID] = mp_spark.application_id[0m
[30;1m522 | [0m[35m    logger.info([0m

[31m--[ [0m[34mMatch #[0m[33m1416[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m509 | [0m[35m        client_id,[0m
[30;1m510 | [0m[35m    )[0m
[30;1m511 | [0m[35m    logger.info([0m
[30;1m512 | [0m[35m        "Setting authentication env var %s=%s",[0m
[30;1m513 | [0m[35m        AzureCredEnvNames.AZURE_CLIENT_SECRET,[0m
[30;1m514 | [0m[35m        "*" * len(client_secret),[0m
[30;1m515 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1417[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m504 | [0m[35m        tenant_id or mp_spark.tenant_id,[0m
[30;1m505 | [0m[35m    )[0m
[30;1m506 | [0m[35m    logger.info([0m
[30;1m507 | [0m[35m        "Setting authentication env var %s=%s",[0m
[30;1m508 | [0m[35m        AzureCredEnvNames.AZURE_CLIENT_ID,[0m
[30;1m509 | [0m[35m        client_id,[0m
[30;1m510 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1418[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m499 | [0m[35m        raise LookupError("Could not obtain client_secret from Key Vault.")[0m
[30;1m500 | [0m[35m    os.environ[AzureCredEnvNames.AZURE_CLIENT_SECRET] = client_secret[0m
[30;1m501 | [0m[35m    logger.info([0m
[30;1m502 | [0m[35m        "Setting authentication env var %s=%s",[0m
[30;1m503 | [0m[35m        AzureCredEnvNames.AZURE_TENANT_ID,[0m
[30;1m504 | [0m[35m        tenant_id or mp_spark.tenant_id,[0m
[30;1m505 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1419[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m488 | [0m[35m[0m
[30;1m489 | [0m[35m[0m
[30;1m490 | [0m[35mdef _set_azure_env_creds(mp_spark: MPSparkUtils, tenant_id: Optional[str] = None):[0m
[30;1m491 | [0m[35m    """Publish Service Principal credentials to environment variables."""[0m
[30;1m492 | [0m[35m    os.environ[AzureCredEnvNames.AZURE_TENANT_ID] = tenant_id or mp_spark.tenant_id[0m
[30;1m493 | [0m[35m    client_id = mp_spark.get_kv_secret(SynapseName.sp_client_id_name)[0m
[30;1m494 | [0m[35m    if not client_id:[0m

[31m--[ [0m[34mMatch #[0m[33m1420[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m447 | [0m[35m        """Return secret from linked service."""[0m
[30;1m448 | [0m[35m        kv_service = self.get_service_of_type(LinkedService.ServiceTypes.AzureKeyVault)[0m
[30;1m449 | [0m[35m        if not kv_service:[0m
[30;1m450 | [0m[35m            raise ValueError("No linked Key Vault service found.")[0m
[30;1m451 | [0m[35m        return mssparkutils.credentials.getSecret([0m
[30;1m452 | [0m[35m            kv_service.azure_name, secret_name, kv_service.name[0m
[30;1m453 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1421[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m440 | [0m[35m                    svc_type=LinkedService.ServiceTypes.AzureBlobFS[0m
[30;1m441 | [0m[35m                )[0m
[30;1m442 | [0m[35m        if not storage_svc:[0m
[30;1m443 | [0m[35m            raise TypeError("No linked storage service found.")[0m
[30;1m444 | [0m[35m        return storage_svc[0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m    def get_kv_secret(self, secret_name: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1422[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m429 | [0m[35m    def get_storage_service([0m
[30;1m430 | [0m[35m        self, linked_svc_name: Optional[str] = None[0m
[30;1m431 | [0m[35m    ) -> LinkedService:[0m
[30;1m432 | [0m[35m        """Return linked storage service (named) or default storage."""[0m
[30;1m433 | [0m[35m        storage_svc: Optional[LinkedService] = None[0m
[30;1m434 | [0m[35m        if linked_svc_name:[0m
[30;1m435 | [0m[35m            storage_svc = self.get_service(svc_name=linked_svc_name)[0m

[31m--[ [0m[34mMatch #[0m[33m1423[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m412 | [0m[35m        Returns[0m
[30;1m413 | [0m[35m        -------[0m
[30;1m414 | [0m[35m        Optional[LinkedService][0m
[30;1m415 | [0m[35m            Named service service.[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m        """[0m
[30;1m418 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1424[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m370 | [0m[35m        Parameters[0m
[30;1m371 | [0m[35m        ----------[0m
[30;1m372 | [0m[35m        svc_type : str[0m
[30;1m373 | [0m[35m            Service Type (AzureBlobFS, AzureBlobStorage, AzureSqlDW,[0m
[30;1m374 | [0m[35m            AzureKeyVault)[0m
[30;1m375 | [0m[35m[0m
[30;1m376 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m1425[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m345 | [0m[35m        Parameters[0m
[30;1m346 | [0m[35m        ----------[0m
[30;1m347 | [0m[35m        svc_type : str[0m
[30;1m348 | [0m[35m            Service Type (AzureBlobFS, AzureBlobStorage, AzureSqlDW,[0m
[30;1m349 | [0m[35m            AzureKeyVault)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m1426[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    def get_service_of_type(self, svc_type: str) -> Optional[LinkedService]:[0m
[30;1m342 | [0m[35m        """[0m
[30;1m343 | [0m[35m        Return the first linked service of specific `svc_type`.[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m        Parameters[0m
[30;1m346 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1427[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m    @property[0m
[30;1m337 | [0m[35m    def config_path(self):[0m
[30;1m338 | [0m[35m        """Return mount path for MSTICPy config."""[0m
[30;1m339 | [0m[35m        return Path(f"/synfs/{self.job_id}/{self.mount_point}")[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    def get_service_of_type(self, svc_type: str) -> Optional[LinkedService]:[0m

[31m--[ [0m[34mMatch #[0m[33m1428[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m    @property[0m
[30;1m327 | [0m[35m    def fs_mounts(self) -> Dict[str, str]:[0m
[30;1m328 | [0m[35m        """Return a dictionary of mount points and targets."""[0m
[30;1m329 | [0m[35m        return {mnt.mountPoint: mnt.source for mnt in mssparkutils.fs.mounts()}[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1429[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m        return az_name["name"][0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m# Note storage linked service is generated by Synapse workspace creation process[0m
[30;1m274 | [0m[35m# pylint: disable=too-few-public-methods[0m
[30;1m275 | [0m[35mclass SynapseName:[0m
[30;1m276 | [0m[35m    """Name mapping to default values."""[0m

[31m--[ [0m[34mMatch #[0m[33m1430[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m232 | [0m[35m        AzureKeyVault = "AzureKeyVault"[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m235 | [0m[35m        """Initialize Linked Service instance."""[0m
[30;1m236 | [0m[35m        self.res_id: str = kwargs.get("id")[0m
[30;1m237 | [0m[35m        self.name: str = kwargs.get("name")[0m
[30;1m238 | [0m[35m        self.entry_type: str = kwargs.get("type")[0m

[31m--[ [0m[34mMatch #[0m[33m1431[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m    _TYPE_PROPS = "typeProperties"[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m    class ServiceTypes:[0m
[30;1m226 | [0m[35m        """Enumeration of linked service type names."""[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        AzureBlobFS = "AzureBlobFS"[0m
[30;1m229 | [0m[35m        AzureSqlDW = "AzureSqlDW"[0m

[31m--[ [0m[34mMatch #[0m[33m1432[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m# pylint: disable=too-few-public-methods[0m
[30;1m220 | [0m[35mclass LinkedService:[0m
[30;1m221 | [0m[35m    """Azure Synapse Linked Service settings."""[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m    _TYPE_PROPS = "typeProperties"[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1433[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m    -------[0m
[30;1m188 | [0m[35m    bool[0m
[30;1m189 | [0m[35m        True if mounting successful or if mount point already connected.[0m
[30;1m190 | [0m[35m        False if mounting failed or mount point connected to a different[0m
[30;1m191 | [0m[35m        storage location.[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    Raises[0m

[31m--[ [0m[34mMatch #[0m[33m1434[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m    Returns[0m
[30;1m187 | [0m[35m    -------[0m
[30;1m188 | [0m[35m    bool[0m
[30;1m189 | [0m[35m        True if mounting successful or if mount point already connected.[0m
[30;1m190 | [0m[35m        False if mounting failed or mount point connected to a different[0m
[30;1m191 | [0m[35m        storage location.[0m
[30;1m192 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1435[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m    mount_path : str[0m
[30;1m178 | [0m[35m        Local path to mount[0m
[30;1m179 | [0m[35m    linked_service : str[0m
[30;1m180 | [0m[35m        Storage linked service name[0m
[30;1m181 | [0m[35m    folder : str, optional[0m
[30;1m182 | [0m[35m        Subfolder of container, if any, by default ""[0m
[30;1m183 | [0m[35m    cloud : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1436[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m    container : str[0m
[30;1m176 | [0m[35m        Container name to mount[0m
[30;1m177 | [0m[35m    mount_path : str[0m
[30;1m178 | [0m[35m        Local path to mount[0m
[30;1m179 | [0m[35m    linked_service : str[0m
[30;1m180 | [0m[35m        Storage linked service name[0m
[30;1m181 | [0m[35m    folder : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1437[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m    store_acct_name : str[0m
[30;1m174 | [0m[35m        Storage account[0m
[30;1m175 | [0m[35m    container : str[0m
[30;1m176 | [0m[35m        Container name to mount[0m
[30;1m177 | [0m[35m    mount_path : str[0m
[30;1m178 | [0m[35m        Local path to mount[0m
[30;1m179 | [0m[35m    linked_service : str[0m

[31m--[ [0m[34mMatch #[0m[33m1438[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m    cloud: str = "global",[0m
[30;1m167 | [0m[35m) -> bool:[0m
[30;1m168 | [0m[35m    """[0m
[30;1m169 | [0m[35m    Mount Azure file container to Synapse file system.[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    Parameters[0m
[30;1m172 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1439[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35mdef current_mounts() -> Dict[str, str]:[0m
[30;1m156 | [0m[35m    """Return dictionary of current Synapse mount points."""[0m
[30;1m157 | [0m[35m    return {mnt.mountPoint: mnt.source for mnt in mssparkutils.fs.mounts()}[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1440[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m        _set_mp_azure_settings(auth_method="env", cloud=cloud)[0m
[30;1m134 | [0m[35m        _set_azure_env_creds(mp_spark=mp_spark, tenant_id=tenant_id)[0m
[30;1m135 | [0m[35m        print("using service principal,", end=" ")[0m
[30;1m136 | [0m[35m        logger.info("Using service principal")[0m
[30;1m137 | [0m[35m    print()[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    # authenticate with MSI or SP to linked KV[0m

[31m--[ [0m[34mMatch #[0m[33m1441[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m        # Publish SP creds from KeyVault[0m
[30;1m133 | [0m[35m        _set_mp_azure_settings(auth_method="env", cloud=cloud)[0m
[30;1m134 | [0m[35m        _set_azure_env_creds(mp_spark=mp_spark, tenant_id=tenant_id)[0m
[30;1m135 | [0m[35m        print("using service principal,", end=" ")[0m
[30;1m136 | [0m[35m        logger.info("Using service principal")[0m
[30;1m137 | [0m[35m    print()[0m
[30;1m138 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1442[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m        linked_service=storage_svc.name,[0m
[30;1m111 | [0m[35m    )[0m
[30;1m112 | [0m[35m    if not mount_success:[0m
[30;1m113 | [0m[35m        raise RuntimeError("Could not mount configuration data container.")[0m
[30;1m114 | [0m[35m    print(f"Mounted {storage_svc.url}/{mp_spark.container} at {mp_spark.config_path}")[0m
[30;1m115 | [0m[35m    logger.info([0m
[30;1m116 | [0m[35m        "Mounted %s/%s at %s", storage_svc.url, mp_spark.container, mp_spark.config_path[0m

[31m--[ [0m[34mMatch #[0m[33m1443[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m        logger.error("No suitable linked storage service found.")[0m
[30;1m101 | [0m[35m        raise RuntimeError("No suitable linked storage service found.")[0m
[30;1m102 | [0m[35m    print(f"Using linked storage service {storage_svc.name}")[0m
[30;1m103 | [0m[35m    logger.info("Using linked storage service %s", storage_svc.name)[0m
[30;1m104 | [0m[35m    print("Mounting storage...", end=" ")[0m
[30;1m105 | [0m[35m    stor_acct_match = re.match(_AZ_NAME_PATTERN, storage_svc.url)[0m
[30;1m106 | [0m[35m    mount_success = mount_container([0m

[31m--[ [0m[34mMatch #[0m[33m1444[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m    if not storage_svc:[0m
[30;1m100 | [0m[35m        logger.error("No suitable linked storage service found.")[0m
[30;1m101 | [0m[35m        raise RuntimeError("No suitable linked storage service found.")[0m
[30;1m102 | [0m[35m    print(f"Using linked storage service {storage_svc.name}")[0m
[30;1m103 | [0m[35m    logger.info("Using linked storage service %s", storage_svc.name)[0m
[30;1m104 | [0m[35m    print("Mounting storage...", end=" ")[0m
[30;1m105 | [0m[35m    stor_acct_match = re.match(_AZ_NAME_PATTERN, storage_svc.url)[0m

[31m--[ [0m[34mMatch #[0m[33m1445[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m    storage_svc = mp_spark.get_storage_service(storage_svc_name)[0m
[30;1m99 | [0m[35m    if not storage_svc:[0m
[30;1m100 | [0m[35m        logger.error("No suitable linked storage service found.")[0m
[30;1m101 | [0m[35m        raise RuntimeError("No suitable linked storage service found.")[0m
[30;1m102 | [0m[35m    print(f"Using linked storage service {storage_svc.name}")[0m
[30;1m103 | [0m[35m    logger.info("Using linked storage service %s", storage_svc.name)[0m
[30;1m104 | [0m[35m    print("Mounting storage...", end=" ")[0m

[31m--[ [0m[34mMatch #[0m[33m1446[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m    mp_spark = MPSparkUtils()[0m
[30;1m98 | [0m[35m    storage_svc = mp_spark.get_storage_service(storage_svc_name)[0m
[30;1m99 | [0m[35m    if not storage_svc:[0m
[30;1m100 | [0m[35m        logger.error("No suitable linked storage service found.")[0m
[30;1m101 | [0m[35m        raise RuntimeError("No suitable linked storage service found.")[0m
[30;1m102 | [0m[35m    print(f"Using linked storage service {storage_svc.name}")[0m
[30;1m103 | [0m[35m    logger.info("Using linked storage service %s", storage_svc.name)[0m

[31m--[ [0m[34mMatch #[0m[33m1447[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m    ------[0m
[30;1m86 | [0m[35m    RuntimeError[0m
[30;1m87 | [0m[35m        No suitable linked storage service found.[0m
[30;1m88 | [0m[35m        Could not mount configuration data container.[0m
[30;1m89 | [0m[35m        Could not authenticate to Azure.[0m
[30;1m90 | [0m[35m        Could not retrieve secret from Key Vault.[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1448[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m    Raises[0m
[30;1m85 | [0m[35m    ------[0m
[30;1m86 | [0m[35m    RuntimeError[0m
[30;1m87 | [0m[35m        No suitable linked storage service found.[0m
[30;1m88 | [0m[35m        Could not mount configuration data container.[0m
[30;1m89 | [0m[35m        Could not authenticate to Azure.[0m
[30;1m90 | [0m[35m        Could not retrieve secret from Key Vault.[0m

[31m--[ [0m[34mMatch #[0m[33m1449[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_synapse_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m        The authentication type to be used by MSTICPy, by default "managed".[0m
[30;1m76 | [0m[35m        Options are "managed", "service_principal"[0m
[30;1m77 | [0m[35m    storage_svc_name : Optional[str], optional[0m
[30;1m78 | [0m[35m        Override the default storage linked service name, by default None[0m
[30;1m79 | [0m[35m    tenant_id : Optional[str], optional[0m
[30;1m80 | [0m[35m        Override the default tenant_id for the Azure authentication, by default None[0m
[30;1m81 | [0m[35m    cloud : str[0m

[31m--[ [0m[34mMatch #[0m[33m1450[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxauditd.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m
[30;1m20 | [0m[35m        type: datetime[0m
[30;1m21 | [0m[35m      add_query_items:[0m
[30;1m22 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1451[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxauditd.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m        type: str[0m
[30;1m14 | [0m[35m        default: 'AuditLog_CL'[0m
[30;1m15 | [0m[35m      start:[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1452[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_o365.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m        type: str[0m
[30;1m68 | [0m[35m        default: OfficeActivity[0m
[30;1m69 | [0m[35m      ip_address_list:[0m
[30;1m70 | [0m[35m        description: The IP Address or list of Addresses[0m
[30;1m71 | [0m[35m        type: list[0m
[30;1m72 | [0m[35m  list_activity_for_resource:[0m
[30;1m73 | [0m[35m    description: Lists Office/O365 Activity for a Resource (OfficeObjectId)[0m

[31m--[ [0m[34mMatch #[0m[33m1453[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_o365.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m        description: The account name to find[0m
[30;1m49 | [0m[35m        type: str[0m
[30;1m50 | [0m[35m  list_activity_for_ip:[0m
[30;1m51 | [0m[35m    description: Lists Office/O365 Activity for Caller IP Address(es)[0m
[30;1m52 | [0m[35m    metadata:[0m
[30;1m53 | [0m[35m      pivot:[0m
[30;1m54 | [0m[35m        short_name: activity[0m

[31m--[ [0m[34mMatch #[0m[33m1454[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_o365.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        type: str[0m
[30;1m46 | [0m[35m        default: OfficeActivity[0m
[30;1m47 | [0m[35m      account_name:[0m
[30;1m48 | [0m[35m        description: The account name to find[0m
[30;1m49 | [0m[35m        type: str[0m
[30;1m50 | [0m[35m  list_activity_for_ip:[0m
[30;1m51 | [0m[35m    description: Lists Office/O365 Activity for Caller IP Address(es)[0m

[31m--[ [0m[34mMatch #[0m[33m1455[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_o365.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m        description: Query start time[0m
[30;1m13 | [0m[35m        type: datetime[0m
[30;1m14 | [0m[35m      end:[0m
[30;1m15 | [0m[35m        description: Query end time[0m
[30;1m16 | [0m[35m        type: datetime[0m
[30;1m17 | [0m[35m      add_query_items:[0m
[30;1m18 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1456[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_o365.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    data_source: 'OfficeActivity'[0m
[30;1m10 | [0m[35m  parameters:[0m
[30;1m11 | [0m[35m      start:[0m
[30;1m12 | [0m[35m        description: Query start time[0m
[30;1m13 | [0m[35m        type: datetime[0m
[30;1m14 | [0m[35m      end:[0m
[30;1m15 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1457[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m            if st_type == "str":[0m
[30;1m297 | [0m[35m                def_settings[setting] = st_opts.get("default")[0m
[30;1m298 | [0m[35m            elif st_type == "bool":[0m
[30;1m299 | [0m[35m                def_settings[setting] = st_opts.get("default", False)[0m
[30;1m300 | [0m[35m        return def_settings[0m

[31m--[ [0m[34mMatch #[0m[33m1458[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m        for setting, defn in prov_defn.items():[0m
[30;1m295 | [0m[35m            st_type, st_opts = defn if isinstance(defn, tuple) else "str", {}[0m
[30;1m296 | [0m[35m            if st_type == "str":[0m
[30;1m297 | [0m[35m                def_settings[setting] = st_opts.get("default")[0m
[30;1m298 | [0m[35m            elif st_type == "bool":[0m
[30;1m299 | [0m[35m                def_settings[setting] = st_opts.get("default", False)[0m
[30;1m300 | [0m[35m        return def_settings[0m

[31m--[ [0m[34mMatch #[0m[33m1459[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m            if st_type == "bool":[0m
[30;1m211 | [0m[35m                def_settings[setting] = st_opts.get("default", False)[0m
[30;1m212 | [0m[35m            elif st_type == "str":[0m
[30;1m213 | [0m[35m                def_settings[setting] = st_opts.get("default")[0m
[30;1m214 | [0m[35m        if wkspace:[0m
[30;1m215 | [0m[35m            return {defn_name: {wkspace: def_settings}}[0m
[30;1m216 | [0m[35m        return {defn_name: def_settings}[0m

[31m--[ [0m[34mMatch #[0m[33m1460[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        for setting, defn in prov_defn.items():[0m
[30;1m209 | [0m[35m            st_type, st_opts = defn if isinstance(defn, tuple) else "str", {}[0m
[30;1m210 | [0m[35m            if st_type == "bool":[0m
[30;1m211 | [0m[35m                def_settings[setting] = st_opts.get("default", False)[0m
[30;1m212 | [0m[35m            elif st_type == "str":[0m
[30;1m213 | [0m[35m                def_settings[setting] = st_opts.get("default")[0m
[30;1m214 | [0m[35m        if wkspace:[0m

[31m--[ [0m[34mMatch #[0m[33m1461[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        az_sent_provs = self.mp_controls.mp_config.get("AzureSentinel")[0m
[30;1m148 | [0m[35m        if az_sent_provs:[0m
[30;1m149 | [0m[35m            # If we have Sentinel providers[0m
[30;1m150 | [0m[35m            opt_list = [f"AzureSentinel.{ws}" for ws in az_sent_provs.get("Workspaces")][0m
[30;1m151 | [0m[35m        else:[0m
[30;1m152 | [0m[35m            opt_list = [][0m
[30;1m153 | [0m[35m        opt_list.extend([0m

[31m--[ [0m[34mMatch #[0m[33m1462[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m            self.set_status(status)[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    def _get_available_options(self):[0m
[30;1m147 | [0m[35m        az_sent_provs = self.mp_controls.mp_config.get("AzureSentinel")[0m
[30;1m148 | [0m[35m        if az_sent_provs:[0m
[30;1m149 | [0m[35m            # If we have Sentinel providers[0m
[30;1m150 | [0m[35m            opt_list = [f"AzureSentinel.{ws}" for ws in az_sent_provs.get("Workspaces")][0m

[31m--[ [0m[34mMatch #[0m[33m1463[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m        return f"{self._COMP_PATH}.{self.select_item.label}"[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def _select_provider(self, change):[0m
[30;1m106 | [0m[35m        prov_name = change.get("new")[0m
[30;1m107 | [0m[35m        edit_ctrl = self._get_settings_ctrls(prov_name, self._COMP_PATH)[0m
[30;1m108 | [0m[35m        self.edit_ctrls = ([0m
[30;1m109 | [0m[35m            edit_ctrl if isinstance(edit_ctrl, widgets.Widget) else edit_ctrl.layout[0m

[31m--[ [0m[34mMatch #[0m[33m1464[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m248 | [0m[35m    </ul>[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m    The last two components also support a "connect" parameter. If this is not[0m
[30;1m251 | [0m[35m    set the default is to initiate authentication to the service as soon as[0m
[30;1m252 | [0m[35m    the component is loaded. set connect=False to prevent this.[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1465[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m    <ul>[0m
[30;1m235 | [0m[35m        <li>TILookup (ti_lookup) - Threat Intelligence lookups</li>[0m
[30;1m236 | [0m[35m        <li>GeoIpLookup (geoip) - Geolocation of IP address lookups[0m
[30;1m237 | [0m[35m        Note: you must specify which GeoIP Provider you wish to use.[0m
[30;1m238 | [0m[35m        </li>[0m
[30;1m239 | [0m[35m        <li>Notebooklets (nb) - Load the MSTIC notebooklets package. This must be[0m
[30;1m240 | [0m[35m        installed in your notebook environment. You must specificy a default[0m

[31m--[ [0m[34mMatch #[0m[33m1466[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_user_defaults.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m    required on the component.)[0m
[30;1m234 | [0m[35m    <ul>[0m
[30;1m235 | [0m[35m        <li>TILookup (ti_lookup) - Threat Intelligence lookups</li>[0m
[30;1m236 | [0m[35m        <li>GeoIpLookup (geoip) - Geolocation of IP address lookups[0m
[30;1m237 | [0m[35m        Note: you must specify which GeoIP Provider you wish to use.[0m
[30;1m238 | [0m[35m        </li>[0m
[30;1m239 | [0m[35m        <li>Notebooklets (nb) - Load the MSTIC notebooklets package. This must be[0m

[31m--[ [0m[34mMatch #[0m[33m1467[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m215 | [0m[35m        description: Name of host to get events from[0m
[30;1m216 | [0m[35m        type: str[0m
[30;1m217 | [0m[35m      host_op:[0m
[30;1m218 | [0m[35m        description: The hostname match operator[0m
[30;1m219 | [0m[35m        type: str[0m
[30;1m220 | [0m[35m        default: has[0m

[31m--[ [0m[34mMatch #[0m[33m1468[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m185 | [0m[35m        description: Name of host to get events from[0m
[30;1m186 | [0m[35m        type: str[0m
[30;1m187 | [0m[35m      host_op:[0m
[30;1m188 | [0m[35m        description: The hostname match operator[0m
[30;1m189 | [0m[35m        type: str[0m
[30;1m190 | [0m[35m        default: has[0m
[30;1m191 | [0m[35m  notable_events:[0m

[31m--[ [0m[34mMatch #[0m[33m1469[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m166 | [0m[35m        description: Name of host to get events from[0m
[30;1m167 | [0m[35m        type: str[0m
[30;1m168 | [0m[35m      host_op:[0m
[30;1m169 | [0m[35m        description: The hostname match operator[0m
[30;1m170 | [0m[35m        type: str[0m
[30;1m171 | [0m[35m        default: has[0m
[30;1m172 | [0m[35m  account_change_events:[0m

[31m--[ [0m[34mMatch #[0m[33m1470[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m136 | [0m[35m        description: Name of host[0m
[30;1m137 | [0m[35m        type: str[0m
[30;1m138 | [0m[35m      host_op:[0m
[30;1m139 | [0m[35m        description: The hostname match operator[0m
[30;1m140 | [0m[35m        type: str[0m
[30;1m141 | [0m[35m        default: has[0m
[30;1m142 | [0m[35m  schdld_tasks_and_services:[0m

[31m--[ [0m[34mMatch #[0m[33m1471[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m94 | [0m[35m        description: Name of host[0m
[30;1m95 | [0m[35m        type: str[0m
[30;1m96 | [0m[35m      host_op:[0m
[30;1m97 | [0m[35m        description: The hostname match operator[0m
[30;1m98 | [0m[35m        type: str[0m
[30;1m99 | [0m[35m        default: has[0m
[30;1m100 | [0m[35m  list_events:[0m

[31m--[ [0m[34mMatch #[0m[33m1472[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m71 | [0m[35m        description: Name of host[0m
[30;1m72 | [0m[35m        type: str[0m
[30;1m73 | [0m[35m      host_op:[0m
[30;1m74 | [0m[35m        description: The hostname match operator[0m
[30;1m75 | [0m[35m        type: str[0m
[30;1m76 | [0m[35m        default: has[0m
[30;1m77 | [0m[35m      event_list:[0m

[31m--[ [0m[34mMatch #[0m[33m1473[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m47 | [0m[35m        description: Name of host[0m
[30;1m48 | [0m[35m        type: str[0m
[30;1m49 | [0m[35m      host_op:[0m
[30;1m50 | [0m[35m        description: The hostname match operator[0m
[30;1m51 | [0m[35m        type: str[0m
[30;1m52 | [0m[35m        default: has[0m
[30;1m53 | [0m[35m  list_host_events_by_id:[0m

[31m--[ [0m[34mMatch #[0m[33m1474[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m        | extend EventData = parse_xml(EventData)[0m
[30;1m154 | [0m[35m        | project-reorder Activity[0m
[30;1m155 | [0m[35m        | extend Data = parse_json(tostring(EventData.EventData)).["Data"][0m
[30;1m156 | [0m[35m        | extend Service = iif(isnotempty(ServiceFileName), ServiceFileName, Data[4].["#text"])[0m
[30;1m157 | [0m[35m        | extend Type = iif(isnotempty(ServiceFileName), "Service", "Scheduled Task")[0m
[30;1m158 | [0m[35m        | extend ServiceType = iif(Type =~ "Service", Data[6].["#text"], "")[0m
[30;1m159 | [0m[35m        | extend ServiceStartType = iif(Type =~ "Service", Data[7].["#text"], "")[0m

[31m--[ [0m[34mMatch #[0m[33m1475[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m        description: Query start time[0m
[30;1m21 | [0m[35m        type: datetime[0m
[30;1m22 | [0m[35m      end:[0m
[30;1m23 | [0m[35m        description: Query end time[0m
[30;1m24 | [0m[35m        type: datetime[0m
[30;1m25 | [0m[35m      add_query_items:[0m
[30;1m26 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1476[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m        type: str[0m
[30;1m18 | [0m[35m        default: ''[0m
[30;1m19 | [0m[35m      start:[0m
[30;1m20 | [0m[35m        description: Query start time[0m
[30;1m21 | [0m[35m        type: datetime[0m
[30;1m22 | [0m[35m      end:[0m
[30;1m23 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1477[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/service_principal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m    TenantId : str[0m
[30;1m37 | [0m[35m        The AAD tenant id of Service Principal[0m
[30;1m38 | [0m[35m    ServicePrincipalType : str[0m
[30;1m39 | [0m[35m        The type of the service principal: 'Unknown', 'Application',[0m
[30;1m40 | [0m[35m        'ManagedIdentity', 'Legacy'[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1478[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/service_principal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m        The tenant id where the application is registered.[0m
[30;1m35 | [0m[35m        This is applicable only to service principals backed by applications.[0m
[30;1m36 | [0m[35m    TenantId : str[0m
[30;1m37 | [0m[35m        The AAD tenant id of Service Principal[0m
[30;1m38 | [0m[35m    ServicePrincipalType : str[0m
[30;1m39 | [0m[35m        The type of the service principal: 'Unknown', 'Application',[0m
[30;1m40 | [0m[35m        'ManagedIdentity', 'Legacy'[0m

[31m--[ [0m[34mMatch #[0m[33m1479[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/service_principal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m        SecurityGroup ObjectGuid[0m
[30;1m33 | [0m[35m    AppOwnerTenantId : str[0m
[30;1m34 | [0m[35m        The tenant id where the application is registered.[0m
[30;1m35 | [0m[35m        This is applicable only to service principals backed by applications.[0m
[30;1m36 | [0m[35m    TenantId : str[0m
[30;1m37 | [0m[35m        The AAD tenant id of Service Principal[0m
[30;1m38 | [0m[35m    ServicePrincipalType : str[0m

[31m--[ [0m[34mMatch #[0m[33m1480[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m            If `end_time_column` is not specified it will also be used to[0m
[30;1m214 | [0m[35m            calculate the end time.[0m
[30;1m215 | [0m[35m        end_time_column : Optional[str][0m
[30;1m216 | [0m[35m            If supplied, it will be used to calculate the end time[0m
[30;1m217 | [0m[35m            of the duration for each group.[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        Other Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m1481[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m            The column name or iterable of column names to group the data by.[0m
[30;1m210 | [0m[35m        time_column : str[0m
[30;1m211 | [0m[35m            Primary time column - will be used to calculate the[0m
[30;1m212 | [0m[35m            start time of the duration for each group.[0m
[30;1m213 | [0m[35m            If `end_time_column` is not specified it will also be used to[0m
[30;1m214 | [0m[35m            calculate the end time.[0m
[30;1m215 | [0m[35m        end_time_column : Optional[str][0m

[31m--[ [0m[34mMatch #[0m[33m1482[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m        group_by : Union[Iterable[str], str][0m
[30;1m209 | [0m[35m            The column name or iterable of column names to group the data by.[0m
[30;1m210 | [0m[35m        time_column : str[0m
[30;1m211 | [0m[35m            Primary time column - will be used to calculate the[0m
[30;1m212 | [0m[35m            start time of the duration for each group.[0m
[30;1m213 | [0m[35m            If `end_time_column` is not specified it will also be used to[0m
[30;1m214 | [0m[35m            calculate the end time.[0m

[31m--[ [0m[34mMatch #[0m[33m1483[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m            (the default is None)[0m
[30;1m169 | [0m[35m        ref_time_col : str, optional[0m
[30;1m170 | [0m[35m            Add references line/label using the this column in `ref_events`[0m
[30;1m171 | [0m[35m            for the time value (x-axis).[0m
[30;1m172 | [0m[35m            (this defaults the value of the `time_column` parameter or 'TimeGenerated'[0m
[30;1m173 | [0m[35m            `time_column` is None)[0m
[30;1m174 | [0m[35m        ref_col : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1484[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m        title : str, optional[0m
[30;1m137 | [0m[35m            Title to display (the default is None)[0m
[30;1m138 | [0m[35m        ref_event : Any, optional[0m
[30;1m139 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m140 | [0m[35m        ref_time : datetime, optional[0m
[30;1m141 | [0m[35m            Add a reference line/label using `ref_time` (the default is None)[0m
[30;1m142 | [0m[35m        ref_label : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1485[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m            (the default is None)[0m
[30;1m88 | [0m[35m        ref_time_col : str, optional[0m
[30;1m89 | [0m[35m            Add references line/label using the this column in `ref_events`[0m
[30;1m90 | [0m[35m            for the time value (x-axis).[0m
[30;1m91 | [0m[35m            (this defaults the value of the `time_column` parameter or 'TimeGenerated'[0m
[30;1m92 | [0m[35m            `time_column` is None)[0m
[30;1m93 | [0m[35m        ref_col : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1486[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m        alert : SecurityAlert, optional[0m
[30;1m57 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m58 | [0m[35m        ref_event : Any, optional[0m
[30;1m59 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m60 | [0m[35m        ref_time : datetime, optional[0m
[30;1m61 | [0m[35m            Add a reference line/label using `ref_time` (the default is None)[0m
[30;1m62 | [0m[35m        group_by : str[0m

[31m--[ [0m[34mMatch #[0m[33m1487[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline_pd_accessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m        title : str, optional[0m
[30;1m53 | [0m[35m            Title to display (the default is None)[0m
[30;1m54 | [0m[35m        alert : SecurityAlert, optional[0m
[30;1m55 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m56 | [0m[35m        ref_event : Any, optional[0m
[30;1m57 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m58 | [0m[35m        ref_time : datetime, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1488[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m122 | [0m[35m        {add_query_items}'[0m
[30;1m123 | [0m[35m    parameters:[0m
[30;1m124 | [0m[35m      host_name:[0m
[30;1m125 | [0m[35m        description: The hostname to find[0m
[30;1m126 | [0m[35m        type: str[0m
[30;1m127 | [0m[35m        default: ''[0m
[30;1m128 | [0m[35m      account_name:[0m

[31m--[ [0m[34mMatch #[0m[33m1489[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m108 | [0m[35m        | extend src_procname = tostring(split(src_proc, "{path_separator}")[-1])[0m
[30;1m109 | [0m[35m        | extend host_match = iif(isnotempty(src_host) and[0m
[30;1m110 | [0m[35m            (Entities has src_hostname or Entities has src_host[0m
[30;1m111 | [0m[35m            or ExtendedProperties has src_hostname[0m
[30;1m112 | [0m[35m            or ExtendedProperties has src_host), true, false)[0m
[30;1m113 | [0m[35m        | extend acct_match = iif(isnotempty(src_acct)[0m
[30;1m114 | [0m[35m            and (Entities has src_accountname or Entities has src_acct[0m

[31m--[ [0m[34mMatch #[0m[33m1490[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m107 | [0m[35m                                      tostring(split(src_acct, "@")[0]))[0m
[30;1m108 | [0m[35m        | extend src_procname = tostring(split(src_proc, "{path_separator}")[-1])[0m
[30;1m109 | [0m[35m        | extend host_match = iif(isnotempty(src_host) and[0m
[30;1m110 | [0m[35m            (Entities has src_hostname or Entities has src_host[0m
[30;1m111 | [0m[35m            or ExtendedProperties has src_hostname[0m
[30;1m112 | [0m[35m            or ExtendedProperties has src_host), true, false)[0m
[30;1m113 | [0m[35m        | extend acct_match = iif(isnotempty(src_acct)[0m

[31m--[ [0m[34mMatch #[0m[33m1491[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m101 | [0m[35m        | where TimeGenerated >= datetime({start})[0m
[30;1m102 | [0m[35m        | where TimeGenerated <= datetime({end})[0m
[30;1m103 | [0m[35m        | extend Computer = src_host[0m
[30;1m104 | [0m[35m        | extend src_hostname = tostring(split(src_host, ".")[0])[0m
[30;1m105 | [0m[35m        | extend src_accountname = iif(src_acct contains "\\\\",[0m
[30;1m106 | [0m[35m                                      tostring(split(src_acct, "\\\\")[-1]),[0m
[30;1m107 | [0m[35m                                      tostring(split(src_acct, "@")[0]))[0m

[31m--[ [0m[34mMatch #[0m[33m1492[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m        description: Query start time[0m
[30;1m203 | [0m[35m        type: datetime[0m
[30;1m204 | [0m[35m      end:[0m
[30;1m205 | [0m[35m        description: Query end time[0m
[30;1m206 | [0m[35m        type: datetime[0m
[30;1m207 | [0m[35m      path_separator:[0m
[30;1m208 | [0m[35m        description: Path separator[0m

[31m--[ [0m[34mMatch #[0m[33m1493[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m          AlertDisplayName = DisplayName, Severity = AlertSeverity[0m
[30;1m200 | [0m[35m          | extend AlertType = iif(isempty(AlertType), AlertName, AlertType)'[0m
[30;1m201 | [0m[35m      start:[0m
[30;1m202 | [0m[35m        description: Query start time[0m
[30;1m203 | [0m[35m        type: datetime[0m
[30;1m204 | [0m[35m      end:[0m
[30;1m205 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1494[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m        let IP_table = toscalar(range idx from 0 to array_length(src_ips_arr) - 1 step 1[0m
[30;1m154 | [0m[35m        | extend ip = trim(@"\\s*", tostring(src_ips_arr[idx]))[0m
[30;1m155 | [0m[35m        | project ip[0m
[30;1m156 | [0m[35m        | distinct ip[0m
[30;1m157 | [0m[35m        | summarize makeset(ip) );[0m
[30;1m158 | [0m[35m        let ip_extract = materialize([0m
[30;1m159 | [0m[35m        {table}[0m

[31m--[ [0m[34mMatch #[0m[33m1495[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m        let src_ips_arr = split(src_ips, ",");[0m
[30;1m153 | [0m[35m        let IP_table = toscalar(range idx from 0 to array_length(src_ips_arr) - 1 step 1[0m
[30;1m154 | [0m[35m        | extend ip = trim(@"\\s*", tostring(src_ips_arr[idx]))[0m
[30;1m155 | [0m[35m        | project ip[0m
[30;1m156 | [0m[35m        | distinct ip[0m
[30;1m157 | [0m[35m        | summarize makeset(ip) );[0m
[30;1m158 | [0m[35m        let ip_extract = materialize([0m

[31m--[ [0m[34mMatch #[0m[33m1496[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m        let src_ips = "{source_ip_list}";[0m
[30;1m152 | [0m[35m        let src_ips_arr = split(src_ips, ",");[0m
[30;1m153 | [0m[35m        let IP_table = toscalar(range idx from 0 to array_length(src_ips_arr) - 1 step 1[0m
[30;1m154 | [0m[35m        | extend ip = trim(@"\\s*", tostring(src_ips_arr[idx]))[0m
[30;1m155 | [0m[35m        | project ip[0m
[30;1m156 | [0m[35m        | distinct ip[0m
[30;1m157 | [0m[35m        | summarize makeset(ip) );[0m

[31m--[ [0m[34mMatch #[0m[33m1497[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m        type: str[0m
[30;1m145 | [0m[35m        default: '\\'[0m
[30;1m146 | [0m[35m  list_alerts_for_ip:[0m
[30;1m147 | [0m[35m    description: Returns alerts with the specified IP Address or addresses.[0m
[30;1m148 | [0m[35m    metadata:[0m
[30;1m149 | [0m[35m    args:[0m
[30;1m150 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m1498[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m        description: Query start time[0m
[30;1m138 | [0m[35m        type: datetime[0m
[30;1m139 | [0m[35m      end:[0m
[30;1m140 | [0m[35m        description: Query end time[0m
[30;1m141 | [0m[35m        type: datetime[0m
[30;1m142 | [0m[35m      path_separator:[0m
[30;1m143 | [0m[35m        description: Path separator[0m

[31m--[ [0m[34mMatch #[0m[33m1499[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m        type: str[0m
[30;1m135 | [0m[35m        default: ''[0m
[30;1m136 | [0m[35m      start:[0m
[30;1m137 | [0m[35m        description: Query start time[0m
[30;1m138 | [0m[35m        type: datetime[0m
[30;1m139 | [0m[35m      end:[0m
[30;1m140 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1500[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m        type: str[0m
[30;1m131 | [0m[35m        default: ''[0m
[30;1m132 | [0m[35m      process_name:[0m
[30;1m133 | [0m[35m        description: The process name to find[0m
[30;1m134 | [0m[35m        type: str[0m
[30;1m135 | [0m[35m        default: ''[0m
[30;1m136 | [0m[35m      start:[0m

[31m--[ [0m[34mMatch #[0m[33m1501[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m        type: str[0m
[30;1m127 | [0m[35m        default: ''[0m
[30;1m128 | [0m[35m      account_name:[0m
[30;1m129 | [0m[35m        description: The account name to find[0m
[30;1m130 | [0m[35m        type: str[0m
[30;1m131 | [0m[35m        default: ''[0m
[30;1m132 | [0m[35m      process_name:[0m

[31m--[ [0m[34mMatch #[0m[33m1502[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m        {add_query_items}'[0m
[30;1m123 | [0m[35m    parameters:[0m
[30;1m124 | [0m[35m      host_name:[0m
[30;1m125 | [0m[35m        description: The hostname to find[0m
[30;1m126 | [0m[35m        type: str[0m
[30;1m127 | [0m[35m        default: ''[0m
[30;1m128 | [0m[35m      account_name:[0m

[31m--[ [0m[34mMatch #[0m[33m1503[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m        description: Query start time[0m
[30;1m64 | [0m[35m        type: datetime[0m
[30;1m65 | [0m[35m      end:[0m
[30;1m66 | [0m[35m        description: Query end time[0m
[30;1m67 | [0m[35m        type: datetime[0m
[30;1m68 | [0m[35m  get_alert:[0m
[30;1m69 | [0m[35m    description: Retrieves a single alert by SystemAlertId[0m

[31m--[ [0m[34mMatch #[0m[33m1504[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m        {add_query_items}'[0m
[30;1m61 | [0m[35m    parameters:[0m
[30;1m62 | [0m[35m      start:[0m
[30;1m63 | [0m[35m        description: Query start time[0m
[30;1m64 | [0m[35m        type: datetime[0m
[30;1m65 | [0m[35m      end:[0m
[30;1m66 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1505[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m        description: Query start time[0m
[30;1m44 | [0m[35m        type: datetime[0m
[30;1m45 | [0m[35m      end:[0m
[30;1m46 | [0m[35m        description: Query end time[0m
[30;1m47 | [0m[35m        type: datetime[0m
[30;1m48 | [0m[35m  list_alerts_counts:[0m
[30;1m49 | [0m[35m    description: Returns summary count of alerts by type[0m

[31m--[ [0m[34mMatch #[0m[33m1506[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m      uri: None[0m
[30;1m41 | [0m[35m    parameters:[0m
[30;1m42 | [0m[35m      start:[0m
[30;1m43 | [0m[35m        description: Query start time[0m
[30;1m44 | [0m[35m        type: datetime[0m
[30;1m45 | [0m[35m      end:[0m
[30;1m46 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1507[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_alert.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m        default: ''[0m
[30;1m26 | [0m[35msources:[0m
[30;1m27 | [0m[35m  list_alerts:[0m
[30;1m28 | [0m[35m    description: Returns security alerts for a given time range[0m
[30;1m29 | [0m[35m    metadata:[0m
[30;1m30 | [0m[35m    args:[0m
[30;1m31 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m1508[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_az_dns.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m        {add_query_items}'[0m
[30;1m79 | [0m[35m    parameters:[0m
[30;1m80 | [0m[35m      ip_address:[0m
[30;1m81 | [0m[35m        description: IP source for lookup queries[0m

[31m--[ [0m[34mMatch #[0m[33m1509[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_az_dns.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        description: IP lookup result to query for[0m
[30;1m63 | [0m[35m        type: str[0m
[30;1m64 | [0m[35m  dns_lookups_from_ip:[0m
[30;1m65 | [0m[35m    description: Returns Dns queries originating from a specified IP address[0m
[30;1m66 | [0m[35m    metadata:[0m
[30;1m67 | [0m[35m      pivot:[0m
[30;1m68 | [0m[35m        short_name: queries_from_ip[0m

[31m--[ [0m[34mMatch #[0m[33m1510[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_az_dns.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m        {add_query_items}'[0m
[30;1m60 | [0m[35m    parameters:[0m
[30;1m61 | [0m[35m      ip_address:[0m
[30;1m62 | [0m[35m        description: IP lookup result to query for[0m
[30;1m63 | [0m[35m        type: str[0m
[30;1m64 | [0m[35m  dns_lookups_from_ip:[0m
[30;1m65 | [0m[35m    description: Returns Dns queries originating from a specified IP address[0m

[31m--[ [0m[34mMatch #[0m[33m1511[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_az_dns.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m        description: Domain to query for[0m
[30;1m44 | [0m[35m        type: str[0m
[30;1m45 | [0m[35m  dns_lookups_for_ip:[0m
[30;1m46 | [0m[35m    description: Returns Dns query events that contain a resolved IP address[0m
[30;1m47 | [0m[35m    metadata:[0m
[30;1m48 | [0m[35m      pivot:[0m
[30;1m49 | [0m[35m        short_name: queries[0m

[31m--[ [0m[34mMatch #[0m[33m1512[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_az_dns.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m
[30;1m20 | [0m[35m        type: datetime[0m
[30;1m21 | [0m[35m      add_query_items:[0m
[30;1m22 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1513[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_az_dns.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m        type: str[0m
[30;1m14 | [0m[35m        default: DnsEvents[0m
[30;1m15 | [0m[35m      start:[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1514[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/file_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    def _select_search_file(self, change):[0m
[30;1m136 | [0m[35m        """Handle event for selection of file from search UI."""[0m
[30;1m137 | [0m[35m        self.file = change.get("new")[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    def _return_file(self, btn):[0m
[30;1m140 | [0m[35m        """Execute callback on selected file if one is defined."""[0m

[31m--[ [0m[34mMatch #[0m[33m1515[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/file_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    def _select_file(self, change):[0m
[30;1m131 | [0m[35m        """Handle event from select file button."""[0m
[30;1m132 | [0m[35m        selected_file = change.get("new")[0m
[30;1m133 | [0m[35m        self.file = str(Path(self.current_folder).joinpath(selected_file).resolve())[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    def _select_search_file(self, change):[0m

[31m--[ [0m[34mMatch #[0m[33m1516[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m87 | [0m[35m        self._preprocessors.processors.pop("hostname")[0m
[30;1m88 | [0m[35m        self._preprocessors.processors.pop("ipv4")[0m
[30;1m89 | [0m[35m        self._preprocessors.processors.pop("ipv6")[0m
[30;1m90 | [0m[35m        self._preprocessors.add_check("hostname", _validate_hostname)[0m
[30;1m91 | [0m[35m        self._preprocessors.add_check("ipv4", _validate_ip)[0m
[30;1m92 | [0m[35m        self._preprocessors.add_check("ipv6", _validate_ip)[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1517[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m87 | [0m[35m        self._preprocessors.processors.pop("hostname")[0m
[30;1m88 | [0m[35m        self._preprocessors.processors.pop("ipv4")[0m
[30;1m89 | [0m[35m        self._preprocessors.processors.pop("ipv6")[0m
[30;1m90 | [0m[35m        self._preprocessors.add_check("hostname", _validate_hostname)[0m
[30;1m91 | [0m[35m        self._preprocessors.add_check("ipv4", _validate_ip)[0m
[30;1m92 | [0m[35m        self._preprocessors.add_check("ipv6", _validate_ip)[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1518[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m84 | [0m[35m    def __init__(self: ContextProvider) -> None:[0m
[30;1m85 | [0m[35m        """Initialize Context provider."""[0m
[30;1m86 | [0m[35m        super().__init__()[0m
[30;1m87 | [0m[35m        self._preprocessors.processors.pop("hostname")[0m
[30;1m88 | [0m[35m        self._preprocessors.processors.pop("ipv4")[0m
[30;1m89 | [0m[35m        self._preprocessors.processors.pop("ipv6")[0m
[30;1m90 | [0m[35m        self._preprocessors.add_check("hostname", _validate_hostname)[0m

[31m--[ [0m[34mMatch #[0m[33m1519[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m48 | [0m[35m    if not match_hostname:[0m
[30;1m49 | [0m[35m        return SanitizedObservable(None, "Unrecognized hostname")[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    return SanitizedObservable(match_hostname.group(0), "ok")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mdef _validate_ip([0m

[31m--[ [0m[34mMatch #[0m[33m1520[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m46 | [0m[35m        re.IGNORECASE | re.VERBOSE | re.MULTILINE,[0m
[30;1m47 | [0m[35m    ).search(hostname)[0m
[30;1m48 | [0m[35m    if not match_hostname:[0m
[30;1m49 | [0m[35m        return SanitizedObservable(None, "Unrecognized hostname")[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    return SanitizedObservable(match_hostname.group(0), "ok")[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1521[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m45 | [0m[35m        HOSTNAME_REGEX,[0m
[30;1m46 | [0m[35m        re.IGNORECASE | re.VERBOSE | re.MULTILINE,[0m
[30;1m47 | [0m[35m    ).search(hostname)[0m
[30;1m48 | [0m[35m    if not match_hostname:[0m
[30;1m49 | [0m[35m        return SanitizedObservable(None, "Unrecognized hostname")[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    return SanitizedObservable(match_hostname.group(0), "ok")[0m

[31m--[ [0m[34mMatch #[0m[33m1522[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m44 | [0m[35m    match_hostname: re.Match | None = re.compile([0m
[30;1m45 | [0m[35m        HOSTNAME_REGEX,[0m
[30;1m46 | [0m[35m        re.IGNORECASE | re.VERBOSE | re.MULTILINE,[0m
[30;1m47 | [0m[35m    ).search(hostname)[0m
[30;1m48 | [0m[35m    if not match_hostname:[0m
[30;1m49 | [0m[35m        return SanitizedObservable(None, "Unrecognized hostname")[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1523[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef _validate_hostname(hostname: str) -> SanitizedObservable:[0m
[30;1m43 | [0m[35m    """Validate that parameter is a valid hostname."""[0m
[30;1m44 | [0m[35m    match_hostname: re.Match | None = re.compile([0m
[30;1m45 | [0m[35m        HOSTNAME_REGEX,[0m
[30;1m46 | [0m[35m        re.IGNORECASE | re.VERBOSE | re.MULTILINE,[0m
[30;1m47 | [0m[35m    ).search(hostname)[0m

[31m--[ [0m[34mMatch #[0m[33m1524[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef _validate_hostname(hostname: str) -> SanitizedObservable:[0m
[30;1m43 | [0m[35m    """Validate that parameter is a valid hostname."""[0m
[30;1m44 | [0m[35m    match_hostname: re.Match | None = re.compile([0m
[30;1m45 | [0m[35m        HOSTNAME_REGEX,[0m
[30;1m46 | [0m[35m        re.IGNORECASE | re.VERBOSE | re.MULTILINE,[0m

[31m--[ [0m[34mMatch #[0m[33m1525[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m39 | [0m[35m)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef _validate_hostname(hostname: str) -> SanitizedObservable:[0m
[30;1m43 | [0m[35m    """Validate that parameter is a valid hostname."""[0m
[30;1m44 | [0m[35m    match_hostname: re.Match | None = re.compile([0m
[30;1m45 | [0m[35m        HOSTNAME_REGEX,[0m

[31m--[ [0m[34mMatch #[0m[33m1526[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m39 | [0m[35m)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef _validate_hostname(hostname: str) -> SanitizedObservable:[0m
[30;1m43 | [0m[35m    """Validate that parameter is a valid hostname."""[0m
[30;1m44 | [0m[35m    match_hostname: re.Match | None = re.compile([0m
[30;1m45 | [0m[35m        HOSTNAME_REGEX,[0m

[31m--[ [0m[34mMatch #[0m[33m1527[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/context_provider_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m    ipaddress: str,[0m
[30;1m56 | [0m[35m    version: int = 4,[0m
[30;1m57 | [0m[35m) -> SanitizedObservable:[0m
[30;1m58 | [0m[35m    """Ensure Ip address is a valid public IPv4 address."""[0m
[30;1m59 | [0m[35m    try:[0m
[30;1m60 | [0m[35m        addr: IPv4Address | IPv6Address = ip_address(ipaddress)[0m
[30;1m61 | [0m[35m    except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m1528[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/anomalous.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m176 | [0m[35m           Cmd(name='Set-Mailbox',[0m
[30;1m177 | [0m[35m           params={'Identity': 'blahblah', 'AuditEnabled': 'false'})][0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m        The Cmd datatype can be accessed from[0m
[30;1m180 | [0m[35m        seqeunce.utils.data_structures.Cmd[0m
[30;1m181 | [0m[35m    window_length: int[0m
[30;1m182 | [0m[35m        length of the sliding window to use when computing the[0m

[31m--[ [0m[34mMatch #[0m[33m1529[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/anomalous.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m163 | [0m[35m    Parameters[0m
[30;1m164 | [0m[35m    ----------[0m
[30;1m165 | [0m[35m    data: pd.DataFrame[0m
[30;1m166 | [0m[35m        Dataframe which contains at least columns for time and sessions[0m
[30;1m167 | [0m[35m    session_column: str[0m
[30;1m168 | [0m[35m        name of the column which contains the sessions[0m
[30;1m169 | [0m[35m        The values in the session column should take one of the following formats:[0m

[31m--[ [0m[34mMatch #[0m[33m1530[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/anomalous.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m119 | [0m[35m    """[0m
[30;1m120 | [0m[35m    scored_sessions = data_with_scores.copy()  # so we don't affect input dataframe[0m
[30;1m121 | [0m[35m    scored_sessions[window_column] = scored_sessions[window_column].apply([0m
[30;1m122 | [0m[35m        lambda x: [str(cmd) for cmd in x][0m
[30;1m123 | [0m[35m    )  # so it[0m
[30;1m124 | [0m[35m    # becomes json serializable for the figure[0m
[30;1m125 | [0m[35m    scored_sessions["time_col"] = scored_sessions[time_column].astype([0m

[31m--[ [0m[34mMatch #[0m[33m1531[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/anomalous.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m    Parameters[0m
[30;1m92 | [0m[35m    ----------[0m
[30;1m93 | [0m[35m    data_with_scores: pd.DataFrame[0m
[30;1m94 | [0m[35m        Dataframe which contains at least columns for time,[0m
[30;1m95 | [0m[35m        session score, window representing the session[0m
[30;1m96 | [0m[35m    time_column: str[0m
[30;1m97 | [0m[35m        name of the column which contains a timestamp[0m

[31m--[ [0m[34mMatch #[0m[33m1532[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/anomalous.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m38 | [0m[35m           Cmd(name='Set-Mailbox',[0m
[30;1m39 | [0m[35m           params={'Identity': 'blahblah', 'AuditEnabled': 'false'})][0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        The Cmd datatype can be accessed from[0m
[30;1m42 | [0m[35m        anomalous_sequence.utils.data_structures.Cmd[0m
[30;1m43 | [0m[35m    window_length: int[0m
[30;1m44 | [0m[35m        length of the sliding window to use when computing the likelihood[0m

[31m--[ [0m[34mMatch #[0m[33m1533[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/anomalous.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m    Parameters[0m
[30;1m26 | [0m[35m    ----------[0m
[30;1m27 | [0m[35m    data: pd.DataFrame[0m
[30;1m28 | [0m[35m        Dataframe which contains at least a column for sessions[0m
[30;1m29 | [0m[35m    session_column: str[0m
[30;1m30 | [0m[35m        name of the column which contains the sessions[0m
[30;1m31 | [0m[35m        The values in the session column should take one of the following formats:[0m

[31m--[ [0m[34mMatch #[0m[33m1534[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/anomalous.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m    Parameters[0m
[30;1m164 | [0m[35m    ----------[0m
[30;1m165 | [0m[35m    data: pd.DataFrame[0m
[30;1m166 | [0m[35m        Dataframe which contains at least columns for time and sessions[0m
[30;1m167 | [0m[35m    session_column: str[0m
[30;1m168 | [0m[35m        name of the column which contains the sessions[0m
[30;1m169 | [0m[35m        The values in the session column should take one of the following formats:[0m

[31m--[ [0m[34mMatch #[0m[33m1535[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/anomalous.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m157 | [0m[35m    Model sessions and then produces an interactive timeline visualisation plot.[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    In particular, the sessions are modelled using a sliding window approach[0m
[30;1m160 | [0m[35m    within a markov model. The visualisation plot has time on the x-axis and[0m
[30;1m161 | [0m[35m    the modelled session likelihood metric on the y-axis.[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m1536[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m547 | [0m[35m    auth_index = {meth: idx for idx, meth in enumerate(current_methods)}[0m
[30;1m548 | [0m[35m    msi_lower_than_cli = auth_index.get("msi", 99) > auth_index.get("cli", 99)[0m
[30;1m549 | [0m[35m    msi_lower_than_devcode = auth_index.get("msi", 99) > auth_index.get([0m
[30;1m550 | [0m[35m        "devicecode", auth_index.get("device_code", 99)[0m
[30;1m551 | [0m[35m    )[0m
[30;1m552 | [0m[35m    if msi_lower_than_cli or msi_lower_than_devcode:[0m
[30;1m553 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m1537[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m        return[0m
[30;1m547 | [0m[35m    auth_index = {meth: idx for idx, meth in enumerate(current_methods)}[0m
[30;1m548 | [0m[35m    msi_lower_than_cli = auth_index.get("msi", 99) > auth_index.get("cli", 99)[0m
[30;1m549 | [0m[35m    msi_lower_than_devcode = auth_index.get("msi", 99) > auth_index.get([0m
[30;1m550 | [0m[35m        "devicecode", auth_index.get("device_code", 99)[0m
[30;1m551 | [0m[35m    )[0m
[30;1m552 | [0m[35m    if msi_lower_than_cli or msi_lower_than_devcode:[0m

[31m--[ [0m[34mMatch #[0m[33m1538[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m        return[0m
[30;1m547 | [0m[35m    auth_index = {meth: idx for idx, meth in enumerate(current_methods)}[0m
[30;1m548 | [0m[35m    msi_lower_than_cli = auth_index.get("msi", 99) > auth_index.get("cli", 99)[0m
[30;1m549 | [0m[35m    msi_lower_than_devcode = auth_index.get("msi", 99) > auth_index.get([0m
[30;1m550 | [0m[35m        "devicecode", auth_index.get("device_code", 99)[0m
[30;1m551 | [0m[35m    )[0m
[30;1m552 | [0m[35m    if msi_lower_than_cli or msi_lower_than_devcode:[0m

[31m--[ [0m[34mMatch #[0m[33m1539[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m545 | [0m[35m    if not current_methods:[0m
[30;1m546 | [0m[35m        return[0m
[30;1m547 | [0m[35m    auth_index = {meth: idx for idx, meth in enumerate(current_methods)}[0m
[30;1m548 | [0m[35m    msi_lower_than_cli = auth_index.get("msi", 99) > auth_index.get("cli", 99)[0m
[30;1m549 | [0m[35m    msi_lower_than_devcode = auth_index.get("msi", 99) > auth_index.get([0m
[30;1m550 | [0m[35m        "devicecode", auth_index.get("device_code", 99)[0m
[30;1m551 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1540[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m545 | [0m[35m    if not current_methods:[0m
[30;1m546 | [0m[35m        return[0m
[30;1m547 | [0m[35m    auth_index = {meth: idx for idx, meth in enumerate(current_methods)}[0m
[30;1m548 | [0m[35m    msi_lower_than_cli = auth_index.get("msi", 99) > auth_index.get("cli", 99)[0m
[30;1m549 | [0m[35m    msi_lower_than_devcode = auth_index.get("msi", 99) > auth_index.get([0m
[30;1m550 | [0m[35m        "devicecode", auth_index.get("device_code", 99)[0m
[30;1m551 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1541[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m418 | [0m[35m    vm_metadata = _get_vm_metadata()[0m
[30;1m419 | [0m[35m    if vm_metadata and "instance" in vm_metadata:[0m
[30;1m420 | [0m[35m        return ([0m
[30;1m421 | [0m[35m            f"https://{vm_metadata.get('instance')}.{vm_metadata.get('domainsuffix')}"[0m
[30;1m422 | [0m[35m        )[0m
[30;1m423 | [0m[35m    return ""[0m
[30;1m424 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1542[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m418 | [0m[35m    vm_metadata = _get_vm_metadata()[0m
[30;1m419 | [0m[35m    if vm_metadata and "instance" in vm_metadata:[0m
[30;1m420 | [0m[35m        return ([0m
[30;1m421 | [0m[35m            f"https://{vm_metadata.get('instance')}.{vm_metadata.get('domainsuffix')}"[0m
[30;1m422 | [0m[35m        )[0m
[30;1m423 | [0m[35m    return ""[0m
[30;1m424 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1543[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35mdef _set_mpconfig_var():[0m
[30;1m378 | [0m[35m    """Set MSTICPYCONFIG to file in user directory if no other found."""[0m
[30;1m379 | [0m[35m    mp_path_val = os.environ.get(MP_ENV_VAR)[0m
[30;1m380 | [0m[35m    if ([0m
[30;1m381 | [0m[35m        # If a valid MSTICPYCONFIG value is found - return[0m
[30;1m382 | [0m[35m        (mp_path_val and Path(mp_path_val).is_file())[0m

[31m--[ [0m[34mMatch #[0m[33m1544[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m    # Use the release ver specified in params, in the environment or[0m
[30;1m310 | [0m[35m    # the notebook default.[0m
[30;1m311 | [0m[35m    pkg_version = _get_pkg_version(min_mp_ver)[0m
[30;1m312 | [0m[35m    mp_install_version = mp_release or os.environ.get("MP_TEST_VER") or str(pkg_version)[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m    check_mp_ver(min_msticpy_ver=mp_install_version, extras=extras)[0m
[30;1m315 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1545[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m    mp_config_convert = MpConfigFile(file=config_json)[0m
[30;1m271 | [0m[35m    azs_settings = mp_config_convert.map_json_to_mp_ws()[0m
[30;1m272 | [0m[35m    def_azs_settings = next([0m
[30;1m273 | [0m[35m        iter(azs_settings.get("AzureSentinel", {}).get("Workspaces", {}).values())[0m
[30;1m274 | [0m[35m    )[0m
[30;1m275 | [0m[35m    if def_azs_settings:[0m
[30;1m276 | [0m[35m        mp_config_convert.settings["AzureSentinel"]["Workspaces"][[0m

[31m--[ [0m[34mMatch #[0m[33m1546[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m    mp_config_convert = MpConfigFile(file=config_json)[0m
[30;1m271 | [0m[35m    azs_settings = mp_config_convert.map_json_to_mp_ws()[0m
[30;1m272 | [0m[35m    def_azs_settings = next([0m
[30;1m273 | [0m[35m        iter(azs_settings.get("AzureSentinel", {}).get("Workspaces", {}).values())[0m
[30;1m274 | [0m[35m    )[0m
[30;1m275 | [0m[35m    if def_azs_settings:[0m
[30;1m276 | [0m[35m        mp_config_convert.settings["AzureSentinel"]["Workspaces"][[0m

[31m--[ [0m[34mMatch #[0m[33m1547[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mdef is_in_aml():[0m
[30;1m88 | [0m[35m    """Return True if running in Azure Machine Learning."""[0m
[30;1m89 | [0m[35m    return os.environ.get("APPSETTING_WEBSITE_SITE_NAME") == "AMLComputeInstance"[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef check_aml_settings([0m

[31m--[ [0m[34mMatch #[0m[33m1548[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mdef is_in_aml_pyspark():[0m
[30;1m83 | [0m[35m    """Return True if running in Spark on Azure Machine Learning."""[0m
[30;1m84 | [0m[35m    return os.environ.get("AZUREML_FRAMEWORK") == "PySpark"[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mdef is_in_aml():[0m

[31m--[ [0m[34mMatch #[0m[33m1549[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35mdef _check_azure_cli_status():[0m
[30;1m493 | [0m[35m    """Check for Azure CLI credentials."""[0m
[30;1m494 | [0m[35m    # import these only if we need them at runtime[0m
[30;1m495 | [0m[35m    # pylint: disable=import-outside-toplevel[0m
[30;1m496 | [0m[35m    from ..auth.azure_auth_core import AzureCliStatus, check_cli_credentials[0m
[30;1m497 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1550[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m283 | [0m[35m        mp_config_settings = yaml.safe_load(mp_config_text)[0m
[30;1m284 | [0m[35m        # update exist settings with the AzSent settings from config.json[0m
[30;1m285 | [0m[35m        mp_config_settings.update(mp_config_convert.settings)[0m
[30;1m286 | [0m[35m        # update MpConfigFile with the merged settings[0m
[30;1m287 | [0m[35m        mp_config_convert.settings = mp_config_settings[0m
[30;1m288 | [0m[35m        mssg = ([0m
[30;1m289 | [0m[35m            f"Updated '{mp_path}' with Microsoft Sentinel settings"[0m

[31m--[ [0m[34mMatch #[0m[33m1551[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m281 | [0m[35m        # If there is an existing file read it in[0m
[30;1m282 | [0m[35m        mp_config_text = Path(mp_path).read_text(encoding="utf-8")[0m
[30;1m283 | [0m[35m        mp_config_settings = yaml.safe_load(mp_config_text)[0m
[30;1m284 | [0m[35m        # update exist settings with the AzSent settings from config.json[0m
[30;1m285 | [0m[35m        mp_config_settings.update(mp_config_convert.settings)[0m
[30;1m286 | [0m[35m        # update MpConfigFile with the merged settings[0m
[30;1m287 | [0m[35m        mp_config_convert.settings = mp_config_settings[0m

[31m--[ [0m[34mMatch #[0m[33m1552[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35mdef check_mp_ver(min_msticpy_ver: Union[str, Tuple], extras: Optional[List[str]]):[0m
[30;1m205 | [0m[35m    """[0m
[30;1m206 | [0m[35m    Check and optionally update the current version of msticpy.[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    Parameters[0m
[30;1m209 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1553[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m472 | [0m[35m        if not ip_shell:[0m
[30;1m473 | [0m[35m            return[0m
[30;1m474 | [0m[35m        apt_list = ip_shell.run_line_magic("sx", "apt list")[0m
[30;1m475 | [0m[35m        apt_list = [apt.split("/", maxsplit=1)[0] for apt in apt_list][0m
[30;1m476 | [0m[35m        missing_lx_pkg = [[0m
[30;1m477 | [0m[35m            apt_pkg[0m
[30;1m478 | [0m[35m            for apt_pkg in ("libgirepository1.0-dev", "gir1.2-secret-1")[0m

[31m--[ [0m[34mMatch #[0m[33m1554[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m452 | [0m[35m        # source ./env_path/scripts/activate[0m
[30;1m453 | [0m[35m[0m
[30;1m454 | [0m[35m        # Uninstall enum34[0m
[30;1m455 | [0m[35m        python -m pip uninstall enum34[0m
[30;1m456 | [0m[35m        # Install pygobject[0m
[30;1m457 | [0m[35m        python -m install pygobject[0m
[30;1m458 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1555[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m        # Install the libgi dependency[0m
[30;1m447 | [0m[35m        sudo apt install libgirepository1.0-dev[0m
[30;1m448 | [0m[35m        sudo apt install gir1.2-secret-1[0m
[30;1m449 | [0m[35m[0m
[30;1m450 | [0m[35m        # activate the environment[0m
[30;1m451 | [0m[35m        # conda activate azureml_py38[0m

[31m--[ [0m[34mMatch #[0m[33m1556[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m444 | [0m[35m    using prior to running the pip commands.[0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m        # Install the libgi dependency[0m
[30;1m447 | [0m[35m        sudo apt install libgirepository1.0-dev[0m
[30;1m448 | [0m[35m        sudo apt install gir1.2-secret-1[0m
[30;1m449 | [0m[35m[0m
[30;1m450 | [0m[35m        # activate the environment[0m

[31m--[ [0m[34mMatch #[0m[33m1557[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m    You can also do this from a terminal - but ensure that you've[0m
[30;1m443 | [0m[35m    activated the environment corresponding to the kernel you are[0m
[30;1m444 | [0m[35m    using prior to running the pip commands.[0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m        # Install the libgi dependency[0m
[30;1m447 | [0m[35m        sudo apt install libgirepository1.0-dev[0m

[31m--[ [0m[34mMatch #[0m[33m1558[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m436 | [0m[35m[0m
[30;1m437 | [0m[35m        %pip uninstall enum34[0m
[30;1m438 | [0m[35m        !sudo apt-get --yes install libgirepository1.0-dev[0m
[30;1m439 | [0m[35m        !sudo apt-get --yes install gir1.2-secret-1[0m
[30;1m440 | [0m[35m        %pip install pygobject[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m    You can also do this from a terminal - but ensure that you've[0m

[31m--[ [0m[34mMatch #[0m[33m1559[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m435 | [0m[35m    From a notebook run:[0m
[30;1m436 | [0m[35m[0m
[30;1m437 | [0m[35m        %pip uninstall enum34[0m
[30;1m438 | [0m[35m        !sudo apt-get --yes install libgirepository1.0-dev[0m
[30;1m439 | [0m[35m        !sudo apt-get --yes install gir1.2-secret-1[0m
[30;1m440 | [0m[35m        %pip install pygobject[0m
[30;1m441 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1560[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m389 | [0m[35m    if user_dir:[0m
[30;1m390 | [0m[35m        mp_path = Path(user_dir).joinpath(MP_FILE)[0m
[30;1m391 | [0m[35m        if mp_path.is_file():[0m
[30;1m392 | [0m[35m            # If there's a file there, set the env variable to that.[0m
[30;1m393 | [0m[35m            os.environ[MP_ENV_VAR] = str(mp_path)[0m
[30;1m394 | [0m[35m            # Since we have already imported msticpy to check the version[0m
[30;1m395 | [0m[35m            # it will have already configured settings so we need to refresh.[0m

[31m--[ [0m[34mMatch #[0m[33m1561[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/azure_ml_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m353 | [0m[35m    path_parts = Path(".").absolute().parts[0m
[30;1m354 | [0m[35m    if "Users" not in path_parts:[0m
[30;1m355 | [0m[35m        return Path(_HOME_PATH).expanduser()[0m
[30;1m356 | [0m[35m    # find the index of the last occurrence of "users"[0m
[30;1m357 | [0m[35m    users_idx = len(path_parts) - path_parts[::-1].index("Users")[0m
[30;1m358 | [0m[35m    # the user folder is one item below this[0m
[30;1m359 | [0m[35m    if len(path_parts) < users_idx + 1:[0m

[31m--[ [0m[34mMatch #[0m[33m1562[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_timeseries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m            | render timechart with (title="Time Series Decomposition - Baseline vs Observed TimeCha[0m
[30;1m103 | [0m[35m            '[0m
[30;1m104 | [0m[35m  plot_timeseries_scoreanomolies:[0m
[30;1m105 | [0m[35m    description: Plot Time Series anomaly score using native KQL render (KQLMagic only)[0m
[30;1m106 | [0m[35m    args:[0m
[30;1m107 | [0m[35m      query: '[0m
[30;1m108 | [0m[35m            {table}[0m

[31m--[ [0m[34mMatch #[0m[33m1563[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_timeseries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m            | extend score = round(score,2)[0m
[30;1m88 | [0m[35m            {add_query_items}'[0m
[30;1m89 | [0m[35m  plot_timeseries_datawithbaseline:[0m
[30;1m90 | [0m[35m    description: Plot of Time Series data using native KQL analysis and plot rendering (KQLMagic onl[0m
[30;1m91 | [0m[35m    args:[0m
[30;1m92 | [0m[35m      query: '[0m
[30;1m93 | [0m[35m            {table}[0m

[31m--[ [0m[34mMatch #[0m[33m1564[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_timeseries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m            | mv-expand {aggregatecolumn} to typeof(double), {timestampcolumn} to typeof(datetime), [0m
[30;1m74 | [0m[35m            {add_query_items}'[0m
[30;1m75 | [0m[35m  get_timeseries_anomalies:[0m
[30;1m76 | [0m[35m    description: Time Series filtered anomalies using native KQL analysis (series_decompose_anomalie[0m
[30;1m77 | [0m[35m    args:[0m
[30;1m78 | [0m[35m      query: '[0m
[30;1m79 | [0m[35m            {table}[0m

[31m--[ [0m[34mMatch #[0m[33m1565[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_timeseries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m            | make-series {aggregatecolumn}={aggregatefunction} on {timestampcolumn} from datetime({[0m
[30;1m61 | [0m[35m            {add_query_items}'[0m
[30;1m62 | [0m[35m  get_timeseries_decompose:[0m
[30;1m63 | [0m[35m    description: Generic Time Series decomposition using native KQL analysis (series_decompose)[0m
[30;1m64 | [0m[35m    args:[0m
[30;1m65 | [0m[35m      query: '[0m
[30;1m66 | [0m[35m            {table}[0m

[31m--[ [0m[34mMatch #[0m[33m1566[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_timeseries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m        default: 'count()'[0m
[30;1m50 | [0m[35msources:[0m
[30;1m51 | [0m[35m  get_timeseries_data:[0m
[30;1m52 | [0m[35m    description: Generic query to return TimeSeriesData for use with native KQL time series function[0m
[30;1m53 | [0m[35m    args:[0m
[30;1m54 | [0m[35m      query: '[0m
[30;1m55 | [0m[35m            {table}[0m

[31m--[ [0m[34mMatch #[0m[33m1567[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_timeseries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m        description: Query start time[0m
[30;1m14 | [0m[35m        type: datetime[0m
[30;1m15 | [0m[35m      end:[0m
[30;1m16 | [0m[35m        description: Query end time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      timeframe:[0m
[30;1m19 | [0m[35m        description: Aggregation TimeFrame[0m

[31m--[ [0m[34mMatch #[0m[33m1568[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_timeseries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m        description: Table name[0m
[30;1m11 | [0m[35m        type: str[0m
[30;1m12 | [0m[35m      start:[0m
[30;1m13 | [0m[35m        description: Query start time[0m
[30;1m14 | [0m[35m        type: datetime[0m
[30;1m15 | [0m[35m      end:[0m
[30;1m16 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1569[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_threatintel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        {add_query_items}'[0m
[30;1m66 | [0m[35m    parameters:[0m
[30;1m67 | [0m[35m      ip_address_list:[0m
[30;1m68 | [0m[35m        description: Ip Address to query for[0m
[30;1m69 | [0m[35m        type: list[0m
[30;1m70 | [0m[35m        aliases:[0m
[30;1m71 | [0m[35m          - observables[0m

[31m--[ [0m[34mMatch #[0m[33m1570[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_threatintel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m        {add_query_items}'[0m
[30;1m41 | [0m[35m      uri: None[0m
[30;1m42 | [0m[35m  list_indicators_by_ip:[0m
[30;1m43 | [0m[35m    description: Returns list of indicators by IP Address[0m
[30;1m44 | [0m[35m    metadata:[0m
[30;1m45 | [0m[35m    args:[0m
[30;1m46 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m1571[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_threatintel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m        description: Query start time[0m
[30;1m21 | [0m[35m        type: datetime[0m
[30;1m22 | [0m[35m      end:[0m
[30;1m23 | [0m[35m        description: Query end time[0m
[30;1m24 | [0m[35m        type: datetime[0m
[30;1m25 | [0m[35m      add_query_items:[0m
[30;1m26 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1572[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_threatintel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m        type: str[0m
[30;1m18 | [0m[35m        default: ''[0m
[30;1m19 | [0m[35m      start:[0m
[30;1m20 | [0m[35m        description: Query start time[0m
[30;1m21 | [0m[35m        type: datetime[0m
[30;1m22 | [0m[35m      end:[0m
[30;1m23 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1573[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m609 | [0m[35m            opt_v_opts = {"required": "required=False" not in opt_dict[v_key]}[0m
[30;1m610 | [0m[35m            # get the validator function for the option type and use that[0m
[30;1m611 | [0m[35m            # to check the actual value[0m
[30;1m612 | [0m[35m            _validator = _VALIDATORS.get(opt_v_type, _validate_string)[0m
[30;1m613 | [0m[35m            return _validator(v_val, f"{path}.{v_key}", opt_v_type, opt_v_opts)[0m
[30;1m614 | [0m[35m    # Otherwise the validation failed[0m
[30;1m615 | [0m[35m    return ValidationResult([0m

[31m--[ [0m[34mMatch #[0m[33m1574[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m586 | [0m[35m        return ValidationResult(True, f"{_VALID_SUCCESS} {mssg}")[0m
[30;1m587 | [0m[35m[0m
[30;1m588 | [0m[35m    # This only handles "one_of" lists of alternatives[0m
[30;1m589 | [0m[35m    opt_list = val_opts.get("defn", {}).get("one_of")[0m
[30;1m590 | [0m[35m    if not opt_list:[0m
[30;1m591 | [0m[35m        return ValidationResult(True, f"{_VALID_SUCCESS} {mssg}")[0m
[30;1m592 | [0m[35m    # pull the definitions (val_type and val_opts) for each item into a dict[0m

[31m--[ [0m[34mMatch #[0m[33m1575[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m586 | [0m[35m        return ValidationResult(True, f"{_VALID_SUCCESS} {mssg}")[0m
[30;1m587 | [0m[35m[0m
[30;1m588 | [0m[35m    # This only handles "one_of" lists of alternatives[0m
[30;1m589 | [0m[35m    opt_list = val_opts.get("defn", {}).get("one_of")[0m
[30;1m590 | [0m[35m    if not opt_list:[0m
[30;1m591 | [0m[35m        return ValidationResult(True, f"{_VALID_SUCCESS} {mssg}")[0m
[30;1m592 | [0m[35m    # pull the definitions (val_type and val_opts) for each item into a dict[0m

[31m--[ [0m[34mMatch #[0m[33m1576[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m553 | [0m[35m        return ValidationResult(True, f"{_VALID_SUCCESS} {mssg}")[0m
[30;1m554 | [0m[35m    if isinstance(value, list):[0m
[30;1m555 | [0m[35m        for item_val in value:[0m
[30;1m556 | [0m[35m            expected_type = val_opts.get("elem_type", "str")[0m
[30;1m557 | [0m[35m            val_type = type(item_val).__name__[0m
[30;1m558 | [0m[35m            if expected_type != val_type:[0m
[30;1m559 | [0m[35m                return ValidationResult([0m

[31m--[ [0m[34mMatch #[0m[33m1577[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m            False,[0m
[30;1m476 | [0m[35m            f"Value {value} must be one of {', '.join(val_opts['options'])} - {mssg}",[0m
[30;1m477 | [0m[35m        )[0m
[30;1m478 | [0m[35m    if val_opts.get("format") == "uuid" and not is_valid_uuid(value):[0m
[30;1m479 | [0m[35m        return ValidationResult([0m
[30;1m480 | [0m[35m            False,[0m
[30;1m481 | [0m[35m            f"Value {value} should be a UUID - {mssg}",[0m

[31m--[ [0m[34mMatch #[0m[33m1578[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35mdef _is_none_and_not_required(value, val_type, val_opts):[0m
[30;1m459 | [0m[35m    if value is None or (val_type == "str" and not value):[0m
[30;1m460 | [0m[35m        return not val_opts.get("required", True)[0m
[30;1m461 | [0m[35m    return False[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1579[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m381 | [0m[35m            defn_path = val_params.pop("mp_defn_path").strip(" /\"'").replace("/", ".")[0m
[30;1m382 | [0m[35m            defn = self._get_elem_from_path(defn_path, self._raw_config_defn)[0m
[30;1m383 | [0m[35m            val_params["defn"] = defn[0m
[30;1m384 | [0m[35m        default_val = val_params.get("default", "")[0m
[30;1m385 | [0m[35m        if isinstance(default_val, str):[0m
[30;1m386 | [0m[35m            if default_val.strip().startswith("["):[0m
[30;1m387 | [0m[35m                # This is a default list - so we need to parse it[0m

[31m--[ [0m[34mMatch #[0m[33m1580[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m            r"(?P<type>[^()]+)\((?P<params>.*)\)$", conf_val.strip()[0m
[30;1m359 | [0m[35m        )[0m
[30;1m360 | [0m[35m        val_type = val_type_match.groupdict().get("type")[0m
[30;1m361 | [0m[35m        val_param_str = val_type_match.groupdict().get("params", "")[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m        if val_param_str:[0m
[30;1m364 | [0m[35m            val_params = {[0m

[31m--[ [0m[34mMatch #[0m[33m1581[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m        val_type_match = re.match([0m
[30;1m358 | [0m[35m            r"(?P<type>[^()]+)\((?P<params>.*)\)$", conf_val.strip()[0m
[30;1m359 | [0m[35m        )[0m
[30;1m360 | [0m[35m        val_type = val_type_match.groupdict().get("type")[0m
[30;1m361 | [0m[35m        val_param_str = val_type_match.groupdict().get("params", "")[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m        if val_param_str:[0m

[31m--[ [0m[34mMatch #[0m[33m1582[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m        # definition[0m
[30;1m339 | [0m[35m        if isinstance(conf_defn, tuple):[0m
[30;1m340 | [0m[35m            val_type, val_opts = conf_defn[0m
[30;1m341 | [0m[35m            validator = _VALIDATORS.get(val_type)[0m
[30;1m342 | [0m[35m            if validator:[0m
[30;1m343 | [0m[35m                return validator(setting, path, val_type, val_opts)[0m
[30;1m344 | [0m[35m            return ValidationResult(True, "No validator for type '{val_type}'")[0m

[31m--[ [0m[34mMatch #[0m[33m1583[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m        tgt_key = new_path_elems[1][0m
[30;1m158 | [0m[35m        for setting_dict in (self.mp_config, self.controls):[0m
[30;1m159 | [0m[35m            parent_elem = self._get_elem_from_path(path_root, setting_dict)[0m
[30;1m160 | [0m[35m            parent_elem[tgt_key] = parent_elem.get(src_key)[0m
[30;1m161 | [0m[35m            if src_key in parent_elem:[0m
[30;1m162 | [0m[35m                del parent_elem[src_key][0m
[30;1m163 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1584[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m            tgt_key = path_elems[1][0m
[30;1m88 | [0m[35m            current_elem = member_dict[0m
[30;1m89 | [0m[35m            for elem in parent_path.split("."):[0m
[30;1m90 | [0m[35m                next_elem = current_elem.get(elem)[0m
[30;1m91 | [0m[35m                if next_elem is None:[0m
[30;1m92 | [0m[35m                    next_elem = {}[0m
[30;1m93 | [0m[35m                    current_elem[elem] = next_elem[0m

[31m--[ [0m[34mMatch #[0m[33m1585[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        paths = path.split(".")[0m
[30;1m62 | [0m[35m        current_elem = member_dict[0m
[30;1m63 | [0m[35m        for elem in paths:[0m
[30;1m64 | [0m[35m            next_elem = current_elem.get(elem)[0m
[30;1m65 | [0m[35m            if next_elem is None:[0m
[30;1m66 | [0m[35m                return next_elem[0m
[30;1m67 | [0m[35m            current_elem = next_elem[0m

[31m--[ [0m[34mMatch #[0m[33m1586[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m576 | [0m[35m                - EnvironmentVar: str()[0m
[30;1m577 | [0m[35m                - KeyVault: str(required=False)[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m    This only handles this type of definition and only looks at[0m
[30;1m580 | [0m[35m    the "required" flag in the options. We'll extend this checker if we[0m
[30;1m581 | [0m[35m    need to for other options.[0m
[30;1m582 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1587[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m# Supporting functions for MpConfigControls[0m
[30;1m454 | [0m[35mdef _get_mssg(value, path):[0m
[30;1m455 | [0m[35m    return f"value '{value}', for setting at path '{path}'"[0m
[30;1m456 | [0m[35m[0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35mdef _is_none_and_not_required(value, val_type, val_opts):[0m

[31m--[ [0m[34mMatch #[0m[33m1588[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m        # If the conf definition is a literal value - compare directly[0m
[30;1m347 | [0m[35m        if conf_defn == setting:[0m
[30;1m348 | [0m[35m            return ValidationResult(True, f"Value is valid at path '{path}'")[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m        # Otherwise, we assume failure.[0m
[30;1m351 | [0m[35m        return ValidationResult(False, f"Validation failed for path '{path}'")[0m

[31m--[ [0m[34mMatch #[0m[33m1589[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m307 | [0m[35m        # If this is None and we're not at a leaf setting it means the[0m
[30;1m308 | [0m[35m        # settings path doesn't exist, so bail here.[0m
[30;1m309 | [0m[35m        if not setting and not isinstance(conf_defn, tuple):[0m
[30;1m310 | [0m[35m            return ValidationResult(True, f"No setting at path '{path}'")[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m        # if the current defn node is a dict, then we need to recurse[0m
[30;1m313 | [0m[35m        # into it.[0m

[31m--[ [0m[34mMatch #[0m[33m1590[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m304 | [0m[35m        if not conf_defn:[0m
[30;1m305 | [0m[35m            return ValidationResult(True, f"No definition for path '{path}'")[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        # If this is None and we're not at a leaf setting it means the[0m
[30;1m308 | [0m[35m        # settings path doesn't exist, so bail here.[0m
[30;1m309 | [0m[35m        if not setting and not isinstance(conf_defn, tuple):[0m
[30;1m310 | [0m[35m            return ValidationResult(True, f"No setting at path '{path}'")[0m

[31m--[ [0m[34mMatch #[0m[33m1591[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m290 | [0m[35m    def _validate_setting_at_path([0m
[30;1m291 | [0m[35m        self, path: str, defn_path: Optional[str] = None, index: Optional[int] = None[0m
[30;1m292 | [0m[35m    ) -> Union[ValidationResult, List[Union[ValidationResult, List[Any]]]]:[0m
[30;1m293 | [0m[35m        """Recursively validate settings at path."""[0m
[30;1m294 | [0m[35m        defn_path = defn_path or path[0m
[30;1m295 | [0m[35m        conf_defn = self.get_defn(defn_path)[0m
[30;1m296 | [0m[35m        setting = self.get_value(path)[0m

[31m--[ [0m[34mMatch #[0m[33m1592[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m208 | [0m[35m        raise ValueError(f"No control found at path {path}")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def _create_ctrl_dict(self, config_dict):[0m
[30;1m211 | [0m[35m        """Create a blank control dictionary from settings."""[0m
[30;1m212 | [0m[35m        ctrl_dict = config_dict.copy()[0m
[30;1m213 | [0m[35m        for name, val in ctrl_dict.items():[0m
[30;1m214 | [0m[35m            if ([0m

[31m--[ [0m[34mMatch #[0m[33m1593[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m            return widget_to_py(ctrl_tree)[0m
[30;1m206 | [0m[35m        if isinstance(ctrl_tree, dict):[0m
[30;1m207 | [0m[35m            return {key: self._get_ctrl_values(f"{path}.{key}") for key in ctrl_tree}[0m
[30;1m208 | [0m[35m        raise ValueError(f"No control found at path {path}")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def _create_ctrl_dict(self, config_dict):[0m
[30;1m211 | [0m[35m        """Create a blank control dictionary from settings."""[0m

[31m--[ [0m[34mMatch #[0m[33m1594[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m            return widget_to_py(ctrl_tree)[0m
[30;1m206 | [0m[35m        if isinstance(ctrl_tree, dict):[0m
[30;1m207 | [0m[35m            return {key: self._get_ctrl_values(f"{path}.{key}") for key in ctrl_tree}[0m
[30;1m208 | [0m[35m        raise ValueError(f"No control found at path {path}")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def _create_ctrl_dict(self, config_dict):[0m
[30;1m211 | [0m[35m        """Create a blank control dictionary from settings."""[0m

[31m--[ [0m[34mMatch #[0m[33m1595[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m194 | [0m[35m        self.set_value(path, self._get_ctrl_values(path))[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    def _get_ctrl_values(self, path: str):[0m
[30;1m197 | [0m[35m        """Recursively save values in the control at `path` to settings."""[0m
[30;1m198 | [0m[35m        ctrl_tree = self.get_control(path)[0m
[30;1m199 | [0m[35m        print_debug([0m
[30;1m200 | [0m[35m            type(ctrl_tree),[0m

[31m--[ [0m[34mMatch #[0m[33m1596[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m190 | [0m[35m                self._set_ctrl_values(f"{path}.{key}")[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    def save_ctrl_values(self, path: str):[0m
[30;1m193 | [0m[35m        """Save the values in the control at `path` to settings."""[0m
[30;1m194 | [0m[35m        self.set_value(path, self._get_ctrl_values(path))[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    def _get_ctrl_values(self, path: str):[0m

[31m--[ [0m[34mMatch #[0m[33m1597[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m167 | [0m[35m        self._set_ctrl_values(path)[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    def _set_ctrl_values(self, path: str):[0m
[30;1m170 | [0m[35m        """Recursively set settings from control values."""[0m
[30;1m171 | [0m[35m        ctrl_tree = self.get_control(path)[0m
[30;1m172 | [0m[35m        if isinstance(ctrl_tree, widgets.Widget):[0m
[30;1m173 | [0m[35m            print_debug("_set_ctrl_values - widget", ctrl_tree)[0m

[31m--[ [0m[34mMatch #[0m[33m1598[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m162 | [0m[35m                del parent_elem[src_key][0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    def populate_ctrl_values(self, path: str):[0m
[30;1m165 | [0m[35m        """Populate control at `path` from settings at `path`."""[0m
[30;1m166 | [0m[35m        print_debug("populate_ctrl_values", path)[0m
[30;1m167 | [0m[35m        self._set_ctrl_values(path)[0m
[30;1m168 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1599[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m162 | [0m[35m                del parent_elem[src_key][0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    def populate_ctrl_values(self, path: str):[0m
[30;1m165 | [0m[35m        """Populate control at `path` from settings at `path`."""[0m
[30;1m166 | [0m[35m        print_debug("populate_ctrl_values", path)[0m
[30;1m167 | [0m[35m        self._set_ctrl_values(path)[0m
[30;1m168 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1600[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m130 | [0m[35m        self._del_elem_at_path(path, self.controls)[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    def get_defn(self, path: str) -> Union[Dict[str, Any], Tuple[str, Any]]:[0m
[30;1m133 | [0m[35m        """Return the setting definition at `path`."""[0m
[30;1m134 | [0m[35m        defn = self._get_elem_from_path(path, self.config_defn)[0m
[30;1m135 | [0m[35m        if defn is not None:[0m
[30;1m136 | [0m[35m            return defn[0m

[31m--[ [0m[34mMatch #[0m[33m1601[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m126 | [0m[35m        self._set_elem_at_path(path, self.controls, value=control)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    def del_control(self, path: str):[0m
[30;1m129 | [0m[35m        """Delete the control stored at `path`."""[0m
[30;1m130 | [0m[35m        self._del_elem_at_path(path, self.controls)[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    def get_defn(self, path: str) -> Union[Dict[str, Any], Tuple[str, Any]]:[0m

[31m--[ [0m[34mMatch #[0m[33m1602[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m126 | [0m[35m        self._set_elem_at_path(path, self.controls, value=control)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    def del_control(self, path: str):[0m
[30;1m129 | [0m[35m        """Delete the control stored at `path`."""[0m
[30;1m130 | [0m[35m        self._del_elem_at_path(path, self.controls)[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    def get_defn(self, path: str) -> Union[Dict[str, Any], Tuple[str, Any]]:[0m

[31m--[ [0m[34mMatch #[0m[33m1603[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35m        return self._get_elem_from_path(path, self.controls)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def set_control(self, path: str, control):[0m
[30;1m124 | [0m[35m        """Set the control stored at `path`."""[0m
[30;1m125 | [0m[35m        print_debug("set_control", path)[0m
[30;1m126 | [0m[35m        self._set_elem_at_path(path, self.controls, value=control)[0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1604[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35m        return self._get_elem_from_path(path, self.controls)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def set_control(self, path: str, control):[0m
[30;1m124 | [0m[35m        """Set the control stored at `path`."""[0m
[30;1m125 | [0m[35m        print_debug("set_control", path)[0m
[30;1m126 | [0m[35m        self._set_elem_at_path(path, self.controls, value=control)[0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1605[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m117 | [0m[35m            self.del_control(path)[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    def get_control(self, path: str) -> Any:[0m
[30;1m120 | [0m[35m        """Return the control stored at `path`."""[0m
[30;1m121 | [0m[35m        return self._get_elem_from_path(path, self.controls)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def set_control(self, path: str, control):[0m

[31m--[ [0m[34mMatch #[0m[33m1606[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m117 | [0m[35m            self.del_control(path)[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    def get_control(self, path: str) -> Any:[0m
[30;1m120 | [0m[35m        """Return the control stored at `path`."""[0m
[30;1m121 | [0m[35m        return self._get_elem_from_path(path, self.controls)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def set_control(self, path: str, control):[0m

[31m--[ [0m[34mMatch #[0m[33m1607[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m        self._set_elem_at_path(path, self.mp_config, value)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    def del_value(self, path: str, keep_ctrl: bool = False):[0m
[30;1m114 | [0m[35m        """Delete setting item at `path`."""[0m
[30;1m115 | [0m[35m        self._del_elem_at_path(path, self.mp_config)[0m
[30;1m116 | [0m[35m        if not keep_ctrl:[0m
[30;1m117 | [0m[35m            self.del_control(path)[0m

[31m--[ [0m[34mMatch #[0m[33m1608[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m107 | [0m[35m        return self._get_elem_from_path(path, self.mp_config)[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    def set_value(self, path: str, value: Any):[0m
[30;1m110 | [0m[35m        """Set setting value at path to `value`."""[0m
[30;1m111 | [0m[35m        self._set_elem_at_path(path, self.mp_config, value)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    def del_value(self, path: str, keep_ctrl: bool = False):[0m

[31m--[ [0m[34mMatch #[0m[33m1609[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m            del parent[tgt_key][0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def get_value(self, path: str) -> Any:[0m
[30;1m106 | [0m[35m        """Return setting value at `path`."""[0m
[30;1m107 | [0m[35m        return self._get_elem_from_path(path, self.mp_config)[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    def set_value(self, path: str, value: Any):[0m

[31m--[ [0m[34mMatch #[0m[33m1610[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m96 | [0m[35m            print_debug("set", parent_path, tgt_key, value)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def _del_elem_at_path(self, path: str, member_dict: Dict[str, Any]):[0m
[30;1m99 | [0m[35m        """Delete an item at `path`."""[0m
[30;1m100 | [0m[35m        parent_path, tgt_key = path.rsplit(".", maxsplit=1)[0m
[30;1m101 | [0m[35m        parent = self._get_elem_from_path(parent_path, member_dict)[0m
[30;1m102 | [0m[35m        if parent is not None and tgt_key in parent:[0m

[31m--[ [0m[34mMatch #[0m[33m1611[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m    def _set_elem_at_path([0m
[30;1m71 | [0m[35m        self, path: str, member_dict: Dict[str, Any], value: Any, create: bool = True[0m
[30;1m72 | [0m[35m    ):[0m
[30;1m73 | [0m[35m        """Set item at the path from `member_dict` to `value`."""[0m
[30;1m74 | [0m[35m        path_elems = path.rsplit(".", maxsplit=1)[0m
[30;1m75 | [0m[35m        parent_path = path_elems[0][0m
[30;1m76 | [0m[35m        parent = self._get_elem_from_path(parent_path, member_dict)[0m

[31m--[ [0m[34mMatch #[0m[33m1612[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    @staticmethod[0m
[30;1m59 | [0m[35m    def _get_elem_from_path(path, member_dict: Dict[str, Any]):[0m
[30;1m60 | [0m[35m        """Return an item at the path from `member_dict`."""[0m
[30;1m61 | [0m[35m        paths = path.split(".")[0m
[30;1m62 | [0m[35m        current_elem = member_dict[0m
[30;1m63 | [0m[35m        for elem in paths:[0m

[31m--[ [0m[34mMatch #[0m[33m1613[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m# Licensed under the MIT License. See License.txt in the project root for[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""MP Config Control Class."""[0m
[30;1m7 | [0m[35mimport pkgutil[0m
[30;1m8 | [0m[35mimport re[0m
[30;1m9 | [0m[35mfrom collections import namedtuple[0m

[31m--[ [0m[34mMatch #[0m[33m1614[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m            # first item in the definition list[0m
[30;1m335 | [0m[35m            conf_defn = conf_defn[0][0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m        # If the defn is a tuple we've reached a leaf node with a true[0m
[30;1m338 | [0m[35m        # definition[0m
[30;1m339 | [0m[35m        if isinstance(conf_defn, tuple):[0m
[30;1m340 | [0m[35m            val_type, val_opts = conf_defn[0m

[31m--[ [0m[34mMatch #[0m[33m1615[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m309 | [0m[35m        if not setting and not isinstance(conf_defn, tuple):[0m
[30;1m310 | [0m[35m            return ValidationResult(True, f"No setting at path '{path}'")[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m        # if the current defn node is a dict, then we need to recurse[0m
[30;1m313 | [0m[35m        # into it.[0m
[30;1m314 | [0m[35m        if isinstance(conf_defn, dict):[0m
[30;1m315 | [0m[35m            val_res = [[0m

[31m--[ [0m[34mMatch #[0m[33m1616[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_sysmon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m        description: Query start time[0m
[30;1m13 | [0m[35m        type: datetime[0m
[30;1m14 | [0m[35m      end:[0m
[30;1m15 | [0m[35m        description: Query end time[0m
[30;1m16 | [0m[35m        type: datetime[0m
[30;1m17 | [0m[35m      add_query_items:[0m
[30;1m18 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1617[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_sysmon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    data_source: 'linux_syslog'[0m
[30;1m10 | [0m[35m  parameters:[0m
[30;1m11 | [0m[35m      start:[0m
[30;1m12 | [0m[35m        description: Query start time[0m
[30;1m13 | [0m[35m        type: datetime[0m
[30;1m14 | [0m[35m      end:[0m
[30;1m15 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1618[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m282 | [0m[35m        type: str[0m
[30;1m283 | [0m[35m    query_macros:[0m
[30;1m284 | [0m[35m      query_condition:[0m
[30;1m285 | [0m[35m        description: IP Address where clause[0m
[30;1m286 | [0m[35m        value: '| where SyslogMessage has "{ip_address}"'[0m
[30;1m287 | [0m[35m  list_account_logon_failures:[0m
[30;1m288 | [0m[35m    description: All failed user logon events for account name[0m

[31m--[ [0m[34mMatch #[0m[33m1619[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m      query: *logon_failures[0m
[30;1m279 | [0m[35m    parameters:[0m
[30;1m280 | [0m[35m      ip_address:[0m
[30;1m281 | [0m[35m        description: Ip Address to query for[0m
[30;1m282 | [0m[35m        type: str[0m
[30;1m283 | [0m[35m    query_macros:[0m
[30;1m284 | [0m[35m      query_condition:[0m

[31m--[ [0m[34mMatch #[0m[33m1620[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m268 | [0m[35m        description: Hostname where clause[0m
[30;1m269 | [0m[35m        value: '| where Computer has "{host_name}"'[0m
[30;1m270 | [0m[35m  list_ip_logon_failures:[0m
[30;1m271 | [0m[35m    description: Failed user logon events from an IP address[0m
[30;1m272 | [0m[35m    metadata:[0m
[30;1m273 | [0m[35m      pivot:[0m
[30;1m274 | [0m[35m        short_name: logon_failures[0m

[31m--[ [0m[34mMatch #[0m[33m1621[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m        {add_query_items}'[0m
[30;1m198 | [0m[35m    parameters:[0m
[30;1m199 | [0m[35m      ip_address:[0m
[30;1m200 | [0m[35m        description: The source IP Address to search on[0m
[30;1m201 | [0m[35m        type: str[0m
[30;1m202 | [0m[35m  list_logons_for_host:[0m
[30;1m203 | [0m[35m    description: All logon events on a host[0m

[31m--[ [0m[34mMatch #[0m[33m1622[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m        description: The account name to search on[0m
[30;1m169 | [0m[35m        type: str[0m
[30;1m170 | [0m[35m  list_logons_for_source_ip:[0m
[30;1m171 | [0m[35m    description: Successful user logon events for source IP (all hosts)[0m
[30;1m172 | [0m[35m    metadata:[0m
[30;1m173 | [0m[35m      pivot:[0m
[30;1m174 | [0m[35m        short_name: logons[0m

[31m--[ [0m[34mMatch #[0m[33m1623[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m      description: Query start time[0m
[30;1m44 | [0m[35m      type: datetime[0m
[30;1m45 | [0m[35m    end:[0m
[30;1m46 | [0m[35m      description: Query end time[0m
[30;1m47 | [0m[35m      type: datetime[0m
[30;1m48 | [0m[35m    add_query_items:[0m
[30;1m49 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1624[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m      type: str[0m
[30;1m41 | [0m[35m      default: "Syslog"[0m
[30;1m42 | [0m[35m    start:[0m
[30;1m43 | [0m[35m      description: Query start time[0m
[30;1m44 | [0m[35m      type: datetime[0m
[30;1m45 | [0m[35m    end:[0m
[30;1m46 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1625[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_azure_sentinel.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def _select_provider(self, change):[0m
[30;1m151 | [0m[35m        """Select a provider from the list."""[0m
[30;1m152 | [0m[35m        prov_name = change.get("new")[0m
[30;1m153 | [0m[35m        self.edit_ctrls = _get_ws_ctrls(prov_name, self.mp_controls, self._COMP_PATH)[0m
[30;1m154 | [0m[35m        self.edit_ctrls.children[0].value = prov_name[0m
[30;1m155 | [0m[35m        self.current_workspace = prov_name[0m

[31m--[ [0m[34mMatch #[0m[33m1626[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_azure_sentinel.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35mdef _get_named_control(edit_ctrls, name):[0m
[30;1m293 | [0m[35m    """Get the control with matching name."""[0m
[30;1m294 | [0m[35m    try:[0m
[30;1m295 | [0m[35m        return next(ctrl for ctrl in edit_ctrls.children if ctrl.description == name)[0m
[30;1m296 | [0m[35m    except StopIteration:[0m

[31m--[ [0m[34mMatch #[0m[33m1627[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_azure_sentinel.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35mdef _get_ws_ctrls(workspace, mp_controls, conf_path):[0m
[30;1m275 | [0m[35m    """Return or create the control set for a workspace."""[0m
[30;1m276 | [0m[35m    defn_path = f"{conf_path}.Default"[0m
[30;1m277 | [0m[35m    prov_defn = mp_controls.get_defn(defn_path)[0m
[30;1m278 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1628[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_azure_sentinel.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m245 | [0m[35m        resource_group = _get_named_control(self.edit_ctrls, "ResourceGroup").value[0m
[30;1m246 | [0m[35m        if not (workspace_id or workspace_name):[0m
[30;1m247 | [0m[35m            self.set_status([0m
[30;1m248 | [0m[35m                "Need at least WorkspaceId or WorkspaceName to lookup settings."[0m
[30;1m249 | [0m[35m            )[0m
[30;1m250 | [0m[35m            return[0m
[30;1m251 | [0m[35m        if workspace_id:[0m

[31m--[ [0m[34mMatch #[0m[33m1629[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_azure_sentinel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m    "Workspace Settings" tab near the top of the page.[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    The Tenant ID is the only value missing from this settings page. If you cannot[0m
[30;1m56 | [0m[35m    find this you can use the following code to try to look it up:[0m
[30;1m57 | [0m[35m    <pre>[0m
[30;1m58 | [0m[35m    from msticpy.common.config.ce_common import get_def_tenant_id[0m
[30;1m59 | [0m[35m    get_def_tenant_id("{workspace-subscription-id}")[0m

[31m--[ [0m[34mMatch #[0m[33m1630[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_azure_sentinel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m    You can also get all of these settings (apart from 'TenantID') from your[0m
[30;1m51 | [0m[35m    workspace portal manually.[0m
[30;1m52 | [0m[35m    Navigate to "Settings" (on the left side of the screen), then click the[0m
[30;1m53 | [0m[35m    "Workspace Settings" tab near the top of the page.[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    The Tenant ID is the only value missing from this settings page. If you cannot[0m
[30;1m56 | [0m[35m    find this you can use the following code to try to look it up:[0m

[31m--[ [0m[34mMatch #[0m[33m1631[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_user.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m      type: str[0m
[30;1m20 | [0m[35m      default: ""[0m
[30;1m21 | [0m[35m    time_column:[0m
[30;1m22 | [0m[35m      description: The name of the column detailing the time the event was generated.[0m
[30;1m23 | [0m[35m      type: str[0m
[30;1m24 | [0m[35m      default: "Timestamp"[0m
[30;1m25 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m1632[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_user.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m
[30;1m16 | [0m[35m      type: datetime[0m
[30;1m17 | [0m[35m    add_query_items:[0m
[30;1m18 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1633[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_user.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    data_source: "user_events"[0m
[30;1m10 | [0m[35m  parameters:[0m
[30;1m11 | [0m[35m    start:[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1634[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m                    self.properties.get("DisplayName", "no alert name"),[0m
[30;1m326 | [0m[35m                ),[0m
[30;1m327 | [0m[35m                entity=self.properties.get("CompromisedEntity", "unknown"),[0m
[30;1m328 | [0m[35m                id=self.properties.get("SystemAlertId", "unknown"),[0m
[30;1m329 | [0m[35m            )[0m
[30;1m330 | [0m[35m            if self.properties[0m
[30;1m331 | [0m[35m            else "Alert has no data."[0m

[31m--[ [0m[34mMatch #[0m[33m1635[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m                    "AlertDisplayName",[0m
[30;1m325 | [0m[35m                    self.properties.get("DisplayName", "no alert name"),[0m
[30;1m326 | [0m[35m                ),[0m
[30;1m327 | [0m[35m                entity=self.properties.get("CompromisedEntity", "unknown"),[0m
[30;1m328 | [0m[35m                id=self.properties.get("SystemAlertId", "unknown"),[0m
[30;1m329 | [0m[35m            )[0m
[30;1m330 | [0m[35m            if self.properties[0m

[31m--[ [0m[34mMatch #[0m[33m1636[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m                ),[0m
[30;1m323 | [0m[35m                name=self.properties.get([0m
[30;1m324 | [0m[35m                    "AlertDisplayName",[0m
[30;1m325 | [0m[35m                    self.properties.get("DisplayName", "no alert name"),[0m
[30;1m326 | [0m[35m                ),[0m
[30;1m327 | [0m[35m                entity=self.properties.get("CompromisedEntity", "unknown"),[0m
[30;1m328 | [0m[35m                id=self.properties.get("SystemAlertId", "unknown"),[0m

[31m--[ [0m[34mMatch #[0m[33m1637[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m                    "StartTimeUtc",[0m
[30;1m321 | [0m[35m                    self.properties.get("StartTime", "no timestamp"),[0m
[30;1m322 | [0m[35m                ),[0m
[30;1m323 | [0m[35m                name=self.properties.get([0m
[30;1m324 | [0m[35m                    "AlertDisplayName",[0m
[30;1m325 | [0m[35m                    self.properties.get("DisplayName", "no alert name"),[0m
[30;1m326 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m1638[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m            """.format([0m
[30;1m319 | [0m[35m                start=self.properties.get([0m
[30;1m320 | [0m[35m                    "StartTimeUtc",[0m
[30;1m321 | [0m[35m                    self.properties.get("StartTime", "no timestamp"),[0m
[30;1m322 | [0m[35m                ),[0m
[30;1m323 | [0m[35m                name=self.properties.get([0m
[30;1m324 | [0m[35m                    "AlertDisplayName",[0m

[31m--[ [0m[34mMatch #[0m[33m1639[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m            <b>Compr_entity:</b> {entity},[0m
[30;1m317 | [0m[35m            <b>Alert_id:</b> {id}[0m
[30;1m318 | [0m[35m            """.format([0m
[30;1m319 | [0m[35m                start=self.properties.get([0m
[30;1m320 | [0m[35m                    "StartTimeUtc",[0m
[30;1m321 | [0m[35m                    self.properties.get("StartTime", "no timestamp"),[0m
[30;1m322 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m1640[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m                ent_type = ent[0][0m
[30;1m297 | [0m[35m            elif isinstance(ent, Dict):[0m
[30;1m298 | [0m[35m                ent_details = ent[0m
[30;1m299 | [0m[35m                ent_type = ent.get("Type", "Unknown")[0m
[30;1m300 | [0m[35m            else:[0m
[30;1m301 | [0m[35m                ent_details = ent[0m
[30;1m302 | [0m[35m                ent_type = "Unknown"[0m

[31m--[ [0m[34mMatch #[0m[33m1641[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m        self.Entities = self._create_entities(ents)[0m
[30;1m196 | [0m[35m        for ent in self._entity_schema:[0m
[30;1m197 | [0m[35m            if ent not in self.__dict__:[0m
[30;1m198 | [0m[35m                self.__dict__[ent] = src_event.get(ent)[0m
[30;1m199 | [0m[35m        if "ExtendedProperties" in src_event:[0m
[30;1m200 | [0m[35m            ext_props = json.loads(src_event["ExtendedProperties"])[0m
[30;1m201 | [0m[35m            self._add_additional_data(ext_props)[0m

[31m--[ [0m[34mMatch #[0m[33m1642[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m
[30;1m186 | [0m[35m        self.Severity = src_event.get("Severity", src_event.get("AlertSeverity"))[0m
[30;1m187 | [0m[35m        self.SystemAlertIds = src_event.get("SystemAlertId", src_event.get("ID"))[0m
[30;1m188 | [0m[35m        if isinstance(src_event["Entities"], str):[0m
[30;1m189 | [0m[35m            try:[0m
[30;1m190 | [0m[35m                ents = _extract_entities(json.loads(src_event["Entities"]))[0m

[31m--[ [0m[34mMatch #[0m[33m1643[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m
[30;1m186 | [0m[35m        self.Severity = src_event.get("Severity", src_event.get("AlertSeverity"))[0m
[30;1m187 | [0m[35m        self.SystemAlertIds = src_event.get("SystemAlertId", src_event.get("ID"))[0m
[30;1m188 | [0m[35m        if isinstance(src_event["Entities"], str):[0m
[30;1m189 | [0m[35m            try:[0m
[30;1m190 | [0m[35m                ents = _extract_entities(json.loads(src_event["Entities"]))[0m

[31m--[ [0m[34mMatch #[0m[33m1644[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m
[30;1m186 | [0m[35m        self.Severity = src_event.get("Severity", src_event.get("AlertSeverity"))[0m
[30;1m187 | [0m[35m        self.SystemAlertIds = src_event.get("SystemAlertId", src_event.get("ID"))[0m
[30;1m188 | [0m[35m        if isinstance(src_event["Entities"], str):[0m
[30;1m189 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m1645[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m
[30;1m186 | [0m[35m        self.Severity = src_event.get("Severity", src_event.get("AlertSeverity"))[0m
[30;1m187 | [0m[35m        self.SystemAlertIds = src_event.get("SystemAlertId", src_event.get("ID"))[0m
[30;1m188 | [0m[35m        if isinstance(src_event["Entities"], str):[0m
[30;1m189 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m1646[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m
[30;1m186 | [0m[35m        self.Severity = src_event.get("Severity", src_event.get("AlertSeverity"))[0m
[30;1m187 | [0m[35m        self.SystemAlertIds = src_event.get("SystemAlertId", src_event.get("ID"))[0m
[30;1m188 | [0m[35m        if isinstance(src_event["Entities"], str):[0m

[31m--[ [0m[34mMatch #[0m[33m1647[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m
[30;1m186 | [0m[35m        self.Severity = src_event.get("Severity", src_event.get("AlertSeverity"))[0m
[30;1m187 | [0m[35m        self.SystemAlertIds = src_event.get("SystemAlertId", src_event.get("ID"))[0m
[30;1m188 | [0m[35m        if isinstance(src_event["Entities"], str):[0m

[31m--[ [0m[34mMatch #[0m[33m1648[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m        self.AlertDisplayName = src_event.get([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m
[30;1m186 | [0m[35m        self.Severity = src_event.get("Severity", src_event.get("AlertSeverity"))[0m
[30;1m187 | [0m[35m        self.SystemAlertIds = src_event.get("SystemAlertId", src_event.get("ID"))[0m

[31m--[ [0m[34mMatch #[0m[33m1649[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m        self.AlertDisplayName = src_event.get([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m
[30;1m186 | [0m[35m        self.Severity = src_event.get("Severity", src_event.get("AlertSeverity"))[0m
[30;1m187 | [0m[35m        self.SystemAlertIds = src_event.get("SystemAlertId", src_event.get("ID"))[0m

[31m--[ [0m[34mMatch #[0m[33m1650[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m        """Create Alert from an alert event."""[0m
[30;1m180 | [0m[35m        self.TimeGenerated = src_event.get("StartTime", src_event.get("TimeGenerated"))[0m
[30;1m181 | [0m[35m        self.AlertDisplayName = src_event.get([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m

[31m--[ [0m[34mMatch #[0m[33m1651[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m        """Create Alert from an alert event."""[0m
[30;1m180 | [0m[35m        self.TimeGenerated = src_event.get("StartTime", src_event.get("TimeGenerated"))[0m
[30;1m181 | [0m[35m        self.AlertDisplayName = src_event.get([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m
[30;1m185 | [0m[35m        self.EndTimeUtc = src_event.get("EndTimeUtc", src_event.get("EndTime"))[0m

[31m--[ [0m[34mMatch #[0m[33m1652[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m179 | [0m[35m        """Create Alert from an alert event."""[0m
[30;1m180 | [0m[35m        self.TimeGenerated = src_event.get("StartTime", src_event.get("TimeGenerated"))[0m
[30;1m181 | [0m[35m        self.AlertDisplayName = src_event.get([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.StartTimeUtc = src_event.get("StartTimeUtc", src_event.get("StartTime"))[0m

[31m--[ [0m[34mMatch #[0m[33m1653[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m179 | [0m[35m        """Create Alert from an alert event."""[0m
[30;1m180 | [0m[35m        self.TimeGenerated = src_event.get("StartTime", src_event.get("TimeGenerated"))[0m
[30;1m181 | [0m[35m        self.AlertDisplayName = src_event.get([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1654[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m179 | [0m[35m        """Create Alert from an alert event."""[0m
[30;1m180 | [0m[35m        self.TimeGenerated = src_event.get("StartTime", src_event.get("TimeGenerated"))[0m
[30;1m181 | [0m[35m        self.AlertDisplayName = src_event.get([0m
[30;1m182 | [0m[35m            "AlertDisplayName", src_event.get("DisplayName", src_event.get("Name"))[0m
[30;1m183 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1655[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m        "ProductComponentName": None,[0m
[30;1m228 | [0m[35m        # The version of the product generating the alert, if relevant (type String)[0m
[30;1m229 | [0m[35m        "ProductVersion": None,[0m
[30;1m230 | [0m[35m        # The time the alert was made available for consumption (type String)[0m
[30;1m231 | [0m[35m        "ProcessingEndTime": None,[0m
[30;1m232 | [0m[35m        # The life cycle status of the alert. This field is optional and all alerts would have the s[0m
[30;1m233 | [0m[35m        "Status": None,[0m

[31m--[ [0m[34mMatch #[0m[33m1656[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/alert.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m219 | [0m[35m        "ProviderName": None,[0m
[30;1m220 | [0m[35m        # List of associated entities (type List)[0m
[30;1m221 | [0m[35m        "Entities": None,[0m
[30;1m222 | [0m[35m        # Time the alert was generated (type String)[0m
[30;1m223 | [0m[35m        "TimeGenerated": None,[0m
[30;1m224 | [0m[35m        # The product that generated the alert (type String)[0m
[30;1m225 | [0m[35m        "ProductName": None,[0m

[31m--[ [0m[34mMatch #[0m[33m1657[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m418 | [0m[35m            The entities matching `entity_type`.[0m
[30;1m419 | [0m[35m[0m
[30;1m420 | [0m[35m        """[0m
[30;1m421 | [0m[35m        class_type = Entity.ENTITY_NAME_MAP.get(entity_type, None)[0m
[30;1m422 | [0m[35m        return [[0m
[30;1m423 | [0m[35m            p[0m
[30;1m424 | [0m[35m            for p in self.entities[0m

[31m--[ [0m[34mMatch #[0m[33m1658[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_base.py[0m
   Pattern: [32m.hostname[0m
[30;1m160 | [0m[35m        return self._source_data.to_dict()[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m    @property[0m
[30;1m163 | [0m[35m    def hostname(self) -> str | None:[0m
[30;1m164 | [0m[35m        """Return the Hostname (not FQDN) of the host associated with the alert."""[0m
[30;1m165 | [0m[35m        return self.primary_host.HostName if self.primary_host is not None else None[0m
[30;1m166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1659[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m237 | [0m[35m        if len(procs) == 1:[0m
[30;1m238 | [0m[35m            return procs[0][0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m        # find the first process that has a parent process property[0m
[30;1m241 | [0m[35m        procs_with_parent = [[0m
[30;1m242 | [0m[35m            proc[0m
[30;1m243 | [0m[35m            for proc in procs[0m

[31m--[ [0m[34mMatch #[0m[33m1660[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/http_context_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m        ) as err:[0m
[30;1m213 | [0m[35m            self._err_to_results(result, err)[0m
[30;1m214 | [0m[35m            if not isinstance(err, LookupError):[0m
[30;1m215 | [0m[35m                url: str | None = req_params.get("url") if req_params else None[0m
[30;1m216 | [0m[35m                result["Reference"] = url[0m
[30;1m217 | [0m[35m        return pd.DataFrame([result])[0m

[31m--[ [0m[34mMatch #[0m[33m1661[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/http_context_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m            query_type,[0m
[30;1m112 | [0m[35m        )[0m
[30;1m113 | [0m[35m        if verb == "GET":[0m
[30;1m114 | [0m[35m            response: httpx.Response = self._httpx_client.get([0m
[30;1m115 | [0m[35m                **req_params,[0m
[30;1m116 | [0m[35m                timeout=get_http_timeout(timeout=timeout),[0m
[30;1m117 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1662[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/http_context_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m        provider_name : str, optional[0m
[30;1m166 | [0m[35m            Name of the provider to use for the lookup[0m
[30;1m167 | [0m[35m        timeout : int, optional[0m
[30;1m168 | [0m[35m            Timeout to use for lookups[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m        Returns[0m
[30;1m171 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1663[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/http_context_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m            will be returned.[0m
[30;1m165 | [0m[35m        provider_name : str, optional[0m
[30;1m166 | [0m[35m            Name of the provider to use for the lookup[0m
[30;1m167 | [0m[35m        timeout : int, optional[0m
[30;1m168 | [0m[35m            Timeout to use for lookups[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m1664[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/http_context_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        provider_name : str, optional[0m
[30;1m82 | [0m[35m            Name of the provider to use for the lookup[0m
[30;1m83 | [0m[35m        timeout : int, optional[0m
[30;1m84 | [0m[35m            Timeout to use for lookups[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        Returns[0m
[30;1m87 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1665[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/contextproviders/http_context_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m            will be returned.[0m
[30;1m81 | [0m[35m        provider_name : str, optional[0m
[30;1m82 | [0m[35m            Name of the provider to use for the lookup[0m
[30;1m83 | [0m[35m        timeout : int, optional[0m
[30;1m84 | [0m[35m            Timeout to use for lookups[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m1666[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m382 | [0m[35m        elif st_type == "m_enum":[0m
[30;1m383 | [0m[35m            ctrl = widgets.SelectMultiple([0m
[30;1m384 | [0m[35m                description=var_name,[0m
[30;1m385 | [0m[35m                options=st_opts.get("options"),[0m
[30;1m386 | [0m[35m                value=curr_val or [],[0m
[30;1m387 | [0m[35m                **(wgt_style or SETTING_LIST_LAYOUT),[0m
[30;1m388 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1667[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m        elif st_type == "enum":[0m
[30;1m376 | [0m[35m            ctrl = widgets.Select([0m
[30;1m377 | [0m[35m                description=var_name,[0m
[30;1m378 | [0m[35m                options=st_opts.get("options"),[0m
[30;1m379 | [0m[35m                value=curr_val or "",[0m
[30;1m380 | [0m[35m                **(wgt_style or SETTING_LIST_LAYOUT),[0m
[30;1m381 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1668[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m    """[0m
[30;1m245 | [0m[35m    sub_metadata = get_subscription_metadata(sub_id)[0m
[30;1m246 | [0m[35m    tenant_ids = sub_metadata.get("managedByTenants", None)[0m
[30;1m247 | [0m[35m    return tenant_ids if tenant_ids else None[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1669[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m    """[0m
[30;1m226 | [0m[35m    sub_metadata = get_subscription_metadata(sub_id)[0m
[30;1m227 | [0m[35m    return sub_metadata.get("tenantId", None)[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35mdef get_managed_tenant_id(sub_id: str) -> Optional[List[str]]:  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m1670[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m        az_credentials = az_connect()[0m
[30;1m198 | [0m[35m        token = get_token(az_credentials, tenant_id)[0m
[30;1m199 | [0m[35m        headers["Authorization"] = f"Bearer {token}"[0m
[30;1m200 | [0m[35m        resp = httpx.get(sub_url, headers=headers)[0m
[30;1m201 | [0m[35m        return resp.json() if resp.status_code == 200 else {"tenantId": tenant_id}[0m
[30;1m202 | [0m[35m    except Exception as err:  # pylint: disable=broad-except[0m
[30;1m203 | [0m[35m        print("Error retrieving subscription metadata", err)[0m

[31m--[ [0m[34mMatch #[0m[33m1671[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m        item.split("=")[0]: item.split("=")[1].strip('"')[0m
[30;1m188 | [0m[35m        for item in www_header.split(", ")[0m
[30;1m189 | [0m[35m    }[0m
[30;1m190 | [0m[35m    tenant_path = hdr_dict.get("Bearer authorization_uri", "").split("/")[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    if not tenant_path:[0m
[30;1m193 | [0m[35m        return {}[0m

[31m--[ [0m[34mMatch #[0m[33m1672[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m    headers = mp_ua_header()[0m
[30;1m179 | [0m[35m    sub_url = get_sub_url.format(subscriptionid=sub_id)[0m
[30;1m180 | [0m[35m    resp = httpx.get(sub_url, headers=headers)[0m
[30;1m181 | [0m[35m    www_header = resp.headers.get("WWW-Authenticate")[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    if not www_header:[0m
[30;1m184 | [0m[35m        return {}[0m

[31m--[ [0m[34mMatch #[0m[33m1673[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m    )[0m
[30;1m178 | [0m[35m    headers = mp_ua_header()[0m
[30;1m179 | [0m[35m    sub_url = get_sub_url.format(subscriptionid=sub_id)[0m
[30;1m180 | [0m[35m    resp = httpx.get(sub_url, headers=headers)[0m
[30;1m181 | [0m[35m    www_header = resp.headers.get("WWW-Authenticate")[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    if not www_header:[0m

[31m--[ [0m[34mMatch #[0m[33m1674[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m454 | [0m[35m    Returns[0m
[30;1m455 | [0m[35m    -------[0m
[30;1m456 | [0m[35m    Any[0m
[30;1m457 | [0m[35m        The settings at that section[subkey] location.[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m    """[0m
[30;1m460 | [0m[35m    curr_section = mp_controls.get_value(section)[0m

[31m--[ [0m[34mMatch #[0m[33m1675[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    """[0m
[30;1m95 | [0m[35m    if ctrl is None and val_type is None:[0m
[30;1m96 | [0m[35m        raise ValueError("Must specify either a target control or expected val_type.")[0m
[30;1m97 | [0m[35m    if ([0m
[30;1m98 | [0m[35m        isinstance(ctrl, widgets.Checkbox)[0m
[30;1m99 | [0m[35m        or val_type == "bool"[0m

[31m--[ [0m[34mMatch #[0m[33m1676[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m    Raises[0m
[30;1m84 | [0m[35m    ------[0m
[30;1m85 | [0m[35m    ValueError[0m
[30;1m86 | [0m[35m        If neither a target control or expected val_type[0m
[30;1m87 | [0m[35m        are specified.[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    Notes[0m

[31m--[ [0m[34mMatch #[0m[33m1677[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_provider_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        setting_path = f"{instance_path}.{setting}"[0m
[30;1m229 | [0m[35m        setting_defn_path = f"{defn_path}.{setting}"[0m
[30;1m230 | [0m[35m        for var_name in prov_defn.get(setting):[0m
[30;1m231 | [0m[35m            comp_defn = mp_controls.get_defn(f"{setting_defn_path}.{var_name}")[0m
[30;1m232 | [0m[35m            if get_defn_or_default(comp_defn)[0] == "cred_key":[0m
[30;1m233 | [0m[35m                arg_ctrl = get_arg_ctrl(setting_path, var_name, mp_controls)[0m

[31m--[ [0m[34mMatch #[0m[33m1678[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_provider_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    @property[0m
[30;1m123 | [0m[35m    def _prov_ctrl_name(self) -> str:[0m
[30;1m124 | [0m[35m        """Return current provider control name."""[0m
[30;1m125 | [0m[35m        return self._prov_name[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1679[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m865 | [0m[35m                timeout=get_http_timeout(),[0m
[30;1m866 | [0m[35m            )[0m
[30;1m867 | [0m[35m        else:[0m
[30;1m868 | [0m[35m            response = httpx.get([0m
[30;1m869 | [0m[35m                submit_url,[0m
[30;1m870 | [0m[35m                params=params,[0m
[30;1m871 | [0m[35m                headers=headers,[0m

[31m--[ [0m[34mMatch #[0m[33m1680[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m858 | [0m[35m            headers.update(vt_param.headers)[0m
[30;1m859 | [0m[35m[0m
[30;1m860 | [0m[35m        if vt_param.http_verb == "post":[0m
[30;1m861 | [0m[35m            response: httpx.Response = httpx.post([0m
[30;1m862 | [0m[35m                submit_url,[0m
[30;1m863 | [0m[35m                data=params,[0m
[30;1m864 | [0m[35m                headers=headers,[0m

[31m--[ [0m[34mMatch #[0m[33m1681[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m        if ioc_type in ["ipv4", "dns"]:[0m
[30;1m613 | [0m[35m            df_dict_vtresults["ResponseCode"] = results_dict.get("response_code", None)[0m
[30;1m614 | [0m[35m            df_dict_vtresults["VerboseMsg"] = results_dict.get("verbose_msg", None)[0m
[30;1m615 | [0m[35m            # dns and ipv4 have multi-valued 'resolutions' and 'detected_urls' lists[0m
[30;1m616 | [0m[35m            # of dictionaries[0m
[30;1m617 | [0m[35m            # This leads to a few horrendous-looking list comprehensions[0m

[31m--[ [0m[34mMatch #[0m[33m1682[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m610 | [0m[35m                df_dict_vtresults["SHA256"] = results_dict.get("sha256", None)[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m        if ioc_type in ["ipv4", "dns"]:[0m
[30;1m613 | [0m[35m            df_dict_vtresults["ResponseCode"] = results_dict.get("response_code", None)[0m
[30;1m614 | [0m[35m            df_dict_vtresults["VerboseMsg"] = results_dict.get("verbose_msg", None)[0m
[30;1m615 | [0m[35m            # dns and ipv4 have multi-valued 'resolutions' and 'detected_urls' lists[0m
[30;1m616 | [0m[35m            # of dictionaries[0m

[31m--[ [0m[34mMatch #[0m[33m1683[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m607 | [0m[35m            if ioc_type in ["md5_hash", "sha1_hash", "sha256_hash"]:[0m
[30;1m608 | [0m[35m                df_dict_vtresults["MD5"] = results_dict.get("md5", None)[0m
[30;1m609 | [0m[35m                df_dict_vtresults["SHA1"] = results_dict.get("sha1", None)[0m
[30;1m610 | [0m[35m                df_dict_vtresults["SHA256"] = results_dict.get("sha256", None)[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m        if ioc_type in ["ipv4", "dns"]:[0m
[30;1m613 | [0m[35m            df_dict_vtresults["ResponseCode"] = results_dict.get("response_code", None)[0m

[31m--[ [0m[34mMatch #[0m[33m1684[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m606 | [0m[35m            df_dict_vtresults["Positives"] = results_dict.get("positives", None)[0m
[30;1m607 | [0m[35m            if ioc_type in ["md5_hash", "sha1_hash", "sha256_hash"]:[0m
[30;1m608 | [0m[35m                df_dict_vtresults["MD5"] = results_dict.get("md5", None)[0m
[30;1m609 | [0m[35m                df_dict_vtresults["SHA1"] = results_dict.get("sha1", None)[0m
[30;1m610 | [0m[35m                df_dict_vtresults["SHA256"] = results_dict.get("sha256", None)[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m        if ioc_type in ["ipv4", "dns"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1685[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m605 | [0m[35m            df_dict_vtresults["Permalink"] = results_dict.get("permalink", None)[0m
[30;1m606 | [0m[35m            df_dict_vtresults["Positives"] = results_dict.get("positives", None)[0m
[30;1m607 | [0m[35m            if ioc_type in ["md5_hash", "sha1_hash", "sha256_hash"]:[0m
[30;1m608 | [0m[35m                df_dict_vtresults["MD5"] = results_dict.get("md5", None)[0m
[30;1m609 | [0m[35m                df_dict_vtresults["SHA1"] = results_dict.get("sha1", None)[0m
[30;1m610 | [0m[35m                df_dict_vtresults["SHA256"] = results_dict.get("sha256", None)[0m
[30;1m611 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1686[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35m            df_dict_vtresults["ScanId"] = results_dict.get("scan_id", None)[0m
[30;1m604 | [0m[35m            df_dict_vtresults["Resource"] = results_dict.get("resource", None)[0m
[30;1m605 | [0m[35m            df_dict_vtresults["Permalink"] = results_dict.get("permalink", None)[0m
[30;1m606 | [0m[35m            df_dict_vtresults["Positives"] = results_dict.get("positives", None)[0m
[30;1m607 | [0m[35m            if ioc_type in ["md5_hash", "sha1_hash", "sha256_hash"]:[0m
[30;1m608 | [0m[35m                df_dict_vtresults["MD5"] = results_dict.get("md5", None)[0m
[30;1m609 | [0m[35m                df_dict_vtresults["SHA1"] = results_dict.get("sha1", None)[0m

[31m--[ [0m[34mMatch #[0m[33m1687[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m            df_dict_vtresults["VerboseMsg"] = results_dict.get("verbose_msg", None)[0m
[30;1m603 | [0m[35m            df_dict_vtresults["ScanId"] = results_dict.get("scan_id", None)[0m
[30;1m604 | [0m[35m            df_dict_vtresults["Resource"] = results_dict.get("resource", None)[0m
[30;1m605 | [0m[35m            df_dict_vtresults["Permalink"] = results_dict.get("permalink", None)[0m
[30;1m606 | [0m[35m            df_dict_vtresults["Positives"] = results_dict.get("positives", None)[0m
[30;1m607 | [0m[35m            if ioc_type in ["md5_hash", "sha1_hash", "sha256_hash"]:[0m
[30;1m608 | [0m[35m                df_dict_vtresults["MD5"] = results_dict.get("md5", None)[0m

[31m--[ [0m[34mMatch #[0m[33m1688[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m            df_dict_vtresults["ResponseCode"] = results_dict.get("response_code", None)[0m
[30;1m602 | [0m[35m            df_dict_vtresults["VerboseMsg"] = results_dict.get("verbose_msg", None)[0m
[30;1m603 | [0m[35m            df_dict_vtresults["ScanId"] = results_dict.get("scan_id", None)[0m
[30;1m604 | [0m[35m            df_dict_vtresults["Resource"] = results_dict.get("resource", None)[0m
[30;1m605 | [0m[35m            df_dict_vtresults["Permalink"] = results_dict.get("permalink", None)[0m
[30;1m606 | [0m[35m            df_dict_vtresults["Positives"] = results_dict.get("positives", None)[0m
[30;1m607 | [0m[35m            if ioc_type in ["md5_hash", "sha1_hash", "sha256_hash"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1689[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m600 | [0m[35m        if ioc_type in ["url", "md5_hash", "sha1_hash", "sha256_hash"]:[0m
[30;1m601 | [0m[35m            df_dict_vtresults["ResponseCode"] = results_dict.get("response_code", None)[0m
[30;1m602 | [0m[35m            df_dict_vtresults["VerboseMsg"] = results_dict.get("verbose_msg", None)[0m
[30;1m603 | [0m[35m            df_dict_vtresults["ScanId"] = results_dict.get("scan_id", None)[0m
[30;1m604 | [0m[35m            df_dict_vtresults["Resource"] = results_dict.get("resource", None)[0m
[30;1m605 | [0m[35m            df_dict_vtresults["Permalink"] = results_dict.get("permalink", None)[0m
[30;1m606 | [0m[35m            df_dict_vtresults["Positives"] = results_dict.get("positives", None)[0m

[31m--[ [0m[34mMatch #[0m[33m1690[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m599 | [0m[35m        # on the IoC type[0m
[30;1m600 | [0m[35m        if ioc_type in ["url", "md5_hash", "sha1_hash", "sha256_hash"]:[0m
[30;1m601 | [0m[35m            df_dict_vtresults["ResponseCode"] = results_dict.get("response_code", None)[0m
[30;1m602 | [0m[35m            df_dict_vtresults["VerboseMsg"] = results_dict.get("verbose_msg", None)[0m
[30;1m603 | [0m[35m            df_dict_vtresults["ScanId"] = results_dict.get("scan_id", None)[0m
[30;1m604 | [0m[35m            df_dict_vtresults["Resource"] = results_dict.get("resource", None)[0m
[30;1m605 | [0m[35m            df_dict_vtresults["Permalink"] = results_dict.get("permalink", None)[0m

[31m--[ [0m[34mMatch #[0m[33m1691[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m598 | [0m[35m        # Parse returned results to our output dataframe depending[0m
[30;1m599 | [0m[35m        # on the IoC type[0m
[30;1m600 | [0m[35m        if ioc_type in ["url", "md5_hash", "sha1_hash", "sha256_hash"]:[0m
[30;1m601 | [0m[35m            df_dict_vtresults["ResponseCode"] = results_dict.get("response_code", None)[0m
[30;1m602 | [0m[35m            df_dict_vtresults["VerboseMsg"] = results_dict.get("verbose_msg", None)[0m
[30;1m603 | [0m[35m            df_dict_vtresults["ScanId"] = results_dict.get("scan_id", None)[0m
[30;1m604 | [0m[35m            df_dict_vtresults["Resource"] = results_dict.get("resource", None)[0m

[31m--[ [0m[34mMatch #[0m[33m1692[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m.hostname[0m
[30;1m622 | [0m[35m                item_list: list = [[0m
[30;1m623 | [0m[35m                    item["hostname"][0m
[30;1m624 | [0m[35m                    for item in results_dict["resolutions"][0m
[30;1m625 | [0m[35m                    if "hostname" in item[0m
[30;1m626 | [0m[35m                ][0m
[30;1m627 | [0m[35m                df_dict_vtresults["ResolvedDomains"] = ", ".join(item_list)[0m
[30;1m628 | [0m[35m            elif ioc_type == "dns" and "resolutions" in results_dict:[0m

[31m--[ [0m[34mMatch #[0m[33m1693[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m.hostname[0m
[30;1m620 | [0m[35m            # is of the required value[0m
[30;1m621 | [0m[35m            if ioc_type == "ipv4" and "resolutions" in results_dict:[0m
[30;1m622 | [0m[35m                item_list: list = [[0m
[30;1m623 | [0m[35m                    item["hostname"][0m
[30;1m624 | [0m[35m                    for item in results_dict["resolutions"][0m
[30;1m625 | [0m[35m                    if "hostname" in item[0m
[30;1m626 | [0m[35m                ][0m

[31m--[ [0m[34mMatch #[0m[33m1694[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m909 | [0m[35m        message : str[0m
[30;1m910 | [0m[35m            the string message to print[0m
[30;1m911 | [0m[35m        verbosity_level : int[0m
[30;1m912 | [0m[35m            verbosity_level at which level the message should be output[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m        """[0m
[30;1m915 | [0m[35m        if verbosity_level <= self._verbosity:[0m

[31m--[ [0m[34mMatch #[0m[33m1695[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m422 | [0m[35m                batch_index += 1[0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35m            # We want to trigger in the following circumstances[0m
[30;1m425 | [0m[35m            # 1. if the length of our batch is at the max VT batchsize for[0m
[30;1m426 | [0m[35m            # this type (If the batch size is 1 this will fire for every row)[0m
[30;1m427 | [0m[35m            # 2. Or we have reached the end of our row iteration[0m
[30;1m428 | [0m[35m            # AND[0m

[31m--[ [0m[34mMatch #[0m[33m1696[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m250 | [0m[35m            and fragments will be dropped before submitting.[0m
[30;1m251 | [0m[35m            Other supported protocols are ftp, telnet, ldap, file[0m
[30;1m252 | [0m[35m            For files MD5, SHA1 and SHA256 hashes are supported.[0m
[30;1m253 | [0m[35m            For IP addresses only dotted IPv4 addresses are supported.[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m        """[0m
[30;1m256 | [0m[35m        # if the caller has supplied alternative type name mappings add any of these[0m

[31m--[ [0m[34mMatch #[0m[33m1697[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/vtlookupv3/vtlookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m    For urls a full http request can be submitted, query string and fragments will be[0m
[30;1m76 | [0m[35m    dropped before submitting.[0m
[30;1m77 | [0m[35m    For files MD5, SHA1 and SHA256 hashes are supported.[0m
[30;1m78 | [0m[35m    For IP addresses only dotted IPv4 addresses are supported.[0m
[30;1m79 | [0m[35m    """[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    # Ioc types that we support[0m

[31m--[ [0m[34mMatch #[0m[33m1698[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_file.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m            ws_settings = {[0m
[30;1m353 | [0m[35m                config: self.settings[entry] for entry, config in _CONFIG_MAP.items()[0m
[30;1m354 | [0m[35m            }[0m
[30;1m355 | [0m[35m            workspace = self.settings.get("workspace_name", "Default")[0m
[30;1m356 | [0m[35m            self.settings = SettingsDict([0m
[30;1m357 | [0m[35m                {"MSSentinel": {"Workspaces": {workspace: ws_settings}}}[0m
[30;1m358 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1699[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_file.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m        """Import sentinel settings from portal URL."""[0m
[30;1m334 | [0m[35m        if not self._last_workspace:[0m
[30;1m335 | [0m[35m            return[0m
[30;1m336 | [0m[35m        curr_workspaces = self.settings.get("MSSentinel", {}).get("Workspaces")[0m
[30;1m337 | [0m[35m        curr_workspaces.update(self._last_workspace)[0m
[30;1m338 | [0m[35m        self.view_settings()[0m
[30;1m339 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1700[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_file.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m        """Import sentinel settings from portal URL."""[0m
[30;1m334 | [0m[35m        if not self._last_workspace:[0m
[30;1m335 | [0m[35m            return[0m
[30;1m336 | [0m[35m        curr_workspaces = self.settings.get("MSSentinel", {}).get("Workspaces")[0m
[30;1m337 | [0m[35m        curr_workspaces.update(self._last_workspace)[0m
[30;1m338 | [0m[35m        self.view_settings()[0m
[30;1m339 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1701[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_file.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m182 | [0m[35m        self.txt_default_config_path.value = file_name[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    def load_default(self):[0m
[30;1m185 | [0m[35m        """Load default settings specified by MSTICPYCONFIG env var."""[0m
[30;1m186 | [0m[35m        if self.mp_config_def_path:[0m
[30;1m187 | [0m[35m            self.current_file = self.mp_config_def_path[0m
[30;1m188 | [0m[35m            with suppress(FileNotFoundError):[0m

[31m--[ [0m[34mMatch #[0m[33m1702[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/mp_config_file.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m        file : Optional[str], optional[0m
[30;1m81 | [0m[35m            config file path to use.[0m
[30;1m82 | [0m[35m            If `file` is not supplied, the msticpyconfig path defaults to the system[0m
[30;1m83 | [0m[35m            default location for msticpyconfig.yaml (MSTICPYCONFIG env var,[0m
[30;1m84 | [0m[35m            current directory, home directory). This path will also be used as[0m
[30;1m85 | [0m[35m            the location to save any changed settings.[0m
[30;1m86 | [0m[35m            If `file` is supplied and exists, the configuration will be loaded from here,[0m

[31m--[ [0m[34mMatch #[0m[33m1703[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/proc_tree_build_winlx.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m309 | [0m[35m        "Unique merged_procs index in merge",[0m
[30;1m310 | [0m[35m        len(merged_procs[Col.source_index].unique()),[0m
[30;1m311 | [0m[35m    )[0m
[30;1m312 | [0m[35m    print("These two should add up to top line")[0m
[30;1m313 | [0m[35m    row_dups = len(rows_with_dups2)[0m
[30;1m314 | [0m[35m    print("Rows with dups", row_dups)[0m
[30;1m315 | [0m[35m    row_nodups = len([0m

[31m--[ [0m[34mMatch #[0m[33m1704[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/proc_tree_build_winlx.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m        child_join_cols = [schema.parent_id][0m
[30;1m190 | [0m[35m    # merge_asof merges on the "by" fields and then the closest time[0m
[30;1m191 | [0m[35m    # match in the time_stamp field. The default is to look backwards[0m
[30;1m192 | [0m[35m    # for a match on the right of the join (parent) that is a time earlier[0m
[30;1m193 | [0m[35m    # than the corresponding row on the left.[0m
[30;1m194 | [0m[35m    return pd.merge_asof([0m
[30;1m195 | [0m[35m        left=procs.sort_values(schema.time_stamp, ascending=True).drop([0m

[31m--[ [0m[34mMatch #[0m[33m1705[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/proc_tree_build_winlx.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m    else:[0m
[30;1m188 | [0m[35m        par_join_cols = [schema.process_id][0m
[30;1m189 | [0m[35m        child_join_cols = [schema.parent_id][0m
[30;1m190 | [0m[35m    # merge_asof merges on the "by" fields and then the closest time[0m
[30;1m191 | [0m[35m    # match in the time_stamp field. The default is to look backwards[0m
[30;1m192 | [0m[35m    # for a match on the right of the join (parent) that is a time earlier[0m
[30;1m193 | [0m[35m    # than the corresponding row on the left.[0m

[31m--[ [0m[34mMatch #[0m[33m1706[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_user.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m
[30;1m16 | [0m[35m      type: datetime[0m
[30;1m17 | [0m[35m    add_query_items:[0m
[30;1m18 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1707[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_user.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    data_source: "user_events"[0m
[30;1m10 | [0m[35m  parameters:[0m
[30;1m11 | [0m[35m    start:[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1708[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m    def _on_select_tab(self, change):[0m
[30;1m307 | [0m[35m        """Handle tab select index events."""[0m
[30;1m308 | [0m[35m        tab_index = change.get("new")[0m
[30;1m309 | [0m[35m        self._load_tab(tab_index)[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m    def add_tab(self, tab_name: str, control: CEItemsBase):[0m

[31m--[ [0m[34mMatch #[0m[33m1709[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m        path_elems = path.split(".")[0m
[30;1m53 | [0m[35m        curr_node = settings[0m
[30;1m54 | [0m[35m        for elem in path_elems:[0m
[30;1m55 | [0m[35m            curr_node = curr_node.get(elem)[0m
[30;1m56 | [0m[35m            if curr_node is None:[0m
[30;1m57 | [0m[35m                break[0m
[30;1m58 | [0m[35m        return curr_node[0m

[31m--[ [0m[34mMatch #[0m[33m1710[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m326 | [0m[35m        self._tab_state.append(dummy_ctrl)[0m
[30;1m327 | [0m[35m        self._tab_lazy_load[new_idx] = control_def[0m
[30;1m328 | [0m[35m        self.controls[tab_name] = dummy_ctrl[0m
[30;1m329 | [0m[35m        # Refresh tab control children and set title[0m
[30;1m330 | [0m[35m        self.tab.children = self._tab_state[0m
[30;1m331 | [0m[35m        self.tab.set_title(new_idx, tab_name)[0m
[30;1m332 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1711[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m321 | [0m[35m        """Add a lazily-loaded tab with name `tab_name` and definition `control_def`."""[0m
[30;1m322 | [0m[35m        self._tab_names.append(tab_name)[0m
[30;1m323 | [0m[35m        new_idx = len(self._tab_state)[0m
[30;1m324 | [0m[35m        # add dummy control to tab state and control def to lazy tab dict[0m
[30;1m325 | [0m[35m        dummy_ctrl = widgets.Label(value="loading...")[0m
[30;1m326 | [0m[35m        self._tab_state.append(dummy_ctrl)[0m
[30;1m327 | [0m[35m        self._tab_lazy_load[new_idx] = control_def[0m

[31m--[ [0m[34mMatch #[0m[33m1712[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m321 | [0m[35m        """Add a lazily-loaded tab with name `tab_name` and definition `control_def`."""[0m
[30;1m322 | [0m[35m        self._tab_names.append(tab_name)[0m
[30;1m323 | [0m[35m        new_idx = len(self._tab_state)[0m
[30;1m324 | [0m[35m        # add dummy control to tab state and control def to lazy tab dict[0m
[30;1m325 | [0m[35m        dummy_ctrl = widgets.Label(value="loading...")[0m
[30;1m326 | [0m[35m        self._tab_state.append(dummy_ctrl)[0m
[30;1m327 | [0m[35m        self._tab_lazy_load[new_idx] = control_def[0m

[31m--[ [0m[34mMatch #[0m[33m1713[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m315 | [0m[35m        self._tab_state.append(control.layout)[0m
[30;1m316 | [0m[35m        self.tab.children = self._tab_state[0m
[30;1m317 | [0m[35m        self.tab.set_title(new_idx, tab_name)[0m
[30;1m318 | [0m[35m        self.controls[tab_name] = control[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    def _add_lazy_tab(self, tab_name: str, control_def: CETabControlDef):[0m
[30;1m321 | [0m[35m        """Add a lazily-loaded tab with name `tab_name` and definition `control_def`."""[0m

[31m--[ [0m[34mMatch #[0m[33m1714[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m300 | [0m[35m            self._tab_state[tab_index] = ctrl.layout[0m
[30;1m301 | [0m[35m            # update the controls dict[0m
[30;1m302 | [0m[35m            self.controls[self._tab_names[tab_index]] = ctrl[0m
[30;1m303 | [0m[35m            # update the tab control children with the new state[0m
[30;1m304 | [0m[35m            self.tab.children = self._tab_state[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m    def _on_select_tab(self, change):[0m

[31m--[ [0m[34mMatch #[0m[33m1715[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m300 | [0m[35m            self._tab_state[tab_index] = ctrl.layout[0m
[30;1m301 | [0m[35m            # update the controls dict[0m
[30;1m302 | [0m[35m            self.controls[self._tab_names[tab_index]] = ctrl[0m
[30;1m303 | [0m[35m            # update the tab control children with the new state[0m
[30;1m304 | [0m[35m            self.tab.children = self._tab_state[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m    def _on_select_tab(self, change):[0m

[31m--[ [0m[34mMatch #[0m[33m1716[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m298 | [0m[35m            ctrl = wgt_cls(*args) if isinstance(args, list) else wgt_cls(**args)[0m
[30;1m299 | [0m[35m            # set this control as the current tab state[0m
[30;1m300 | [0m[35m            self._tab_state[tab_index] = ctrl.layout[0m
[30;1m301 | [0m[35m            # update the controls dict[0m
[30;1m302 | [0m[35m            self.controls[self._tab_names[tab_index]] = ctrl[0m
[30;1m303 | [0m[35m            # update the tab control children with the new state[0m
[30;1m304 | [0m[35m            self.tab.children = self._tab_state[0m

[31m--[ [0m[34mMatch #[0m[33m1717[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m296 | [0m[35m            wgt_cls, args = self._tab_lazy_load[tab_index][0m
[30;1m297 | [0m[35m            # initialize the class object with args or kwargs[0m
[30;1m298 | [0m[35m            ctrl = wgt_cls(*args) if isinstance(args, list) else wgt_cls(**args)[0m
[30;1m299 | [0m[35m            # set this control as the current tab state[0m
[30;1m300 | [0m[35m            self._tab_state[tab_index] = ctrl.layout[0m
[30;1m301 | [0m[35m            # update the controls dict[0m
[30;1m302 | [0m[35m            self.controls[self._tab_names[tab_index]] = ctrl[0m

[31m--[ [0m[34mMatch #[0m[33m1718[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m    def set_status(self, status, timeout: float = 3.0):[0m
[30;1m68 | [0m[35m        """Set the status text."""[0m
[30;1m69 | [0m[35m        self.status.value = status[0m
[30;1m70 | [0m[35m        if timeout == 0 or self.testing:[0m
[30;1m71 | [0m[35m            return[0m
[30;1m72 | [0m[35m        sleep(timeout)[0m
[30;1m73 | [0m[35m        self.clear_status()[0m

[31m--[ [0m[34mMatch #[0m[33m1719[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/comp_edit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""Component Edit base and mixin classes."""[0m
[30;1m7 | [0m[35mfrom abc import ABC, abstractmethod[0m
[30;1m8 | [0m[35mfrom time import sleep[0m
[30;1m9 | [0m[35mfrom typing import Any, Dict, List, Optional, Tuple, Union[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport ipywidgets as widgets[0m

[31m--[ [0m[34mMatch #[0m[33m1720[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_az_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m
[30;1m20 | [0m[35m        type: datetime[0m
[30;1m21 | [0m[35m      add_query_items:[0m
[30;1m22 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1721[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_az_network.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m        type: str[0m
[30;1m14 | [0m[35m        default: 'AzureNetworkAnalytics_CL'[0m
[30;1m15 | [0m[35m      start:[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1722[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azuresentinel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m        description: Dynamic Summary Name[0m
[30;1m214 | [0m[35m        type: str[0m
[30;1m215 | [0m[35m  list_dynamic_summaries:[0m
[30;1m216 | [0m[35m    description: Returns all Dynamic Summaries by time range[0m
[30;1m217 | [0m[35m    metadata:[0m
[30;1m218 | [0m[35m    args:[0m
[30;1m219 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m1723[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azuresentinel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m        type: str[0m
[30;1m92 | [0m[35m        default: na[0m
[30;1m93 | [0m[35m      ip_address:[0m
[30;1m94 | [0m[35m        description: IP address[0m
[30;1m95 | [0m[35m        type: str[0m
[30;1m96 | [0m[35m        default: na[0m
[30;1m97 | [0m[35m      domain:[0m

[31m--[ [0m[34mMatch #[0m[33m1724[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azuresentinel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m        | where SoftDeleted == false[0m
[30;1m45 | [0m[35m        {add_query_items}'[0m
[30;1m46 | [0m[35m  list_bookmarks_for_entity:[0m
[30;1m47 | [0m[35m    description: Retrieves bookmarks for a host, account, ip address, domain, url or other entity id[0m
[30;1m48 | [0m[35m    metadata:[0m
[30;1m49 | [0m[35m      pivot:[0m
[30;1m50 | [0m[35m        short_name: bookmarks[0m

[31m--[ [0m[34mMatch #[0m[33m1725[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azuresentinel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m      default: ""[0m
[30;1m29 | [0m[35msources:[0m
[30;1m30 | [0m[35m  list_bookmarks:[0m
[30;1m31 | [0m[35m    description: Retrieves list of bookmarks for a time range[0m
[30;1m32 | [0m[35m    metadata:[0m
[30;1m33 | [0m[35m    args:[0m
[30;1m34 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m1726[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azuresentinel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m      description: Query start time[0m
[30;1m21 | [0m[35m      type: datetime[0m
[30;1m22 | [0m[35m    end:[0m
[30;1m23 | [0m[35m      description: Query end time[0m
[30;1m24 | [0m[35m      type: datetime[0m
[30;1m25 | [0m[35m    add_query_items:[0m
[30;1m26 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1727[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_azuresentinel.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m      type: str[0m
[30;1m18 | [0m[35m      default: ""[0m
[30;1m19 | [0m[35m    start:[0m
[30;1m20 | [0m[35m      description: Query start time[0m
[30;1m21 | [0m[35m      type: datetime[0m
[30;1m22 | [0m[35m    end:[0m
[30;1m23 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1728[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m            self.cwd = src_event.get("cwd")[0m
[30;1m127 | [0m[35m            self.name = src_event.get("cwd")[0m
[30;1m128 | [0m[35m        else:[0m
[30;1m129 | [0m[35m            self.ProcessId = src_event.get("ProcessId")[0m
[30;1m130 | [0m[35m            self.ImageFile = File(src_event=src_event, role="parent")[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1729[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m            self.effective_group = src_event.get("effective_group")[0m
[30;1m125 | [0m[35m            self.egid = src_event.get("effective_group")[0m
[30;1m126 | [0m[35m            self.cwd = src_event.get("cwd")[0m
[30;1m127 | [0m[35m            self.name = src_event.get("cwd")[0m
[30;1m128 | [0m[35m        else:[0m
[30;1m129 | [0m[35m            self.ProcessId = src_event.get("ProcessId")[0m
[30;1m130 | [0m[35m            self.ImageFile = File(src_event=src_event, role="parent")[0m

[31m--[ [0m[34mMatch #[0m[33m1730[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m            self.euid = src_event.get("euid")[0m
[30;1m124 | [0m[35m            self.effective_group = src_event.get("effective_group")[0m
[30;1m125 | [0m[35m            self.egid = src_event.get("effective_group")[0m
[30;1m126 | [0m[35m            self.cwd = src_event.get("cwd")[0m
[30;1m127 | [0m[35m            self.name = src_event.get("cwd")[0m
[30;1m128 | [0m[35m        else:[0m
[30;1m129 | [0m[35m            self.ProcessId = src_event.get("ProcessId")[0m

[31m--[ [0m[34mMatch #[0m[33m1731[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m            self.effective_user = src_event.get("effective_user")[0m
[30;1m123 | [0m[35m            self.euid = src_event.get("euid")[0m
[30;1m124 | [0m[35m            self.effective_group = src_event.get("effective_group")[0m
[30;1m125 | [0m[35m            self.egid = src_event.get("effective_group")[0m
[30;1m126 | [0m[35m            self.cwd = src_event.get("cwd")[0m
[30;1m127 | [0m[35m            self.name = src_event.get("cwd")[0m
[30;1m128 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1732[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m            self.gid = src_event.get("gid")[0m
[30;1m122 | [0m[35m            self.effective_user = src_event.get("effective_user")[0m
[30;1m123 | [0m[35m            self.euid = src_event.get("euid")[0m
[30;1m124 | [0m[35m            self.effective_group = src_event.get("effective_group")[0m
[30;1m125 | [0m[35m            self.egid = src_event.get("effective_group")[0m
[30;1m126 | [0m[35m            self.cwd = src_event.get("cwd")[0m
[30;1m127 | [0m[35m            self.name = src_event.get("cwd")[0m

[31m--[ [0m[34mMatch #[0m[33m1733[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m            self.group = src_event.get("group")[0m
[30;1m121 | [0m[35m            self.gid = src_event.get("gid")[0m
[30;1m122 | [0m[35m            self.effective_user = src_event.get("effective_user")[0m
[30;1m123 | [0m[35m            self.euid = src_event.get("euid")[0m
[30;1m124 | [0m[35m            self.effective_group = src_event.get("effective_group")[0m
[30;1m125 | [0m[35m            self.egid = src_event.get("effective_group")[0m
[30;1m126 | [0m[35m            self.cwd = src_event.get("cwd")[0m

[31m--[ [0m[34mMatch #[0m[33m1734[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m            self.auid = src_event.get("auid")[0m
[30;1m120 | [0m[35m            self.group = src_event.get("group")[0m
[30;1m121 | [0m[35m            self.gid = src_event.get("gid")[0m
[30;1m122 | [0m[35m            self.effective_user = src_event.get("effective_user")[0m
[30;1m123 | [0m[35m            self.euid = src_event.get("euid")[0m
[30;1m124 | [0m[35m            self.effective_group = src_event.get("effective_group")[0m
[30;1m125 | [0m[35m            self.egid = src_event.get("effective_group")[0m

[31m--[ [0m[34mMatch #[0m[33m1735[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m            self.audit_user = src_event.get("audit_user")[0m
[30;1m119 | [0m[35m            self.auid = src_event.get("auid")[0m
[30;1m120 | [0m[35m            self.group = src_event.get("group")[0m
[30;1m121 | [0m[35m            self.gid = src_event.get("gid")[0m
[30;1m122 | [0m[35m            self.effective_user = src_event.get("effective_user")[0m
[30;1m123 | [0m[35m            self.euid = src_event.get("euid")[0m
[30;1m124 | [0m[35m            self.effective_group = src_event.get("effective_group")[0m

[31m--[ [0m[34mMatch #[0m[33m1736[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m            self.success = src_event.get("success")[0m
[30;1m118 | [0m[35m            self.audit_user = src_event.get("audit_user")[0m
[30;1m119 | [0m[35m            self.auid = src_event.get("auid")[0m
[30;1m120 | [0m[35m            self.group = src_event.get("group")[0m
[30;1m121 | [0m[35m            self.gid = src_event.get("gid")[0m
[30;1m122 | [0m[35m            self.effective_user = src_event.get("effective_user")[0m
[30;1m123 | [0m[35m            self.euid = src_event.get("euid")[0m

[31m--[ [0m[34mMatch #[0m[33m1737[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m            # Linux properties[0m
[30;1m117 | [0m[35m            self.success = src_event.get("success")[0m
[30;1m118 | [0m[35m            self.audit_user = src_event.get("audit_user")[0m
[30;1m119 | [0m[35m            self.auid = src_event.get("auid")[0m
[30;1m120 | [0m[35m            self.group = src_event.get("group")[0m
[30;1m121 | [0m[35m            self.gid = src_event.get("gid")[0m
[30;1m122 | [0m[35m            self.effective_user = src_event.get("effective_user")[0m

[31m--[ [0m[34mMatch #[0m[33m1738[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m            # Linux properties[0m
[30;1m117 | [0m[35m            self.success = src_event.get("success")[0m
[30;1m118 | [0m[35m            self.audit_user = src_event.get("audit_user")[0m
[30;1m119 | [0m[35m            self.auid = src_event.get("auid")[0m
[30;1m120 | [0m[35m            self.group = src_event.get("group")[0m
[30;1m121 | [0m[35m            self.gid = src_event.get("gid")[0m

[31m--[ [0m[34mMatch #[0m[33m1739[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m                self.ParentProcess = parent[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m            # Linux properties[0m
[30;1m117 | [0m[35m            self.success = src_event.get("success")[0m
[30;1m118 | [0m[35m            self.audit_user = src_event.get("audit_user")[0m
[30;1m119 | [0m[35m            self.auid = src_event.get("auid")[0m
[30;1m120 | [0m[35m            self.group = src_event.get("group")[0m

[31m--[ [0m[34mMatch #[0m[33m1740[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m    def _create_from_event(self, src_event, role):[0m
[30;1m102 | [0m[35m        if role == "new":[0m
[30;1m103 | [0m[35m            self.ProcessId = src_event.get("NewProcessId")[0m
[30;1m104 | [0m[35m            self.CommandLine = src_event.get("CommandLine")[0m
[30;1m105 | [0m[35m            if "TimeCreatedUtc" in src_event:[0m
[30;1m106 | [0m[35m                self.CreationTimeUtc = src_event["TimeCreatedUtc"][0m
[30;1m107 | [0m[35m            elif "TimeGenerated" in src_event:[0m

[31m--[ [0m[34mMatch #[0m[33m1741[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    def _create_from_event(self, src_event, role):[0m
[30;1m102 | [0m[35m        if role == "new":[0m
[30;1m103 | [0m[35m            self.ProcessId = src_event.get("NewProcessId")[0m
[30;1m104 | [0m[35m            self.CommandLine = src_event.get("CommandLine")[0m
[30;1m105 | [0m[35m            if "TimeCreatedUtc" in src_event:[0m
[30;1m106 | [0m[35m                self.CreationTimeUtc = src_event["TimeCreatedUtc"][0m

[31m--[ [0m[34mMatch #[0m[33m1742[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m            if the Pivot environment does not have one.[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        """[0m
[30;1m224 | [0m[35m        return self._providers.get(name)[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    def edit_query_time(self, timespan: Optional[TimeSpan] = None):[0m
[30;1m227 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1743[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m320 | [0m[35m        return self.timespan[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m    def reset_timespan(self):[0m
[30;1m323 | [0m[35m        """Reset the time range used to [now - 1day] - [now]."""[0m
[30;1m324 | [0m[35m        now = datetime.now(timezone.utc)[0m
[30;1m325 | [0m[35m        self._query_time.set_time([0m
[30;1m326 | [0m[35m            start=now - timedelta(1),[0m

[31m--[ [0m[34mMatch #[0m[33m1744[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    @property[0m
[30;1m257 | [0m[35m    def end(self):[0m
[30;1m258 | [0m[35m        """Return current end time for queries."""[0m
[30;1m259 | [0m[35m        return self._query_time.end[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1745[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m    @property[0m
[30;1m252 | [0m[35m    def start(self):[0m
[30;1m253 | [0m[35m        """Return current start time for queries."""[0m
[30;1m254 | [0m[35m        return self._query_time.start[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1746[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m244 | [0m[35m            origin_time=datetime.now(timezone.utc),[0m
[30;1m245 | [0m[35m            before=before,[0m
[30;1m246 | [0m[35m            after=0,[0m
[30;1m247 | [0m[35m            label="Set time range for pivot functions.",[0m
[30;1m248 | [0m[35m            units=units,[0m
[30;1m249 | [0m[35m        )[0m
[30;1m250 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1747[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m            from `namespace`), by default None[0m
[30;1m72 | [0m[35m        timespan : Optional[TimeSpan], optional[0m
[30;1m73 | [0m[35m            The default timespan used by providers that require[0m
[30;1m74 | [0m[35m            start and end times. By default the time range is initialized[0m
[30;1m75 | [0m[35m            to be 24 hours prior to the load time.[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1748[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_process.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m      default: ""[0m
[30;1m25 | [0m[35msources:[0m
[30;1m26 | [0m[35m  list_host_processes:[0m
[30;1m27 | [0m[35m    description: Return all process creations for a host for the specified time range[0m
[30;1m28 | [0m[35m    metadata:[0m
[30;1m29 | [0m[35m      pivot:[0m
[30;1m30 | [0m[35m        short_name: processes[0m

[31m--[ [0m[34mMatch #[0m[33m1749[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_process.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m
[30;1m20 | [0m[35m      type: datetime[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1750[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_process.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m      type: str[0m
[30;1m14 | [0m[35m      default: "DeviceProcessEvents"[0m
[30;1m15 | [0m[35m    start:[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1751[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_file.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m      type: str[0m
[30;1m24 | [0m[35m      default: ""[0m
[30;1m25 | [0m[35m    time_column:[0m
[30;1m26 | [0m[35m      description: The name of the column detailing the time the event was generated.[0m
[30;1m27 | [0m[35m      type: str[0m
[30;1m28 | [0m[35m      default: "Timestamp"[0m
[30;1m29 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m1752[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_file.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m
[30;1m20 | [0m[35m      type: datetime[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1753[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mde/kql_mdatp_file.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m      type: str[0m
[30;1m14 | [0m[35m      default: "DeviceFileEvents"[0m
[30;1m15 | [0m[35m    start:[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1754[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/azure_resource.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m        res_match = re.search("/resource/(?P<res_path>.+)", self.ResourceId)[0m
[30;1m100 | [0m[35m        if not res_match:[0m
[30;1m101 | [0m[35m            return[0m
[30;1m102 | [0m[35m        res_elems = res_match.groupdict().get("res_path", "").split("/")[0m
[30;1m103 | [0m[35m        keys = islice(res_elems, 0, len(res_elems), 2)[0m
[30;1m104 | [0m[35m        vals = islice(res_elems, 1, len(res_elems), 2)[0m
[30;1m105 | [0m[35m        self.ResourceIdParts = dict(zip(keys, vals))[0m

[31m--[ [0m[34mMatch #[0m[33m1755[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/azure_resource.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m    @property[0m
[30;1m83 | [0m[35m    def Provider(self):  # noqa: N802[0m
[30;1m84 | [0m[35m        """Return the Provider name or None."""  # noqa: N802[0m
[30;1m85 | [0m[35m        return self.ResourceIdParts.get("providers")[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    _entity_schema = {[0m
[30;1m88 | [0m[35m        # ResourceId (type System.String)[0m

[31m--[ [0m[34mMatch #[0m[33m1756[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/azure_resource.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    @property[0m
[30;1m78 | [0m[35m    def ResourceGroup(self):  # noqa: N802[0m
[30;1m79 | [0m[35m        """Return the ResourceGroup name or None."""  # noqa: N802[0m
[30;1m80 | [0m[35m        return self.ResourceIdParts.get("resourceGroups")[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    @property[0m
[30;1m83 | [0m[35m    def Provider(self):  # noqa: N802[0m

[31m--[ [0m[34mMatch #[0m[33m1757[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/azure_resource.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    @property[0m
[30;1m73 | [0m[35m    def SubscriptionId(self):  # noqa: N802[0m
[30;1m74 | [0m[35m        """Return the subscription Id or None."""  # noqa: N802[0m
[30;1m75 | [0m[35m        return self.ResourceIdParts.get("subscriptions")[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    @property[0m
[30;1m78 | [0m[35m    def ResourceGroup(self):  # noqa: N802[0m

[31m--[ [0m[34mMatch #[0m[33m1758[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_pandas_accessors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m            Name of the output column for ASN description,[0m
[30;1m232 | [0m[35m            by default "ASNDescription"[0m
[30;1m233 | [0m[35m        ip_column : str, optional[0m
[30;1m234 | [0m[35m            Name of the output column for full whois data,[0m
[30;1m235 | [0m[35m            by default "WhoIsData"[0m
[30;1m236 | [0m[35m        show_progress : bool, optional[0m
[30;1m237 | [0m[35m            Show progress for each query, by default False[0m

[31m--[ [0m[34mMatch #[0m[33m1759[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_pandas_accessors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m        Parameters[0m
[30;1m224 | [0m[35m        ----------[0m
[30;1m225 | [0m[35m        ip_column : str[0m
[30;1m226 | [0m[35m            Column name of IP Address to look up.[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        Other Parameters[0m
[30;1m229 | [0m[35m        ----------------[0m

[31m--[ [0m[34mMatch #[0m[33m1760[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_pandas_accessors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m        target_attrs : Optional[List[str]], optional[0m
[30;1m181 | [0m[35m            Optional list of columns to use as target node attributes, by default None[0m
[30;1m182 | [0m[35m        edge_attrs : Optional[List[str]], optional[0m
[30;1m183 | [0m[35m            Optional list of columns to use as edge node attributes, by default None[0m
[30;1m184 | [0m[35m        graph_type : str[0m
[30;1m185 | [0m[35m            "graph" or "digraph" (for nx.DiGraph)[0m
[30;1m186 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1761[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_pandas_accessors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m        source_attrs : Optional[List[str]], optional[0m
[30;1m179 | [0m[35m            Optional list of columns to use as source node attributes, by default None[0m
[30;1m180 | [0m[35m        target_attrs : Optional[List[str]], optional[0m
[30;1m181 | [0m[35m            Optional list of columns to use as target node attributes, by default None[0m
[30;1m182 | [0m[35m        edge_attrs : Optional[List[str]], optional[0m
[30;1m183 | [0m[35m            Optional list of columns to use as edge node attributes, by default None[0m
[30;1m184 | [0m[35m        graph_type : str[0m

[31m--[ [0m[34mMatch #[0m[33m1762[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_pandas_accessors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m        target_col : str[0m
[30;1m177 | [0m[35m            Column for target nodes.[0m
[30;1m178 | [0m[35m        source_attrs : Optional[List[str]], optional[0m
[30;1m179 | [0m[35m            Optional list of columns to use as source node attributes, by default None[0m
[30;1m180 | [0m[35m        target_attrs : Optional[List[str]], optional[0m
[30;1m181 | [0m[35m            Optional list of columns to use as target node attributes, by default None[0m
[30;1m182 | [0m[35m        edge_attrs : Optional[List[str]], optional[0m

[31m--[ [0m[34mMatch #[0m[33m1763[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_processes.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m144 | [0m[35m      pid:[0m
[30;1m145 | [0m[35m        description: Process Id to search for[0m
[30;1m146 | [0m[35m        type: list[0m
[30;1m147 | [0m[35m      hostname:[0m
[30;1m148 | [0m[35m        description: Hostname where the process is running[0m
[30;1m149 | [0m[35m        type: list[0m

[31m--[ [0m[34mMatch #[0m[33m1764[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_processes.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m126 | [0m[35m                      },[0m
[30;1m127 | [0m[35m                      {[0m
[30;1m128 | [0m[35m                          "facetName": "ownerMachine",[0m
[30;1m129 | [0m[35m                          "values":[ "{hostname}" ],[0m
[30;1m130 | [0m[35m                          "filterType":"ContainsIgnoreCase"[0m
[30;1m131 | [0m[35m                      },[0m
[30;1m132 | [0m[35m                      {[0m

[31m--[ [0m[34mMatch #[0m[33m1765[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_processes.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m110 | [0m[35m        description: Suspicion that the process should have[0m
[30;1m111 | [0m[35m        type: str[0m
[30;1m112 | [0m[35m  find_process_by_pid:[0m
[30;1m113 | [0m[35m    description: Search for a process by pid and hostname[0m
[30;1m114 | [0m[35m    metadata:[0m
[30;1m115 | [0m[35m    args:[0m
[30;1m116 | [0m[35m      query: |-[0m

[31m--[ [0m[34mMatch #[0m[33m1766[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_processes.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m      type: str[0m
[30;1m23 | [0m[35m      default: creationTime[0m
[30;1m24 | [0m[35m    timeFeatureId:[0m
[30;1m25 | [0m[35m      description: Time boundary[0m
[30;1m26 | [0m[35m      type: str[0m
[30;1m27 | [0m[35m      default: startFeatureId[0m
[30;1m28 | [0m[35m    customFields:[0m

[31m--[ [0m[34mMatch #[0m[33m1767[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_processes.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m      type: datetime[0m
[30;1m19 | [0m[35m      default: 0[0m
[30;1m20 | [0m[35m    timefield:[0m
[30;1m21 | [0m[35m      description: Field to use for time[0m
[30;1m22 | [0m[35m      type: str[0m
[30;1m23 | [0m[35m      default: creationTime[0m
[30;1m24 | [0m[35m    timeFeatureId:[0m

[31m--[ [0m[34mMatch #[0m[33m1768[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_processes.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m      type: datetime[0m
[30;1m15 | [0m[35m      default: -7[0m
[30;1m16 | [0m[35m    end:[0m
[30;1m17 | [0m[35m      description: Query end time[0m
[30;1m18 | [0m[35m      type: datetime[0m
[30;1m19 | [0m[35m      default: 0[0m
[30;1m20 | [0m[35m    timefield:[0m

[31m--[ [0m[34mMatch #[0m[33m1769[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_processes.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    data_source: "hunting_queries"[0m
[30;1m11 | [0m[35m  parameters:[0m
[30;1m12 | [0m[35m    start:[0m
[30;1m13 | [0m[35m      description: Query start time[0m
[30;1m14 | [0m[35m      type: datetime[0m
[30;1m15 | [0m[35m      default: -7[0m
[30;1m16 | [0m[35m    end:[0m

[31m--[ [0m[34mMatch #[0m[33m1770[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity_graph.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    def __str__(self):[0m
[30;1m72 | [0m[35m        """Return string representation of edge."""[0m
[30;1m73 | [0m[35m        return self.attrs.get("name", "unnamed-edge")[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    def __repr__(self):[0m
[30;1m76 | [0m[35m        """Return full repr of edge."""[0m

[31m--[ [0m[34mMatch #[0m[33m1771[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        """[0m
[30;1m62 | [0m[35m        self.source: Node = source[0m
[30;1m63 | [0m[35m        self.target: Node = target[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        self.attrs: Dict[str, Any] = attrs or {}[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1772[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m            Dictionary of name/value edge attributes, by default None[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        """[0m
[30;1m62 | [0m[35m        self.source: Node = source[0m
[30;1m63 | [0m[35m        self.target: Node = target[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        self.attrs: Dict[str, Any] = attrs or {}[0m

[31m--[ [0m[34mMatch #[0m[33m1773[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m        ----------[0m
[30;1m54 | [0m[35m        source : Node[0m
[30;1m55 | [0m[35m            Source node.[0m
[30;1m56 | [0m[35m        target : Node[0m
[30;1m57 | [0m[35m            Target node.[0m
[30;1m58 | [0m[35m        attrs : Dict[str, Any], optional[0m
[30;1m59 | [0m[35m            Dictionary of name/value edge attributes, by default None[0m

[31m--[ [0m[34mMatch #[0m[33m1774[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        Parameters[0m
[30;1m53 | [0m[35m        ----------[0m
[30;1m54 | [0m[35m        source : Node[0m
[30;1m55 | [0m[35m            Source node.[0m
[30;1m56 | [0m[35m        target : Node[0m
[30;1m57 | [0m[35m            Target node.[0m

[31m--[ [0m[34mMatch #[0m[33m1775[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m            target.edges.add(edge)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    def has_edge(self, other):[0m
[30;1m41 | [0m[35m        """Return True if node has an edge with `other`."""[0m
[30;1m42 | [0m[35m        return any(edge for edge in self.edges if other in (edge.target, edge.source))[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1776[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m        Parameters[0m
[30;1m27 | [0m[35m        ----------[0m
[30;1m28 | [0m[35m        target : Node[0m
[30;1m29 | [0m[35m            Target node.[0m
[30;1m30 | [0m[35m        edge_attrs : Optional[Dict[str, Any]], optional[0m
[30;1m31 | [0m[35m            Attributes to assign to new edge, by default None[0m

[31m--[ [0m[34mMatch #[0m[33m1777[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m        net_cidr: str = "No network data retrieved."[0m
[30;1m742 | [0m[35m    else:[0m
[30;1m743 | [0m[35m        net_cidr = " ".join([0m
[30;1m744 | [0m[35m            f"{net_data[net_prefix]}/{net_data.get('length', '')}"[0m
[30;1m745 | [0m[35m            for net_prefix in net_prefixes[0m
[30;1m746 | [0m[35m        )[0m
[30;1m747 | [0m[35m    address: str | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m1778[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35mdef _create_net(data: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m736 | [0m[35m    """Create a network object from RDAP data."""[0m
[30;1m737 | [0m[35m    net_data: dict[str, Any] = data.get("cidr0_cidrs", [None])[0] or {}[0m
[30;1m738 | [0m[35m    net_prefixes: set[str] = net_data.keys() & {"v4prefix", "v6prefix"}[0m
[30;1m739 | [0m[35m[0m
[30;1m740 | [0m[35m    if not net_data or not net_prefixes:[0m

[31m--[ [0m[34mMatch #[0m[33m1779[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m704 | [0m[35mdef _run_rdap_query(url: str) -> httpx.Response | None:[0m
[30;1m705 | [0m[35m    """Execute rdap query call and handle errors."""[0m
[30;1m706 | [0m[35m    try:[0m
[30;1m707 | [0m[35m        return httpx.get(url)[0m
[30;1m708 | [0m[35m    except (httpx.WriteError, httpx.ReadError):[0m
[30;1m709 | [0m[35m        return None[0m
[30;1m710 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1780[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m670 | [0m[35m            for link in rdap_data_content["links"]:[0m
[30;1m671 | [0m[35m                if link["rel"] == "up":[0m
[30;1m672 | [0m[35m                    up_data_link: str = link["href"][0m
[30;1m673 | [0m[35m                    up_rdap_data: httpx.Response = httpx.get(up_data_link)[0m
[30;1m674 | [0m[35m                    up_rdap_data_content: dict[str, Any] = up_rdap_data.json()[0m
[30;1m675 | [0m[35m                    up_net: dict[str, Any] = _create_net(up_rdap_data_content)[0m
[30;1m676 | [0m[35m                    ipwhois_result.properties["nets"].append(up_net)[0m

[31m--[ [0m[34mMatch #[0m[33m1781[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m638 | [0m[35m        ipwhois_result.properties["asn_registry"] = asn_items["Registry"][0m
[30;1m639 | [0m[35m        ipwhois_result.properties["asn_date"] = asn_items["Allocated"][0m
[30;1m640 | [0m[35m        ipwhois_result.properties["asn_description"] = asn_items["AS Name"][0m
[30;1m641 | [0m[35m        registry_url = _REGISTRIES.get(asn_items.get("Registry", ""), {}).get("url")[0m
[30;1m642 | [0m[35m    if not asn_items or not registry_url:[0m
[30;1m643 | [0m[35m        return _IpWhoIsResult(None)[0m
[30;1m644 | [0m[35m    return _add_rdap_data([0m

[31m--[ [0m[34mMatch #[0m[33m1782[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m638 | [0m[35m        ipwhois_result.properties["asn_registry"] = asn_items["Registry"][0m
[30;1m639 | [0m[35m        ipwhois_result.properties["asn_date"] = asn_items["Allocated"][0m
[30;1m640 | [0m[35m        ipwhois_result.properties["asn_description"] = asn_items["AS Name"][0m
[30;1m641 | [0m[35m        registry_url = _REGISTRIES.get(asn_items.get("Registry", ""), {}).get("url")[0m
[30;1m642 | [0m[35m    if not asn_items or not registry_url:[0m
[30;1m643 | [0m[35m        return _IpWhoIsResult(None)[0m
[30;1m644 | [0m[35m    return _add_rdap_data([0m

[31m--[ [0m[34mMatch #[0m[33m1783[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m638 | [0m[35m        ipwhois_result.properties["asn_registry"] = asn_items["Registry"][0m
[30;1m639 | [0m[35m        ipwhois_result.properties["asn_date"] = asn_items["Allocated"][0m
[30;1m640 | [0m[35m        ipwhois_result.properties["asn_description"] = asn_items["AS Name"][0m
[30;1m641 | [0m[35m        registry_url = _REGISTRIES.get(asn_items.get("Registry", ""), {}).get("url")[0m
[30;1m642 | [0m[35m    if not asn_items or not registry_url:[0m
[30;1m643 | [0m[35m        return _IpWhoIsResult(None)[0m
[30;1m644 | [0m[35m    return _add_rdap_data([0m

[31m--[ [0m[34mMatch #[0m[33m1784[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        nonlocal asns_dict[0m
[30;1m75 | [0m[35m        if not asns_dict:[0m
[30;1m76 | [0m[35m            try:[0m
[30;1m77 | [0m[35m                asns_resp: httpx.Response = httpx.get(_POTAROO_ASNS_URL)[0m
[30;1m78 | [0m[35m            except httpx.ConnectError as err:[0m
[30;1m79 | [0m[35m                err_msg: str = "Unable to get ASN details from potaroo.net"[0m
[30;1m80 | [0m[35m                raise MsticpyConnectionError(err_msg) from err[0m

[31m--[ [0m[34mMatch #[0m[33m1785[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m189 | [0m[35m    # Produce ip_entity record using available dataframes[0m
[30;1m190 | [0m[35m    ip_hb: pd.Series[str] = heartbeat_df.iloc[0][0m
[30;1m191 | [0m[35m    ip_entity.Address = ip_hb["ComputerIP"][0m
[30;1m192 | [0m[35m    ip_entity.hostname = ip_hb["Computer"][0m
[30;1m193 | [0m[35m    ip_entity.SourceComputerId = ip_hb["SourceComputerId"][0m
[30;1m194 | [0m[35m    ip_entity.OSType = ip_hb["OSType"][0m
[30;1m195 | [0m[35m    ip_entity.OSName = ip_hb["OSName"][0m

[31m--[ [0m[34mMatch #[0m[33m1786[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m468 | [0m[35m    raw : bool, optional[0m
[30;1m469 | [0m[35m        Set True if raw whois result wanted, by default False[0m
[30;1m470 | [0m[35m    query_rate : float, optional[0m
[30;1m471 | [0m[35m        Controls the rate at which queries are made, by default 0.5[0m
[30;1m472 | [0m[35m    retry_count : int, optional[0m
[30;1m473 | [0m[35m        The number of times to retry a query if it fails, default is 5[0m
[30;1m474 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1787[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m348 | [0m[35m    ip_column : str[0m
[30;1m349 | [0m[35m        Column name of IP Address to look up.[0m
[30;1m350 | [0m[35m    all_columns:[0m
[30;1m351 | [0m[35m        Expand all whois data to columns.[0m
[30;1m352 | [0m[35m    asn_col : str, optional[0m
[30;1m353 | [0m[35m        Name of the output column for ASN description,[0m
[30;1m354 | [0m[35m        by default "ASNDescription".[0m

[31m--[ [0m[34mMatch #[0m[33m1788[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m773 | [0m[35m    port: int = 43,[0m
[30;1m774 | [0m[35m    retry_count: int = 5,[0m
[30;1m775 | [0m[35m) -> str:[0m
[30;1m776 | [0m[35m    """Connect to whois server and send query."""[0m
[30;1m777 | [0m[35m    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as conn:[0m
[30;1m778 | [0m[35m        conn.connect((server, port))[0m
[30;1m779 | [0m[35m        conn.send(query.encode())[0m

[31m--[ [0m[34mMatch #[0m[33m1789[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m710 | [0m[35m[0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35mdef _whois_result_to_pandas(results: str | list[str] | dict[str, Any]) -> pd.DataFrame:[0m
[30;1m713 | [0m[35m    """Transform whois results to a Pandas DataFrame."""[0m
[30;1m714 | [0m[35m    if isinstance(results, dict):[0m
[30;1m715 | [0m[35m        return pd.DataFrame([0m
[30;1m716 | [0m[35m            [result or {"query": idx} for idx, result in results.items()],[0m

[31m--[ [0m[34mMatch #[0m[33m1790[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m656 | [0m[35m    *,[0m
[30;1m657 | [0m[35m    raw: bool,[0m
[30;1m658 | [0m[35m) -> _IpWhoIsResult:[0m
[30;1m659 | [0m[35m    """Add RDAP data to WhoIs result."""[0m
[30;1m660 | [0m[35m    retries = 0[0m
[30;1m661 | [0m[35m    while retries < retry_count:[0m
[30;1m662 | [0m[35m        rdap_data: httpx.Response = _rdap_lookup([0m

[31m--[ [0m[34mMatch #[0m[33m1791[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m629 | [0m[35m        ip_addr = ip_addr.Address[0m
[30;1m630 | [0m[35m    asn_items: dict[str, Any] = get_asn_from_ip(ip_addr.strip())[0m
[30;1m631 | [0m[35m    registry_url: str | None = None[0m
[30;1m632 | [0m[35m    if asn_items and "Error: no ASN or IP match on line 1." not in asn_items:[0m
[30;1m633 | [0m[35m        ipwhois_result: _IpWhoIsResult = _IpWhoIsResult(asn_items["AS Name"], {})[0m
[30;1m634 | [0m[35m        ipwhois_result.properties["asn"] = asn_items["AS"][0m
[30;1m635 | [0m[35m        ipwhois_result.properties["query"] = asn_items["IP"][0m

[31m--[ [0m[34mMatch #[0m[33m1792[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m624 | [0m[35m    raw: bool = False,[0m
[30;1m625 | [0m[35m    retry_count: int = 5,[0m
[30;1m626 | [0m[35m) -> _IpWhoIsResult:[0m
[30;1m627 | [0m[35m    """Conduct lookup of IP Whois information."""[0m
[30;1m628 | [0m[35m    if isinstance(ip_addr, IpAddress):[0m
[30;1m629 | [0m[35m        ip_addr = ip_addr.Address[0m
[30;1m630 | [0m[35m    asn_items: dict[str, Any] = get_asn_from_ip(ip_addr.strip())[0m

[31m--[ [0m[34mMatch #[0m[33m1793[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m587 | [0m[35m        Details of the ASN that the IP belongs to.[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35m    """[0m
[30;1m590 | [0m[35m    ip_param: str | IpAddress | None = ip or ip_address[0m
[30;1m591 | [0m[35m    if not ip_param:[0m
[30;1m592 | [0m[35m        return {}[0m
[30;1m593 | [0m[35m    if isinstance(ip_param, IpAddress):[0m

[31m--[ [0m[34mMatch #[0m[33m1794[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m584 | [0m[35m    Returns[0m
[30;1m585 | [0m[35m    -------[0m
[30;1m586 | [0m[35m    dict[0m
[30;1m587 | [0m[35m        Details of the ASN that the IP belongs to.[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35m    """[0m
[30;1m590 | [0m[35m    ip_param: str | IpAddress | None = ip or ip_address[0m

[31m--[ [0m[34mMatch #[0m[33m1795[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m579 | [0m[35m    ip : Union[str, IpAddress][0m
[30;1m580 | [0m[35m        IP address to lookup.[0m
[30;1m581 | [0m[35m    ip_address : Union[str, IpAddress][0m
[30;1m582 | [0m[35m        IP address to lookup (alias of `ip`).[0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35m    Returns[0m
[30;1m585 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m1796[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m577 | [0m[35m    Parameters[0m
[30;1m578 | [0m[35m    ----------[0m
[30;1m579 | [0m[35m    ip : Union[str, IpAddress][0m
[30;1m580 | [0m[35m        IP address to lookup.[0m
[30;1m581 | [0m[35m    ip_address : Union[str, IpAddress][0m
[30;1m582 | [0m[35m        IP address to lookup (alias of `ip`).[0m
[30;1m583 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1797[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m576 | [0m[35m[0m
[30;1m577 | [0m[35m    Parameters[0m
[30;1m578 | [0m[35m    ----------[0m
[30;1m579 | [0m[35m    ip : Union[str, IpAddress][0m
[30;1m580 | [0m[35m        IP address to lookup.[0m
[30;1m581 | [0m[35m    ip_address : Union[str, IpAddress][0m
[30;1m582 | [0m[35m        IP address to lookup (alias of `ip`).[0m

[31m--[ [0m[34mMatch #[0m[33m1798[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m572 | [0m[35m    ip_address: str | IpAddress | None = None,[0m
[30;1m573 | [0m[35m) -> dict[str, Any]:[0m
[30;1m574 | [0m[35m    """[0m
[30;1m575 | [0m[35m    Get the ASN that an IP belongs to.[0m
[30;1m576 | [0m[35m[0m
[30;1m577 | [0m[35m    Parameters[0m
[30;1m578 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1799[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m486 | [0m[35m    """[0m
[30;1m487 | [0m[35m    ip = ip if ip is not None else ip_address[0m
[30;1m488 | [0m[35m    if ip is None:[0m
[30;1m489 | [0m[35m        err_msg: str = "One of ip or ip_address parameters must be supplied."[0m
[30;1m490 | [0m[35m        raise ValueError(err_msg)[0m
[30;1m491 | [0m[35m    if isinstance(ip, (list, pd.Series)):[0m
[30;1m492 | [0m[35m        rate_limit: bool = len(ip) > RATE_LIMIT_THRESHOLD[0m

[31m--[ [0m[34mMatch #[0m[33m1800[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m    """[0m
[30;1m487 | [0m[35m    ip = ip if ip is not None else ip_address[0m
[30;1m488 | [0m[35m    if ip is None:[0m
[30;1m489 | [0m[35m        err_msg: str = "One of ip or ip_address parameters must be supplied."[0m
[30;1m490 | [0m[35m        raise ValueError(err_msg)[0m
[30;1m491 | [0m[35m    if isinstance(ip, (list, pd.Series)):[0m

[31m--[ [0m[34mMatch #[0m[33m1801[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m484 | [0m[35m        If neither `ip` nor `ip_address` is supplied.[0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m    """[0m
[30;1m487 | [0m[35m    ip = ip if ip is not None else ip_address[0m
[30;1m488 | [0m[35m    if ip is None:[0m
[30;1m489 | [0m[35m        err_msg: str = "One of ip or ip_address parameters must be supplied."[0m
[30;1m490 | [0m[35m        raise ValueError(err_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1802[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m484 | [0m[35m        If neither `ip` nor `ip_address` is supplied.[0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m    """[0m
[30;1m487 | [0m[35m    ip = ip if ip is not None else ip_address[0m
[30;1m488 | [0m[35m    if ip is None:[0m
[30;1m489 | [0m[35m        err_msg: str = "One of ip or ip_address parameters must be supplied."[0m
[30;1m490 | [0m[35m        raise ValueError(err_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1803[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m484 | [0m[35m        If neither `ip` nor `ip_address` is supplied.[0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m    """[0m
[30;1m487 | [0m[35m    ip = ip if ip is not None else ip_address[0m
[30;1m488 | [0m[35m    if ip is None:[0m
[30;1m489 | [0m[35m        err_msg: str = "One of ip or ip_address parameters must be supplied."[0m
[30;1m490 | [0m[35m        raise ValueError(err_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1804[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m475 | [0m[35m    Returns[0m
[30;1m476 | [0m[35m    -------[0m
[30;1m477 | [0m[35m    Union[pd.DataFrame, Dict][0m
[30;1m478 | [0m[35m        If a single IP Address provided result is a dictionary[0m
[30;1m479 | [0m[35m        if multiple provided results are formatted as a dataframe.[0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m    Raises[0m

[31m--[ [0m[34mMatch #[0m[33m1805[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m466 | [0m[35m    ip_address : Union[IpAddress, str, List][0m
[30;1m467 | [0m[35m        An IP address or list of IP addresses to lookup. Alias of `ip`.[0m
[30;1m468 | [0m[35m    raw : bool, optional[0m
[30;1m469 | [0m[35m        Set True if raw whois result wanted, by default False[0m
[30;1m470 | [0m[35m    query_rate : float, optional[0m
[30;1m471 | [0m[35m        Controls the rate at which queries are made, by default 0.5[0m
[30;1m472 | [0m[35m    retry_count : int, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1806[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m464 | [0m[35m    ip : Union[IpAddress, str, List][0m
[30;1m465 | [0m[35m        An IP address or list of IP addresses to lookup.[0m
[30;1m466 | [0m[35m    ip_address : Union[IpAddress, str, List][0m
[30;1m467 | [0m[35m        An IP address or list of IP addresses to lookup. Alias of `ip`.[0m
[30;1m468 | [0m[35m    raw : bool, optional[0m
[30;1m469 | [0m[35m        Set True if raw whois result wanted, by default False[0m
[30;1m470 | [0m[35m    query_rate : float, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1807[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m464 | [0m[35m    ip : Union[IpAddress, str, List][0m
[30;1m465 | [0m[35m        An IP address or list of IP addresses to lookup.[0m
[30;1m466 | [0m[35m    ip_address : Union[IpAddress, str, List][0m
[30;1m467 | [0m[35m        An IP address or list of IP addresses to lookup. Alias of `ip`.[0m
[30;1m468 | [0m[35m    raw : bool, optional[0m
[30;1m469 | [0m[35m        Set True if raw whois result wanted, by default False[0m
[30;1m470 | [0m[35m    query_rate : float, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1808[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m    Parameters[0m
[30;1m463 | [0m[35m    ----------[0m
[30;1m464 | [0m[35m    ip : Union[IpAddress, str, List][0m
[30;1m465 | [0m[35m        An IP address or list of IP addresses to lookup.[0m
[30;1m466 | [0m[35m    ip_address : Union[IpAddress, str, List][0m
[30;1m467 | [0m[35m        An IP address or list of IP addresses to lookup. Alias of `ip`.[0m
[30;1m468 | [0m[35m    raw : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1809[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m    Parameters[0m
[30;1m463 | [0m[35m    ----------[0m
[30;1m464 | [0m[35m    ip : Union[IpAddress, str, List][0m
[30;1m465 | [0m[35m        An IP address or list of IP addresses to lookup.[0m
[30;1m466 | [0m[35m    ip_address : Union[IpAddress, str, List][0m
[30;1m467 | [0m[35m        An IP address or list of IP addresses to lookup. Alias of `ip`.[0m
[30;1m468 | [0m[35m    raw : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1810[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m461 | [0m[35m[0m
[30;1m462 | [0m[35m    Parameters[0m
[30;1m463 | [0m[35m    ----------[0m
[30;1m464 | [0m[35m    ip : Union[IpAddress, str, List][0m
[30;1m465 | [0m[35m        An IP address or list of IP addresses to lookup.[0m
[30;1m466 | [0m[35m    ip_address : Union[IpAddress, str, List][0m
[30;1m467 | [0m[35m        An IP address or list of IP addresses to lookup. Alias of `ip`.[0m

[31m--[ [0m[34mMatch #[0m[33m1811[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m457 | [0m[35m    retry_count: int = 5,[0m
[30;1m458 | [0m[35m) -> pd.DataFrame | _IpWhoIsResult:[0m
[30;1m459 | [0m[35m    """[0m
[30;1m460 | [0m[35m    Lookup IP Whois information.[0m
[30;1m461 | [0m[35m[0m
[30;1m462 | [0m[35m    Parameters[0m
[30;1m463 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1812[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m418 | [0m[35m            Name of the output column for ASN description,[0m
[30;1m419 | [0m[35m            by default "ASNDescription"[0m
[30;1m420 | [0m[35m        whois_col : str, optional[0m
[30;1m421 | [0m[35m            Name of the output column for full whois data,[0m
[30;1m422 | [0m[35m            by default "WhoIsData"[0m
[30;1m423 | [0m[35m        show_progress : bool, optional[0m
[30;1m424 | [0m[35m            Show progress for each query, by default False[0m

[31m--[ [0m[34mMatch #[0m[33m1813[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m413 | [0m[35m        Parameters[0m
[30;1m414 | [0m[35m        ----------[0m
[30;1m415 | [0m[35m        ip_column : str[0m
[30;1m416 | [0m[35m            Column name of IP Address to look up.[0m
[30;1m417 | [0m[35m        asn_col : str, optional[0m
[30;1m418 | [0m[35m            Name of the output column for ASN description,[0m
[30;1m419 | [0m[35m            by default "ASNDescription"[0m

[31m--[ [0m[34mMatch #[0m[33m1814[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m393 | [0m[35m@pd.api.extensions.register_dataframe_accessor("mp_whois")[0m
[30;1m394 | [0m[35m@export[0m
[30;1m395 | [0m[35mclass IpWhoisAccessor:[0m
[30;1m396 | [0m[35m    """Pandas api extension for IP Whois lookup."""[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35m    def __init__(self: IpWhoisAccessor, pandas_obj: pd.DataFrame) -> None:[0m
[30;1m399 | [0m[35m        """Instantiate pandas extension class."""[0m

[31m--[ [0m[34mMatch #[0m[33m1815[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m354 | [0m[35m        by default "ASNDescription".[0m
[30;1m355 | [0m[35m        Ignored if `all_columns` is True.[0m
[30;1m356 | [0m[35m    whois_col : str, optional[0m
[30;1m357 | [0m[35m        Name of the output column for full whois data,[0m
[30;1m358 | [0m[35m        by default "WhoIsData"[0m
[30;1m359 | [0m[35m        Ignored if `all_columns` is True.[0m
[30;1m360 | [0m[35m    show_progress : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1816[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m348 | [0m[35m    ip_column : str[0m
[30;1m349 | [0m[35m        Column name of IP Address to look up.[0m
[30;1m350 | [0m[35m    all_columns:[0m
[30;1m351 | [0m[35m        Expand all whois data to columns.[0m
[30;1m352 | [0m[35m    asn_col : str, optional[0m
[30;1m353 | [0m[35m        Name of the output column for ASN description,[0m
[30;1m354 | [0m[35m        by default "ASNDescription".[0m

[31m--[ [0m[34mMatch #[0m[33m1817[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m348 | [0m[35m    ip_column : str[0m
[30;1m349 | [0m[35m        Column name of IP Address to look up.[0m
[30;1m350 | [0m[35m    all_columns:[0m
[30;1m351 | [0m[35m        Expand all whois data to columns.[0m
[30;1m352 | [0m[35m    asn_col : str, optional[0m
[30;1m353 | [0m[35m        Name of the output column for ASN description,[0m
[30;1m354 | [0m[35m        by default "ASNDescription".[0m

[31m--[ [0m[34mMatch #[0m[33m1818[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m346 | [0m[35m    data : pd.DataFrame[0m
[30;1m347 | [0m[35m        Input DataFrame[0m
[30;1m348 | [0m[35m    ip_column : str[0m
[30;1m349 | [0m[35m        Column name of IP Address to look up.[0m
[30;1m350 | [0m[35m    all_columns:[0m
[30;1m351 | [0m[35m        Expand all whois data to columns.[0m
[30;1m352 | [0m[35m    asn_col : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1819[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m339 | [0m[35m    show_progress: bool = False,[0m
[30;1m340 | [0m[35m) -> pd.DataFrame:[0m
[30;1m341 | [0m[35m    """[0m
[30;1m342 | [0m[35m    Retrieve Whois ASN information for DataFrame of IP Addresses.[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m    Parameters[0m
[30;1m345 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1820[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m339 | [0m[35m    show_progress: bool = False,[0m
[30;1m340 | [0m[35m) -> pd.DataFrame:[0m
[30;1m341 | [0m[35m    """[0m
[30;1m342 | [0m[35m    Retrieve Whois ASN information for DataFrame of IP Addresses.[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m    Parameters[0m
[30;1m345 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1821[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m323 | [0m[35m            logger.info(".")[0m
[30;1m324 | [0m[35m        return whois_result[0m
[30;1m325 | [0m[35m    return _IpWhoIsResult([0m
[30;1m326 | [0m[35m        name=f"No ASN Information for IP type: {ip_type}",[0m
[30;1m327 | [0m[35m        properties={},[0m
[30;1m328 | [0m[35m    )[0m
[30;1m329 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1822[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m305 | [0m[35m    IP addresses.[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m    """[0m
[30;1m308 | [0m[35m    ip_str = ip or ip_str[0m
[30;1m309 | [0m[35m    if not ip_str:[0m
[30;1m310 | [0m[35m        err_msg: str = "'ip' or 'ip_str' value must be specified"[0m
[30;1m311 | [0m[35m        raise ValueError(err_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1823[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m    -----[0m
[30;1m303 | [0m[35m    This function uses the Python functools lru_cache and[0m
[30;1m304 | [0m[35m    will return answers from the cache for previously queried[0m
[30;1m305 | [0m[35m    IP addresses.[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m    """[0m
[30;1m308 | [0m[35m    ip_str = ip or ip_str[0m

[31m--[ [0m[34mMatch #[0m[33m1824[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m296 | [0m[35m    Returns[0m
[30;1m297 | [0m[35m    -------[0m
[30;1m298 | [0m[35m    IP[0m
[30;1m299 | [0m[35m        Details of the IP data collected[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m    Notes[0m
[30;1m302 | [0m[35m    -----[0m

[31m--[ [0m[34mMatch #[0m[33m1825[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m    Returns[0m
[30;1m297 | [0m[35m    -------[0m
[30;1m298 | [0m[35m    IP[0m
[30;1m299 | [0m[35m        Details of the IP data collected[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m    Notes[0m

[31m--[ [0m[34mMatch #[0m[33m1826[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m287 | [0m[35m    Parameters[0m
[30;1m288 | [0m[35m    ----------[0m
[30;1m289 | [0m[35m    ip : str[0m
[30;1m290 | [0m[35m        IP Address to look up.[0m
[30;1m291 | [0m[35m    ip_str : str[0m
[30;1m292 | [0m[35m        alias for `ip`.[0m
[30;1m293 | [0m[35m    show_progress : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1827[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    Parameters[0m
[30;1m288 | [0m[35m    ----------[0m
[30;1m289 | [0m[35m    ip : str[0m
[30;1m290 | [0m[35m        IP Address to look up.[0m
[30;1m291 | [0m[35m    ip_str : str[0m
[30;1m292 | [0m[35m        alias for `ip`.[0m

[31m--[ [0m[34mMatch #[0m[33m1828[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m282 | [0m[35m    ip_str: str | None = None,[0m
[30;1m283 | [0m[35m) -> pd.DataFrame | _IpWhoIsResult:[0m
[30;1m284 | [0m[35m    """[0m
[30;1m285 | [0m[35m    Retrieve whois ASN information for given IP address using IPWhois python package.[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    Parameters[0m
[30;1m288 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1829[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m282 | [0m[35m    ip_str: str | None = None,[0m
[30;1m283 | [0m[35m) -> pd.DataFrame | _IpWhoIsResult:[0m
[30;1m284 | [0m[35m    """[0m
[30;1m285 | [0m[35m    Retrieve whois ASN information for given IP address using IPWhois python package.[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    Parameters[0m
[30;1m288 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1830[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m244 | [0m[35m        Returns ip type string using ip address module[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    """[0m
[30;1m247 | [0m[35m    ip_str = ip or ip_str[0m
[30;1m248 | [0m[35m    if not ip_str:[0m
[30;1m249 | [0m[35m        err_msg: str = "'ip' or 'ip_str' value must be specified"[0m
[30;1m250 | [0m[35m        raise ValueError(err_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1831[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m    Returns[0m
[30;1m242 | [0m[35m    -------[0m
[30;1m243 | [0m[35m    str[0m
[30;1m244 | [0m[35m        Returns ip type string using ip address module[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    """[0m
[30;1m247 | [0m[35m    ip_str = ip or ip_str[0m

[31m--[ [0m[34mMatch #[0m[33m1832[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m    Returns[0m
[30;1m242 | [0m[35m    -------[0m
[30;1m243 | [0m[35m    str[0m
[30;1m244 | [0m[35m        Returns ip type string using ip address module[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    """[0m
[30;1m247 | [0m[35m    ip_str = ip or ip_str[0m

[31m--[ [0m[34mMatch #[0m[33m1833[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m236 | [0m[35m    ip : str[0m
[30;1m237 | [0m[35m        The string of the IP Address[0m
[30;1m238 | [0m[35m    ip_str : str[0m
[30;1m239 | [0m[35m        The string of the IP Address - alias for `ip`[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    Returns[0m
[30;1m242 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m1834[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m    Parameters[0m
[30;1m235 | [0m[35m    ----------[0m
[30;1m236 | [0m[35m    ip : str[0m
[30;1m237 | [0m[35m        The string of the IP Address[0m
[30;1m238 | [0m[35m    ip_str : str[0m
[30;1m239 | [0m[35m        The string of the IP Address - alias for `ip`[0m
[30;1m240 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1835[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    Parameters[0m
[30;1m235 | [0m[35m    ----------[0m
[30;1m236 | [0m[35m    ip : str[0m
[30;1m237 | [0m[35m        The string of the IP Address[0m
[30;1m238 | [0m[35m    ip_str : str[0m
[30;1m239 | [0m[35m        The string of the IP Address - alias for `ip`[0m

[31m--[ [0m[34mMatch #[0m[33m1836[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m@export[0m
[30;1m228 | [0m[35mdef get_ip_type(ip: str | None = None, ip_str: str | None = None) -> str:[0m
[30;1m229 | [0m[35m    """[0m
[30;1m230 | [0m[35m    Validate value is an IP address and determine IPType category.[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    (IPAddress category is e.g. Private/Public/Multicast).[0m
[30;1m233 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1837[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m    Returns[0m
[30;1m182 | [0m[35m    -------[0m
[30;1m183 | [0m[35m    IP[0m
[30;1m184 | [0m[35m        Details of the IP data collected[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    """[0m
[30;1m187 | [0m[35m    ip_entity: IpAddress = IpAddress()[0m

[31m--[ [0m[34mMatch #[0m[33m1838[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    Returns[0m
[30;1m182 | [0m[35m    -------[0m
[30;1m183 | [0m[35m    IP[0m
[30;1m184 | [0m[35m        Details of the IP data collected[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1839[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m    az_net_df: pd.DataFrame | None = None,[0m
[30;1m170 | [0m[35m) -> IpAddress:[0m
[30;1m171 | [0m[35m    """[0m
[30;1m172 | [0m[35m    Generate ip_entity record for provided IP value.[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m    Parameters[0m
[30;1m175 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1840[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m        else:[0m
[30;1m155 | [0m[35m            ip_list = {addr}[0m
[30;1m156 | [0m[35m        ip_list = ip_list - all_ips  # remove IP addresses we've seen[0m
[30;1m157 | [0m[35m        ip_entities.extend(IpAddress(Address=ip) for ip in ip_list)[0m
[30;1m158 | [0m[35m        all_ips |= ip_list[0m
[30;1m159 | [0m[35m        if geo_lookup:[0m
[30;1m160 | [0m[35m            for ip_ent in ip_entities:[0m

[31m--[ [0m[34mMatch #[0m[33m1841[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m            ip_list = {ip.strip() for ip in addr.split(",")}[0m
[30;1m154 | [0m[35m        else:[0m
[30;1m155 | [0m[35m            ip_list = {addr}[0m
[30;1m156 | [0m[35m        ip_list = ip_list - all_ips  # remove IP addresses we've seen[0m
[30;1m157 | [0m[35m        ip_entities.extend(IpAddress(Address=ip) for ip in ip_list)[0m
[30;1m158 | [0m[35m        all_ips |= ip_list[0m
[30;1m159 | [0m[35m        if geo_lookup:[0m

[31m--[ [0m[34mMatch #[0m[33m1842[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m150 | [0m[35m        if isinstance(addr, list):[0m
[30;1m151 | [0m[35m            ip_list: set[str] = set(addr)[0m
[30;1m152 | [0m[35m        elif isinstance(addr, str) and "," in addr:[0m
[30;1m153 | [0m[35m            ip_list = {ip.strip() for ip in addr.split(",")}[0m
[30;1m154 | [0m[35m        else:[0m
[30;1m155 | [0m[35m            ip_list = {addr}[0m
[30;1m156 | [0m[35m        ip_list = ip_list - all_ips  # remove IP addresses we've seen[0m

[31m--[ [0m[34mMatch #[0m[33m1843[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m    Returns[0m
[30;1m122 | [0m[35m    -------[0m
[30;1m123 | [0m[35m    List[0m
[30;1m124 | [0m[35m        The populated IP entities including address and geo-location[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    Raises[0m
[30;1m127 | [0m[35m    ------[0m

[31m--[ [0m[34mMatch #[0m[33m1844[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m    data : pd.DataFrame[0m
[30;1m114 | [0m[35m        Use DataFrame as input[0m
[30;1m115 | [0m[35m    ip_col : str[0m
[30;1m116 | [0m[35m        Column containing IP addresses[0m
[30;1m117 | [0m[35m    geo_lookup : bool[0m
[30;1m118 | [0m[35m        If true, do geolocation lookup on IPs,[0m
[30;1m119 | [0m[35m        by default, True[0m

[31m--[ [0m[34mMatch #[0m[33m1845[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m    Parameters[0m
[30;1m109 | [0m[35m    ----------[0m
[30;1m110 | [0m[35m    ip_str : str[0m
[30;1m111 | [0m[35m        A string with a single IP Address or multiple addresses[0m
[30;1m112 | [0m[35m        delimited by comma or space[0m
[30;1m113 | [0m[35m    data : pd.DataFrame[0m
[30;1m114 | [0m[35m        Use DataFrame as input[0m

[31m--[ [0m[34mMatch #[0m[33m1846[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m    geo_lookup: bool = True,[0m
[30;1m104 | [0m[35m) -> list[IpAddress]:[0m
[30;1m105 | [0m[35m    """[0m
[30;1m106 | [0m[35m    Take in an IP Address string and converts it to an IP Entity.[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m    Parameters[0m
[30;1m109 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1847[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m    geo_lookup: bool = True,[0m
[30;1m104 | [0m[35m) -> list[IpAddress]:[0m
[30;1m105 | [0m[35m    """[0m
[30;1m106 | [0m[35m    Take in an IP Address string and converts it to an IP Entity.[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m    Parameters[0m
[30;1m109 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1848[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mimport warnings[0m
[30;1m22 | [0m[35mfrom dataclasses import asdict, dataclass, field[0m
[30;1m23 | [0m[35mfrom functools import lru_cache[0m
[30;1m24 | [0m[35mfrom time import sleep[0m
[30;1m25 | [0m[35mfrom typing import Any, Callable, Iterator[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mimport httpx[0m

[31m--[ [0m[34mMatch #[0m[33m1849[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mContains a series of functions required to manipulate and[0m
[30;1m10 | [0m[35menrich IP Address data to assist investigations.[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mDesigned to support any data source containing IP address entity.[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m"""[0m
[30;1m15 | [0m[35mfrom __future__ import annotations[0m

[31m--[ [0m[34mMatch #[0m[33m1850[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mip_utils - IP Address functions.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mContains a series of functions required to manipulate and[0m
[30;1m10 | [0m[35menrich IP Address data to assist investigations.[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mDesigned to support any data source containing IP address entity.[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1851[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/ip_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35mip_utils - IP Address functions.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mContains a series of functions required to manipulate and[0m
[30;1m10 | [0m[35menrich IP Address data to assist investigations.[0m

[31m--[ [0m[34mMatch #[0m[33m1852[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/probabilities.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m146 | [0m[35m    to 1.[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    Note also that each parameter can only take one value at a time[0m
[30;1m149 | [0m[35m    (unlike how a command can take multiple parameters at a time).[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    Parameters[0m
[30;1m152 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1853[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/probabilities.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m145 | [0m[35m    on the parameter. Therefore, we DO expect these probabilities to sum[0m
[30;1m146 | [0m[35m    to 1.[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    Note also that each parameter can only take one value at a time[0m
[30;1m149 | [0m[35m    (unlike how a command can take multiple parameters at a time).[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m1854[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/probabilities.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m79 | [0m[35m    parameters are independent Bernoulii random variables conditional[0m
[30;1m80 | [0m[35m    on the command.[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    Note also that because multiple parameters can appear at a time for[0m
[30;1m83 | [0m[35m    a command, and because we are computing the probability that each[0m
[30;1m84 | [0m[35m    parameter is present or not, we do NOT expect the probabilities to[0m
[30;1m85 | [0m[35m    sum to 1.[0m

[31m--[ [0m[34mMatch #[0m[33m1855[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/probabilities.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m46 | [0m[35m    )[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    # compute prior probs[0m
[30;1m49 | [0m[35m    for cmd in seq1_counts:[0m
[30;1m50 | [0m[35m        prior_probs[cmd] = seq1_counts[cmd] / total_cmds[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    # compute trans probs[0m

[31m--[ [0m[34mMatch #[0m[33m1856[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/probabilities.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m    on the parameter. Therefore, we DO expect these probabilities to sum[0m
[30;1m146 | [0m[35m    to 1.[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    Note also that each parameter can only take one value at a time[0m
[30;1m149 | [0m[35m    (unlike how a command can take multiple parameters at a time).[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m1857[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/probabilities.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m    and also the probabilities of the values conditional on the param.[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    Note that we will be modelling the values as categorical conditional[0m
[30;1m145 | [0m[35m    on the parameter. Therefore, we DO expect these probabilities to sum[0m
[30;1m146 | [0m[35m    to 1.[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    Note also that each parameter can only take one value at a time[0m

[31m--[ [0m[34mMatch #[0m[33m1858[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/probabilities.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    Note also that because multiple parameters can appear at a time for[0m
[30;1m83 | [0m[35m    a command, and because we are computing the probability that each[0m
[30;1m84 | [0m[35m    parameter is present or not, we do NOT expect the probabilities to[0m
[30;1m85 | [0m[35m    sum to 1.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    Note also that we use laplace smoothing in the counting[0m

[31m--[ [0m[34mMatch #[0m[33m1859[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/probabilities.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m    parameters are independent Bernoulii random variables conditional[0m
[30;1m80 | [0m[35m    on the command.[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    Note also that because multiple parameters can appear at a time for[0m
[30;1m83 | [0m[35m    a command, and because we are computing the probability that each[0m
[30;1m84 | [0m[35m    parameter is present or not, we do NOT expect the probabilities to[0m
[30;1m85 | [0m[35m    sum to 1.[0m

[31m--[ [0m[34mMatch #[0m[33m1860[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/cloud_logon_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        self.SessionId = src_event.get("SessionId")[0m
[30;1m75 | [0m[35m        self.Account = src_event.get("Account")[0m
[30;1m76 | [0m[35m        self.UserAgent = src_event.get("UserAgent")[0m
[30;1m77 | [0m[35m        self.StartTime = src_event.get("StartTimeUtc")[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    @property[0m
[30;1m80 | [0m[35m    def description_str(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1861[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/cloud_logon_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m74 | [0m[35m        self.SessionId = src_event.get("SessionId")[0m
[30;1m75 | [0m[35m        self.Account = src_event.get("Account")[0m
[30;1m76 | [0m[35m        self.UserAgent = src_event.get("UserAgent")[0m
[30;1m77 | [0m[35m        self.StartTime = src_event.get("StartTimeUtc")[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1862[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/cloud_logon_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m74 | [0m[35m        self.SessionId = src_event.get("SessionId")[0m
[30;1m75 | [0m[35m        self.Account = src_event.get("Account")[0m
[30;1m76 | [0m[35m        self.UserAgent = src_event.get("UserAgent")[0m
[30;1m77 | [0m[35m        self.StartTime = src_event.get("StartTimeUtc")[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1863[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/cloud_logon_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m            self._create_from_event(src_event)[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m74 | [0m[35m        self.SessionId = src_event.get("SessionId")[0m
[30;1m75 | [0m[35m        self.Account = src_event.get("Account")[0m
[30;1m76 | [0m[35m        self.UserAgent = src_event.get("UserAgent")[0m
[30;1m77 | [0m[35m        self.StartTime = src_event.get("StartTimeUtc")[0m

[31m--[ [0m[34mMatch #[0m[33m1864[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/cloud_logon_session.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    UserAgent : str[0m
[30;1m32 | [0m[35m        The UserAgent[0m
[30;1m33 | [0m[35m    StartTime: str[0m
[30;1m34 | [0m[35m        The time the session started[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    """[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1865[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m855 | [0m[35m[0m
[30;1m856 | [0m[35m    def extract(self, column, **kwargs) -> pd.DataFrame:[0m
[30;1m857 | [0m[35m        """[0m
[30;1m858 | [0m[35m        Base64 decode strings taken from a pandas dataframe.[0m
[30;1m859 | [0m[35m[0m
[30;1m860 | [0m[35m        Parameters[0m
[30;1m861 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1866[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m772 | [0m[35m@export[0m
[30;1m773 | [0m[35mdef get_items_from_tar(binary: bytes) -> Tuple[str, Dict[str, bytes]]:[0m
[30;1m774 | [0m[35m    """[0m
[30;1m775 | [0m[35m    Return dictionary of tar file contents.[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m    Parameters[0m
[30;1m778 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1867[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m    if decode_success:[0m
[30;1m417 | [0m[35m        # stuff that we have already decoded may also contain further[0m
[30;1m418 | [0m[35m        # base64 encoded strings[0m
[30;1m419 | [0m[35m        prefix = ([0m
[30;1m420 | [0m[35m            f"{item_prefix}.{fragment_index}." if item_prefix else f"{fragment_index}."[0m
[30;1m421 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1868[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    while True:[0m
[30;1m352 | [0m[35m        # search sequentially through the input string for any strings[0m
[30;1m353 | [0m[35m        # that look like base64[0m
[30;1m354 | [0m[35m        _debug_print_trace([0m
[30;1m355 | [0m[35m            f"regex searching {decoded_string[:200]} ",[0m
[30;1m356 | [0m[35m            f"from pos: {match_pos} bin_index {fragment_index}",[0m

[31m--[ [0m[34mMatch #[0m[33m1869[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m263 | [0m[35m    data: pd.DataFrame, column: str, trace: bool = False, utf16: bool = False[0m
[30;1m264 | [0m[35m) -> pd.DataFrame:[0m
[30;1m265 | [0m[35m    """[0m
[30;1m266 | [0m[35m    Base64 decode strings taken from a pandas dataframe.[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m    Parameters[0m
[30;1m269 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1870[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35m    input_string: str, trace: bool = False, utf16: bool = False[0m
[30;1m222 | [0m[35m) -> Tuple[str, pd.DataFrame]:[0m
[30;1m223 | [0m[35m    """[0m
[30;1m224 | [0m[35m    Base64 decode an input string.[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    Parameters[0m
[30;1m227 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1871[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m    utf16: bool = False,[0m
[30;1m145 | [0m[35m) -> Any:[0m
[30;1m146 | [0m[35m    """[0m
[30;1m147 | [0m[35m    Base64 decode an input string or strings taken from a pandas dataframe.[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    Parameters[0m
[30;1m150 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1872[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m}[0m
[30;1m84 | [0m[35m_BASE64_HEADER_OFFSET_TYPES = {"DAxMDA3NzcAMDAwMDAwM": "tar"}[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m# Base64 simple regex[0m
[30;1m87 | [0m[35m_BASE64_REGEX = "(?P<b64>[A-Za-z0-9+/\\n\\r]{30,}={0,2})"[0m
[30;1m88 | [0m[35mBASE64_REGEX_C = re.compile(_BASE64_REGEX, re.I | re.X)[0m
[30;1m89 | [0m[35m# Same expresion without group for pandas[0m

[31m--[ [0m[34mMatch #[0m[33m1873[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35mget_hashes(binary): Return md5, sha1 and sha256 hashes of input byte string[0m
[30;1m25 | [0m[35m"""[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mimport base64[0m
[30;1m28 | [0m[35mimport binascii[0m
[30;1m29 | [0m[35mimport gzip[0m
[30;1m30 | [0m[35mimport hashlib[0m

[31m--[ [0m[34mMatch #[0m[33m1874[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mOther helper functions may also be useful standalone[0m
[30;1m21 | [0m[35mget_items_from_gzip(binary): Return decompressed gzip content of byte string[0m
[30;1m22 | [0m[35mget_items_from_zip(binary): Return dictionary of zip contents from byte string[0m
[30;1m23 | [0m[35mget_items_from_tar(binary): Return dictionary of tar file contents[0m
[30;1m24 | [0m[35mget_hashes(binary): Return md5, sha1 and sha256 hashes of input byte string[0m
[30;1m25 | [0m[35m"""[0m
[30;1m26 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1875[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/base64unpack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mbase64_unpack.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mThe main function of this module is to decode and unpack[0m
[30;1m10 | [0m[35mstrings that are obfuscated using base64 and/or certain[0m
[30;1m11 | [0m[35mcompression algorithms such as gzip and zip.[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mIt has the following functions:[0m

[31m--[ [0m[34mMatch #[0m[33m1876[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_connections.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m90 | [0m[35m      pid:[0m
[30;1m91 | [0m[35m        description: Command to search for[0m
[30;1m92 | [0m[35m        type: list[0m
[30;1m93 | [0m[35m      hostname:[0m
[30;1m94 | [0m[35m        description: Hostname where the process is running[0m
[30;1m95 | [0m[35m        type: list[0m

[31m--[ [0m[34mMatch #[0m[33m1877[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_connections.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m64 | [0m[35m                      },[0m
[30;1m65 | [0m[35m                      {[0m
[30;1m66 | [0m[35m                          "facetName": "ownerMachine",[0m
[30;1m67 | [0m[35m                          "values":[ "{hostname}" ],[0m
[30;1m68 | [0m[35m                          "filterType":"Equals"[0m
[30;1m69 | [0m[35m                      },[0m
[30;1m70 | [0m[35m                      {[0m

[31m--[ [0m[34mMatch #[0m[33m1878[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_connections.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m      type: str[0m
[30;1m23 | [0m[35m      default: creationTime[0m
[30;1m24 | [0m[35m    timeFeatureId:[0m
[30;1m25 | [0m[35m      description: Time boundary[0m
[30;1m26 | [0m[35m      type: str[0m
[30;1m27 | [0m[35m      default: startFeatureId[0m
[30;1m28 | [0m[35m    customFields:[0m

[31m--[ [0m[34mMatch #[0m[33m1879[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_connections.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m      type: datetime[0m
[30;1m19 | [0m[35m      default: 0[0m
[30;1m20 | [0m[35m    timefield:[0m
[30;1m21 | [0m[35m      description: Field to use for time[0m
[30;1m22 | [0m[35m      type: str[0m
[30;1m23 | [0m[35m      default: creationTime[0m
[30;1m24 | [0m[35m    timeFeatureId:[0m

[31m--[ [0m[34mMatch #[0m[33m1880[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_connections.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m      type: datetime[0m
[30;1m15 | [0m[35m      default: -7[0m
[30;1m16 | [0m[35m    end:[0m
[30;1m17 | [0m[35m      description: Query end time[0m
[30;1m18 | [0m[35m      type: datetime[0m
[30;1m19 | [0m[35m      default: 0[0m
[30;1m20 | [0m[35m    timefield:[0m

[31m--[ [0m[34mMatch #[0m[33m1881[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_connections.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    data_source: "hunting_queries"[0m
[30;1m11 | [0m[35m  parameters:[0m
[30;1m12 | [0m[35m    start:[0m
[30;1m13 | [0m[35m      description: Query start time[0m
[30;1m14 | [0m[35m      type: datetime[0m
[30;1m15 | [0m[35m      default: -7[0m
[30;1m16 | [0m[35m    end:[0m

[31m--[ [0m[34mMatch #[0m[33m1882[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m    ClusterQueryEndTime : datetime[0m
[30;1m54 | [0m[35m        ClusterQueryEndTime of the Mail cluster[0m
[30;1m55 | [0m[35m    ClusterGroup : str[0m
[30;1m56 | [0m[35m        ClusterGroup of the Mail cluster[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    """[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1883[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m    ClusterQueryStartTime : datetime[0m
[30;1m52 | [0m[35m        ClusterQueryStartTime of the Mail cluster[0m
[30;1m53 | [0m[35m    ClusterQueryEndTime : datetime[0m
[30;1m54 | [0m[35m        ClusterQueryEndTime of the Mail cluster[0m
[30;1m55 | [0m[35m    ClusterGroup : str[0m
[30;1m56 | [0m[35m        ClusterGroup of the Mail cluster[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1884[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m    ClusterSourceType : str[0m
[30;1m50 | [0m[35m        ClusterSourceType of the Mail cluster[0m
[30;1m51 | [0m[35m    ClusterQueryStartTime : datetime[0m
[30;1m52 | [0m[35m        ClusterQueryStartTime of the Mail cluster[0m
[30;1m53 | [0m[35m    ClusterQueryEndTime : datetime[0m
[30;1m54 | [0m[35m        ClusterQueryEndTime of the Mail cluster[0m
[30;1m55 | [0m[35m    ClusterGroup : str[0m

[31m--[ [0m[34mMatch #[0m[33m1885[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m    ClusterSourceIdentifier : str[0m
[30;1m48 | [0m[35m        ClusterSourceIdentifier of the Mail cluster[0m
[30;1m49 | [0m[35m    ClusterSourceType : str[0m
[30;1m50 | [0m[35m        ClusterSourceType of the Mail cluster[0m
[30;1m51 | [0m[35m    ClusterQueryStartTime : datetime[0m
[30;1m52 | [0m[35m        ClusterQueryStartTime of the Mail cluster[0m
[30;1m53 | [0m[35m    ClusterQueryEndTime : datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1886[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    Source : str[0m
[30;1m46 | [0m[35m        Source of the Mail cluster[0m
[30;1m47 | [0m[35m    ClusterSourceIdentifier : str[0m
[30;1m48 | [0m[35m        ClusterSourceIdentifier of the Mail cluster[0m
[30;1m49 | [0m[35m    ClusterSourceType : str[0m
[30;1m50 | [0m[35m        ClusterSourceType of the Mail cluster[0m
[30;1m51 | [0m[35m    ClusterQueryStartTime : datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1887[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    IsVolumeAnomaly : bool[0m
[30;1m44 | [0m[35m        IsVolumeAnomaly of the Mail cluster[0m
[30;1m45 | [0m[35m    Source : str[0m
[30;1m46 | [0m[35m        Source of the Mail cluster[0m
[30;1m47 | [0m[35m    ClusterSourceIdentifier : str[0m
[30;1m48 | [0m[35m        ClusterSourceIdentifier of the Mail cluster[0m
[30;1m49 | [0m[35m    ClusterSourceType : str[0m

[31m--[ [0m[34mMatch #[0m[33m1888[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    MailCount : int[0m
[30;1m42 | [0m[35m        MailCount of the Mail cluster[0m
[30;1m43 | [0m[35m    IsVolumeAnomaly : bool[0m
[30;1m44 | [0m[35m        IsVolumeAnomaly of the Mail cluster[0m
[30;1m45 | [0m[35m    Source : str[0m
[30;1m46 | [0m[35m        Source of the Mail cluster[0m
[30;1m47 | [0m[35m    ClusterSourceIdentifier : str[0m

[31m--[ [0m[34mMatch #[0m[33m1889[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    QueryTime : datetime[0m
[30;1m40 | [0m[35m        QueryTime of the Mail cluster[0m
[30;1m41 | [0m[35m    MailCount : int[0m
[30;1m42 | [0m[35m        MailCount of the Mail cluster[0m
[30;1m43 | [0m[35m    IsVolumeAnomaly : bool[0m
[30;1m44 | [0m[35m        IsVolumeAnomaly of the Mail cluster[0m
[30;1m45 | [0m[35m    Source : str[0m

[31m--[ [0m[34mMatch #[0m[33m1890[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    Query : str[0m
[30;1m38 | [0m[35m        Query of the Mail cluster[0m
[30;1m39 | [0m[35m    QueryTime : datetime[0m
[30;1m40 | [0m[35m        QueryTime of the Mail cluster[0m
[30;1m41 | [0m[35m    MailCount : int[0m
[30;1m42 | [0m[35m        MailCount of the Mail cluster[0m
[30;1m43 | [0m[35m    IsVolumeAnomaly : bool[0m

[31m--[ [0m[34mMatch #[0m[33m1891[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    Threats : List[str][0m
[30;1m36 | [0m[35m        Threats of the Mail cluster[0m
[30;1m37 | [0m[35m    Query : str[0m
[30;1m38 | [0m[35m        Query of the Mail cluster[0m
[30;1m39 | [0m[35m    QueryTime : datetime[0m
[30;1m40 | [0m[35m        QueryTime of the Mail cluster[0m
[30;1m41 | [0m[35m    MailCount : int[0m

[31m--[ [0m[34mMatch #[0m[33m1892[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m    CountByProtectionStatus : Dict[str, int] = {}[0m
[30;1m34 | [0m[35m        CountByProtectionStatus of the Mail cluster[0m
[30;1m35 | [0m[35m    Threats : List[str][0m
[30;1m36 | [0m[35m        Threats of the Mail cluster[0m
[30;1m37 | [0m[35m    Query : str[0m
[30;1m38 | [0m[35m        Query of the Mail cluster[0m
[30;1m39 | [0m[35m    QueryTime : datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1893[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    CountByThreatType : Dict[str, int] = {}[0m
[30;1m32 | [0m[35m        CountByThreatType of the Mail cluster[0m
[30;1m33 | [0m[35m    CountByProtectionStatus : Dict[str, int] = {}[0m
[30;1m34 | [0m[35m        CountByProtectionStatus of the Mail cluster[0m
[30;1m35 | [0m[35m    Threats : List[str][0m
[30;1m36 | [0m[35m        Threats of the Mail cluster[0m
[30;1m37 | [0m[35m    Query : str[0m

[31m--[ [0m[34mMatch #[0m[33m1894[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    CountByDeliveryStatus : Dict[str, int] = {}[0m
[30;1m30 | [0m[35m        CountByDeliveryStatus of the Mail cluster[0m
[30;1m31 | [0m[35m    CountByThreatType : Dict[str, int] = {}[0m
[30;1m32 | [0m[35m        CountByThreatType of the Mail cluster[0m
[30;1m33 | [0m[35m    CountByProtectionStatus : Dict[str, int] = {}[0m
[30;1m34 | [0m[35m        CountByProtectionStatus of the Mail cluster[0m
[30;1m35 | [0m[35m    Threats : List[str][0m

[31m--[ [0m[34mMatch #[0m[33m1895[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    NetworkMessageIds : List[str][0m
[30;1m28 | [0m[35m        NetworkMessageIds of the Mail cluster[0m
[30;1m29 | [0m[35m    CountByDeliveryStatus : Dict[str, int] = {}[0m
[30;1m30 | [0m[35m        CountByDeliveryStatus of the Mail cluster[0m
[30;1m31 | [0m[35m    CountByThreatType : Dict[str, int] = {}[0m
[30;1m32 | [0m[35m        CountByThreatType of the Mail cluster[0m
[30;1m33 | [0m[35m    CountByProtectionStatus : Dict[str, int] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m1896[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m    Attributes[0m
[30;1m26 | [0m[35m    ----------[0m
[30;1m27 | [0m[35m    NetworkMessageIds : List[str][0m
[30;1m28 | [0m[35m        NetworkMessageIds of the Mail cluster[0m
[30;1m29 | [0m[35m    CountByDeliveryStatus : Dict[str, int] = {}[0m
[30;1m30 | [0m[35m        CountByDeliveryStatus of the Mail cluster[0m
[30;1m31 | [0m[35m    CountByThreatType : Dict[str, int] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m1897[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tilookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m        start: dt.datetime, optional[0m
[30;1m178 | [0m[35m            Time since when IOC is considered relevant[0m
[30;1m179 | [0m[35m        end: dt.datetime, optional[0m
[30;1m180 | [0m[35m            Time until when IOC is considered relevant[0m
[30;1m181 | [0m[35m        progress : bool[0m
[30;1m182 | [0m[35m            Use progress bar to track completion, by default True[0m
[30;1m183 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1898[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tilookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m        prov_scope : str, optional[0m
[30;1m176 | [0m[35m            Use "primary", "secondary" or "all" providers, by default "primary"[0m
[30;1m177 | [0m[35m        start: dt.datetime, optional[0m
[30;1m178 | [0m[35m            Time since when IOC is considered relevant[0m
[30;1m179 | [0m[35m        end: dt.datetime, optional[0m
[30;1m180 | [0m[35m            Time until when IOC is considered relevant[0m
[30;1m181 | [0m[35m        progress : bool[0m

[31m--[ [0m[34mMatch #[0m[33m1899[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tilookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m        start: dt.datetime, optional[0m
[30;1m95 | [0m[35m            Time since when IOC is considered relevant[0m
[30;1m96 | [0m[35m        end: dt.datetime, optional[0m
[30;1m97 | [0m[35m            Time until when IOC is considered relevant[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        Returns[0m
[30;1m100 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m1900[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tilookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m        show_not_supported: boolean, optional[0m
[30;1m93 | [0m[35m            If True, display result even if provider does not support this type of IOC.[0m
[30;1m94 | [0m[35m        start: dt.datetime, optional[0m
[30;1m95 | [0m[35m            Time since when IOC is considered relevant[0m
[30;1m96 | [0m[35m        end: dt.datetime, optional[0m
[30;1m97 | [0m[35m            Time until when IOC is considered relevant[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1901[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_hosts.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m41 | [0m[35m        - elementDisplayName[0m
[30;1m42 | [0m[35msources:[0m
[30;1m43 | [0m[35m  find_hosts:[0m
[30;1m44 | [0m[35m    description: Search for hosts by searching for a list of hostname[0m
[30;1m45 | [0m[35m    metadata:[0m
[30;1m46 | [0m[35m      pivot:[0m
[30;1m47 | [0m[35m        short_name: enrich[0m

[31m--[ [0m[34mMatch #[0m[33m1902[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_hosts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m      type: str[0m
[30;1m23 | [0m[35m      default: creationTime[0m
[30;1m24 | [0m[35m    timeFeatureId:[0m
[30;1m25 | [0m[35m      description: Time boundary[0m
[30;1m26 | [0m[35m      type: str[0m
[30;1m27 | [0m[35m      default: startFeatureId[0m
[30;1m28 | [0m[35m    customFields:[0m

[31m--[ [0m[34mMatch #[0m[33m1903[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_hosts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m      type: datetime[0m
[30;1m19 | [0m[35m      default: 0[0m
[30;1m20 | [0m[35m    timefield:[0m
[30;1m21 | [0m[35m      description: Field to use for time[0m
[30;1m22 | [0m[35m      type: str[0m
[30;1m23 | [0m[35m      default: creationTime[0m
[30;1m24 | [0m[35m    timeFeatureId:[0m

[31m--[ [0m[34mMatch #[0m[33m1904[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_hosts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m      type: datetime[0m
[30;1m15 | [0m[35m      default: -1[0m
[30;1m16 | [0m[35m    end:[0m
[30;1m17 | [0m[35m      description: Query end time[0m
[30;1m18 | [0m[35m      type: datetime[0m
[30;1m19 | [0m[35m      default: 0[0m
[30;1m20 | [0m[35m    timefield:[0m

[31m--[ [0m[34mMatch #[0m[33m1905[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/cybereason/cybereason_hosts.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    data_source: "hunting_queries"[0m
[30;1m11 | [0m[35m  parameters:[0m
[30;1m12 | [0m[35m    start:[0m
[30;1m13 | [0m[35m      description: Query start time[0m
[30;1m14 | [0m[35m      type: datetime[0m
[30;1m15 | [0m[35m      default: -1[0m
[30;1m16 | [0m[35m    end:[0m

[31m--[ [0m[34mMatch #[0m[33m1906[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/file.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m                iter([0m
[30;1m197 | [0m[35m                    sorted([0m
[30;1m198 | [0m[35m                        self.FileHashes,[0m
[30;1m199 | [0m[35m                        key=lambda f_hash: alg_order.get(f_hash.Algorithm, 10),[0m
[30;1m200 | [0m[35m                    )[0m
[30;1m201 | [0m[35m                )[0m
[30;1m202 | [0m[35m            ).Value[0m

[31m--[ [0m[34mMatch #[0m[33m1907[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m    period: int = kwargs.get("period", 24)[0m
[30;1m262 | [0m[35m    score_threshold: float = kwargs.get("score_threshold", 3.0)[0m
[30;1m263 | [0m[35m    time_column = kwargs.get("time_column")[0m
[30;1m264 | [0m[35m    data_column = kwargs.get("data_column")[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m    if not isinstance(data, pd.DataFrame):[0m
[30;1m267 | [0m[35m        raise MsticpyException("input data should be a pandas dataframe")[0m

[31m--[ [0m[34mMatch #[0m[33m1908[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    seasonal: int = kwargs.get("seasonal", 7)[0m
[30;1m261 | [0m[35m    period: int = kwargs.get("period", 24)[0m
[30;1m262 | [0m[35m    score_threshold: float = kwargs.get("score_threshold", 3.0)[0m
[30;1m263 | [0m[35m    time_column = kwargs.get("time_column")[0m
[30;1m264 | [0m[35m    data_column = kwargs.get("data_column")[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m    if not isinstance(data, pd.DataFrame):[0m

[31m--[ [0m[34mMatch #[0m[33m1909[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m    check_kwargs(kwargs, _DEFAULT_KWARGS)[0m
[30;1m260 | [0m[35m    seasonal: int = kwargs.get("seasonal", 7)[0m
[30;1m261 | [0m[35m    period: int = kwargs.get("period", 24)[0m
[30;1m262 | [0m[35m    score_threshold: float = kwargs.get("score_threshold", 3.0)[0m
[30;1m263 | [0m[35m    time_column = kwargs.get("time_column")[0m
[30;1m264 | [0m[35m    data_column = kwargs.get("data_column")[0m
[30;1m265 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1910[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m    """[0m
[30;1m259 | [0m[35m    check_kwargs(kwargs, _DEFAULT_KWARGS)[0m
[30;1m260 | [0m[35m    seasonal: int = kwargs.get("seasonal", 7)[0m
[30;1m261 | [0m[35m    period: int = kwargs.get("period", 24)[0m
[30;1m262 | [0m[35m    score_threshold: float = kwargs.get("score_threshold", 3.0)[0m
[30;1m263 | [0m[35m    time_column = kwargs.get("time_column")[0m
[30;1m264 | [0m[35m    data_column = kwargs.get("data_column")[0m

[31m--[ [0m[34mMatch #[0m[33m1911[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    """[0m
[30;1m259 | [0m[35m    check_kwargs(kwargs, _DEFAULT_KWARGS)[0m
[30;1m260 | [0m[35m    seasonal: int = kwargs.get("seasonal", 7)[0m
[30;1m261 | [0m[35m    period: int = kwargs.get("period", 24)[0m
[30;1m262 | [0m[35m    score_threshold: float = kwargs.get("score_threshold", 3.0)[0m
[30;1m263 | [0m[35m    time_column = kwargs.get("time_column")[0m

[31m--[ [0m[34mMatch #[0m[33m1912[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m367 | [0m[35m            period[0m
[30;1m368 | [0m[35m        ) * 2 and start_period is not None:[0m
[30;1m369 | [0m[35m            # if the current time is less than 2x the period away[0m
[30;1m370 | [0m[35m            # from our current end_period time, update the end_time[0m
[30;1m371 | [0m[35m            periods[start_period] = time + pd.Timedelta(period)[0m
[30;1m372 | [0m[35m        else:[0m
[30;1m373 | [0m[35m            # otherwise start a new period[0m

[31m--[ [0m[34mMatch #[0m[33m1913[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35mdef create_time_period_kqlfilter(periods: Dict[datetime, datetime]) -> str:[0m
[30;1m425 | [0m[35m    """[0m
[30;1m426 | [0m[35m    Return KQL time filter expression from anomaly periods.[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m    Parameters[0m
[30;1m429 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1914[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m394 | [0m[35m    time_column : str, optional[0m
[30;1m395 | [0m[35m        The name of the time column[0m
[30;1m396 | [0m[35m    period : str, optional[0m
[30;1m397 | [0m[35m        pandas-compatible time period designator,[0m
[30;1m398 | [0m[35m        by default "1h"[0m
[30;1m399 | [0m[35m    pos_only : bool, optional[0m
[30;1m400 | [0m[35m        If True only extract positive anomaly periods,[0m

[31m--[ [0m[34mMatch #[0m[33m1915[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m392 | [0m[35m    data : pd.DataFrame[0m
[30;1m393 | [0m[35m        The data to process[0m
[30;1m394 | [0m[35m    time_column : str, optional[0m
[30;1m395 | [0m[35m        The name of the time column[0m
[30;1m396 | [0m[35m    period : str, optional[0m
[30;1m397 | [0m[35m        pandas-compatible time period designator,[0m
[30;1m398 | [0m[35m        by default "1h"[0m

[31m--[ [0m[34mMatch #[0m[33m1916[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m373 | [0m[35m            # otherwise start a new period[0m
[30;1m374 | [0m[35m            start_period = time - pd.Timedelta(period)[0m
[30;1m375 | [0m[35m            periods[start_period] = time + pd.Timedelta(period)[0m
[30;1m376 | [0m[35m        end_period = time[0m
[30;1m377 | [0m[35m    return periods[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1917[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m372 | [0m[35m        else:[0m
[30;1m373 | [0m[35m            # otherwise start a new period[0m
[30;1m374 | [0m[35m            start_period = time - pd.Timedelta(period)[0m
[30;1m375 | [0m[35m            periods[start_period] = time + pd.Timedelta(period)[0m
[30;1m376 | [0m[35m        end_period = time[0m
[30;1m377 | [0m[35m    return periods[0m
[30;1m378 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1918[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m            periods[start_period] = time + pd.Timedelta(period)[0m
[30;1m372 | [0m[35m        else:[0m
[30;1m373 | [0m[35m            # otherwise start a new period[0m
[30;1m374 | [0m[35m            start_period = time - pd.Timedelta(period)[0m
[30;1m375 | [0m[35m            periods[start_period] = time + pd.Timedelta(period)[0m
[30;1m376 | [0m[35m        end_period = time[0m
[30;1m377 | [0m[35m    return periods[0m

[31m--[ [0m[34mMatch #[0m[33m1919[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m368 | [0m[35m        ) * 2 and start_period is not None:[0m
[30;1m369 | [0m[35m            # if the current time is less than 2x the period away[0m
[30;1m370 | [0m[35m            # from our current end_period time, update the end_time[0m
[30;1m371 | [0m[35m            periods[start_period] = time + pd.Timedelta(period)[0m
[30;1m372 | [0m[35m        else:[0m
[30;1m373 | [0m[35m            # otherwise start a new period[0m
[30;1m374 | [0m[35m            start_period = time - pd.Timedelta(period)[0m

[31m--[ [0m[34mMatch #[0m[33m1920[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m366 | [0m[35m        elif (time - end_period) <= pd.Timedelta([0m
[30;1m367 | [0m[35m            period[0m
[30;1m368 | [0m[35m        ) * 2 and start_period is not None:[0m
[30;1m369 | [0m[35m            # if the current time is less than 2x the period away[0m
[30;1m370 | [0m[35m            # from our current end_period time, update the end_time[0m
[30;1m371 | [0m[35m            periods[start_period] = time + pd.Timedelta(period)[0m
[30;1m372 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1921[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m361 | [0m[35m            # If we're not already in an anomaly period[0m
[30;1m362 | [0m[35m            # create start/end for a new one[0m
[30;1m363 | [0m[35m            start_period = time - pd.Timedelta(period)  # type: ignore[0m
[30;1m364 | [0m[35m            end_period = time + pd.Timedelta(period)  # type: ignore[0m
[30;1m365 | [0m[35m            periods[start_period] = end_period[0m
[30;1m366 | [0m[35m        elif (time - end_period) <= pd.Timedelta([0m
[30;1m367 | [0m[35m            period[0m

[31m--[ [0m[34mMatch #[0m[33m1922[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m360 | [0m[35m        if not end_period:[0m
[30;1m361 | [0m[35m            # If we're not already in an anomaly period[0m
[30;1m362 | [0m[35m            # create start/end for a new one[0m
[30;1m363 | [0m[35m            start_period = time - pd.Timedelta(period)  # type: ignore[0m
[30;1m364 | [0m[35m            end_period = time + pd.Timedelta(period)  # type: ignore[0m
[30;1m365 | [0m[35m            periods[start_period] = end_period[0m
[30;1m366 | [0m[35m        elif (time - end_period) <= pd.Timedelta([0m

[31m--[ [0m[34mMatch #[0m[33m1923[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m324 | [0m[35m    time_column : str, optional[0m
[30;1m325 | [0m[35m        The name of the time column[0m
[30;1m326 | [0m[35m    period : str, optional[0m
[30;1m327 | [0m[35m        pandas-compatible time period designator,[0m
[30;1m328 | [0m[35m        by default "1h"[0m
[30;1m329 | [0m[35m    pos_only : bool, optional[0m
[30;1m330 | [0m[35m        If True only extract positive anomaly periods,[0m

[31m--[ [0m[34mMatch #[0m[33m1924[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m322 | [0m[35m    data : pd.DataFrame[0m
[30;1m323 | [0m[35m        The data to process[0m
[30;1m324 | [0m[35m    time_column : str, optional[0m
[30;1m325 | [0m[35m        The name of the time column[0m
[30;1m326 | [0m[35m    period : str, optional[0m
[30;1m327 | [0m[35m        pandas-compatible time period designator,[0m
[30;1m328 | [0m[35m        by default "1h"[0m

[31m--[ [0m[34mMatch #[0m[33m1925[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m    Returns[0m
[30;1m248 | [0m[35m    -------[0m
[30;1m249 | [0m[35m    pd.DataFrame[0m
[30;1m250 | [0m[35m        Returns a dataframe with additional columns by decomposing time series data[0m
[30;1m251 | [0m[35m        into residual, trend, seasonal, weights, baseline, score and anomalies.[0m
[30;1m252 | [0m[35m        The anomalies column will have 0, 1,-1 values based on score_threshold set.[0m
[30;1m253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1926[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m232 | [0m[35m    ----------------[0m
[30;1m233 | [0m[35m    time_column : str, optional[0m
[30;1m234 | [0m[35m        If the input data is not indexed on the time column, use this column[0m
[30;1m235 | [0m[35m        as the time index[0m
[30;1m236 | [0m[35m    data_column : str, optional[0m
[30;1m237 | [0m[35m        Use named column if the input data has more than one column.[0m
[30;1m238 | [0m[35m    seasonal : int, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1927[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m    Other Parameters[0m
[30;1m232 | [0m[35m    ----------------[0m
[30;1m233 | [0m[35m    time_column : str, optional[0m
[30;1m234 | [0m[35m        If the input data is not indexed on the time column, use this column[0m
[30;1m235 | [0m[35m        as the time index[0m
[30;1m236 | [0m[35m    data_column : str, optional[0m
[30;1m237 | [0m[35m        Use named column if the input data has more than one column.[0m

[31m--[ [0m[34mMatch #[0m[33m1928[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m    ----------[0m
[30;1m226 | [0m[35m    data : pd.DataFrame[0m
[30;1m227 | [0m[35m        DataFrame as a time series data set retrieved from data connector or[0m
[30;1m228 | [0m[35m        external data source. Dataframe must have 2 columns with time column[0m
[30;1m229 | [0m[35m        set as index and other numeric value.[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m    Other Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m1929[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m    Parameters[0m
[30;1m225 | [0m[35m    ----------[0m
[30;1m226 | [0m[35m    data : pd.DataFrame[0m
[30;1m227 | [0m[35m        DataFrame as a time series data set retrieved from data connector or[0m
[30;1m228 | [0m[35m        external data source. Dataframe must have 2 columns with time column[0m
[30;1m229 | [0m[35m        set as index and other numeric value.[0m
[30;1m230 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1930[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m        Parameters[0m
[30;1m155 | [0m[35m        ----------[0m
[30;1m156 | [0m[35m            value_column : str, optional[0m
[30;1m157 | [0m[35m            Name of column holding numeric values to plot against time series to[0m
[30;1m158 | [0m[35m            determine anomalies[0m
[30;1m159 | [0m[35m            (the default is 'Total')[0m
[30;1m160 | [0m[35m        y : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1931[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def plot(self, **kwargs):[0m
[30;1m151 | [0m[35m        """[0m
[30;1m152 | [0m[35m        Display time series anomalies visualization.[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m        Parameters[0m
[30;1m155 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1932[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m        time_column : str, optional[0m
[30;1m132 | [0m[35m            The name of the time column[0m
[30;1m133 | [0m[35m        period : str, optional[0m
[30;1m134 | [0m[35m            pandas-compatible time period designator,[0m
[30;1m135 | [0m[35m            by default "1H"[0m
[30;1m136 | [0m[35m        pos_only : bool, optional[0m
[30;1m137 | [0m[35m            If True only extract positive anomaly periods,[0m

[31m--[ [0m[34mMatch #[0m[33m1933[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m        Parameters[0m
[30;1m130 | [0m[35m        ----------[0m
[30;1m131 | [0m[35m        time_column : str, optional[0m
[30;1m132 | [0m[35m            The name of the time column[0m
[30;1m133 | [0m[35m        period : str, optional[0m
[30;1m134 | [0m[35m            pandas-compatible time period designator,[0m
[30;1m135 | [0m[35m            by default "1H"[0m

[31m--[ [0m[34mMatch #[0m[33m1934[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    def kql_periods(self, **kwargs):[0m
[30;1m126 | [0m[35m        """[0m
[30;1m127 | [0m[35m        Return KQL filter expression for anomaly time periods.[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        Parameters[0m
[30;1m130 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m1935[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        time_column : str, optional[0m
[30;1m82 | [0m[35m            The name of the time column[0m
[30;1m83 | [0m[35m        period : str, optional[0m
[30;1m84 | [0m[35m            pandas-compatible time period designator,[0m
[30;1m85 | [0m[35m            by default "1H"[0m
[30;1m86 | [0m[35m        pos_only : bool, optional[0m
[30;1m87 | [0m[35m            If True only extract positive anomaly periods,[0m

[31m--[ [0m[34mMatch #[0m[33m1936[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m        Parameters[0m
[30;1m80 | [0m[35m        ----------[0m
[30;1m81 | [0m[35m        time_column : str, optional[0m
[30;1m82 | [0m[35m            The name of the time column[0m
[30;1m83 | [0m[35m        period : str, optional[0m
[30;1m84 | [0m[35m            pandas-compatible time period designator,[0m
[30;1m85 | [0m[35m            by default "1H"[0m

[31m--[ [0m[34mMatch #[0m[33m1937[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m        Returns[0m
[30;1m62 | [0m[35m        -------[0m
[30;1m63 | [0m[35m        pd.DataFrame[0m
[30;1m64 | [0m[35m            Returns a dataframe with additional columns by decomposing time series data[0m
[30;1m65 | [0m[35m            into residual, trend, seasonal, weights, baseline, score and anomalies.[0m
[30;1m66 | [0m[35m            The anomalies column will have 0, 1,-1 values based on score_threshold set.[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1938[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m        ----------[0m
[30;1m47 | [0m[35m        time_column : str, optional[0m
[30;1m48 | [0m[35m            If the input data is not indexed on the time column, use this column[0m
[30;1m49 | [0m[35m            as the time index[0m
[30;1m50 | [0m[35m        data_column : str, optional[0m
[30;1m51 | [0m[35m            Use named column if the input data has more than one column.[0m
[30;1m52 | [0m[35m        seasonal : int, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1939[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        Parameters[0m
[30;1m46 | [0m[35m        ----------[0m
[30;1m47 | [0m[35m        time_column : str, optional[0m
[30;1m48 | [0m[35m            If the input data is not indexed on the time column, use this column[0m
[30;1m49 | [0m[35m            as the time index[0m
[30;1m50 | [0m[35m        data_column : str, optional[0m
[30;1m51 | [0m[35m            Use named column if the input data has more than one column.[0m

[31m--[ [0m[34mMatch #[0m[33m1940[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/timeseries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m@pd.api.extensions.register_dataframe_accessor("mp_timeseries")[0m
[30;1m34 | [0m[35mclass MsticpyTimeSeriesAccessor:[0m
[30;1m35 | [0m[35m    """Msticpy pandas accessor for time series functions."""[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def __init__(self, pandas_obj):[0m
[30;1m38 | [0m[35m        """Initialize the extension."""[0m

[31m--[ [0m[34mMatch #[0m[33m1941[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_activity.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m34 | [0m[35m        type: str[0m
[30;1m35 | [0m[35m        default: ''[0m
[30;1m36 | [0m[35m      host_op:[0m
[30;1m37 | [0m[35m        description: The hostname match operator[0m
[30;1m38 | [0m[35m        type: str[0m
[30;1m39 | [0m[35m        default: has[0m
[30;1m40 | [0m[35m      query_project:[0m

[31m--[ [0m[34mMatch #[0m[33m1942[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_activity.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m        description: Query start time[0m
[30;1m20 | [0m[35m        type: datetime[0m
[30;1m21 | [0m[35m      end:[0m
[30;1m22 | [0m[35m        description: Query end time[0m
[30;1m23 | [0m[35m        type: datetime[0m
[30;1m24 | [0m[35m      add_query_items:[0m
[30;1m25 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m1943[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_activity.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m        type: str[0m
[30;1m17 | [0m[35m        default: 'Syslog'[0m
[30;1m18 | [0m[35m      start:[0m
[30;1m19 | [0m[35m        description: Query start time[0m
[30;1m20 | [0m[35m        type: datetime[0m
[30;1m21 | [0m[35m      end:[0m
[30;1m22 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m1944[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m494 | [0m[35m        if "Type" not in raw_entity and entity_type is None:[0m
[30;1m495 | [0m[35m            return raw_entity[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35m        entity_type_name = raw_entity.get("Type")[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m        if not entity_type_name and entity_type:[0m
[30;1m500 | [0m[35m            entity_type_name = cls._get_entity_type_name(entity_type)[0m

[31m--[ [0m[34mMatch #[0m[33m1945[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m        )[0m
[30;1m140 | [0m[35m        if not ent_type:[0m
[30;1m141 | [0m[35m            ent_type = "unknown"[0m
[30;1m142 | [0m[35m        ent_cls = cls.ENTITY_NAME_MAP.get(ent_type)[0m
[30;1m143 | [0m[35m        if not ent_cls:[0m
[30;1m144 | [0m[35m            ent_cls = cls.ENTITY_NAME_MAP["unknown"][0m
[30;1m145 | [0m[35m        return ent_cls(src_entity, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m1946[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m        ent_type = ([0m
[30;1m136 | [0m[35m            src_entity.get("Type") or src_entity.get("type")[0m
[30;1m137 | [0m[35m            if src_entity[0m
[30;1m138 | [0m[35m            else kwargs.get("Type") or kwargs.get("type")[0m
[30;1m139 | [0m[35m        )[0m
[30;1m140 | [0m[35m        if not ent_type:[0m
[30;1m141 | [0m[35m            ent_type = "unknown"[0m

[31m--[ [0m[34mMatch #[0m[33m1947[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m        ent_type = ([0m
[30;1m136 | [0m[35m            src_entity.get("Type") or src_entity.get("type")[0m
[30;1m137 | [0m[35m            if src_entity[0m
[30;1m138 | [0m[35m            else kwargs.get("Type") or kwargs.get("type")[0m
[30;1m139 | [0m[35m        )[0m
[30;1m140 | [0m[35m        if not ent_type:[0m
[30;1m141 | [0m[35m            ent_type = "unknown"[0m

[31m--[ [0m[34mMatch #[0m[33m1948[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        """[0m
[30;1m135 | [0m[35m        ent_type = ([0m
[30;1m136 | [0m[35m            src_entity.get("Type") or src_entity.get("type")[0m
[30;1m137 | [0m[35m            if src_entity[0m
[30;1m138 | [0m[35m            else kwargs.get("Type") or kwargs.get("type")[0m
[30;1m139 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1949[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        """[0m
[30;1m135 | [0m[35m        ent_type = ([0m
[30;1m136 | [0m[35m            src_entity.get("Type") or src_entity.get("type")[0m
[30;1m137 | [0m[35m            if src_entity[0m
[30;1m138 | [0m[35m            else kwargs.get("Type") or kwargs.get("type")[0m
[30;1m139 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1950[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m586 | [0m[35m            graph.add_edge(edge.source.name_str, edge.target.name_str, **edge.attrs)[0m
[30;1m587 | [0m[35m[0m
[30;1m588 | [0m[35m            for node in (edge.source, edge.target):[0m
[30;1m589 | [0m[35m                # If this node has edges that are not in our graph[0m
[30;1m590 | [0m[35m                # call to_networkx recursively on that node.[0m
[30;1m591 | [0m[35m                if any([0m
[30;1m592 | [0m[35m                    edge[0m

[31m--[ [0m[34mMatch #[0m[33m1951[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m585 | [0m[35m                continue[0m
[30;1m586 | [0m[35m            graph.add_edge(edge.source.name_str, edge.target.name_str, **edge.attrs)[0m
[30;1m587 | [0m[35m[0m
[30;1m588 | [0m[35m            for node in (edge.source, edge.target):[0m
[30;1m589 | [0m[35m                # If this node has edges that are not in our graph[0m
[30;1m590 | [0m[35m                # call to_networkx recursively on that node.[0m
[30;1m591 | [0m[35m                if any([0m

[31m--[ [0m[34mMatch #[0m[33m1952[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m504 | [0m[35m        if entity_type_name and entity_type_name.lower() in cls.ENTITY_NAME_MAP:[0m
[30;1m505 | [0m[35m            return cls.ENTITY_NAME_MAP[entity_type_name.lower()](raw_entity)[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m        raise TypeError(f"Could not find a suitable type for {entity_type}")[0m
[30;1m508 | [0m[35m[0m
[30;1m509 | [0m[35m    @classmethod[0m
[30;1m510 | [0m[35m    def _get_entity_type_name(cls, entity_type: Type) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1953[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/entity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35mfrom ..._version import VERSION[0m
[30;1m20 | [0m[35mfrom ...common.utility import export, valid_pyname[0m
[30;1m21 | [0m[35mfrom .entity_enums import ENTITY_ENUMS[0m
[30;1m22 | [0m[35mfrom .entity_graph import Node[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m__version__ = VERSION[0m
[30;1m25 | [0m[35m__author__ = "Ian Hellen"[0m

[31m--[ [0m[34mMatch #[0m[33m1954[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m530 | [0m[35m                    }[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        FontAwesome icon (prefix "fa") names are available at https://fontawesome.com/[0m
[30;1m533 | [0m[35m        GlyphIcons icons (prefix "glyphicon") are available at https://www.glyphicons.com/[0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m        """[0m
[30;1m536 | [0m[35m        return plot_map(data=self._df, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m1955[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m529 | [0m[35m                        "icon": "info-sign",[0m
[30;1m530 | [0m[35m                    }[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        FontAwesome icon (prefix "fa") names are available at https://fontawesome.com/[0m
[30;1m533 | [0m[35m        GlyphIcons icons (prefix "glyphicon") are available at https://www.glyphicons.com/[0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1956[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m561 | [0m[35m        node_size : int, optional[0m
[30;1m562 | [0m[35m            Size of the nodes in pixels, by default 25[0m
[30;1m563 | [0m[35m        font_size : int, optional[0m
[30;1m564 | [0m[35m            Font size for node labels, by default 10[0m
[30;1m565 | [0m[35m            Can be an integer (point size) or a string (e.g. "10pt")[0m
[30;1m566 | [0m[35m        width : int, optional[0m
[30;1m567 | [0m[35m            Width in pixels, by default 800[0m

[31m--[ [0m[34mMatch #[0m[33m1957[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m420 | [0m[35m        Parameters[0m
[30;1m421 | [0m[35m        ----------[0m
[30;1m422 | [0m[35m        ip_column : Optional[str], optional[0m
[30;1m423 | [0m[35m            The name of the IP Address column, by default None[0m
[30;1m424 | [0m[35m        lat_column : Optional[str], optional[0m
[30;1m425 | [0m[35m            The name of the location 'latitude' column, by default None[0m
[30;1m426 | [0m[35m        long_column : Optional[str], optional[0m

[31m--[ [0m[34mMatch #[0m[33m1958[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m391 | [0m[35m        node_size : int, optional[0m
[30;1m392 | [0m[35m            Size of the nodes in pixels, by default 25[0m
[30;1m393 | [0m[35m        font_size : int, optional[0m
[30;1m394 | [0m[35m            Font size for node labels, by default 10[0m
[30;1m395 | [0m[35m            Can be an integer (point size) or a string (e.g. "10pt")[0m
[30;1m396 | [0m[35m        width : int, optional[0m
[30;1m397 | [0m[35m            Width in pixels, by default 800[0m

[31m--[ [0m[34mMatch #[0m[33m1959[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m353 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m354 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m355 | [0m[35m            False or None (no sort)[0m
[30;1m356 | [0m[35m            True  - Sort ascending[0m
[30;1m357 | [0m[35m        hide : bool, optional[0m
[30;1m358 | [0m[35m            Creates and returns but does not display the plot, default[0m
[30;1m359 | [0m[35m            is False.[0m

[31m--[ [0m[34mMatch #[0m[33m1960[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m351 | [0m[35m            default is None.[0m
[30;1m352 | [0m[35m            Acceptable values are:[0m
[30;1m353 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m354 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m355 | [0m[35m            False or None (no sort)[0m
[30;1m356 | [0m[35m            True  - Sort ascending[0m
[30;1m357 | [0m[35m        hide : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1961[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m350 | [0m[35m            Sorts the labels of the y axis (takes precedence over `sort`),[0m
[30;1m351 | [0m[35m            default is None.[0m
[30;1m352 | [0m[35m            Acceptable values are:[0m
[30;1m353 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m354 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m355 | [0m[35m            False or None (no sort)[0m
[30;1m356 | [0m[35m            True  - Sort ascending[0m

[31m--[ [0m[34mMatch #[0m[33m1962[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m345 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m346 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m347 | [0m[35m            False or None (no sort)[0m
[30;1m348 | [0m[35m            True  - Sort ascending[0m
[30;1m349 | [0m[35m        sort_y : str, optional[0m
[30;1m350 | [0m[35m            Sorts the labels of the y axis (takes precedence over `sort`),[0m
[30;1m351 | [0m[35m            default is None.[0m

[31m--[ [0m[34mMatch #[0m[33m1963[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m343 | [0m[35m            default is None.[0m
[30;1m344 | [0m[35m            Acceptable values are:[0m
[30;1m345 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m346 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m347 | [0m[35m            False or None (no sort)[0m
[30;1m348 | [0m[35m            True  - Sort ascending[0m
[30;1m349 | [0m[35m        sort_y : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1964[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m            Sorts the labels of the x axis (takes precedence over `sort`),[0m
[30;1m343 | [0m[35m            default is None.[0m
[30;1m344 | [0m[35m            Acceptable values are:[0m
[30;1m345 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m346 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m347 | [0m[35m            False or None (no sort)[0m
[30;1m348 | [0m[35m            True  - Sort ascending[0m

[31m--[ [0m[34mMatch #[0m[33m1965[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m338 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m339 | [0m[35m            False or None (no sort)[0m
[30;1m340 | [0m[35m            True  - Sort ascending[0m
[30;1m341 | [0m[35m        sort_x : str, optional[0m
[30;1m342 | [0m[35m            Sorts the labels of the x axis (takes precedence over `sort`),[0m
[30;1m343 | [0m[35m            default is None.[0m

[31m--[ [0m[34mMatch #[0m[33m1966[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m335 | [0m[35m            Sorts the labels of both axes, default is None.[0m
[30;1m336 | [0m[35m            Acceptable values are:[0m
[30;1m337 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m338 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m339 | [0m[35m            False or None (no sort)[0m
[30;1m340 | [0m[35m            True  - Sort ascending[0m
[30;1m341 | [0m[35m        sort_x : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1967[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m        sort : Union[str, bool], optional[0m
[30;1m335 | [0m[35m            Sorts the labels of both axes, default is None.[0m
[30;1m336 | [0m[35m            Acceptable values are:[0m
[30;1m337 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m
[30;1m338 | [0m[35m            'desc' (or string starting with 'asc') - Sort descending[0m
[30;1m339 | [0m[35m            False or None (no sort)[0m
[30;1m340 | [0m[35m            True  - Sort ascending[0m

[31m--[ [0m[34mMatch #[0m[33m1968[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m331 | [0m[35m            The plot width. Default is 900[0m
[30;1m332 | [0m[35m        color : str[0m
[30;1m333 | [0m[35m            The color of the plotted points, default is "red"[0m
[30;1m334 | [0m[35m        sort : Union[str, bool], optional[0m
[30;1m335 | [0m[35m            Sorts the labels of both axes, default is None.[0m
[30;1m336 | [0m[35m            Acceptable values are:[0m
[30;1m337 | [0m[35m            'asc' (or string starting with 'asc') - Sort ascending[0m

[31m--[ [0m[34mMatch #[0m[33m1969[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m            If `end_time_column` is not specified it will also be used to[0m
[30;1m203 | [0m[35m            calculate the end time.[0m
[30;1m204 | [0m[35m        end_time_column : Optional[str][0m
[30;1m205 | [0m[35m            If supplied, it will be used to calculate the end time[0m
[30;1m206 | [0m[35m            of the duration for each group.[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        Other Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m1970[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m198 | [0m[35m            The column name or iterable of column names to group the data by.[0m
[30;1m199 | [0m[35m        time_column : str[0m
[30;1m200 | [0m[35m            Primary time column - will be used to calculate the[0m
[30;1m201 | [0m[35m            start time of the duration for each group.[0m
[30;1m202 | [0m[35m            If `end_time_column` is not specified it will also be used to[0m
[30;1m203 | [0m[35m            calculate the end time.[0m
[30;1m204 | [0m[35m        end_time_column : Optional[str][0m

[31m--[ [0m[34mMatch #[0m[33m1971[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m        group_by : Union[Iterable[str], str][0m
[30;1m198 | [0m[35m            The column name or iterable of column names to group the data by.[0m
[30;1m199 | [0m[35m        time_column : str[0m
[30;1m200 | [0m[35m            Primary time column - will be used to calculate the[0m
[30;1m201 | [0m[35m            start time of the duration for each group.[0m
[30;1m202 | [0m[35m            If `end_time_column` is not specified it will also be used to[0m
[30;1m203 | [0m[35m            calculate the end time.[0m

[31m--[ [0m[34mMatch #[0m[33m1972[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m            (the default is None)[0m
[30;1m164 | [0m[35m        ref_time_col : str, optional[0m
[30;1m165 | [0m[35m            Add references line/label using the this column in `ref_events`[0m
[30;1m166 | [0m[35m            for the time value (x-axis).[0m
[30;1m167 | [0m[35m            (this defaults the value of the `time_column` parameter or 'TimeGenerated'[0m
[30;1m168 | [0m[35m            `time_column` is None)[0m
[30;1m169 | [0m[35m        ref_col : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1973[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m        title : str, optional[0m
[30;1m132 | [0m[35m            Title to display (the default is None)[0m
[30;1m133 | [0m[35m        ref_event : Any, optional[0m
[30;1m134 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m135 | [0m[35m        ref_time : datetime, optional[0m
[30;1m136 | [0m[35m            Add a reference line/label using `ref_time` (the default is None)[0m
[30;1m137 | [0m[35m        ref_label : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1974[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m            (the default is None)[0m
[30;1m88 | [0m[35m        ref_time_col : str, optional[0m
[30;1m89 | [0m[35m            Add references line/label using the this column in `ref_events`[0m
[30;1m90 | [0m[35m            for the time value (x-axis).[0m
[30;1m91 | [0m[35m            (this defaults the value of the `time_column` parameter or 'TimeGenerated'[0m
[30;1m92 | [0m[35m            `time_column` is None)[0m
[30;1m93 | [0m[35m        ref_col : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1975[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m        alert : SecurityAlert, optional[0m
[30;1m57 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m58 | [0m[35m        ref_event : Any, optional[0m
[30;1m59 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m60 | [0m[35m        ref_time : datetime, optional[0m
[30;1m61 | [0m[35m            Add a reference line/label using `ref_time` (the default is None)[0m
[30;1m62 | [0m[35m        group_by : str[0m

[31m--[ [0m[34mMatch #[0m[33m1976[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/mp_pandas_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m        title : str, optional[0m
[30;1m53 | [0m[35m            Title to display (the default is None)[0m
[30;1m54 | [0m[35m        alert : SecurityAlert, optional[0m
[30;1m55 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m56 | [0m[35m        ref_event : Any, optional[0m
[30;1m57 | [0m[35m            Add a reference line/label using the alert time (the default is None)[0m
[30;1m58 | [0m[35m        ref_time : datetime, optional[0m

[31m--[ [0m[34mMatch #[0m[33m1977[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/localdata/local_data.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    args:[0m
[30;1m46 | [0m[35m      query: process_tree.pkl[0m
[30;1m47 | [0m[35m  list_azure_network_flows_by_ip:[0m
[30;1m48 | [0m[35m    description: List Azure Network flows by IP address[0m
[30;1m49 | [0m[35m    metadata:[0m
[30;1m50 | [0m[35m      data_families: [Network][0m
[30;1m51 | [0m[35m    args:[0m

[31m--[ [0m[34mMatch #[0m[33m1978[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m    if entity_cf in entity_cls_dict:[0m
[30;1m126 | [0m[35m        print(f"Match found '{entity_cls_dict[entity_cf].__name__}'")[0m
[30;1m127 | [0m[35m        return entity_cls_dict[entity_cf][0m
[30;1m128 | [0m[35m    # Try to find the closest matches[0m
[30;1m129 | [0m[35m    closest = difflib.get_close_matches(entity, entity_cls_dict.keys(), cutoff=0.4)[0m
[30;1m130 | [0m[35m    mssg = [f"No exact match found for '{entity}'. "][0m
[30;1m131 | [0m[35m    if len(closest) == 1:[0m

[31m--[ [0m[34mMatch #[0m[33m1979[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m177 | [0m[35m### Event Timelines[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35mDisplay any log events on an interactive timeline. Using the[0m
[30;1m180 | [0m[35m[Bokeh Visualization Library](https://bokeh.org/) the timeline control enables[0m
[30;1m181 | [0m[35myou to visualize one or more event streams, interactively zoom into specific time[0m
[30;1m182 | [0m[35mslots and view event details for plotted events.[0m
[30;1m183 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1980[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m[docs/notebooks](https://github.com/microsoft/msticpy/blob/master/docs/notebooks)[0m
[30;1m81 | [0m[35mfolder and accompanying notebooks.[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35mYou can also browse through the sample notebooks referenced at the end of this document[0m
[30;1m84 | [0m[35mto see some of the functionality used in context. You can play with some of the package[0m
[30;1m85 | [0m[35mfunctions in this interactive demo on mybinder.org.[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1981[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m## Documentation[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35mFull documentation is at [ReadTheDocs](https://msticpy.readthedocs.io/en/latest/)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35mSample notebooks for many of the modules are in the[0m
[30;1m80 | [0m[35m[docs/notebooks](https://github.com/microsoft/msticpy/blob/master/docs/notebooks)[0m

[31m--[ [0m[34mMatch #[0m[33m1982[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m`pip install --upgrade msticpy`[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35mNote it is good practice to copy your msticpyconfig.yaml and store it on your disk but outside of yo[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m## Documentation[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1983[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m<img src="./docs/source/visualization/_static/Widgets1.png"[0m
[30;1m290 | [0m[35m  alt="Time span Widget"[0m
[30;1m291 | [0m[35m  title="Query time setter" height="100" />[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m<img src="./docs/source/visualization/_static/Widgets4.png"[0m
[30;1m294 | [0m[35m  alt="Alert browser"[0m

[31m--[ [0m[34mMatch #[0m[33m1984[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35mThese are built from the [Jupyter ipywidgets](https://ipywidgets.readthedocs.io/) collection[0m
[30;1m286 | [0m[35mand group common functionality useful in InfoSec tasks such as list pickers,[0m
[30;1m287 | [0m[35mquery time boundary settings and event display into an easy-to-use format.[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m<img src="./docs/source/visualization/_static/Widgets1.png"[0m
[30;1m290 | [0m[35m  alt="Time span Widget"[0m

[31m--[ [0m[34mMatch #[0m[33m1985[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m### iocextract[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35mUses regular expressions to look for Indicator of Compromise (IoC) patterns - IP Addresses, URLs,[0m
[30;1m237 | [0m[35mDNS domains, Hashes, file paths.[0m
[30;1m238 | [0m[35mInput can be a single string or a pandas dataframe.[0m
[30;1m239 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1986[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m226 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m227 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m228 | [0m[35mbase64 content and up to a specified depth.[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m[Base64 Decoding](https://msticpy.readthedocs.io/en/latest/data_analysis/Base64Unpack.html)[0m
[30;1m231 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m1987[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m### base64unpack[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m226 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m227 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m228 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m1988[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m[Pivot Functions Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/PivotFunc[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m### base64unpack[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35mBase64 and archive (gz, zip, tar) extractor. It will try to identify any base64 encoded[0m
[30;1m228 | [0m[35mstrings and try decode them. If the result looks like one of the supported archive types it[0m
[30;1m229 | [0m[35mwill unpack the contents. The results of each decode/unpack are rechecked for further[0m
[30;1m230 | [0m[35mbase64 content and up to a specified depth.[0m

[31m--[ [0m[34mMatch #[0m[33m1989[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35mLets you use *MSTICPy* functionality in an "entity-centric" way.[0m
[30;1m214 | [0m[35mAll functions, queries and lookups that relate to a particular entity type[0m
[30;1m215 | [0m[35m(e.g. Host, IpAddress, Url) are collected together as methods of that[0m
[30;1m216 | [0m[35mentity class. So, if you want to do things with an IP address, just load[0m
[30;1m217 | [0m[35mthe IpAddress entity and browse its methods.[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m[Pivot Functions](https://msticpy.readthedocs.io/en/latest/data_analysis/PivotFunctions.html)[0m

[31m--[ [0m[34mMatch #[0m[33m1990[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35mDisplay any log events on an interactive timeline. Using the[0m
[30;1m180 | [0m[35m[Bokeh Visualization Library](https://bokeh.org/) the timeline control enables[0m
[30;1m181 | [0m[35myou to visualize one or more event streams, interactively zoom into specific time[0m
[30;1m182 | [0m[35mslots and view event details for plotted events.[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m<img src="./docs/source/visualization/_static/TimeLine-01.png"[0m

[31m--[ [0m[34mMatch #[0m[33m1991[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m[Anomalous Sequence Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Anomal[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m### Time Series Analysis[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35mTime series analysis allows you to identify unusual patterns in your log data[0m
[30;1m167 | [0m[35mtaking into account normal seasonal variations (e.g. the regular ebb and flow of[0m
[30;1m168 | [0m[35mevents over hours of the day, days of the week, etc.). Using both analysis and[0m
[30;1m169 | [0m[35mvisualization highlights unusual traffic flows or event activity for any data[0m

[31m--[ [0m[34mMatch #[0m[33m1992[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m159 | [0m[35mand[0m
[30;1m160 | [0m[35m[Anomalous Sequence Notebook](https://github.com/microsoft/msticpy/blob/master/docs/notebooks/Anomal[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m### Time Series Analysis[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35mTime series analysis allows you to identify unusual patterns in your log data[0m
[30;1m165 | [0m[35mtaking into account normal seasonal variations (e.g. the regular ebb and flow of[0m

[31m--[ [0m[34mMatch #[0m[33m1993[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35mDetect unusual sequences of events in your Office, Active Directory or other log data.[0m
[30;1m154 | [0m[35mYou can extract sessions (e.g. activity initiated by the same account) and identify and[0m
[30;1m155 | [0m[35mvisualize unusual sequences of activity. For example, detecting an attacker setting[0m
[30;1m156 | [0m[35ma mail forwarding rule on someone's mailbox.[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m[Anomalous Sessions](https://msticpy.readthedocs.io/en/latest/data_analysis/AnomalousSequence.html)[0m
[30;1m159 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m1994[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m<img src="./docs/source/visualization/_static/folium_sf_zoom.png"[0m
[30;1m129 | [0m[35m  alt="Folium map"[0m
[30;1m130 | [0m[35m  title="Plotting Geo IP Location" height="200" />[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m[GeoIP Lookup](https://msticpy.readthedocs.io/en/latest/data_acquisition/GeoIPLookups.html)[0m
[30;1m133 | [0m[35mand[0m

[31m--[ [0m[34mMatch #[0m[33m1995[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m### GeoLocation Data[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35mThe GeoIP lookup classes allow you to match the geo-locations of IP addresses[0m
[30;1m123 | [0m[35musing either:[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m- GeoLiteLookup - Maxmind Geolite (see <https://www.maxmind.com>)[0m

[31m--[ [0m[34mMatch #[0m[33m1996[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m`pip install --upgrade msticpy`[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35mNote it is good practice to copy your msticpyconfig.yaml and store it on your disk but outside of yo[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m## Documentation[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1997[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m  multi-dimensional Morph Charts[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mIt also includes some time-saving notebook tools such as widgets to[0m
[30;1m23 | [0m[35mset query time boundaries, select and display items from lists, and[0m
[30;1m24 | [0m[35mconfigure the notebook environment.[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m<img src="./docs/source/visualization/_static/Timeline-08.png"[0m

[31m--[ [0m[34mMatch #[0m[33m1998[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m  resource data[0m
[30;1m16 | [0m[35m- extract Indicators of Activity (IoA) from logs and unpack encoded data[0m
[30;1m17 | [0m[35m- perform sophisticated analysis such as anomalous session detection and[0m
[30;1m18 | [0m[35m  time series decomposition[0m
[30;1m19 | [0m[35m- visualize data using interactive timelines, process trees and[0m
[30;1m20 | [0m[35m  multi-dimensional Morph Charts[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1999[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        """[0m
[30;1m273 | [0m[35m        host = kwargs.get("host", None)[0m
[30;1m274 | [0m[35m        glob_pat = kwargs.get("glob", "*")[0m
[30;1m275 | [0m[35m        if not index_name:[0m
[30;1m276 | [0m[35m            raise ValueError("parameter `index_name` must be specified")[0m
[30;1m277 | [0m[35m        input_files = Path(folder_path).glob(glob_pat)[0m

[31m--[ [0m[34mMatch #[0m[33m2000[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m            Set this to true to create the index if it doesn't already exist. Default is False.[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        """[0m
[30;1m273 | [0m[35m        host = kwargs.get("host", None)[0m
[30;1m274 | [0m[35m        glob_pat = kwargs.get("glob", "*")[0m
[30;1m275 | [0m[35m        if not index_name:[0m
[30;1m276 | [0m[35m            raise ValueError("parameter `index_name` must be specified")[0m

[31m--[ [0m[34mMatch #[0m[33m2001[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m            Set this to true to create the index if it doesn't already exist. Default is False.[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        """[0m
[30;1m213 | [0m[35m        host = kwargs.get("host", None)[0m
[30;1m214 | [0m[35m        if not index_name:[0m
[30;1m215 | [0m[35m            raise ValueError("parameter `index_name` must be specified")[0m
[30;1m216 | [0m[35m        path = Path(file_path)[0m

[31m--[ [0m[34mMatch #[0m[33m2002[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m            else:[0m
[30;1m160 | [0m[35m                source_type = table_name[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m        host = kwargs.get("host", None)[0m
[30;1m163 | [0m[35m        if not index_name:[0m
[30;1m164 | [0m[35m            raise ValueError("parameter `index_name` must be specified")[0m
[30;1m165 | [0m[35m        if not isinstance(data, pd.DataFrame):[0m

[31m--[ [0m[34mMatch #[0m[33m2003[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m            )[0m
[30;1m101 | [0m[35m        if not host:[0m
[30;1m102 | [0m[35m            host = "msticpy_splunk_uploader"[0m
[30;1m103 | [0m[35m        index = self._load_index(index_name, kwargs.get("create_index", False))[0m
[30;1m104 | [0m[35m        progress = tqdm(total=len(data.index), desc="Rows", position=0)[0m
[30;1m105 | [0m[35m        source_types = [][0m
[30;1m106 | [0m[35m        for row in data.iterrows():[0m

[31m--[ [0m[34mMatch #[0m[33m2004[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        self.driver = SplunkDriver()[0m
[30;1m38 | [0m[35m        self.port = kwargs.get("port", 8089)[0m
[30;1m39 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m40 | [0m[35m        self._connect = kwargs.get("connect", True)[0m
[30;1m41 | [0m[35m        self.connected = False[0m
[30;1m42 | [0m[35m        if self._connect:[0m
[30;1m43 | [0m[35m            self.connect()[0m

[31m--[ [0m[34mMatch #[0m[33m2005[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        self.bearer_token = kwargs.get("bearer_token")[0m
[30;1m37 | [0m[35m        self.driver = SplunkDriver()[0m
[30;1m38 | [0m[35m        self.port = kwargs.get("port", 8089)[0m
[30;1m39 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m40 | [0m[35m        self._connect = kwargs.get("connect", True)[0m
[30;1m41 | [0m[35m        self.connected = False[0m
[30;1m42 | [0m[35m        if self._connect:[0m

[31m--[ [0m[34mMatch #[0m[33m2006[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m        self.username = kwargs.get("username")[0m
[30;1m36 | [0m[35m        self.bearer_token = kwargs.get("bearer_token")[0m
[30;1m37 | [0m[35m        self.driver = SplunkDriver()[0m
[30;1m38 | [0m[35m        self.port = kwargs.get("port", 8089)[0m
[30;1m39 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m40 | [0m[35m        self._connect = kwargs.get("connect", True)[0m
[30;1m41 | [0m[35m        self.connected = False[0m

[31m--[ [0m[34mMatch #[0m[33m2007[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        self.host = kwargs.get("host")[0m
[30;1m34 | [0m[35m        self.password = kwargs.get("password")[0m
[30;1m35 | [0m[35m        self.username = kwargs.get("username")[0m
[30;1m36 | [0m[35m        self.bearer_token = kwargs.get("bearer_token")[0m
[30;1m37 | [0m[35m        self.driver = SplunkDriver()[0m
[30;1m38 | [0m[35m        self.port = kwargs.get("port", 8089)[0m
[30;1m39 | [0m[35m        self._debug = kwargs.get("debug", False)[0m

[31m--[ [0m[34mMatch #[0m[33m2008[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m        self._kwargs = kwargs[0m
[30;1m33 | [0m[35m        self.host = kwargs.get("host")[0m
[30;1m34 | [0m[35m        self.password = kwargs.get("password")[0m
[30;1m35 | [0m[35m        self.username = kwargs.get("username")[0m
[30;1m36 | [0m[35m        self.bearer_token = kwargs.get("bearer_token")[0m
[30;1m37 | [0m[35m        self.driver = SplunkDriver()[0m
[30;1m38 | [0m[35m        self.port = kwargs.get("port", 8089)[0m

[31m--[ [0m[34mMatch #[0m[33m2009[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        super().__init__()[0m
[30;1m32 | [0m[35m        self._kwargs = kwargs[0m
[30;1m33 | [0m[35m        self.host = kwargs.get("host")[0m
[30;1m34 | [0m[35m        self.password = kwargs.get("password")[0m
[30;1m35 | [0m[35m        self.username = kwargs.get("username")[0m
[30;1m36 | [0m[35m        self.bearer_token = kwargs.get("bearer_token")[0m
[30;1m37 | [0m[35m        self.driver = SplunkDriver()[0m

[31m--[ [0m[34mMatch #[0m[33m2010[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        """Initialize a Splunk Uploader instance."""[0m
[30;1m31 | [0m[35m        super().__init__()[0m
[30;1m32 | [0m[35m        self._kwargs = kwargs[0m
[30;1m33 | [0m[35m        self.host = kwargs.get("host")[0m
[30;1m34 | [0m[35m        self.password = kwargs.get("password")[0m
[30;1m35 | [0m[35m        self.username = kwargs.get("username")[0m
[30;1m36 | [0m[35m        self.bearer_token = kwargs.get("bearer_token")[0m

[31m--[ [0m[34mMatch #[0m[33m2011[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/splunk_uploader.py[0m
   Pattern: [32m.hostname[0m
[30;1m90 | [0m[35m            csv, json or other can be input and then passed to[0m
[30;1m91 | [0m[35m            df.to_csv(), df.to_json(), df.to_string() styles respectively.[0m
[30;1m92 | [0m[35m        host : str, optional[0m
[30;1m93 | [0m[35m            The hostname associated with the uploaded data, by default "msticpy_splunk_uploader".[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m        """[0m
[30;1m96 | [0m[35m        if not self.connected:[0m

[31m--[ [0m[34mMatch #[0m[33m2012[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/oauth_application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    OAuthAppId : str[0m
[30;1m28 | [0m[35m        Global ID of the application (in AAD, "Application ID" of the application object)[0m
[30;1m29 | [0m[35m    OAuthObjectId : str[0m
[30;1m30 | [0m[35m        Object ID of the service principal in AAD[0m
[30;1m31 | [0m[35m    Name : str[0m
[30;1m32 | [0m[35m        Name of the app[0m
[30;1m33 | [0m[35m    TenantId : str[0m

[31m--[ [0m[34mMatch #[0m[33m2013[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m444 | [0m[35m        graph_df = series_data[list(data_columns)].copy()[0m
[30;1m445 | [0m[35m        graph_df["y_index"] = y_index[0m
[30;1m446 | [0m[35m        series_def["y_index"] = y_index[0m
[30;1m447 | [0m[35m        ser_color = series_def.get("color", None)[0m
[30;1m448 | [0m[35m        if not ser_color:[0m
[30;1m449 | [0m[35m            ser_color = colors[y_index % palette_size][0m
[30;1m450 | [0m[35m            series_def["color"] = ser_color[0m

[31m--[ [0m[34mMatch #[0m[33m2014[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m430 | [0m[35m        src_cols = series_def.get("source_columns", series_def_src_cols)[0m
[30;1m431 | [0m[35m        data_columns.update(src_cols or series_def_src_cols)[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m        time_col = series_def.get("time_column", None)[0m
[30;1m434 | [0m[35m        if not time_col:[0m
[30;1m435 | [0m[35m            time_col = param.time_column[0m
[30;1m436 | [0m[35m            series_def["time_column"] = time_col[0m

[31m--[ [0m[34mMatch #[0m[33m2015[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m427 | [0m[35m        # if the series has source columns, use those[0m
[30;1m428 | [0m[35m        # or fall back to global source cols or defaults[0m
[30;1m429 | [0m[35m        series_def_src_cols = get_def_source_cols(series_data, param.source_columns)[0m
[30;1m430 | [0m[35m        src_cols = series_def.get("source_columns", series_def_src_cols)[0m
[30;1m431 | [0m[35m        data_columns.update(src_cols or series_def_src_cols)[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m        time_col = series_def.get("time_column", None)[0m

[31m--[ [0m[34mMatch #[0m[33m2016[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m        legend_pos = "left"[0m
[30;1m342 | [0m[35m    legend_items = [][0m
[30;1m343 | [0m[35m    for ser_name, series_def in data.items():[0m
[30;1m344 | [0m[35m        size_param = series_def.get("size", 10)[0m
[30;1m345 | [0m[35m        glyph_size: Union[pd.Series, int][0m
[30;1m346 | [0m[35m        if isinstance(size_param, str):[0m
[30;1m347 | [0m[35m            if size_param in series_def["data"].columns:[0m

[31m--[ [0m[34mMatch #[0m[33m2017[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m472 | [0m[35m):[0m
[30;1m473 | [0m[35m    """Return data groupings as a dictionary."""[0m
[30;1m474 | [0m[35m    data_columns = get_def_source_cols(data, source_columns)[0m
[30;1m475 | [0m[35m    # If the time column not explicitly specified in source_columns, add it[0m
[30;1m476 | [0m[35m    data_columns.add(time_column)[0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m    series_dict: Dict[str, Dict] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m2018[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m453 | [0m[35m        series_def["source"] = ColumnDataSource(graph_df)[0m
[30;1m454 | [0m[35m        y_index += 1[0m
[30;1m455 | [0m[35m[0m
[30;1m456 | [0m[35m        # calculate min/max time from this set[0m
[30;1m457 | [0m[35m        if min_time is None:[0m
[30;1m458 | [0m[35m            min_time = series_data[time_col].min()[0m
[30;1m459 | [0m[35m            max_time = series_data[time_col].max()[0m

[31m--[ [0m[34mMatch #[0m[33m2019[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m434 | [0m[35m        if not time_col:[0m
[30;1m435 | [0m[35m            time_col = param.time_column[0m
[30;1m436 | [0m[35m            series_def["time_column"] = time_col[0m
[30;1m437 | [0m[35m        # ensure named time columns are in datetime format[0m
[30;1m438 | [0m[35m        series_data = ensure_df_datetimes(data=series_data, columns=time_col)[0m
[30;1m439 | [0m[35m        data_columns.update([time_col])[0m
[30;1m440 | [0m[35m        # add the data columns to the tool tip column set[0m

[31m--[ [0m[34mMatch #[0m[33m2020[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m        (the default is None)[0m
[30;1m178 | [0m[35m    ref_time_col : str, optional[0m
[30;1m179 | [0m[35m        Add references line/label using the this column in `ref_events`[0m
[30;1m180 | [0m[35m        for the time value (x-axis).[0m
[30;1m181 | [0m[35m        (this defaults the value of the `time_column` parameter or 'TimeGenerated'[0m
[30;1m182 | [0m[35m        `time_column` is None)[0m
[30;1m183 | [0m[35m    ref_col : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m2021[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m    alert : SecurityAlert, optional[0m
[30;1m139 | [0m[35m        Add a reference line/label using the alert time (the default is None)[0m
[30;1m140 | [0m[35m    ref_event : Any, optional[0m
[30;1m141 | [0m[35m        Add a reference line/label using the alert time (the default is None)[0m
[30;1m142 | [0m[35m    ref_time : datetime, optional[0m
[30;1m143 | [0m[35m        Add a reference line/label using `ref_time` (the default is None)[0m
[30;1m144 | [0m[35m    group_by : str[0m

[31m--[ [0m[34mMatch #[0m[33m2022[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/timeline.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m    title : str, optional[0m
[30;1m135 | [0m[35m        Title to display (the default is None)[0m
[30;1m136 | [0m[35m    alert : SecurityAlert, optional[0m
[30;1m137 | [0m[35m        Add a reference line/label using the alert time (the default is None)[0m
[30;1m138 | [0m[35m    ref_event : Any, optional[0m
[30;1m139 | [0m[35m        Add a reference line/label using the alert time (the default is None)[0m
[30;1m140 | [0m[35m    ref_time : datetime, optional[0m

[31m--[ [0m[34mMatch #[0m[33m2023[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/uploader_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    @staticmethod[0m
[30;1m79 | [0m[35m    def get_http_timeout(**kwargs):[0m
[30;1m80 | [0m[35m        """Get http timeout from settings or kwargs."""[0m
[30;1m81 | [0m[35m        return get_http_timeout(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m2024[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m470 | [0m[35m    node_attrs = {}[0m
[30;1m471 | [0m[35m    for node, attrs in entity_graph.nodes(data=True):[0m
[30;1m472 | [0m[35m        try:[0m
[30;1m473 | [0m[35m            color = color_map.get(attrs["Type"].lower(), "green")[0m
[30;1m474 | [0m[35m        except KeyError:[0m
[30;1m475 | [0m[35m            color = "green"[0m
[30;1m476 | [0m[35m        node_attrs.update({node: color})[0m

[31m--[ [0m[34mMatch #[0m[33m2025[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m                "TimeGenerated": _convert_to_tz_aware_ts(node.get("TimeGenerated")),[0m
[30;1m340 | [0m[35m                "EndTime": _convert_to_tz_aware_ts(node.get("EndTime")),[0m
[30;1m341 | [0m[35m                "StartTime": _convert_to_tz_aware_ts([0m
[30;1m342 | [0m[35m                    node.get("StartTime", node.get("TimeGenerated"))[0m
[30;1m343 | [0m[35m                ),[0m
[30;1m344 | [0m[35m            }[0m
[30;1m345 | [0m[35m            for node in self.alertentity_graph.nodes.values()[0m

[31m--[ [0m[34mMatch #[0m[33m2026[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m                "TimeGenerated": _convert_to_tz_aware_ts(node.get("TimeGenerated")),[0m
[30;1m340 | [0m[35m                "EndTime": _convert_to_tz_aware_ts(node.get("EndTime")),[0m
[30;1m341 | [0m[35m                "StartTime": _convert_to_tz_aware_ts([0m
[30;1m342 | [0m[35m                    node.get("StartTime", node.get("TimeGenerated"))[0m
[30;1m343 | [0m[35m                ),[0m
[30;1m344 | [0m[35m            }[0m
[30;1m345 | [0m[35m            for node in self.alertentity_graph.nodes.values()[0m

[31m--[ [0m[34mMatch #[0m[33m2027[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m337 | [0m[35m                "Description": node.get("Description"),[0m
[30;1m338 | [0m[35m                "Type": node.get("Type"),[0m
[30;1m339 | [0m[35m                "TimeGenerated": _convert_to_tz_aware_ts(node.get("TimeGenerated")),[0m
[30;1m340 | [0m[35m                "EndTime": _convert_to_tz_aware_ts(node.get("EndTime")),[0m
[30;1m341 | [0m[35m                "StartTime": _convert_to_tz_aware_ts([0m
[30;1m342 | [0m[35m                    node.get("StartTime", node.get("TimeGenerated"))[0m
[30;1m343 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m2028[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m336 | [0m[35m                "Name": node.get("Name"),[0m
[30;1m337 | [0m[35m                "Description": node.get("Description"),[0m
[30;1m338 | [0m[35m                "Type": node.get("Type"),[0m
[30;1m339 | [0m[35m                "TimeGenerated": _convert_to_tz_aware_ts(node.get("TimeGenerated")),[0m
[30;1m340 | [0m[35m                "EndTime": _convert_to_tz_aware_ts(node.get("EndTime")),[0m
[30;1m341 | [0m[35m                "StartTime": _convert_to_tz_aware_ts([0m
[30;1m342 | [0m[35m                    node.get("StartTime", node.get("TimeGenerated"))[0m

[31m--[ [0m[34mMatch #[0m[33m2029[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m335 | [0m[35m            {[0m
[30;1m336 | [0m[35m                "Name": node.get("Name"),[0m
[30;1m337 | [0m[35m                "Description": node.get("Description"),[0m
[30;1m338 | [0m[35m                "Type": node.get("Type"),[0m
[30;1m339 | [0m[35m                "TimeGenerated": _convert_to_tz_aware_ts(node.get("TimeGenerated")),[0m
[30;1m340 | [0m[35m                "EndTime": _convert_to_tz_aware_ts(node.get("EndTime")),[0m
[30;1m341 | [0m[35m                "StartTime": _convert_to_tz_aware_ts([0m

[31m--[ [0m[34mMatch #[0m[33m2030[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m        node_list = [[0m
[30;1m335 | [0m[35m            {[0m
[30;1m336 | [0m[35m                "Name": node.get("Name"),[0m
[30;1m337 | [0m[35m                "Description": node.get("Description"),[0m
[30;1m338 | [0m[35m                "Type": node.get("Type"),[0m
[30;1m339 | [0m[35m                "TimeGenerated": _convert_to_tz_aware_ts(node.get("TimeGenerated")),[0m
[30;1m340 | [0m[35m                "EndTime": _convert_to_tz_aware_ts(node.get("EndTime")),[0m

[31m--[ [0m[34mMatch #[0m[33m2031[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m        """Generate a dataframe of nodes in the graph."""[0m
[30;1m334 | [0m[35m        node_list = [[0m
[30;1m335 | [0m[35m            {[0m
[30;1m336 | [0m[35m                "Name": node.get("Name"),[0m
[30;1m337 | [0m[35m                "Description": node.get("Description"),[0m
[30;1m338 | [0m[35m                "Type": node.get("Type"),[0m
[30;1m339 | [0m[35m                "TimeGenerated": _convert_to_tz_aware_ts(node.get("TimeGenerated")),[0m

[31m--[ [0m[34mMatch #[0m[33m2032[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m440 | [0m[35m    node_size : int, optional[0m
[30;1m441 | [0m[35m        Size of the nodes in pixels, by default 25[0m
[30;1m442 | [0m[35m    font_size : int, optional[0m
[30;1m443 | [0m[35m        Font size for node labels, by default 10[0m
[30;1m444 | [0m[35m        Can be an integer (point size) or a string (e.g. "10pt")[0m
[30;1m445 | [0m[35m    width : int, optional[0m
[30;1m446 | [0m[35m        Width in pixels, by default 800[0m

[31m--[ [0m[34mMatch #[0m[33m2033[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m                    node.get("StartTime", node.get("TimeGenerated"))[0m
[30;1m343 | [0m[35m                ),[0m
[30;1m344 | [0m[35m            }[0m
[30;1m345 | [0m[35m            for node in self.alertentity_graph.nodes.values()[0m
[30;1m346 | [0m[35m        ][0m
[30;1m347 | [0m[35m        return pd.DataFrame(node_list).replace("None", np.nan)[0m
[30;1m348 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2034[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m323 | [0m[35m            The name of the node to remove.[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        """[0m
[30;1m326 | [0m[35m        # Check node is present[0m
[30;1m327 | [0m[35m        if name in self.alertentity_graph.nodes():[0m
[30;1m328 | [0m[35m            self.alertentity_graph.remove_node(name)[0m
[30;1m329 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m2035[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m320 | [0m[35m        Parameters[0m
[30;1m321 | [0m[35m        ----------[0m
[30;1m322 | [0m[35m        name : str[0m
[30;1m323 | [0m[35m            The name of the node to remove.[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        """[0m
[30;1m326 | [0m[35m        # Check node is present[0m

[31m--[ [0m[34mMatch #[0m[33m2036[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m    def remove_node(self, name: str):[0m
[30;1m317 | [0m[35m        """[0m
[30;1m318 | [0m[35m        Remove a node from the graph.[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        Parameters[0m
[30;1m321 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2037[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m294 | [0m[35m        source : str[0m
[30;1m295 | [0m[35m            Name of node to remove link from[0m
[30;1m296 | [0m[35m        target : str[0m
[30;1m297 | [0m[35m            name of node to remove link to[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m        Raises[0m
[30;1m300 | [0m[35m        ------[0m

[31m--[ [0m[34mMatch #[0m[33m2038[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m        Parameters[0m
[30;1m293 | [0m[35m        ----------[0m
[30;1m294 | [0m[35m        source : str[0m
[30;1m295 | [0m[35m            Name of node to remove link from[0m
[30;1m296 | [0m[35m        target : str[0m
[30;1m297 | [0m[35m            name of node to remove link to[0m
[30;1m298 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2039[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m        source : str[0m
[30;1m263 | [0m[35m            Name of node to link from[0m
[30;1m264 | [0m[35m        target : str[0m
[30;1m265 | [0m[35m            Name of node to link to[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m        Raises[0m
[30;1m268 | [0m[35m        ------[0m

[31m--[ [0m[34mMatch #[0m[33m2040[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m260 | [0m[35m        Parameters[0m
[30;1m261 | [0m[35m        ----------[0m
[30;1m262 | [0m[35m        source : str[0m
[30;1m263 | [0m[35m            Name of node to link from[0m
[30;1m264 | [0m[35m        target : str[0m
[30;1m265 | [0m[35m            Name of node to link to[0m
[30;1m266 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2041[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m        Parameters[0m
[30;1m232 | [0m[35m        ----------[0m
[30;1m233 | [0m[35m        name : str[0m
[30;1m234 | [0m[35m            The name of the node to add[0m
[30;1m235 | [0m[35m        description : Optional[str], optional[0m
[30;1m236 | [0m[35m            A description of the note, by default None[0m
[30;1m237 | [0m[35m        attached_to : Union[str, List], optional[0m

[31m--[ [0m[34mMatch #[0m[33m2042[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m226 | [0m[35m        attached_to: Union[str, List] = None,[0m
[30;1m227 | [0m[35m    ):[0m
[30;1m228 | [0m[35m        """[0m
[30;1m229 | [0m[35m        Add a node to the graph representing a note or comment.[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        Parameters[0m
[30;1m232 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2043[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m        ent : Entity[0m
[30;1m194 | [0m[35m            The entity object to add the graph[0m
[30;1m195 | [0m[35m        attached_to : str, optional[0m
[30;1m196 | [0m[35m            The name of the node to attach the entity to, by default None[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m        """[0m
[30;1m199 | [0m[35m        self._add_entity_node(ent, attached_to)[0m

[31m--[ [0m[34mMatch #[0m[33m2044[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        graph = self._plot_no_timeline(hide=True, **kwargs)[0m
[30;1m159 | [0m[35m        if tl_type == "duration":[0m
[30;1m160 | [0m[35m            # remove missing time values[0m
[30;1m161 | [0m[35m            timeline = display_timeline_duration([0m
[30;1m162 | [0m[35m                tl_df.dropna(subset=["StartTime", "EndTime"]),[0m
[30;1m163 | [0m[35m                group_by="Name",[0m

[31m--[ [0m[34mMatch #[0m[33m2045[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/entity_graph_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m        node_size : int, optional[0m
[30;1m91 | [0m[35m            Size of the nodes in pixels, by default 25[0m
[30;1m92 | [0m[35m        font_size : int, optional[0m
[30;1m93 | [0m[35m            Font size for node labels, by default 10[0m
[30;1m94 | [0m[35m            Can be an integer (point size) or a string (e.g. "10pt")[0m
[30;1m95 | [0m[35m        width : int, optional[0m
[30;1m96 | [0m[35m            Width in pixels, by default 800[0m

[31m--[ [0m[34mMatch #[0m[33m2046[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m61 | [0m[35m        for cmd in session:[0m
[30;1m62 | [0m[35m            seq1_counts[cmd] += 1[0m
[30;1m63 | [0m[35m            seq2_counts[prev][cmd] += 1[0m
[30;1m64 | [0m[35m            prev = cmd[0m
[30;1m65 | [0m[35m        seq2_counts[prev][end_token] += 1[0m
[30;1m66 | [0m[35m        seq1_counts[end_token] += 1[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2047[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m58 | [0m[35m    for session in sessions:[0m
[30;1m59 | [0m[35m        prev = start_token[0m
[30;1m60 | [0m[35m        seq1_counts[prev] += 1[0m
[30;1m61 | [0m[35m        for cmd in session:[0m
[30;1m62 | [0m[35m            seq1_counts[cmd] += 1[0m
[30;1m63 | [0m[35m            seq2_counts[prev][cmd] += 1[0m
[30;1m64 | [0m[35m            prev = cmd[0m

[31m--[ [0m[34mMatch #[0m[33m2048[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_only.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m    use_geo_mean: bool = False,[0m
[30;1m289 | [0m[35m) -> Tuple[List[str], float]:[0m
[30;1m290 | [0m[35m    """[0m
[30;1m291 | [0m[35m    Find and compute likelihood of the rarest window in the session.[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m    Parameters[0m
[30;1m294 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2049[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m            Sperator used in files in target folder, by default ",".[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        """[0m
[30;1m212 | [0m[35m        glob_pat = kwargs.get("glob", "*")[0m
[30;1m213 | [0m[35m        ext = glob_pat[0m
[30;1m214 | [0m[35m        t_name = bool(table_name)[0m
[30;1m215 | [0m[35m        input_files = Path(folder_path).glob(ext)[0m

[31m--[ [0m[34mMatch #[0m[33m2050[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m            Custom number of rows to batch.[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m        """[0m
[30;1m161 | [0m[35m        batch_size = kwargs.get("batch_size", 10000)  # Set a default batch size[0m
[30;1m162 | [0m[35m        events = [][0m
[30;1m163 | [0m[35m        for i, row in enumerate(data.iterrows()):[0m
[30;1m164 | [0m[35m            events.append(row[1].astype(str).to_dict())[0m

[31m--[ [0m[34mMatch #[0m[33m2051[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m            **mp_ua_header(),[0m
[30;1m128 | [0m[35m        }[0m
[30;1m129 | [0m[35m        try:[0m
[30;1m130 | [0m[35m            response = httpx.post([0m
[30;1m131 | [0m[35m                uri, content=body, headers=headers, timeout=self.get_http_timeout()[0m
[30;1m132 | [0m[35m            )[0m
[30;1m133 | [0m[35m        except httpx.ConnectError as req_err:[0m

[31m--[ [0m[34mMatch #[0m[33m2052[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        self.workspace = workspace[0m
[30;1m42 | [0m[35m        self.workspace_secret = workspace_secret[0m
[30;1m43 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m44 | [0m[35m        self.ops_loc = kwargs.get("opsinsight_loc", ".ods.opinsights.azure.com")[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def _build_signature([0m
[30;1m47 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m2053[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m        self._kwargs = kwargs[0m
[30;1m41 | [0m[35m        self.workspace = workspace[0m
[30;1m42 | [0m[35m        self.workspace_secret = workspace_secret[0m
[30;1m43 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m44 | [0m[35m        self.ops_loc = kwargs.get("opsinsight_loc", ".ods.opinsights.azure.com")[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def _build_signature([0m

[31m--[ [0m[34mMatch #[0m[33m2054[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/uploaders/loganalytics_uploader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""LogAnalytics Uploader class."""[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport datetime[0m
[30;1m9 | [0m[35mimport hashlib[0m
[30;1m10 | [0m[35mimport hmac[0m

[31m--[ [0m[34mMatch #[0m[33m2055[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m    os.environ["KQLMAGIC_LOAD_MODE"] = "silent"[0m
[30;1m765 | [0m[35m    # Kqlmagic config will use AZ CLI login if available[0m
[30;1m766 | [0m[35m    kql_config = os.environ.get("KQLMAGIC_CONFIGURATION", "")[0m
[30;1m767 | [0m[35m    if "try_azcli_login" not in kql_config:[0m
[30;1m768 | [0m[35m        kql_config = ";".join([kql_config, "try_azcli_login=True"])[0m
[30;1m769 | [0m[35m        os.environ["KQLMAGIC_CONFIGURATION"] = kql_config[0m

[31m--[ [0m[34mMatch #[0m[33m2056[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m704 | [0m[35m    # 7. Error - no Microsoft Sentinel config[0m
[30;1m705 | [0m[35m    if current_config_path() is not None:[0m
[30;1m706 | [0m[35m        return True[0m
[30;1m707 | [0m[35m    mp_path = os.environ.get("MSTICPYCONFIG")[0m
[30;1m708 | [0m[35m    if mp_path and not Path(mp_path).is_file():[0m
[30;1m709 | [0m[35m        _err_output(_MISSING_MPCONFIG_ENV_ERR)[0m
[30;1m710 | [0m[35m        logger.warning("MSTICPYCONFIG set to %s but no file found", mp_path)[0m

[31m--[ [0m[34mMatch #[0m[33m2057[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m604 | [0m[35m    """Return global values if found."""[0m
[30;1m605 | [0m[35m    py_ver = namespace.get(PY_VER_VAR, "3.8")[0m
[30;1m606 | [0m[35m    mp_ver = namespace.get(MP_VER_VAR, __version__)[0m
[30;1m607 | [0m[35m    extras = namespace.get(MP_EXTRAS)[0m
[30;1m608 | [0m[35m    return py_ver, mp_ver, extras[0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2058[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35mdef _get_aml_globals(namespace: Dict[str, Any]):[0m
[30;1m604 | [0m[35m    """Return global values if found."""[0m
[30;1m605 | [0m[35m    py_ver = namespace.get(PY_VER_VAR, "3.8")[0m
[30;1m606 | [0m[35m    mp_ver = namespace.get(MP_VER_VAR, __version__)[0m
[30;1m607 | [0m[35m    extras = namespace.get(MP_EXTRAS)[0m
[30;1m608 | [0m[35m    return py_ver, mp_ver, extras[0m
[30;1m609 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2059[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35mdef _get_aml_globals(namespace: Dict[str, Any]):[0m
[30;1m604 | [0m[35m    """Return global values if found."""[0m
[30;1m605 | [0m[35m    py_ver = namespace.get(PY_VER_VAR, "3.8")[0m
[30;1m606 | [0m[35m    mp_ver = namespace.get(MP_VER_VAR, __version__)[0m
[30;1m607 | [0m[35m    extras = namespace.get(MP_EXTRAS)[0m
[30;1m608 | [0m[35m    return py_ver, mp_ver, extras[0m

[31m--[ [0m[34mMatch #[0m[33m2060[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m    if imp_pkg:[0m
[30;1m589 | [0m[35m        pkg = imp_pkg.get("pkg")[0m
[30;1m590 | [0m[35m        tgt = imp_pkg.get("tgt")[0m
[30;1m591 | [0m[35m        alias = imp_pkg.get("alias")[0m
[30;1m592 | [0m[35m    import_item = f"{pkg}.{tgt}" if tgt else pkg[0m
[30;1m593 | [0m[35m    if alias:[0m
[30;1m594 | [0m[35m        import_item = f"{alias} ({import_item})"[0m

[31m--[ [0m[34mMatch #[0m[33m2061[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m587 | [0m[35m    """Return string representation of package import."""[0m
[30;1m588 | [0m[35m    if imp_pkg:[0m
[30;1m589 | [0m[35m        pkg = imp_pkg.get("pkg")[0m
[30;1m590 | [0m[35m        tgt = imp_pkg.get("tgt")[0m
[30;1m591 | [0m[35m        alias = imp_pkg.get("alias")[0m
[30;1m592 | [0m[35m    import_item = f"{pkg}.{tgt}" if tgt else pkg[0m
[30;1m593 | [0m[35m    if alias:[0m

[31m--[ [0m[34mMatch #[0m[33m2062[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m586 | [0m[35m) -> str:[0m
[30;1m587 | [0m[35m    """Return string representation of package import."""[0m
[30;1m588 | [0m[35m    if imp_pkg:[0m
[30;1m589 | [0m[35m        pkg = imp_pkg.get("pkg")[0m
[30;1m590 | [0m[35m        tgt = imp_pkg.get("tgt")[0m
[30;1m591 | [0m[35m        alias = imp_pkg.get("alias")[0m
[30;1m592 | [0m[35m    import_item = f"{pkg}.{tgt}" if tgt else pkg[0m

[31m--[ [0m[34mMatch #[0m[33m2063[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m556 | [0m[35m[0m
[30;1m557 | [0m[35mdef _detect_env(env_name: Literal["aml", "synapse"], **kwargs):[0m
[30;1m558 | [0m[35m    """Return true if an environment should be detected."""[0m
[30;1m559 | [0m[35m    detect_opt = kwargs.get("detect_env", True)[0m
[30;1m560 | [0m[35m    if isinstance(detect_opt, bool):[0m
[30;1m561 | [0m[35m        return detect_opt[0m
[30;1m562 | [0m[35m    return env_name in detect_opt if isinstance(detect_opt, list) else True[0m

[31m--[ [0m[34mMatch #[0m[33m2064[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m261 | [0m[35m        specification (e.g. "pandas>=0.25")[0m
[30;1m262 | [0m[35m    user_install : bool, optional[0m
[30;1m263 | [0m[35m        Install packages in the "user" rather than system site-packages.[0m
[30;1m264 | [0m[35m        Use this option if you cannot or do not want to update the system[0m
[30;1m265 | [0m[35m        packages.[0m
[30;1m266 | [0m[35m        You should usually avoid using this option with standard Conda environments.[0m
[30;1m267 | [0m[35m    extra_imports : List[str], optional[0m

[31m--[ [0m[34mMatch #[0m[33m2065[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m734 | [0m[35m        # pylint: enable=broad-except[0m
[30;1m735 | [0m[35m[0m
[30;1m736 | [0m[35m    _pr_output("Could not find msticpyconfig.yaml in standard search.")[0m
[30;1m737 | [0m[35m    logger.warning("Could not find msticpyconfig.yaml in standard search.")[0m
[30;1m738 | [0m[35m    if is_in_aml():[0m
[30;1m739 | [0m[35m        _pr_output([0m
[30;1m740 | [0m[35m            "AML environment detected.",[0m

[31m--[ [0m[34mMatch #[0m[33m2066[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m733 | [0m[35m            _pr_output("Please report this to msticpy@microsoft.com")[0m
[30;1m734 | [0m[35m        # pylint: enable=broad-except[0m
[30;1m735 | [0m[35m[0m
[30;1m736 | [0m[35m    _pr_output("Could not find msticpyconfig.yaml in standard search.")[0m
[30;1m737 | [0m[35m    logger.warning("Could not find msticpyconfig.yaml in standard search.")[0m
[30;1m738 | [0m[35m    if is_in_aml():[0m
[30;1m739 | [0m[35m        _pr_output([0m

[31m--[ [0m[34mMatch #[0m[33m2067[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m696 | [0m[35m    # Cases[0m
[30;1m697 | [0m[35m    # 0. Current config file exists -> return ok[0m
[30;1m698 | [0m[35m    # 1. Env var set and mpconfig exists -> goto 4[0m
[30;1m699 | [0m[35m    # 2. Env var set and mpconfig file not exists - warn and continue[0m
[30;1m700 | [0m[35m    # 3. search_for_file finds mpconfig -> goto 4[0m
[30;1m701 | [0m[35m    # 4. if file and check_file_contents -> return ok[0m
[30;1m702 | [0m[35m    # 5. search_for_file(config.json)[0m

[31m--[ [0m[34mMatch #[0m[33m2068[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m695 | [0m[35mdef _get_or_create_config() -> bool:[0m
[30;1m696 | [0m[35m    # Cases[0m
[30;1m697 | [0m[35m    # 0. Current config file exists -> return ok[0m
[30;1m698 | [0m[35m    # 1. Env var set and mpconfig exists -> goto 4[0m
[30;1m699 | [0m[35m    # 2. Env var set and mpconfig file not exists - warn and continue[0m
[30;1m700 | [0m[35m    # 3. search_for_file finds mpconfig -> goto 4[0m
[30;1m701 | [0m[35m    # 4. if file and check_file_contents -> return ok[0m

[31m--[ [0m[34mMatch #[0m[33m2069[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m        alias for `verbose`[0m
[30;1m292 | [0m[35m    config : Optional[str][0m
[30;1m293 | [0m[35m        Use this path to load a msticpyconfig.yaml.[0m
[30;1m294 | [0m[35m        Defaults are MSTICPYCONFIG env variable, home folder (~/.msticpy),[0m
[30;1m295 | [0m[35m        current working directory.[0m
[30;1m296 | [0m[35m    no_config_check : bool, optional[0m
[30;1m297 | [0m[35m        Skip the check for valid configuration. Default is False.[0m

[31m--[ [0m[34mMatch #[0m[33m2070[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m        - "msticpy" - import msticpy packages[0m
[30;1m256 | [0m[35m        - "none" (or any other value) don't load any default packages.[0m
[30;1m257 | [0m[35m    additional_packages : List[str], optional[0m
[30;1m258 | [0m[35m        Additional packages to be pip installed,[0m
[30;1m259 | [0m[35m        by default None.[0m
[30;1m260 | [0m[35m        Packages are specified by name only or version[0m
[30;1m261 | [0m[35m        specification (e.g. "pandas>=0.25")[0m

[31m--[ [0m[34mMatch #[0m[33m2071[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m490 | [0m[35m[0m
[30;1m491 | [0m[35m    """[0m
[30;1m492 | [0m[35m    data = _get_parsed_token_data(token)[0m
[30;1m493 | [0m[35m    return data.get("oid")[0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35mdef _get_parsed_token_data(token) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m2072[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m406 | [0m[35m        """[0m
[30;1m407 | [0m[35m        mgmt = KeyVaultManagementClient(self.auth_client.modern, self.subscription_id)[0m
[30;1m408 | [0m[35m        try:[0m
[30;1m409 | [0m[35m            vault = mgmt.vaults.get(self.resource_group, vault_name)[0m
[30;1m410 | [0m[35m        except ResourceNotFoundError as cloud_err:[0m
[30;1m411 | [0m[35m            raise MsticpyKeyVaultConfigError([0m
[30;1m412 | [0m[35m                "Check that you have specified the right value for VaultName"[0m

[31m--[ [0m[34mMatch #[0m[33m2073[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m        self.auth_client = az_connect_core()[0m
[30;1m374 | [0m[35m        self.resource_group = resource_group or self.settings.get("resourcegroup")[0m
[30;1m375 | [0m[35m        self.azure_region = azure_region or self.settings.get("azureregion")[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    def list_vaults(self) -> List[str]:[0m
[30;1m378 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2074[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m            )[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m        self.auth_client = az_connect_core()[0m
[30;1m374 | [0m[35m        self.resource_group = resource_group or self.settings.get("resourcegroup")[0m
[30;1m375 | [0m[35m        self.azure_region = azure_region or self.settings.get("azureregion")[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    def list_vaults(self) -> List[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m2075[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m                "Please add this to the KeyVault section of msticpyconfig.yaml",[0m
[30;1m354 | [0m[35m                title="missing tenant ID value.",[0m
[30;1m355 | [0m[35m            )[0m
[30;1m356 | [0m[35m        self.subscription_id = subscription_id or self.settings.get("subscriptionid")[0m
[30;1m357 | [0m[35m        if not self.subscription_id:[0m
[30;1m358 | [0m[35m            raise MsticpyKeyVaultConfigError([0m
[30;1m359 | [0m[35m                "Could not get SubscriptionId from function parameters or configuration.",[0m

[31m--[ [0m[34mMatch #[0m[33m2076[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m346 | [0m[35m        """[0m
[30;1m347 | [0m[35m        self.debug = kwargs.pop("debug", False)[0m
[30;1m348 | [0m[35m        self.settings: KeyVaultSettings = settings or KeyVaultSettings()[0m
[30;1m349 | [0m[35m        self.tenant_id = tenant_id or self.settings.get("tenantid")[0m
[30;1m350 | [0m[35m        if not self.tenant_id:[0m
[30;1m351 | [0m[35m            raise MsticpyKeyVaultConfigError([0m
[30;1m352 | [0m[35m                "Could not get TenantId from function parameters or configuration.",[0m

[31m--[ [0m[34mMatch #[0m[33m2077[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        if "authority" in kwargs:[0m
[30;1m149 | [0m[35m            self.settings["authority"] = kwargs.pop("authority")[0m
[30;1m150 | [0m[35m        self.authority_uri = self.settings.get_tenant_authority_host([0m
[30;1m151 | [0m[35m            authority_uri=kwargs.get("authority_uri"), tenant=self.tenant_id[0m
[30;1m152 | [0m[35m        )[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m        self._vault_name, self.vault_uri = self._get_vault_name_and_uri([0m

[31m--[ [0m[34mMatch #[0m[33m2078[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m            "authn_type", self.settings.get("authntype", "interactive")[0m
[30;1m141 | [0m[35m        )[0m
[30;1m142 | [0m[35m        self.auth_methods = kwargs.pop([0m
[30;1m143 | [0m[35m            "auth_methods", self.settings.get("auth_methods", ["interactive"])[0m
[30;1m144 | [0m[35m        )[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m        # for authority and authority_uri, any parameters take priority[0m

[31m--[ [0m[34mMatch #[0m[33m2079[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m                azcli_uri="https://docs.microsoft.com/cli/azure/authenticate-azure-cli",[0m
[30;1m138 | [0m[35m            )[0m
[30;1m139 | [0m[35m        self.authn_type = kwargs.pop([0m
[30;1m140 | [0m[35m            "authn_type", self.settings.get("authntype", "interactive")[0m
[30;1m141 | [0m[35m        )[0m
[30;1m142 | [0m[35m        self.auth_methods = kwargs.pop([0m
[30;1m143 | [0m[35m            "auth_methods", self.settings.get("auth_methods", ["interactive"])[0m

[31m--[ [0m[34mMatch #[0m[33m2080[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m        self.debug = kwargs.pop("debug", False)[0m
[30;1m129 | [0m[35m        self.settings: KeyVaultSettings = settings or KeyVaultSettings()[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        self.tenant_id = tenant_id or self.settings.get("tenantid")[0m
[30;1m132 | [0m[35m        if not self.tenant_id:[0m
[30;1m133 | [0m[35m            raise MsticpyKeyVaultConfigError([0m
[30;1m134 | [0m[35m                "Could not get TenantId from function parameters or configuration.",[0m

[31m--[ [0m[34mMatch #[0m[33m2081[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m    def create_vault(self, vault_name: str) -> Vault:[0m
[30;1m420 | [0m[35m        """[0m
[30;1m421 | [0m[35m        Create new or update existing vault.[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35m        Parameters[0m
[30;1m424 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2082[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m45 | [0m[35m        "1. Add 'cli' to the list of authentication methods in Azure/auth_methods"[0m
[30;1m46 | [0m[35m        " in msticpyconfig.yaml "[0m
[30;1m47 | [0m[35m    ),[0m
[30;1m48 | [0m[35m    "2. run 'az login` at the start of your session.",[0m
[30;1m49 | [0m[35m    "3. Re-run the MSTICPy function that failed with this error.",[0m
[30;1m50 | [0m[35m    "",[0m
[30;1m51 | [0m[35m][0m

[31m--[ [0m[34mMatch #[0m[33m2083[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m            Possible values are:[0m
[30;1m87 | [0m[35m            - "env" - to get authentication details from environment variables[0m
[30;1m88 | [0m[35m            - "cli" - to use Azure CLI authentication details[0m
[30;1m89 | [0m[35m            - "msi" - to user Managed Service Identity details[0m
[30;1m90 | [0m[35m            - "interactive" - to prompt for interactive login[0m
[30;1m91 | [0m[35m            - "vscode" - to use VSCode credentials[0m
[30;1m92 | [0m[35m            - "powershell" - to use PowerShell credentials[0m

[31m--[ [0m[34mMatch #[0m[33m2084[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m        Parameters[0m
[30;1m72 | [0m[35m        ----------[0m
[30;1m73 | [0m[35m        tenant_id : str[0m
[30;1m74 | [0m[35m            The tenant ID of the service[0m
[30;1m75 | [0m[35m        vault_uri : str, optional[0m
[30;1m76 | [0m[35m            The full URI of the keyvault, by default None[0m
[30;1m77 | [0m[35m        vault_name : str, optional[0m

[31m--[ [0m[34mMatch #[0m[33m2085[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""Keyvault client - adapted from Bluehound code."""[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mfrom typing import Any, List[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2086[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    defaults = data_map.get("defaults", {})[0m
[30;1m86 | [0m[35m    sources = data_map.get("sources", {})[0m
[30;1m87 | [0m[35m    metadata = data_map.get("metadata", {})[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    logger.info("Read %s queries from %s", len(sources), query_file)[0m
[30;1m90 | [0m[35m    return sources, defaults, metadata[0m

[31m--[ [0m[34mMatch #[0m[33m2087[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        raise[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    defaults = data_map.get("defaults", {})[0m
[30;1m86 | [0m[35m    sources = data_map.get("sources", {})[0m
[30;1m87 | [0m[35m    metadata = data_map.get("metadata", {})[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    logger.info("Read %s queries from %s", len(sources), query_file)[0m

[31m--[ [0m[34mMatch #[0m[33m2088[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        )[0m
[30;1m83 | [0m[35m        raise[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    defaults = data_map.get("defaults", {})[0m
[30;1m86 | [0m[35m    sources = data_map.get("sources", {})[0m
[30;1m87 | [0m[35m    metadata = data_map.get("metadata", {})[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2089[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_query_reader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m119 | [0m[35m    if "metadata" not in query_def_dict or not query_def_dict["metadata"]:[0m
[30;1m120 | [0m[35m        raise ValueError("Imported file has no metadata defined")[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    # data_environments and data_families must be defined at with at least[0m
[30;1m123 | [0m[35m    # one value[0m
[30;1m124 | [0m[35m    _validate_data_categories(query_def_dict)[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2090[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_query_reader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m119 | [0m[35m    if "metadata" not in query_def_dict or not query_def_dict["metadata"]:[0m
[30;1m120 | [0m[35m        raise ValueError("Imported file has no metadata defined")[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    # data_environments and data_families must be defined at with at least[0m
[30;1m123 | [0m[35m    # one value[0m
[30;1m124 | [0m[35m    _validate_data_categories(query_def_dict)[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2091[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m81 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m82 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m
[30;1m83 | [0m[35m        self.RiskLevel = src_event.get("RiskLevel")[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    @property[0m
[30;1m86 | [0m[35m    def description_str(self):[0m

[31m--[ [0m[34mMatch #[0m[33m2092[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        self.MailboxPrimaryAddress = src_event.get("MailboxPrimaryAddress")[0m
[30;1m80 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m81 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m82 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m
[30;1m83 | [0m[35m        self.RiskLevel = src_event.get("RiskLevel")[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m2093[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m79 | [0m[35m        self.MailboxPrimaryAddress = src_event.get("MailboxPrimaryAddress")[0m
[30;1m80 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m81 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m82 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m
[30;1m83 | [0m[35m        self.RiskLevel = src_event.get("RiskLevel")[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2094[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m79 | [0m[35m        self.MailboxPrimaryAddress = src_event.get("MailboxPrimaryAddress")[0m
[30;1m80 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m81 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m82 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m
[30;1m83 | [0m[35m        self.RiskLevel = src_event.get("RiskLevel")[0m

[31m--[ [0m[34mMatch #[0m[33m2095[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mailbox.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m            self._create_from_event(src_event)[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m79 | [0m[35m        self.MailboxPrimaryAddress = src_event.get("MailboxPrimaryAddress")[0m
[30;1m80 | [0m[35m        self.Upn = src_event.get("Upn")[0m
[30;1m81 | [0m[35m        self.DisplayName = src_event.get("DisplayName")[0m
[30;1m82 | [0m[35m        self.ExternalDirectoryObjectId = src_event.get("ExternalDirectoryObjectId")[0m

[31m--[ [0m[34mMatch #[0m[33m2096[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/auditdextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m    # if the field requires conversion conv will specify the[0m
[30;1m235 | [0m[35m    # target type - only int currently[0m
[30;1m236 | [0m[35m    for fieldname, conv in _FIELD_DEFS[mssg_type].items():[0m
[30;1m237 | [0m[35m        value = message_dict[mssg_type].get(fieldname, None)[0m
[30;1m238 | [0m[35m        if not value:[0m
[30;1m239 | [0m[35m            return[0m
[30;1m240 | [0m[35m        if conv and conv == "int":[0m

[31m--[ [0m[34mMatch #[0m[33m2097[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/auditdextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m            if mssg_type == "EXECVE":[0m
[30;1m197 | [0m[35m                args = int(proc_create_dict.get("argc", 1))[0m
[30;1m198 | [0m[35m                arg_strs = [[0m
[30;1m199 | [0m[35m                    proc_create_dict.get(f"a{arg_idx}", "") for arg_idx in range(args)[0m
[30;1m200 | [0m[35m                ][0m
[30;1m201 | [0m[35m                proc_create_dict["cmdline"] = " ".join(arg_strs)[0m
[30;1m202 | [0m[35m        return "SYSCALL_EXECVE", proc_create_dict[0m

[31m--[ [0m[34mMatch #[0m[33m2098[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/auditdextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m            _extract_mssg_value(mssg_type, message_dict, proc_create_dict)[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m            if mssg_type == "EXECVE":[0m
[30;1m197 | [0m[35m                args = int(proc_create_dict.get("argc", 1))[0m
[30;1m198 | [0m[35m                arg_strs = [[0m
[30;1m199 | [0m[35m                    proc_create_dict.get(f"a{arg_idx}", "") for arg_idx in range(args)[0m
[30;1m200 | [0m[35m                ][0m

[31m--[ [0m[34mMatch #[0m[33m2099[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/auditdextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m            rec_dict: Dict[str, Optional[str]] = {}[0m
[30;1m133 | [0m[35m            # Get our field mapping for encoded params for this[0m
[30;1m134 | [0m[35m            # mssg_type (rec_key)[0m
[30;1m135 | [0m[35m            encoded_fields_map = _ENCODED_PARAMS.get(rec_key, None)[0m
[30;1m136 | [0m[35m            for rec_item in rec_val:[0m
[30;1m137 | [0m[35m                # for each mssg item, split into k/v pair[0m
[30;1m138 | [0m[35m                rec_split = rec_item.split("=", maxsplit=1)[0m

[31m--[ [0m[34mMatch #[0m[33m2100[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/auditdextract.py[0m
   Pattern: [32m.hostname[0m
[30;1m55 | [0m[35m    "msg": None,[0m
[30;1m56 | [0m[35m    "acct": None,[0m
[30;1m57 | [0m[35m    "exe": None,[0m
[30;1m58 | [0m[35m    "hostname": None,[0m
[30;1m59 | [0m[35m    "addr": None,[0m
[30;1m60 | [0m[35m    "terminal": None,[0m
[30;1m61 | [0m[35m    "res": None,[0m

[31m--[ [0m[34mMatch #[0m[33m2101[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/auditdextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m491 | [0m[35m    Returns[0m
[30;1m492 | [0m[35m    -------[0m
[30;1m493 | [0m[35m    str[0m
[30;1m494 | [0m[35m        The extracted message time string[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m    """[0m
[30;1m497 | [0m[35m    audit_message = audit_str.rstrip().split(": ")[0m

[31m--[ [0m[34mMatch #[0m[33m2102[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m472 | [0m[35mdef _debug_flag(*args: str, **kwargs: str) -> bool:[0m
[30;1m473 | [0m[35m    """Return True if debug/print args passed."""[0m
[30;1m474 | [0m[35m    return any(db_arg for db_arg in _DEBUG_FLAGS if db_arg in args) or any([0m
[30;1m475 | [0m[35m        db_arg for db_arg in _DEBUG_FLAGS if kwargs.get(db_arg, False)[0m
[30;1m476 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m2103[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m            }[0m
[30;1m438 | [0m[35m        query_options["time_span"] = {[0m
[30;1m439 | [0m[35m            "start": params.get("start"),[0m
[30;1m440 | [0m[35m            "end": params.get("end"),[0m
[30;1m441 | [0m[35m        }[0m
[30;1m442 | [0m[35m        return query_options[0m
[30;1m443 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2104[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m436 | [0m[35m                key: val for key, val in kwargs.items() if key not in params[0m
[30;1m437 | [0m[35m            }[0m
[30;1m438 | [0m[35m        query_options["time_span"] = {[0m
[30;1m439 | [0m[35m            "start": params.get("start"),[0m
[30;1m440 | [0m[35m            "end": params.get("end"),[0m
[30;1m441 | [0m[35m        }[0m
[30;1m442 | [0m[35m        return query_options[0m

[31m--[ [0m[34mMatch #[0m[33m2105[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m413 | [0m[35m                query=query["query"],[0m
[30;1m414 | [0m[35m                query_paths=query.get([0m
[30;1m415 | [0m[35m                    "query_paths",[0m
[30;1m416 | [0m[35m                    query.get("query_container", "default"),[0m
[30;1m417 | [0m[35m                ),[0m
[30;1m418 | [0m[35m                description=query["description"],[0m
[30;1m419 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m2106[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m411 | [0m[35m            self.query_store.add_query([0m
[30;1m412 | [0m[35m                name=query["name"],[0m
[30;1m413 | [0m[35m                query=query["query"],[0m
[30;1m414 | [0m[35m                query_paths=query.get([0m
[30;1m415 | [0m[35m                    "query_paths",[0m
[30;1m416 | [0m[35m                    query.get("query_container", "default"),[0m
[30;1m417 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m2107[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m                str(qry_path) for qry_path in builtin_qry_paths if qry_path.is_dir()[0m
[30;1m356 | [0m[35m            )[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m        for custom_path in settings.get("Custom", {}):[0m
[30;1m359 | [0m[35m            custom_qry_path: str | None = _resolve_path(custom_path)[0m
[30;1m360 | [0m[35m            if custom_qry_path:[0m
[30;1m361 | [0m[35m                all_query_paths.append(custom_qry_path)[0m

[31m--[ [0m[34mMatch #[0m[33m2108[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m        """Fetch queries from YAML files in specified paths."""[0m
[30;1m346 | [0m[35m        settings: dict[str, Any] = get_config("QueryDefinitions", {})[0m
[30;1m347 | [0m[35m        all_query_paths: list[Path | str] = [][0m
[30;1m348 | [0m[35m        for def_qry_path in settings.get("Default", []):[0m
[30;1m349 | [0m[35m            # only read queries from environment folder[0m
[30;1m350 | [0m[35m            builtin_qry_paths: list[Path] = self._get_query_folder_for_env([0m
[30;1m351 | [0m[35m                def_qry_path,[0m

[31m--[ [0m[34mMatch #[0m[33m2109[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m            data_env_queries.update([0m
[30;1m143 | [0m[35m                self._read_queries_from_paths(query_paths=query_paths),[0m
[30;1m144 | [0m[35m            )[0m
[30;1m145 | [0m[35m        self.query_store: QueryStore = data_env_queries.get([0m
[30;1m146 | [0m[35m            self.environment_name,[0m
[30;1m147 | [0m[35m            QueryStore(self.environment_name),[0m
[30;1m148 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2110[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    @property[0m
[30;1m233 | [0m[35m    def query_time(self: Self) -> QueryTime:[0m
[30;1m234 | [0m[35m        """Return the default QueryTime control for queries."""[0m
[30;1m235 | [0m[35m        return self._query_time[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    def _execute_query([0m

[31m--[ [0m[34mMatch #[0m[33m2111[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m94 | [0m[35m        DataProviderBase : base class for data query providers.[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        """[0m
[30;1m97 | [0m[35m        # import at runtime to prevent circular import[0m
[30;1m98 | [0m[35m        # pylint: disable=import-outside-toplevel, cyclic-import[0m
[30;1m99 | [0m[35m        from ...init.pivot_init.pivot_data_queries import add_data_queries_to_entities[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2112[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m312 | [0m[35m        params: dict[str, Any],[0m
[30;1m313 | [0m[35m        missing: list[str],[0m
[30;1m314 | [0m[35m    ) -> bool:[0m
[30;1m315 | [0m[35m        """Fall back on builtin query time if no time parameters were supplied."""[0m
[30;1m316 | [0m[35m        defaults_added = False[0m
[30;1m317 | [0m[35m        if "start" in missing:[0m
[30;1m318 | [0m[35m            missing.remove("start")[0m

[31m--[ [0m[34mMatch #[0m[33m2113[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m312 | [0m[35m        params: dict[str, Any],[0m
[30;1m313 | [0m[35m        missing: list[str],[0m
[30;1m314 | [0m[35m    ) -> bool:[0m
[30;1m315 | [0m[35m        """Fall back on builtin query time if no time parameters were supplied."""[0m
[30;1m316 | [0m[35m        defaults_added = False[0m
[30;1m317 | [0m[35m        if "start" in missing:[0m
[30;1m318 | [0m[35m            missing.remove("start")[0m

[31m--[ [0m[34mMatch #[0m[33m2114[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/data_providers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m                driver = self.driver_class(data_environment=data_environment, **kwargs)[0m
[30;1m115 | [0m[35m            else:[0m
[30;1m116 | [0m[35m                err_msg: str = ([0m
[30;1m117 | [0m[35m                    f"Could not find suitable data provider for {data_environment}"[0m
[30;1m118 | [0m[35m                )[0m
[30;1m119 | [0m[35m                raise LookupError(err_msg)[0m
[30;1m120 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m2115[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/param_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m                if param in arg_object.query_params:[0m
[30;1m98 | [0m[35m                    req_params[param] = arg_object.query_params[param][0m
[30;1m99 | [0m[35m            elif isinstance(arg_object, dict) and param in arg_object:[0m
[30;1m100 | [0m[35m                req_params[param] = arg_object.get(param, None)[0m
[30;1m101 | [0m[35m            elif hasattr(arg_object, param):[0m
[30;1m102 | [0m[35m                req_params[param] = getattr(arg_object, param)[0m
[30;1m103 | [0m[35m        remaining_params = [[0m

[31m--[ [0m[34mMatch #[0m[33m2116[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/param_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    # required_params are those that don't have defaults set in the query[0m
[30;1m49 | [0m[35m    # template. Build a dictionary to hold the values. This will contain[0m
[30;1m50 | [0m[35m    # at least the required params plus any that are extracted from args and[0m
[30;1m51 | [0m[35m    # kwargs and have been added dynamically.[0m
[30;1m52 | [0m[35m    req_param_names = query_source.required_params.keys()[0m
[30;1m53 | [0m[35m    req_params: Dict[str, Any] = {param: None for param in req_param_names}[0m

[31m--[ [0m[34mMatch #[0m[33m2117[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/param_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m        )[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    # Get the names of any params that were required but we didn't[0m
[30;1m67 | [0m[35m    # find a value for[0m
[30;1m68 | [0m[35m    missing_params = [[0m
[30;1m69 | [0m[35m        p_name for p_name, p_value in req_params.items() if p_value is None[0m
[30;1m70 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m2118[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/ip_address.py[0m
   Pattern: [32m.hostname[0m
[30;1m69 | [0m[35m        self.Address: str = ""[0m
[30;1m70 | [0m[35m        self.Location: GeoLocation | None = None[0m
[30;1m71 | [0m[35m        self.ThreatIntelligence: list[Threatintelligence] = [][0m
[30;1m72 | [0m[35m        self.hostname: str | None = None[0m
[30;1m73 | [0m[35m        self.SourceComputerId: str | None = None[0m
[30;1m74 | [0m[35m        self.OSType: str | None = None[0m
[30;1m75 | [0m[35m        self.OSName: str | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m2119[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    @property[0m
[30;1m93 | [0m[35m    def ip_address(self) -> IPv4Address | IPv6Address | None:[0m
[30;1m94 | [0m[35m        """Return a python IP address object from the entity property."""[0m
[30;1m95 | [0m[35m        try:[0m
[30;1m96 | [0m[35m            return ip_address(self.Address)[0m
[30;1m97 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m2120[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/proc_tree_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35mdef _add_tree_properties(proc_tree):[0m
[30;1m128 | [0m[35m    """Add root, branch, leaf properties and set proc_key as index."""[0m
[30;1m129 | [0m[35m    proc_tree = proc_tree.copy()[0m
[30;1m130 | [0m[35m    # Create labels based on node type[0m
[30;1m131 | [0m[35m    ppids = proc_tree[[Col.parent_key]].set_index(Col.parent_key)[0m
[30;1m132 | [0m[35m    proc_tree = proc_tree.assign(IsRoot=False, IsLeaf=False, IsBranch=False)[0m
[30;1m133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2121[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m622 | [0m[35m            64: IoCType.sha256_hash,[0m
[30;1m623 | [0m[35m        }[0m
[30;1m624 | [0m[35m        hashsize = len(file_hash.strip())[0m
[30;1m625 | [0m[35m        return hashsize_map.get(hashsize, IoCType.unknown)[0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m    def get_ioc_type(self, observable: str) -> str:[0m
[30;1m628 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2122[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m511 | [0m[35m        include_paths = kwargs.get("include_paths", False)[0m
[30;1m512 | [0m[35m        ignore_tld_current = self._ignore_tld[0m
[30;1m513 | [0m[35m        self._ignore_tld = kwargs.get("ignore_tlds", False)[0m
[30;1m514 | [0m[35m        defanged = kwargs.get("defanged", self._defanged)[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        ioc_types_to_use = self._get_ioc_types_to_use(ioc_types, include_paths)[0m
[30;1m517 | [0m[35m        if isinstance(columns, str):[0m

[31m--[ [0m[34mMatch #[0m[33m2123[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m        ioc_types = kwargs.get("ioc_types")[0m
[30;1m511 | [0m[35m        include_paths = kwargs.get("include_paths", False)[0m
[30;1m512 | [0m[35m        ignore_tld_current = self._ignore_tld[0m
[30;1m513 | [0m[35m        self._ignore_tld = kwargs.get("ignore_tlds", False)[0m
[30;1m514 | [0m[35m        defanged = kwargs.get("defanged", self._defanged)[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        ioc_types_to_use = self._get_ioc_types_to_use(ioc_types, include_paths)[0m

[31m--[ [0m[34mMatch #[0m[33m2124[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m        """[0m
[30;1m509 | [0m[35m        check_kwargs(kwargs, ["ioc_types", "include_paths", "ignore_tlds", "defanged"])[0m
[30;1m510 | [0m[35m        ioc_types = kwargs.get("ioc_types")[0m
[30;1m511 | [0m[35m        include_paths = kwargs.get("include_paths", False)[0m
[30;1m512 | [0m[35m        ignore_tld_current = self._ignore_tld[0m
[30;1m513 | [0m[35m        self._ignore_tld = kwargs.get("ignore_tlds", False)[0m
[30;1m514 | [0m[35m        defanged = kwargs.get("defanged", self._defanged)[0m

[31m--[ [0m[34mMatch #[0m[33m2125[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m        """[0m
[30;1m509 | [0m[35m        check_kwargs(kwargs, ["ioc_types", "include_paths", "ignore_tlds", "defanged"])[0m
[30;1m510 | [0m[35m        ioc_types = kwargs.get("ioc_types")[0m
[30;1m511 | [0m[35m        include_paths = kwargs.get("include_paths", False)[0m
[30;1m512 | [0m[35m        ignore_tld_current = self._ignore_tld[0m
[30;1m513 | [0m[35m        self._ignore_tld = kwargs.get("ignore_tlds", False)[0m

[31m--[ [0m[34mMatch #[0m[33m2126[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m        include_paths = kwargs.get("include_paths", False)[0m
[30;1m401 | [0m[35m        ignore_tld_current = self._ignore_tld[0m
[30;1m402 | [0m[35m        self._ignore_tld = kwargs.get("ignore_tlds", False)[0m
[30;1m403 | [0m[35m        defanged = kwargs.get("defanged", self._defanged)[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m        if src and src.strip():[0m
[30;1m406 | [0m[35m            return self._scan_for_iocs(src=src, ioc_types=ioc_types, defanged=defanged)[0m

[31m--[ [0m[34mMatch #[0m[33m2127[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m        ioc_types = kwargs.get("ioc_types")[0m
[30;1m400 | [0m[35m        include_paths = kwargs.get("include_paths", False)[0m
[30;1m401 | [0m[35m        ignore_tld_current = self._ignore_tld[0m
[30;1m402 | [0m[35m        self._ignore_tld = kwargs.get("ignore_tlds", False)[0m
[30;1m403 | [0m[35m        defanged = kwargs.get("defanged", self._defanged)[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m        if src and src.strip():[0m

[31m--[ [0m[34mMatch #[0m[33m2128[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m        """[0m
[30;1m398 | [0m[35m        check_kwargs(kwargs, ["ioc_types", "include_paths", "ignore_tlds", "defanged"])[0m
[30;1m399 | [0m[35m        ioc_types = kwargs.get("ioc_types")[0m
[30;1m400 | [0m[35m        include_paths = kwargs.get("include_paths", False)[0m
[30;1m401 | [0m[35m        ignore_tld_current = self._ignore_tld[0m
[30;1m402 | [0m[35m        self._ignore_tld = kwargs.get("ignore_tlds", False)[0m
[30;1m403 | [0m[35m        defanged = kwargs.get("defanged", self._defanged)[0m

[31m--[ [0m[34mMatch #[0m[33m2129[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        """[0m
[30;1m398 | [0m[35m        check_kwargs(kwargs, ["ioc_types", "include_paths", "ignore_tlds", "defanged"])[0m
[30;1m399 | [0m[35m        ioc_types = kwargs.get("ioc_types")[0m
[30;1m400 | [0m[35m        include_paths = kwargs.get("include_paths", False)[0m
[30;1m401 | [0m[35m        ignore_tld_current = self._ignore_tld[0m
[30;1m402 | [0m[35m        self._ignore_tld = kwargs.get("ignore_tlds", False)[0m

[31m--[ [0m[34mMatch #[0m[33m2130[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m.hostname[0m
[30;1m581 | [0m[35m        self._ignore_tld = ignore_tlds[0m
[30;1m582 | [0m[35m        if ioc_type == IoCType.file_hash.name:[0m
[30;1m583 | [0m[35m            val_type = self.file_hash_type(input_str).name[0m
[30;1m584 | [0m[35m        elif ioc_type == IoCType.hostname.name:[0m
[30;1m585 | [0m[35m            val_type = "dns"[0m
[30;1m586 | [0m[35m        else:[0m
[30;1m587 | [0m[35m            val_type = ioc_type[0m

[31m--[ [0m[34mMatch #[0m[33m2131[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m.hostname[0m
[30;1m77 | [0m[35m    email = "email"[0m
[30;1m78 | [0m[35m    windows_path = "windows_path"[0m
[30;1m79 | [0m[35m    linux_path = "linux_path"[0m
[30;1m80 | [0m[35m    hostname = "hostname"[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    # pylint: enable=invalid-name[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2132[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m.hostname[0m
[30;1m77 | [0m[35m    email = "email"[0m
[30;1m78 | [0m[35m    windows_path = "windows_path"[0m
[30;1m79 | [0m[35m    linux_path = "linux_path"[0m
[30;1m80 | [0m[35m    hostname = "hostname"[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    # pylint: enable=invalid-name[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2133[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m19 | [0m[35m-  Windows file paths[0m
[30;1m20 | [0m[35m-  Linux file paths (this is kind of noisy because a legal linux file[0m
[30;1m21 | [0m[35m   path can have almost any character) You can modify or add to the[0m
[30;1m22 | [0m[35m   regular expressions used at runtime.[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m"""[0m
[30;1m25 | [0m[35mfrom __future__ import annotations[0m

[31m--[ [0m[34mMatch #[0m[33m2134[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m564 | [0m[35m        ioc_type : str[0m
[30;1m565 | [0m[35m            the regex pattern to use[0m
[30;1m566 | [0m[35m        ignore_tlds : bool, optional[0m
[30;1m567 | [0m[35m            If True, ignore the official Top Level Domains[0m
[30;1m568 | [0m[35m            list when determining whether a domain name is[0m
[30;1m569 | [0m[35m            a legal domain.[0m
[30;1m570 | [0m[35m        defanged : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m2135[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m481 | [0m[35m            a legal domain.[0m
[30;1m482 | [0m[35m        defanged : bool, optional[0m
[30;1m483 | [0m[35m            If True will match defanged versions of from email, dns,[0m
[30;1m484 | [0m[35m            url and ip entities.[0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m        Returns[0m
[30;1m487 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m2136[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m476 | [0m[35m            and 'linux_path'). If `ioc_types` is specified[0m
[30;1m477 | [0m[35m            this parameter is ignored.[0m
[30;1m478 | [0m[35m        ignore_tlds : bool, optional[0m
[30;1m479 | [0m[35m            If True, ignore the official Top Level Domains[0m
[30;1m480 | [0m[35m            list when determining whether a domain name is[0m
[30;1m481 | [0m[35m            a legal domain.[0m
[30;1m482 | [0m[35m        defanged : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m2137[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m367 | [0m[35m            a legal domain.[0m
[30;1m368 | [0m[35m        defanged : bool, optional[0m
[30;1m369 | [0m[35m            If True will match defanged versions of from email, dns,[0m
[30;1m370 | [0m[35m            url and ip entities.[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m        Returns[0m
[30;1m373 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m2138[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m362 | [0m[35m            and 'linux_path'). If `ioc_types` is specified[0m
[30;1m363 | [0m[35m            this parameter is ignored.[0m
[30;1m364 | [0m[35m        ignore_tlds : bool, optional[0m
[30;1m365 | [0m[35m            If True, ignore the official Top Level Domains[0m
[30;1m366 | [0m[35m            list when determining whether a domain name is[0m
[30;1m367 | [0m[35m            a legal domain.[0m
[30;1m368 | [0m[35m        defanged : bool, optional[0m

[31m--[ [0m[34mMatch #[0m[33m2139[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m        # Dns Domains[0m
[30;1m216 | [0m[35m        # This also matches IP addresses but IPs have higher[0m
[30;1m217 | [0m[35m        # priority both matching on the same substring will defer[0m
[30;1m218 | [0m[35m        # to the IP regex[0m
[30;1m219 | [0m[35m        self.add_ioc_type(IoCType.dns.name, self.DNS_REGEX, 2, defang_pattern=False)[0m
[30;1m220 | [0m[35m        self.add_ioc_type(IoCType.dns.name, self.DNS_DF_REGEX, 2, defang_pattern=True)[0m
[30;1m221 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2140[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m        self.add_ioc_type(IoCType.ipv6.name, self.IPV6_REGEX, 0)[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        # Dns Domains[0m
[30;1m216 | [0m[35m        # This also matches IP addresses but IPs have higher[0m
[30;1m217 | [0m[35m        # priority both matching on the same substring will defer[0m
[30;1m218 | [0m[35m        # to the IP regex[0m
[30;1m219 | [0m[35m        self.add_ioc_type(IoCType.dns.name, self.DNS_REGEX, 2, defang_pattern=False)[0m

[31m--[ [0m[34mMatch #[0m[33m2141[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/iocextract.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m            If True, the regex will be used to match defanged IoC patterns[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        """[0m
[30;1m202 | [0m[35m        # IP Addresses[0m
[30;1m203 | [0m[35m        self.add_ioc_type([0m
[30;1m204 | [0m[35m            IoCType.ipv4.name, self.IPV4_REGEX, 0, "ipaddress", defang_pattern=False[0m
[30;1m205 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2142[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/data_structures.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    def __init__(self, name: str, params: Union[set, dict]):[0m
[30;1m80 | [0m[35m        """[0m
[30;1m81 | [0m[35m        Instantiate the Cmd class.[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        Parameters[0m
[30;1m84 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2143[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m        col_type = col_map.get(col_name, "str")  # type: ignore[0m
[30;1m440 | [0m[35m        if not silent:[0m
[30;1m441 | [0m[35m            print(col_name, end=", ")[0m
[30;1m442 | [0m[35m        map_func = MAP_FUNCS.get(col_type)[0m
[30;1m443 | [0m[35m        try:[0m
[30;1m444 | [0m[35m            if map_func == "null":[0m
[30;1m445 | [0m[35m                data[col_name] = None[0m

[31m--[ [0m[34mMatch #[0m[33m2144[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m436 | [0m[35m    for col_name in data.columns:[0m
[30;1m437 | [0m[35m        if col_name not in col_map:[0m
[30;1m438 | [0m[35m            continue[0m
[30;1m439 | [0m[35m        col_type = col_map.get(col_name, "str")  # type: ignore[0m
[30;1m440 | [0m[35m        if not silent:[0m
[30;1m441 | [0m[35m            print(col_name, end=", ")[0m
[30;1m442 | [0m[35m        map_func = MAP_FUNCS.get(col_type)[0m

[31m--[ [0m[34mMatch #[0m[33m2145[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m        return f"192.168.{ls_bytes}"[0m
[30;1m172 | [0m[35m    # by default, remap all[0m
[30;1m173 | [0m[35m    return ".".join([0m
[30;1m174 | [0m[35m        [ip_map[idx].get(byte, "1") for idx, byte in enumerate(ip_addr.split("."))][0m
[30;1m175 | [0m[35m    )[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2146[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        # class C res private[0m
[30;1m165 | [0m[35m        ls_bytes = ".".join([0m
[30;1m166 | [0m[35m            [[0m
[30;1m167 | [0m[35m                ip_map[idx].get(byte, "1")[0m
[30;1m168 | [0m[35m                for idx, byte in enumerate(ip_addr.split(".")[2:])[0m
[30;1m169 | [0m[35m            ][0m
[30;1m170 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2147[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m        # class B res private[0m
[30;1m156 | [0m[35m        ls_bytes = ".".join([0m
[30;1m157 | [0m[35m            [[0m
[30;1m158 | [0m[35m                ip_map[idx].get(byte, "1")[0m
[30;1m159 | [0m[35m                for idx, byte in enumerate(ip_addr.split(".")[2:])[0m
[30;1m160 | [0m[35m            ][0m
[30;1m161 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2148[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m        # class A res private[0m
[30;1m147 | [0m[35m        ls_bytes = ".".join([0m
[30;1m148 | [0m[35m            [[0m
[30;1m149 | [0m[35m                ip_map[idx].get(byte, "1")[0m
[30;1m150 | [0m[35m                for idx, byte in enumerate(ip_addr.split(".")[1:])[0m
[30;1m151 | [0m[35m            ][0m
[30;1m152 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2149[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m182 | [0m[35m    Parameters[0m
[30;1m183 | [0m[35m    ----------[0m
[30;1m184 | [0m[35m    input_item : Union[List[str], str][0m
[30;1m185 | [0m[35m        List of IP addresses or single IP address.[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    Returns[0m
[30;1m188 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m2150[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m182 | [0m[35m    Parameters[0m
[30;1m183 | [0m[35m    ----------[0m
[30;1m184 | [0m[35m    input_item : Union[List[str], str][0m
[30;1m185 | [0m[35m        List of IP addresses or single IP address.[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    Returns[0m
[30;1m188 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m2151[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35mdef hash_ip(input_item: Union[List[str], str]) -> Union[List[str], str]:[0m
[30;1m179 | [0m[35m    """[0m
[30;1m180 | [0m[35m    Hash IP address or list of IP addresses.[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    Parameters[0m
[30;1m183 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2152[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35mdef hash_ip(input_item: Union[List[str], str]) -> Union[List[str], str]:[0m
[30;1m179 | [0m[35m    """[0m
[30;1m180 | [0m[35m    Hash IP address or list of IP addresses.[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    Parameters[0m
[30;1m183 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2153[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m    Returns[0m
[30;1m113 | [0m[35m    -------[0m
[30;1m114 | [0m[35m    str[0m
[30;1m115 | [0m[35m        Hashed IP Address.[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    """[0m
[30;1m118 | [0m[35m    if not ip_addr or not isinstance(ip_addr, str):[0m

[31m--[ [0m[34mMatch #[0m[33m2154[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m    Parameters[0m
[30;1m108 | [0m[35m    ----------[0m
[30;1m109 | [0m[35m    ip_addr : str[0m
[30;1m110 | [0m[35m        IP address string[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    Returns[0m
[30;1m113 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m2155[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m@lru_cache(maxsize=1024)[0m
[30;1m103 | [0m[35mdef _hash_ip_item(ip_addr: str) -> str:[0m
[30;1m104 | [0m[35m    """[0m
[30;1m105 | [0m[35m    Hash IP address.[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    Parameters[0m
[30;1m108 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2156[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m    return out_str[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m# Create a random map for shuffling IP address components[0m
[30;1m93 | [0m[35mip_map: List[Dict[str, str]] = [][0m
[30;1m94 | [0m[35mfor _ in range(4):[0m
[30;1m95 | [0m[35m    rng = np.random.default_rng()[0m

[31m--[ [0m[34mMatch #[0m[33m2157[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/data_obfus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m_MAP_FILE = "resources/obfuscation_cols.yaml"[0m
[30;1m21 | [0m[35m_obfus_map_file = pkgutil.get_data("msticpy", _MAP_FILE)[0m
[30;1m22 | [0m[35mif not _obfus_map_file:[0m
[30;1m23 | [0m[35m    warnings.warn(f"Could not find obfuscation column map {_MAP_FILE}")[0m
[30;1m24 | [0m[35melse:[0m
[30;1m25 | [0m[35m    _obfus_dicts = yaml.safe_load(_obfus_map_file)[0m
[30;1m26 | [0m[35m    for data_col_map in _obfus_dicts.values():[0m

[31m--[ [0m[34mMatch #[0m[33m2158[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/syslog_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m    suspicious_actions: list = None,[0m
[30;1m206 | [0m[35m) -> dict:[0m
[30;1m207 | [0m[35m    """[0m
[30;1m208 | [0m[35m    Detect if a sudo session occurs at the point of a suspicious event.[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    Parameters[0m
[30;1m211 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2159[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/syslog_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35mdef _find_suspicious_sudo_session(suspicious_actions: list, sudo_sessions: dict):[0m
[30;1m271 | [0m[35m    risky_sessions = {}[0m
[30;1m272 | [0m[35m    # Determine if suspicious event occurs during a session time window[0m
[30;1m273 | [0m[35m    for event in suspicious_actions:[0m
[30;1m274 | [0m[35m        for value in event.values():[0m
[30;1m275 | [0m[35m            for sess_key, sess_val in sudo_sessions.items():[0m

[31m--[ [0m[34mMatch #[0m[33m2160[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/syslog_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35mdef _find_risky_sudo_session(risky_actions: dict, sudo_sessions: dict):[0m
[30;1m257 | [0m[35m    risky_sessions = {}[0m
[30;1m258 | [0m[35m    # Determine if risky event occurs during a session time window[0m
[30;1m259 | [0m[35m    for key, value in risky_actions.items():[0m
[30;1m260 | [0m[35m        for sess_key, sess_val in sudo_sessions.items():[0m
[30;1m261 | [0m[35m            if ([0m

[31m--[ [0m[34mMatch #[0m[33m2161[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/syslog_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m@export[0m
[30;1m123 | [0m[35mdef cluster_syslog_logons_df(logon_events: pd.DataFrame) -> pd.DataFrame:[0m
[30;1m124 | [0m[35m    """[0m
[30;1m125 | [0m[35m    Cluster logon sessions in syslog by start/end time based on PAM events.[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    Parameters[0m
[30;1m128 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2162[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/syslog_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m    Parameters[0m
[30;1m47 | [0m[35m    ----------[0m
[30;1m48 | [0m[35m    syslog_df : pd.DataFrame[0m
[30;1m49 | [0m[35m        A dataframe of all syslog events for the host in the time window requried[0m
[30;1m50 | [0m[35m    heartbeat_df : pd.DataFrame[0m
[30;1m51 | [0m[35m        A dataframe of heartbeat data for the host[0m
[30;1m52 | [0m[35m    az_net_df : pd.DataFrame[0m

[31m--[ [0m[34mMatch #[0m[33m2163[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/network.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m    attrib_cols: Optional[Iterable[str]],[0m
[30;1m82 | [0m[35m    node_role: NodeRole,[0m
[30;1m83 | [0m[35m):[0m
[30;1m84 | [0m[35m    """Set node attributes from column values."""[0m
[30;1m85 | [0m[35m    all_cols = [column, *attrib_cols] if attrib_cols else [column][0m
[30;1m86 | [0m[35m    # Create an 'agg' dictionary to apply to DataFrame[0m
[30;1m87 | [0m[35m    agg_dict: Dict[str, Union[str, Callable]] = ([0m

[31m--[ [0m[34mMatch #[0m[33m2164[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/network.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    target_attrs : Optional[List[str]], optional[0m
[30;1m46 | [0m[35m        Optional list of columns to use as target node attributes, by default None[0m
[30;1m47 | [0m[35m    edge_attrs : Optional[List[str]], optional[0m
[30;1m48 | [0m[35m        Optional list of columns to use as edge node attributes, by default None[0m
[30;1m49 | [0m[35m    graph_type : str[0m
[30;1m50 | [0m[35m        "graph" or "digraph" (for nx.DiGraph)[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2165[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/network.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    source_attrs : Optional[List[str]], optional[0m
[30;1m44 | [0m[35m        Optional list of columns to use as source node attributes, by default None[0m
[30;1m45 | [0m[35m    target_attrs : Optional[List[str]], optional[0m
[30;1m46 | [0m[35m        Optional list of columns to use as target node attributes, by default None[0m
[30;1m47 | [0m[35m    edge_attrs : Optional[List[str]], optional[0m
[30;1m48 | [0m[35m        Optional list of columns to use as edge node attributes, by default None[0m
[30;1m49 | [0m[35m    graph_type : str[0m

[31m--[ [0m[34mMatch #[0m[33m2166[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/network.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    target_col : str[0m
[30;1m42 | [0m[35m        Column for target nodes.[0m
[30;1m43 | [0m[35m    source_attrs : Optional[List[str]], optional[0m
[30;1m44 | [0m[35m        Optional list of columns to use as source node attributes, by default None[0m
[30;1m45 | [0m[35m    target_attrs : Optional[List[str]], optional[0m
[30;1m46 | [0m[35m        Optional list of columns to use as target node attributes, by default None[0m
[30;1m47 | [0m[35m    edge_attrs : Optional[List[str]], optional[0m

[31m--[ [0m[34mMatch #[0m[33m2167[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_utils_mixin.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m368 | [0m[35mdef _normalize_to_regex([0m
[30;1m369 | [0m[35m    search_term: Union[str, Iterable[str], None], ignore_case: bool[0m
[30;1m370 | [0m[35m) -> List[Pattern[str]]:[0m
[30;1m371 | [0m[35m    """Return iterable or str search term as list of compiled reg expressions."""[0m
[30;1m372 | [0m[35m    if not search_term:[0m
[30;1m373 | [0m[35m        return [][0m
[30;1m374 | [0m[35m    regex_opts = [re.IGNORECASE] if ignore_case else [][0m

[31m--[ [0m[34mMatch #[0m[33m2168[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/core/query_provider_utils_mixin.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m314 | [0m[35m        parameters : Optional[Iterable[QueryParam]], optional[0m
[30;1m315 | [0m[35m            Optional list of parameter definitions, by default None.[0m
[30;1m316 | [0m[35m            If the query is parameterized you must supply definitions[0m
[30;1m317 | [0m[35m            for the parameters here - at least name and type.[0m
[30;1m318 | [0m[35m            Parameters can be the named tuple QueryParam (also[0m
[30;1m319 | [0m[35m            exposed as QueryProvider.Param) or a 4-value[0m
[30;1m320 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2169[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/network_plot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m    output_notebook()[0m
[30;1m320 | [0m[35m    font_pnt = f"{font_size}pt" if isinstance(font_size, int) else font_size[0m
[30;1m321 | [0m[35m    node_attrs = {[0m
[30;1m322 | [0m[35m        node: attrs.get("color", "green")[0m
[30;1m323 | [0m[35m        for node, attrs in entity_graph.nodes(data=True)[0m
[30;1m324 | [0m[35m    }[0m
[30;1m325 | [0m[35m    nx.set_node_attributes(entity_graph, node_attrs, "node_color")[0m

[31m--[ [0m[34mMatch #[0m[33m2170[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/network_plot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m            "color",[0m
[30;1m140 | [0m[35m            ([0m
[30;1m141 | [0m[35m                source_color[0m
[30;1m142 | [0m[35m                if attrs.get("node_role", "source") == "source"[0m
[30;1m143 | [0m[35m                else target_color[0m
[30;1m144 | [0m[35m            ),[0m
[30;1m145 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2171[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/network_plot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m    target_color = kwargs.pop("target_color", "lightgreen")[0m
[30;1m136 | [0m[35m    edge_color = kwargs.pop("edge_color", "black")[0m
[30;1m137 | [0m[35m    node_attrs = {[0m
[30;1m138 | [0m[35m        node: attrs.get([0m
[30;1m139 | [0m[35m            "color",[0m
[30;1m140 | [0m[35m            ([0m
[30;1m141 | [0m[35m                source_color[0m

[31m--[ [0m[34mMatch #[0m[33m2172[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/network_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m    node_size : int, optional[0m
[30;1m299 | [0m[35m        Size of the nodes in pixels, by default 25[0m
[30;1m300 | [0m[35m    font_size : int, optional[0m
[30;1m301 | [0m[35m        Font size for node labels, by default 10[0m
[30;1m302 | [0m[35m        Can be an integer (point size) or a string (e.g. "10pt")[0m
[30;1m303 | [0m[35m    width : int, optional[0m
[30;1m304 | [0m[35m        Width in pixels, by default 800[0m

[31m--[ [0m[34mMatch #[0m[33m2173[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/network_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m        Optional list of edge attributes to use as hover properties, by default None[0m
[30;1m108 | [0m[35m    layout : GraphLayout, optional[0m
[30;1m109 | [0m[35m        The layout name to use, a callable that will return layout[0m
[30;1m110 | [0m[35m        positions, a dictionary of {nFode_id: (float, float)} node positions.[0m
[30;1m111 | [0m[35m        The default is "spring".[0m
[30;1m112 | [0m[35m        See https://networkx.org/documentation/stable/reference/drawing.html[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2174[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/network_plot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m    node_size : int, optional[0m
[30;1m89 | [0m[35m        Size of the nodes in pixels, by default 25[0m
[30;1m90 | [0m[35m    font_size : int, optional[0m
[30;1m91 | [0m[35m        Font size for node labels, by default 10[0m
[30;1m92 | [0m[35m        Can be an integer (point size) or a string (e.g. "10pt")[0m
[30;1m93 | [0m[35m    width : int, optional[0m
[30;1m94 | [0m[35m        Width in pixels, by default 800[0m

[31m--[ [0m[34mMatch #[0m[33m2175[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m423 | [0m[35m    Parameters[0m
[30;1m424 | [0m[35m    ----------[0m
[30;1m425 | [0m[35m    session: List[Cmd][0m
[30;1m426 | [0m[35m        list of Cmd datatype[0m
[30;1m427 | [0m[35m        an example session::[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m            [Cmd(name='Set-User', params={'Identity', 'Force'}), Cmd(name='Set-Mailbox',[0m

[31m--[ [0m[34mMatch #[0m[33m2176[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m334 | [0m[35m    Parameters[0m
[30;1m335 | [0m[35m    ----------[0m
[30;1m336 | [0m[35m    session: List[Cmd][0m
[30;1m337 | [0m[35m        list of Cmd datatype[0m
[30;1m338 | [0m[35m        an example session::[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m            [Cmd(name='Set-User', params={'Identity', 'Force'}),[0m

[31m--[ [0m[34mMatch #[0m[33m2177[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m238 | [0m[35m    Parameters[0m
[30;1m239 | [0m[35m    ----------[0m
[30;1m240 | [0m[35m    window: List[Cmd][0m
[30;1m241 | [0m[35m        part or all of a session, where a session is a list of the Cmd datatype[0m
[30;1m242 | [0m[35m        an example session::[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m            [Cmd(name='Set-User', params={'Identity', 'Force'}), Cmd(name='Set-Mailbox',[0m

[31m--[ [0m[34mMatch #[0m[33m2178[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m        name of command[0m
[30;1m179 | [0m[35m        (e.g. for Exchange powershell commands: "Set-Mailbox")[0m
[30;1m180 | [0m[35m    params: Union[set, dict][0m
[30;1m181 | [0m[35m        set of accompanying params for the cmd[0m
[30;1m182 | [0m[35m        (e.g for Exchange powershell commands: {'Identity', 'ForwardingEmailAddress'}).[0m
[30;1m183 | [0m[35m        If params is set to be a dictionary of accompanying params and values,[0m
[30;1m184 | [0m[35m        then only the keys of the dict will be used.[0m

[31m--[ [0m[34mMatch #[0m[33m2179[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m79 | [0m[35m    for session in sessions:[0m
[30;1m80 | [0m[35m        prev = start_token[0m
[30;1m81 | [0m[35m        seq1_counts[prev] += 1[0m
[30;1m82 | [0m[35m        for cmd in session:[0m
[30;1m83 | [0m[35m            seq1_counts[cmd.name] += 1[0m
[30;1m84 | [0m[35m            seq2_counts[prev][cmd.name] += 1[0m
[30;1m85 | [0m[35m            prev = cmd.name[0m

[31m--[ [0m[34mMatch #[0m[33m2180[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m44 | [0m[35m    Parameters[0m
[30;1m45 | [0m[35m    ----------[0m
[30;1m46 | [0m[35m    sessions: List[List[Cmd]][0m
[30;1m47 | [0m[35m        each session is a list of the Cmd datatype. Where the Cmd datatype[0m
[30;1m48 | [0m[35m        has a name attribute (command name) and a params attribute[0m
[30;1m49 | [0m[35m        (set containing params associated with the command)[0m
[30;1m50 | [0m[35m        an example session::[0m

[31m--[ [0m[34mMatch #[0m[33m2181[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m44 | [0m[35m    Parameters[0m
[30;1m45 | [0m[35m    ----------[0m
[30;1m46 | [0m[35m    sessions: List[List[Cmd]][0m
[30;1m47 | [0m[35m        each session is a list of the Cmd datatype. Where the Cmd datatype[0m
[30;1m48 | [0m[35m        has a name attribute (command name) and a params attribute[0m
[30;1m49 | [0m[35m        (set containing params associated with the command)[0m
[30;1m50 | [0m[35m        an example session::[0m

[31m--[ [0m[34mMatch #[0m[33m2182[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35mHelper module for computations when modelling sessions.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mIn particular, this module is for when each session is a list[0m
[30;1m10 | [0m[35mof the Cmd datatype with the params attribute set to a set[0m
[30;1m11 | [0m[35mof accompanying params.[0m
[30;1m12 | [0m[35m"""[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2183[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/cmds_params_only.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m418 | [0m[35m    use_geo_mean=False,[0m
[30;1m419 | [0m[35m) -> Tuple[List[Cmd], float]:[0m
[30;1m420 | [0m[35m    """[0m
[30;1m421 | [0m[35m    Find and compute the likelihood of the rarest window of `window_len` in the session.[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35m    Parameters[0m
[30;1m424 | [0m[35m    ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2184[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m578 | [0m[35m            distinct_list.append(distinct_item["name"])[0m
[30;1m579 | [0m[35m        else:[0m
[30;1m580 | [0m[35m            val = _parse_expression(_get_expr_value(distinct_item))[0m
[30;1m581 | [0m[35m            if val != distinct_item.get("value"):[0m
[30;1m582 | [0m[35m                # If value was a complex expression we can't use[0m
[30;1m583 | [0m[35m                # it directly so just revert to distinct *[0m
[30;1m584 | [0m[35m                distinct_list = ["*"][0m

[31m--[ [0m[34mMatch #[0m[33m2185[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35m            group_by_expr_list.append(f"{name_expr}any({expr['value']})")[0m
[30;1m360 | [0m[35m        else:[0m
[30;1m361 | [0m[35m            group_by_expr_list.append([0m
[30;1m362 | [0m[35m                f"{name_expr}{_parse_expression(expr.get('value'))}"[0m
[30;1m363 | [0m[35m            )[0m
[30;1m364 | [0m[35m    query_lines.append(f"| summarize {', '.join(group_by_expr_list)} by {by_clause}")[0m
[30;1m365 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2186[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m        name_expr = ""[0m
[30;1m356 | [0m[35m        if "name" in expr:[0m
[30;1m357 | [0m[35m            name_expr = f"{expr.get('name')} = "[0m
[30;1m358 | [0m[35m        if isinstance(expr.get("value"), str):[0m
[30;1m359 | [0m[35m            group_by_expr_list.append(f"{name_expr}any({expr['value']})")[0m
[30;1m360 | [0m[35m        else:[0m
[30;1m361 | [0m[35m            group_by_expr_list.append([0m

[31m--[ [0m[34mMatch #[0m[33m2187[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m354 | [0m[35m    for expr in expr_list:[0m
[30;1m355 | [0m[35m        name_expr = ""[0m
[30;1m356 | [0m[35m        if "name" in expr:[0m
[30;1m357 | [0m[35m            name_expr = f"{expr.get('name')} = "[0m
[30;1m358 | [0m[35m        if isinstance(expr.get("value"), str):[0m
[30;1m359 | [0m[35m            group_by_expr_list.append(f"{name_expr}any({expr['value']})")[0m
[30;1m360 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m2188[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m    )[0m
[30;1m349 | [0m[35m    by_clause = ", ".join(val["value"] for val in group_by_expr if val.get("value"))[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    expr_list = parsed_sql.get(SELECT, parsed_sql.get(SELECT_DISTINCT, []))[0m
[30;1m352 | [0m[35m    group_by_expr_list = [][0m
[30;1m353 | [0m[35m    expr_list = _get_expr_value(expr_list)[0m
[30;1m354 | [0m[35m    for expr in expr_list:[0m

[31m--[ [0m[34mMatch #[0m[33m2189[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m    )[0m
[30;1m349 | [0m[35m    by_clause = ", ".join(val["value"] for val in group_by_expr if val.get("value"))[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    expr_list = parsed_sql.get(SELECT, parsed_sql.get(SELECT_DISTINCT, []))[0m
[30;1m352 | [0m[35m    group_by_expr_list = [][0m
[30;1m353 | [0m[35m    expr_list = _get_expr_value(expr_list)[0m
[30;1m354 | [0m[35m    for expr in expr_list:[0m

[31m--[ [0m[34mMatch #[0m[33m2190[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m346 | [0m[35m    group_by_expr = ([0m
[30;1m347 | [0m[35m        group_by_expr if isinstance(group_by_expr, list) else [group_by_expr][0m
[30;1m348 | [0m[35m    )[0m
[30;1m349 | [0m[35m    by_clause = ", ".join(val["value"] for val in group_by_expr if val.get("value"))[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    expr_list = parsed_sql.get(SELECT, parsed_sql.get(SELECT_DISTINCT, []))[0m
[30;1m352 | [0m[35m    group_by_expr_list = [][0m

[31m--[ [0m[34mMatch #[0m[33m2191[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35m        isinstance(expr_list, list)[0m
[30;1m327 | [0m[35m        and len(expr_list) == 1[0m
[30;1m328 | [0m[35m        and isinstance(expr_list[0], dict)[0m
[30;1m329 | [0m[35m        and isinstance(expr_list[0].get("value"), list)[0m
[30;1m330 | [0m[35m    ):[0m
[30;1m331 | [0m[35m        return expr_list[0]["value"][0m
[30;1m332 | [0m[35m    return expr_list[0m

[31m--[ [0m[34mMatch #[0m[33m2192[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m    extend_items = [][0m
[30;1m289 | [0m[35m    for item in select_list:[0m
[30;1m290 | [0m[35m        value = _parse_expression(item["value"])[0m
[30;1m291 | [0m[35m        name = item.get("name")[0m
[30;1m292 | [0m[35m        if value != item["value"]:[0m
[30;1m293 | [0m[35m            # if this isn't a simple rename - add to extend[0m
[30;1m294 | [0m[35m            name = name or _gen_expr_name(item["value"])[0m

[31m--[ [0m[34mMatch #[0m[33m2193[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m            if isinstance(from_item, str):[0m
[30;1m263 | [0m[35m                query_lines.append((from_item))[0m
[30;1m264 | [0m[35m            elif isinstance(from_item, dict) and "value" in from_item:[0m
[30;1m265 | [0m[35m                query_lines.extend(_parse_query(from_item.get("value")))  # type: ignore[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m    join_expr = from_expr if isinstance(from_expr, list) else [from_expr][0m
[30;1m268 | [0m[35m    join_list = _get_join_list(join_expr)[0m

[31m--[ [0m[34mMatch #[0m[33m2194[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/sql_to_kql.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m486 | [0m[35m[0m
[30;1m487 | [0m[35m[0m
[30;1m488 | [0m[35mdef _format_order_item(item: Dict[str, Any]) -> str:[0m
[30;1m489 | [0m[35m    """Return ORDER BY item with sort direction."""[0m
[30;1m490 | [0m[35m    if "sort" in item:[0m
[30;1m491 | [0m[35m        return f"{item['value']} {item['sort'].lower()}"[0m
[30;1m492 | [0m[35m    return f"{item['value']}"[0m

[31m--[ [0m[34mMatch #[0m[33m2195[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m768 | [0m[35m    @classmethod[0m
[30;1m769 | [0m[35m    def import_provider(cls: type[Self], provider: str) -> type[Provider]:[0m
[30;1m770 | [0m[35m        """Import provider class."""[0m
[30;1m771 | [0m[35m        mod_name, cls_name = cls.PROVIDERS.get(provider, (None, None))[0m
[30;1m772 | [0m[35m[0m
[30;1m773 | [0m[35m        if not (mod_name and cls_name):[0m
[30;1m774 | [0m[35m            if hasattr(cls, "CUSTOM_PROVIDERS") and provider in cls.CUSTOM_PROVIDERS:[0m

[31m--[ [0m[34mMatch #[0m[33m2196[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/lookup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m345 | [0m[35m        """Reload provider settings from config."""[0m
[30;1m346 | [0m[35m        reload_settings()[0m
[30;1m347 | [0m[35m        logger.info([0m
[30;1m348 | [0m[35m            "Settings reloaded. Use reload_providers to update settings for loaded providers.",[0m
[30;1m349 | [0m[35m        )[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    def reload_providers(self: Self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m2197[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m803 | [0m[35m                provider_class: type[Provider] = self.import_provider(prov_name)[0m
[30;1m804 | [0m[35m            except LookupError:[0m
[30;1m805 | [0m[35m                warnings.warn([0m
[30;1m806 | [0m[35m                    f"Could not find provider class for {provider_name} "[0m
[30;1m807 | [0m[35m                    f"in config section '{provider_name}'. "[0m
[30;1m808 | [0m[35m                    f"Provider class name in config is '{settings.provider}'",[0m
[30;1m809 | [0m[35m                    stacklevel=2,[0m

[31m--[ [0m[34mMatch #[0m[33m2198[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m486 | [0m[35m        start: dt.datetime[0m
[30;1m487 | [0m[35m            If supported by the provider, start time for the item's validity[0m
[30;1m488 | [0m[35m        end: dt.datetime[0m
[30;1m489 | [0m[35m            If supported by the provider, end time for the item's validity[0m
[30;1m490 | [0m[35m        progress : bool[0m
[30;1m491 | [0m[35m            Use progress bar to track completion, by default True[0m
[30;1m492 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2199[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m484 | [0m[35m        show_not_supported: bool[0m
[30;1m485 | [0m[35m            If True, display unsupported items. Defaults to False[0m
[30;1m486 | [0m[35m        start: dt.datetime[0m
[30;1m487 | [0m[35m            If supported by the provider, start time for the item's validity[0m
[30;1m488 | [0m[35m        end: dt.datetime[0m
[30;1m489 | [0m[35m            If supported by the provider, end time for the item's validity[0m
[30;1m490 | [0m[35m        progress : bool[0m

[31m--[ [0m[34mMatch #[0m[33m2200[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m419 | [0m[35m        start: dt.datetime[0m
[30;1m420 | [0m[35m            If supported by the provider, start time for the item's validity[0m
[30;1m421 | [0m[35m        end: dt.datetime[0m
[30;1m422 | [0m[35m            If supported by the provider, end time for the item's validity[0m
[30;1m423 | [0m[35m        progress : bool[0m
[30;1m424 | [0m[35m            Use progress bar to track completion, by default True[0m
[30;1m425 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2201[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m417 | [0m[35m        show_not_supported: bool[0m
[30;1m418 | [0m[35m            If True, display unsupported items. Defaults to False[0m
[30;1m419 | [0m[35m        start: dt.datetime[0m
[30;1m420 | [0m[35m            If supported by the provider, start time for the item's validity[0m
[30;1m421 | [0m[35m        end: dt.datetime[0m
[30;1m422 | [0m[35m            If supported by the provider, end time for the item's validity[0m
[30;1m423 | [0m[35m        progress : bool[0m

[31m--[ [0m[34mMatch #[0m[33m2202[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_data_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m        """[0m
[30;1m126 | [0m[35m        del kwargs[0m
[30;1m127 | [0m[35m        query_name = query_source.name if query_source else query[0m
[30;1m128 | [0m[35m        file_path = self.data_files.get(query.casefold())[0m
[30;1m129 | [0m[35m        if not file_path:[0m
[30;1m130 | [0m[35m            raise FileNotFoundError([0m
[30;1m131 | [0m[35m                f"Data file ({query}) for query {query_name} not found."[0m

[31m--[ [0m[34mMatch #[0m[33m2203[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_data_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        self._paths: List[str] = ["."][0m
[30;1m42 | [0m[35m        if data_paths := kwargs.get("data_paths"):[0m
[30;1m43 | [0m[35m            self._paths = [path.strip() for path in data_paths][0m
[30;1m44 | [0m[35m        elif has_config("DataProviders.LocalData"):[0m
[30;1m45 | [0m[35m            self._paths = get_config("LocalData.data_paths", self._paths)[0m

[31m--[ [0m[34mMatch #[0m[33m2204[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_data_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        """[0m
[30;1m37 | [0m[35m        del connection_str[0m
[30;1m38 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m39 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        self._paths: List[str] = ["."][0m

[31m--[ [0m[34mMatch #[0m[33m2205[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m        # until the search has finished.[0m
[30;1m304 | [0m[35m        # https://dev.splunk.com/enterprise/docs/python/[0m
[30;1m305 | [0m[35m        # sdk-python/howtousesplunkpython/howtorunsearchespython[0m
[30;1m306 | [0m[35m        is_oneshot = kwargs.get("oneshot", False)[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m        if is_oneshot is True:[0m
[30;1m309 | [0m[35m            kwargs["output_mode"] = "json"[0m

[31m--[ [0m[34mMatch #[0m[33m2206[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m                algorithms=[alg],[0m
[30;1m230 | [0m[35m                options={"verify_signature": False},[0m
[30;1m231 | [0m[35m            )[0m
[30;1m232 | [0m[35m            token_idp = decoded_token.get("idp")[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m            if token_idp == "Splunk":  # nosec[0m
[30;1m235 | [0m[35m                epoch_issued_at = decoded_token["iat"][0m

[31m--[ [0m[34mMatch #[0m[33m2207[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m            print("Credential loading from msticpyconfig.yaml file.")[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m        cs_dict["port"] = int(cs_dict["port"])[0m
[30;1m198 | [0m[35m        verify_opt = cs_dict.get("verify")[0m
[30;1m199 | [0m[35m        if isinstance(verify_opt, str):[0m
[30;1m200 | [0m[35m            cs_dict["verify"] = "true" in verify_opt.casefold()[0m
[30;1m201 | [0m[35m        elif isinstance(verify_opt, bool):[0m

[31m--[ [0m[34mMatch #[0m[33m2208[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        }[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m        # Replace to Splunk python sdk's parameter name of sp_client.connect()[0m
[30;1m146 | [0m[35m        if arg_dict.get("bearer_token"):[0m
[30;1m147 | [0m[35m            arg_dict["splunkToken"] = arg_dict.pop("bearer_token")[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m2209[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m        self.service = None[0m
[30;1m97 | [0m[35m        self._loaded = True[0m
[30;1m98 | [0m[35m        self._connected = False[0m
[30;1m99 | [0m[35m        if kwargs.get("debug", False):[0m
[30;1m100 | [0m[35m            logger.setLevel(logging.DEBUG)[0m
[30;1m101 | [0m[35m        self._required_params = self._SPLUNK_REQD_ARGS[0m
[30;1m102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2210[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m481 | [0m[35m            resp_rows.extend([row for row in reader if isinstance(row, dict)])[0m
[30;1m482 | [0m[35m            progress_bar_paginate.update(page_size)[0m
[30;1m483 | [0m[35m            offset += page_size[0m
[30;1m484 | [0m[35m        # Update progress bar indicating fetch results[0m
[30;1m485 | [0m[35m        progress_bar_paginate.update(result_count)[0m
[30;1m486 | [0m[35m        progress_bar_paginate.close()[0m
[30;1m487 | [0m[35m        logger.info("Retrieved %d results.", len(resp_rows))[0m

[31m--[ [0m[34mMatch #[0m[33m2211[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m    @staticmethod[0m
[30;1m431 | [0m[35m    def _retrieve_job_status(query_job, progress_bar, prev_progress):[0m
[30;1m432 | [0m[35m        """Poll the status of a job and update the progress bar."""[0m
[30;1m433 | [0m[35m        stats = {[0m
[30;1m434 | [0m[35m            "is_done": query_job["isDone"],[0m
[30;1m435 | [0m[35m            "done_progress": float(query_job["doneProgress"]) * 100,[0m

[31m--[ [0m[34mMatch #[0m[33m2212[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m419 | [0m[35m                    title="Splunk query timeout",[0m
[30;1m420 | [0m[35m                )[0m
[30;1m421 | [0m[35m            sleep(1)[0m
[30;1m422 | [0m[35m        # Update progress bar indicating job completion[0m
[30;1m423 | [0m[35m        progress_bar.update(100)[0m
[30;1m424 | [0m[35m        progress_bar.close()[0m
[30;1m425 | [0m[35m        sleep(2)[0m

[31m--[ [0m[34mMatch #[0m[33m2213[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m404 | [0m[35m        # Initiate progress bar and start while loop, waiting for async query to complete[0m
[30;1m405 | [0m[35m        progress_bar = tqdm(total=100, desc="Waiting Splunk job to complete")[0m
[30;1m406 | [0m[35m        prev_progress = 0[0m
[30;1m407 | [0m[35m        offset = 0  # Start at result 0[0m
[30;1m408 | [0m[35m        start_time = datetime.now()[0m
[30;1m409 | [0m[35m        end_time = start_time + timedelta(seconds=timeout)[0m
[30;1m410 | [0m[35m        while True:[0m

[31m--[ [0m[34mMatch #[0m[33m2214[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m287 | [0m[35m        # default to unlimited query unless count is specified[0m
[30;1m288 | [0m[35m        count = kwargs.pop("count", 0)[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m        # Get sets of N results at a time, N=100 by default[0m
[30;1m291 | [0m[35m        page_size = kwargs.pop("page_size", 100)[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        # default to 60s unless timeout is specified[0m

[31m--[ [0m[34mMatch #[0m[33m2215[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m268 | [0m[35m            Set to True for oneshot (blocking) mode, by default False[0m
[30;1m269 | [0m[35m        page_size = int, optional[0m
[30;1m270 | [0m[35m            Pass to Splunk results reader in terms of fetch speed,[0m
[30;1m271 | [0m[35m            which sets of result amount will be got at a time,[0m
[30;1m272 | [0m[35m            by default, 100[0m
[30;1m273 | [0m[35m        timeout : int, optional[0m
[30;1m274 | [0m[35m            Amount of time to wait for results, by default 60[0m

[31m--[ [0m[34mMatch #[0m[33m2216[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m        page_size = kwargs.pop("page_size", 100)[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        # default to 60s unless timeout is specified[0m
[30;1m294 | [0m[35m        timeout = kwargs.pop("timeout", 60)[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        # Normal (non-blocking) searches or oneshot (blocking) searches.[0m
[30;1m297 | [0m[35m        # Defaults to Normal(non-blocking)[0m

[31m--[ [0m[34mMatch #[0m[33m2217[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m290 | [0m[35m        # Get sets of N results at a time, N=100 by default[0m
[30;1m291 | [0m[35m        page_size = kwargs.pop("page_size", 100)[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        # default to 60s unless timeout is specified[0m
[30;1m294 | [0m[35m        timeout = kwargs.pop("timeout", 60)[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        # Normal (non-blocking) searches or oneshot (blocking) searches.[0m

[31m--[ [0m[34mMatch #[0m[33m2218[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m            which sets of result amount will be got at a time,[0m
[30;1m272 | [0m[35m            by default, 100[0m
[30;1m273 | [0m[35m        timeout : int, optional[0m
[30;1m274 | [0m[35m            Amount of time to wait for results, by default 60[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        Returns[0m
[30;1m277 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m2219[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m            Pass to Splunk results reader in terms of fetch speed,[0m
[30;1m271 | [0m[35m            which sets of result amount will be got at a time,[0m
[30;1m272 | [0m[35m            by default, 100[0m
[30;1m273 | [0m[35m        timeout : int, optional[0m
[30;1m274 | [0m[35m            Amount of time to wait for results, by default 60[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m2220[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m    ),[0m
[30;1m61 | [0m[35m    "token": ([0m
[30;1m62 | [0m[35m        "(string) The current session token (optional). Session tokens can be"[0m
[30;1m63 | [0m[35m        + " shared across multiple service instances."[0m
[30;1m64 | [0m[35m    ),[0m
[30;1m65 | [0m[35m    "cookie": ([0m
[30;1m66 | [0m[35m        "(string) A session cookie. When provided, you don’t need to call"[0m

[31m--[ [0m[34mMatch #[0m[33m2221[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    "host": "(string) The host name (the default is 'localhost').",[0m
[30;1m46 | [0m[35m    "port": "(string) The port number (the default is '8089').",[0m
[30;1m47 | [0m[35m    "http_scheme": ([0m
[30;1m48 | [0m[35m        "('https' or 'http') The scheme for accessing the service "[0m
[30;1m49 | [0m[35m        + "(the default is 'https')."[0m
[30;1m50 | [0m[35m    ),[0m
[30;1m51 | [0m[35m    "verify": ([0m

[31m--[ [0m[34mMatch #[0m[33m2222[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/splunk_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m"""Splunk Driver class."""[0m
[30;1m7 | [0m[35mimport logging[0m
[30;1m8 | [0m[35mfrom datetime import datetime, timedelta, timezone[0m
[30;1m9 | [0m[35mfrom time import sleep[0m
[30;1m10 | [0m[35mfrom typing import Any, Dict, Iterable, Optional, Tuple, Union[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport jwt[0m

[31m--[ [0m[34mMatch #[0m[33m2223[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/data_viewer_panel.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35mdef _format_value(value: Any, width=150) -> str:[0m
[30;1m251 | [0m[35m    """Apply format function to column cell."""[0m
[30;1m252 | [0m[35m    return _FORMATTERS.get(type(value), _FORMATTERS[str])(value, width)[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35mTD_ALIGN = """[0m

[31m--[ [0m[34mMatch #[0m[33m2224[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/data_viewer_panel.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m239 | [0m[35m    (dict, list): lambda value, width: f"<pre>{pformat(value, width=width)}</pre>",[0m
[30;1m240 | [0m[35m    str: lambda value, width: "<br>".join(wrap(value, width=width)),[0m
[30;1m241 | [0m[35m}[0m
[30;1m242 | [0m[35m# expand[0m
[30;1m243 | [0m[35m_FORMATTERS = {[0m
[30;1m244 | [0m[35m    val_type: func[0m
[30;1m245 | [0m[35m    for val_tuple, func in _ROW_FORMAT_FUNCS.items()[0m

[31m--[ [0m[34mMatch #[0m[33m2225[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/data_viewer_panel.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m        ):[0m
[30;1m104 | [0m[35m            self._hidden_columns.remove("TenantId")[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        # Create the tabulator control[0m
[30;1m107 | [0m[35m        self.data_table = pn.widgets.Tabulator([0m
[30;1m108 | [0m[35m            self.data,[0m
[30;1m109 | [0m[35m            header_filters=kwargs.pop("header_filters", True),[0m

[31m--[ [0m[34mMatch #[0m[33m2226[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/data_viewer_panel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35mTD_ALIGN = """[0m
[30;1m256 | [0m[35m<style>[0m
[30;1m257 | [0m[35mtd { text-align:left; vertical-align: top }[0m
[30;1m258 | [0m[35m</style>[0m
[30;1m259 | [0m[35m"""[0m
[30;1m260 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2227[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/data_viewer_panel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m239 | [0m[35m    (dict, list): lambda value, width: f"<pre>{pformat(value, width=width)}</pre>",[0m
[30;1m240 | [0m[35m    str: lambda value, width: "<br>".join(wrap(value, width=width)),[0m
[30;1m241 | [0m[35m}[0m
[30;1m242 | [0m[35m# expand[0m
[30;1m243 | [0m[35m_FORMATTERS = {[0m
[30;1m244 | [0m[35m    val_type: func[0m
[30;1m245 | [0m[35m    for val_tuple, func in _ROW_FORMAT_FUNCS.items()[0m

[31m--[ [0m[34mMatch #[0m[33m2228[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/data_viewer_panel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mexcept ImportError as err:[0m
[30;1m21 | [0m[35m    raise MsticpyMissingDependencyError([0m
[30;1m22 | [0m[35m        "This component needs the panel package.",[0m
[30;1m23 | [0m[35m        "Install the conda or pip 'panel' package.",[0m
[30;1m24 | [0m[35m        packages="panel",[0m
[30;1m25 | [0m[35m    ) from err[0m
[30;1m26 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2229[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/process_tree_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m    template = template or _create_proctree_template(schema)  # type: ignore[0m
[30;1m434 | [0m[35m    output: List[str] = [][0m
[30;1m435 | [0m[35m    for _, row in procs.sort_values(sort_column).iterrows():[0m
[30;1m436 | [0m[35m        depth_count = Counter(row.path).get("/", 0)[0m
[30;1m437 | [0m[35m        header = _node_header(depth_count)[0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m        # handle first row separately since it needs a header[0m

[31m--[ [0m[34mMatch #[0m[33m2230[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/process_tree_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35mdef _node_header(depth_count):[0m
[30;1m498 | [0m[35m    """Return text tree node header given tree depth."""[0m
[30;1m499 | [0m[35m    return "+ " if depth_count == 0 else "   " * depth_count + "+-- "[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2231[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/process_tree_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m411 | [0m[35m        A manually created template to use to create the node[0m
[30;1m412 | [0m[35m        formatting, by default None[0m
[30;1m413 | [0m[35m    sort_column : str, optional[0m
[30;1m414 | [0m[35m        The column to sort the DataFrame by, by default "path"[0m
[30;1m415 | [0m[35m    wrap_column : int, optional[0m
[30;1m416 | [0m[35m        Override any template-specified wrap limit, by default 0[0m
[30;1m417 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2232[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/process_tree_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m408 | [0m[35m        The schema to use for mapping the DataFrame column[0m
[30;1m409 | [0m[35m        names, by default None[0m
[30;1m410 | [0m[35m    template : Optional[List[TemplateLine]], optional[0m
[30;1m411 | [0m[35m        A manually created template to use to create the node[0m
[30;1m412 | [0m[35m        formatting, by default None[0m
[30;1m413 | [0m[35m    sort_column : str, optional[0m
[30;1m414 | [0m[35m        The column to sort the DataFrame by, by default "path"[0m

[31m--[ [0m[34mMatch #[0m[33m2233[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/data_types.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mdef _get_dot_attrib(obj, elem_path: str) -> Any:[0m
[30;1m71 | [0m[35m    """Return attribute at dotted path."""[0m
[30;1m72 | [0m[35m    path_elems = elem_path.split(".")[0m
[30;1m73 | [0m[35m    cur_node = obj[0m
[30;1m74 | [0m[35m    for elem in path_elems:[0m

[31m--[ [0m[34mMatch #[0m[33m2234[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/setup.cfg[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m42 | [0m[35mproject_urls = [0m
[30;1m43 | [0m[35m	Documentation = https://msticpy.readthedocs.io[0m
[30;1m44 | [0m[35m	Code = https://github.com/microsoft/msticpy[0m
[30;1m45 | [0m[35m	Issue tracker = https://github.com/microsoft/msticpy/issues[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[options][0m
[30;1m48 | [0m[35mzip_safe = False[0m

[31m--[ [0m[34mMatch #[0m[33m2235[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m        relevant_techniques=parsed_yaml_dict.get("relevantTechniques", []),[0m
[30;1m248 | [0m[35m        query=parsed_yaml_dict.get("query", ""),[0m
[30;1m249 | [0m[35m        version=parsed_yaml_dict.get("version", ""),[0m
[30;1m250 | [0m[35m        kind=parsed_yaml_dict.get("kind", ""),[0m
[30;1m251 | [0m[35m        folder_name=yaml_path.replace("\\", "/").split("/")[-2],[0m
[30;1m252 | [0m[35m        source_file_name=yaml_path,[0m
[30;1m253 | [0m[35m        query_type=query_type,[0m

[31m--[ [0m[34mMatch #[0m[33m2236[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m        tactics=parsed_yaml_dict.get("tactics", ""),[0m
[30;1m247 | [0m[35m        relevant_techniques=parsed_yaml_dict.get("relevantTechniques", []),[0m
[30;1m248 | [0m[35m        query=parsed_yaml_dict.get("query", ""),[0m
[30;1m249 | [0m[35m        version=parsed_yaml_dict.get("version", ""),[0m
[30;1m250 | [0m[35m        kind=parsed_yaml_dict.get("kind", ""),[0m
[30;1m251 | [0m[35m        folder_name=yaml_path.replace("\\", "/").split("/")[-2],[0m
[30;1m252 | [0m[35m        source_file_name=yaml_path,[0m

[31m--[ [0m[34mMatch #[0m[33m2237[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m        trigger_threshold=parsed_yaml_dict.get("triggerThreshold", ""),[0m
[30;1m246 | [0m[35m        tactics=parsed_yaml_dict.get("tactics", ""),[0m
[30;1m247 | [0m[35m        relevant_techniques=parsed_yaml_dict.get("relevantTechniques", []),[0m
[30;1m248 | [0m[35m        query=parsed_yaml_dict.get("query", ""),[0m
[30;1m249 | [0m[35m        version=parsed_yaml_dict.get("version", ""),[0m
[30;1m250 | [0m[35m        kind=parsed_yaml_dict.get("kind", ""),[0m
[30;1m251 | [0m[35m        folder_name=yaml_path.replace("\\", "/").split("/")[-2],[0m

[31m--[ [0m[34mMatch #[0m[33m2238[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m        trigger_operator=parsed_yaml_dict.get("triggerOperator", ""),[0m
[30;1m245 | [0m[35m        trigger_threshold=parsed_yaml_dict.get("triggerThreshold", ""),[0m
[30;1m246 | [0m[35m        tactics=parsed_yaml_dict.get("tactics", ""),[0m
[30;1m247 | [0m[35m        relevant_techniques=parsed_yaml_dict.get("relevantTechniques", []),[0m
[30;1m248 | [0m[35m        query=parsed_yaml_dict.get("query", ""),[0m
[30;1m249 | [0m[35m        version=parsed_yaml_dict.get("version", ""),[0m
[30;1m250 | [0m[35m        kind=parsed_yaml_dict.get("kind", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2239[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m        query_period=parsed_yaml_dict.get("queryPeriod", ""),[0m
[30;1m244 | [0m[35m        trigger_operator=parsed_yaml_dict.get("triggerOperator", ""),[0m
[30;1m245 | [0m[35m        trigger_threshold=parsed_yaml_dict.get("triggerThreshold", ""),[0m
[30;1m246 | [0m[35m        tactics=parsed_yaml_dict.get("tactics", ""),[0m
[30;1m247 | [0m[35m        relevant_techniques=parsed_yaml_dict.get("relevantTechniques", []),[0m
[30;1m248 | [0m[35m        query=parsed_yaml_dict.get("query", ""),[0m
[30;1m249 | [0m[35m        version=parsed_yaml_dict.get("version", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2240[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m        query_frequency=parsed_yaml_dict.get("queryFrequency", ""),[0m
[30;1m243 | [0m[35m        query_period=parsed_yaml_dict.get("queryPeriod", ""),[0m
[30;1m244 | [0m[35m        trigger_operator=parsed_yaml_dict.get("triggerOperator", ""),[0m
[30;1m245 | [0m[35m        trigger_threshold=parsed_yaml_dict.get("triggerThreshold", ""),[0m
[30;1m246 | [0m[35m        tactics=parsed_yaml_dict.get("tactics", ""),[0m
[30;1m247 | [0m[35m        relevant_techniques=parsed_yaml_dict.get("relevantTechniques", []),[0m
[30;1m248 | [0m[35m        query=parsed_yaml_dict.get("query", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2241[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m        required_data_connectors=parsed_yaml_dict.get("requiredDataConnectors", {}),[0m
[30;1m242 | [0m[35m        query_frequency=parsed_yaml_dict.get("queryFrequency", ""),[0m
[30;1m243 | [0m[35m        query_period=parsed_yaml_dict.get("queryPeriod", ""),[0m
[30;1m244 | [0m[35m        trigger_operator=parsed_yaml_dict.get("triggerOperator", ""),[0m
[30;1m245 | [0m[35m        trigger_threshold=parsed_yaml_dict.get("triggerThreshold", ""),[0m
[30;1m246 | [0m[35m        tactics=parsed_yaml_dict.get("tactics", ""),[0m
[30;1m247 | [0m[35m        relevant_techniques=parsed_yaml_dict.get("relevantTechniques", []),[0m

[31m--[ [0m[34mMatch #[0m[33m2242[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m        tags=parsed_yaml_dict.get("tags_entry", []),[0m
[30;1m241 | [0m[35m        required_data_connectors=parsed_yaml_dict.get("requiredDataConnectors", {}),[0m
[30;1m242 | [0m[35m        query_frequency=parsed_yaml_dict.get("queryFrequency", ""),[0m
[30;1m243 | [0m[35m        query_period=parsed_yaml_dict.get("queryPeriod", ""),[0m
[30;1m244 | [0m[35m        trigger_operator=parsed_yaml_dict.get("triggerOperator", ""),[0m
[30;1m245 | [0m[35m        trigger_threshold=parsed_yaml_dict.get("triggerThreshold", ""),[0m
[30;1m246 | [0m[35m        tactics=parsed_yaml_dict.get("tactics", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2243[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m        severity=parsed_yaml_dict.get("severity", ""),[0m
[30;1m240 | [0m[35m        tags=parsed_yaml_dict.get("tags_entry", []),[0m
[30;1m241 | [0m[35m        required_data_connectors=parsed_yaml_dict.get("requiredDataConnectors", {}),[0m
[30;1m242 | [0m[35m        query_frequency=parsed_yaml_dict.get("queryFrequency", ""),[0m
[30;1m243 | [0m[35m        query_period=parsed_yaml_dict.get("queryPeriod", ""),[0m
[30;1m244 | [0m[35m        trigger_operator=parsed_yaml_dict.get("triggerOperator", ""),[0m
[30;1m245 | [0m[35m        trigger_threshold=parsed_yaml_dict.get("triggerThreshold", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2244[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m        description=parsed_yaml_dict.get("description", ""),[0m
[30;1m239 | [0m[35m        severity=parsed_yaml_dict.get("severity", ""),[0m
[30;1m240 | [0m[35m        tags=parsed_yaml_dict.get("tags_entry", []),[0m
[30;1m241 | [0m[35m        required_data_connectors=parsed_yaml_dict.get("requiredDataConnectors", {}),[0m
[30;1m242 | [0m[35m        query_frequency=parsed_yaml_dict.get("queryFrequency", ""),[0m
[30;1m243 | [0m[35m        query_period=parsed_yaml_dict.get("queryPeriod", ""),[0m
[30;1m244 | [0m[35m        trigger_operator=parsed_yaml_dict.get("triggerOperator", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2245[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m        query_id=parsed_yaml_dict.get("id", ""),[0m
[30;1m238 | [0m[35m        description=parsed_yaml_dict.get("description", ""),[0m
[30;1m239 | [0m[35m        severity=parsed_yaml_dict.get("severity", ""),[0m
[30;1m240 | [0m[35m        tags=parsed_yaml_dict.get("tags_entry", []),[0m
[30;1m241 | [0m[35m        required_data_connectors=parsed_yaml_dict.get("requiredDataConnectors", {}),[0m
[30;1m242 | [0m[35m        query_frequency=parsed_yaml_dict.get("queryFrequency", ""),[0m
[30;1m243 | [0m[35m        query_period=parsed_yaml_dict.get("queryPeriod", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2246[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        name=parsed_yaml_dict.get("name"),[0m
[30;1m237 | [0m[35m        query_id=parsed_yaml_dict.get("id", ""),[0m
[30;1m238 | [0m[35m        description=parsed_yaml_dict.get("description", ""),[0m
[30;1m239 | [0m[35m        severity=parsed_yaml_dict.get("severity", ""),[0m
[30;1m240 | [0m[35m        tags=parsed_yaml_dict.get("tags_entry", []),[0m
[30;1m241 | [0m[35m        required_data_connectors=parsed_yaml_dict.get("requiredDataConnectors", {}),[0m
[30;1m242 | [0m[35m        query_frequency=parsed_yaml_dict.get("queryFrequency", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2247[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m    new_query = SentinelQuery([0m
[30;1m236 | [0m[35m        name=parsed_yaml_dict.get("name"),[0m
[30;1m237 | [0m[35m        query_id=parsed_yaml_dict.get("id", ""),[0m
[30;1m238 | [0m[35m        description=parsed_yaml_dict.get("description", ""),[0m
[30;1m239 | [0m[35m        severity=parsed_yaml_dict.get("severity", ""),[0m
[30;1m240 | [0m[35m        tags=parsed_yaml_dict.get("tags_entry", []),[0m
[30;1m241 | [0m[35m        required_data_connectors=parsed_yaml_dict.get("requiredDataConnectors", {}),[0m

[31m--[ [0m[34mMatch #[0m[33m2248[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m    new_query = SentinelQuery([0m
[30;1m236 | [0m[35m        name=parsed_yaml_dict.get("name"),[0m
[30;1m237 | [0m[35m        query_id=parsed_yaml_dict.get("id", ""),[0m
[30;1m238 | [0m[35m        description=parsed_yaml_dict.get("description", ""),[0m
[30;1m239 | [0m[35m        severity=parsed_yaml_dict.get("severity", ""),[0m
[30;1m240 | [0m[35m        tags=parsed_yaml_dict.get("tags_entry", []),[0m

[31m--[ [0m[34mMatch #[0m[33m2249[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m        return SentinelQuery()[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m    new_query = SentinelQuery([0m
[30;1m236 | [0m[35m        name=parsed_yaml_dict.get("name"),[0m
[30;1m237 | [0m[35m        query_id=parsed_yaml_dict.get("id", ""),[0m
[30;1m238 | [0m[35m        description=parsed_yaml_dict.get("description", ""),[0m
[30;1m239 | [0m[35m        severity=parsed_yaml_dict.get("severity", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m2250[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m            except TypeError as err:[0m
[30;1m400 | [0m[35m                logger.warning([0m
[30;1m401 | [0m[35m                    """Query name is most likely None at %s for[0m
[30;1m402 | [0m[35m                    current query %r""",[0m
[30;1m403 | [0m[35m                    source_folder,[0m
[30;1m404 | [0m[35m                    cur_query,[0m

[31m--[ [0m[34mMatch #[0m[33m2251[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m    """[0m
[30;1m323 | [0m[35m    dict_to_write = {"metadata": {}, "defaults": {}, "sources": {}}  # type: ignore[0m
[30;1m324 | [0m[35m    dict_to_write["metadata"]["version"] = 1  # write update version functionality[0m
[30;1m325 | [0m[35m    dict_to_write["metadata"]["description"] = "Sentinel Alert Queries - " + folder_name[0m
[30;1m326 | [0m[35m    dict_to_write["metadata"]["data_environments"] = [[0m
[30;1m327 | [0m[35m        "MSSentinel"[0m

[31m--[ [0m[34mMatch #[0m[33m2252[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sentinel_query_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m    Parameters[0m
[30;1m104 | [0m[35m    ----------[0m
[30;1m105 | [0m[35m    git_url : str, optional[0m
[30;1m106 | [0m[35m        URL of the GIT Repository to be downloaded, by default[0m
[30;1m107 | [0m[35m        "https://github.com/Azure/Azure-Sentinel/archive/master.zip"[0m
[30;1m108 | [0m[35m    outputdir : str, optional[0m
[30;1m109 | [0m[35m        Provide absolute path to the output folder to save downloaded archive[0m

[31m--[ [0m[34mMatch #[0m[33m2253[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/vis/ti_browser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m48 | [0m[35m    opts = get_ti_select_options(ti_data=data, severities=severities)[0m
[30;1m49 | [0m[35m    disp_func = ti_details_display(ti_data=data)[0m
[30;1m50 | [0m[35m    if not opts and not data.empty:[0m
[30;1m51 | [0m[35m        print("No results at TI Severities 'warning' or 'high'")[0m
[30;1m52 | [0m[35m        print("Displaying only 'information' severity items.")[0m
[30;1m53 | [0m[35m        opts = get_ti_select_options(ti_data=data, severities="all")[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2254[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/anomalous_sequence/utils/laplace_smooth.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m    cmd_param_counts_ls = copy.deepcopy(cmd_param_counts)[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    params: List[str] = list(param_counts.keys()) + [unk_token][0m
[30;1m93 | [0m[35m    for cmd in cmds:[0m
[30;1m94 | [0m[35m        for param in params:[0m
[30;1m95 | [0m[35m            if param in cmd_param_counts_ls[cmd] or param == unk_token:[0m
[30;1m96 | [0m[35m                param_counts_ls[param] += 1[0m

[31m--[ [0m[34mMatch #[0m[33m2255[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m445 | [0m[35m                return ws_config, name[0m
[30;1m446 | [0m[35m            if ws_config.get(self.CONF_WS_ID, "").casefold() == ws_name.casefold():[0m
[30;1m447 | [0m[35m                return ws_config, name[0m
[30;1m448 | [0m[35m            if ws_config.get(self.CONF_WS_NAME, "").casefold() == ws_name.casefold():[0m
[30;1m449 | [0m[35m                return ws_config, name[0m
[30;1m450 | [0m[35m        return {}, None[0m
[30;1m451 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2256[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m443 | [0m[35m        for name, ws_config in ws_configs.items():[0m
[30;1m444 | [0m[35m            if ws_name.casefold() == name.casefold():[0m
[30;1m445 | [0m[35m                return ws_config, name[0m
[30;1m446 | [0m[35m            if ws_config.get(self.CONF_WS_ID, "").casefold() == ws_name.casefold():[0m
[30;1m447 | [0m[35m                return ws_config, name[0m
[30;1m448 | [0m[35m            if ws_config.get(self.CONF_WS_NAME, "").casefold() == ws_name.casefold():[0m
[30;1m449 | [0m[35m                return ws_config, name[0m

[31m--[ [0m[34mMatch #[0m[33m2257[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m[0m
[30;1m421 | [0m[35m    def _read_pkg_config_values(self, workspace_name: Optional[str] = None):[0m
[30;1m422 | [0m[35m        """Try to find a usable config from the MSTICPy config file."""[0m
[30;1m423 | [0m[35m        ws_settings = get_config("AzureSentinel", {}).get("Workspaces")  # type: ignore[0m
[30;1m424 | [0m[35m        if not ws_settings:[0m
[30;1m425 | [0m[35m            return[0m
[30;1m426 | [0m[35m        selected_workspace: Dict[str, str] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m2258[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m            self["workspace_id"] = chg.get("new")[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m        def update_tnt(chg):[0m
[30;1m371 | [0m[35m            self["tenant_id"] = chg.get("new")[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m        ws_id_wgt.observe(update_ws, names="value")[0m
[30;1m374 | [0m[35m        ten_id_wgt.observe(update_tnt, names="value")[0m

[31m--[ [0m[34mMatch #[0m[33m2259[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m365 | [0m[35m        ten_id_wgt = widgets.Text(description="Tenant Id:", **WIDGET_DEFAULTS)[0m
[30;1m366 | [0m[35m[0m
[30;1m367 | [0m[35m        def update_ws(chg):[0m
[30;1m368 | [0m[35m            self["workspace_id"] = chg.get("new")[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m        def update_tnt(chg):[0m
[30;1m371 | [0m[35m            self["tenant_id"] = chg.get("new")[0m

[31m--[ [0m[34mMatch #[0m[33m2260[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m346 | [0m[35m            {[0m
[30;1m347 | [0m[35m                ws_name: {[0m
[30;1m348 | [0m[35m                    cls.CONF_WS_ID: ws.get(cls.CONF_WS_ID),[0m
[30;1m349 | [0m[35m                    cls.CONF_TENANT_ID: ws.get(cls.CONF_TENANT_ID),[0m
[30;1m350 | [0m[35m                }[0m
[30;1m351 | [0m[35m                for ws_name, ws in ws_settings.items()[0m
[30;1m352 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m2261[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m        return ([0m
[30;1m346 | [0m[35m            {[0m
[30;1m347 | [0m[35m                ws_name: {[0m
[30;1m348 | [0m[35m                    cls.CONF_WS_ID: ws.get(cls.CONF_WS_ID),[0m
[30;1m349 | [0m[35m                    cls.CONF_TENANT_ID: ws.get(cls.CONF_TENANT_ID),[0m
[30;1m350 | [0m[35m                }[0m
[30;1m351 | [0m[35m                for ws_name, ws in ws_settings.items()[0m

[31m--[ [0m[34mMatch #[0m[33m2262[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m            Dictionary of workspaces with workspace and tenantIds.[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m        """[0m
[30;1m344 | [0m[35m        ws_settings = get_config("AzureSentinel", {}).get("Workspaces")[0m
[30;1m345 | [0m[35m        return ([0m
[30;1m346 | [0m[35m            {[0m
[30;1m347 | [0m[35m                ws_name: {[0m

[31m--[ [0m[34mMatch #[0m[33m2263[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m                cls.CONF_SUB_ID: settings.get(cls.CONF_SUB_ID),  # type: ignore[0m
[30;1m277 | [0m[35m                cls.CONF_WS_ID: settings.get(cls.CONF_WS_ID),  # type: ignore[0m
[30;1m278 | [0m[35m                cls.CONF_TENANT_ID: settings.get(cls.CONF_TENANT_ID),  # type: ignore[0m
[30;1m279 | [0m[35m                cls.CONF_RES_GROUP: settings.get(cls.CONF_RES_GROUP),  # type: ignore[0m
[30;1m280 | [0m[35m            }[0m
[30;1m281 | [0m[35m        )[0m
[30;1m282 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2264[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m                cls.CONF_WS_NAME: settings.get(cls.CONF_WS_NAME),  # type: ignore[0m
[30;1m276 | [0m[35m                cls.CONF_SUB_ID: settings.get(cls.CONF_SUB_ID),  # type: ignore[0m
[30;1m277 | [0m[35m                cls.CONF_WS_ID: settings.get(cls.CONF_WS_ID),  # type: ignore[0m
[30;1m278 | [0m[35m                cls.CONF_TENANT_ID: settings.get(cls.CONF_TENANT_ID),  # type: ignore[0m
[30;1m279 | [0m[35m                cls.CONF_RES_GROUP: settings.get(cls.CONF_RES_GROUP),  # type: ignore[0m
[30;1m280 | [0m[35m            }[0m
[30;1m281 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2265[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m            config={  # type: ignore[0m
[30;1m275 | [0m[35m                cls.CONF_WS_NAME: settings.get(cls.CONF_WS_NAME),  # type: ignore[0m
[30;1m276 | [0m[35m                cls.CONF_SUB_ID: settings.get(cls.CONF_SUB_ID),  # type: ignore[0m
[30;1m277 | [0m[35m                cls.CONF_WS_ID: settings.get(cls.CONF_WS_ID),  # type: ignore[0m
[30;1m278 | [0m[35m                cls.CONF_TENANT_ID: settings.get(cls.CONF_TENANT_ID),  # type: ignore[0m
[30;1m279 | [0m[35m                cls.CONF_RES_GROUP: settings.get(cls.CONF_RES_GROUP),  # type: ignore[0m
[30;1m280 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m2266[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m        return cls([0m
[30;1m274 | [0m[35m            config={  # type: ignore[0m
[30;1m275 | [0m[35m                cls.CONF_WS_NAME: settings.get(cls.CONF_WS_NAME),  # type: ignore[0m
[30;1m276 | [0m[35m                cls.CONF_SUB_ID: settings.get(cls.CONF_SUB_ID),  # type: ignore[0m
[30;1m277 | [0m[35m                cls.CONF_WS_ID: settings.get(cls.CONF_WS_ID),  # type: ignore[0m
[30;1m278 | [0m[35m                cls.CONF_TENANT_ID: settings.get(cls.CONF_TENANT_ID),  # type: ignore[0m
[30;1m279 | [0m[35m                cls.CONF_RES_GROUP: settings.get(cls.CONF_RES_GROUP),  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m2267[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m        """Create a WorkstationConfig from MSTICPY Workspace settings."""[0m
[30;1m273 | [0m[35m        return cls([0m
[30;1m274 | [0m[35m            config={  # type: ignore[0m
[30;1m275 | [0m[35m                cls.CONF_WS_NAME: settings.get(cls.CONF_WS_NAME),  # type: ignore[0m
[30;1m276 | [0m[35m                cls.CONF_SUB_ID: settings.get(cls.CONF_SUB_ID),  # type: ignore[0m
[30;1m277 | [0m[35m                cls.CONF_WS_ID: settings.get(cls.CONF_WS_ID),  # type: ignore[0m
[30;1m278 | [0m[35m                cls.CONF_TENANT_ID: settings.get(cls.CONF_TENANT_ID),  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m2268[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m    @property[0m
[30;1m254 | [0m[35m    def args(self) -> Dict[str, str]:[0m
[30;1m255 | [0m[35m        """Return any additional arguments."""[0m
[30;1m256 | [0m[35m        return self._config.get(self.CONF_ARGS, {})[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    @property[0m
[30;1m259 | [0m[35m    def settings_path(self) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m2269[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m            self.CONF_WS_ID: self._config.get(self.CONF_WS_ID),[0m
[30;1m248 | [0m[35m            self.CONF_TENANT_ID: self._config.get(self.CONF_TENANT_ID),[0m
[30;1m249 | [0m[35m            self.CONF_RES_GROUP: self._config.get(self.CONF_RES_GROUP),[0m
[30;1m250 | [0m[35m            self.CONF_ARGS: self._config.get(self.CONF_ARGS),[0m
[30;1m251 | [0m[35m        }[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m2270[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m            self.CONF_SUB_ID: self._config.get(self.CONF_SUB_ID),[0m
[30;1m247 | [0m[35m            self.CONF_WS_ID: self._config.get(self.CONF_WS_ID),[0m
[30;1m248 | [0m[35m            self.CONF_TENANT_ID: self._config.get(self.CONF_TENANT_ID),[0m
[30;1m249 | [0m[35m            self.CONF_RES_GROUP: self._config.get(self.CONF_RES_GROUP),[0m
[30;1m250 | [0m[35m            self.CONF_ARGS: self._config.get(self.CONF_ARGS),[0m
[30;1m251 | [0m[35m        }[0m
[30;1m252 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2271[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m            self.CONF_WS_NAME: self._config.get(self.CONF_WS_NAME),[0m
[30;1m246 | [0m[35m            self.CONF_SUB_ID: self._config.get(self.CONF_SUB_ID),[0m
[30;1m247 | [0m[35m            self.CONF_WS_ID: self._config.get(self.CONF_WS_ID),[0m
[30;1m248 | [0m[35m            self.CONF_TENANT_ID: self._config.get(self.CONF_TENANT_ID),[0m
[30;1m249 | [0m[35m            self.CONF_RES_GROUP: self._config.get(self.CONF_RES_GROUP),[0m
[30;1m250 | [0m[35m            self.CONF_ARGS: self._config.get(self.CONF_ARGS),[0m
[30;1m251 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m2272[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m        return {[0m
[30;1m245 | [0m[35m            self.CONF_WS_NAME: self._config.get(self.CONF_WS_NAME),[0m
[30;1m246 | [0m[35m            self.CONF_SUB_ID: self._config.get(self.CONF_SUB_ID),[0m
[30;1m247 | [0m[35m            self.CONF_WS_ID: self._config.get(self.CONF_WS_ID),[0m
[30;1m248 | [0m[35m            self.CONF_TENANT_ID: self._config.get(self.CONF_TENANT_ID),[0m
[30;1m249 | [0m[35m            self.CONF_RES_GROUP: self._config.get(self.CONF_RES_GROUP),[0m
[30;1m250 | [0m[35m            self.CONF_ARGS: self._config.get(self.CONF_ARGS),[0m

[31m--[ [0m[34mMatch #[0m[33m2273[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m        """Return the equivalent MSTICPY settings dictionary."""[0m
[30;1m244 | [0m[35m        return {[0m
[30;1m245 | [0m[35m            self.CONF_WS_NAME: self._config.get(self.CONF_WS_NAME),[0m
[30;1m246 | [0m[35m            self.CONF_SUB_ID: self._config.get(self.CONF_SUB_ID),[0m
[30;1m247 | [0m[35m            self.CONF_WS_ID: self._config.get(self.CONF_WS_ID),[0m
[30;1m248 | [0m[35m            self.CONF_TENANT_ID: self._config.get(self.CONF_TENANT_ID),[0m
[30;1m249 | [0m[35m            self.CONF_RES_GROUP: self._config.get(self.CONF_RES_GROUP),[0m

[31m--[ [0m[34mMatch #[0m[33m2274[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m    def mp_settings(self):[0m
[30;1m243 | [0m[35m        """Return the equivalent MSTICPY settings dictionary."""[0m
[30;1m244 | [0m[35m        return {[0m
[30;1m245 | [0m[35m            self.CONF_WS_NAME: self._config.get(self.CONF_WS_NAME),[0m
[30;1m246 | [0m[35m            self.CONF_SUB_ID: self._config.get(self.CONF_SUB_ID),[0m
[30;1m247 | [0m[35m            self.CONF_WS_ID: self._config.get(self.CONF_WS_ID),[0m
[30;1m248 | [0m[35m            self.CONF_TENANT_ID: self._config.get(self.CONF_TENANT_ID),[0m

[31m--[ [0m[34mMatch #[0m[33m2275[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        """[0m
[30;1m213 | [0m[35m        ws_value = self._config.get(self.CONF_WS_ID, None)[0m
[30;1m214 | [0m[35m        ten_value = self._config.get(self.CONF_TENANT_ID, None)[0m
[30;1m215 | [0m[35m        return is_valid_uuid(ws_value) and is_valid_uuid(ten_value)  # type: ignore[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m2276[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m            True if configuration loaded.[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        """[0m
[30;1m213 | [0m[35m        ws_value = self._config.get(self.CONF_WS_ID, None)[0m
[30;1m214 | [0m[35m        ten_value = self._config.get(self.CONF_TENANT_ID, None)[0m
[30;1m215 | [0m[35m        return is_valid_uuid(ws_value) and is_valid_uuid(ten_value)  # type: ignore[0m
[30;1m216 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2277[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        return ([0m
[30;1m185 | [0m[35m            key == "Type"[0m
[30;1m186 | [0m[35m            or key in self._config[0m
[30;1m187 | [0m[35m            or self._CONFIG_TO_SETTINGS_NAME_MAP.get(key) in self._config[0m
[30;1m188 | [0m[35m            or key in self.__dict__[0m
[30;1m189 | [0m[35m        )[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2278[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m        if key in self._SETTINGS_TO_CONFIG_NAME_MAP:[0m
[30;1m172 | [0m[35m            return self._config.get(key)[0m
[30;1m173 | [0m[35m        if key in self._CONFIG_TO_SETTINGS_NAME_MAP:[0m
[30;1m174 | [0m[35m            return self._config.get(self._CONFIG_TO_SETTINGS_NAME_MAP[key])[0m
[30;1m175 | [0m[35m        raise KeyError(f"{self.__class__.__name__} has no attribute '{key}'")[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    def __setitem__(self, key: str, value: Any):[0m

[31m--[ [0m[34mMatch #[0m[33m2279[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m    def __getitem__(self, key: str):[0m
[30;1m170 | [0m[35m        """Allow property get using dictionary key syntax."""[0m
[30;1m171 | [0m[35m        if key in self._SETTINGS_TO_CONFIG_NAME_MAP:[0m
[30;1m172 | [0m[35m            return self._config.get(key)[0m
[30;1m173 | [0m[35m        if key in self._CONFIG_TO_SETTINGS_NAME_MAP:[0m
[30;1m174 | [0m[35m            return self._config.get(self._CONFIG_TO_SETTINGS_NAME_MAP[key])[0m
[30;1m175 | [0m[35m        raise KeyError(f"{self.__class__.__name__} has no attribute '{key}'")[0m

[31m--[ [0m[34mMatch #[0m[33m2280[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m419 | [0m[35m            )[0m
[30;1m420 | [0m[35m[0m
[30;1m421 | [0m[35m    def _read_pkg_config_values(self, workspace_name: Optional[str] = None):[0m
[30;1m422 | [0m[35m        """Try to find a usable config from the MSTICPy config file."""[0m
[30;1m423 | [0m[35m        ws_settings = get_config("AzureSentinel", {}).get("Workspaces")  # type: ignore[0m
[30;1m424 | [0m[35m        if not ws_settings:[0m
[30;1m425 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m2281[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m        ):[0m
[30;1m304 | [0m[35m            workspace_id = match.groupdict()["workspace_id"][0m
[30;1m305 | [0m[35m        else:[0m
[30;1m306 | [0m[35m            raise ValueError("Could not find workspace ID in connection string.")[0m
[30;1m307 | [0m[35m        if match := re.match(ws_name_regex, connection_str, re.IGNORECASE | re.VERBOSE):[0m
[30;1m308 | [0m[35m            workspace_name = match.groupdict()["workspace_name"][0m
[30;1m309 | [0m[35m        return cls([0m

[31m--[ [0m[34mMatch #[0m[33m2282[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m297 | [0m[35m        if match := re.match(tenant_regex, connection_str, re.IGNORECASE | re.VERBOSE):[0m
[30;1m298 | [0m[35m            tenant_id = match.groupdict()["tenant_id"][0m
[30;1m299 | [0m[35m        else:[0m
[30;1m300 | [0m[35m            raise ValueError("Could not find tenant ID in connection string.")[0m
[30;1m301 | [0m[35m        if match := re.match([0m
[30;1m302 | [0m[35m            workspace_regex, connection_str, re.IGNORECASE | re.VERBOSE[0m
[30;1m303 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m2283[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m][0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m_NO_CONFIG_ERR = [[0m
[30;1m56 | [0m[35m    "Could not find msticpyconfig.yaml or config.json.",[0m
[30;1m57 | [0m[35m    "The 'config.json' file is created when you launch notebooks from "[0m
[30;1m58 | [0m[35m    "Microsoft Sentinel. If you have copied the notebook to another location "[0m
[30;1m59 | [0m[35m    "or folder you will need to copy this configuration file.",[0m

[31m--[ [0m[34mMatch #[0m[33m2284[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/common/wsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m][0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m_NO_CONFIG_WARN = [[0m
[30;1m39 | [0m[35m    "Could not find Microsoft Sentinel settings in msticpyconfig.yaml or a config.json ",[0m
[30;1m40 | [0m[35m    "(in the current directory or via a MSTICPYCONFIG variable.)",[0m
[30;1m41 | [0m[35m    "We found the file '{config_file}' and will use this.",[0m
[30;1m42 | [0m[35m    "We recommend using an explicit msticpyconfig.yaml specified using the",[0m

[31m--[ [0m[34mMatch #[0m[33m2285[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/cloud_mappings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m289 | [0m[35m    @property[0m
[30;1m290 | [0m[35m    def resource_manager(self) -> str:[0m
[30;1m291 | [0m[35m        """Return the resource manager URI."""[0m
[30;1m292 | [0m[35m        return format_endpoint(self.endpoints.get("resourceManager"))  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m2286[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/cloud_mappings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m    def log_analytics_uri(self) -> str:[0m
[30;1m284 | [0m[35m        """Return the AAD authority URI."""[0m
[30;1m285 | [0m[35m        return format_endpoint([0m
[30;1m286 | [0m[35m            self.endpoints.get("logAnalyticsResourceId")  # type: ignore[0m
[30;1m287 | [0m[35m        )[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m2287[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/cloud_mappings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m    def authority_uri(self) -> str:[0m
[30;1m277 | [0m[35m        """Return the AAD authority URI."""[0m
[30;1m278 | [0m[35m        return format_endpoint([0m
[30;1m279 | [0m[35m            self.endpoints.get("authentication", {}).get("loginEndpoint")[0m
[30;1m280 | [0m[35m        )[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m2288[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/cloud_mappings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m    def authority_uri(self) -> str:[0m
[30;1m277 | [0m[35m        """Return the AAD authority URI."""[0m
[30;1m278 | [0m[35m        return format_endpoint([0m
[30;1m279 | [0m[35m            self.endpoints.get("authentication", {}).get("loginEndpoint")[0m
[30;1m280 | [0m[35m        )[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m2289[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/cloud_mappings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m            If the cloud name is not valid.[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        """[0m
[30;1m266 | [0m[35m        return self.endpoints.get("suffixes", {})[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m    @property[0m
[30;1m269 | [0m[35m    def token_uri(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m2290[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/cloud_mappings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    f_resource_manager_url = format_endpoint(resource_manager_url)[0m
[30;1m145 | [0m[35m    endpoint_url = f"{f_resource_manager_url}metadata/endpoints?api-version=latest"[0m
[30;1m146 | [0m[35m    try:[0m
[30;1m147 | [0m[35m        resp = httpx.get(endpoint_url, timeout=get_http_timeout())[0m
[30;1m148 | [0m[35m        if resp.status_code == 200:[0m
[30;1m149 | [0m[35m            return resp.json()[0m
[30;1m150 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2291[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/cloud_mappings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        Contains endpoints and suffixes for a specific cloud.[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    """[0m
[30;1m121 | [0m[35m    resource_manager_url = CLOUD_MAPPING.get(CLOUD_ALIASES.get(cloud, "global"))[0m
[30;1m122 | [0m[35m    return get_cloud_endpoints_by_resource_manager_url(resource_manager_url)  # type: ignore[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2292[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/cloud_mappings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        Contains endpoints and suffixes for a specific cloud.[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    """[0m
[30;1m121 | [0m[35m    resource_manager_url = CLOUD_MAPPING.get(CLOUD_ALIASES.get(cloud, "global"))[0m
[30;1m122 | [0m[35m    return get_cloud_endpoints_by_resource_manager_url(resource_manager_url)  # type: ignore[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2293[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m    def _get_config_settings(prov_name) -> Dict[Any, Any]:[0m
[30;1m298 | [0m[35m        """Get config from msticpyconfig."""[0m
[30;1m299 | [0m[35m        data_provs = get_provider_settings(config_section="DataProviders")[0m
[30;1m300 | [0m[35m        splunk_settings: Optional[ProviderSettings] = data_provs.get(prov_name)[0m
[30;1m301 | [0m[35m        return getattr(splunk_settings, "args", {})[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m2294[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m            ),[0m
[30;1m100 | [0m[35m        )[0m
[30;1m101 | [0m[35m        self.set_driver_property(DriverProps.SUPPORTS_THREADING, False)[0m
[30;1m102 | [0m[35m        self.set_driver_property(DriverProps.MAX_PARALLEL, kwargs.get("max_threads", 4))[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    def __getattr__(self, attrib):[0m
[30;1m105 | [0m[35m        """Return item from the properties dictionary as an attribute."""[0m

[31m--[ [0m[34mMatch #[0m[33m2295[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        # self.use_query_paths = True[0m
[30;1m86 | [0m[35m        # self.has_driver_queries = False[0m
[30;1m87 | [0m[35m        self._previous_connection = False[0m
[30;1m88 | [0m[35m        self.data_environment = kwargs.get("data_environment")[0m
[30;1m89 | [0m[35m        self._query_filter: Dict[str, Set[str]] = defaultdict(set)[0m
[30;1m90 | [0m[35m        self._instance: Optional[str] = None[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2296[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m138 | [0m[35m        -----[0m
[30;1m139 | [0m[35m        This does not guarantee that the last data source[0m
[30;1m140 | [0m[35m        connection was successful. It is a best effort to track[0m
[30;1m141 | [0m[35m        whether the provider has made at least one successful[0m
[30;1m142 | [0m[35m        authentication.[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2297[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m127 | [0m[35m    @property[0m
[30;1m128 | [0m[35m    def connected(self) -> bool:[0m
[30;1m129 | [0m[35m        """[0m
[30;1m130 | [0m[35m        Return true if at least one connection has been made.[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        Returns[0m
[30;1m133 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m2298[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m    @staticmethod[0m
[30;1m312 | [0m[35m    def get_http_timeout(**kwargs):[0m
[30;1m313 | [0m[35m        """Get http timeout from settings or kwargs."""[0m
[30;1m314 | [0m[35m        return get_http_timeout(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m2299[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m    @property[0m
[30;1m246 | [0m[35m    def driver_queries(self) -> Iterable[Dict[str, Any]]:[0m
[30;1m247 | [0m[35m        """[0m
[30;1m248 | [0m[35m        Return queries retrieved from the service after connecting.[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        Returns[0m
[30;1m251 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m2300[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/driver_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m    @property[0m
[30;1m232 | [0m[35m    def service_queries(self) -> Tuple[Dict[str, str], str]:[0m
[30;1m233 | [0m[35m        """[0m
[30;1m234 | [0m[35m        Return queries retrieved from the service after connecting.[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        Returns[0m
[30;1m237 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m2301[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m920 | [0m[35m                return tech_df, tactics_df[0m
[30;1m921 | [0m[35m            except pickle.PickleError:[0m
[30;1m922 | [0m[35m                pass[0m
[30;1m923 | [0m[35m    resp = httpx.get(_MITRE_JSON_URL, timeout=_HTTP_TIMEOUT, headers=mp_ua_header())[0m
[30;1m924 | [0m[35m    mitre = pd.json_normalize(resp.json()["objects"])[0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m    # remove deprecated items[0m

[31m--[ [0m[34mMatch #[0m[33m2302[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m644 | [0m[35m                continue[0m
[30;1m645 | [0m[35m            metadata_doc[_LAST_UPDATE_KEY] = pd.Timestamp.utcnow().isoformat()[0m
[30;1m646 | [0m[35m            md_cached_metadata[filename] = metadata_doc[0m
[30;1m647 | [0m[35m        doc_id = metadata_doc.get("id")[0m
[30;1m648 | [0m[35m        mdr_entry = metadata_doc.copy()[0m
[30;1m649 | [0m[35m        mdr_entry.pop(_LAST_UPDATE_KEY, None)[0m
[30;1m650 | [0m[35m        md_metadata[doc_id] = MordorEntry(**mdr_entry)[0m

[31m--[ [0m[34mMatch #[0m[33m2303[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m632 | [0m[35m        if filename in md_cached_metadata:[0m
[30;1m633 | [0m[35m            metadata_doc = md_cached_metadata[filename][0m
[30;1m634 | [0m[35m            last_timestamp = pd.Timestamp([0m
[30;1m635 | [0m[35m                metadata_doc.get(_LAST_UPDATE_KEY, _DEFAULT_TS)[0m
[30;1m636 | [0m[35m            )[0m
[30;1m637 | [0m[35m            cache_valid = (pd.Timestamp.utcnow() - last_timestamp).days < 30[0m
[30;1m638 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2304[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m578 | [0m[35m    file_blob_uri = ([0m
[30;1m579 | [0m[35m        f"https://raw.githubusercontent.com/OTRF/Security-Datasets/master/{gh_file}"[0m
[30;1m580 | [0m[35m    )[0m
[30;1m581 | [0m[35m    file_resp = httpx.get(file_blob_uri, timeout=_HTTP_TIMEOUT, headers=mp_ua_header())[0m
[30;1m582 | [0m[35m    return file_resp.content[0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2305[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m562 | [0m[35m    def _get_mdr_tree(uri):[0m
[30;1m563 | [0m[35m        nonlocal mordor_tree[0m
[30;1m564 | [0m[35m        if mordor_tree is None:[0m
[30;1m565 | [0m[35m            resp = httpx.get(uri, timeout=_HTTP_TIMEOUT, headers=mp_ua_header())[0m
[30;1m566 | [0m[35m            mordor_tree = resp.json()[0m
[30;1m567 | [0m[35m        return mordor_tree[0m
[30;1m568 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2306[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m548 | [0m[35m    md_tree = _GET_MORDOR_TREE(_MORDOR_TREE_URI)[0m
[30;1m549 | [0m[35m    yield from ([0m
[30;1m550 | [0m[35m        t_item["path"][0m
[30;1m551 | [0m[35m        for t_item in md_tree.get("tree")[0m
[30;1m552 | [0m[35m        if t_item["type"] == "blob"[0m
[30;1m553 | [0m[35m        and t_item["path"].startswith("datasets")[0m
[30;1m554 | [0m[35m        and item_type in t_item["path"][0m

[31m--[ [0m[34mMatch #[0m[33m2307[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m                )[0m
[30;1m518 | [0m[35m                self._rel_file_paths.append([0m
[30;1m519 | [0m[35m                    {[0m
[30;1m520 | [0m[35m                        "file_type": file.get("type"),[0m
[30;1m521 | [0m[35m                        "file_path": f_path,[0m
[30;1m522 | [0m[35m                        "relative_path": f_rel_path,[0m
[30;1m523 | [0m[35m                        "qry_path": query_path,[0m

[31m--[ [0m[34mMatch #[0m[33m2308[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m        """[0m
[30;1m509 | [0m[35m        if not self._rel_file_paths:[0m
[30;1m510 | [0m[35m            for file in self.files:[0m
[30;1m511 | [0m[35m                f_path = file.get("link")[0m
[30;1m512 | [0m[35m                if not f_path:[0m
[30;1m513 | [0m[35m                    continue[0m
[30;1m514 | [0m[35m                f_rel_path = f_path.replace(DS_PREFIX, "")[0m

[31m--[ [0m[34mMatch #[0m[33m2309[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m        """[0m
[30;1m477 | [0m[35m        return [[0m
[30;1m478 | [0m[35m            (nbk.get("name", ""), nbk.get("project", ""), nbk.get("link", ""))[0m
[30;1m479 | [0m[35m            for nbk in self.notebooks[0m
[30;1m480 | [0m[35m        ][0m
[30;1m481 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2310[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m        """[0m
[30;1m477 | [0m[35m        return [[0m
[30;1m478 | [0m[35m            (nbk.get("name", ""), nbk.get("project", ""), nbk.get("link", ""))[0m
[30;1m479 | [0m[35m            for nbk in self.notebooks[0m
[30;1m480 | [0m[35m        ][0m
[30;1m481 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2311[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m        """[0m
[30;1m477 | [0m[35m        return [[0m
[30;1m478 | [0m[35m            (nbk.get("name", ""), nbk.get("project", ""), nbk.get("link", ""))[0m
[30;1m479 | [0m[35m            for nbk in self.notebooks[0m
[30;1m480 | [0m[35m        ][0m
[30;1m481 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2312[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m            )[0m
[30;1m313 | [0m[35m        self.technique = attack.get("technique") if attack else technique[0m
[30;1m314 | [0m[35m        self.sub_technique = attack.get("sub-technique") if attack else sub_technique[0m
[30;1m315 | [0m[35m        self.tactics = attack.get("tactics") if attack else tactics  # type: ignore[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m        self._technique_name = None[0m
[30;1m318 | [0m[35m        self._technique_desc = None[0m

[31m--[ [0m[34mMatch #[0m[33m2313[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m                "Either 'attack' or 'technique' and 'tactics' must be specified."[0m
[30;1m312 | [0m[35m            )[0m
[30;1m313 | [0m[35m        self.technique = attack.get("technique") if attack else technique[0m
[30;1m314 | [0m[35m        self.sub_technique = attack.get("sub-technique") if attack else sub_technique[0m
[30;1m315 | [0m[35m        self.tactics = attack.get("tactics") if attack else tactics  # type: ignore[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m        self._technique_name = None[0m

[31m--[ [0m[34mMatch #[0m[33m2314[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m310 | [0m[35m            raise TypeError([0m
[30;1m311 | [0m[35m                "Either 'attack' or 'technique' and 'tactics' must be specified."[0m
[30;1m312 | [0m[35m            )[0m
[30;1m313 | [0m[35m        self.technique = attack.get("technique") if attack else technique[0m
[30;1m314 | [0m[35m        self.sub_technique = attack.get("sub-technique") if attack else sub_technique[0m
[30;1m315 | [0m[35m        self.tactics = attack.get("tactics") if attack else tactics  # type: ignore[0m
[30;1m316 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2315[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m            "used_cached", mdr_settings.get("used_cached", True)[0m
[30;1m73 | [0m[35m        )[0m
[30;1m74 | [0m[35m        self.save_folder = kwargs.pop([0m
[30;1m75 | [0m[35m            "save_folder", mdr_settings.get("save_folder", ".")[0m
[30;1m76 | [0m[35m        )[0m
[30;1m77 | [0m[35m        self.save_folder = _resolve_cache_folder(self.save_folder)[0m
[30;1m78 | [0m[35m        self.silent = kwargs.pop("silent", False)[0m

[31m--[ [0m[34mMatch #[0m[33m2316[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/mordor_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        mdr_settings = get_config("DataProviders.Mordor", {})[0m
[30;1m71 | [0m[35m        self.use_cached = kwargs.pop([0m
[30;1m72 | [0m[35m            "used_cached", mdr_settings.get("used_cached", True)[0m
[30;1m73 | [0m[35m        )[0m
[30;1m74 | [0m[35m        self.save_folder = kwargs.pop([0m
[30;1m75 | [0m[35m            "save_folder", mdr_settings.get("save_folder", ".")[0m

[31m--[ [0m[34mMatch #[0m[33m2317[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m    if settings.get("Connect"):[0m
[30;1m204 | [0m[35m        print(f"Connecting to {name}")[0m
[30;1m205 | [0m[35m        try:[0m
[30;1m206 | [0m[35m            connect_args = settings.get("ConnectArgs", {})[0m
[30;1m207 | [0m[35m            if connect_args is None:[0m
[30;1m208 | [0m[35m                connect_args = {}[0m
[30;1m209 | [0m[35m            instance.connect(**connect_args)[0m

[31m--[ [0m[34mMatch #[0m[33m2318[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m        logger.exception("Failed to initialize %s", name, exc_info=True)[0m
[30;1m201 | [0m[35m        return None[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    if settings.get("Connect"):[0m
[30;1m204 | [0m[35m        print(f"Connecting to {name}")[0m
[30;1m205 | [0m[35m        try:[0m
[30;1m206 | [0m[35m            connect_args = settings.get("ConnectArgs", {})[0m

[31m--[ [0m[34mMatch #[0m[33m2319[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m        init_args = settings.get("InitArgs", {})[0m
[30;1m192 | [0m[35m        if init_args is None:[0m
[30;1m193 | [0m[35m            init_args = {}[0m
[30;1m194 | [0m[35m        if data_env := settings.get("DataEnvironment"):[0m
[30;1m195 | [0m[35m            init_args["data_environment"] = data_env[0m
[30;1m196 | [0m[35m        instance = cls(**init_args)[0m
[30;1m197 | [0m[35m        logger.info("Initialized %s", name)[0m

[31m--[ [0m[34mMatch #[0m[33m2320[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    """[0m
[30;1m190 | [0m[35m    try:[0m
[30;1m191 | [0m[35m        init_args = settings.get("InitArgs", {})[0m
[30;1m192 | [0m[35m        if init_args is None:[0m
[30;1m193 | [0m[35m            init_args = {}[0m
[30;1m194 | [0m[35m        if data_env := settings.get("DataEnvironment"):[0m

[31m--[ [0m[34mMatch #[0m[33m2321[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m    logger.info("Loading %d components", len(user_config.get("QueryProviders", {})))[0m
[30;1m163 | [0m[35m    for comp_name, comp_settings in user_config.get("Components", {}).items():[0m
[30;1m164 | [0m[35m        module = importlib.import_module(comp_settings.get("Module"), package="msticpy")[0m
[30;1m165 | [0m[35m        comp_class = getattr(module, comp_settings.get("Class"))[0m
[30;1m166 | [0m[35m        comp_instance = _initialize_component(comp_name, comp_settings, comp_class)[0m
[30;1m167 | [0m[35m        if comp_instance:[0m
[30;1m168 | [0m[35m            namespace[comp_name] = comp_instance[0m

[31m--[ [0m[34mMatch #[0m[33m2322[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m    """[0m
[30;1m162 | [0m[35m    logger.info("Loading %d components", len(user_config.get("QueryProviders", {})))[0m
[30;1m163 | [0m[35m    for comp_name, comp_settings in user_config.get("Components", {}).items():[0m
[30;1m164 | [0m[35m        module = importlib.import_module(comp_settings.get("Module"), package="msticpy")[0m
[30;1m165 | [0m[35m        comp_class = getattr(module, comp_settings.get("Class"))[0m
[30;1m166 | [0m[35m        comp_instance = _initialize_component(comp_name, comp_settings, comp_class)[0m
[30;1m167 | [0m[35m        if comp_instance:[0m

[31m--[ [0m[34mMatch #[0m[33m2323[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    """[0m
[30;1m162 | [0m[35m    logger.info("Loading %d components", len(user_config.get("QueryProviders", {})))[0m
[30;1m163 | [0m[35m    for comp_name, comp_settings in user_config.get("Components", {}).items():[0m
[30;1m164 | [0m[35m        module = importlib.import_module(comp_settings.get("Module"), package="msticpy")[0m
[30;1m165 | [0m[35m        comp_class = getattr(module, comp_settings.get("Class"))[0m
[30;1m166 | [0m[35m        comp_instance = _initialize_component(comp_name, comp_settings, comp_class)[0m

[31m--[ [0m[34mMatch #[0m[33m2324[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m        The namespace to load the component instances into.[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    """[0m
[30;1m162 | [0m[35m    logger.info("Loading %d components", len(user_config.get("QueryProviders", {})))[0m
[30;1m163 | [0m[35m    for comp_name, comp_settings in user_config.get("Components", {}).items():[0m
[30;1m164 | [0m[35m        module = importlib.import_module(comp_settings.get("Module"), package="msticpy")[0m
[30;1m165 | [0m[35m        comp_class = getattr(module, comp_settings.get("Class"))[0m

[31m--[ [0m[34mMatch #[0m[33m2325[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m    logger.info([0m
[30;1m138 | [0m[35m        "Loading %d query providers", len(user_config.get("QueryProviders", {}))[0m
[30;1m139 | [0m[35m    )[0m
[30;1m140 | [0m[35m    for qry_prov_name, qry_prov_settings in user_config.get([0m
[30;1m141 | [0m[35m        "QueryProviders", {}[0m
[30;1m142 | [0m[35m    ).items():[0m
[30;1m143 | [0m[35m        qry_prov = _initialize_component([0m

[31m--[ [0m[34mMatch #[0m[33m2326[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/mp_user_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    """[0m
[30;1m137 | [0m[35m    logger.info([0m
[30;1m138 | [0m[35m        "Loading %d query providers", len(user_config.get("QueryProviders", {}))[0m
[30;1m139 | [0m[35m    )[0m
[30;1m140 | [0m[35m    for qry_prov_name, qry_prov_settings in user_config.get([0m
[30;1m141 | [0m[35m        "QueryProviders", {}[0m

[31m--[ [0m[34mMatch #[0m[33m2327[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/resource_graph_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        result_truncated = False[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        top = kwargs.get("top", 1000)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        request_options = QueryRequestOptions([0m
[30;1m164 | [0m[35m            top=top,[0m

[31m--[ [0m[34mMatch #[0m[33m2328[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/resource_graph_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m        """[0m
[30;1m78 | [0m[35m        auth_methods = kwargs.get("auth_methods")[0m
[30;1m79 | [0m[35m        auth_methods = auth_methods or self.az_cloud_config.auth_methods[0m
[30;1m80 | [0m[35m        silent = kwargs.get("silent", True)[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        credentials = az_connect(auth_methods=auth_methods, silent=silent)[0m
[30;1m83 | [0m[35m        if only_interactive_cred(credentials.modern):[0m

[31m--[ [0m[34mMatch #[0m[33m2329[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/resource_graph_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        section of msticpyconfig.yaml, if available.[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m        """[0m
[30;1m78 | [0m[35m        auth_methods = kwargs.get("auth_methods")[0m
[30;1m79 | [0m[35m        auth_methods = auth_methods or self.az_cloud_config.auth_methods[0m
[30;1m80 | [0m[35m        silent = kwargs.get("silent", True)[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2330[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/resource_graph_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        self.subscription_ids = None[0m
[30;1m54 | [0m[35m        self._connected = False[0m
[30;1m55 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m56 | [0m[35m        self.az_cloud_config = AzureCloudConfig(cloud=kwargs.get("cloud"))[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    def connect(self, connection_str: str = None, **kwargs):[0m
[30;1m59 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2331[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/resource_graph_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m        self.sub_client = None[0m
[30;1m53 | [0m[35m        self.subscription_ids = None[0m
[30;1m54 | [0m[35m        self._connected = False[0m
[30;1m55 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m56 | [0m[35m        self.az_cloud_config = AzureCloudConfig(cloud=kwargs.get("cloud"))[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    def connect(self, connection_str: str = None, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m2332[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/resource_graph_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m179 | [0m[35m        if response.result_truncated == ResultTruncated.true:[0m
[30;1m180 | [0m[35m            result_truncated = True[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m        if result_truncated and top is not None and len(response.data) < top:[0m
[30;1m183 | [0m[35m            warnings.warn([0m
[30;1m184 | [0m[35m                "Unable to paginate the results of the query. "[0m
[30;1m185 | [0m[35m                "Some resources may be missing from the results. "[0m

[31m--[ [0m[34mMatch #[0m[33m2333[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/resource_graph_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        result_truncated = False[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        top = kwargs.get("top", 1000)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        request_options = QueryRequestOptions([0m
[30;1m164 | [0m[35m            top=top,[0m

[31m--[ [0m[34mMatch #[0m[33m2334[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/get_environment_key.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m            Whether to display on instantiation (the default is False)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        """[0m
[30;1m56 | [0m[35m        env_val = os.environ.get(env_var)[0m
[30;1m57 | [0m[35m        self._name = env_var[0m
[30;1m58 | [0m[35m        self._value = ""[0m
[30;1m59 | [0m[35m        description = kwargs.pop("prompt", description)[0m

[31m--[ [0m[34mMatch #[0m[33m2335[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m            If tenant is not defined.[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m        """[0m
[30;1m207 | [0m[35m        tenant = tenant or self.get("tenantid") or self.az_cloud_config.tenant_id[0m
[30;1m208 | [0m[35m        if not tenant:[0m
[30;1m209 | [0m[35m            raise MsticpyKeyVaultConfigError([0m
[30;1m210 | [0m[35m                "Could not get TenantId from function parameters or configuration.",[0m

[31m--[ [0m[34mMatch #[0m[33m2336[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        """[0m
[30;1m168 | [0m[35m        auth = authority_uri or self.authority_uri.strip()[0m
[30;1m169 | [0m[35m        tenant = tenant or self.get("tenantid") or self.az_cloud_config.tenant_id[0m
[30;1m170 | [0m[35m        if not tenant:[0m
[30;1m171 | [0m[35m            raise MsticpyKeyVaultConfigError([0m
[30;1m172 | [0m[35m                "Could not get TenantId from function parameters or configuration.",[0m

[31m--[ [0m[34mMatch #[0m[33m2337[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m    @property[0m
[30;1m123 | [0m[35m    def keyvault_uri(self) -> Optional[str]:[0m
[30;1m124 | [0m[35m        """Return KeyVault URI template for current cloud."""[0m
[30;1m125 | [0m[35m        suffix = self.az_cloud_config.suffixes.get("keyVaultDns")[0m
[30;1m126 | [0m[35m        kv_uri = f"https://{{vault}}.{suffix}"[0m
[30;1m127 | [0m[35m        if not kv_uri:[0m
[30;1m128 | [0m[35m            mssg = f"Could not find a valid KeyVault endpoint for {self.cloud}"[0m

[31m--[ [0m[34mMatch #[0m[33m2338[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m    @property[0m
[30;1m103 | [0m[35m    def cloud(self) -> str:[0m
[30;1m104 | [0m[35m        """Return the cloud for the settings."""[0m
[30;1m105 | [0m[35m        return self.get("authority", "global").casefold()[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    @property[0m
[30;1m108 | [0m[35m    def authority_uri(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m2339[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def get(self, key: str, default: Any = None) -> Any:[0m
[30;1m99 | [0m[35m        """Return dict value or default."""[0m
[30;1m100 | [0m[35m        return self.__dict__.get(key.casefold(), default)[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    @property[0m
[30;1m103 | [0m[35m    def cloud(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m2340[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_settings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m        """Return Azure management URI template for current cloud."""[0m
[30;1m135 | [0m[35m        mgmt_uri = self.az_cloud_config.resource_manager[0m
[30;1m136 | [0m[35m        if not mgmt_uri:[0m
[30;1m137 | [0m[35m            mssg = f"Could not find a valid KeyVault endpoint for {self.cloud}"[0m
[30;1m138 | [0m[35m            warnings.warn(mssg)[0m
[30;1m139 | [0m[35m        return mgmt_uri[0m
[30;1m140 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2341[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/auth/keyvault_settings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m        suffix = self.az_cloud_config.suffixes.get("keyVaultDns")[0m
[30;1m126 | [0m[35m        kv_uri = f"https://{{vault}}.{suffix}"[0m
[30;1m127 | [0m[35m        if not kv_uri:[0m
[30;1m128 | [0m[35m            mssg = f"Could not find a valid KeyVault endpoint for {self.cloud}"[0m
[30;1m129 | [0m[35m            warnings.warn(mssg)[0m
[30;1m130 | [0m[35m        return kv_uri[0m
[30;1m131 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2342[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m570 | [0m[35m            is_instance_name = True[0m
[30;1m571 | [0m[35m        else:[0m
[30;1m572 | [0m[35m            # otherwise get the default Sumologic entry[0m
[30;1m573 | [0m[35m            sumologic_settings = sl_settings.get("Sumologic")[0m
[30;1m574 | [0m[35m            is_instance_name = False[0m
[30;1m575 | [0m[35m        return getattr(sumologic_settings, "args", {}), is_instance_name[0m

[31m--[ [0m[34mMatch #[0m[33m2343[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m        }[0m
[30;1m566 | [0m[35m        sumologic_settings: Optional[ProviderSettings][0m
[30;1m567 | [0m[35m        # Check if the connection string is an instance name[0m
[30;1m568 | [0m[35m        sumologic_settings = sl_settings.get(f"Sumologic-{instance_name}")[0m
[30;1m569 | [0m[35m        if sumologic_settings:[0m
[30;1m570 | [0m[35m            is_instance_name = True[0m
[30;1m571 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m2344[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m        """[0m
[30;1m476 | [0m[35m        limit = kwargs.get("limit", None)[0m
[30;1m477 | [0m[35m        verbosity = kwargs.get("verbosity", 0)[0m
[30;1m478 | [0m[35m        normalize = kwargs.pop("normalize", True)[0m
[30;1m479 | [0m[35m        exporting = kwargs.pop("exporting", False)[0m
[30;1m480 | [0m[35m        export_path = kwargs.pop("export_path", "")[0m

[31m--[ [0m[34mMatch #[0m[33m2345[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m            or query response if an error.[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m        """[0m
[30;1m476 | [0m[35m        limit = kwargs.get("limit", None)[0m
[30;1m477 | [0m[35m        verbosity = kwargs.get("verbosity", 0)[0m
[30;1m478 | [0m[35m        normalize = kwargs.pop("normalize", True)[0m
[30;1m479 | [0m[35m        exporting = kwargs.pop("exporting", False)[0m

[31m--[ [0m[34mMatch #[0m[33m2346[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m        self.service = None[0m
[30;1m66 | [0m[35m        self._loaded = True[0m
[30;1m67 | [0m[35m        self._connected = False[0m
[30;1m68 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m69 | [0m[35m        self.set_driver_property(DriverProps.PUBLIC_ATTRS, {"client": self.service})[0m
[30;1m70 | [0m[35m        self.set_driver_property([0m
[30;1m71 | [0m[35m            DriverProps.FORMATTERS, {"datetime": self._format_datetime}[0m

[31m--[ [0m[34mMatch #[0m[33m2347[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m518 | [0m[35m        if exporting:[0m
[30;1m519 | [0m[35m            if export_path.endswith(".xlsx"):[0m
[30;1m520 | [0m[35m                if verbosity >= 2:[0m
[30;1m521 | [0m[35m                    print(f"DEBUG: Exporting results to excel file {export_path}")[0m
[30;1m522 | [0m[35m                dataframe_res.to_excel(export_path, index=False)[0m
[30;1m523 | [0m[35m            elif export_path.endswith(".csv"):[0m
[30;1m524 | [0m[35m                if verbosity >= 2:[0m

[31m--[ [0m[34mMatch #[0m[33m2348[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m444 | [0m[35m        timeZone : str[0m
[30;1m445 | [0m[35m            timezone used for time range search[0m
[30;1m446 | [0m[35m        byReceiptTime : datetime[0m
[30;1m447 | [0m[35m            if time reference should used _receiptTime (time when Sumologic[0m
[30;1m448 | [0m[35m            got message) instead of _messageTime (time present in log message).[0m
[30;1m449 | [0m[35m        limit : int[0m
[30;1m450 | [0m[35m            An integer describing the max number of search results to return.[0m

[31m--[ [0m[34mMatch #[0m[33m2349[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m442 | [0m[35m        end_time : datetime[0m
[30;1m443 | [0m[35m            alias for `end`[0m
[30;1m444 | [0m[35m        timeZone : str[0m
[30;1m445 | [0m[35m            timezone used for time range search[0m
[30;1m446 | [0m[35m        byReceiptTime : datetime[0m
[30;1m447 | [0m[35m            if time reference should used _receiptTime (time when Sumologic[0m
[30;1m448 | [0m[35m            got message) instead of _messageTime (time present in log message).[0m

[31m--[ [0m[34mMatch #[0m[33m2350[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m438 | [0m[35m        end : datetime[0m
[30;1m439 | [0m[35m            A datetime() object representing the end of the search window.[0m
[30;1m440 | [0m[35m            If used without start_time, the search start will be the earliest[0m
[30;1m441 | [0m[35m            time in the index.[0m
[30;1m442 | [0m[35m        end_time : datetime[0m
[30;1m443 | [0m[35m            alias for `end`[0m
[30;1m444 | [0m[35m        timeZone : str[0m

[31m--[ [0m[34mMatch #[0m[33m2351[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m            else:[0m
[30;1m289 | [0m[35m                print([0m
[30;1m290 | [0m[35m                    f"WARN: wait more than timeout {self.timeout}. stopping. "[0m
[30;1m291 | [0m[35m                    + "Use timeout argument to wait longer."[0m
[30;1m292 | [0m[35m                )[0m
[30;1m293 | [0m[35m                break[0m
[30;1m294 | [0m[35m        return status[0m

[31m--[ [0m[34mMatch #[0m[33m2352[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m287 | [0m[35m                time_counter += self.checkinterval[0m
[30;1m288 | [0m[35m            else:[0m
[30;1m289 | [0m[35m                print([0m
[30;1m290 | [0m[35m                    f"WARN: wait more than timeout {self.timeout}. stopping. "[0m
[30;1m291 | [0m[35m                    + "Use timeout argument to wait longer."[0m
[30;1m292 | [0m[35m                )[0m
[30;1m293 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m2353[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m        checkinterval : int[0m
[30;1m204 | [0m[35m            interval in seconds to check if results are gathered[0m
[30;1m205 | [0m[35m        timeout : int[0m
[30;1m206 | [0m[35m            timeout in seconds when gathering results[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        Returns[0m
[30;1m209 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m2354[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m            Provide more verbose state. from 0 least verbose to 4 most one.[0m
[30;1m203 | [0m[35m        checkinterval : int[0m
[30;1m204 | [0m[35m            interval in seconds to check if results are gathered[0m
[30;1m205 | [0m[35m        timeout : int[0m
[30;1m206 | [0m[35m            timeout in seconds when gathering results[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        Returns[0m

[31m--[ [0m[34mMatch #[0m[33m2355[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m192 | [0m[35m        timezone : str[0m
[30;1m193 | [0m[35m            timezone used for time range search[0m
[30;1m194 | [0m[35m        byreceipttime : datetime[0m
[30;1m195 | [0m[35m            if time reference should used _receiptTime (time when Sumologic[0m
[30;1m196 | [0m[35m            got message) instead of _messageTime (time present in log message).[0m
[30;1m197 | [0m[35m        limit : int[0m
[30;1m198 | [0m[35m            An integer describing the max number of search results to return.[0m

[31m--[ [0m[34mMatch #[0m[33m2356[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m        end_time:[0m
[30;1m191 | [0m[35m            alias for `end`[0m
[30;1m192 | [0m[35m        timezone : str[0m
[30;1m193 | [0m[35m            timezone used for time range search[0m
[30;1m194 | [0m[35m        byreceipttime : datetime[0m
[30;1m195 | [0m[35m            if time reference should used _receiptTime (time when Sumologic[0m
[30;1m196 | [0m[35m            got message) instead of _messageTime (time present in log message).[0m

[31m--[ [0m[34mMatch #[0m[33m2357[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m        end : datetime[0m
[30;1m187 | [0m[35m            A datetime() object representing the end of the search window.[0m
[30;1m188 | [0m[35m            If used without start_time, the search start will be the earliest[0m
[30;1m189 | [0m[35m            time in the index.[0m
[30;1m190 | [0m[35m        end_time:[0m
[30;1m191 | [0m[35m            alias for `end`[0m
[30;1m192 | [0m[35m        timezone : str[0m

[31m--[ [0m[34mMatch #[0m[33m2358[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/sumologic_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m#  --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""Sumologic Driver class."""[0m
[30;1m7 | [0m[35mimport re[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom datetime import datetime, timedelta[0m
[30;1m10 | [0m[35mfrom timeit import default_timer as timer[0m
[30;1m11 | [0m[35mfrom typing import Any, Dict, Optional, Tuple, Union[0m

[31m--[ [0m[34mMatch #[0m[33m2359[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m                # if this doesn't have a value set explicitly or[0m
[30;1m93 | [0m[35m                # one that was recovered from the widget registry[0m
[30;1m94 | [0m[35m                # set it from the nb_param value[0m
[30;1m95 | [0m[35m                wgt_internal_name = self._NB_PARAMS.get(attr, attr)[0m
[30;1m96 | [0m[35m                if nb_param in name_space and not getattr([0m
[30;1m97 | [0m[35m                    self, wgt_internal_name, None[0m
[30;1m98 | [0m[35m                ):[0m

[31m--[ [0m[34mMatch #[0m[33m2360[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m86 | [0m[35m            # register the current instance as the last instance[0m
[30;1m87 | [0m[35m            _WIDGET_REG[self._id] = self[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m        # if there are any notebook params relevant to this control[0m
[30;1m90 | [0m[35m        if nb_params and name_space:[0m
[30;1m91 | [0m[35m            for attr, nb_param in nb_params.items():[0m
[30;1m92 | [0m[35m                # if this doesn't have a value set explicitly or[0m

[31m--[ [0m[34mMatch #[0m[33m2361[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        """[0m
[30;1m74 | [0m[35m        del kwargs  # allow to be called with kwargs that are ignored[0m
[30;1m75 | [0m[35m        # Try to retrieve previous values based on ID of this control[0m
[30;1m76 | [0m[35m        if register and id_vals:[0m
[30;1m77 | [0m[35m            id_list = [self.__class__.__name__, *[str(val) for val in id_vals]][0m
[30;1m78 | [0m[35m            self._id = hash("".join(id_list))[0m

[31m--[ [0m[34mMatch #[0m[33m2362[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35mdef default_max_buffer(max_default: Optional[int], default: int, unit: TimeUnit) -> int:[0m
[30;1m143 | [0m[35m    """Return the max time buffer for a give time unit."""[0m
[30;1m144 | [0m[35m    mag_default = abs(int(default * 4))[0m
[30;1m145 | [0m[35m    if max_default is not None:[0m
[30;1m146 | [0m[35m        max_value = abs(max_default)[0m

[31m--[ [0m[34mMatch #[0m[33m2363[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35mdef default_max_buffer(max_default: Optional[int], default: int, unit: TimeUnit) -> int:[0m
[30;1m143 | [0m[35m    """Return the max time buffer for a give time unit."""[0m
[30;1m144 | [0m[35m    mag_default = abs(int(default * 4))[0m
[30;1m145 | [0m[35m    if max_default is not None:[0m
[30;1m146 | [0m[35m        max_value = abs(max_default)[0m

[31m--[ [0m[34mMatch #[0m[33m2364[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/eventcluster.py[0m
   Pattern: [32m.hostname[0m
[30;1m14 | [0m[35mstring data. For example, an administration command that does some[0m
[30;1m15 | [0m[35mmaintenance on thousands of servers with a commandline such as:::[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    install-update -hostname {host.fqdn} -tmp:/tmp/{GUID}/rollback[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mcan[0m
[30;1m20 | [0m[35mbe collapsed into a single cluster pattern by ignoring the character[0m

[31m--[ [0m[34mMatch #[0m[33m2365[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/eventcluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m    data : Union[pd.DataFrame, np.ndarray][0m
[30;1m177 | [0m[35m        The source data[0m
[30;1m178 | [0m[35m    time_column : str[0m
[30;1m179 | [0m[35m        Name of the Time column[0m
[30;1m180 | [0m[35m    counts : np.ndarray[0m
[30;1m181 | [0m[35m        The counts of members in each cluster[0m
[30;1m182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2366[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/eventcluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m    normalize : bool, optional[0m
[30;1m90 | [0m[35m        Normalize the input data (should probably always be True)[0m
[30;1m91 | [0m[35m    time_column : str, optional[0m
[30;1m92 | [0m[35m        If there is a time column the output data will be ordered by this[0m
[30;1m93 | [0m[35m        (the default is 'TimeCreatedUtc')[0m
[30;1m94 | [0m[35m    max_cluster_distance : float, optional[0m
[30;1m95 | [0m[35m        DBSCAN eps (max cluster member distance) (the default is 0.01)[0m

[31m--[ [0m[34mMatch #[0m[33m2367[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m            ][0m
[30;1m476 | [0m[35m            ws_match = re.search(self._WS_RGX, self.current_connection, re.IGNORECASE)[0m
[30;1m477 | [0m[35m            if ws_match:[0m
[30;1m478 | [0m[35m                ws_name = ws_match.groupdict().get("ws")[0m
[30;1m479 | [0m[35m                ex_mssgs.append(f"The workspace id used was {ws_name}.")[0m
[30;1m480 | [0m[35m            ex_mssgs.append(f"The full connection string was {self.current_connection}")[0m
[30;1m481 | [0m[35m            raise MsticpyKqlConnectionError(*ex_mssgs, title="unknown workspace")[0m

[31m--[ [0m[34mMatch #[0m[33m2368[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m468 | [0m[35m[0m
[30;1m469 | [0m[35m    def _raise_kql_error(self, ex):[0m
[30;1m470 | [0m[35m        kql_err = json.loads(ex.args[0]).get("error")[0m
[30;1m471 | [0m[35m        if kql_err.get("code") == "WorkspaceNotFoundError":[0m
[30;1m472 | [0m[35m            ex_mssgs = [[0m
[30;1m473 | [0m[35m                "The workspace ID used to connect to Microsoft Sentinel could not be found.",[0m
[30;1m474 | [0m[35m                "Please check that this is a valid workspace for your subscription",[0m

[31m--[ [0m[34mMatch #[0m[33m2369[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m467 | [0m[35m    _TEN_RGX = r"tenant\(['\"](?P<tenant>[^'\"]+)"[0m
[30;1m468 | [0m[35m[0m
[30;1m469 | [0m[35m    def _raise_kql_error(self, ex):[0m
[30;1m470 | [0m[35m        kql_err = json.loads(ex.args[0]).get("error")[0m
[30;1m471 | [0m[35m        if kql_err.get("code") == "WorkspaceNotFoundError":[0m
[30;1m472 | [0m[35m            ex_mssgs = [[0m
[30;1m473 | [0m[35m                "The workspace ID used to connect to Microsoft Sentinel could not be found.",[0m

[31m--[ [0m[34mMatch #[0m[33m2370[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m454 | [0m[35m                    f"(err_code: {result.completion_query_info.get('StatusCode')})",[0m
[30;1m455 | [0m[35m                ][0m
[30;1m456 | [0m[35m            elif "Text" in q_info:[0m
[30;1m457 | [0m[35m                err_contents = [f"StatusDescription {q_info.get('Text')}"][0m
[30;1m458 | [0m[35m            else:[0m
[30;1m459 | [0m[35m                err_contents = [f"Unknown error type: {q_info}"][0m
[30;1m460 | [0m[35m        if not err_contents:[0m

[31m--[ [0m[34mMatch #[0m[33m2371[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m451 | [0m[35m            if "StatusDescription" in q_info:[0m
[30;1m452 | [0m[35m                err_contents = [[0m
[30;1m453 | [0m[35m                    f"StatusDescription {q_info.get('StatusDescription')}",[0m
[30;1m454 | [0m[35m                    f"(err_code: {result.completion_query_info.get('StatusCode')})",[0m
[30;1m455 | [0m[35m                ][0m
[30;1m456 | [0m[35m            elif "Text" in q_info:[0m
[30;1m457 | [0m[35m                err_contents = [f"StatusDescription {q_info.get('Text')}"][0m

[31m--[ [0m[34mMatch #[0m[33m2372[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m450 | [0m[35m            q_info = result.completion_query_info[0m
[30;1m451 | [0m[35m            if "StatusDescription" in q_info:[0m
[30;1m452 | [0m[35m                err_contents = [[0m
[30;1m453 | [0m[35m                    f"StatusDescription {q_info.get('StatusDescription')}",[0m
[30;1m454 | [0m[35m                    f"(err_code: {result.completion_query_info.get('StatusCode')})",[0m
[30;1m455 | [0m[35m                ][0m
[30;1m456 | [0m[35m            elif "Text" in q_info:[0m

[31m--[ [0m[34mMatch #[0m[33m2373[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m            az_cloud = _AZ_CLOUD_MAP.get(kql_cloud, "public")[0m
[30;1m438 | [0m[35m            return kql_cloud, az_cloud[0m
[30;1m439 | [0m[35m        az_cloud = self.az_cloud_config.cloud[0m
[30;1m440 | [0m[35m        kql_cloud = _KQL_CLOUD_MAP.get(az_cloud, "public")[0m
[30;1m441 | [0m[35m        if kql_cloud != self._get_kql_option("cloud"):[0m
[30;1m442 | [0m[35m            self._set_kql_option("cloud", kql_cloud)[0m
[30;1m443 | [0m[35m        return kql_cloud, az_cloud[0m

[31m--[ [0m[34mMatch #[0m[33m2374[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m434 | [0m[35m        if "cloud" in kql_config:[0m
[30;1m435 | [0m[35m            # Set by user - we don't want to override this[0m
[30;1m436 | [0m[35m            kql_cloud = self._get_kql_option("cloud")[0m
[30;1m437 | [0m[35m            az_cloud = _AZ_CLOUD_MAP.get(kql_cloud, "public")[0m
[30;1m438 | [0m[35m            return kql_cloud, az_cloud[0m
[30;1m439 | [0m[35m        az_cloud = self.az_cloud_config.cloud[0m
[30;1m440 | [0m[35m        kql_cloud = _KQL_CLOUD_MAP.get(az_cloud, "public")[0m

[31m--[ [0m[34mMatch #[0m[33m2375[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m430 | [0m[35m    def _set_kql_cloud(self):[0m
[30;1m431 | [0m[35m        """If cloud is set in Azure Settings override default."""[0m
[30;1m432 | [0m[35m        # Check that there isn't a cloud setting in the KQLMAGIC env var[0m
[30;1m433 | [0m[35m        kql_config = os.environ.get(_KQL_ENV_OPTS, "")[0m
[30;1m434 | [0m[35m        if "cloud" in kql_config:[0m
[30;1m435 | [0m[35m            # Set by user - we don't want to override this[0m
[30;1m436 | [0m[35m            kql_cloud = self._get_kql_option("cloud")[0m

[31m--[ [0m[34mMatch #[0m[33m2376[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m    @staticmethod[0m
[30;1m409 | [0m[35m    def _set_kql_env_option(option, value):[0m
[30;1m410 | [0m[35m        """Set an item in the KqlMagic main config environment variable."""[0m
[30;1m411 | [0m[35m        kql_config = os.environ.get(_KQL_ENV_OPTS, "")[0m
[30;1m412 | [0m[35m        current_opts = {[0m
[30;1m413 | [0m[35m            opt.split("=")[0].strip(): opt.split("=")[1][0m
[30;1m414 | [0m[35m            for opt in kql_config.split(";")[0m

[31m--[ [0m[34mMatch #[0m[33m2377[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m389 | [0m[35m    @staticmethod[0m
[30;1m390 | [0m[35m    def _get_kql_option(option):[0m
[30;1m391 | [0m[35m        """Retrieve a current Kqlmagic notebook option."""[0m
[30;1m392 | [0m[35m        return kql_exec(f"--config {option}").get(option)[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m    @staticmethod[0m
[30;1m395 | [0m[35m    def _set_kql_option(option, value):[0m

[31m--[ [0m[34mMatch #[0m[33m2378[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m                return result, None[0m
[30;1m326 | [0m[35m            if hasattr(result, "completion_query_info") and ([0m
[30;1m327 | [0m[35m                int(result.completion_query_info.get("StatusCode", 1)) == 0[0m
[30;1m328 | [0m[35m                or result.completion_query_info.get("Text")[0m
[30;1m329 | [0m[35m                == "Query completed successfully"[0m
[30;1m330 | [0m[35m            ):[0m
[30;1m331 | [0m[35m                data_frame = result.to_dataframe()[0m

[31m--[ [0m[34mMatch #[0m[33m2379[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m            if isinstance(result, pd.DataFrame):[0m
[30;1m325 | [0m[35m                return result, None[0m
[30;1m326 | [0m[35m            if hasattr(result, "completion_query_info") and ([0m
[30;1m327 | [0m[35m                int(result.completion_query_info.get("StatusCode", 1)) == 0[0m
[30;1m328 | [0m[35m                or result.completion_query_info.get("Text")[0m
[30;1m329 | [0m[35m                == "Query completed successfully"[0m
[30;1m330 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m2380[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        mp_az_auth = kwargs.get("mp_az_auth", "default")[0m
[30;1m168 | [0m[35m        mp_az_tenant_id = kwargs.get("mp_az_tenant_id")[0m
[30;1m169 | [0m[35m        workspace = kwargs.get("workspace")[0m
[30;1m170 | [0m[35m        if workspace or connection_str is None:[0m
[30;1m171 | [0m[35m            connection_str = WorkspaceConfig(workspace=workspace)  # type: ignore[0m
[30;1m172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2381[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m            print("Connecting...", end=" ")[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        mp_az_auth = kwargs.get("mp_az_auth", "default")[0m
[30;1m168 | [0m[35m        mp_az_tenant_id = kwargs.get("mp_az_tenant_id")[0m
[30;1m169 | [0m[35m        workspace = kwargs.get("workspace")[0m
[30;1m170 | [0m[35m        if workspace or connection_str is None:[0m
[30;1m171 | [0m[35m            connection_str = WorkspaceConfig(workspace=workspace)  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m2382[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        if not self._previous_connection:[0m
[30;1m165 | [0m[35m            print("Connecting...", end=" ")[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        mp_az_auth = kwargs.get("mp_az_auth", "default")[0m
[30;1m168 | [0m[35m        mp_az_tenant_id = kwargs.get("mp_az_tenant_id")[0m
[30;1m169 | [0m[35m        workspace = kwargs.get("workspace")[0m
[30;1m170 | [0m[35m        if workspace or connection_str is None:[0m

[31m--[ [0m[34mMatch #[0m[33m2383[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m        """[0m
[30;1m103 | [0m[35m        self.az_cloud_config = AzureCloudConfig()[0m
[30;1m104 | [0m[35m        self._ip = get_ipython()[0m
[30;1m105 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m106 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m107 | [0m[35m        self.workspace_id: Optional[str] = None[0m
[30;1m108 | [0m[35m        self._loaded = self._is_kqlmagic_loaded()[0m

[31m--[ [0m[34mMatch #[0m[33m2384[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m# Need to set KQL option before importing[0m
[30;1m39 | [0m[35mdef _set_kql_env_option(option, value):[0m
[30;1m40 | [0m[35m    """Set an item in the KqlMagic main config environment variable."""[0m
[30;1m41 | [0m[35m    kql_config = os.environ.get(_KQL_ENV_OPTS, "")[0m
[30;1m42 | [0m[35m    current_opts = {[0m
[30;1m43 | [0m[35m        opt.split("=")[0].strip(): opt.split("=")[1][0m
[30;1m44 | [0m[35m        for opt in kql_config.split(";")[0m

[31m--[ [0m[34mMatch #[0m[33m2385[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m480 | [0m[35m            ex_mssgs.append(f"The full connection string was {self.current_connection}")[0m
[30;1m481 | [0m[35m            raise MsticpyKqlConnectionError(*ex_mssgs, title="unknown workspace")[0m
[30;1m482 | [0m[35m        raise MsticpyKqlConnectionError([0m
[30;1m483 | [0m[35m            "The service returned the following error when connecting",[0m
[30;1m484 | [0m[35m            str(ex),[0m
[30;1m485 | [0m[35m            title="Kql response error",[0m
[30;1m486 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2386[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m    def _set_kql_cloud(self):[0m
[30;1m431 | [0m[35m        """If cloud is set in Azure Settings override default."""[0m
[30;1m432 | [0m[35m        # Check that there isn't a cloud setting in the KQLMAGIC env var[0m
[30;1m433 | [0m[35m        kql_config = os.environ.get(_KQL_ENV_OPTS, "")[0m
[30;1m434 | [0m[35m        if "cloud" in kql_config:[0m
[30;1m435 | [0m[35m            # Set by user - we don't want to override this[0m

[31m--[ [0m[34mMatch #[0m[33m2387[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/kql_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m        "Cannot use this feature without Kqlmagic installed",[0m
[30;1m64 | [0m[35m        "Install msticpy with the [kql] extra or one of the following:",[0m
[30;1m65 | [0m[35m        "%pip install Kqlmagic   # notebook",[0m
[30;1m66 | [0m[35m        "python -m pip install Kqlmagic   # python",[0m
[30;1m67 | [0m[35m        title="Error importing Kqlmagic",[0m
[30;1m68 | [0m[35m        extra="kql",[0m
[30;1m69 | [0m[35m    ) from imp_err[0m

[31m--[ [0m[34mMatch #[0m[33m2388[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/select_alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m        self.id_col = id_col[0m
[30;1m91 | [0m[35m        time_col = kwargs.get("time_col", "TimeGenerated")[0m
[30;1m92 | [0m[35m        self.time_col = time_col if time_col in alerts.columns else "TimeGenerated"[0m
[30;1m93 | [0m[35m        self.default_alert = kwargs.get("default_alert", None)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m        columns = columns or ["AlertName", "ProductName"][0m
[30;1m96 | [0m[35m        self.disp_columns = list({col for col in columns if col in alerts.columns})[0m

[31m--[ [0m[34mMatch #[0m[33m2389[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbwidgets/select_alert.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        self.alerts = alerts[0m
[30;1m89 | [0m[35m        self.alert_action = action[0m
[30;1m90 | [0m[35m        self.id_col = id_col[0m
[30;1m91 | [0m[35m        time_col = kwargs.get("time_col", "TimeGenerated")[0m
[30;1m92 | [0m[35m        self.time_col = time_col if time_col in alerts.columns else "TimeGenerated"[0m
[30;1m93 | [0m[35m        self.default_alert = kwargs.get("default_alert", None)[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2390[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/proc_tree_schema.py[0m
   Pattern: [32m.hostname[0m
[30;1m275 | [0m[35m    path_separator="\\",[0m
[30;1m276 | [0m[35m    event_id_column="eventtype",[0m
[30;1m277 | [0m[35m    event_id_identifier="start",[0m
[30;1m278 | [0m[35m    host_name_column="hostname",[0m
[30;1m279 | [0m[35m)[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35mSUPPORTED_SCHEMAS: tuple[ProcSchema, ...] = ([0m

[31m--[ [0m[34mMatch #[0m[33m2391[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_osquery_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m        table_map = defaultdict(list)[0m
[30;1m331 | [0m[35m        for name in self._data_cache:[0m
[30;1m332 | [0m[35m            match = re.search(self._OSQ_TABLE_REGEX, name, re.IGNORECASE)[0m
[30;1m333 | [0m[35m            table_name = match.groupdict().get("table_name") if match else name[0m
[30;1m334 | [0m[35m            table_name = valid_pyname(table_name.strip())[0m
[30;1m335 | [0m[35m            table_map[table_name].append(name)[0m
[30;1m336 | [0m[35m        return table_map[0m

[31m--[ [0m[34mMatch #[0m[33m2392[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_osquery_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m            )[0m
[30;1m78 | [0m[35m            if prov_settings:[0m
[30;1m79 | [0m[35m                self._paths = prov_settings.args.get("data_paths", []) or self._paths[0m
[30;1m80 | [0m[35m                self._cache_file = prov_settings.args.get("cache_file")[0m
[30;1m81 | [0m[35m                logger.info("data paths read from config %s", str(self._paths))[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        self._progress = kwargs.pop("progress", True)[0m

[31m--[ [0m[34mMatch #[0m[33m2393[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_osquery_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m                "OSQueryLogs"[0m
[30;1m77 | [0m[35m            )[0m
[30;1m78 | [0m[35m            if prov_settings:[0m
[30;1m79 | [0m[35m                self._paths = prov_settings.args.get("data_paths", []) or self._paths[0m
[30;1m80 | [0m[35m                self._cache_file = prov_settings.args.get("cache_file")[0m
[30;1m81 | [0m[35m                logger.info("data paths read from config %s", str(self._paths))[0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2394[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_osquery_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m            self._paths = [path.strip() for path in data_paths][0m
[30;1m73 | [0m[35m            logger.info("data paths read from param %s", str(self._paths))[0m
[30;1m74 | [0m[35m        else:[0m
[30;1m75 | [0m[35m            prov_settings = get_provider_settings(config_section="DataProviders").get([0m
[30;1m76 | [0m[35m                "OSQueryLogs"[0m
[30;1m77 | [0m[35m            )[0m
[30;1m78 | [0m[35m            if prov_settings:[0m

[31m--[ [0m[34mMatch #[0m[33m2395[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_osquery_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        self._paths: List[str] = ["."][0m
[30;1m69 | [0m[35m        # If data paths specified, use these[0m
[30;1m70 | [0m[35m        # from kwargs or settings[0m
[30;1m71 | [0m[35m        if data_paths := kwargs.get("data_paths"):[0m
[30;1m72 | [0m[35m            self._paths = [path.strip() for path in data_paths][0m
[30;1m73 | [0m[35m            logger.info("data paths read from param %s", str(self._paths))[0m
[30;1m74 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m2396[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_osquery_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        """[0m
[30;1m64 | [0m[35m        del connection_str[0m
[30;1m65 | [0m[35m        self._debug = kwargs.get("debug", False)[0m
[30;1m66 | [0m[35m        super().__init__()[0m
[30;1m67 | [0m[35m        self._cache_file: Optional[str] = None[0m
[30;1m68 | [0m[35m        self._paths: List[str] = ["."][0m

[31m--[ [0m[34mMatch #[0m[33m2397[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/local_osquery_driver.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m313 | [0m[35m                # if so, we combine with newly-extracted data[0m
[30;1m314 | [0m[35m                combined_dfs.append(self._data_cache[event_name])[0m
[30;1m315 | [0m[35m            combined_dfs.append(self._extract_event_type(df_all_queries, event_name))[0m
[30;1m316 | [0m[35m            # update the cache[0m
[30;1m317 | [0m[35m            self._data_cache[event_name] = _rename_columns(pd.concat(combined_dfs))[0m
[30;1m318 | [0m[35m            logger.info([0m
[30;1m319 | [0m[35m                "event type %s read to _data_cache, len: %d",[0m

[31m--[ [0m[34mMatch #[0m[33m2398[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_search_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m            return azure_to_pd.get(azure_type, "object")[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m        for column in data_frame.columns:[0m
[30;1m198 | [0m[35m            azure_type = type_mapping.get(column)[0m
[30;1m199 | [0m[35m            if not azure_type:[0m
[30;1m200 | [0m[35m                continue[0m
[30;1m201 | [0m[35m            pandas_type = map_azure_type(azure_type)[0m

[31m--[ [0m[34mMatch #[0m[33m2399[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_search_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m                "boolean": "bool",[0m
[30;1m193 | [0m[35m                "guid": "str",[0m
[30;1m194 | [0m[35m            }[0m
[30;1m195 | [0m[35m            return azure_to_pd.get(azure_type, "object")[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m        for column in data_frame.columns:[0m
[30;1m198 | [0m[35m            azure_type = type_mapping.get(column)[0m

[31m--[ [0m[34mMatch #[0m[33m2400[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_search_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m    def _table_to_dataframe(self, table: dict[str, Any]) -> pd.DataFrame:[0m
[30;1m179 | [0m[35m        """Convert Azure types to pandas dtypes."""[0m
[30;1m180 | [0m[35m        rows = table.get("rows", [])[0m
[30;1m181 | [0m[35m        col_names = [col["name"] for col in table.get("columns", [])][0m
[30;1m182 | [0m[35m        data_frame = pd.DataFrame(rows, columns=col_names)[0m
[30;1m183 | [0m[35m        type_mapping = {col["name"]: col["type"] for col in table["columns"]}[0m
[30;1m184 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2401[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_search_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    def _table_to_dataframe(self, table: dict[str, Any]) -> pd.DataFrame:[0m
[30;1m179 | [0m[35m        """Convert Azure types to pandas dtypes."""[0m
[30;1m180 | [0m[35m        rows = table.get("rows", [])[0m
[30;1m181 | [0m[35m        col_names = [col["name"] for col in table.get("columns", [])][0m
[30;1m182 | [0m[35m        data_frame = pd.DataFrame(rows, columns=col_names)[0m
[30;1m183 | [0m[35m        type_mapping = {col["name"]: col["type"] for col in table["columns"]}[0m

[31m--[ [0m[34mMatch #[0m[33m2402[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_search_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m    def _query_search_endpoint(self, search_url, query_body, timeout):[0m
[30;1m155 | [0m[35m        try:[0m
[30;1m156 | [0m[35m            with httpx.Client(timeout=timeout) as client:[0m
[30;1m157 | [0m[35m                response = client.post([0m
[30;1m158 | [0m[35m                    search_url, headers=self._auth_header, json=query_body[0m
[30;1m159 | [0m[35m                )[0m
[30;1m160 | [0m[35m        except httpx.RequestError as req_err:[0m

[31m--[ [0m[34mMatch #[0m[33m2403[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_search_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        # Make request[0m
[30;1m137 | [0m[35m        results = self._query_search_endpoint(search_url, query_body, timeout)[0m
[30;1m138 | [0m[35m        tables = results.get("tables", [])[0m
[30;1m139 | [0m[35m        if not tables:[0m
[30;1m140 | [0m[35m            logger.warning("No tables found in the response.")[0m
[30;1m141 | [0m[35m            return pd.DataFrame(), {"status": "no_data"}[0m

[31m--[ [0m[34mMatch #[0m[33m2404[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_search_driver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    def _create_query_client(self, connection_str: str | None = None, **kwargs):[0m
[30;1m58 | [0m[35m        """Create a query client using the /search endpoint."""[0m
[30;1m59 | [0m[35m        az_auth_types = kwargs.pop("auth_types", kwargs.get("mp_az_auth"))[0m
[30;1m60 | [0m[35m        if isinstance(az_auth_types, bool):[0m
[30;1m61 | [0m[35m            az_auth_types = None[0m
[30;1m62 | [0m[35m        if isinstance(az_auth_types, str):[0m

[31m--[ [0m[34mMatch #[0m[33m2405[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/drivers/azure_search_driver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m        }[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        # Time-out can be specified if needed[0m
[30;1m134 | [0m[35m        timeout = kwargs.pop("timeout", 300)[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        # Make request[0m
[30;1m137 | [0m[35m        results = self._query_search_endpoint(search_url, query_body, timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m2406[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m    nbinit_params = {}[0m
[30;1m198 | [0m[35m    if comp_settings and isinstance(comp_settings, dict):[0m
[30;1m199 | [0m[35m        prov_name, prov_args = next([0m
[30;1m200 | [0m[35m            iter(comp_settings.get("query_provider", {}).items())[0m
[30;1m201 | [0m[35m        )[0m
[30;1m202 | [0m[35m        if prov_name:[0m
[30;1m203 | [0m[35m            nbinit_params = {"query_provider": prov_name}[0m

[31m--[ [0m[34mMatch #[0m[33m2407[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35mdef _load_geoip_lookup(comp_settings=None, **kwargs):[0m
[30;1m181 | [0m[35m    del kwargs[0m
[30;1m182 | [0m[35m    provider = ([0m
[30;1m183 | [0m[35m        comp_settings.get("provider") if isinstance(comp_settings, dict) else None[0m
[30;1m184 | [0m[35m    )[0m
[30;1m185 | [0m[35m    if provider == "GeoLiteLookup":[0m
[30;1m186 | [0m[35m        from ..context.geoip import GeoLiteLookup[0m

[31m--[ [0m[34mMatch #[0m[33m2408[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35mdef _load_provider(prov_name: str, qry_prov_entry: Dict[str, Any]) -> Tuple[str, Any]:[0m
[30;1m161 | [0m[35m    alias = qry_prov_entry.get("alias", prov_name)[0m
[30;1m162 | [0m[35m    connect = qry_prov_entry.get("connect", True)[0m
[30;1m163 | [0m[35m    obj_name = f"qry_{alias.lower()}"[0m
[30;1m164 | [0m[35m    prov_obj = QueryProvider(prov_name)[0m
[30;1m165 | [0m[35m    print(f"Loaded *{prov_name}* as '{obj_name}'. ", end="")[0m

[31m--[ [0m[34mMatch #[0m[33m2409[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35mdef _load_provider(prov_name: str, qry_prov_entry: Dict[str, Any]) -> Tuple[str, Any]:[0m
[30;1m161 | [0m[35m    alias = qry_prov_entry.get("alias", prov_name)[0m
[30;1m162 | [0m[35m    connect = qry_prov_entry.get("connect", True)[0m
[30;1m163 | [0m[35m    obj_name = f"qry_{alias.lower()}"[0m
[30;1m164 | [0m[35m    prov_obj = QueryProvider(prov_name)[0m

[31m--[ [0m[34mMatch #[0m[33m2410[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m            continue[0m
[30;1m142 | [0m[35m        print(f"Loading {prov_name}, workspace: {ws_name}")[0m
[30;1m143 | [0m[35m        alias = ws_settings.get("alias", ws_name)[0m
[30;1m144 | [0m[35m        connect = ws_settings.get("connect", True)[0m
[30;1m145 | [0m[35m        obj_name = f"qry_{alias.lower()}"[0m
[30;1m146 | [0m[35m        print(f"Workspace *{ws_name}* query provider loaded as '{obj_name}'. ", end="")[0m
[30;1m147 | [0m[35m        prov_obj = QueryProvider(prov_name)[0m

[31m--[ [0m[34mMatch #[0m[33m2411[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m        if not ws_settings:[0m
[30;1m141 | [0m[35m            continue[0m
[30;1m142 | [0m[35m        print(f"Loading {prov_name}, workspace: {ws_name}")[0m
[30;1m143 | [0m[35m        alias = ws_settings.get("alias", ws_name)[0m
[30;1m144 | [0m[35m        connect = ws_settings.get("connect", True)[0m
[30;1m145 | [0m[35m        obj_name = f"qry_{alias.lower()}"[0m
[30;1m146 | [0m[35m        print(f"Workspace *{ws_name}* query provider loaded as '{obj_name}'. ", end="")[0m

[31m--[ [0m[34mMatch #[0m[33m2412[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m        load_comp_func = COMP_LOADERS.get(comp)[0m
[30;1m102 | [0m[35m        if comp not in comps_to_load or not load_comp_func:[0m
[30;1m103 | [0m[35m            continue[0m
[30;1m104 | [0m[35m        comp_settings = comps_to_load.get(comp)[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        if load_comp_func:[0m
[30;1m107 | [0m[35m            print(f"Loading *{comp}*. ", end="")[0m

[31m--[ [0m[34mMatch #[0m[33m2413[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m    comps_to_load = user_defaults.get("LoadComponents", {})[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    for comp in COMP_LOADERS:[0m
[30;1m101 | [0m[35m        load_comp_func = COMP_LOADERS.get(comp)[0m
[30;1m102 | [0m[35m        if comp not in comps_to_load or not load_comp_func:[0m
[30;1m103 | [0m[35m            continue[0m
[30;1m104 | [0m[35m        comp_settings = comps_to_load.get(comp)[0m

[31m--[ [0m[34mMatch #[0m[33m2414[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m    prov_dict = {}[0m
[30;1m96 | [0m[35m    if "LoadComponents" not in user_defaults:[0m
[30;1m97 | [0m[35m        return prov_dict[0m
[30;1m98 | [0m[35m    comps_to_load = user_defaults.get("LoadComponents", {})[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    for comp in COMP_LOADERS:[0m
[30;1m101 | [0m[35m        load_comp_func = COMP_LOADERS.get(comp)[0m

[31m--[ [0m[34mMatch #[0m[33m2415[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    prov_dict = {}[0m
[30;1m82 | [0m[35m    query_provs = user_defaults.get("QueryProviders", {})[0m
[30;1m83 | [0m[35m    if query_provs and isinstance(query_provs, dict):[0m
[30;1m84 | [0m[35m        for prov_name, qry_prov_entry in user_defaults.get("QueryProviders").items():[0m
[30;1m85 | [0m[35m            if prov_name == "AzureSentinel":[0m
[30;1m86 | [0m[35m                provs = _load_az_workspaces(prov_name, qry_prov_entry)[0m
[30;1m87 | [0m[35m                prov_dict.update(provs)[0m

[31m--[ [0m[34mMatch #[0m[33m2416[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mdef _load_query_providers(user_defaults):[0m
[30;1m81 | [0m[35m    prov_dict = {}[0m
[30;1m82 | [0m[35m    query_provs = user_defaults.get("QueryProviders", {})[0m
[30;1m83 | [0m[35m    if query_provs and isinstance(query_provs, dict):[0m
[30;1m84 | [0m[35m        for prov_name, qry_prov_entry in user_defaults.get("QueryProviders").items():[0m
[30;1m85 | [0m[35m            if prov_name == "AzureSentinel":[0m

[31m--[ [0m[34mMatch #[0m[33m2417[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/user_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m        GeoIpLookup:[0m
[30;1m30 | [0m[35m        provider: GeoLiteLookup   # geoip provider to use[0m
[30;1m31 | [0m[35m        Notebooklets:       # Load and intialize Notebooklets[0m
[30;1m32 | [0m[35m        query_provider:   # Pass it this query provider at startup[0m
[30;1m33 | [0m[35m            AzureSentinel:[0m
[30;1m34 | [0m[35m            workspace: CyberSoc[0m
[30;1m35 | [0m[35m        Pivot:              # No parameters[0m

[31m--[ [0m[34mMatch #[0m[33m2418[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m            pyperclip.copy(self._get_current_func())[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    def _search_func(self, change):[0m
[30;1m225 | [0m[35m        search_txt = change.get("new")[0m
[30;1m226 | [0m[35m        search_results, hits = self._search_funcs(search_txt)[0m
[30;1m227 | [0m[35m        self._layout["func_help_accd"].set_title(2, f"Search results ({hits})")[0m
[30;1m228 | [0m[35m        self._html["search_res"].value = search_results[0m

[31m--[ [0m[34mMatch #[0m[33m2419[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m        self._select["pivot_funcs"].options = self.piv_entities.get(entity)[1][0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def _select_function(self, change):[0m
[30;1m192 | [0m[35m        func_name = change.get("new")[0m
[30;1m193 | [0m[35m        entity_name = self._select["entities"].value[0m
[30;1m194 | [0m[35m        entity = self.piv_entities[entity_name][0][0m
[30;1m195 | [0m[35m        func_name_path = func_name.split(".")[0m

[31m--[ [0m[34mMatch #[0m[33m2420[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    def _display_pivots(self, change):[0m
[30;1m188 | [0m[35m        entity = change.get("new")[0m
[30;1m189 | [0m[35m        self._select["pivot_funcs"].options = self.piv_entities.get(entity)[1][0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def _select_function(self, change):[0m
[30;1m192 | [0m[35m        func_name = change.get("new")[0m

[31m--[ [0m[34mMatch #[0m[33m2421[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/pivot_core/pivot_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m        self.display()[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    def _display_pivots(self, change):[0m
[30;1m188 | [0m[35m        entity = change.get("new")[0m
[30;1m189 | [0m[35m        self._select["pivot_funcs"].options = self.piv_entities.get(entity)[1][0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def _select_function(self, change):[0m

[31m--[ [0m[34mMatch #[0m[33m2422[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m      IpAddress: Address[0m
[30;1m94 | [0m[35m    func_df_param_name: data[0m
[30;1m95 | [0m[35m    func_df_col_param_name: ip[0m
[30;1m96 | [0m[35m    func_out_column_name: ip[0m
[30;1m97 | [0m[35m    func_input_value_arg: ip_str[0m
[30;1m98 | [0m[35m    create_shortcut: True[0m
[30;1m99 | [0m[35m  b64_unpack:[0m

[31m--[ [0m[34mMatch #[0m[33m2423[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m    entity_map:[0m
[30;1m93 | [0m[35m      IpAddress: Address[0m
[30;1m94 | [0m[35m    func_df_param_name: data[0m
[30;1m95 | [0m[35m    func_df_col_param_name: ip[0m
[30;1m96 | [0m[35m    func_out_column_name: ip[0m
[30;1m97 | [0m[35m    func_input_value_arg: ip_str[0m
[30;1m98 | [0m[35m    create_shortcut: True[0m

[31m--[ [0m[34mMatch #[0m[33m2424[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m    entity_map:[0m
[30;1m80 | [0m[35m      IpAddress: Address[0m
[30;1m81 | [0m[35m    can_iterate: True[0m
[30;1m82 | [0m[35m    func_df_param_name: ip[0m
[30;1m83 | [0m[35m    func_df_col_param_name: ip_column[0m
[30;1m84 | [0m[35m    func_input_value_arg: ip_address[0m
[30;1m85 | [0m[35m    create_shortcut: True[0m

[31m--[ [0m[34mMatch #[0m[33m2425[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m  who_is:[0m
[30;1m60 | [0m[35m    src_module: msticpy.context.ip_utils[0m
[30;1m61 | [0m[35m    src_func_name: get_whois_df[0m
[30;1m62 | [0m[35m    func_new_name: whois[0m
[30;1m63 | [0m[35m    input_type: dataframe[0m
[30;1m64 | [0m[35m    entity_map:[0m
[30;1m65 | [0m[35m      IpAddress: Address[0m

[31m--[ [0m[34mMatch #[0m[33m2426[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m  #   ## to the input. This defaults to the the same column name[0m
[30;1m46 | [0m[35m  #   ## as func_df_col_param_name. Only relevant if the wrapped func[0m
[30;1m47 | [0m[35m  #   ## returns a DF[0m
[30;1m48 | [0m[35m  #   func_out_column_name: ip[0m
[30;1m49 | [0m[35m  #[0m
[30;1m50 | [0m[35m  #   ## static parameters (kwargs) passed to the target function[0m
[30;1m51 | [0m[35m  #   func_static_params:[0m

[31m--[ [0m[34mMatch #[0m[33m2427[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m  #   ## name of the entity with the entity attribute to as input. E.g.[0m
[30;1m28 | [0m[35m  #   ## for a function to lookup whois info for an IP Address from an IpAddress[0m
[30;1m29 | [0m[35m  #   ## entity, the key will be 'IpAddress' and the value 'Address' (the[0m
[30;1m30 | [0m[35m  #   ## attribute of the entity containing the IP address value.)[0m
[30;1m31 | [0m[35m  #   entity_map:[0m
[30;1m32 | [0m[35m  #     IpAddress: Address[0m
[30;1m33 | [0m[35m  #     Host: HostName[0m

[31m--[ [0m[34mMatch #[0m[33m2428[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m  #[0m
[30;1m26 | [0m[35m  #   ## dict of entity_map supported. Each entry should be the[0m
[30;1m27 | [0m[35m  #   ## name of the entity with the entity attribute to as input. E.g.[0m
[30;1m28 | [0m[35m  #   ## for a function to lookup whois info for an IP Address from an IpAddress[0m
[30;1m29 | [0m[35m  #   ## entity, the key will be 'IpAddress' and the value 'Address' (the[0m
[30;1m30 | [0m[35m  #   ## attribute of the entity containing the IP address value.)[0m
[30;1m31 | [0m[35m  #   entity_map:[0m

[31m--[ [0m[34mMatch #[0m[33m2429[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m  #[0m
[30;1m26 | [0m[35m  #   ## dict of entity_map supported. Each entry should be the[0m
[30;1m27 | [0m[35m  #   ## name of the entity with the entity attribute to as input. E.g.[0m
[30;1m28 | [0m[35m  #   ## for a function to lookup whois info for an IP Address from an IpAddress[0m
[30;1m29 | [0m[35m  #   ## entity, the key will be 'IpAddress' and the value 'Address' (the[0m
[30;1m30 | [0m[35m  #   ## attribute of the entity containing the IP address value.)[0m
[30;1m31 | [0m[35m  #   entity_map:[0m

[31m--[ [0m[34mMatch #[0m[33m2430[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/resources/mp_pivot_reg.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m  #[0m
[30;1m17 | [0m[35m  #   ## rename the function - this is the name that will appear in the[0m
[30;1m18 | [0m[35m  #   ## pivot UI[0m
[30;1m19 | [0m[35m  #   func_new_name: whois[0m
[30;1m20 | [0m[35m  #[0m
[30;1m21 | [0m[35m  #   ## input type = dataframe, iterable, value[0m
[30;1m22 | [0m[35m  #   ## Note: this is the input type that the wrapped function expects, not[0m

[31m--[ [0m[34mMatch #[0m[33m2431[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/aiagents/config_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    """[0m
[30;1m63 | [0m[35m    if "api_key" in config:[0m
[30;1m64 | [0m[35m        api_key = os.environ.get(str(config["api_key"]), None)[0m
[30;1m65 | [0m[35m        if not api_key:[0m
[30;1m66 | [0m[35m            raise MsticpyUserConfigError([0m
[30;1m67 | [0m[35m                f"Environment variable {config['api_key']} specified, but not found!"[0m

[31m--[ [0m[34mMatch #[0m[33m2432[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m        let minTimeRange = ago(7d);[0m
[30;1m26 | [0m[35m        let wordLinks =[0m
[30;1m27 | [0m[35m          DeviceEvents[0m
[30;1m28 | [0m[35m          // Filter on click on links from WinWord[0m
[30;1m29 | [0m[35m          | where {time_column} > minTimeRange and ActionType == "BrowserLaunchedToOpenUrl" and isno[0m
[30;1m30 | [0m[35m          | project ClickTime={time_column}, DeviceId, DeviceName, ClickUrl=RemoteUrl;[0m
[30;1m31 | [0m[35m        let docAttachments =[0m

[31m--[ [0m[34mMatch #[0m[33m2433[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m366 | [0m[35m        {add_query_items}'[0m
[30;1m367 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Lateral%20Mo[0m
[30;1m368 | [0m[35m  service_account_powershell:[0m
[30;1m369 | [0m[35m    description: Service Accounts Performing Remote PowerShell[0m
[30;1m370 | [0m[35m    metadata:[0m
[30;1m371 | [0m[35m    args:[0m
[30;1m372 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2434[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m345 | [0m[35m        {add_query_items}'[0m
[30;1m346 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Exploits/Lin[0m
[30;1m347 | [0m[35m  brute_force:[0m
[30;1m348 | [0m[35m    description: Look for public IP addresses that failed to logon to a computer multiple times, usi[0m
[30;1m349 | [0m[35m    metadata:[0m
[30;1m350 | [0m[35m    args:[0m
[30;1m351 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2435[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m328 | [0m[35m        | where InitiatingProcessFileName =~ "cmd.exe" and InitiatingProcessParentFileName =~ "excel[0m
[30;1m329 | [0m[35m        | where RemoteUrl endswith ".kr"[0m
[30;1m330 | [0m[35m        | project {time_column}, DeviceName, RemoteIP, RemoteUrl[0m
[30;1m331 | [0m[35m        | top 100 by {time_column}[0m
[30;1m332 | [0m[35m        {add_query_items}'[0m
[30;1m333 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Exploits/Fla[0m
[30;1m334 | [0m[35m  cve_2018_1111:[0m

[31m--[ [0m[34mMatch #[0m[33m2436[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35mon("$.Command", AdditionalFields, typeof(string)), InitiatingProcessCommandLine, InitiatingProcessPa[0m
[30;1m292 | [0m[35m            | where PowershellCommand !endswith ".ps1" and PowershellCommand !endswith ".exe";[0m
[30;1m293 | [0m[35m        // Filter Powershell cmdlets executed on relevant machine and time period[0m
[30;1m294 | [0m[35m        powershellCommands | where DeviceId == DeviceId and Timestamp between ((timestamp-5min) .. 1[0m
[30;1m295 | [0m[35m        // Filter out common powershell cmdlets[0m

[31m--[ [0m[34mMatch #[0m[33m2437[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m        {add_query_items}'[0m
[30;1m279 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Po[0m
[30;1m280 | [0m[35m  uncommon_powershell:[0m
[30;1m281 | [0m[35m    description: Find which uncommon Powershell Cmdlets were executed on that machine in a certain t[0m
[30;1m282 | [0m[35m    metadata:[0m
[30;1m283 | [0m[35m    args:[0m
[30;1m284 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2438[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m        {add_query_items}'[0m
[30;1m279 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Po[0m
[30;1m280 | [0m[35m  uncommon_powershell:[0m
[30;1m281 | [0m[35m    description: Find which uncommon Powershell Cmdlets were executed on that machine in a certain t[0m
[30;1m282 | [0m[35m    metadata:[0m
[30;1m283 | [0m[35m    args:[0m
[30;1m284 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2439[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m274 | [0m[35m          or ProcessCommandLine has "Start-BitsTransfer"[0m
[30;1m275 | [0m[35m          or ProcessCommandLine has "mpcmdrun.exe"[0m
[30;1m276 | [0m[35m        | project {time_column}, DeviceName, InitiatingProcessFileName, FileName, ProcessCommandLine[0m
[30;1m277 | [0m[35m        | top 100 by {time_column}[0m
[30;1m278 | [0m[35m        {add_query_items}'[0m
[30;1m279 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Po[0m
[30;1m280 | [0m[35m  uncommon_powershell:[0m

[31m--[ [0m[34mMatch #[0m[33m2440[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m        DeviceProcessEvents[0m
[30;1m243 | [0m[35m        | where {time_column} > ago(7d)[0m
[30;1m244 | [0m[35m        | where ProcessCommandLine contains "TVqQAAMAAAAEAAA"[0m
[30;1m245 | [0m[35m        | top 1000 by {time_column}[0m
[30;1m246 | [0m[35m        {add_query_items}'[0m
[30;1m247 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Ba[0m
[30;1m248 | [0m[35m  malware_recycle:[0m

[31m--[ [0m[34mMatch #[0m[33m2441[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m235 | [0m[35m        {add_query_items}'[0m
[30;1m236 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Discovery/SM[0m
[30;1m237 | [0m[35m  b64_pe:[0m
[30;1m238 | [0m[35m    description: Finding base64 encoded PE files header seen in the command line parameters[0m
[30;1m239 | [0m[35m    metadata:[0m
[30;1m240 | [0m[35m    args:[0m
[30;1m241 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2442[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m        {add_query_items}'[0m
[30;1m223 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Discovery/En[0m
[30;1m224 | [0m[35m  smb_discovery:[0m
[30;1m225 | [0m[35m    description: Query for processes that accessed more than 10 IP addresses over port 445 (SMB) - p[0m
[30;1m226 | [0m[35m    metadata:[0m
[30;1m227 | [0m[35m    args:[0m
[30;1m228 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2443[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m(ProcessCommandLine contains " /do" or ProcessCommandLine contains " /domain")[0m
[30;1m219 | [0m[35m        | extend Target = extract("(?i)[user|group] (\"*[a-zA-Z0-9-_ ]+\"*)", 1, ProcessCommandLine)[0m
[30;1m220 | [0m[35m        | project AccountName, Target, ProcessCommandLine, DeviceName, {time_column}[0m
[30;1m221 | [0m[35m        | sort by AccountName, Target[0m
[30;1m222 | [0m[35m        {add_query_items}'[0m
[30;1m223 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Discovery/En[0m
[30;1m224 | [0m[35m  smb_discovery:[0m

[31m--[ [0m[34mMatch #[0m[33m2444[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m128 | [0m[35m        let alerts =[0m
[30;1m129 | [0m[35m            AlertInfo | join AlertEvidence on AlertId[0m
[30;1m130 | [0m[35m            | summarize (FirstDetectedActivity, Title)=argmin({time_column}, Title) by AlertId, Devi[0m
[30;1m131 | [0m[35m            // Filter alerts that include events from before the queried time period[0m
[30;1m132 | [0m[35m            | where FirstDetectedActivity > minTimeRange;[0m
[30;1m133 | [0m[35m        // Join the two together - looking for alerts that are right after an abnormal network logon[0m
[30;1m134 | [0m[35m        alerts | join kind=inner (outlookLinks) on DeviceId | where FirstDetectedActivity - {time_co[0m

[31m--[ [0m[34mMatch #[0m[33m2445[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m          | where[0m
[30;1m118 | [0m[35m              // outlook.exe is the Office Outlook app[0m
[30;1m119 | [0m[35m              InitiatingProcessFileName =~ "outlook.exe"[0m
[30;1m120 | [0m[35m              // RuntimeBroker.exe opens links for all apps from the Windows store, including the Wi[0m
[30;1m121 | [0m[35m              // However, it will also include some links opened from other apps.[0m
[30;1m122 | [0m[35m                  or InitiatingProcessFileName =~ "runtimebroker.exe"[0m
[30;1m123 | [0m[35m            | project {time_column}, DeviceId, DeviceName, RemoteUrl, InitiatingProcessFileName, Par[0m

[31m--[ [0m[34mMatch #[0m[33m2446[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m        {add_query_items}'[0m
[30;1m106 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Delivery/Ema[0m
[30;1m107 | [0m[35m  email_link:[0m
[30;1m108 | [0m[35m    description: Look for links opened from mail apps – if a detection occurred right afterwards[0m
[30;1m109 | [0m[35m    metadata:[0m
[30;1m110 | [0m[35m    args:[0m
[30;1m111 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2447[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m                    | project DeviceName, ActivityId=extractjson("$.ActivityId", AdditionalFields, t[0m
[30;1m87 | [0m[35m                on DeviceName, ActivityId[0m
[30;1m88 | [0m[35m          | project-away ActivityId;[0m
[30;1m89 | [0m[35m        // Query for links opened from outlook, that are close in time to a SmartScreen warning[0m
[30;1m90 | [0m[35m        let emailLinksNearSmartScreenWarnings =[0m
[30;1m91 | [0m[35m            DeviceEvents[0m
[30;1m92 | [0m[35m            | where ActionType == "BrowserLaunchedToOpenUrl" and isnotempty(RemoteUrl) and Initiatin[0m

[31m--[ [0m[34mMatch #[0m[33m2448[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m          | where {time_column} > minTimeRange[0m
[30;1m34 | [0m[35m          // Query for common document file extensions[0m
[30;1m35 | [0m[35m            and (FileName endswith ".docx" or FileName endswith ".docm" or FileName endswith ".doc")[0m
[30;1m36 | [0m[35m          // Query for files saved from email clients such as the Office Outlook app or the Windows [0m
[30;1m37 | [0m[35m            and InitiatingProcessFileName in~ ("outlook.exe", "hxoutlook.exe")[0m
[30;1m38 | [0m[35m          | summarize AttachmentSaveTime=min({time_column}) by AttachmentName=FileName, DeviceId;[0m
[30;1m39 | [0m[35m        let browserDownloads =[0m

[31m--[ [0m[34mMatch #[0m[33m2449[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m        type: str[0m
[30;1m14 | [0m[35m        default: ''[0m
[30;1m15 | [0m[35m      time_column:[0m
[30;1m16 | [0m[35m        description: The name of the column detailing the time the event was generated.[0m
[30;1m17 | [0m[35m        type: str[0m
[30;1m18 | [0m[35m        default: "Timestamp"[0m
[30;1m19 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m2450[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m301 | [0m[35m        description: hostname of computer to focus query on[0m
[30;1m302 | [0m[35m        type: str[0m
[30;1m303 | [0m[35m        aliases:[0m
[30;1m304 | [0m[35m          - hostname[0m
[30;1m305 | [0m[35m      timestamp:[0m
[30;1m306 | [0m[35m        description: timestamp to base investigation scope on[0m
[30;1m307 | [0m[35m        type: str[0m

[31m--[ [0m[34mMatch #[0m[33m2451[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_hunting.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m298 | [0m[35m      uri: "https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries/blob/master/Execution/Po[0m
[30;1m299 | [0m[35m    parameters:[0m
[30;1m300 | [0m[35m      host_name:[0m
[30;1m301 | [0m[35m        description: hostname of computer to focus query on[0m
[30;1m302 | [0m[35m        type: str[0m
[30;1m303 | [0m[35m        aliases:[0m
[30;1m304 | [0m[35m          - hostname[0m

[31m--[ [0m[34mMatch #[0m[33m2452[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_process.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m      default: "Timestamp"[0m
[30;1m29 | [0m[35msources:[0m
[30;1m30 | [0m[35m  list_host_processes:[0m
[30;1m31 | [0m[35m    description: Return all process creations for a host for the specified time range[0m
[30;1m32 | [0m[35m    metadata:[0m
[30;1m33 | [0m[35m    args:[0m
[30;1m34 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2453[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_process.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m      type: str[0m
[30;1m24 | [0m[35m      default: ""[0m
[30;1m25 | [0m[35m    time_column:[0m
[30;1m26 | [0m[35m      description: The name of the column detailing the time the event was generated.[0m
[30;1m27 | [0m[35m      type: str[0m
[30;1m28 | [0m[35m      default: "Timestamp"[0m
[30;1m29 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m2454[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_process.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m
[30;1m20 | [0m[35m      type: datetime[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m2455[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_process.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m      type: str[0m
[30;1m14 | [0m[35m      default: "DeviceProcessEvents"[0m
[30;1m15 | [0m[35m    start:[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2456[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        self.Subject = src_event.get("Subject")[0m
[30;1m157 | [0m[35m        self.AntispamDirection = src_event.get("AntispamDirection")[0m
[30;1m158 | [0m[35m        self.DeliveryAction = src_event.get("DeliveryAction")[0m
[30;1m159 | [0m[35m        self.Language = src_event.get("Language")[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    @property[0m
[30;1m162 | [0m[35m    def description_str(self):[0m

[31m--[ [0m[34mMatch #[0m[33m2457[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m        self.InternetMessageId = src_event.get("InternetMessageId")[0m
[30;1m156 | [0m[35m        self.Subject = src_event.get("Subject")[0m
[30;1m157 | [0m[35m        self.AntispamDirection = src_event.get("AntispamDirection")[0m
[30;1m158 | [0m[35m        self.DeliveryAction = src_event.get("DeliveryAction")[0m
[30;1m159 | [0m[35m        self.Language = src_event.get("Language")[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m2458[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m        self.NetworkMessageId = src_event.get("NetworkMessageId")[0m
[30;1m155 | [0m[35m        self.InternetMessageId = src_event.get("InternetMessageId")[0m
[30;1m156 | [0m[35m        self.Subject = src_event.get("Subject")[0m
[30;1m157 | [0m[35m        self.AntispamDirection = src_event.get("AntispamDirection")[0m
[30;1m158 | [0m[35m        self.DeliveryAction = src_event.get("DeliveryAction")[0m
[30;1m159 | [0m[35m        self.Language = src_event.get("Language")[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2459[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m        self.ReceivedDate = src_event.get("ReceiveDate")[0m
[30;1m154 | [0m[35m        self.NetworkMessageId = src_event.get("NetworkMessageId")[0m
[30;1m155 | [0m[35m        self.InternetMessageId = src_event.get("InternetMessageId")[0m
[30;1m156 | [0m[35m        self.Subject = src_event.get("Subject")[0m
[30;1m157 | [0m[35m        self.AntispamDirection = src_event.get("AntispamDirection")[0m
[30;1m158 | [0m[35m        self.DeliveryAction = src_event.get("DeliveryAction")[0m
[30;1m159 | [0m[35m        self.Language = src_event.get("Language")[0m

[31m--[ [0m[34mMatch #[0m[33m2460[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        self.P2SenderDomain = src_event.get("P2SenderDomain")[0m
[30;1m153 | [0m[35m        self.ReceivedDate = src_event.get("ReceiveDate")[0m
[30;1m154 | [0m[35m        self.NetworkMessageId = src_event.get("NetworkMessageId")[0m
[30;1m155 | [0m[35m        self.InternetMessageId = src_event.get("InternetMessageId")[0m
[30;1m156 | [0m[35m        self.Subject = src_event.get("Subject")[0m
[30;1m157 | [0m[35m        self.AntispamDirection = src_event.get("AntispamDirection")[0m
[30;1m158 | [0m[35m        self.DeliveryAction = src_event.get("DeliveryAction")[0m

[31m--[ [0m[34mMatch #[0m[33m2461[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m        self.P2SenderDisplayName = src_event.get("P2SenderDisplayName")[0m
[30;1m152 | [0m[35m        self.P2SenderDomain = src_event.get("P2SenderDomain")[0m
[30;1m153 | [0m[35m        self.ReceivedDate = src_event.get("ReceiveDate")[0m
[30;1m154 | [0m[35m        self.NetworkMessageId = src_event.get("NetworkMessageId")[0m
[30;1m155 | [0m[35m        self.InternetMessageId = src_event.get("InternetMessageId")[0m
[30;1m156 | [0m[35m        self.Subject = src_event.get("Subject")[0m
[30;1m157 | [0m[35m        self.AntispamDirection = src_event.get("AntispamDirection")[0m

[31m--[ [0m[34mMatch #[0m[33m2462[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m        self.P2Sender = src_event.get("P2Sender")[0m
[30;1m151 | [0m[35m        self.P2SenderDisplayName = src_event.get("P2SenderDisplayName")[0m
[30;1m152 | [0m[35m        self.P2SenderDomain = src_event.get("P2SenderDomain")[0m
[30;1m153 | [0m[35m        self.ReceivedDate = src_event.get("ReceiveDate")[0m
[30;1m154 | [0m[35m        self.NetworkMessageId = src_event.get("NetworkMessageId")[0m
[30;1m155 | [0m[35m        self.InternetMessageId = src_event.get("InternetMessageId")[0m
[30;1m156 | [0m[35m        self.Subject = src_event.get("Subject")[0m

[31m--[ [0m[34mMatch #[0m[33m2463[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m        self.P1SenderDomain = src_event.get("P1SenderDomain")[0m
[30;1m150 | [0m[35m        self.P2Sender = src_event.get("P2Sender")[0m
[30;1m151 | [0m[35m        self.P2SenderDisplayName = src_event.get("P2SenderDisplayName")[0m
[30;1m152 | [0m[35m        self.P2SenderDomain = src_event.get("P2SenderDomain")[0m
[30;1m153 | [0m[35m        self.ReceivedDate = src_event.get("ReceiveDate")[0m
[30;1m154 | [0m[35m        self.NetworkMessageId = src_event.get("NetworkMessageId")[0m
[30;1m155 | [0m[35m        self.InternetMessageId = src_event.get("InternetMessageId")[0m

[31m--[ [0m[34mMatch #[0m[33m2464[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        self.P1SenderDisplayName = src_event.get("P1SenderDisplayName")[0m
[30;1m149 | [0m[35m        self.P1SenderDomain = src_event.get("P1SenderDomain")[0m
[30;1m150 | [0m[35m        self.P2Sender = src_event.get("P2Sender")[0m
[30;1m151 | [0m[35m        self.P2SenderDisplayName = src_event.get("P2SenderDisplayName")[0m
[30;1m152 | [0m[35m        self.P2SenderDomain = src_event.get("P2SenderDomain")[0m
[30;1m153 | [0m[35m        self.ReceivedDate = src_event.get("ReceiveDate")[0m
[30;1m154 | [0m[35m        self.NetworkMessageId = src_event.get("NetworkMessageId")[0m

[31m--[ [0m[34mMatch #[0m[33m2465[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        self.P1Sender = src_event.get("P1Sender")[0m
[30;1m148 | [0m[35m        self.P1SenderDisplayName = src_event.get("P1SenderDisplayName")[0m
[30;1m149 | [0m[35m        self.P1SenderDomain = src_event.get("P1SenderDomain")[0m
[30;1m150 | [0m[35m        self.P2Sender = src_event.get("P2Sender")[0m
[30;1m151 | [0m[35m        self.P2SenderDisplayName = src_event.get("P2SenderDisplayName")[0m
[30;1m152 | [0m[35m        self.P2SenderDomain = src_event.get("P2SenderDomain")[0m
[30;1m153 | [0m[35m        self.ReceivedDate = src_event.get("ReceiveDate")[0m

[31m--[ [0m[34mMatch #[0m[33m2466[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m        self.SenderIP = src_event.get("SenderIP")[0m
[30;1m147 | [0m[35m        self.P1Sender = src_event.get("P1Sender")[0m
[30;1m148 | [0m[35m        self.P1SenderDisplayName = src_event.get("P1SenderDisplayName")[0m
[30;1m149 | [0m[35m        self.P1SenderDomain = src_event.get("P1SenderDomain")[0m
[30;1m150 | [0m[35m        self.P2Sender = src_event.get("P2Sender")[0m
[30;1m151 | [0m[35m        self.P2SenderDisplayName = src_event.get("P2SenderDisplayName")[0m
[30;1m152 | [0m[35m        self.P2SenderDomain = src_event.get("P2SenderDomain")[0m

[31m--[ [0m[34mMatch #[0m[33m2467[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m        self.Threats = src_event.get("Threats")[0m
[30;1m146 | [0m[35m        self.SenderIP = src_event.get("SenderIP")[0m
[30;1m147 | [0m[35m        self.P1Sender = src_event.get("P1Sender")[0m
[30;1m148 | [0m[35m        self.P1SenderDisplayName = src_event.get("P1SenderDisplayName")[0m
[30;1m149 | [0m[35m        self.P1SenderDomain = src_event.get("P1SenderDomain")[0m
[30;1m150 | [0m[35m        self.P2Sender = src_event.get("P2Sender")[0m
[30;1m151 | [0m[35m        self.P2SenderDisplayName = src_event.get("P2SenderDisplayName")[0m

[31m--[ [0m[34mMatch #[0m[33m2468[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m        self.Urls = src_event.get("Urls")[0m
[30;1m145 | [0m[35m        self.Threats = src_event.get("Threats")[0m
[30;1m146 | [0m[35m        self.SenderIP = src_event.get("SenderIP")[0m
[30;1m147 | [0m[35m        self.P1Sender = src_event.get("P1Sender")[0m
[30;1m148 | [0m[35m        self.P1SenderDisplayName = src_event.get("P1SenderDisplayName")[0m
[30;1m149 | [0m[35m        self.P1SenderDomain = src_event.get("P1SenderDomain")[0m
[30;1m150 | [0m[35m        self.P2Sender = src_event.get("P2Sender")[0m

[31m--[ [0m[34mMatch #[0m[33m2469[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        self.Files = src_event.get("FileEntityIds")[0m
[30;1m144 | [0m[35m        self.Urls = src_event.get("Urls")[0m
[30;1m145 | [0m[35m        self.Threats = src_event.get("Threats")[0m
[30;1m146 | [0m[35m        self.SenderIP = src_event.get("SenderIP")[0m
[30;1m147 | [0m[35m        self.P1Sender = src_event.get("P1Sender")[0m
[30;1m148 | [0m[35m        self.P1SenderDisplayName = src_event.get("P1SenderDisplayName")[0m
[30;1m149 | [0m[35m        self.P1SenderDomain = src_event.get("P1SenderDomain")[0m

[31m--[ [0m[34mMatch #[0m[33m2470[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m        self.Recipient = src_event.get("Recipient")[0m
[30;1m143 | [0m[35m        self.Files = src_event.get("FileEntityIds")[0m
[30;1m144 | [0m[35m        self.Urls = src_event.get("Urls")[0m
[30;1m145 | [0m[35m        self.Threats = src_event.get("Threats")[0m
[30;1m146 | [0m[35m        self.SenderIP = src_event.get("SenderIP")[0m
[30;1m147 | [0m[35m        self.P1Sender = src_event.get("P1Sender")[0m
[30;1m148 | [0m[35m        self.P1SenderDisplayName = src_event.get("P1SenderDisplayName")[0m

[31m--[ [0m[34mMatch #[0m[33m2471[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m142 | [0m[35m        self.Recipient = src_event.get("Recipient")[0m
[30;1m143 | [0m[35m        self.Files = src_event.get("FileEntityIds")[0m
[30;1m144 | [0m[35m        self.Urls = src_event.get("Urls")[0m
[30;1m145 | [0m[35m        self.Threats = src_event.get("Threats")[0m
[30;1m146 | [0m[35m        self.SenderIP = src_event.get("SenderIP")[0m
[30;1m147 | [0m[35m        self.P1Sender = src_event.get("P1Sender")[0m

[31m--[ [0m[34mMatch #[0m[33m2472[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m142 | [0m[35m        self.Recipient = src_event.get("Recipient")[0m
[30;1m143 | [0m[35m        self.Files = src_event.get("FileEntityIds")[0m
[30;1m144 | [0m[35m        self.Urls = src_event.get("Urls")[0m
[30;1m145 | [0m[35m        self.Threats = src_event.get("Threats")[0m
[30;1m146 | [0m[35m        self.SenderIP = src_event.get("SenderIP")[0m

[31m--[ [0m[34mMatch #[0m[33m2473[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m            self._create_from_event(src_event)[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m    def _create_from_event(self, src_event):[0m
[30;1m142 | [0m[35m        self.Recipient = src_event.get("Recipient")[0m
[30;1m143 | [0m[35m        self.Files = src_event.get("FileEntityIds")[0m
[30;1m144 | [0m[35m        self.Urls = src_event.get("Urls")[0m
[30;1m145 | [0m[35m        self.Threats = src_event.get("Threats")[0m

[31m--[ [0m[34mMatch #[0m[33m2474[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m    Language : str[0m
[30;1m76 | [0m[35m        Language of the Mail message[0m
[30;1m77 | [0m[35m    ThreatDetectionMethods : str[0m
[30;1m78 | [0m[35m        ThreatDetectionMethods of the Mail message[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    """[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2475[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m    DeliveryLocation : str[0m
[30;1m74 | [0m[35m        DeliveryLocation of the Mail message[0m
[30;1m75 | [0m[35m    Language : str[0m
[30;1m76 | [0m[35m        Language of the Mail message[0m
[30;1m77 | [0m[35m    ThreatDetectionMethods : str[0m
[30;1m78 | [0m[35m        ThreatDetectionMethods of the Mail message[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2476[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m    DeliveryAction : str[0m
[30;1m72 | [0m[35m        DeliveryAction of the Mail message[0m
[30;1m73 | [0m[35m    DeliveryLocation : str[0m
[30;1m74 | [0m[35m        DeliveryLocation of the Mail message[0m
[30;1m75 | [0m[35m    Language : str[0m
[30;1m76 | [0m[35m        Language of the Mail message[0m
[30;1m77 | [0m[35m    ThreatDetectionMethods : str[0m

[31m--[ [0m[34mMatch #[0m[33m2477[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m    AntispamDirection : str[0m
[30;1m70 | [0m[35m        AntispamDirection of the Mail message[0m
[30;1m71 | [0m[35m    DeliveryAction : str[0m
[30;1m72 | [0m[35m        DeliveryAction of the Mail message[0m
[30;1m73 | [0m[35m    DeliveryLocation : str[0m
[30;1m74 | [0m[35m        DeliveryLocation of the Mail message[0m
[30;1m75 | [0m[35m    Language : str[0m

[31m--[ [0m[34mMatch #[0m[33m2478[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m    BodyFingerprintBin5 : str[0m
[30;1m68 | [0m[35m        BodyFingerprintBin5 of the Mail message[0m
[30;1m69 | [0m[35m    AntispamDirection : str[0m
[30;1m70 | [0m[35m        AntispamDirection of the Mail message[0m
[30;1m71 | [0m[35m    DeliveryAction : str[0m
[30;1m72 | [0m[35m        DeliveryAction of the Mail message[0m
[30;1m73 | [0m[35m    DeliveryLocation : str[0m

[31m--[ [0m[34mMatch #[0m[33m2479[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m    BodyFingerprintBin4 : str[0m
[30;1m66 | [0m[35m        BodyFingerprintBin4 of the Mail message[0m
[30;1m67 | [0m[35m    BodyFingerprintBin5 : str[0m
[30;1m68 | [0m[35m        BodyFingerprintBin5 of the Mail message[0m
[30;1m69 | [0m[35m    AntispamDirection : str[0m
[30;1m70 | [0m[35m        AntispamDirection of the Mail message[0m
[30;1m71 | [0m[35m    DeliveryAction : str[0m

[31m--[ [0m[34mMatch #[0m[33m2480[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m    BodyFingerprintBin3 : str[0m
[30;1m64 | [0m[35m        BodyFingerprintBin3 of the Mail message[0m
[30;1m65 | [0m[35m    BodyFingerprintBin4 : str[0m
[30;1m66 | [0m[35m        BodyFingerprintBin4 of the Mail message[0m
[30;1m67 | [0m[35m    BodyFingerprintBin5 : str[0m
[30;1m68 | [0m[35m        BodyFingerprintBin5 of the Mail message[0m
[30;1m69 | [0m[35m    AntispamDirection : str[0m

[31m--[ [0m[34mMatch #[0m[33m2481[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m    BodyFingerprintBin2 : str[0m
[30;1m62 | [0m[35m        BodyFingerprintBin2 of the Mail message[0m
[30;1m63 | [0m[35m    BodyFingerprintBin3 : str[0m
[30;1m64 | [0m[35m        BodyFingerprintBin3 of the Mail message[0m
[30;1m65 | [0m[35m    BodyFingerprintBin4 : str[0m
[30;1m66 | [0m[35m        BodyFingerprintBin4 of the Mail message[0m
[30;1m67 | [0m[35m    BodyFingerprintBin5 : str[0m

[31m--[ [0m[34mMatch #[0m[33m2482[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m    BodyFingerprintBin1 : str[0m
[30;1m60 | [0m[35m        BodyFingerprintBin1 of the Mail message[0m
[30;1m61 | [0m[35m    BodyFingerprintBin2 : str[0m
[30;1m62 | [0m[35m        BodyFingerprintBin2 of the Mail message[0m
[30;1m63 | [0m[35m    BodyFingerprintBin3 : str[0m
[30;1m64 | [0m[35m        BodyFingerprintBin3 of the Mail message[0m
[30;1m65 | [0m[35m    BodyFingerprintBin4 : str[0m

[31m--[ [0m[34mMatch #[0m[33m2483[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    Subject : str[0m
[30;1m58 | [0m[35m        Subject of the Mail message[0m
[30;1m59 | [0m[35m    BodyFingerprintBin1 : str[0m
[30;1m60 | [0m[35m        BodyFingerprintBin1 of the Mail message[0m
[30;1m61 | [0m[35m    BodyFingerprintBin2 : str[0m
[30;1m62 | [0m[35m        BodyFingerprintBin2 of the Mail message[0m
[30;1m63 | [0m[35m    BodyFingerprintBin3 : str[0m

[31m--[ [0m[34mMatch #[0m[33m2484[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m    InternetMessageId : str[0m
[30;1m56 | [0m[35m        InternetMessageId of the Mail message[0m
[30;1m57 | [0m[35m    Subject : str[0m
[30;1m58 | [0m[35m        Subject of the Mail message[0m
[30;1m59 | [0m[35m    BodyFingerprintBin1 : str[0m
[30;1m60 | [0m[35m        BodyFingerprintBin1 of the Mail message[0m
[30;1m61 | [0m[35m    BodyFingerprintBin2 : str[0m

[31m--[ [0m[34mMatch #[0m[33m2485[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m    NetworkMessageId : str[0m
[30;1m54 | [0m[35m        NetworkMessageId of the Mail message[0m
[30;1m55 | [0m[35m    InternetMessageId : str[0m
[30;1m56 | [0m[35m        InternetMessageId of the Mail message[0m
[30;1m57 | [0m[35m    Subject : str[0m
[30;1m58 | [0m[35m        Subject of the Mail message[0m
[30;1m59 | [0m[35m    BodyFingerprintBin1 : str[0m

[31m--[ [0m[34mMatch #[0m[33m2486[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m    ReceivedDate : datetime[0m
[30;1m52 | [0m[35m        ReceivedDate of the Mail message[0m
[30;1m53 | [0m[35m    NetworkMessageId : str[0m
[30;1m54 | [0m[35m        NetworkMessageId of the Mail message[0m
[30;1m55 | [0m[35m    InternetMessageId : str[0m
[30;1m56 | [0m[35m        InternetMessageId of the Mail message[0m
[30;1m57 | [0m[35m    Subject : str[0m

[31m--[ [0m[34mMatch #[0m[33m2487[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m    P2SenderDomain : str[0m
[30;1m50 | [0m[35m        P2SenderDomain of the Mail message[0m
[30;1m51 | [0m[35m    ReceivedDate : datetime[0m
[30;1m52 | [0m[35m        ReceivedDate of the Mail message[0m
[30;1m53 | [0m[35m    NetworkMessageId : str[0m
[30;1m54 | [0m[35m        NetworkMessageId of the Mail message[0m
[30;1m55 | [0m[35m    InternetMessageId : str[0m

[31m--[ [0m[34mMatch #[0m[33m2488[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m    P2SenderDisplayName : str[0m
[30;1m48 | [0m[35m        P2SenderDisplayName of the Mail message[0m
[30;1m49 | [0m[35m    P2SenderDomain : str[0m
[30;1m50 | [0m[35m        P2SenderDomain of the Mail message[0m
[30;1m51 | [0m[35m    ReceivedDate : datetime[0m
[30;1m52 | [0m[35m        ReceivedDate of the Mail message[0m
[30;1m53 | [0m[35m    NetworkMessageId : str[0m

[31m--[ [0m[34mMatch #[0m[33m2489[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    P2Sender : str[0m
[30;1m46 | [0m[35m        P2Sender of the Mail message[0m
[30;1m47 | [0m[35m    P2SenderDisplayName : str[0m
[30;1m48 | [0m[35m        P2SenderDisplayName of the Mail message[0m
[30;1m49 | [0m[35m    P2SenderDomain : str[0m
[30;1m50 | [0m[35m        P2SenderDomain of the Mail message[0m
[30;1m51 | [0m[35m    ReceivedDate : datetime[0m

[31m--[ [0m[34mMatch #[0m[33m2490[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    SenderIP : str[0m
[30;1m44 | [0m[35m        SenderIP of the Mail message[0m
[30;1m45 | [0m[35m    P2Sender : str[0m
[30;1m46 | [0m[35m        P2Sender of the Mail message[0m
[30;1m47 | [0m[35m    P2SenderDisplayName : str[0m
[30;1m48 | [0m[35m        P2SenderDisplayName of the Mail message[0m
[30;1m49 | [0m[35m    P2SenderDomain : str[0m

[31m--[ [0m[34mMatch #[0m[33m2491[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    P1SenderDomain : str[0m
[30;1m42 | [0m[35m        P1SenderDomain of the Mail message[0m
[30;1m43 | [0m[35m    SenderIP : str[0m
[30;1m44 | [0m[35m        SenderIP of the Mail message[0m
[30;1m45 | [0m[35m    P2Sender : str[0m
[30;1m46 | [0m[35m        P2Sender of the Mail message[0m
[30;1m47 | [0m[35m    P2SenderDisplayName : str[0m

[31m--[ [0m[34mMatch #[0m[33m2492[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    P1SenderDisplayName : str[0m
[30;1m40 | [0m[35m        P1SenderDisplayName of the Mail message[0m
[30;1m41 | [0m[35m    P1SenderDomain : str[0m
[30;1m42 | [0m[35m        P1SenderDomain of the Mail message[0m
[30;1m43 | [0m[35m    SenderIP : str[0m
[30;1m44 | [0m[35m        SenderIP of the Mail message[0m
[30;1m45 | [0m[35m    P2Sender : str[0m

[31m--[ [0m[34mMatch #[0m[33m2493[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    P1Sender : str[0m
[30;1m38 | [0m[35m        P1Sender of the Mail message[0m
[30;1m39 | [0m[35m    P1SenderDisplayName : str[0m
[30;1m40 | [0m[35m        P1SenderDisplayName of the Mail message[0m
[30;1m41 | [0m[35m    P1SenderDomain : str[0m
[30;1m42 | [0m[35m        P1SenderDomain of the Mail message[0m
[30;1m43 | [0m[35m    SenderIP : str[0m

[31m--[ [0m[34mMatch #[0m[33m2494[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    Sender : str[0m
[30;1m36 | [0m[35m        Sender of the Mail message[0m
[30;1m37 | [0m[35m    P1Sender : str[0m
[30;1m38 | [0m[35m        P1Sender of the Mail message[0m
[30;1m39 | [0m[35m    P1SenderDisplayName : str[0m
[30;1m40 | [0m[35m        P1SenderDisplayName of the Mail message[0m
[30;1m41 | [0m[35m    P1SenderDomain : str[0m

[31m--[ [0m[34mMatch #[0m[33m2495[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m    Threats : List[str][0m
[30;1m34 | [0m[35m        Threats of the Mail message[0m
[30;1m35 | [0m[35m    Sender : str[0m
[30;1m36 | [0m[35m        Sender of the Mail message[0m
[30;1m37 | [0m[35m    P1Sender : str[0m
[30;1m38 | [0m[35m        P1Sender of the Mail message[0m
[30;1m39 | [0m[35m    P1SenderDisplayName : str[0m

[31m--[ [0m[34mMatch #[0m[33m2496[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    Urls : List[str][0m
[30;1m32 | [0m[35m        Urls of the Mail message[0m
[30;1m33 | [0m[35m    Threats : List[str][0m
[30;1m34 | [0m[35m        Threats of the Mail message[0m
[30;1m35 | [0m[35m    Sender : str[0m
[30;1m36 | [0m[35m        Sender of the Mail message[0m
[30;1m37 | [0m[35m    P1Sender : str[0m

[31m--[ [0m[34mMatch #[0m[33m2497[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    Files : List[Entity][0m
[30;1m30 | [0m[35m        Files of the Mail message[0m
[30;1m31 | [0m[35m    Urls : List[str][0m
[30;1m32 | [0m[35m        Urls of the Mail message[0m
[30;1m33 | [0m[35m    Threats : List[str][0m
[30;1m34 | [0m[35m        Threats of the Mail message[0m
[30;1m35 | [0m[35m    Sender : str[0m

[31m--[ [0m[34mMatch #[0m[33m2498[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    Recipient : str[0m
[30;1m28 | [0m[35m        Recipient of the Mail message[0m
[30;1m29 | [0m[35m    Files : List[Entity][0m
[30;1m30 | [0m[35m        Files of the Mail message[0m
[30;1m31 | [0m[35m    Urls : List[str][0m
[30;1m32 | [0m[35m        Urls of the Mail message[0m
[30;1m33 | [0m[35m    Threats : List[str][0m

[31m--[ [0m[34mMatch #[0m[33m2499[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/mail_message.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m    Attributes[0m
[30;1m26 | [0m[35m    ----------[0m
[30;1m27 | [0m[35m    Recipient : str[0m
[30;1m28 | [0m[35m        Recipient of the Mail message[0m
[30;1m29 | [0m[35m    Files : List[Entity][0m
[30;1m30 | [0m[35m        Files of the Mail message[0m
[30;1m31 | [0m[35m    Urls : List[str][0m

[31m--[ [0m[34mMatch #[0m[33m2500[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/logging.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35mdef _get_logging_config():[0m
[30;1m70 | [0m[35m    """Obtain logging configuration from environment or config."""[0m
[30;1m71 | [0m[35m    log_file = os.environ.get(_MP_LOG_FILE_ENV)[0m
[30;1m72 | [0m[35m    log_level = os.environ.get(_MP_LOG_LEVEL_ENV)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    log_file = log_file or get_config("Logging.FileName", None)[0m
[30;1m75 | [0m[35m    log_level = log_level or get_config("Logging.LogLevel", None)[0m

[31m--[ [0m[34mMatch #[0m[33m2501[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/logging.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mdef _get_logging_config():[0m
[30;1m70 | [0m[35m    """Obtain logging configuration from environment or config."""[0m
[30;1m71 | [0m[35m    log_file = os.environ.get(_MP_LOG_FILE_ENV)[0m
[30;1m72 | [0m[35m    log_level = os.environ.get(_MP_LOG_LEVEL_ENV)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    log_file = log_file or get_config("Logging.FileName", None)[0m

[31m--[ [0m[34mMatch #[0m[33m2502[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m366 | [0m[35m        type: str[0m
[30;1m367 | [0m[35m        default: "CommonSecurityLog"[0m
[30;1m368 | [0m[35m      ip_address:[0m
[30;1m369 | [0m[35m        description: IP address of host[0m
[30;1m370 | [0m[35m        type: str[0m
[30;1m371 | [0m[35m        default: ""[0m

[31m--[ [0m[34mMatch #[0m[33m2503[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m349 | [0m[35m      pivot:[0m
[30;1m350 | [0m[35m        short_name: hosts_csl[0m
[30;1m351 | [0m[35m        direct_func_entities:[0m
[30;1m352 | [0m[35m          - IP[0m
[30;1m353 | [0m[35m    args:[0m
[30;1m354 | [0m[35m      query: '[0m
[30;1m355 | [0m[35m        {table}[0m

[31m--[ [0m[34mMatch #[0m[33m2504[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m344 | [0m[35m        type: str[0m
[30;1m345 | [0m[35m        default: ""[0m
[30;1m346 | [0m[35m  hosts_by_ip_csl:[0m
[30;1m347 | [0m[35m    description: Returns hosts associated with a IP addresses (CommonSecurityLog)[0m
[30;1m348 | [0m[35m    metadata:[0m
[30;1m349 | [0m[35m      pivot:[0m
[30;1m350 | [0m[35m        short_name: hosts_csl[0m

[31m--[ [0m[34mMatch #[0m[33m2505[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m318 | [0m[35m        type: str[0m
[30;1m319 | [0m[35m        default: "CommonSecurityLog"[0m
[30;1m320 | [0m[35m  ips_by_host_csl:[0m
[30;1m321 | [0m[35m    description: Returns all IP addresses associated with a host (CommonSecurityLog)[0m
[30;1m322 | [0m[35m    metadata:[0m
[30;1m323 | [0m[35m      pivot:[0m
[30;1m324 | [0m[35m        short_name: ips_csl[0m

[31m--[ [0m[34mMatch #[0m[33m2506[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m        type: str[0m
[30;1m303 | [0m[35m        default: ""[0m
[30;1m304 | [0m[35m  all_network_connections_csl:[0m
[30;1m305 | [0m[35m    description: Returns all network connections for a time range (CommonSecurityLog)[0m
[30;1m306 | [0m[35m    args:[0m
[30;1m307 | [0m[35m      query: "[0m
[30;1m308 | [0m[35m        {table}[0m

[31m--[ [0m[34mMatch #[0m[33m2507[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m        type: str[0m
[30;1m299 | [0m[35m        default: "CommonSecurityLog"[0m
[30;1m300 | [0m[35m      ip_address:[0m
[30;1m301 | [0m[35m        description: IP address of host[0m
[30;1m302 | [0m[35m        type: str[0m
[30;1m303 | [0m[35m        default: ""[0m
[30;1m304 | [0m[35m  all_network_connections_csl:[0m

[31m--[ [0m[34mMatch #[0m[33m2508[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m282 | [0m[35m      pivot:[0m
[30;1m283 | [0m[35m        short_name: ip_connections_csl[0m
[30;1m284 | [0m[35m        direct_func_entities:[0m
[30;1m285 | [0m[35m          - IP[0m
[30;1m286 | [0m[35m    args:[0m
[30;1m287 | [0m[35m      query: '[0m
[30;1m288 | [0m[35m        {table}[0m

[31m--[ [0m[34mMatch #[0m[33m2509[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m277 | [0m[35m        type: str[0m
[30;1m278 | [0m[35m        default: ""[0m
[30;1m279 | [0m[35m  ip_network_connections_csl:[0m
[30;1m280 | [0m[35m    description: Returns network connections to and from an IP address (CommonSecurityLog)[0m
[30;1m281 | [0m[35m    metadata:[0m
[30;1m282 | [0m[35m      pivot:[0m
[30;1m283 | [0m[35m        short_name: ip_connections_csl[0m

[31m--[ [0m[34mMatch #[0m[33m2510[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m        description: Query start time[0m
[30;1m218 | [0m[35m        type: datetime[0m
[30;1m219 | [0m[35m      end:[0m
[30;1m220 | [0m[35m        description: Query end time[0m
[30;1m221 | [0m[35m        type: datetime[0m
[30;1m222 | [0m[35m      table:[0m
[30;1m223 | [0m[35m        description: Table name[0m

[31m--[ [0m[34mMatch #[0m[33m2511[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35m        type: str[0m
[30;1m215 | [0m[35m        default: *azure_network_project[0m
[30;1m216 | [0m[35m      start:[0m
[30;1m217 | [0m[35m        description: Query start time[0m
[30;1m218 | [0m[35m        type: datetime[0m
[30;1m219 | [0m[35m      end:[0m
[30;1m220 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2512[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m183 | [0m[35m        description: Query start time[0m
[30;1m184 | [0m[35m        type: datetime[0m
[30;1m185 | [0m[35m      end:[0m
[30;1m186 | [0m[35m        description: Query end time[0m
[30;1m187 | [0m[35m        type: datetime[0m
[30;1m188 | [0m[35m      table:[0m
[30;1m189 | [0m[35m        description: Table name[0m

[31m--[ [0m[34mMatch #[0m[33m2513[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m        description: Column project statement[0m
[30;1m181 | [0m[35m        type: list[0m
[30;1m182 | [0m[35m      start:[0m
[30;1m183 | [0m[35m        description: Query start time[0m
[30;1m184 | [0m[35m        type: datetime[0m
[30;1m185 | [0m[35m      end:[0m
[30;1m186 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2514[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m        type: str[0m
[30;1m164 | [0m[35m        default: Heartbeat[0m
[30;1m165 | [0m[35m  list_azure_network_flows_by_ip:[0m
[30;1m166 | [0m[35m    description: Returns Azure NSG flow events for an IP Address.[0m
[30;1m167 | [0m[35m    metadata:[0m
[30;1m168 | [0m[35m      pivot:[0m
[30;1m169 | [0m[35m        short_name: net_flows[0m

[31m--[ [0m[34mMatch #[0m[33m2515[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m        {add_query_items}'[0m
[30;1m157 | [0m[35m    parameters:[0m
[30;1m158 | [0m[35m      ip_address:[0m
[30;1m159 | [0m[35m        description: IP Address[0m
[30;1m160 | [0m[35m        type: str[0m
[30;1m161 | [0m[35m      table:[0m
[30;1m162 | [0m[35m        description: Table name[0m

[31m--[ [0m[34mMatch #[0m[33m2516[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m      query: '[0m
[30;1m153 | [0m[35m        {table}[0m
[30;1m154 | [0m[35m        | where ComputerIP == "{ip_address}"[0m
[30;1m155 | [0m[35m        | top 1 by TimeGenerated desc nulls last[0m
[30;1m156 | [0m[35m        {add_query_items}'[0m
[30;1m157 | [0m[35m    parameters:[0m
[30;1m158 | [0m[35m      ip_address:[0m

[31m--[ [0m[34mMatch #[0m[33m2517[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m        type: str[0m
[30;1m142 | [0m[35m        default: Heartbeat[0m
[30;1m143 | [0m[35m  get_heartbeat_for_ip:[0m
[30;1m144 | [0m[35m    description: Returns latest OMS Heartbeat event for ip address.[0m
[30;1m145 | [0m[35m    metadata:[0m
[30;1m146 | [0m[35m      data_families: [AzureNetwork, Network, Heartbeat][0m
[30;1m147 | [0m[35m      pivot:[0m

[31m--[ [0m[34mMatch #[0m[33m2518[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m      query: '[0m
[30;1m131 | [0m[35m        {table}[0m
[30;1m132 | [0m[35m        | where Computer has "{host_name}"[0m
[30;1m133 | [0m[35m        | top 1 by TimeGenerated desc nulls last[0m
[30;1m134 | [0m[35m        {add_query_items}'[0m
[30;1m135 | [0m[35m    parameters:[0m
[30;1m136 | [0m[35m      host_name:[0m

[31m--[ [0m[34mMatch #[0m[33m2519[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m        {add_query_items}'[0m
[30;1m113 | [0m[35m    parameters:[0m
[30;1m114 | [0m[35m      ip_address:[0m
[30;1m115 | [0m[35m        description: IP Address[0m
[30;1m116 | [0m[35m        type: str[0m
[30;1m117 | [0m[35m      table:[0m
[30;1m118 | [0m[35m        description: Table name[0m

[31m--[ [0m[34mMatch #[0m[33m2520[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m        | where PrivateIPAddresses_s has "{ip_address}"[0m
[30;1m106 | [0m[35m        or PublicIPAddresses_s has "{ip_address}"[0m
[30;1m107 | [0m[35m        | where ResourceType == "NetworkInterface"[0m
[30;1m108 | [0m[35m        | top 1 by TimeGenerated desc[0m
[30;1m109 | [0m[35m        | project-rename PrivateIPAddresses = PrivateIPAddresses_s,[0m
[30;1m110 | [0m[35m        PublicIPAddresses = PublicIPAddresses_s, VirtualMachine = VirtualMachine_s[0m
[30;1m111 | [0m[35m        | extend Computer = split(VirtualMachine, "/")[-1][0m

[31m--[ [0m[34mMatch #[0m[33m2521[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m        type: str[0m
[30;1m94 | [0m[35m        default: AzureNetworkAnalytics_CL[0m
[30;1m95 | [0m[35m  get_host_for_ip:[0m
[30;1m96 | [0m[35m    description: Returns the most recent Azure NSG Interface event for an IP Address.[0m
[30;1m97 | [0m[35m    metadata:[0m
[30;1m98 | [0m[35m      pivot:[0m
[30;1m99 | [0m[35m        short_name: interface[0m

[31m--[ [0m[34mMatch #[0m[33m2522[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m        {table}[0m
[30;1m81 | [0m[35m        | where VirtualMachine_s has "{host_name}"[0m
[30;1m82 | [0m[35m        | where ResourceType == "NetworkInterface"[0m
[30;1m83 | [0m[35m        | top 1 by TimeGenerated desc[0m
[30;1m84 | [0m[35m        | project-rename PrivateIPAddresses = PrivateIPAddresses_s,[0m
[30;1m85 | [0m[35m        PublicIPAddresses = PublicIPAddresses_s[0m
[30;1m86 | [0m[35m        {add_query_items}'[0m

[31m--[ [0m[34mMatch #[0m[33m2523[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m      type: str[0m
[30;1m65 | [0m[35m      default: "SourceIP"[0m
[30;1m66 | [0m[35m    dest_ip_field:[0m
[30;1m67 | [0m[35m      description: The column name containing destination IP[0m
[30;1m68 | [0m[35m      type: str[0m
[30;1m69 | [0m[35m      default: "DestinationIP"[0m
[30;1m70 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m2524[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m      type: list[0m
[30;1m61 | [0m[35m      default: ["Palo Alto Networks", "Fortinet", "Cisco", "Check Point"][0m
[30;1m62 | [0m[35m    source_ip_field:[0m
[30;1m63 | [0m[35m      description: The column name containing source IP[0m
[30;1m64 | [0m[35m      type: str[0m
[30;1m65 | [0m[35m      default: "SourceIP"[0m
[30;1m66 | [0m[35m    dest_ip_field:[0m

[31m--[ [0m[34mMatch #[0m[33m2525[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m      description: Query start time[0m
[30;1m54 | [0m[35m      type: datetime[0m
[30;1m55 | [0m[35m    end:[0m
[30;1m56 | [0m[35m      description: Query end time[0m
[30;1m57 | [0m[35m      type: datetime[0m
[30;1m58 | [0m[35m    vendors:[0m
[30;1m59 | [0m[35m      description: Vendors to filter queries on[0m

[31m--[ [0m[34mMatch #[0m[33m2526[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_net.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m      type: str[0m
[30;1m51 | [0m[35m      default: ""[0m
[30;1m52 | [0m[35m    start:[0m
[30;1m53 | [0m[35m      description: Query start time[0m
[30;1m54 | [0m[35m      type: datetime[0m
[30;1m55 | [0m[35m    end:[0m
[30;1m56 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2527[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m        {add_query_items}'[0m
[30;1m244 | [0m[35m    parameters:[0m
[30;1m245 | [0m[35m      ip_address:[0m
[30;1m246 | [0m[35m        description: The IP Address to find[0m
[30;1m247 | [0m[35m        type: str[0m
[30;1m248 | [0m[35m      event_filter:[0m
[30;1m249 | [0m[35m        description: Event ID filter[0m

[31m--[ [0m[34mMatch #[0m[33m2528[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m        {add_query_items}'[0m
[30;1m244 | [0m[35m    parameters:[0m
[30;1m245 | [0m[35m      ip_address:[0m
[30;1m246 | [0m[35m        description: The IP Address to find[0m
[30;1m247 | [0m[35m        type: str[0m
[30;1m248 | [0m[35m      event_filter:[0m
[30;1m249 | [0m[35m        description: Event ID filter[0m

[31m--[ [0m[34mMatch #[0m[33m2529[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m        type: str[0m
[30;1m226 | [0m[35m        default: "| where EventID in (4624, 4625)"[0m
[30;1m227 | [0m[35m  list_logon_attempts_by_ip:[0m
[30;1m228 | [0m[35m    description: Returns the logon events for an IP Address (all hosts)[0m
[30;1m229 | [0m[35m    metadata:[0m
[30;1m230 | [0m[35m      pivot:[0m
[30;1m231 | [0m[35m        short_name: logon_attempts[0m

[31m--[ [0m[34mMatch #[0m[33m2530[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m        {add_query_items}'[0m
[30;1m192 | [0m[35m    parameters:[0m
[30;1m193 | [0m[35m      account_name:[0m
[30;1m194 | [0m[35m        description: The account name to find[0m
[30;1m195 | [0m[35m        type: str[0m
[30;1m196 | [0m[35m      event_filter:[0m
[30;1m197 | [0m[35m        description: Event ID filter[0m

[31m--[ [0m[34mMatch #[0m[33m2531[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m        {add_query_items}'[0m
[30;1m167 | [0m[35m    parameters:[0m
[30;1m168 | [0m[35m      account_name:[0m
[30;1m169 | [0m[35m        description: The account name to find[0m
[30;1m170 | [0m[35m        type: str[0m
[30;1m171 | [0m[35m      event_filter:[0m
[30;1m172 | [0m[35m        description: Event ID filter[0m

[31m--[ [0m[34mMatch #[0m[33m2532[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m        {add_query_items}'[0m
[30;1m146 | [0m[35m    parameters:[0m
[30;1m147 | [0m[35m      account_name:[0m
[30;1m148 | [0m[35m        description: The account name to find[0m
[30;1m149 | [0m[35m        type: str[0m
[30;1m150 | [0m[35m  list_logon_attempts_by_account:[0m
[30;1m151 | [0m[35m    description: Retrieves all logon events for an account (all hosts)[0m

[31m--[ [0m[34mMatch #[0m[33m2533[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m        description: Name of host[0m
[30;1m103 | [0m[35m        type: str[0m
[30;1m104 | [0m[35m  list_host_logon_failures:[0m
[30;1m105 | [0m[35m    description: Returns the logon failure events on a host for time range[0m
[30;1m106 | [0m[35m    metadata:[0m
[30;1m107 | [0m[35m      pivot:[0m
[30;1m108 | [0m[35m        short_name: logon_failures[0m

[31m--[ [0m[34mMatch #[0m[33m2534[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        description: The logon session ID of the source process[0m
[30;1m82 | [0m[35m        type: str[0m
[30;1m83 | [0m[35m  list_host_logons:[0m
[30;1m84 | [0m[35m    description: Returns the logon events on a host for time range[0m
[30;1m85 | [0m[35m    metadata:[0m
[30;1m86 | [0m[35m      pivot:[0m
[30;1m87 | [0m[35m        short_name: logons[0m

[31m--[ [0m[34mMatch #[0m[33m2535[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m      description: Query start time[0m
[30;1m47 | [0m[35m      type: datetime[0m
[30;1m48 | [0m[35m    end:[0m
[30;1m49 | [0m[35m      description: Query end time[0m
[30;1m50 | [0m[35m      type: datetime[0m
[30;1m51 | [0m[35m    add_query_items:[0m
[30;1m52 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m2536[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_logon.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m        WorkstationName[0m
[30;1m44 | [0m[35m        | extend TimeCreatedUtc=TimeGenerated"[0m
[30;1m45 | [0m[35m    start:[0m
[30;1m46 | [0m[35m      description: Query start time[0m
[30;1m47 | [0m[35m      type: datetime[0m
[30;1m48 | [0m[35m    end:[0m
[30;1m49 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2537[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/ce_azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m    These can be overridden by settings of individual component settings. The options are:[0m
[30;1m33 | [0m[35m    <ul>[0m
[30;1m34 | [0m[35m    <li>env - take credential information from environment variables</li>[0m
[30;1m35 | [0m[35m    <li>msi - use Managed Service Identity credentials, if available</li>[0m
[30;1m36 | [0m[35m    <li>cli - use Azure CLI credentials, if available</li>[0m
[30;1m37 | [0m[35m    <li>interactive - use interactive browser authentication</li>[0m
[30;1m38 | [0m[35m    <li>vscode" - to use VSCode credentials</li>[0m

[31m--[ [0m[34mMatch #[0m[33m2538[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/analysis/cluster_auditd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m    audit_data : pd.DataFrame[0m
[30;1m23 | [0m[35m        The Audit data containing process creation events[0m
[30;1m24 | [0m[35m    app: str, optional[0m
[30;1m25 | [0m[35m        The name of a specific app you wish to cluster[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    Returns[0m
[30;1m28 | [0m[35m    -------[0m

[31m--[ [0m[34mMatch #[0m[33m2539[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_file.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m      type: str[0m
[30;1m24 | [0m[35m      default: ""[0m
[30;1m25 | [0m[35m    time_column:[0m
[30;1m26 | [0m[35m      description: The name of the column detailing the time the event was generated.[0m
[30;1m27 | [0m[35m      type: str[0m
[30;1m28 | [0m[35m      default: "Timestamp"[0m
[30;1m29 | [0m[35msources:[0m

[31m--[ [0m[34mMatch #[0m[33m2540[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_file.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m
[30;1m20 | [0m[35m      type: datetime[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m2541[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_file.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m      type: str[0m
[30;1m14 | [0m[35m      default: "DeviceFileEvents"[0m
[30;1m15 | [0m[35m    start:[0m
[30;1m16 | [0m[35m      description: Query start time[0m
[30;1m17 | [0m[35m      type: datetime[0m
[30;1m18 | [0m[35m    end:[0m
[30;1m19 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2542[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_identity.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m      uri: None[0m
[30;1m56 | [0m[35m    parameters:[0m
[30;1m57 | [0m[35m      ip_address:[0m
[30;1m58 | [0m[35m        description: Source IP address of logons[0m
[30;1m59 | [0m[35m        type: str[0m
[30;1m60 | [0m[35m  logons_for_host:[0m
[30;1m61 | [0m[35m    description: Return all Active Directory on-premises user logons for host/device name[0m

[31m--[ [0m[34mMatch #[0m[33m2543[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_identity.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m        description: Name or part name of user/UPN[0m
[30;1m44 | [0m[35m        type: str[0m
[30;1m45 | [0m[35m  logons_for_ip:[0m
[30;1m46 | [0m[35m    description: Return all Active Directory on-premises user logons for ip address[0m
[30;1m47 | [0m[35m    metadata:[0m
[30;1m48 | [0m[35m    args:[0m
[30;1m49 | [0m[35m      query: '[0m

[31m--[ [0m[34mMatch #[0m[33m2544[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_identity.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m      type: str[0m
[30;1m20 | [0m[35m      default: ""[0m
[30;1m21 | [0m[35m    time_column:[0m
[30;1m22 | [0m[35m      description: The name of the column detailing the time the event was generated.[0m
[30;1m23 | [0m[35m      type: str[0m
[30;1m24 | [0m[35m      default: "Timestamp"[0m
[30;1m25 | [0m[35m    table:[0m

[31m--[ [0m[34mMatch #[0m[33m2545[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_identity.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m
[30;1m16 | [0m[35m      type: datetime[0m
[30;1m17 | [0m[35m    add_query_items:[0m
[30;1m18 | [0m[35m      description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m2546[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/m365d/kql_m365_identity.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    data_source: "user_events"[0m
[30;1m10 | [0m[35m  parameters:[0m
[30;1m11 | [0m[35m    start:[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2547[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/soc/incident.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m            self.Alerts = new_alerts[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    _entity_schema = {[0m
[30;1m125 | [0m[35m        # Time the Incident was Generated[0m
[30;1m126 | [0m[35m        "TimeGenerated": None,[0m
[30;1m127 | [0m[35m        # Incident Name[0m
[30;1m128 | [0m[35m        "DisplayName": None,[0m

[31m--[ [0m[34mMatch #[0m[33m2548[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m                "%Y-%m-%dT%H:%M:%S.%fZ",[0m
[30;1m141 | [0m[35m            ).replace(tzinfo=dt.timezone.utc),[0m
[30;1m142 | [0m[35m            "last_update": dt.datetime.strptime([0m
[30;1m143 | [0m[35m                response["RawResult"].get("lastUpdateDate", None),[0m
[30;1m144 | [0m[35m                "%Y-%m-%dT%H:%M:%S.%fZ",[0m
[30;1m145 | [0m[35m            ).replace(tzinfo=dt.timezone.utc),[0m
[30;1m146 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m2549[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                "%Y-%m-%dT%H:%M:%S.%fZ",[0m
[30;1m137 | [0m[35m            ).replace(tzinfo=dt.timezone.utc),[0m
[30;1m138 | [0m[35m            "last_seen": dt.datetime.strptime([0m
[30;1m139 | [0m[35m                response["RawResult"].get("lastSeen", None),[0m
[30;1m140 | [0m[35m                "%Y-%m-%dT%H:%M:%S.%fZ",[0m
[30;1m141 | [0m[35m            ).replace(tzinfo=dt.timezone.utc),[0m
[30;1m142 | [0m[35m            "last_update": dt.datetime.strptime([0m

[31m--[ [0m[34mMatch #[0m[33m2550[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m            "campaigns": response["RawResult"].get("relatedCampaigns", []),[0m
[30;1m133 | [0m[35m            "score": response["RawResult"].get("score", 0),[0m
[30;1m134 | [0m[35m            "first_seen": dt.datetime.strptime([0m
[30;1m135 | [0m[35m                response["RawResult"].get("firstSeen", None),[0m
[30;1m136 | [0m[35m                "%Y-%m-%dT%H:%M:%S.%fZ",[0m
[30;1m137 | [0m[35m            ).replace(tzinfo=dt.timezone.utc),[0m
[30;1m138 | [0m[35m            "last_seen": dt.datetime.strptime([0m

[31m--[ [0m[34mMatch #[0m[33m2551[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m            + response["RawResult"].get("SystemTags", []),[0m
[30;1m131 | [0m[35m            "malware": response["RawResult"].get("relatedMalware", []),[0m
[30;1m132 | [0m[35m            "campaigns": response["RawResult"].get("relatedCampaigns", []),[0m
[30;1m133 | [0m[35m            "score": response["RawResult"].get("score", 0),[0m
[30;1m134 | [0m[35m            "first_seen": dt.datetime.strptime([0m
[30;1m135 | [0m[35m                response["RawResult"].get("firstSeen", None),[0m
[30;1m136 | [0m[35m                "%Y-%m-%dT%H:%M:%S.%fZ",[0m

[31m--[ [0m[34mMatch #[0m[33m2552[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m            "tags": response["RawResult"].get("tags", [])[0m
[30;1m130 | [0m[35m            + response["RawResult"].get("SystemTags", []),[0m
[30;1m131 | [0m[35m            "malware": response["RawResult"].get("relatedMalware", []),[0m
[30;1m132 | [0m[35m            "campaigns": response["RawResult"].get("relatedCampaigns", []),[0m
[30;1m133 | [0m[35m            "score": response["RawResult"].get("score", 0),[0m
[30;1m134 | [0m[35m            "first_seen": dt.datetime.strptime([0m
[30;1m135 | [0m[35m                response["RawResult"].get("firstSeen", None),[0m

[31m--[ [0m[34mMatch #[0m[33m2553[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m            "response_code": response["Status"],[0m
[30;1m129 | [0m[35m            "tags": response["RawResult"].get("tags", [])[0m
[30;1m130 | [0m[35m            + response["RawResult"].get("SystemTags", []),[0m
[30;1m131 | [0m[35m            "malware": response["RawResult"].get("relatedMalware", []),[0m
[30;1m132 | [0m[35m            "campaigns": response["RawResult"].get("relatedCampaigns", []),[0m
[30;1m133 | [0m[35m            "score": response["RawResult"].get("score", 0),[0m
[30;1m134 | [0m[35m            "first_seen": dt.datetime.strptime([0m

[31m--[ [0m[34mMatch #[0m[33m2554[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m            "geolocation": response["RawResult"].get("geolocation", None),[0m
[30;1m128 | [0m[35m            "response_code": response["Status"],[0m
[30;1m129 | [0m[35m            "tags": response["RawResult"].get("tags", [])[0m
[30;1m130 | [0m[35m            + response["RawResult"].get("SystemTags", []),[0m
[30;1m131 | [0m[35m            "malware": response["RawResult"].get("relatedMalware", []),[0m
[30;1m132 | [0m[35m            "campaigns": response["RawResult"].get("relatedCampaigns", []),[0m
[30;1m133 | [0m[35m            "score": response["RawResult"].get("score", 0),[0m

[31m--[ [0m[34mMatch #[0m[33m2555[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m            "threat_actors": response["RawResult"].get("relatedThreatActors", ""),[0m
[30;1m127 | [0m[35m            "geolocation": response["RawResult"].get("geolocation", None),[0m
[30;1m128 | [0m[35m            "response_code": response["Status"],[0m
[30;1m129 | [0m[35m            "tags": response["RawResult"].get("tags", [])[0m
[30;1m130 | [0m[35m            + response["RawResult"].get("SystemTags", []),[0m
[30;1m131 | [0m[35m            "malware": response["RawResult"].get("relatedMalware", []),[0m
[30;1m132 | [0m[35m            "campaigns": response["RawResult"].get("relatedCampaigns", []),[0m

[31m--[ [0m[34mMatch #[0m[33m2556[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        sev: str = response["RawResult"].get("severity", "Low")[0m
[30;1m125 | [0m[35m        result_dict: dict[str, Any] = {[0m
[30;1m126 | [0m[35m            "threat_actors": response["RawResult"].get("relatedThreatActors", ""),[0m
[30;1m127 | [0m[35m            "geolocation": response["RawResult"].get("geolocation", None),[0m
[30;1m128 | [0m[35m            "response_code": response["Status"],[0m
[30;1m129 | [0m[35m            "tags": response["RawResult"].get("tags", [])[0m
[30;1m130 | [0m[35m            + response["RawResult"].get("SystemTags", []),[0m

[31m--[ [0m[34mMatch #[0m[33m2557[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        sev: str = response["RawResult"].get("severity", "Low")[0m
[30;1m125 | [0m[35m        result_dict: dict[str, Any] = {[0m
[30;1m126 | [0m[35m            "threat_actors": response["RawResult"].get("relatedThreatActors", ""),[0m
[30;1m127 | [0m[35m            "geolocation": response["RawResult"].get("geolocation", None),[0m
[30;1m128 | [0m[35m            "response_code": response["Status"],[0m
[30;1m129 | [0m[35m            "tags": response["RawResult"].get("tags", [])[0m

[31m--[ [0m[34mMatch #[0m[33m2558[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m        if response["RawResult"].get("whitelisted", False):[0m
[30;1m122 | [0m[35m            return False, ResultSeverity.information, "Whitelisted."[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        sev: str = response["RawResult"].get("severity", "Low")[0m
[30;1m125 | [0m[35m        result_dict: dict[str, Any] = {[0m
[30;1m126 | [0m[35m            "threat_actors": response["RawResult"].get("relatedThreatActors", ""),[0m
[30;1m127 | [0m[35m            "geolocation": response["RawResult"].get("geolocation", None),[0m

[31m--[ [0m[34mMatch #[0m[33m2559[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/context/tiproviders/intsights.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        ):[0m
[30;1m119 | [0m[35m            return False, ResultSeverity.information, "Not found."[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m        if response["RawResult"].get("whitelisted", False):[0m
[30;1m122 | [0m[35m            return False, ResultSeverity.information, "Whitelisted."[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        sev: str = response["RawResult"].get("severity", "Low")[0m

[31m--[ [0m[34mMatch #[0m[33m2560[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m536 | [0m[35m        if val_type in ("enum", "m_enum"):[0m
[30;1m537 | [0m[35m            return widgets.SelectMultiple([0m
[30;1m538 | [0m[35m                description=name,[0m
[30;1m539 | [0m[35m                options=val_opts.get("options"),[0m
[30;1m540 | [0m[35m                value=curr_value or [],[0m
[30;1m541 | [0m[35m                style=self._W_STYLE,[0m
[30;1m542 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m2561[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m    def _create_select_ctrl(self, ctrl_defn, name, curr_value):[0m
[30;1m518 | [0m[35m        val_type, val_opts = ctrl_defn[0m
[30;1m519 | [0m[35m        if curr_value is None:[0m
[30;1m520 | [0m[35m            curr_value = val_opts.get("default")[0m
[30;1m521 | [0m[35m[0m
[30;1m522 | [0m[35m        if val_type == "str":[0m
[30;1m523 | [0m[35m            return widgets.Text([0m

[31m--[ [0m[34mMatch #[0m[33m2562[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m457 | [0m[35m            if not isinstance(ctrl_map.get(elem), dict):[0m
[30;1m458 | [0m[35m                ctrl_map[elem] = ctrl[0m
[30;1m459 | [0m[35m                break[0m
[30;1m460 | [0m[35m            ctrl_map = ctrl_map.get(elem)[0m
[30;1m461 | [0m[35m[0m
[30;1m462 | [0m[35m    @property[0m
[30;1m463 | [0m[35m    def value(self) -> Union[str, Dict[str, Optional[str]]]:[0m

[31m--[ [0m[34mMatch #[0m[33m2563[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m454 | [0m[35m        ctrl_path = path.replace(f"{self.comp_path}.", "")[0m
[30;1m455 | [0m[35m        ctrl_map = self.control_map[0m
[30;1m456 | [0m[35m        for elem in ctrl_path.split("."):[0m
[30;1m457 | [0m[35m            if not isinstance(ctrl_map.get(elem), dict):[0m
[30;1m458 | [0m[35m                ctrl_map[elem] = ctrl[0m
[30;1m459 | [0m[35m                break[0m
[30;1m460 | [0m[35m            ctrl_map = ctrl_map.get(elem)[0m

[31m--[ [0m[34mMatch #[0m[33m2564[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m376 | [0m[35m        if not value or isinstance(value, str):[0m
[30;1m377 | [0m[35m            value = {}[0m
[30;1m378 | [0m[35m        self.txt_alias.value = value.get("alias", "")[0m
[30;1m379 | [0m[35m        self.cb_connect.value = value.get("connect", True)[0m
[30;1m380 | [0m[35m[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35mclass UserDefLoadComponent(SettingsControl):[0m

[31m--[ [0m[34mMatch #[0m[33m2565[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m        """[0m
[30;1m376 | [0m[35m        if not value or isinstance(value, str):[0m
[30;1m377 | [0m[35m            value = {}[0m
[30;1m378 | [0m[35m        self.txt_alias.value = value.get("alias", "")[0m
[30;1m379 | [0m[35m        self.cb_connect.value = value.get("connect", True)[0m
[30;1m380 | [0m[35m[0m
[30;1m381 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2566[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m        if self.rb_store_type.value == STORE_TEXT:[0m
[30;1m189 | [0m[35m            sec_value = self.txt_val.value[0m
[30;1m190 | [0m[35m        elif self.rb_store_type.value == STORE_ENV_VAR:[0m
[30;1m191 | [0m[35m            sec_value = os.environ.get(self.txt_val.value.strip())[0m
[30;1m192 | [0m[35m        else:[0m
[30;1m193 | [0m[35m            return[0m
[30;1m194 | [0m[35m        if not sec_value:[0m

[31m--[ [0m[34mMatch #[0m[33m2567[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        """Disable the text field if KeyVault and kv_def_enabled."""[0m
[30;1m165 | [0m[35m        if self.rb_store_type.value != STORE_KEYVAULT:[0m
[30;1m166 | [0m[35m            return[0m
[30;1m167 | [0m[35m        kv_def_enabled = change.get("new")[0m
[30;1m168 | [0m[35m        if kv_def_enabled:[0m
[30;1m169 | [0m[35m            self.txt_val.value = ""[0m
[30;1m170 | [0m[35m        self.txt_val.disabled = kv_def_enabled[0m

[31m--[ [0m[34mMatch #[0m[33m2568[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m    def _change_store(self, change):[0m
[30;1m155 | [0m[35m        """Handle event for store type radio button."""[0m
[30;1m156 | [0m[35m        st_type = change.get("new")[0m
[30;1m157 | [0m[35m        self.txt_val.description = "Value" if st_type == STORE_TEXT else st_type[0m
[30;1m158 | [0m[35m        self._set_kv_visibility()[0m
[30;1m159 | [0m[35m        self.lbl_setting.value = st_type[0m

[31m--[ [0m[34mMatch #[0m[33m2569[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m479 | [0m[35m            self._set_ctrl_from_val(path="", value=value)[0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m    def _get_val_from_ctrl(self, val_dict):[0m
[30;1m482 | [0m[35m        """Recursive get values from control dictionary."""[0m
[30;1m483 | [0m[35m        ctrl_val = {}[0m
[30;1m484 | [0m[35m        if not val_dict:[0m
[30;1m485 | [0m[35m            return val_dict[0m

[31m--[ [0m[34mMatch #[0m[33m2570[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m467 | [0m[35m        Returns[0m
[30;1m468 | [0m[35m        -------[0m
[30;1m469 | [0m[35m        Optional[Dict[str, Any]][0m
[30;1m470 | [0m[35m            Control value dictionary.[0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m        """[0m
[30;1m473 | [0m[35m        return self._get_val_from_ctrl(self.control_map)[0m

[31m--[ [0m[34mMatch #[0m[33m2571[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m450 | [0m[35m                self._create_controls(ctrl_path, mp_controls)[0m
[30;1m451 | [0m[35m[0m
[30;1m452 | [0m[35m    def _add_control_to_map(self, path, ctrl):[0m
[30;1m453 | [0m[35m        """Set a value at dotted path location in self.control_map dict."""[0m
[30;1m454 | [0m[35m        ctrl_path = path.replace(f"{self.comp_path}.", "")[0m
[30;1m455 | [0m[35m        ctrl_map = self.control_map[0m
[30;1m456 | [0m[35m        for elem in ctrl_path.split("."):[0m

[31m--[ [0m[34mMatch #[0m[33m2572[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m127 | [0m[35m    @value.setter[0m
[30;1m128 | [0m[35m    def value(self, value: Union[str, Dict[str, Optional[str]]]):[0m
[30;1m129 | [0m[35m        """[0m
[30;1m130 | [0m[35m        Set control to value.[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        Parameters[0m
[30;1m133 | [0m[35m        ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2573[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/config/compound_ctrls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m# Licensed under the MIT License. See License.txt in the project root for[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m"""Compound control classes."""[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mfrom copy import deepcopy[0m
[30;1m9 | [0m[35mfrom typing import Any, Dict, Optional, Tuple, Union[0m

[31m--[ [0m[34mMatch #[0m[33m2574[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/cmd_line.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m    cmd_field: str[0m
[30;1m133 | [0m[35m        The column of the event data that contains command line activity[0m
[30;1m134 | [0m[35m    time: int, optional[0m
[30;1m135 | [0m[35m        Time window in seconds in which to evaluate speed of execution against[0m
[30;1m136 | [0m[35m        (Defaults to 5)[0m
[30;1m137 | [0m[35m    events: int, optional[0m
[30;1m138 | [0m[35m        Number of syslog command execution events in which to evaluate[0m

[31m--[ [0m[34mMatch #[0m[33m2575[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/transform/cmd_line.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m    with open(detection_rules, "r", encoding="utf-8") as json_file:[0m
[30;1m94 | [0m[35m        rules = json.load(json_file)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    # Decode any Base64 encoded commands so we can match on them as well[0m
[30;1m97 | [0m[35m    b64_regex = re.compile([0m
[30;1m98 | [0m[35m        "(?P<b64>(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|"[0m
[30;1m99 | [0m[35m        + "[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$)"[0m

[31m--[ [0m[34mMatch #[0m[33m2576[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_alert_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m      query: '|datamodel Alerts Alerts search| search dest={ip_address} {field_rename} {project_fiel[0m
[30;1m58 | [0m[35m    parameters:[0m
[30;1m59 | [0m[35m      ip_address:[0m
[30;1m60 | [0m[35m        description: The source IP Address to search on[0m
[30;1m61 | [0m[35m        type: str[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m  list_alerts_for_user:[0m

[31m--[ [0m[34mMatch #[0m[33m2577[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_alert_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        type: str[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m  list_alerts_for_dest_ip:[0m
[30;1m53 | [0m[35m    description: Retrieves list of alerts with a common destination IP Address[0m
[30;1m54 | [0m[35m    metadata:[0m
[30;1m55 | [0m[35m      data_families: [Alerts][0m
[30;1m56 | [0m[35m    args:[0m

[31m--[ [0m[34mMatch #[0m[33m2578[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_alert_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m      query: '|datamodel Alerts Alerts search {field_rename}| search src={ip_address} {field_rename}[0m
[30;1m47 | [0m[35m    parameters:[0m
[30;1m48 | [0m[35m      ip_address:[0m
[30;1m49 | [0m[35m        description: The source IP Address to search on[0m
[30;1m50 | [0m[35m        type: str[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m  list_alerts_for_dest_ip:[0m

[31m--[ [0m[34mMatch #[0m[33m2579[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_alert_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m      query: '|datamodel Alerts Alerts search {field_rename} {project_fields} {add_query_items}'[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m  list_alerts_for_src_ip:[0m
[30;1m42 | [0m[35m    description: Retrieves list of alerts with a common source IP Address[0m
[30;1m43 | [0m[35m    metadata:[0m
[30;1m44 | [0m[35m      data_families: [Alerts][0m
[30;1m45 | [0m[35m    args:[0m

[31m--[ [0m[34mMatch #[0m[33m2580[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_alert_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m
[30;1m23 | [0m[35m      type: str[0m
[30;1m24 | [0m[35m      default: '| head 100'[0m
[30;1m25 | [0m[35m    field_rename:[0m
[30;1m26 | [0m[35m      description: Renames fields which are prepended by datamodel name[0m
[30;1m27 | [0m[35m      type: str[0m

[31m--[ [0m[34mMatch #[0m[33m2581[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_alert_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m
[30;1m16 | [0m[35m      type: datetime[0m
[30;1m17 | [0m[35m    project_fields:[0m
[30;1m18 | [0m[35m      description: Project Field names[0m

[31m--[ [0m[34mMatch #[0m[33m2582[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_alert_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    data_source: 'bots'[0m
[30;1m10 | [0m[35m  parameters:[0m
[30;1m11 | [0m[35m    start:[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2583[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_authentication_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m      query: '|datamodel Authentication Authentication search | search Authentication.src={ip_addres[0m
[30;1m51 | [0m[35m    parameters:[0m
[30;1m52 | [0m[35m      ip_address:[0m
[30;1m53 | [0m[35m        description: The source IP Address to search on[0m
[30;1m54 | [0m[35m        type: str[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m  list_logon_failures:[0m

[31m--[ [0m[34mMatch #[0m[33m2584[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_authentication_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m        type: str[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m  list_logons_for_source_ip:[0m
[30;1m46 | [0m[35m    description: All successful user logon events for source IP (all hosts)[0m
[30;1m47 | [0m[35m    metadata:[0m
[30;1m48 | [0m[35m      data_families: [Authentication][0m
[30;1m49 | [0m[35m    args:[0m

[31m--[ [0m[34mMatch #[0m[33m2585[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_authentication_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    add_query_items:[0m
[30;1m22 | [0m[35m      description: Additional query clauses[0m
[30;1m23 | [0m[35m      type: str[0m
[30;1m24 | [0m[35m      default: '| head 100'[0m
[30;1m25 | [0m[35m    field_rename:[0m
[30;1m26 | [0m[35m      description: Renames fields which are prepended by datamodel name[0m
[30;1m27 | [0m[35m      type: str[0m

[31m--[ [0m[34mMatch #[0m[33m2586[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_authentication_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m
[30;1m16 | [0m[35m      type: datetime[0m
[30;1m17 | [0m[35m    project_fields:[0m
[30;1m18 | [0m[35m      description: Project Field names[0m

[31m--[ [0m[34mMatch #[0m[33m2587[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/splunk/splunk_authentication_queries.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    data_source: 'bots'[0m
[30;1m10 | [0m[35m  parameters:[0m
[30;1m11 | [0m[35m    start:[0m
[30;1m12 | [0m[35m      description: Query start time[0m
[30;1m13 | [0m[35m      type: datetime[0m
[30;1m14 | [0m[35m    end:[0m
[30;1m15 | [0m[35m      description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2588[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbmagics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        args = magic_arguments.parse_argstring(save_to_cell, line)[0m
[30;1m222 | [0m[35m        print(args)[0m
[30;1m223 | [0m[35m        print(type(args.object))[0m
[30;1m224 | [0m[35m        obj = local_ns.get(args.object)[0m
[30;1m225 | [0m[35m        if obj is None:[0m
[30;1m226 | [0m[35m            raise ValueError(f"Variable '{args.object}' not found.")[0m
[30;1m227 | [0m[35m        save_obj_to_cell(obj, args.var_name)[0m

[31m--[ [0m[34mMatch #[0m[33m2589[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbmagics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m        def b64(self, line: str = "", cell: str = None) -> str:[0m
[30;1m74 | [0m[35m            """[0m
[30;1m75 | [0m[35m            Base64 IPython magic extension.[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m            Parameters[0m
[30;1m78 | [0m[35m            ----------[0m

[31m--[ [0m[34mMatch #[0m[33m2590[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/init/nbmagics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35mfrom .._version import VERSION[0m
[30;1m32 | [0m[35mfrom ..common.utility import is_ipython[0m
[30;1m33 | [0m[35mfrom ..common.utility.ipython import save_obj_to_cell[0m
[30;1m34 | [0m[35mfrom ..transform import base64unpack as base64[0m
[30;1m35 | [0m[35mfrom ..transform.iocextract import IoCExtract[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m__version__ = VERSION[0m

[31m--[ [0m[34mMatch #[0m[33m2591[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_apps.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m
[30;1m20 | [0m[35m        type: datetime[0m
[30;1m21 | [0m[35m      add_query_items:[0m
[30;1m22 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m2592[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_lxsyslog_apps.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m        type: str[0m
[30;1m14 | [0m[35m        default: 'Syslog'[0m
[30;1m15 | [0m[35m      start:[0m
[30;1m16 | [0m[35m        description: Query start time[0m
[30;1m17 | [0m[35m        type: datetime[0m
[30;1m18 | [0m[35m      end:[0m
[30;1m19 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2593[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_proc.yaml[0m
   Pattern: [32m.hostname[0m
[30;1m82 | [0m[35m        description: Name of host[0m
[30;1m83 | [0m[35m        type: str[0m
[30;1m84 | [0m[35m      host_op:[0m
[30;1m85 | [0m[35m        description: The hostname match operator[0m
[30;1m86 | [0m[35m        type: str[0m
[30;1m87 | [0m[35m        default: has[0m
[30;1m88 | [0m[35m  list_matching_processes:[0m

[31m--[ [0m[34mMatch #[0m[33m2594[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_proc.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m266 | [0m[35m        | where NewProcessId == sourceParentProcessId[0m
[30;1m267 | [0m[35m        | where NewProcessId == sourceParentProcessId[0m
[30;1m268 | [0m[35m        | extend NodeRole = "parent", Level = 1[0m
[30;1m269 | [0m[35m        | top 1 by TimeCreatedUtc desc nulls last)[0m
[30;1m270 | [0m[35m        {add_query_items}'[0m
[30;1m271 | [0m[35m    parameters:[0m
[30;1m272 | [0m[35m      host_name:[0m

[31m--[ [0m[34mMatch #[0m[33m2595[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_proc.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m251 | [0m[35m            | where NewProcessId == sourceProcessId[0m
[30;1m252 | [0m[35m            | where NewProcessName =~ "{process_name}"[0m
[30;1m253 | [0m[35m            | extend NodeRole = "source", Level = 0[0m
[30;1m254 | [0m[35m            | top 1 by TimeCreatedUtc desc nulls last);[0m
[30;1m255 | [0m[35m        let sourceTimeCreatedUtc = toscalar(sourceProcess | project TimeCreatedUtc );[0m
[30;1m256 | [0m[35m        let sourceParentProcessId = toscalar(sourceProcess | project ProcessId);[0m
[30;1m257 | [0m[35m        {table}[0m

[31m--[ [0m[34mMatch #[0m[33m2596[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_proc.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m150 | [0m[35m            | where (SubjectLogonId == sourceLogonId or TargetLogonId == sourceLogonId)[0m
[30;1m151 | [0m[35m            | where NewProcessId == sourceParentProcessId[0m
[30;1m152 | [0m[35m            | extend NodeRole = "parent", Level = 1[0m
[30;1m153 | [0m[35m            | top 1 by TimeCreatedUtc desc nulls last);[0m
[30;1m154 | [0m[35m        let parentLogonId = toscalar(sourceProcess | project SubjectLogonId);[0m
[30;1m155 | [0m[35m        let parentTimeCreated = toscalar(sourceProcess | project TimeCreatedUtc);[0m
[30;1m156 | [0m[35m        let childProcesses =[0m

[31m--[ [0m[34mMatch #[0m[33m2597[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_proc.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m            | where NewProcessId == sourceProcessId[0m
[30;1m134 | [0m[35m            | where NewProcessName =~ "{process_name}"[0m
[30;1m135 | [0m[35m            | extend NodeRole = "source", Level = 0[0m
[30;1m136 | [0m[35m            | top 1 by TimeCreatedUtc desc nulls last);[0m
[30;1m137 | [0m[35m        let sourceTimeCreatedUtc = toscalar(sourceProcess | project TimeCreatedUtc);[0m
[30;1m138 | [0m[35m        let sourceParentProcessId = toscalar(sourceProcess | project ProcessId);[0m
[30;1m139 | [0m[35m        let system_session_id = "0x3e7";[0m

[31m--[ [0m[34mMatch #[0m[33m2598[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_proc.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m        default: '\\'[0m
[30;1m60 | [0m[35msources:[0m
[30;1m61 | [0m[35m  list_host_processes:[0m
[30;1m62 | [0m[35m    description: Returns list of processes on a host for a time range[0m
[30;1m63 | [0m[35m    metadata:[0m
[30;1m64 | [0m[35m      pivot:[0m
[30;1m65 | [0m[35m        short_name: processes[0m

[31m--[ [0m[34mMatch #[0m[33m2599[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_proc.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m        description: Query start time[0m
[30;1m44 | [0m[35m        type: datetime[0m
[30;1m45 | [0m[35m      end:[0m
[30;1m46 | [0m[35m        description: Query end time[0m
[30;1m47 | [0m[35m        type: datetime[0m
[30;1m48 | [0m[35m      add_query_items:[0m
[30;1m49 | [0m[35m        description: Additional query clauses[0m

[31m--[ [0m[34mMatch #[0m[33m2600[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/data/queries/mssentinel/kql_sent_winevent_proc.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m            SourceComputerId[0m
[30;1m41 | [0m[35m          | extend TimeCreatedUtc=TimeGenerated'[0m
[30;1m42 | [0m[35m      start:[0m
[30;1m43 | [0m[35m        description: Query start time[0m
[30;1m44 | [0m[35m        type: datetime[0m
[30;1m45 | [0m[35m      end:[0m
[30;1m46 | [0m[35m        description: Query end time[0m

[31m--[ [0m[34mMatch #[0m[33m2601[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m    def __getattr__(self, name: str):[0m
[30;1m95 | [0m[35m        """Return the value of the named property 'name'."""[0m
[30;1m96 | [0m[35m        if self.Url:[0m
[30;1m97 | [0m[35m            val = _url_components(self.Url).get(name)[0m
[30;1m98 | [0m[35m            if val:[0m
[30;1m99 | [0m[35m                return val[0m
[30;1m100 | [0m[35m        return super().__getattr__(name)[0m

[31m--[ [0m[34mMatch #[0m[33m2602[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/datamodel/entities/url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m    def __getitem__(self, key: str):[0m
[30;1m87 | [0m[35m        """Allow property get using dictionary key syntax."""[0m
[30;1m88 | [0m[35m        if self.Url:[0m
[30;1m89 | [0m[35m            val = _url_components(self.Url).get(key)[0m
[30;1m90 | [0m[35m            if val:[0m
[30;1m91 | [0m[35m                return val[0m
[30;1m92 | [0m[35m        return super().__getitem__(key)[0m

[31m--[ [0m[34mMatch #[0m[33m2603[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_alert_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35mdef _find_graph_node(nx_graph, node_type, target_name):[0m
[30;1m167 | [0m[35m    """Find a node with a given name and type."""[0m
[30;1m168 | [0m[35m    node_prefix = f"{node_type}: {target_name}"[0m
[30;1m169 | [0m[35m    nodes = [[0m
[30;1m170 | [0m[35m        n[0m

[31m--[ [0m[34mMatch #[0m[33m2604[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_alert_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35mdef _add_alert_node(nx_graph, alert):[0m
[30;1m154 | [0m[35m    """Add alert node to the graph."""[0m
[30;1m155 | [0m[35m    nx_graph.add_node([0m
[30;1m156 | [0m[35m        alert["AlertType"] + "(R)",[0m
[30;1m157 | [0m[35m        name=alert["AlertType"],[0m

[31m--[ [0m[34mMatch #[0m[33m2605[0m[34m of [0m[33m2605[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msticpy-2.16.2/msticpy/nbtools/security_alert_graph.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m                # don't add a new edge to the host[0m
[30;1m71 | [0m[35m                continue[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            # get the node id of the related entity and add an edge if it[0m
[30;1m74 | [0m[35m            # doesn't already exist[0m
[30;1m75 | [0m[35m            (related_entity, _) = _get_name_and_description(rel_entity)[0m
[30;1m76 | [0m[35m            if not alertentity_graph.has_edge(related_entity, e_name):[0m

2605 matches found.
