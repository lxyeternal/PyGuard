[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m440 | [0m[35m    host=None,[0m
[30;1m441 | [0m[35m    port=None,[0m
[30;1m442 | [0m[35m    username=None,[0m
[30;1m443 | [0m[35m    password=None,[0m
[30;1m444 | [0m[35m    charset=None,[0m
[30;1m445 | [0m[35m    continue_after_timeout=None,[0m
[30;1m446 | [0m[35m):[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m67 | [0m[35m                self._client = boto3.client("rds-data")[0m
[30;1m68 | [0m[35m        self._dbname = dbname[0m
[30;1m69 | [0m[35m        self._aurora_cluster_arn = aurora_cluster_arn or os.environ.get("AURORA_CLUSTER_ARN")[0m
[30;1m70 | [0m[35m        self._secret_arn = secret_arn or os.environ.get("AURORA_SECRET_ARN")[0m
[30;1m71 | [0m[35m        self._charset = charset[0m
[30;1m72 | [0m[35m        self._transaction_id = None[0m
[30;1m73 | [0m[35m        self._continue_after_timeout = continue_after_timeout[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m66 | [0m[35m            with self._client_init_lock:[0m
[30;1m67 | [0m[35m                self._client = boto3.client("rds-data")[0m
[30;1m68 | [0m[35m        self._dbname = dbname[0m
[30;1m69 | [0m[35m        self._aurora_cluster_arn = aurora_cluster_arn or os.environ.get("AURORA_CLUSTER_ARN")[0m
[30;1m70 | [0m[35m        self._secret_arn = secret_arn or os.environ.get("AURORA_SECRET_ARN")[0m
[30;1m71 | [0m[35m        self._charset = charset[0m
[30;1m72 | [0m[35m        self._transaction_id = None[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/mysql_error_codes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m701 | [0m[35m    ER_FAILED_READ_FROM_PAR_FILE = 1696[0m
[30;1m702 | [0m[35m    ER_VALUES_IS_NOT_INT_TYPE_ERROR = 1697[0m
[30;1m703 | [0m[35m    ER_ACCESS_DENIED_NO_PASSWORD_ERROR = 1698[0m
[30;1m704 | [0m[35m    ER_SET_PASSWORD_AUTH_PLUGIN = 1699[0m
[30;1m705 | [0m[35m    ER_GRANT_PLUGIN_USER_EXISTS = 1700[0m
[30;1m706 | [0m[35m    ER_TRUNCATE_ILLEGAL_FK = 1701[0m
[30;1m707 | [0m[35m    ER_PLUGIN_IS_PERMANENT = 1702[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/mysql_error_codes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m700 | [0m[35m    ER_STORED_FUNCTION_PREVENTS_SWITCH_SQL_LOG_BIN = 1695[0m
[30;1m701 | [0m[35m    ER_FAILED_READ_FROM_PAR_FILE = 1696[0m
[30;1m702 | [0m[35m    ER_VALUES_IS_NOT_INT_TYPE_ERROR = 1697[0m
[30;1m703 | [0m[35m    ER_ACCESS_DENIED_NO_PASSWORD_ERROR = 1698[0m
[30;1m704 | [0m[35m    ER_SET_PASSWORD_AUTH_PLUGIN = 1699[0m
[30;1m705 | [0m[35m    ER_GRANT_PLUGIN_USER_EXISTS = 1700[0m
[30;1m706 | [0m[35m    ER_TRUNCATE_ILLEGAL_FK = 1701[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/mysql_error_codes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m135 | [0m[35m    ER_HOST_NOT_PRIVILEGED = 1130[0m
[30;1m136 | [0m[35m    ER_PASSWORD_ANONYMOUS_USER = 1131[0m
[30;1m137 | [0m[35m    ER_PASSWORD_NOT_ALLOWED = 1132[0m
[30;1m138 | [0m[35m    ER_PASSWORD_NO_MATCH = 1133[0m
[30;1m139 | [0m[35m    ER_UPDATE_INF = 1134[0m
[30;1m140 | [0m[35m    ER_CANT_CREATE_THREAD = 1135[0m
[30;1m141 | [0m[35m    ER_WRONG_VALUE_COUNT_ON_ROW = 1136[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/mysql_error_codes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m134 | [0m[35m    ER_HOST_IS_BLOCKED = 1129[0m
[30;1m135 | [0m[35m    ER_HOST_NOT_PRIVILEGED = 1130[0m
[30;1m136 | [0m[35m    ER_PASSWORD_ANONYMOUS_USER = 1131[0m
[30;1m137 | [0m[35m    ER_PASSWORD_NOT_ALLOWED = 1132[0m
[30;1m138 | [0m[35m    ER_PASSWORD_NO_MATCH = 1133[0m
[30;1m139 | [0m[35m    ER_UPDATE_INF = 1134[0m
[30;1m140 | [0m[35m    ER_CANT_CREATE_THREAD = 1135[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/mysql_error_codes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m133 | [0m[35m    ER_FUNCTION_NOT_DEFINED = 1128[0m
[30;1m134 | [0m[35m    ER_HOST_IS_BLOCKED = 1129[0m
[30;1m135 | [0m[35m    ER_HOST_NOT_PRIVILEGED = 1130[0m
[30;1m136 | [0m[35m    ER_PASSWORD_ANONYMOUS_USER = 1131[0m
[30;1m137 | [0m[35m    ER_PASSWORD_NOT_ALLOWED = 1132[0m
[30;1m138 | [0m[35m    ER_PASSWORD_NO_MATCH = 1133[0m
[30;1m139 | [0m[35m    ER_UPDATE_INF = 1134[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api-0.5.0.dist-info/METADATA[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m  expected by the Data API (a JSON object with the keys ``username`` and ``password``)::[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m      aws secretsmanager create-secret --name rds-db-credentials/MY_DB[0m
[30;1m48 | [0m[35m      aws secretsmanager put-secret-value --secret-id rds-db-credentials/MY_DB --secret-string "$(jq[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m* Configure your AWS command line credentials using[0m
[30;1m51 | [0m[35m  `standard AWS conventions <https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.htm[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api-0.5.0.dist-info/METADATA[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m  expected by the Data API (a JSON object with the keys ``username`` and ``password``)::[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m      aws secretsmanager create-secret --name rds-db-credentials/MY_DB[0m
[30;1m48 | [0m[35m      aws secretsmanager put-secret-value --secret-id rds-db-credentials/MY_DB --secret-string "$(jq[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m* Configure your AWS command line credentials using[0m
[30;1m51 | [0m[35m  `standard AWS conventions <https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.htm[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api-0.5.0.dist-info/METADATA[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m* Save the database credentials in[0m
[30;1m44 | [0m[35m  `AWS Secrets Manager <https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html>`_ us[0m
[30;1m45 | [0m[35m  expected by the Data API (a JSON object with the keys ``username`` and ``password``)::[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m      aws secretsmanager create-secret --name rds-db-credentials/MY_DB[0m
[30;1m48 | [0m[35m      aws secretsmanager put-secret-value --secret-id rds-db-credentials/MY_DB --secret-string "$(jq[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api-0.5.0.dist-info/METADATA[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m99 | [0m[35mMotivation[0m
[30;1m100 | [0m[35m----------[0m
[30;1m101 | [0m[35mThe `RDS Data API <https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/data-api.html>`_ is [0m
[30;1m102 | [0m[35mAWS Lambda serverless environment and the sophisticated features provided by PostgreSQL and MySQL. T[0m
[30;1m103 | [0m[35mSQL over HTTP, which has advantages in the context of AWS Lambda:[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m* It eliminates the need to open database ports to the AWS Lambda public IP address pool[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aurora_data_api/postgresql_error_codes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m    ER_INVALID_SQL_STMT_NAME = "26000"[0m
[30;1m115 | [0m[35m    ER_TRIGGERED_DATA_CHANGE_VIOLATION = "27000"[0m
[30;1m116 | [0m[35m    ER_INVALID_AUTHORIZATION_SPEC = "28000"[0m
[30;1m117 | [0m[35m    ER_INVALID_PASSWORD = "28P01"[0m
[30;1m118 | [0m[35m    ER_DEPENDENT_PRIVILEGE_DESCRIPTORS_STILL_EXIST = "2B000"[0m
[30;1m119 | [0m[35m    ER_DEPENDENT_OBJS_STILL_EXIST = "2BP01"[0m
[30;1m120 | [0m[35m    ER_INVALID_TRANSAC_TERMINATION = "2D000"[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m                for record in page["records"]:[0m
[30;1m392 | [0m[35m                    yield record[0m
[30;1m393 | [0m[35m        else:[0m
[30;1m394 | [0m[35m            for record in self._current_response.get("records", []):[0m
[30;1m395 | [0m[35m                yield record[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m    def fetchone(self):[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m        return response[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m    def _render_value(self, value, col_desc=None):[0m
[30;1m330 | [0m[35m        if value.get("isNull"):[0m
[30;1m331 | [0m[35m            return None[0m
[30;1m332 | [0m[35m        elif "arrayValue" in value:[0m
[30;1m333 | [0m[35m            if "arrayValues" in value["arrayValue"]:[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m    @property[0m
[30;1m300 | [0m[35m    def lastrowid(self):[0m
[30;1m301 | [0m[35m        # TODO: this may not make sense if the previous statement is not an INSERT[0m
[30;1m302 | [0m[35m        if self._current_response and self._current_response.get("generatedFields"):[0m
[30;1m303 | [0m[35m            return self._render_value(self._current_response["generatedFields"][-1])[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m    def _page_input(self, iterable, page_size=1000):[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m        return [self.prepare_param(k, v) for k, v in parameters.items()][0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    def _get_database_error(self, original_error):[0m
[30;1m248 | [0m[35m        error_msg = getattr(original_error, "response", {}).get("Error", {}).get("Message", "")[0m
[30;1m249 | [0m[35m        try:[0m
[30;1m250 | [0m[35m            res = re.search(r"Error code: (\d+); SQLState: (\d+)$", error_msg)[0m
[30;1m251 | [0m[35m            if res:  # MySQL error[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m        return [self.prepare_param(k, v) for k, v in parameters.items()][0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    def _get_database_error(self, original_error):[0m
[30;1m248 | [0m[35m        error_msg = getattr(original_error, "response", {}).get("Error", {}).get("Message", "")[0m
[30;1m249 | [0m[35m        try:[0m
[30;1m250 | [0m[35m            res = re.search(r"Error code: (\d+); SQLState: (\d+)$", error_msg)[0m
[30;1m251 | [0m[35m            if res:  # MySQL error[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m        self.description = [][0m
[30;1m212 | [0m[35m        for column in column_metadata:[0m
[30;1m213 | [0m[35m            col_desc = ColumnDescription([0m
[30;1m214 | [0m[35m                name=column["name"], type_code=self._pg_type_map.get(column["typeName"].lower(), str[0m
[30;1m215 | [0m[35m            )[0m
[30;1m216 | [0m[35m            self.description.append(col_desc)[0m
[30;1m217 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        # if param_data_api_type == "arrayValue" and len(param_value) > 0:[0m
[30;1m203 | [0m[35m        #     return {[0m
[30;1m204 | [0m[35m        #         param_data_api_type: {[0m
[30;1m205 | [0m[35m        #             self._data_api_type_map.get(type(param_value[0]), "stringValue") + "s": param_[0m
[30;1m206 | [0m[35m        #         }[0m
[30;1m207 | [0m[35m        #     }[0m
[30;1m208 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m    def prepare_param(self, param_name, param_value):[0m
[30;1m192 | [0m[35m        if param_value is None:[0m
[30;1m193 | [0m[35m            return dict(name=param_name, value=dict(isNull=True))[0m
[30;1m194 | [0m[35m        param_data_api_type = self._data_api_type_map.get(type(param_value), "stringValue")[0m
[30;1m195 | [0m[35m        param = dict(name=param_name, value={param_data_api_type: param_value})[0m
[30;1m196 | [0m[35m        if param_data_api_type == "stringValue" and not isinstance(param_value, str):[0m
[30;1m197 | [0m[35m            param["value"][param_data_api_type] = str(param_value)[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m                self._client = boto3.client("rds-data")[0m
[30;1m68 | [0m[35m        self._dbname = dbname[0m
[30;1m69 | [0m[35m        self._aurora_cluster_arn = aurora_cluster_arn or os.environ.get("AURORA_CLUSTER_ARN")[0m
[30;1m70 | [0m[35m        self._secret_arn = secret_arn or os.environ.get("AURORA_SECRET_ARN")[0m
[30;1m71 | [0m[35m        self._charset = charset[0m
[30;1m72 | [0m[35m        self._transaction_id = None[0m
[30;1m73 | [0m[35m        self._continue_after_timeout = continue_after_timeout[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m            with self._client_init_lock:[0m
[30;1m67 | [0m[35m                self._client = boto3.client("rds-data")[0m
[30;1m68 | [0m[35m        self._dbname = dbname[0m
[30;1m69 | [0m[35m        self._aurora_cluster_arn = aurora_cluster_arn or os.environ.get("AURORA_CLUSTER_ARN")[0m
[30;1m70 | [0m[35m        self._secret_arn = secret_arn or os.environ.get("AURORA_SECRET_ARN")[0m
[30;1m71 | [0m[35m        self._charset = charset[0m
[30;1m72 | [0m[35m        self._transaction_id = None[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m248 | [0m[35m        error_msg = getattr(original_error, "response", {}).get("Error", {}).get("Message", "")[0m
[30;1m249 | [0m[35m        try:[0m
[30;1m250 | [0m[35m            res = re.search(r"Error code: (\d+); SQLState: (\d+)$", error_msg)[0m
[30;1m251 | [0m[35m            if res:  # MySQL error[0m
[30;1m252 | [0m[35m                error_code = int(res.group(1))[0m
[30;1m253 | [0m[35m                error_class = MySQLError.from_code(error_code)[0m
[30;1m254 | [0m[35m                error = error_class(error_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m            self.description.append(col_desc)[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    def _start_paginated_query(self, execute_statement_args, records_per_page=None):[0m
[30;1m219 | [0m[35m        # MySQL cursors are non-scrollable (https://dev.mysql.com/doc/refman/8.0/en/cursors.html)[0m
[30;1m220 | [0m[35m        # - may not support page autosizing[0m
[30;1m221 | [0m[35m        # - FETCH requires INTO - may need to write all results into a server side var and iterate o[0m
[30;1m222 | [0m[35m        pg_cursor_name = "{}_{}_{}".format([0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mparamstyle = "named"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mDate = datetime.date[0m
[30;1m33 | [0m[35mTime = datetime.time[0m
[30;1m34 | [0m[35mTimestamp = datetime.datetime[0m
[30;1m35 | [0m[35mDateFromTicks = datetime.date.fromtimestamp[0m
[30;1m36 | [0m[35m# TimeFromTicks = datetime.time.fromtimestamp TODO[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api-0.5.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35mAWS Lambda serverless environment and the sophisticated features provided by PostgreSQL and MySQL. T[0m
[30;1m103 | [0m[35mSQL over HTTP, which has advantages in the context of AWS Lambda:[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m* It eliminates the need to open database ports to the AWS Lambda public IP address pool[0m
[30;1m106 | [0m[35m* It uses stateless HTTP connections instead of stateful internal TCP connection pools used by most [0m
[30;1m107 | [0m[35m  (the stateful pools become invalid after going through[0m
[30;1m108 | [0m[35m  `AWS Lambda freeze-thaw cycles <https://docs.aws.amazon.com/lambda/latest/dg/running-lambda-code.h[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m28[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aurora_data_api-0.5.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m------------[0m
[30;1m30 | [0m[35m::[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    pip install aurora-data-api[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mPrerequisites[0m
[30;1m35 | [0m[35m-------------[0m

28 matches found.
