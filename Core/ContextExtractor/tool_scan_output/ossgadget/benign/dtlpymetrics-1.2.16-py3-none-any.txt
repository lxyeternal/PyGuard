[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/dtlpy_scores.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m    dl.setenv('rc')[0m
[30;1m193 | [0m[35m    project = dl.projects.get(project_id='2cb9ae90-b6e8-4d15-9016-17bacc9b7bdf')[0m
[30;1m194 | [0m[35m    task = dl.tasks.get(task_id='63bffffa8cac97275a31fd17')[0m
[30;1m195 | [0m[35m    annotation = dl.annotations.get(annotation_id='6499302b6563931044046cbc')[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m    score = Score(type=ScoreType.ANNOTATION_IOU,[0m
[30;1m198 | [0m[35m                  value=0.9,[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/dtlpy_scores.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35mdef tests():[0m
[30;1m192 | [0m[35m    dl.setenv('rc')[0m
[30;1m193 | [0m[35m    project = dl.projects.get(project_id='2cb9ae90-b6e8-4d15-9016-17bacc9b7bdf')[0m
[30;1m194 | [0m[35m    task = dl.tasks.get(task_id='63bffffa8cac97275a31fd17')[0m
[30;1m195 | [0m[35m    annotation = dl.annotations.get(annotation_id='6499302b6563931044046cbc')[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m    score = Score(type=ScoreType.ANNOTATION_IOU,[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/dtlpy_scores.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35mdef tests():[0m
[30;1m192 | [0m[35m    dl.setenv('rc')[0m
[30;1m193 | [0m[35m    project = dl.projects.get(project_id='2cb9ae90-b6e8-4d15-9016-17bacc9b7bdf')[0m
[30;1m194 | [0m[35m    task = dl.tasks.get(task_id='63bffffa8cac97275a31fd17')[0m
[30;1m195 | [0m[35m    annotation = dl.annotations.get(annotation_id='6499302b6563931044046cbc')[0m
[30;1m196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/dtlpy_scores.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m            self._project = repositories.Projects(client_api=self._client_api).get(project_id=self._[0m
[30;1m75 | [0m[35m        if self._project is None:[0m
[30;1m76 | [0m[35m            # try get checkout[0m
[30;1m77 | [0m[35m            project = self._client_api.state_io.get('project')[0m
[30;1m78 | [0m[35m            if project is not None:[0m
[30;1m79 | [0m[35m                self._project = entities.Project.from_json(_json=project, client_api=self._client_ap[0m
[30;1m80 | [0m[35m        if self._project is None:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/dtlpy_scores.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m    def project(self) -> entities.Project:[0m
[30;1m72 | [0m[35m        if self._project is None and self._project_id is not None:[0m
[30;1m73 | [0m[35m            # get from id[0m
[30;1m74 | [0m[35m            self._project = repositories.Projects(client_api=self._client_api).get(project_id=self._[0m
[30;1m75 | [0m[35m        if self._project is None:[0m
[30;1m76 | [0m[35m            # try get checkout[0m
[30;1m77 | [0m[35m            project = self._client_api.state_io.get('project')[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m    model_filename = f'{model_id}.csv'[0m
[30;1m179 | [0m[35m    items_filters = dl.Filters(field='hidden', values=True)[0m
[30;1m180 | [0m[35m    items_filters.add(field='name', values=model_filename)[0m
[30;1m181 | [0m[35m    dataset = dl.datasets.get(dataset_id=dataset_id)[0m
[30;1m182 | [0m[35m    items = list(dataset.items.list(filters=items_filters).all())[0m
[30;1m183 | [0m[35m    if len(items) == 0:[0m
[30;1m184 | [0m[35m        raise ValueError(f'No scores found for model ID {model_id}. Please evaluate model on the dat[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m            if annotation.metadata.get('user', {}).get('model') is None:[0m
[30;1m81 | [0m[35m                # GT annotation (no model in metadata)[0m
[30;1m82 | [0m[35m                item_annots_1.append(annotation)[0m
[30;1m83 | [0m[35m            elif annotation.metadata.get('user', {}).get('model', {}).get('name', '') == model.name:[0m
[30;1m84 | [0m[35m                # annotation came from the evaluated model[0m
[30;1m85 | [0m[35m                item_annots_2.append(annotation)[0m
[30;1m86 | [0m[35m        annotation_sets_by_item[item_id] = {'gt': item_annots_1,[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m            if annotation.metadata.get('user', {}).get('model') is None:[0m
[30;1m81 | [0m[35m                # GT annotation (no model in metadata)[0m
[30;1m82 | [0m[35m                item_annots_1.append(annotation)[0m
[30;1m83 | [0m[35m            elif annotation.metadata.get('user', {}).get('model', {}).get('name', '') == model.name:[0m
[30;1m84 | [0m[35m                # annotation came from the evaluated model[0m
[30;1m85 | [0m[35m                item_annots_2.append(annotation)[0m
[30;1m86 | [0m[35m        annotation_sets_by_item[item_id] = {'gt': item_annots_1,[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m            if annotation.metadata.get('user', {}).get('model') is None:[0m
[30;1m81 | [0m[35m                # GT annotation (no model in metadata)[0m
[30;1m82 | [0m[35m                item_annots_1.append(annotation)[0m
[30;1m83 | [0m[35m            elif annotation.metadata.get('user', {}).get('model', {}).get('name', '') == model.name:[0m
[30;1m84 | [0m[35m                # annotation came from the evaluated model[0m
[30;1m85 | [0m[35m                item_annots_2.append(annotation)[0m
[30;1m86 | [0m[35m        annotation_sets_by_item[item_id] = {'gt': item_annots_1,[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m        collection: dl.AnnotationCollection = dl.AnnotationCollection.from_json(_json=data['annotati[0m
[30;1m78 | [0m[35m                                                                                item=item)[0m
[30;1m79 | [0m[35m        for annotation in collection:[0m
[30;1m80 | [0m[35m            if annotation.metadata.get('user', {}).get('model') is None:[0m
[30;1m81 | [0m[35m                # GT annotation (no model in metadata)[0m
[30;1m82 | [0m[35m                item_annots_1.append(annotation)[0m
[30;1m83 | [0m[35m            elif annotation.metadata.get('user', {}).get('model', {}).get('name', '') == model.name:[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m        collection: dl.AnnotationCollection = dl.AnnotationCollection.from_json(_json=data['annotati[0m
[30;1m78 | [0m[35m                                                                                item=item)[0m
[30;1m79 | [0m[35m        for annotation in collection:[0m
[30;1m80 | [0m[35m            if annotation.metadata.get('user', {}).get('model') is None:[0m
[30;1m81 | [0m[35m                # GT annotation (no model in metadata)[0m
[30;1m82 | [0m[35m                item_annots_1.append(annotation)[0m
[30;1m83 | [0m[35m            elif annotation.metadata.get('user', {}).get('model', {}).get('name', '') == model.name:[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/models.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m493 | [0m[35m    precision_points = np.concatenate([[0], precision, [0]])[0m
[30;1m494 | [0m[35m    confidence_points = np.concatenate([[confidence[0]], confidence, [confidence[-1]]])[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m    # find the maximum precision between each recall value, backwards[0m
[30;1m497 | [0m[35m    for i in range(len(precision_points) - 1, 0, -1):[0m
[30;1m498 | [0m[35m        precision_points[i - 1] = max(precision_points[i - 1], precision_points[i])[0m
[30;1m499 | [0m[35m        # print(precision_points[i-1])  # DEBUG[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m            if scores_by_annotator.get(score.context.get('assignmentId')) is None:[0m
[30;1m113 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')] = [score.value][0m
[30;1m114 | [0m[35m            else:[0m
[30;1m115 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')].append(score.value)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    annot_scores = {key: sum(val) / len(val) for key, val, in scores_by_annotator.items()}[0m
[30;1m118 | [0m[35m    best_annotator = annot_scores[max(annot_scores, key=annot_scores.get)][0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m    for score in scores:[0m
[30;1m111 | [0m[35m        if score.type == ScoreType.ANNOTATION_OVERALL:[0m
[30;1m112 | [0m[35m            if scores_by_annotator.get(score.context.get('assignmentId')) is None:[0m
[30;1m113 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')] = [score.value][0m
[30;1m114 | [0m[35m            else:[0m
[30;1m115 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')].append(score.value)[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    for score in scores:[0m
[30;1m111 | [0m[35m        if score.type == ScoreType.ANNOTATION_OVERALL:[0m
[30;1m112 | [0m[35m            if scores_by_annotator.get(score.context.get('assignmentId')) is None:[0m
[30;1m113 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')] = [score.value][0m
[30;1m114 | [0m[35m            else:[0m
[30;1m115 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')].append(score.value)[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    for score in scores:[0m
[30;1m111 | [0m[35m        if score.type == ScoreType.ANNOTATION_OVERALL:[0m
[30;1m112 | [0m[35m            if scores_by_annotator.get(score.context.get('assignmentId')) is None:[0m
[30;1m113 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')] = [score.value][0m
[30;1m114 | [0m[35m            else:[0m
[30;1m115 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')].append(score.value)[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m            if scores_by_annotator.get(score.context.get('assignmentId')) is None:[0m
[30;1m95 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')] = [score.value][0m
[30;1m96 | [0m[35m            else:[0m
[30;1m97 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')].append(score.value)[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    return scores_by_annotator[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m    for score in scores:[0m
[30;1m93 | [0m[35m        if score.type == ScoreType.ANNOTATION_OVERALL:[0m
[30;1m94 | [0m[35m            if scores_by_annotator.get(score.context.get('assignmentId')) is None:[0m
[30;1m95 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')] = [score.value][0m
[30;1m96 | [0m[35m            else:[0m
[30;1m97 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')].append(score.value)[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    for score in scores:[0m
[30;1m93 | [0m[35m        if score.type == ScoreType.ANNOTATION_OVERALL:[0m
[30;1m94 | [0m[35m            if scores_by_annotator.get(score.context.get('assignmentId')) is None:[0m
[30;1m95 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')] = [score.value][0m
[30;1m96 | [0m[35m            else:[0m
[30;1m97 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')].append(score.value)[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    for score in scores:[0m
[30;1m93 | [0m[35m        if score.type == ScoreType.ANNOTATION_OVERALL:[0m
[30;1m94 | [0m[35m            if scores_by_annotator.get(score.context.get('assignmentId')) is None:[0m
[30;1m95 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')] = [score.value][0m
[30;1m96 | [0m[35m            else:[0m
[30;1m97 | [0m[35m                scores_by_annotator[score.context.get('assignmentId')].append(score.value)[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m    :return: True if item is video[0m
[30;1m11 | [0m[35m    """[0m
[30;1m12 | [0m[35m    if item.metadata.get('system', dict()):[0m
[30;1m13 | [0m[35m        item_mimetype = item.metadata['system'].get('mimetype', None)[0m
[30;1m14 | [0m[35m        is_video = 'video' in item_mimetype[0m
[30;1m15 | [0m[35m    else:[0m
[30;1m16 | [0m[35m        is_video = False[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/dl_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m    :param item: dl.Item[0m
[30;1m10 | [0m[35m    :return: True if item is video[0m
[30;1m11 | [0m[35m    """[0m
[30;1m12 | [0m[35m    if item.metadata.get('system', dict()):[0m
[30;1m13 | [0m[35m        item_mimetype = item.metadata['system'].get('mimetype', None)[0m
[30;1m14 | [0m[35m        is_video = 'video' in item_mimetype[0m
[30;1m15 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics-1.2.16.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m## Python installation[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m```shell[0m
[30;1m160 | [0m[35mpip install dtlpymetrics[0m
[30;1m161 | [0m[35m```[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m## Functions[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics-1.2.16.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m`item = dl.items.dl(item_id='64c0f2e1ec9103d52eaedbe2')`[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35mIn this example item, the ground truth has 3 for each cat and dog class. The assignee however, label[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m```python[0m
[30;1m122 | [0m[35m{[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics-1.2.16.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m`item = dl.items.dl(item_id='64c0f2e1ec9103d52eaedbe2')`[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35mIn this example item, the ground truth has 3 for each cat and dog class. The assignee however, label[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m```python[0m
[30;1m122 | [0m[35m{[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics-1.2.16.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m## Description[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mThis app improves the efficiency of annotating data by improving annotation quality while reducing t[0m
[30;1m26 | [0m[35mproduce them.[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mThe components of this app are:[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m310 | [0m[35m    ####################[0m
[30;1m311 | [0m[35m    # calculate scores #[0m
[30;1m312 | [0m[35m    ####################[0m
[30;1m313 | [0m[35m    labels = dl.recipes.get(task.recipe_id).ontologies.list()[0].labels_flat_dict.keys()[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m    # compare between each assignment and create Score entities[0m
[30;1m316 | [0m[35m    all_scores = list()[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m    # add in reference annotations if testing task[0m
[30;1m280 | [0m[35m    if task_type == 'testing':[0m
[30;1m281 | [0m[35m        # get all ref from the src item[0m
[30;1m282 | [0m[35m        src_item = dl.items.get(item_id=item._src_item)[0m
[30;1m283 | [0m[35m        # ref_annots_by_frame = get_annotations_from_frames(src_item.annotations.list())[0m
[30;1m284 | [0m[35m        ref_annotations = src_item.annotations.list()[0m
[30;1m285 | [0m[35m        num_frames = src_item.metadata['system']['nb_frames'][0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m            # TODO compare annotations between models[0m
[30;1m268 | [0m[35m            # default is "ref", if no assignment ID is found[0m
[30;1m269 | [0m[35m            assignment_id = annotation_slice.metadata['system'].get('assignmentId', 'ref')[0m
[30;1m270 | [0m[35m            task_id = annotation_slice.metadata['system'].get('taskId', None)[0m
[30;1m271 | [0m[35m            if task_id == task.id:[0m
[30;1m272 | [0m[35m                assignment_annotator = assignments_by_id[assignment_id].annotator[0m
[30;1m273 | [0m[35m                frame_annots_by_assignment[assignment_annotator].append(annotation_slice)[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m        for annotation_slice in annotation_slices:[0m
[30;1m267 | [0m[35m            # TODO compare annotations between models[0m
[30;1m268 | [0m[35m            # default is "ref", if no assignment ID is found[0m
[30;1m269 | [0m[35m            assignment_id = annotation_slice.metadata['system'].get('assignmentId', 'ref')[0m
[30;1m270 | [0m[35m            task_id = annotation_slice.metadata['system'].get('taskId', None)[0m
[30;1m271 | [0m[35m            if task_id == task.id:[0m
[30;1m272 | [0m[35m                assignment_annotator = assignments_by_id[assignment_id].annotator[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m    # add in reference annotations if testing task[0m
[30;1m230 | [0m[35m    if task_type == 'testing':[0m
[30;1m231 | [0m[35m        # get all ref from the src item[0m
[30;1m232 | [0m[35m        src_item = dl.items.get(item_id=item._src_item)[0m
[30;1m233 | [0m[35m        annots_by_assignment['ref'] = src_item.annotations.list()[0m
[30;1m234 | [0m[35m    return annots_by_assignment[0m
[30;1m235 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m        # default is "ref"[0m
[30;1m219 | [0m[35m        # TODO handle models[0m
[30;1m220 | [0m[35m        assignment_id = annotation.metadata['system'].get('assignmentId', 'ref')[0m
[30;1m221 | [0m[35m        task_id = annotation.metadata['system'].get('taskId', None)[0m
[30;1m222 | [0m[35m        if task_id == task.id:[0m
[30;1m223 | [0m[35m            assignment_annotator = assignments_by_id[assignment_id].annotator[0m
[30;1m224 | [0m[35m            annots_by_assignment[assignment_annotator].append(annotation)[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m    for annotation in annotations:[0m
[30;1m218 | [0m[35m        # default is "ref"[0m
[30;1m219 | [0m[35m        # TODO handle models[0m
[30;1m220 | [0m[35m        assignment_id = annotation.metadata['system'].get('assignmentId', 'ref')[0m
[30;1m221 | [0m[35m        task_id = annotation.metadata['system'].get('taskId', None)[0m
[30;1m222 | [0m[35m        if task_id == task.id:[0m
[30;1m223 | [0m[35m            assignment_annotator = assignments_by_id[assignment_id].annotator[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m        for asg_items in asg_pages.all():[0m
[30;1m192 | [0m[35m            refs = asg_items.metadata['system']['refs'][0m
[30;1m193 | [0m[35m            for ref in refs:[0m
[30;1m194 | [0m[35m                if ref.get('type') == 'assignment':[0m
[30;1m195 | [0m[35m                    consensus_assignments.append(ref['id'])[0m
[30;1m196 | [0m[35m    else:[0m
[30;1m197 | [0m[35m        consensus_assignments = [asg.id for asg in assignments][0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m    logger.info(f'Starting scoring for item: {item.id} and task: {task.id}')[0m
[30;1m77 | [0m[35m    if task.metadata['system'].get('consensusTaskType') == 'consensus':[0m
[30;1m78 | [0m[35m        task_type = 'consensus'[0m
[30;1m79 | [0m[35m    elif task.metadata['system'].get('consensusTaskType') in ['qualification', 'honeypot']:[0m
[30;1m80 | [0m[35m        task_type = 'testing'[0m
[30;1m81 | [0m[35m    else:[0m
[30;1m82 | [0m[35m        raise ValueError(f'Task type is not suitable for scoring.')[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m    :return: list of Scores[0m
[30;1m75 | [0m[35m    """[0m
[30;1m76 | [0m[35m    logger.info(f'Starting scoring for item: {item.id} and task: {task.id}')[0m
[30;1m77 | [0m[35m    if task.metadata['system'].get('consensusTaskType') == 'consensus':[0m
[30;1m78 | [0m[35m        task_type = 'consensus'[0m
[30;1m79 | [0m[35m    elif task.metadata['system'].get('consensusTaskType') in ['qualification', 'honeypot']:[0m
[30;1m80 | [0m[35m        task_type = 'testing'[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m            # for testing tasks, check if the item is complete via metadata[0m
[30;1m47 | [0m[35m            elif ref.get('metadata', None) is None:[0m
[30;1m48 | [0m[35m                continue[0m
[30;1m49 | [0m[35m            elif ref.get('metadata').get('status', None) in ['completed', 'consensus_done']:[0m
[30;1m50 | [0m[35m                current_task_done = True[0m
[30;1m51 | [0m[35m                break[0m
[30;1m52 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m            # for testing tasks, check if the item is complete via metadata[0m
[30;1m47 | [0m[35m            elif ref.get('metadata', None) is None:[0m
[30;1m48 | [0m[35m                continue[0m
[30;1m49 | [0m[35m            elif ref.get('metadata').get('status', None) in ['completed', 'consensus_done']:[0m
[30;1m50 | [0m[35m                current_task_done = True[0m
[30;1m51 | [0m[35m                break[0m
[30;1m52 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m            if ref['id'] != task.id:[0m
[30;1m45 | [0m[35m                continue[0m
[30;1m46 | [0m[35m            # for testing tasks, check if the item is complete via metadata[0m
[30;1m47 | [0m[35m            elif ref.get('metadata', None) is None:[0m
[30;1m48 | [0m[35m                continue[0m
[30;1m49 | [0m[35m            elif ref.get('metadata').get('status', None) in ['completed', 'consensus_done']:[0m
[30;1m50 | [0m[35m                current_task_done = True[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    if task.metadata['system'].get('consensusTaskType') not in ['qualification', 'honeypot', 'consen[0m
[30;1m25 | [0m[35m        raise ValueError(f'Task type is not suitable for scoring')[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    if task.metadata['system'].get('consensusTaskType') in ['honeypot', 'qualification']:[0m
[30;1m28 | [0m[35m        # qualification and honeypot scoring is completed on cloned items for each assignee[0m
[30;1m29 | [0m[35m        filters = dl.Filters()[0m
[30;1m30 | [0m[35m        filters.add(field='hidden', values=True)  # return only the clones[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    :return: dict of scores with item id as key and list of Scores as value[0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m    # determine task type[0m
[30;1m24 | [0m[35m    if task.metadata['system'].get('consensusTaskType') not in ['qualification', 'honeypot', 'consen[0m
[30;1m25 | [0m[35m        raise ValueError(f'Task type is not suitable for scoring')[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    if task.metadata['system'].get('consensusTaskType') in ['honeypot', 'qualification']:[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m260 | [0m[35m        all_annotation_slices[f] = annotations.get_frame(frame_num=f)[0m
[30;1m261 | [0m[35m    annotations_by_frame = {}[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    # within each frame, sort all annotation slices to their corresponding assignment/annotator[0m
[30;1m264 | [0m[35m    for frame, annotation_slices in all_annotation_slices.items():[0m
[30;1m265 | [0m[35m        frame_annots_by_assignment = {assignment.annotator: [] for assignment in assignments_by_id.v[0m
[30;1m266 | [0m[35m        for annotation_slice in annotation_slices:[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m                           task_type: str,[0m
[30;1m241 | [0m[35m                           assignments_by_id: dict) -> dict:[0m
[30;1m242 | [0m[35m    """[0m
[30;1m243 | [0m[35m    Hidden function to split video annotations frame by frame and sort by assignment[0m
[30;1m244 | [0m[35m    :param annotations:[0m
[30;1m245 | [0m[35m    :param item:[0m
[30;1m246 | [0m[35m    :param task:[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/scoring/tasks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m                f'configured and completed.')[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        #########################################[0m
[30;1m107 | [0m[35m        # sort annotations and calculate scores #[0m
[30;1m108 | [0m[35m        #########################################[0m
[30;1m109 | [0m[35m        annotations = item.annotations.list()[0m
[30;1m110 | [0m[35m        annotators_list = [assignment.annotator for assignment in assignments_by_id.values()][0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/evaluating/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m                annot_scores = {key: sum(val) / len(val) for key, val, in scores_by_annotator.items([0m
[30;1m44 | [0m[35m                best_annotator = annot_scores[max(annot_scores, key=annot_scores.get)][0m
[30;1m45 | [0m[35m                annots_to_keep = [score.entity_id for score in all_scores if[0m
[30;1m46 | [0m[35m                                  (score.context.get('assignmentId') == best_annotator) and ([0m
[30;1m47 | [0m[35m                                          score.type == ScoreType.ANNOTATION_OVERALL)][0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m                cleanup_annots_by_score(scores=all_scores,[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/evaluating/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m    agree_threshold = agreement_config.get("agree_threshold", 0.5)[0m
[30;1m24 | [0m[35m    keep_only_best = agreement_config.get("keep_only_best", False)[0m
[30;1m25 | [0m[35m    fail_keep_all = agreement_config.get("fail_keep_all", True)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    logger.info(f"Running consensus agreement using task {task.name} with ID {task.id}")[0m
[30;1m28 | [0m[35m    logger.info(f"Configurations: agreement threshold = {agree_threshold}, "[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/evaluating/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    :return: dl.Item[0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m    agree_threshold = agreement_config.get("agree_threshold", 0.5)[0m
[30;1m24 | [0m[35m    keep_only_best = agreement_config.get("keep_only_best", False)[0m
[30;1m25 | [0m[35m    fail_keep_all = agreement_config.get("fail_keep_all", True)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    logger.info(f"Running consensus agreement using task {task.name} with ID {task.id}")[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/evaluating/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    :param progress: dl.Progress (optional)[0m
[30;1m21 | [0m[35m    :return: dl.Item[0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m    agree_threshold = agreement_config.get("agree_threshold", 0.5)[0m
[30;1m24 | [0m[35m    keep_only_best = agreement_config.get("keep_only_best", False)[0m
[30;1m25 | [0m[35m    fail_keep_all = agreement_config.get("fail_keep_all", True)[0m
[30;1m26 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/evaluating/tasks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m    all_scores = calc_task_item_score(task=task, item=item, upload=False)[0m
[30;1m34 | [0m[35m    agreement = check_annotator_agreement(scores=all_scores, threshold=agree_threshold)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    # determine node output action[0m
[30;1m37 | [0m[35m    if progress is not None:[0m
[30;1m38 | [0m[35m        if agreement is True:[0m
[30;1m39 | [0m[35m            progress.update(action='consensus passed')[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/evaluating/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    conf_matrix = pd.DataFrame(index=label_names, columns=label_names, data=0)[0m
[30;1m67 | [0m[35m    for label1, label2 in grouped_labels.index:[0m
[30;1m68 | [0m[35m        # index/rows are the ground truth, cols are the predictions[0m
[30;1m69 | [0m[35m        conf_matrix.loc[label1, label2] = grouped_labels.get((label1, label2), 0)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    return conf_matrix[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/evaluating/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m    model_filename = f'{model_id}.csv'[0m
[30;1m38 | [0m[35m    filters = dl.Filters(field='hidden', values=True)[0m
[30;1m39 | [0m[35m    filters.add(field='name', values=model_filename)[0m
[30;1m40 | [0m[35m    dataset = dl.datasets.get(dataset_id=dataset_id)[0m
[30;1m41 | [0m[35m    items = list(dataset.items.list(filters=filters).all())[0m
[30;1m42 | [0m[35m    if len(items) == 0:[0m
[30;1m43 | [0m[35m        raise ValueError(f'No scores found for model ID {model_id}. Please evaluate model on the dat[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m697 | [0m[35m                first_annotation_id=first_id,[0m
[30;1m698 | [0m[35m                first_annotation_creator=first_annotation.creator,[0m
[30;1m699 | [0m[35m                first_annotation_label=first_annotation.label,[0m
[30;1m700 | [0m[35m                first_annotation_confidence=first_annotation.metadata.get('user', dict()).get('model[0m
[30;1m701 | [0m[35m                    'confidence', 1),[0m
[30;1m702 | [0m[35m                second_annotation_id=None,[0m
[30;1m703 | [0m[35m                second_annotation_creator=None,[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m697 | [0m[35m                first_annotation_id=first_id,[0m
[30;1m698 | [0m[35m                first_annotation_creator=first_annotation.creator,[0m
[30;1m699 | [0m[35m                first_annotation_label=first_annotation.label,[0m
[30;1m700 | [0m[35m                first_annotation_confidence=first_annotation.metadata.get('user', dict()).get('model[0m
[30;1m701 | [0m[35m                    'confidence', 1),[0m
[30;1m702 | [0m[35m                second_annotation_id=None,[0m
[30;1m703 | [0m[35m                second_annotation_creator=None,[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m697 | [0m[35m                first_annotation_id=first_id,[0m
[30;1m698 | [0m[35m                first_annotation_creator=first_annotation.creator,[0m
[30;1m699 | [0m[35m                first_annotation_label=first_annotation.label,[0m
[30;1m700 | [0m[35m                first_annotation_confidence=first_annotation.metadata.get('user', dict()).get('model[0m
[30;1m701 | [0m[35m                    'confidence', 1),[0m
[30;1m702 | [0m[35m                second_annotation_id=None,[0m
[30;1m703 | [0m[35m                second_annotation_creator=None,[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m687 | [0m[35m                                    second_annotation_creator=second_annotation.creator,[0m
[30;1m688 | [0m[35m                                    second_annotation_label=second_annotation.label,[0m
[30;1m689 | [0m[35m                                    second_annotation_confidence=[0m
[30;1m690 | [0m[35m                                    second_annotation.metadata.get('user', dict()).get('model', dict[0m
[30;1m691 | [0m[35m                                        'confidence', 1),[0m
[30;1m692 | [0m[35m                                    item_id=second_annotation.item_id[0m
[30;1m693 | [0m[35m                                    ))[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m687 | [0m[35m                                    second_annotation_creator=second_annotation.creator,[0m
[30;1m688 | [0m[35m                                    second_annotation_label=second_annotation.label,[0m
[30;1m689 | [0m[35m                                    second_annotation_confidence=[0m
[30;1m690 | [0m[35m                                    second_annotation.metadata.get('user', dict()).get('model', dict[0m
[30;1m691 | [0m[35m                                        'confidence', 1),[0m
[30;1m692 | [0m[35m                                    item_id=second_annotation.item_id[0m
[30;1m693 | [0m[35m                                    ))[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m687 | [0m[35m                                    second_annotation_creator=second_annotation.creator,[0m
[30;1m688 | [0m[35m                                    second_annotation_label=second_annotation.label,[0m
[30;1m689 | [0m[35m                                    second_annotation_confidence=[0m
[30;1m690 | [0m[35m                                    second_annotation.metadata.get('user', dict()).get('model', dict[0m
[30;1m691 | [0m[35m                                        'confidence', 1),[0m
[30;1m692 | [0m[35m                                    item_id=second_annotation.item_id[0m
[30;1m693 | [0m[35m                                    ))[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m666 | [0m[35m                second_annotation_id=second_annotation_id,[0m
[30;1m667 | [0m[35m                second_annotation_creator=second_annotation.creator,[0m
[30;1m668 | [0m[35m                second_annotation_label=second_annotation.label,[0m
[30;1m669 | [0m[35m                second_annotation_confidence=second_annotation.metadata.get('user', dict()).get('mod[0m
[30;1m670 | [0m[35m                    'confidence', 1),[0m
[30;1m671 | [0m[35m                geometry_score=geometry_score,[0m
[30;1m672 | [0m[35m                annotation_score=annotation_score,[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m666 | [0m[35m                second_annotation_id=second_annotation_id,[0m
[30;1m667 | [0m[35m                second_annotation_creator=second_annotation.creator,[0m
[30;1m668 | [0m[35m                second_annotation_label=second_annotation.label,[0m
[30;1m669 | [0m[35m                second_annotation_confidence=second_annotation.metadata.get('user', dict()).get('mod[0m
[30;1m670 | [0m[35m                    'confidence', 1),[0m
[30;1m671 | [0m[35m                geometry_score=geometry_score,[0m
[30;1m672 | [0m[35m                annotation_score=annotation_score,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m666 | [0m[35m                second_annotation_id=second_annotation_id,[0m
[30;1m667 | [0m[35m                second_annotation_creator=second_annotation.creator,[0m
[30;1m668 | [0m[35m                second_annotation_label=second_annotation.label,[0m
[30;1m669 | [0m[35m                second_annotation_confidence=second_annotation.metadata.get('user', dict()).get('mod[0m
[30;1m670 | [0m[35m                    'confidence', 1),[0m
[30;1m671 | [0m[35m                geometry_score=geometry_score,[0m
[30;1m672 | [0m[35m                annotation_score=annotation_score,[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m661 | [0m[35m                first_annotation_id=first_annotation_id,[0m
[30;1m662 | [0m[35m                first_annotation_creator=first_annotation.creator,[0m
[30;1m663 | [0m[35m                first_annotation_label=first_annotation.label,[0m
[30;1m664 | [0m[35m                first_annotation_confidence=first_annotation.metadata.get('user', dict()).get('model[0m
[30;1m665 | [0m[35m                    'confidence', 1),[0m
[30;1m666 | [0m[35m                second_annotation_id=second_annotation_id,[0m
[30;1m667 | [0m[35m                second_annotation_creator=second_annotation.creator,[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m661 | [0m[35m                first_annotation_id=first_annotation_id,[0m
[30;1m662 | [0m[35m                first_annotation_creator=first_annotation.creator,[0m
[30;1m663 | [0m[35m                first_annotation_label=first_annotation.label,[0m
[30;1m664 | [0m[35m                first_annotation_confidence=first_annotation.metadata.get('user', dict()).get('model[0m
[30;1m665 | [0m[35m                    'confidence', 1),[0m
[30;1m666 | [0m[35m                second_annotation_id=second_annotation_id,[0m
[30;1m667 | [0m[35m                second_annotation_creator=second_annotation.creator,[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m661 | [0m[35m                first_annotation_id=first_annotation_id,[0m
[30;1m662 | [0m[35m                first_annotation_creator=first_annotation.creator,[0m
[30;1m663 | [0m[35m                first_annotation_label=first_annotation.label,[0m
[30;1m664 | [0m[35m                first_annotation_confidence=first_annotation.metadata.get('user', dict()).get('model[0m
[30;1m665 | [0m[35m                    'confidence', 1),[0m
[30;1m666 | [0m[35m                second_annotation_id=second_annotation_id,[0m
[30;1m667 | [0m[35m                second_annotation_creator=second_annotation.creator,[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m        """[0m
[30;1m536 | [0m[35m        height = config.get('height', 500)[0m
[30;1m537 | [0m[35m        width = config.get('width', 500)[0m
[30;1m538 | [0m[35m        diag = np.sqrt(height ** 2 + width ** 2)[0m
[30;1m539 | [0m[35m        # 20% of the image diagonal tolerance (empirically). need to[0m
[30;1m540 | [0m[35m        return np.exp(-1 / diag * 20 * np.linalg.norm(np.asarray(pt1) - np.asarray(pt2)))[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m533 | [0m[35m        :return: calculated point iou[0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m        """[0m
[30;1m536 | [0m[35m        height = config.get('height', 500)[0m
[30;1m537 | [0m[35m        width = config.get('width', 500)[0m
[30;1m538 | [0m[35m        diag = np.sqrt(height ** 2 + width ** 2)[0m
[30;1m539 | [0m[35m        # 20% of the image diagonal tolerance (empirically). need to[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m    # create user confusion from ALL annotations #[0m
[30;1m230 | [0m[35m    ##############################################[0m
[30;1m231 | [0m[35m    annotation_scores.append(Score(type=ScoreType.USER_CONFUSION,[0m
[30;1m232 | [0m[35m                                   value=mean_or_default(arr=all_results.get('annotation_score', lis[0m
[30;1m233 | [0m[35m                                                         default=1)))[0m
[30;1m234 | [0m[35m    ##############################################[0m
[30;1m235 | [0m[35m    # create label confusion scores for this set #[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m                                             a.type == compare_type and not a.metadata.get('system',[0m
[30;1m95 | [0m[35m                                                 'system', False)][0m
[30;1m96 | [0m[35m        annotation_subset_two.annotations = [a for a in annotations_set_two if[0m
[30;1m97 | [0m[35m                                             a.type == compare_type and not a.metadata.get('system',[0m
[30;1m98 | [0m[35m                                                 'system', False)][0m
[30;1m99 | [0m[35m        # create 2d dataframe with annotation id as names and set all to -1 -> not calculated[0m
[30;1m100 | [0m[35m        if match_wrong_labels is True:[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m                                             a.type == compare_type and not a.metadata.get('system',[0m
[30;1m95 | [0m[35m                                                 'system', False)][0m
[30;1m96 | [0m[35m        annotation_subset_two.annotations = [a for a in annotations_set_two if[0m
[30;1m97 | [0m[35m                                             a.type == compare_type and not a.metadata.get('system',[0m
[30;1m98 | [0m[35m                                                 'system', False)][0m
[30;1m99 | [0m[35m        # create 2d dataframe with annotation id as names and set all to -1 -> not calculated[0m
[30;1m100 | [0m[35m        if match_wrong_labels is True:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        annotation_subset_one = entities.AnnotationCollection()[0m
[30;1m89 | [0m[35m        annotation_subset_two = entities.AnnotationCollection()[0m
[30;1m90 | [0m[35m        annotation_subset_one.annotations = [a for a in annotations_set_one if[0m
[30;1m91 | [0m[35m                                             a.type == compare_type and not a.metadata.get('system',[0m
[30;1m92 | [0m[35m                                                 'system', False)][0m
[30;1m93 | [0m[35m        annotation_subset_two.annotations = [a for a in annotations_set_two if[0m
[30;1m94 | [0m[35m                                             a.type == compare_type and not a.metadata.get('system',[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        annotation_subset_one = entities.AnnotationCollection()[0m
[30;1m89 | [0m[35m        annotation_subset_two = entities.AnnotationCollection()[0m
[30;1m90 | [0m[35m        annotation_subset_one.annotations = [a for a in annotations_set_one if[0m
[30;1m91 | [0m[35m                                             a.type == compare_type and not a.metadata.get('system',[0m
[30;1m92 | [0m[35m                                                 'system', False)][0m
[30;1m93 | [0m[35m        annotation_subset_two.annotations = [a for a in annotations_set_two if[0m
[30;1m94 | [0m[35m                                             a.type == compare_type and not a.metadata.get('system',[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m598 | [0m[35m        :return: Matches object[0m
[30;1m599 | [0m[35m        """[0m
[30;1m600 | [0m[35m        if ignore_geometry is True and ignore_labels is True and ignore_attributes is True:[0m
[30;1m601 | [0m[35m            raise ValueError('Cant compare annotation with all ignore flags set to True, must choose[0m
[30;1m602 | [0m[35m        annotation_type_to_func = {[0m
[30;1m603 | [0m[35m            entities.AnnotationType.BOX: Matchers.calculate_iou_box,[0m
[30;1m604 | [0m[35m            entities.AnnotationType.CLASSIFICATION: Matchers.calculate_iou_classification,[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m565 | [0m[35m        intersection = set(attributes1).intersection(set(attributes2))[0m
[30;1m566 | [0m[35m        union = set(attributes1).union(attributes2)[0m
[30;1m567 | [0m[35m        if len(union) == 0:[0m
[30;1m568 | [0m[35m            # if there is no union - there are no attributes at all[0m
[30;1m569 | [0m[35m            return 1[0m
[30;1m570 | [0m[35m        return len(intersection) / len(union)[0m
[30;1m571 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m520 | [0m[35m        pt is [x,y][0m
[30;1m521 | [0m[35m        normalizing to score between [0, 1] -> 1 is the exact match[0m
[30;1m522 | [0m[35m        if same point score is 1[0m
[30;1m523 | [0m[35m        at about 20 pix distance score is about 0.5, 100 goes to 0[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m        x = np.arange(int(diag))[0m
[30;1m526 | [0m[35m        y = np.exp(-1 / diag * 20 * x)[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m74[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dtlpymetrics/utils/matching.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m393 | [0m[35m            elif loc == 'second':[0m
[30;1m394 | [0m[35m                if match.second_annotation_id == annotation_id:[0m
[30;1m395 | [0m[35m                    return match[0m
[30;1m396 | [0m[35m        raise ValueError('could not find annotation id {!r} in {}'.format(annotation_id, loc))[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35mclass Matchers:[0m

74 matches found.
