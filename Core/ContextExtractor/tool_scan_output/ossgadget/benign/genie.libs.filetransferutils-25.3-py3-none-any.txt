[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/nxos/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m        Warning: Permanently added '1.1.1.1' (ECDSA) to the list of known hosts.[0m
[30;1m106 | [0m[35m        Outbound-ReKey for 1.1.1.1:22[0m
[30;1m107 | [0m[35m        Inbound-ReKey for 1.1.1.1:22[0m
[30;1m108 | [0m[35m        myuser@1.1.1.1's password:[0m
[30;1m109 | [0m[35m        Connected to 1.1.1.1.[0m
[30;1m110 | [0m[35m        sftp> put  /var/tmp/vsh/R3_nx-running-config  /home/virl[0m
[30;1m111 | [0m[35m        Uploading /var/tmp/vsh/R3_nx-running-config to /home/virl/R3_nx-running-config[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/nxos/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m    raw5 = '''[0m
[30;1m81 | [0m[35m        show clock > ftp://10.1.7.250//auto/tftp-ssr/show_clock vrf management[0m
[30;1m82 | [0m[35m        Enter username: rcpuser[0m
[30;1m83 | [0m[35m        Password:[0m
[30;1m84 | [0m[35m        ***** Transfer of file Completed Successfully *****[0m
[30;1m85 | [0m[35m    '''[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/nxos/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m    raw1 = '''[0m
[30;1m46 | [0m[35m        copy bootflash:/virtual-instance.conf ftp://10.1.0.213//auto/tftp-ssr/virtual-instance.conf[0m
[30;1m47 | [0m[35m        Enter username: rcpuser[0m
[30;1m48 | [0m[35m        Password:[0m
[30;1m49 | [0m[35m        ***** Transfer of file Completed Successfully *****[0m
[30;1m50 | [0m[35m        Copy complete.[0m
[30;1m51 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/nxos/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m    # Add testbed servers for authentication[0m
[30;1m33 | [0m[35m    device.testbed.servers = AttrDict([0m
[30;1m34 | [0m[35m        server_name = dict([0m
[30;1m35 | [0m[35m            username="myuser", password="mypw", address='1.1.1.1'),[0m
[30;1m36 | [0m[35m    )[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    dir_output = ['bootflash:/ISSUCleanGolden.system.gbin',[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m                use_kstack: `bool`[0m
[30;1m40 | [0m[35m                    Use faster version during copy operation[0m
[30;1m41 | [0m[35m                    Not supported with a file transfer protocol[0m
[30;1m42 | [0m[35m                    prompting for a username and password[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m            Returns[0m
[30;1m45 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m167 | [0m[35m                'password',[0m
[30;1m168 | [0m[35m                SecretString.from_plaintext(self._generate_credential()))[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m            httpd.auth = base64.b64encode([0m
[30;1m171 | [0m[35m                "{}:{}".format(username, to_plaintext(password)).encode()).decode()[0m
[30;1m172 | [0m[35m        else:[0m
[30;1m173 | [0m[35m            httpd.auth = None[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport email[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport pathlib[0m
[30;1m6 | [0m[35mimport http.server[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m179 | [0m[35m            'credentials': Credentials({[0m
[30;1m180 | [0m[35m                'http': {[0m
[30;1m181 | [0m[35m                    'username': username,[0m
[30;1m182 | [0m[35m                    'password': password[0m
[30;1m183 | [0m[35m                }[0m
[30;1m184 | [0m[35m            }) if http_auth else {}[0m
[30;1m185 | [0m[35m        })[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m179 | [0m[35m            'credentials': Credentials({[0m
[30;1m180 | [0m[35m                'http': {[0m
[30;1m181 | [0m[35m                    'username': username,[0m
[30;1m182 | [0m[35m                    'password': password[0m
[30;1m183 | [0m[35m                }[0m
[30;1m184 | [0m[35m            }) if http_auth else {}[0m
[30;1m185 | [0m[35m        })[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m168 | [0m[35m                SecretString.from_plaintext(self._generate_credential()))[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m            httpd.auth = base64.b64encode([0m
[30;1m171 | [0m[35m                "{}:{}".format(username, to_plaintext(password)).encode()).decode()[0m
[30;1m172 | [0m[35m        else:[0m
[30;1m173 | [0m[35m            httpd.auth = None[0m
[30;1m174 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m164 | [0m[35m            creds = self.server_info.get('credentials', {}).get('http', {})[0m
[30;1m165 | [0m[35m            username = creds.get('username', self._generate_credential())[0m
[30;1m166 | [0m[35m            password = creds.get([0m
[30;1m167 | [0m[35m                'password',[0m
[30;1m168 | [0m[35m                SecretString.from_plaintext(self._generate_credential()))[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m            httpd.auth = base64.b64encode([0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m163 | [0m[35m        if http_auth:[0m
[30;1m164 | [0m[35m            creds = self.server_info.get('credentials', {}).get('http', {})[0m
[30;1m165 | [0m[35m            username = creds.get('username', self._generate_credential())[0m
[30;1m166 | [0m[35m            password = creds.get([0m
[30;1m167 | [0m[35m                'password',[0m
[30;1m168 | [0m[35m                SecretString.from_plaintext(self._generate_credential()))[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/junos/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m    # Mock device output[0m
[30;1m34 | [0m[35m    raw1 = '''[0m
[30;1m35 | [0m[35m            file copy golden_config ftp://myuser@1.1.1.1:/test/ [0m
[30;1m36 | [0m[35m            Password for myuser@1.1.1.1:[0m
[30;1m37 | [0m[35m            ftp://myuser@1.1.1.1:/test/golden_config     100% of 3040  B   11 MBps[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/junos/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m    # Add testbed servers for authentication[0m
[30;1m28 | [0m[35m    device.testbed.servers = AttrDict([0m
[30;1m29 | [0m[35m        server_name = dict([0m
[30;1m30 | [0m[35m            username="myuser", password="mypw", address='1.1.1.1'),[0m
[30;1m31 | [0m[35m    )[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # Mock device output[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/iosxr/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35m            copy ftp://SERVER-IP/IOS-eXR/7.4.2/ASR9K.IOS-eXR7.4.2.All-SMUs.20230501.tar harddisk:/tm[0m
[30;1m113 | [0m[35m            Thu Feb 29 10:32:44.460 EST[0m
[30;1m114 | [0m[35m            Source username: [anonymous]?SERVER-USERNAME[0m
[30;1m115 | [0m[35m            Source password: [0m
[30;1m116 | [0m[35m            Destination filename [/harddisk:/tmp-ALL-v7.4.2-PyATS/ASR9K.IOS-eXR7.4.2.All-SMUs.202305[0m
[30;1m117 | [0m[35m            Accessing ftp://SERVER-USERNAME:*@SERVER-IP/IOS-eXR/7.4.2/ASR9K.IOS-eXR7.4.2.All-SMUs.20[0m
[30;1m118 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/iosxr/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m            sftp running-config myuser@1.1.1.1:/home/virl vrf management[0m
[30;1m101 | [0m[35m            Thu Oct 10 15:45:18.989 UTC[0m
[30;1m102 | [0m[35m            Connecting to 172.16.1.250...[0m
[30;1m103 | [0m[35m            Password:[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m            /misc/disk1/running-config[0m
[30;1m106 | [0m[35m              Overwrite /home/virl/running-config on host 172.16.1.250, continu? [[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/iosxr/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m89 | [0m[35m        copy running-config ftp://10.1.6.242//auto/tftp-ssr/fake_config_2.tcl[0m
[30;1m90 | [0m[35m        Host name or IP address (control-c to abort): [10.1.6.242;default]?[0m
[30;1m91 | [0m[35m        Destination username: []?rcpuser[0m
[30;1m92 | [0m[35m        Destination password:[0m
[30;1m93 | [0m[35m        Destination file name (control-c to abort): [/auto/tftp-ssr/fake_config_2.tcl]?[0m
[30;1m94 | [0m[35m        Building configuration.[0m
[30;1m95 | [0m[35m        349 lines built in 1 second[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/iosxr/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m29 | [0m[35m    # Add testbed servers for authentication[0m
[30;1m30 | [0m[35m    device.testbed.servers = AttrDict([0m
[30;1m31 | [0m[35m        server_name = dict([0m
[30;1m32 | [0m[35m            username="myuser", password="mypw", address='1.1.1.1'),[0m
[30;1m33 | [0m[35m    )[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    dir_output = ['disk0:/status_file', 'disk0:/clihistory', 'disk0:/cvac',[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m158 | [0m[35m                      loop_continue=True,[0m
[30;1m159 | [0m[35m                      continue_timer=False),[0m
[30;1m160 | [0m[35m            Statement(pattern=r'[P|p]assword for .*$',[0m
[30;1m161 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m162 | [0m[35m                      loop_continue=True,[0m
[30;1m163 | [0m[35m                      continue_timer=False),[0m
[30;1m164 | [0m[35m            Statement(pattern=r'Do you want to delete.*$',[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m158 | [0m[35m                      loop_continue=True,[0m
[30;1m159 | [0m[35m                      continue_timer=False),[0m
[30;1m160 | [0m[35m            Statement(pattern=r'[P|p]assword for .*$',[0m
[30;1m161 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m162 | [0m[35m                      loop_continue=True,[0m
[30;1m163 | [0m[35m                      continue_timer=False),[0m
[30;1m164 | [0m[35m            Statement(pattern=r'Do you want to delete.*$',[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m158 | [0m[35m                      loop_continue=True,[0m
[30;1m159 | [0m[35m                      continue_timer=False),[0m
[30;1m160 | [0m[35m            Statement(pattern=r'[P|p]assword for .*$',[0m
[30;1m161 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m162 | [0m[35m                      loop_continue=True,[0m
[30;1m163 | [0m[35m                      continue_timer=False),[0m
[30;1m164 | [0m[35m            Statement(pattern=r'Do you want to delete.*$',[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m                      loop_continue=True,[0m
[30;1m155 | [0m[35m                      continue_timer=False),[0m
[30;1m156 | [0m[35m            Statement(pattern=r'.*[P|p]assword:\s*$',[0m
[30;1m157 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m158 | [0m[35m                      loop_continue=True,[0m
[30;1m159 | [0m[35m                      continue_timer=False),[0m
[30;1m160 | [0m[35m            Statement(pattern=r'[P|p]assword for .*$',[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m                      loop_continue=True,[0m
[30;1m155 | [0m[35m                      continue_timer=False),[0m
[30;1m156 | [0m[35m            Statement(pattern=r'.*[P|p]assword:\s*$',[0m
[30;1m157 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m158 | [0m[35m                      loop_continue=True,[0m
[30;1m159 | [0m[35m                      continue_timer=False),[0m
[30;1m160 | [0m[35m            Statement(pattern=r'[P|p]assword for .*$',[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m                      loop_continue=True,[0m
[30;1m155 | [0m[35m                      continue_timer=False),[0m
[30;1m156 | [0m[35m            Statement(pattern=r'.*[P|p]assword:\s*$',[0m
[30;1m157 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m158 | [0m[35m                      loop_continue=True,[0m
[30;1m159 | [0m[35m                      continue_timer=False),[0m
[30;1m160 | [0m[35m            Statement(pattern=r'[P|p]assword for .*$',[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m                      loop_continue=True,[0m
[30;1m143 | [0m[35m                      continue_timer=False),[0m
[30;1m144 | [0m[35m            Statement(pattern=r'Destination password.*$',[0m
[30;1m145 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m146 | [0m[35m                      loop_continue=True,[0m
[30;1m147 | [0m[35m                      continue_timer=False),[0m
[30;1m148 | [0m[35m            Statement(pattern=r'.*[D|d]estination file *name.*$',[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m                      loop_continue=True,[0m
[30;1m143 | [0m[35m                      continue_timer=False),[0m
[30;1m144 | [0m[35m            Statement(pattern=r'Destination password.*$',[0m
[30;1m145 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m146 | [0m[35m                      loop_continue=True,[0m
[30;1m147 | [0m[35m                      continue_timer=False),[0m
[30;1m148 | [0m[35m            Statement(pattern=r'.*[D|d]estination file *name.*$',[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m                      loop_continue=True,[0m
[30;1m143 | [0m[35m                      continue_timer=False),[0m
[30;1m144 | [0m[35m            Statement(pattern=r'Destination password.*$',[0m
[30;1m145 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m146 | [0m[35m                      loop_continue=True,[0m
[30;1m147 | [0m[35m                      continue_timer=False),[0m
[30;1m148 | [0m[35m            Statement(pattern=r'.*[D|d]estination file *name.*$',[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m141 | [0m[35m                      action='sendline({username})'.format(username=username),[0m
[30;1m142 | [0m[35m                      loop_continue=True,[0m
[30;1m143 | [0m[35m                      continue_timer=False),[0m
[30;1m144 | [0m[35m            Statement(pattern=r'Destination password.*$',[0m
[30;1m145 | [0m[35m                      action='sendline({password})'.format(password=password),[0m
[30;1m146 | [0m[35m                      loop_continue=True,[0m
[30;1m147 | [0m[35m                      continue_timer=False),[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m                                               protocol=kwargs.get('protocol'))[0m
[30;1m97 | [0m[35m        else:[0m
[30;1m98 | [0m[35m            username = None[0m
[30;1m99 | [0m[35m            password = None[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        destination_filename = ''[0m
[30;1m102 | [0m[35m        if destination:[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m            if 'username' in kwargs and kwargs['username'] and kwargs['username'] in used_server:[0m
[30;1m94 | [0m[35m                used_server = used_server.split('@')[1][0m
[30;1m95 | [0m[35m            username, password = self.get_auth(used_server,[0m
[30;1m96 | [0m[35m                                               protocol=kwargs.get('protocol'))[0m
[30;1m97 | [0m[35m        else:[0m
[30;1m98 | [0m[35m            username = None[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m        if not device:[0m
[30;1m86 | [0m[35m            raise AttributeError("Device object is missing, can't proceed with execution")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        # Extracting username and password to be used during device calls[0m
[30;1m89 | [0m[35m        if used_server:[0m
[30;1m90 | [0m[35m            # Case when cli sent contains the username[0m
[30;1m91 | [0m[35m            # EX: admin@1.1.1.1[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/iosxe/test_filetransferutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m    # Add testbed servers for authentication[0m
[30;1m41 | [0m[35m    device.testbed.servers = AttrDict([0m
[30;1m42 | [0m[35m        server_name = dict([0m
[30;1m43 | [0m[35m            username="myuser", password="mypw", address='1.1.1.1'),[0m
[30;1m44 | [0m[35m    )[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    dir_output = ['flash:/nvram_config', 'flash:/.rollback_timer',[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m137 | [0m[35m                url = 'http://{u}:{p}@localhost:{port}/test.txt'.format([0m
[30;1m138 | [0m[35m                    port = fs['port'],[0m
[30;1m139 | [0m[35m                    u = fs['credentials']['http']['username'],[0m
[30;1m140 | [0m[35m                    p = to_plaintext(fs['credentials']['http']['password'])[0m
[30;1m141 | [0m[35m                )[0m
[30;1m142 | [0m[35m                orig_data = ['test123'] * 2[0m
[30;1m143 | [0m[35m                data, content_type = encode_multipart_formdata(orig_data)[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m121 | [0m[35m                url = 'http://{u}:{p}@localhost:{port}/test.txt'.format([0m
[30;1m122 | [0m[35m                    port = fs['port'],[0m
[30;1m123 | [0m[35m                    u = fs['credentials']['http']['username'],[0m
[30;1m124 | [0m[35m                    p = to_plaintext(fs['credentials']['http']['password'])[0m
[30;1m125 | [0m[35m                )[0m
[30;1m126 | [0m[35m                orig_data = 'test123'[0m
[30;1m127 | [0m[35m                data, content_type = encode_multipart_formdata(orig_data)[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m113 | [0m[35m            self.assertEqual(fs['protocol'], 'http')[0m
[30;1m114 | [0m[35m            self.assertEqual(fs['credentials']['http']['username'], 'test')[0m
[30;1m115 | [0m[35m            self.assertEqual([0m
[30;1m116 | [0m[35m                to_plaintext(fs['credentials']['http']['password']), 'test123')[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    def test_http_multipart_single(self):[0m
[30;1m119 | [0m[35m        with tempfile.TemporaryDirectory() as td:[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35m                        custom=dict(http_auth=True),[0m
[30;1m105 | [0m[35m                        credentials=dict(http=dict([0m
[30;1m106 | [0m[35m                            username='test',[0m
[30;1m107 | [0m[35m                            password='test123'[0m
[30;1m108 | [0m[35m                        ))[0m
[30;1m109 | [0m[35m                        ) as fs:[0m
[30;1m110 | [0m[35m            self.assertEqual(fs['address'], '127.0.0.1')[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m                self.assertIsInstance(fs['credentials']['ftp']['password'],[0m
[30;1m63 | [0m[35m                                      SecretString)[0m
[30;1m64 | [0m[35m                self.assertEqual([0m
[30;1m65 | [0m[35m                    to_plaintext(fs['credentials']['ftp']['password']),[0m
[30;1m66 | [0m[35m                    'mypass')[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    def test_scp(self):[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m                self.assertEqual(fs['subnet'], '127.0.0.1')[0m
[30;1m60 | [0m[35m                self.assertEqual(fs['path'], td)[0m
[30;1m61 | [0m[35m                self.assertEqual(fs['protocol'], 'ftp')[0m
[30;1m62 | [0m[35m                self.assertIsInstance(fs['credentials']['ftp']['password'],[0m
[30;1m63 | [0m[35m                                      SecretString)[0m
[30;1m64 | [0m[35m                self.assertEqual([0m
[30;1m65 | [0m[35m                    to_plaintext(fs['credentials']['ftp']['password']),[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m53 | [0m[35m                            credentials={[0m
[30;1m54 | [0m[35m                                'ftp': {[0m
[30;1m55 | [0m[35m                                    'username': 'myuser',[0m
[30;1m56 | [0m[35m                                    'password': 'mypass'}},[0m
[30;1m57 | [0m[35m                            path=td) as fs:[0m
[30;1m58 | [0m[35m                self.assertEqual(fs['address'], '127.0.0.1')[0m
[30;1m59 | [0m[35m                self.assertEqual(fs['subnet'], '127.0.0.1')[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35m            self.assertNotEqual(fs['port'], 0)[0m
[30;1m44 | [0m[35m            self.assertEqual(fs['path'], '/')[0m
[30;1m45 | [0m[35m            self.assertEqual(fs['protocol'], 'ftp')[0m
[30;1m46 | [0m[35m            self.assertIsInstance(fs['credentials']['ftp']['password'],[0m
[30;1m47 | [0m[35m                                  SecretString)[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    def test_ftp_pass_args(self):[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m        # Connect to FTP server[0m
[30;1m88 | [0m[35m        client = ftplib.FTP()[0m
[30;1m89 | [0m[35m        client.connect(host=ip, port=port)[0m
[30;1m90 | [0m[35m        client.login(user=username, passwd=password)[0m
[30;1m91 | [0m[35m        # Get list of files from FTP server[0m
[30;1m92 | [0m[35m        client.dir(lambda x: None)[0m
[30;1m93 | [0m[35m        client.quit()[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m82 | [0m[35m        port = self.server_info['port'][0m
[30;1m83 | [0m[35m        username = self.server_info['credentials']['ftp']['username'][0m
[30;1m84 | [0m[35m        password = to_plaintext([0m
[30;1m85 | [0m[35m            self.server_info['credentials']['ftp']['password'])[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        # Connect to FTP server[0m
[30;1m88 | [0m[35m        client = ftplib.FTP()[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m81 | [0m[35m        ip = self.server_info.get('address', '0.0.0.0')[0m
[30;1m82 | [0m[35m        port = self.server_info['port'][0m
[30;1m83 | [0m[35m        username = self.server_info['credentials']['ftp']['username'][0m
[30;1m84 | [0m[35m        password = to_plaintext([0m
[30;1m85 | [0m[35m            self.server_info['credentials']['ftp']['password'])[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        # Connect to FTP server[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        # Create FTP Server[0m
[30;1m54 | [0m[35m        auth = DummyAuthorizer()[0m
[30;1m55 | [0m[35m        auth.add_user(username, to_plaintext(password), path, perm='elradfmwMT')[0m
[30;1m56 | [0m[35m        handler = FTPHandler[0m
[30;1m57 | [0m[35m        handler.authorizer = auth[0m
[30;1m58 | [0m[35m        server = FTPServer(address, handler)[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m        new_info['credentials'] = Credentials({[0m
[30;1m41 | [0m[35m            'ftp': {[0m
[30;1m42 | [0m[35m                'username': username,[0m
[30;1m43 | [0m[35m                'password': password[0m
[30;1m44 | [0m[35m            }[0m
[30;1m45 | [0m[35m        })[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m        new_info['credentials'] = Credentials({[0m
[30;1m41 | [0m[35m            'ftp': {[0m
[30;1m42 | [0m[35m                'username': username,[0m
[30;1m43 | [0m[35m                'password': password[0m
[30;1m44 | [0m[35m            }[0m
[30;1m45 | [0m[35m        })[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m        creds = self.server_info.get('credentials', {}).get('ftp', {})[0m
[30;1m34 | [0m[35m        username = creds.get('username', self._generate_credential())[0m
[30;1m35 | [0m[35m        password = creds.get([0m
[30;1m36 | [0m[35m            'password',[0m
[30;1m37 | [0m[35m            SecretString.from_plaintext(self._generate_credential()))[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        # return credentials back to parent process[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        creds = self.server_info.get('credentials', {}).get('ftp', {})[0m
[30;1m34 | [0m[35m        username = creds.get('username', self._generate_credential())[0m
[30;1m35 | [0m[35m        password = creds.get([0m
[30;1m36 | [0m[35m            'password',[0m
[30;1m37 | [0m[35m            SecretString.from_plaintext(self._generate_credential()))[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m            # Remove any password in destination[0m
[30;1m47 | [0m[35m            destination = destination.replace(auth, username, 1)[0m
[30;1m48 | [0m[35m        if parsed_source.netloc and '@' in source:[0m
[30;1m49 | [0m[35m            # Remove any password in source[0m
[30;1m50 | [0m[35m            source = source.replace(auth, username, 1)[0m
[30;1m51 | [0m[35m        cmd = 'file copy {s} {d}'.format(s=source, d=destination)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35m        # for junos we need to put only the username in the address, reconstruct[0m
[30;1m44 | [0m[35m        # here[0m
[30;1m45 | [0m[35m        if parsed_dest.netloc and '@' in destination:[0m
[30;1m46 | [0m[35m            # Remove any password in destination[0m
[30;1m47 | [0m[35m            destination = destination.replace(auth, username, 1)[0m
[30;1m48 | [0m[35m        if parsed_source.netloc and '@' in source:[0m
[30;1m49 | [0m[35m            # Remove any password in source[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/tests/nxos/test_filetransferutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m    def test_validate_and_update_url(self):[0m
[30;1m206 | [0m[35m        self.fu_device.is_valid_ip = Mock()[0m
[30;1m207 | [0m[35m        self.fu_device.is_valid_ip.side_effect = self.is_valid_ip_mapper[0m
[30;1m208 | [0m[35m        # set multiple ip for the server[0m
[30;1m209 | [0m[35m        self.device.testbed.servers.server_name['address']=['2.2.2.2', '1.1.1.1'][0m
[30;1m210 | [0m[35m        not_reachable_url = self.fu_device.validate_and_update_url('sftp://2.2.2.2//home/virl',[0m
[30;1m211 | [0m[35m                                                                    device=self.device)[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/tests/nxos/test_filetransferutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m        copy running-config tftp://10.1.7.250//auto/tftp-ssr/test_config.py vrf management[0m
[30;1m92 | [0m[35m        Trying to connect to tftp server......[0m
[30;1m93 | [0m[35m        Connection to Server Established.[0m
[30;1m94 | [0m[35m        [                         ]         0.50KB[#                        ]         4.50KB[##     [0m
[30;1m95 | [0m[35m        Copy complete, now saving to disk (please wait)...[0m
[30;1m96 | [0m[35m        Copy complete.[0m
[30;1m97 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/tests/nxos/test_filetransferutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    raw7 ='''[0m
[30;1m91 | [0m[35m        copy running-config tftp://10.1.7.250//auto/tftp-ssr/test_config.py vrf management[0m
[30;1m92 | [0m[35m        Trying to connect to tftp server......[0m
[30;1m93 | [0m[35m        Connection to Server Established.[0m
[30;1m94 | [0m[35m        [                         ]         0.50KB[#                        ]         4.50KB[##     [0m
[30;1m95 | [0m[35m        Copy complete, now saving to disk (please wait)...[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for TFTP on IOSXR devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXRBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for TFTP on JunOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsJunOSBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        # Extract device from the keyword arguments, if not passed raise an[0m
[30;1m209 | [0m[35m        # AttributeError[0m
[30;1m210 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m211 | [0m[35m        if not device:[0m
[30;1m212 | [0m[35m            raise AttributeError("Device object is missing, can't proceed with"[0m
[30;1m213 | [0m[35m                                 " execution")[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m        # Extract device from the keyword arguments, if not passed raise an[0m
[30;1m150 | [0m[35m        # AttributeError[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m153 | [0m[35m        if not device:[0m
[30;1m154 | [0m[35m            raise AttributeError("Device object is missing, can't proceed with"[0m
[30;1m155 | [0m[35m                                 " execution")[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m            Parameters[0m
[30;1m353 | [0m[35m            ----------[0m
[30;1m354 | [0m[35m                cmd (`str`):  Command to be executed on the device[0m
[30;1m355 | [0m[35m                target (`str`):  File path including the protocol, server and[0m
[30;1m356 | [0m[35m                    file location.[0m
[30;1m357 | [0m[35m                timeout_seconds: `str`[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m257 | [0m[35m        """[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m        # delete flash:memleak.tcl[0m
[30;1m260 | [0m[35m        cmd = cmd or 'delete {f}'.format(f=target)[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        self.send_cli_to_device(cli=cmd,[0m
[30;1m263 | [0m[35m                                timeout_seconds=timeout_seconds,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m257 | [0m[35m        """[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m        # delete flash:memleak.tcl[0m
[30;1m260 | [0m[35m        cmd = cmd or 'delete {f}'.format(f=target)[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        self.send_cli_to_device(cli=cmd,[0m
[30;1m263 | [0m[35m                                timeout_seconds=timeout_seconds,[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m228 | [0m[35m                timeout_seconds : `int`[0m
[30;1m229 | [0m[35m                    The number of seconds to wait before aborting the operation.[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m                cmd : `str`[0m
[30;1m232 | [0m[35m                    Command to override the default delete command[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m            Returns[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m217 | [0m[35m                               dir_output=dir_output,[0m
[30;1m218 | [0m[35m                               **kwargs)[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m    def deletefile(self, target, timeout_seconds, cmd = None, *args, **kwargs):[0m
[30;1m221 | [0m[35m        """ Delete a file[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m    def parsed_dir(self, target, timeout_seconds, dir_output, *args, **kwargs):[0m
[30;1m102 | [0m[35m        """ Retrieve filenames contained in a directory.[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m            Do not recurse into subdirectories, only list files at the top level[0m
[30;1m105 | [0m[35m            of the given directory.[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m319 | [0m[35m                    Same format as `os.chmod`.[0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m                timeout_seconds : `int`[0m
[30;1m322 | [0m[35m                    Maximum allowed amount of time for the operation.[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m            Returns[0m
[30;1m325 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m276 | [0m[35m                    The URL of the new file name.[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m                timeout_seconds : `int`[0m
[30;1m279 | [0m[35m                    Maximum allowed amount of time for the operation.[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m            Returns[0m
[30;1m282 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m    def parsed_dir(self, target, timeout_seconds, dir_output, *args, **kwargs):[0m
[30;1m102 | [0m[35m        """ Retrieve filenames contained in a directory.[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m            Do not recurse into subdirectories, only list files at the top level[0m
[30;1m105 | [0m[35m            of the given directory.[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        path = self.server_info['path'][0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        # Set up client logging[0m
[30;1m52 | [0m[35m        logfile = self.server_info.get('logfile', None)[0m
[30;1m53 | [0m[35m        if logfile:[0m
[30;1m54 | [0m[35m            logfile = '%s.client%s' % os.path.splitext(logfile)[0m
[30;1m55 | [0m[35m            ftp_logger = logging.getLogger('tftpy')[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m        server.listen(address, port)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def verify_server(self):[0m
[30;1m47 | [0m[35m        ip = self.server_info.get('address', '0.0.0.0')[0m
[30;1m48 | [0m[35m        port = self.server_info['port'][0m
[30;1m49 | [0m[35m        path = self.server_info['path'][0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        server = TftpServer(self.path)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        logfile = self.server_info.get('logfile', None)[0m
[30;1m34 | [0m[35m        if logfile:[0m
[30;1m35 | [0m[35m            ftp_logger = logging.getLogger('tftpy')[0m
[30;1m36 | [0m[35m            ftp_logger.setLevel(logging.DEBUG)[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        signal.signal(signal.SIGINT, lambda x, y: None)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m28 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m29 | [0m[35m        self.path = self.server_info.setdefault('path', '/')[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        server = TftpServer(self.path)[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        # Run server in separate process[0m
[30;1m25 | [0m[35m        signal.signal(signal.SIGINT, lambda x, y: None)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m28 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m29 | [0m[35m        self.path = self.server_info.setdefault('path', '/')[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m            filepath = '%s/%s' % (path, filename)[0m
[30;1m93 | [0m[35m            if not os.path.exists(filepath):[0m
[30;1m94 | [0m[35m                return filename[0m
[30;1m95 | [0m[35m        raise OSError('Could not find filename not already in %s' % path)[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m            os.remove(upfilepath)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def get_port(self, server):[0m
[30;1m84 | [0m[35m        # Threaded function to get the allocated port for the TFTP server[0m
[30;1m85 | [0m[35m        server.is_running.wait(5)[0m
[30;1m86 | [0m[35m        self.queue.put({'port': server.listenport, 'path': self.path})[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m            ftp_handler = logging.FileHandler(logfile)[0m
[30;1m59 | [0m[35m            ftp_logger.addHandler(ftp_handler)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        # Create a temporary file to copy to the TFTP server[0m
[30;1m62 | [0m[35m        with tempfile.TemporaryDirectory() as tmpdir:[0m
[30;1m63 | [0m[35m            # Create a file that will not conflict with any existing files[0m
[30;1m64 | [0m[35m            filename = self._generate_filename()[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m        server.listen(address, port)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def verify_server(self):[0m
[30;1m47 | [0m[35m        ip = self.server_info.get('address', '0.0.0.0')[0m
[30;1m48 | [0m[35m        port = self.server_info['port'][0m
[30;1m49 | [0m[35m        path = self.server_info['path'][0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35mclass FileServer(BaseFileServer):[0m
[30;1m17 | [0m[35m    '''FileServer for tftp protocol[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    Starts a TFTP server in another process and returns address information[0m
[30;1m20 | [0m[35m    '''[0m
[30;1m21 | [0m[35m    protocol = 'tftp'[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/tftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mDEFAULT_PORT = 0[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mclass FileServer(BaseFileServer):[0m
[30;1m17 | [0m[35m    '''FileServer for tftp protocol[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    Starts a TFTP server in another process and returns address information[0m
[30;1m20 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/sftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for sftp on IOSXR devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXRBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m        used_server = self.get_server(source, destination)[0m
[30;1m10 | [0m[35m        username, _ = self.get_auth(used_server)[0m
[30;1m11 | [0m[35m        ssh_protocol = {'scp', 'sftp'}[0m
[30;1m12 | [0m[35m        quiet = kwargs.get('quiet', False)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m15 | [0m[35m        # sftp only support download[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m
[30;1m28 | [0m[35m                                              protocol=protocol,[0m
[30;1m29 | [0m[35m                                              s=source.replace('{}://'.format(protocol),[0m
[30;1m30 | [0m[35m                                                               '').replace('//', ':/'),[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m                break[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        else:[0m
[30;1m37 | [0m[35m            raise NotImplementedError('Only SFTP and SCP protocols are supported for linux')[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        super().copyfile(source=source, destination=destination,[0m
[30;1m40 | [0m[35m            timeout_seconds=timeout_seconds, cmd=cmd, used_server=used_server,[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m                break[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        else:[0m
[30;1m37 | [0m[35m            raise NotImplementedError('Only SFTP and SCP protocols are supported for linux')[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        super().copyfile(source=source, destination=destination,[0m
[30;1m40 | [0m[35m            timeout_seconds=timeout_seconds, cmd=cmd, used_server=used_server,[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m                    destination = '{username}@{url}'.format(username=username, url=destination)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m
[30;1m28 | [0m[35m                                              protocol=protocol,[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m                elif '{}:'.format(protocol) in destination:[0m
[30;1m22 | [0m[35m                    destination = '{username}@{url}'.format(username=username, url=destination)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m                elif '{}:'.format(protocol) in destination:[0m
[30;1m22 | [0m[35m                    destination = '{username}@{url}'.format(username=username, url=destination)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m                elif '{}:'.format(protocol) in destination:[0m
[30;1m22 | [0m[35m                    destination = '{username}@{url}'.format(username=username, url=destination)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m        quiet = kwargs.get('quiet', False)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m15 | [0m[35m        # sftp only support download[0m
[30;1m16 | [0m[35m        for protocol in ssh_protocol:[0m
[30;1m17 | [0m[35m            if '{}:'.format(protocol) in source or '{}:'.format(protocol) in destination:[0m
[30;1m18 | [0m[35m                # scp/sftp requires username in the address[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m        ssh_protocol = {'scp', 'sftp'}[0m
[30;1m12 | [0m[35m        quiet = kwargs.get('quiet', False)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m15 | [0m[35m        # sftp only support download[0m
[30;1m16 | [0m[35m        for protocol in ssh_protocol:[0m
[30;1m17 | [0m[35m            if '{}:'.format(protocol) in source or '{}:'.format(protocol) in destination:[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/linux/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m        ssh_protocol = {'scp', 'sftp'}[0m
[30;1m12 | [0m[35m        quiet = kwargs.get('quiet', False)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m15 | [0m[35m        # sftp only support download[0m
[30;1m16 | [0m[35m        for protocol in ssh_protocol:[0m
[30;1m17 | [0m[35m            if '{}:'.format(protocol) in source or '{}:'.format(protocol) in destination:[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m87 | [0m[35m                                                   device=device,[0m
[30;1m88 | [0m[35m                                                   vrf=vrf,[0m
[30;1m89 | [0m[35m                                                   cache_ip=kwargs.get([0m
[30;1m90 | [0m[35m                                                       'cache_ip', True))[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        if vrf is None:[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        source = self.validate_and_update_url(source,[0m
[30;1m82 | [0m[35m                                              device=device,[0m
[30;1m83 | [0m[35m                                              vrf=vrf,[0m
[30;1m84 | [0m[35m                                              cache_ip=kwargs.get([0m
[30;1m85 | [0m[35m                                                  'cache_ip', True))[0m
[30;1m86 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m87 | [0m[35m                                                   device=device,[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        """[0m
[30;1m76 | [0m[35m        # use a device passed as an argument, or the device saved as an[0m
[30;1m77 | [0m[35m        # attribute[0m
[30;1m78 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m81 | [0m[35m        source = self.validate_and_update_url(source,[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m467 | [0m[35m            cmd = 'copy {f} {t} vrf {vrf}'.format(f=source, t=destination,[0m
[30;1m468 | [0m[35m                vrf=vrf)[0m
[30;1m469 | [0m[35m        else:[0m
[30;1m470 | [0m[35m            cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m        super().copyconfiguration(source=source, destination=destination,[0m
[30;1m473 | [0m[35m            timeout_seconds=timeout_seconds, cmd=cmd, used_server=used_server,[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m464 | [0m[35m        # Build copy command[0m
[30;1m465 | [0m[35m        # Example - copy running-configuration bootflash:tempfile1[0m
[30;1m466 | [0m[35m        if vrf:[0m
[30;1m467 | [0m[35m            cmd = 'copy {f} {t} vrf {vrf}'.format(f=source, t=destination,[0m
[30;1m468 | [0m[35m                vrf=vrf)[0m
[30;1m469 | [0m[35m        else:[0m
[30;1m470 | [0m[35m            cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m        # Patch up the command together[0m
[30;1m392 | [0m[35m        # show clock > tftp://10.1.0.213//auto/ftp-ssr/show_clock vrf management[0m
[30;1m393 | [0m[35m        cmd = "show clock > {e} vrf {vrf}".format(e=target, vrf=vrf)[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m        super().validateserver(cmd=cmd, target=target,[0m
[30;1m396 | [0m[35m            timeout_seconds=timeout_seconds, used_server=used_server, *args,[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        """[0m
[30;1m319 | [0m[35m        # move bootflash:memleak.tcl memleak_j.tcl[0m
[30;1m320 | [0m[35m        cmd = 'move {f} {u}'.format(f=source, u=destination)[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m        super().renamefile(source, destination, timeout_seconds, cmd,[0m
[30;1m323 | [0m[35m            *args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m123 | [0m[35m    def dir(self, target, timeout_seconds=300, *args, **kwargs):[0m
[30;1m124 | [0m[35m        """ Retrieve filenames contained in a directory.[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            Do not recurse into subdirectories, only list files at the top level[0m
[30;1m127 | [0m[35m            of the given directory.[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        # for n9k only[0m
[30;1m114 | [0m[35m        if use_kstack:[0m
[30;1m115 | [0m[35m            cmd += ' use-kstack'[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        # Extract the server address to be used later for authentication[0m
[30;1m118 | [0m[35m        used_server = self.get_server(source, destination)[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m108 | [0m[35m            if compact:[0m
[30;1m109 | [0m[35m                cmd = 'copy {f} {t} compact'.format(f=source, t=destination)[0m
[30;1m110 | [0m[35m            else:[0m
[30;1m111 | [0m[35m                cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        # for n9k only[0m
[30;1m114 | [0m[35m        if use_kstack:[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m                                                      vrf=vrf)[0m
[30;1m107 | [0m[35m        else:[0m
[30;1m108 | [0m[35m            if compact:[0m
[30;1m109 | [0m[35m                cmd = 'copy {f} {t} compact'.format(f=source, t=destination)[0m
[30;1m110 | [0m[35m            else:[0m
[30;1m111 | [0m[35m                cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m                                                              t=destination,[0m
[30;1m102 | [0m[35m                                                              vrf=vrf)[0m
[30;1m103 | [0m[35m            else:[0m
[30;1m104 | [0m[35m                cmd = 'copy {f} {t} vrf {vrf}'.format(f=source,[0m
[30;1m105 | [0m[35m                                                      t=destination,[0m
[30;1m106 | [0m[35m                                                      vrf=vrf)[0m
[30;1m107 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35m        if vrf:[0m
[30;1m98 | [0m[35m            # for n9k only[0m
[30;1m99 | [0m[35m            if compact:[0m
[30;1m100 | [0m[35m                cmd = 'copy {f} {t} compact vrf {vrf}'.format(f=source,[0m
[30;1m101 | [0m[35m                                                              t=destination,[0m
[30;1m102 | [0m[35m                                                              vrf=vrf)[0m
[30;1m103 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m        # attribute[0m
[30;1m78 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m81 | [0m[35m        source = self.validate_and_update_url(source,[0m
[30;1m82 | [0m[35m                                              device=device,[0m
[30;1m83 | [0m[35m                                              vrf=vrf,[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m                    Same format as `os.chmod`.[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m                timeout_seconds : `int`[0m
[30;1m337 | [0m[35m                    Maximum allowed amount of time for the operation.[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m            Returns[0m
[30;1m340 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m290 | [0m[35m                    The URL of the new file name.[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m                timeout_seconds : `int`[0m
[30;1m293 | [0m[35m                    Maximum allowed amount of time for the operation.[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m            Returns[0m
[30;1m296 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m    def dir(self, target, timeout_seconds=300, *args, **kwargs):[0m
[30;1m124 | [0m[35m        """ Retrieve filenames contained in a directory.[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            Do not recurse into subdirectories, only list files at the top level[0m
[30;1m127 | [0m[35m            of the given directory.[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/ios/ftp/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on IOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ...iosxe.ftp.fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/ios/ftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on IOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ...iosxe.ftp.fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/ftp/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on IOSXR devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXRBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/ftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on IOSXR devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXRBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        if http_auth:[0m
[30;1m164 | [0m[35m            creds = self.server_info.get('credentials', {}).get('http', {})[0m
[30;1m165 | [0m[35m            username = creds.get('username', self._generate_credential())[0m
[30;1m166 | [0m[35m            password = creds.get([0m
[30;1m167 | [0m[35m                'password',[0m
[30;1m168 | [0m[35m                SecretString.from_plaintext(self._generate_credential()))[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        if http_auth:[0m
[30;1m164 | [0m[35m            creds = self.server_info.get('credentials', {}).get('http', {})[0m
[30;1m165 | [0m[35m            username = creds.get('username', self._generate_credential())[0m
[30;1m166 | [0m[35m            password = creds.get([0m
[30;1m167 | [0m[35m                'password',[0m
[30;1m168 | [0m[35m                SecretString.from_plaintext(self._generate_credential()))[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m        local_port = httpd.server_port[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        if http_auth:[0m
[30;1m164 | [0m[35m            creds = self.server_info.get('credentials', {}).get('http', {})[0m
[30;1m165 | [0m[35m            username = creds.get('username', self._generate_credential())[0m
[30;1m166 | [0m[35m            password = creds.get([0m
[30;1m167 | [0m[35m                'password',[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m        local_port = httpd.server_port[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        if http_auth:[0m
[30;1m164 | [0m[35m            creds = self.server_info.get('credentials', {}).get('http', {})[0m
[30;1m165 | [0m[35m            username = creds.get('username', self._generate_credential())[0m
[30;1m166 | [0m[35m            password = creds.get([0m
[30;1m167 | [0m[35m                'password',[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m153 | [0m[35m        local_dir = self.server_info.get('path', '/')[0m
[30;1m154 | [0m[35m        # use authentication by default[0m
[30;1m155 | [0m[35m        http_auth = self.server_info.get('custom', {}).get('http_auth', True)[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # Setup local HTTP server[0m
[30;1m158 | [0m[35m        server_address = (address, port)[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m153 | [0m[35m        local_dir = self.server_info.get('path', '/')[0m
[30;1m154 | [0m[35m        # use authentication by default[0m
[30;1m155 | [0m[35m        http_auth = self.server_info.get('custom', {}).get('http_auth', True)[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # Setup local HTTP server[0m
[30;1m158 | [0m[35m        server_address = (address, port)[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m        # Run server in separate process[0m
[30;1m151 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m152 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m153 | [0m[35m        local_dir = self.server_info.get('path', '/')[0m
[30;1m154 | [0m[35m        # use authentication by default[0m
[30;1m155 | [0m[35m        http_auth = self.server_info.get('custom', {}).get('http_auth', True)[0m
[30;1m156 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m    def run_server(self):[0m
[30;1m150 | [0m[35m        # Run server in separate process[0m
[30;1m151 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m152 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m153 | [0m[35m        local_dir = self.server_info.get('path', '/')[0m
[30;1m154 | [0m[35m        # use authentication by default[0m
[30;1m155 | [0m[35m        http_auth = self.server_info.get('custom', {}).get('http_auth', True)[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def run_server(self):[0m
[30;1m150 | [0m[35m        # Run server in separate process[0m
[30;1m151 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m152 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m153 | [0m[35m        local_dir = self.server_info.get('path', '/')[0m
[30;1m154 | [0m[35m        # use authentication by default[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m        self.directory = self.server.directory[0m
[30;1m112 | [0m[35m        log.debug(f'Sending file {self.path} from location {self.directory}')[0m
[30;1m113 | [0m[35m        if self.server.auth:[0m
[30;1m114 | [0m[35m            if self.headers.get([0m
[30;1m115 | [0m[35m                    "Authorization") != "Basic " + self.server.auth:[0m
[30;1m116 | [0m[35m                self.do_AUTHHEAD()[0m
[30;1m117 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m            if self.headers.get('Expect', '') == '100-continue':[0m
[30;1m96 | [0m[35m                self.send_response_only(100)[0m
[30;1m97 | [0m[35m                self.end_headers()[0m
[30;1m98 | [0m[35m            if 'multipart' in self.headers.get('Content-Type', ''):[0m
[30;1m99 | [0m[35m                self.receive_multipart(filepath)[0m
[30;1m100 | [0m[35m            else:[0m
[30;1m101 | [0m[35m                # receive data and store in file[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m            log.debug(f'Receiving file {path} to location {server_dir}')[0m
[30;1m93 | [0m[35m            self.length = int(self.headers['Content-Length'])[0m
[30;1m94 | [0m[35m            # Signal to device that we are ready to receive the file data[0m
[30;1m95 | [0m[35m            if self.headers.get('Expect', '') == '100-continue':[0m
[30;1m96 | [0m[35m                self.send_response_only(100)[0m
[30;1m97 | [0m[35m                self.end_headers()[0m
[30;1m98 | [0m[35m            if 'multipart' in self.headers.get('Content-Type', ''):[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    def do_PUT(self):[0m
[30;1m82 | [0m[35m        try:[0m
[30;1m83 | [0m[35m            if self.server.auth:[0m
[30;1m84 | [0m[35m                if self.headers.get([0m
[30;1m85 | [0m[35m                        "Authorization") != "Basic " + self.server.auth:[0m
[30;1m86 | [0m[35m                    self.do_AUTHHEAD()[0m
[30;1m87 | [0m[35m                    return[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m            filepath = server_dir / path[0m
[30;1m68 | [0m[35m            log.debug(f'Receiving file {path} to location {server_dir}')[0m
[30;1m69 | [0m[35m            self.length = int(self.headers['Content-Length'])[0m
[30;1m70 | [0m[35m            if 'multipart' in self.headers.get('Content-Type', ''):[0m
[30;1m71 | [0m[35m                self.receive_multipart(filepath)[0m
[30;1m72 | [0m[35m            else:[0m
[30;1m73 | [0m[35m                with open(filepath, 'wb') as f:[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m    def do_POST(self):[0m
[30;1m58 | [0m[35m        try:[0m
[30;1m59 | [0m[35m            if self.server.auth:[0m
[30;1m60 | [0m[35m                if self.headers.get([0m
[30;1m61 | [0m[35m                        "Authorization") != "Basic " + self.server.auth:[0m
[30;1m62 | [0m[35m                    self.do_AUTHHEAD()[0m
[30;1m63 | [0m[35m                    return[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m                    f.write(payload)[0m
[30;1m47 | [0m[35m        else:[0m
[30;1m48 | [0m[35m            log.error('Unable to decode payload with content type {}'.format([0m
[30;1m49 | [0m[35m                self.headers.get('Content-Type')))[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    def do_AUTHHEAD(self):[0m
[30;1m52 | [0m[35m        self.send_response(401)[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    def receive_multipart(self, filename):[0m
[30;1m23 | [0m[35m        data = self.rfile.read(self.length)[0m
[30;1m24 | [0m[35m        content_header = 'Content-Type: ' + self.headers.get('Content-Type') + '\n\n'[0m
[30;1m25 | [0m[35m        data = content_header.encode() + data[0m
[30;1m26 | [0m[35m        msg = email.message_from_bytes(data)[0m
[30;1m27 | [0m[35m        if msg.is_multipart():[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35mclass ForkingHTTPServer(ForkingMixIn, http.server.HTTPServer):[0m
[30;1m122 | [0m[35m    '''Forking HTTP server[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    Allows the server to process several requests at the time. In some[0m
[30;1m125 | [0m[35m    HTTP client implementations, two HTTP requets may be sent without[0m
[30;1m126 | [0m[35m    explicitly closing them. This class adds support for this use-case[0m
[30;1m127 | [0m[35m    scenario[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/http.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport email[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport pathlib[0m
[30;1m6 | [0m[35mimport http.server[0m
[30;1m7 | [0m[35mfrom socketserver import ForkingMixIn[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/ftp/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = ['ip ftp source-interface {interface}'][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = ['ip ftp source-interface {interface}'][0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/ftp/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = ['ip ftp source-interface {interface}'][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = ['ip ftp source-interface {interface}'][0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/ftp/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on IOSXE devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/ftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = ['ip ftp source-interface {interface}'][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = ['ip ftp source-interface {interface}'][0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/ftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = ['ip ftp source-interface {interface}'][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = ['ip ftp source-interface {interface}'][0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/ftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on IOSXE devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie.libs.filetransferutils-25.3.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mGenie was initially developed internally in Cisco, and is now available to the[0m
[30;1m55 | [0m[35mgeneral public starting early 2018 through `Cisco DevNet`_. Visit the Genie[0m
[30;1m56 | [0m[35mhome page at[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    https://developer.cisco.com/site/pyats/[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m.. _Cisco DevNet: https://developer.cisco.com/[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie.libs.filetransferutils-25.3.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m    $ pip install --upgrade genie.libs.filetransferutils[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    # to install alpha/beta versions, add --pre[0m
[30;1m87 | [0m[35m    $ pip install --pre genie.libs.filetransferutils[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mFor more information on setting up your Python development environment,[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie.libs.filetransferutils-25.3.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m    $ pip install genie[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    # to upgrade this package manually[0m
[30;1m84 | [0m[35m    $ pip install --upgrade genie.libs.filetransferutils[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    # to install alpha/beta versions, add --pre[0m
[30;1m87 | [0m[35m    $ pip install --pre genie.libs.filetransferutils[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie.libs.filetransferutils-25.3.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m.. code-block:: console[0m
[30;1m79 | [0m[35m [0m
[30;1m80 | [0m[35m    # install genie as a whole[0m
[30;1m81 | [0m[35m    $ pip install genie[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    # to upgrade this package manually[0m
[30;1m84 | [0m[35m    $ pip install --upgrade genie.libs.filetransferutils[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for TFTP on NXOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsNXBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/scp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m    '''FileServer for scp protocol[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m    Does not actually start any server, just provides address information for[0m
[30;1m7 | [0m[35m    scp copy commands[0m
[30;1m8 | [0m[35m    '''[0m
[30;1m9 | [0m[35m    protocol = 'scp'[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/scp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom ..server import FileServer as BaseFileServer[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mclass FileServer(BaseFileServer):[0m
[30;1m4 | [0m[35m    '''FileServer for scp protocol[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m    Does not actually start any server, just provides address information for[0m
[30;1m7 | [0m[35m    scp copy commands[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/ios/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for TFTP on IOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ...iosxe.tftp.fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    ][0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = [[0m
[30;1m12 | [0m[35m        'ip tftp source-interface {interface}', 'ip tftp blocksize {blocksize}'[0m
[30;1m13 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    ][0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = [[0m
[30;1m12 | [0m[35m        'ip tftp source-interface {interface}', 'ip tftp blocksize {blocksize}'[0m
[30;1m13 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = [[0m
[30;1m8 | [0m[35m        'ip tftp source-interface {interface}', 'ip tftp blocksize {blocksize}'[0m
[30;1m9 | [0m[35m    ][0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = [[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = [[0m
[30;1m8 | [0m[35m        'ip tftp source-interface {interface}', 'ip tftp blocksize {blocksize}'[0m
[30;1m9 | [0m[35m    ][0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = [[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/tftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for TFTP on IOSXE devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/ftp/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on JunOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsJunOSBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/ftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on JunOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsJunOSBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/tests/iosxr/test_filetransferutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m    '''[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    raw7 =  '''[0m
[30;1m100 | [0m[35m            sftp running-config myuser@1.1.1.1:/home/virl vrf management[0m
[30;1m101 | [0m[35m            Thu Oct 10 15:45:18.989 UTC[0m
[30;1m102 | [0m[35m            Connecting to 172.16.1.250...[0m
[30;1m103 | [0m[35m            Password:[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/tests/iosxr/test_filetransferutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    raw6 = '''[0m
[30;1m89 | [0m[35m        copy running-config ftp://10.1.6.242//auto/tftp-ssr/fake_config_2.tcl[0m
[30;1m90 | [0m[35m        Host name or IP address (control-c to abort): [10.1.6.242;default]?[0m
[30;1m91 | [0m[35m        Destination username: []?rcpuser[0m
[30;1m92 | [0m[35m        Destination password:[0m
[30;1m93 | [0m[35m        Destination file name (control-c to abort): [/auto/tftp-ssr/fake_config_2.tcl]?[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/ios/sftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SFTP on IOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ...iosxe.sftp.fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m                    device.configure(config_restore)[0m
[30;1m296 | [0m[35m                    # If specified, wait for a period of time after restoring[0m
[30;1m297 | [0m[35m                    # configuration to let it settle[0m
[30;1m298 | [0m[35m                    wait_time = kwargs.get('wait_after_restore', 1)[0m
[30;1m299 | [0m[35m                    time.sleep(wait_time)[0m
[30;1m300 | [0m[35m                except Exception:[0m
[30;1m301 | [0m[35m                    logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m        # device might be a connection, get actual device[0m
[30;1m247 | [0m[35m        device = device.device[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        vrf = kwargs.get('vrf')[0m
[30;1m250 | [0m[35m        # Retrieve correct config template for this OS[0m
[30;1m251 | [0m[35m        if vrf:[0m
[30;1m252 | [0m[35m            copy_config = getattr(self, 'COPY_CONFIG_VRF_TEMPLATE', None)[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m                protocol source interface configuration to the device if provided)[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m        """[0m
[30;1m242 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m243 | [0m[35m        if not device:[0m
[30;1m244 | [0m[35m            raise AttributeError("Device object is missing, can't proceed with"[0m
[30;1m245 | [0m[35m                                 " configuration")[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m                    error_pattern = device.testbed.custom.fileutils.get('error_pattern')[0m
[30;1m212 | [0m[35m                    if isinstance(error_pattern, list):[0m
[30;1m213 | [0m[35m                        error_pattern = error_pattern[0m
[30;1m214 | [0m[35m                    append_error_pattern = device.testbed.custom.fileutils.get('append_error_pattern[0m
[30;1m215 | [0m[35m                    if isinstance(append_error_pattern, list):[0m
[30;1m216 | [0m[35m                        error_pattern.extend(append_error_pattern)[0m
[30;1m217 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        if hasattr(device, 'testbed'):[0m
[30;1m209 | [0m[35m            if hasattr(device.testbed, 'custom'):[0m
[30;1m210 | [0m[35m                if hasattr(device.testbed.custom, 'fileutils'):[0m
[30;1m211 | [0m[35m                    error_pattern = device.testbed.custom.fileutils.get('error_pattern')[0m
[30;1m212 | [0m[35m                    if isinstance(error_pattern, list):[0m
[30;1m213 | [0m[35m                        error_pattern = error_pattern[0m
[30;1m214 | [0m[35m                    append_error_pattern = device.testbed.custom.fileutils.get('append_error_pattern[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m                      continue_timer=False),[0m
[30;1m188 | [0m[35m            Statement(pattern=r'.*Do you want to (overwrite|overwritte|overwrit).*$',[0m
[30;1m189 | [0m[35m                      action='sendline({overwrite})'.format([0m
[30;1m190 | [0m[35m                          overwrite='y' if kwargs.get('overwrite', True) else 'n'),[0m
[30;1m191 | [0m[35m                      loop_continue=True,[0m
[30;1m192 | [0m[35m                      continue_timer=False),[0m
[30;1m193 | [0m[35m            Statement(pattern=r'Enter vrf.*$',[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m                      loop_continue=True,[0m
[30;1m183 | [0m[35m                      continue_timer=False),[0m
[30;1m184 | [0m[35m            Statement(pattern=r' *[O|o]verwrite.*continu.*$',[0m
[30;1m185 | [0m[35m                      action='sendline({overwrite})'.format(overwrite='yes' if kwargs.get('overwrite[0m
[30;1m186 | [0m[35m                      loop_continue=True,[0m
[30;1m187 | [0m[35m                      continue_timer=False),[0m
[30;1m188 | [0m[35m            Statement(pattern=r'.*Do you want to (overwrite|overwritte|overwrit).*$',[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m            if 'username' in kwargs and kwargs['username'] and kwargs['username'] in used_server:[0m
[30;1m94 | [0m[35m                used_server = used_server.split('@')[1][0m
[30;1m95 | [0m[35m            username, password = self.get_auth(used_server,[0m
[30;1m96 | [0m[35m                                               protocol=kwargs.get('protocol'))[0m
[30;1m97 | [0m[35m        else:[0m
[30;1m98 | [0m[35m            username = None[0m
[30;1m99 | [0m[35m            password = None[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        # Extract device from the keyword arguments, if not passed raise an[0m
[30;1m83 | [0m[35m        # AttributeError[0m
[30;1m84 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m85 | [0m[35m        if not device:[0m
[30;1m86 | [0m[35m            raise AttributeError("Device object is missing, can't proceed with execution")[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m        if not used_server:[0m
[30;1m423 | [0m[35m            # If both URLS have no valid IP addres, raise an exception[0m
[30;1m424 | [0m[35m            raise Exception("No valid server address or hostname has been detected in the "[0m
[30;1m425 | [0m[35m                "passed URLS '{from_URL}' & '{to_URL}'".format([0m
[30;1m426 | [0m[35m                    from_URL=source, to_URL=destination))[0m
[30;1m427 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m417 | [0m[35m                break[0m
[30;1m418 | [0m[35m            except Exception:[0m
[30;1m419 | [0m[35m                if parsed.hostname:[0m
[30;1m420 | [0m[35m                    used_server = parsed.hostname[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m        if not used_server:[0m
[30;1m423 | [0m[35m            # If both URLS have no valid IP addres, raise an exception[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m416 | [0m[35m                used_server = str(ipaddress.ip_address(parsed.hostname))[0m
[30;1m417 | [0m[35m                break[0m
[30;1m418 | [0m[35m            except Exception:[0m
[30;1m419 | [0m[35m                if parsed.hostname:[0m
[30;1m420 | [0m[35m                    used_server = parsed.hostname[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m        if not used_server:[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m413 | [0m[35m            # Validate parsed address is a valid IP address[0m
[30;1m414 | [0m[35m            try:[0m
[30;1m415 | [0m[35m                # only include address, no port or credentials[0m
[30;1m416 | [0m[35m                used_server = str(ipaddress.ip_address(parsed.hostname))[0m
[30;1m417 | [0m[35m                break[0m
[30;1m418 | [0m[35m            except Exception:[0m
[30;1m419 | [0m[35m                if parsed.hostname:[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m                >>> from ..fileutils import FileUtils[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m                  # copy flash:/memleak.tcl ftp://10.1.0.213//auto/tftp-ssr/memleak.tcl[0m
[30;1m76 | [0m[35m                  >>> cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m                  >>> FileUtils.send_cli_to_device(cli=cmd,[0m
[30;1m79 | [0m[35m                  ...   timeout_seconds=timeout_seconds, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m420 | [0m[35m                    used_server = parsed.hostname[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m        if not used_server:[0m
[30;1m423 | [0m[35m            # If both URLS have no valid IP addres, raise an exception[0m
[30;1m424 | [0m[35m            raise Exception("No valid server address or hostname has been detected in the "[0m
[30;1m425 | [0m[35m                "passed URLS '{from_URL}' & '{to_URL}'".format([0m
[30;1m426 | [0m[35m                    from_URL=source, to_URL=destination))[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m410 | [0m[35m        # Extract the server address to be used later for authentication[0m
[30;1m411 | [0m[35m        for item in new_list:[0m
[30;1m412 | [0m[35m            parsed = self.parse_url(item)[0m
[30;1m413 | [0m[35m            # Validate parsed address is a valid IP address[0m
[30;1m414 | [0m[35m            try:[0m
[30;1m415 | [0m[35m                # only include address, no port or credentials[0m
[30;1m416 | [0m[35m                used_server = str(ipaddress.ip_address(parsed.hostname))[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m            return False[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    def is_valid_ip_no_cache(self, ip, device, vrf=None):[0m
[30;1m355 | [0m[35m        # check if ip is reachable from device by sending ping command, not cached version[0m
[30;1m356 | [0m[35m        try:[0m
[30;1m357 | [0m[35m            if vrf:[0m
[30;1m358 | [0m[35m                device.ping(ip, vrf=vrf)[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m341 | [0m[35m    @lru_cache(maxsize=32)[0m
[30;1m342 | [0m[35m    def is_valid_ip_cache(self, ip, device, vrf=None):[0m
[30;1m343 | [0m[35m        # check if ip is reachable from device by sending ping command,[0m
[30;1m344 | [0m[35m        # this one is cached that it only pings the first time[0m
[30;1m345 | [0m[35m        try:[0m
[30;1m346 | [0m[35m            if vrf:[0m
[30;1m347 | [0m[35m                device.ping(ip, vrf=vrf)[0m
[30;1m348 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    @lru_cache(maxsize=32)[0m
[30;1m342 | [0m[35m    def is_valid_ip_cache(self, ip, device, vrf=None):[0m
[30;1m343 | [0m[35m        # check if ip is reachable from device by sending ping command,[0m
[30;1m344 | [0m[35m        # this one is cached that it only pings the first time[0m
[30;1m345 | [0m[35m        try:[0m
[30;1m346 | [0m[35m            if vrf:[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m293 | [0m[35m            if config_restore:[0m
[30;1m294 | [0m[35m                try:[0m
[30;1m295 | [0m[35m                    device.configure(config_restore)[0m
[30;1m296 | [0m[35m                    # If specified, wait for a period of time after restoring[0m
[30;1m297 | [0m[35m                    # configuration to let it settle[0m
[30;1m298 | [0m[35m                    wait_time = kwargs.get('wait_after_restore', 1)[0m
[30;1m299 | [0m[35m                    time.sleep(wait_time)[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m                      action='sendline()',[0m
[30;1m166 | [0m[35m                      loop_continue=True,[0m
[30;1m167 | [0m[35m                      continue_timer=False),[0m
[30;1m168 | [0m[35m            Statement(pattern=r'Host name or IP address.*$',[0m
[30;1m169 | [0m[35m                      action='sendline()',[0m
[30;1m170 | [0m[35m                      loop_continue=True,[0m
[30;1m171 | [0m[35m                      continue_timer=False),[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport contextlib[0m
[30;1m6 | [0m[35mimport ipaddress[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom functools import lru_cache[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m# Urlparse[0m
[30;1m11 | [0m[35mfrom urllib.parse import urlparse[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        # Wait for queue to ensure the server is running[0m
[30;1m164 | [0m[35m        try:[0m
[30;1m165 | [0m[35m            info = self.queue.get(True, self.timeout)[0m
[30;1m166 | [0m[35m        except queue.Empty:[0m
[30;1m167 | [0m[35m            self.stop_server()[0m
[30;1m168 | [0m[35m            raise Exception('%s server did not start after %s seconds' %[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m        # Log address of server[0m
[30;1m97 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m98 | [0m[35m        port = self.server_info.get('port')[0m
[30;1m99 | [0m[35m        path = self.server_info.get('path', '/')[0m
[30;1m100 | [0m[35m        if port:[0m
[30;1m101 | [0m[35m            address += ':%s' % port[0m
[30;1m102 | [0m[35m        logger.info('%s File Server%s started on %s with path %s' %[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        # Log address of server[0m
[30;1m97 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m98 | [0m[35m        port = self.server_info.get('port')[0m
[30;1m99 | [0m[35m        path = self.server_info.get('path', '/')[0m
[30;1m100 | [0m[35m        if port:[0m
[30;1m101 | [0m[35m            address += ':%s' % port[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m            raise OSError('Failed to verify %s' % str(type(self))) from e[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        # Log address of server[0m
[30;1m97 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m98 | [0m[35m        port = self.server_info.get('port')[0m
[30;1m99 | [0m[35m        path = self.server_info.get('path', '/')[0m
[30;1m100 | [0m[35m        if port:[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        if self.server_info.get('subnet') or cfg.get(FILETRANSFER_SUBNET_CFG):[0m
[30;1m64 | [0m[35m            # Get specific ip from subnet[0m
[30;1m65 | [0m[35m            self.server_info['address'] = self._get_ip([0m
[30;1m66 | [0m[35m                self.server_info.get('subnet', cfg.get(FILETRANSFER_SUBNET_CFG)))[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        # Extract name if provided[0m
[30;1m69 | [0m[35m        self.name = None[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        if self.server_info.get('subnet') or cfg.get(FILETRANSFER_SUBNET_CFG):[0m
[30;1m64 | [0m[35m            # Get specific ip from subnet[0m
[30;1m65 | [0m[35m            self.server_info['address'] = self._get_ip([0m
[30;1m66 | [0m[35m                self.server_info.get('subnet', cfg.get(FILETRANSFER_SUBNET_CFG)))[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        # Extract name if provided[0m
[30;1m69 | [0m[35m        self.name = None[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m        self.server_info.update(kwargs)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # try to determine IP address from user provided subnet[0m
[30;1m63 | [0m[35m        if self.server_info.get('subnet') or cfg.get(FILETRANSFER_SUBNET_CFG):[0m
[30;1m64 | [0m[35m            # Get specific ip from subnet[0m
[30;1m65 | [0m[35m            self.server_info['address'] = self._get_ip([0m
[30;1m66 | [0m[35m                self.server_info.get('subnet', cfg.get(FILETRANSFER_SUBNET_CFG)))[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m        self.server_info.update(kwargs)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # try to determine IP address from user provided subnet[0m
[30;1m63 | [0m[35m        if self.server_info.get('subnet') or cfg.get(FILETRANSFER_SUBNET_CFG):[0m
[30;1m64 | [0m[35m            # Get specific ip from subnet[0m
[30;1m65 | [0m[35m            self.server_info['address'] = self._get_ip([0m
[30;1m66 | [0m[35m                self.server_info.get('subnet', cfg.get(FILETRANSFER_SUBNET_CFG)))[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        # Get class specific to protocol[0m
[30;1m32 | [0m[35m        if factory_cls is FileServer:[0m
[30;1m33 | [0m[35m            protocol = kwargs.get('protocol', '').lower()[0m
[30;1m34 | [0m[35m            if not protocol:[0m
[30;1m35 | [0m[35m                raise TypeError('No protocol specified')[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m104 | [0m[35m                    f' {self.name}' if self.name else '',[0m
[30;1m105 | [0m[35m                    address, path))[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        # Update testbed with new server info[0m
[30;1m108 | [0m[35m        if self.testbed is not None and self.name:[0m
[30;1m109 | [0m[35m            recursive_update([0m
[30;1m110 | [0m[35m                self.testbed.servers.setdefault(self.name, AttrDict()),[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m        if len(valid_ips) == 0:[0m
[30;1m144 | [0m[35m            raise TypeError('No valid IP for subnet %s' % (subnet))[0m
[30;1m145 | [0m[35m        elif len(valid_ips) > 1:[0m
[30;1m146 | [0m[35m            raise TypeError('More than one valid IP for subnet %s.\n%s\nTry a '[0m
[30;1m147 | [0m[35m                            'more specific subnet.' %[0m
[30;1m148 | [0m[35m                            (subnet, '\n'.join(valid_ips)))[0m
[30;1m149 | [0m[35m        return valid_ips[0][0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # Must have exactly one match[0m
[30;1m143 | [0m[35m        if len(valid_ips) == 0:[0m
[30;1m144 | [0m[35m            raise TypeError('No valid IP for subnet %s' % (subnet))[0m
[30;1m145 | [0m[35m        elif len(valid_ips) > 1:[0m
[30;1m146 | [0m[35m            raise TypeError('More than one valid IP for subnet %s.\n%s\nTry a '[0m
[30;1m147 | [0m[35m                            'more specific subnet.' %[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m            for snic in iface:[0m
[30;1m137 | [0m[35m                if snic.family == socket.AF_INET:[0m
[30;1m138 | [0m[35m                    ip = netaddr.IPAddress(snic.address, flags=netaddr.INET_ATON)[0m
[30;1m139 | [0m[35m                    if ip in subnet:[0m
[30;1m140 | [0m[35m                        valid_ips.append(snic.address)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # Must have exactly one match[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m        for iname, iface in interfaces.items():[0m
[30;1m136 | [0m[35m            for snic in iface:[0m
[30;1m137 | [0m[35m                if snic.family == socket.AF_INET:[0m
[30;1m138 | [0m[35m                    ip = netaddr.IPAddress(snic.address, flags=netaddr.INET_ATON)[0m
[30;1m139 | [0m[35m                    if ip in subnet:[0m
[30;1m140 | [0m[35m                        valid_ips.append(snic.address)[0m
[30;1m141 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m            subnet.netmask = netmask[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        valid_ips = [][0m
[30;1m132 | [0m[35m        # Check the IP addresses of all interfaces to find the ones that match[0m
[30;1m133 | [0m[35m        # the given subnet[0m
[30;1m134 | [0m[35m        interfaces = psutil.net_if_addrs()[0m
[30;1m135 | [0m[35m        for iname, iface in interfaces.items():[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m            subnet.netmask = netmask[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        valid_ips = [][0m
[30;1m132 | [0m[35m        # Check the IP addresses of all interfaces to find the ones that match[0m
[30;1m133 | [0m[35m        # the given subnet[0m
[30;1m134 | [0m[35m        interfaces = psutil.net_if_addrs()[0m
[30;1m135 | [0m[35m        for iname, iface in interfaces.items():[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # try to determine IP address from user provided subnet[0m
[30;1m63 | [0m[35m        if self.server_info.get('subnet') or cfg.get(FILETRANSFER_SUBNET_CFG):[0m
[30;1m64 | [0m[35m            # Get specific ip from subnet[0m
[30;1m65 | [0m[35m            self.server_info['address'] = self._get_ip([0m
[30;1m66 | [0m[35m                self.server_info.get('subnet', cfg.get(FILETRANSFER_SUBNET_CFG)))[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m        self.timeout = kwargs.pop('timeout', TIMEOUT_DEFAULT)[0m
[30;1m60 | [0m[35m        self.server_info.update(kwargs)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # try to determine IP address from user provided subnet[0m
[30;1m63 | [0m[35m        if self.server_info.get('subnet') or cfg.get(FILETRANSFER_SUBNET_CFG):[0m
[30;1m64 | [0m[35m            # Get specific ip from subnet[0m
[30;1m65 | [0m[35m            self.server_info['address'] = self._get_ip([0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/tests/iosxe/test_filetransferutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m188 | [0m[35m            'copy flash:/memleak.tcl ftp://myuser:mypw@1.1.1.1//auto/tftp-ssr/memleak.tcl',[0m
[30;1m189 | [0m[35m            prompt_recovery=True, timeout='300', reply=ANY, error_pattern=ANY)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def test_copyfile_with_hostname(self):[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        self.device.execute = Mock()[0m
[30;1m194 | [0m[35m        self.device.execute.side_effect = self.mapper[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                )[0m
[30;1m142 | [0m[35m                orig_data = ['test123'] * 2[0m
[30;1m143 | [0m[35m                data, content_type = encode_multipart_formdata(orig_data)[0m
[30;1m144 | [0m[35m                r = requests.post(url, data=data, headers={'Content-type': content_type})[0m
[30;1m145 | [0m[35m                self.assertEqual(r.status_code, 201)[0m
[30;1m146 | [0m[35m                with open(os.path.join(td, 'test_1.txt'), 'rb') as f:[0m
[30;1m147 | [0m[35m                    test_data = f.read().decode()[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/tests/fileserver/test_filetransferserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m                )[0m
[30;1m126 | [0m[35m                orig_data = 'test123'[0m
[30;1m127 | [0m[35m                data, content_type = encode_multipart_formdata(orig_data)[0m
[30;1m128 | [0m[35m                r = requests.post(url, data=data, headers={'Content-type': content_type})[0m
[30;1m129 | [0m[35m                self.assertEqual(r.status_code, 201)[0m
[30;1m130 | [0m[35m                with open(os.path.join(td, 'test.txt'), 'rb') as f:[0m
[30;1m131 | [0m[35m                    test_data = f.read().decode()[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/sftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = ['ip scp source-interface {interface}'][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = ['ip scp source-interface {interface}'][0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/sftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = ['ip scp source-interface {interface}'][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = ['ip scp source-interface {interface}'][0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/sftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SFTP on IOSXE devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/ios/scp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SCP on IOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ...iosxe.scp.fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/scp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SCP on IOSXR devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXRBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        server.serve_forever()[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    def verify_server(self):[0m
[30;1m81 | [0m[35m        ip = self.server_info.get('address', '0.0.0.0')[0m
[30;1m82 | [0m[35m        port = self.server_info['port'][0m
[30;1m83 | [0m[35m        username = self.server_info['credentials']['ftp']['username'][0m
[30;1m84 | [0m[35m        password = to_plaintext([0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m        server.max_cons_per_ip = 5[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # Set up logging for the FTP Server[0m
[30;1m63 | [0m[35m        logfile = self.server_info.get('logfile', None)[0m
[30;1m64 | [0m[35m        if logfile:[0m
[30;1m65 | [0m[35m            ftp_logger = logging.getLogger('pyftpdlib')[0m
[30;1m66 | [0m[35m            ftp_logger.setLevel(logging.DEBUG)[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        })[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m48 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m49 | [0m[35m        address = (address, port)[0m
[30;1m50 | [0m[35m        path = self.server_info.setdefault('path', '/')[0m
[30;1m51 | [0m[35m        new_info['path'] = path[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m            }[0m
[30;1m45 | [0m[35m        })[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        address = self.server_info.get('address', '0.0.0.0')[0m
[30;1m48 | [0m[35m        port = self.server_info.get('port', DEFAULT_PORT)[0m
[30;1m49 | [0m[35m        address = (address, port)[0m
[30;1m50 | [0m[35m        path = self.server_info.setdefault('path', '/')[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        creds = self.server_info.get('credentials', {}).get('ftp', {})[0m
[30;1m34 | [0m[35m        username = creds.get('username', self._generate_credential())[0m
[30;1m35 | [0m[35m        password = creds.get([0m
[30;1m36 | [0m[35m            'password',[0m
[30;1m37 | [0m[35m            SecretString.from_plaintext(self._generate_credential()))[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        new_info = {}[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        creds = self.server_info.get('credentials', {}).get('ftp', {})[0m
[30;1m34 | [0m[35m        username = creds.get('username', self._generate_credential())[0m
[30;1m35 | [0m[35m        password = creds.get([0m
[30;1m36 | [0m[35m            'password',[0m
[30;1m37 | [0m[35m            SecretString.from_plaintext(self._generate_credential()))[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        # dict to send back in queue once server is started[0m
[30;1m31 | [0m[35m        new_info = {}[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        creds = self.server_info.get('credentials', {}).get('ftp', {})[0m
[30;1m34 | [0m[35m        username = creds.get('username', self._generate_credential())[0m
[30;1m35 | [0m[35m        password = creds.get([0m
[30;1m36 | [0m[35m            'password',[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        # dict to send back in queue once server is started[0m
[30;1m31 | [0m[35m        new_info = {}[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        creds = self.server_info.get('credentials', {}).get('ftp', {})[0m
[30;1m34 | [0m[35m        username = creds.get('username', self._generate_credential())[0m
[30;1m35 | [0m[35m        password = creds.get([0m
[30;1m36 | [0m[35m            'password',[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m88 | [0m[35m        client = ftplib.FTP()[0m
[30;1m89 | [0m[35m        client.connect(host=ip, port=port)[0m
[30;1m90 | [0m[35m        client.login(user=username, passwd=password)[0m
[30;1m91 | [0m[35m        # Get list of files from FTP server[0m
[30;1m92 | [0m[35m        client.dir(lambda x: None)[0m
[30;1m93 | [0m[35m        client.quit()[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m84 | [0m[35m        password = to_plaintext([0m
[30;1m85 | [0m[35m            self.server_info['credentials']['ftp']['password'])[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        # Connect to FTP server[0m
[30;1m88 | [0m[35m        client = ftplib.FTP()[0m
[30;1m89 | [0m[35m        client.connect(host=ip, port=port)[0m
[30;1m90 | [0m[35m        client.login(user=username, passwd=password)[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m59 | [0m[35m        server.max_cons = 256[0m
[30;1m60 | [0m[35m        server.max_cons_per_ip = 5[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # Set up logging for the FTP Server[0m
[30;1m63 | [0m[35m        logfile = self.server_info.get('logfile', None)[0m
[30;1m64 | [0m[35m        if logfile:[0m
[30;1m65 | [0m[35m            ftp_logger = logging.getLogger('pyftpdlib')[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35m        path = self.server_info.setdefault('path', '/')[0m
[30;1m51 | [0m[35m        new_info['path'] = path[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        # Create FTP Server[0m
[30;1m54 | [0m[35m        auth = DummyAuthorizer()[0m
[30;1m55 | [0m[35m        auth.add_user(username, to_plaintext(password), path, perm='elradfmwMT')[0m
[30;1m56 | [0m[35m        handler = FTPHandler[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35mclass FileServer(BaseFileServer):[0m
[30;1m18 | [0m[35m    '''FileServer for ftp protocol[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    Starts a FTP server in another process and returns address information[0m
[30;1m21 | [0m[35m    '''[0m
[30;1m22 | [0m[35m    protocol = 'ftp'[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35mDEFAULT_PORT = 0[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mclass FileServer(BaseFileServer):[0m
[30;1m18 | [0m[35m    '''FileServer for ftp protocol[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    Starts a FTP server in another process and returns address information[0m
[30;1m21 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        client = ftplib.FTP()[0m
[30;1m89 | [0m[35m        client.connect(host=ip, port=port)[0m
[30;1m90 | [0m[35m        client.login(user=username, passwd=password)[0m
[30;1m91 | [0m[35m        # Get list of files from FTP server[0m
[30;1m92 | [0m[35m        client.dir(lambda x: None)[0m
[30;1m93 | [0m[35m        client.quit()[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m        password = to_plaintext([0m
[30;1m85 | [0m[35m            self.server_info['credentials']['ftp']['password'])[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        # Connect to FTP server[0m
[30;1m88 | [0m[35m        client = ftplib.FTP()[0m
[30;1m89 | [0m[35m        client.connect(host=ip, port=port)[0m
[30;1m90 | [0m[35m        client.login(user=username, passwd=password)[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m        server.serve_forever()[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    def verify_server(self):[0m
[30;1m81 | [0m[35m        ip = self.server_info.get('address', '0.0.0.0')[0m
[30;1m82 | [0m[35m        port = self.server_info['port'][0m
[30;1m83 | [0m[35m        username = self.server_info['credentials']['ftp']['username'][0m
[30;1m84 | [0m[35m        password = to_plaintext([0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m        server.max_cons = 256[0m
[30;1m60 | [0m[35m        server.max_cons_per_ip = 5[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # Set up logging for the FTP Server[0m
[30;1m63 | [0m[35m        logfile = self.server_info.get('logfile', None)[0m
[30;1m64 | [0m[35m        if logfile:[0m
[30;1m65 | [0m[35m            ftp_logger = logging.getLogger('pyftpdlib')[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        path = self.server_info.setdefault('path', '/')[0m
[30;1m51 | [0m[35m        new_info['path'] = path[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        # Create FTP Server[0m
[30;1m54 | [0m[35m        auth = DummyAuthorizer()[0m
[30;1m55 | [0m[35m        auth.add_user(username, to_plaintext(password), path, perm='elradfmwMT')[0m
[30;1m56 | [0m[35m        handler = FTPHandler[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mclass FileServer(BaseFileServer):[0m
[30;1m18 | [0m[35m    '''FileServer for ftp protocol[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    Starts a FTP server in another process and returns address information[0m
[30;1m21 | [0m[35m    '''[0m
[30;1m22 | [0m[35m    protocol = 'ftp'[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/protocols/ftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mDEFAULT_PORT = 0[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mclass FileServer(BaseFileServer):[0m
[30;1m18 | [0m[35m    '''FileServer for ftp protocol[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    Starts a FTP server in another process and returns address information[0m
[30;1m21 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m87 | [0m[35m                                                   device=device,[0m
[30;1m88 | [0m[35m                                                   vrf=vrf,[0m
[30;1m89 | [0m[35m                                                   cache_ip=kwargs.get([0m
[30;1m90 | [0m[35m                                                       'cache_ip', True))[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        # copy flash:/memleak.tcl ftp://10.1.0.213//auto/tftp-ssr/memleak.tcl[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        source = self.validate_and_update_url(source,[0m
[30;1m82 | [0m[35m                                              device=device,[0m
[30;1m83 | [0m[35m                                              vrf=vrf,[0m
[30;1m84 | [0m[35m                                              cache_ip=kwargs.get([0m
[30;1m85 | [0m[35m                                                  'cache_ip', True))[0m
[30;1m86 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m87 | [0m[35m                                                   device=device,[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        """[0m
[30;1m76 | [0m[35m        # use a device passed as an argument, or the device saved as an[0m
[30;1m77 | [0m[35m        # attribute[0m
[30;1m78 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m81 | [0m[35m        source = self.validate_and_update_url(source,[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m        # Build copy command[0m
[30;1m477 | [0m[35m        # Example - copy running-configuration bootflash:tempfile1[0m
[30;1m478 | [0m[35m        cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m        super().copyconfiguration(source=source, destination=destination,[0m
[30;1m481 | [0m[35m            timeout_seconds=timeout_seconds, cmd=cmd, used_server=used_server,[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m        # Patch up the command together[0m
[30;1m404 | [0m[35m        # show clock | redirect ftp://10.1.6.242//auto/tftp-ssr/show_clock[0m
[30;1m405 | [0m[35m        cmd = "show clock | redirect {e}".format(e=target)[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        self.parse_url(target)[0m
[30;1m408 | [0m[35m        super().validateserver(cmd=cmd, target=target,[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m        """[0m
[30;1m333 | [0m[35m        # rename bootflash:memleak.tcl memleak_j.tcl[0m
[30;1m334 | [0m[35m        cmd = 'rename {f} {u}'.format(f=source, u=destination)[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m        super().renamefile(source, destination, timeout_seconds, cmd,[0m
[30;1m337 | [0m[35m            *args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m        cmd = None[0m
[30;1m289 | [0m[35m        if force:[0m
[30;1m290 | [0m[35m            cmd = 'delete /force {f}'.format(f=target)[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m        super().deletefile(target, timeout_seconds, cmd=cmd, *args, **kwargs)[0m
[30;1m293 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m        """[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m        cmd = None[0m
[30;1m289 | [0m[35m        if force:[0m
[30;1m290 | [0m[35m            cmd = 'delete /force {f}'.format(f=target)[0m
[30;1m291 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m122 | [0m[35m    def dir(self, target, timeout_seconds=300, *args, **kwargs):[0m
[30;1m123 | [0m[35m        """ Retrieve filenames contained in a directory.[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m            Do not recurse into subdirectories, only list files at the top level[0m
[30;1m126 | [0m[35m            of the given directory.[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m            cmd = 'copy {f} {t}'.format(f=source, t=dest)[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        if vrf:[0m
[30;1m109 | [0m[35m            cmd += f' vrf {vrf}'[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        # if still too long, log warning and continue[0m
[30;1m112 | [0m[35m        if len(cmd) > MAX_CLI_LENGTH:[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m                dest = destination[:idx][0m
[30;1m104 | [0m[35m            else:[0m
[30;1m105 | [0m[35m                dest = destination[0m
[30;1m106 | [0m[35m            cmd = 'copy {f} {t}'.format(f=source, t=dest)[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        if vrf:[0m
[30;1m109 | [0m[35m            cmd += f' vrf {vrf}'[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m                                                       'cache_ip', True))[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        # copy flash:/memleak.tcl ftp://10.1.0.213//auto/tftp-ssr/memleak.tcl[0m
[30;1m93 | [0m[35m        cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m
[30;1m94 | [0m[35m        if len(cmd) > MAX_CLI_LENGTH:[0m
[30;1m95 | [0m[35m            # path is too long for IOSXE CLI, truncate it by using destination without path[0m
[30;1m96 | [0m[35m            if '//' in destination:[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m        # attribute[0m
[30;1m78 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m81 | [0m[35m        source = self.validate_and_update_url(source,[0m
[30;1m82 | [0m[35m                                              device=device,[0m
[30;1m83 | [0m[35m                                              vrf=vrf,[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m348 | [0m[35m                    Same format as `os.chmod`.[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                timeout_seconds : `int`[0m
[30;1m351 | [0m[35m                    Maximum allowed amount of time for the operation.[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m            Returns[0m
[30;1m354 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m304 | [0m[35m                    The URL of the new file name.[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m                timeout_seconds : `int`[0m
[30;1m307 | [0m[35m                    Maximum allowed amount of time for the operation.[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m            Returns[0m
[30;1m310 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m    def dir(self, target, timeout_seconds=300, *args, **kwargs):[0m
[30;1m123 | [0m[35m        """ Retrieve filenames contained in a directory.[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m            Do not recurse into subdirectories, only list files at the top level[0m
[30;1m126 | [0m[35m            of the given directory.[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/http/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SCP on NXOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsNXBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/sftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SFTP on NXOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsNXBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/scp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SCP on JunOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsJunOSBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/scp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SCP on NXOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsNXBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/ftp/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on NXOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsNXBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/nxos/ftp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for FTP on NXOS devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsNXBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m        used_server = self.get_server(source, destination)[0m
[30;1m10 | [0m[35m        username, _ = self.get_auth(used_server)[0m
[30;1m11 | [0m[35m        ssh_protocol = {'scp', 'sftp'}[0m
[30;1m12 | [0m[35m        quiet = kwargs.get('quiet', False)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m15 | [0m[35m        # sftp only support download[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35m        """[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        # rm -f /data/techsupport/local.tgz[0m
[30;1m81 | [0m[35m        cmd = 'rm -f {f}'.format(f=target)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        self.send_cli_to_device(cli=cmd, timeout_seconds=timeout_seconds, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m
[30;1m28 | [0m[35m                                              protocol=protocol,[0m
[30;1m29 | [0m[35m                                              s=source.replace('{}://'.format(protocol),[0m
[30;1m30 | [0m[35m                                                               '').replace('//', ':/'),[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m                break[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        else:[0m
[30;1m37 | [0m[35m            raise NotImplementedError('Only SFTP and SCP protocols are currently supported for APIC'[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        super().copyfile(source=source, destination=destination,[0m
[30;1m40 | [0m[35m            timeout_seconds=timeout_seconds, cmd=cmd, used_server=used_server,[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m                break[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        else:[0m
[30;1m37 | [0m[35m            raise NotImplementedError('Only SFTP and SCP protocols are currently supported for APIC'[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        super().copyfile(source=source, destination=destination,[0m
[30;1m40 | [0m[35m            timeout_seconds=timeout_seconds, cmd=cmd, used_server=used_server,[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m                    destination = '{username}@{url}'.format(username=username, url=destination)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m
[30;1m28 | [0m[35m                                              protocol=protocol,[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m                elif '{}:'.format(protocol) in destination:[0m
[30;1m22 | [0m[35m                    destination = '{username}@{url}'.format(username=username, url=destination)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m                elif '{}:'.format(protocol) in destination:[0m
[30;1m22 | [0m[35m                    destination = '{username}@{url}'.format(username=username, url=destination)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m                elif '{}:'.format(protocol) in destination:[0m
[30;1m22 | [0m[35m                    destination = '{username}@{url}'.format(username=username, url=destination)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                # still use scp if user provided sftp because sftp is interactive[0m
[30;1m25 | [0m[35m                # will change this if one day we can support sftp on linux[0m
[30;1m26 | [0m[35m                # if quiet is true it will hide the copy progress[0m
[30;1m27 | [0m[35m                cmd = 'scp {q}{s} {d}'.format(q='-q ' if quiet else '',[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m        quiet = kwargs.get('quiet', False)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m15 | [0m[35m        # sftp only support download[0m
[30;1m16 | [0m[35m        for protocol in ssh_protocol:[0m
[30;1m17 | [0m[35m            if '{}:'.format(protocol) in source or '{}:'.format(protocol) in destination:[0m
[30;1m18 | [0m[35m                # scp/sftp requires username in the address[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m        ssh_protocol = {'scp', 'sftp'}[0m
[30;1m12 | [0m[35m        quiet = kwargs.get('quiet', False)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m15 | [0m[35m        # sftp only support download[0m
[30;1m16 | [0m[35m        for protocol in ssh_protocol:[0m
[30;1m17 | [0m[35m            if '{}:'.format(protocol) in source or '{}:'.format(protocol) in destination:[0m
[30;1m18 | [0m[35m                # scp/sftp requires username in the address[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/apic/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m        ssh_protocol = {'scp', 'sftp'}[0m
[30;1m12 | [0m[35m        quiet = kwargs.get('quiet', False)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m15 | [0m[35m        # sftp only support download[0m
[30;1m16 | [0m[35m        for protocol in ssh_protocol:[0m
[30;1m17 | [0m[35m            if '{}:'.format(protocol) in source or '{}:'.format(protocol) in destination:[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m536 | [0m[35m                # Append port if it's defined[0m
[30;1m537 | [0m[35m                server_block = self.get_server_block([0m
[30;1m538 | [0m[35m                server_name_or_ip = parsed_url.hostname, device = device)[0m
[30;1m539 | [0m[35m                port = server_block.get('port')[0m
[30;1m540 | [0m[35m                if port and port != DEFAULT_PORTS[protocol]:[0m
[30;1m541 | [0m[35m                    hostname = '%s:%s' % (hostname, str(port))[0m
[30;1m542 | [0m[35m                # Make sure we don't replace the protocol when the hostname has the[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m526 | [0m[35m            except Exception as e:[0m
[30;1m527 | [0m[35m                logger.error(f'Could not copy file because of {e}')[0m
[30;1m528 | [0m[35m                raise e[0m
[30;1m529 | [0m[35m            version = out.get('software_version')[0m
[30;1m530 | [0m[35m        if version and int(version.split('.')[0]) >= 7:[0m
[30;1m531 | [0m[35m            # if there is a host name, this means the address is remote[0m
[30;1m532 | [0m[35m            if parsed_url.hostname:[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m93 | [0m[35m                                                   device=device,[0m
[30;1m94 | [0m[35m                                                   vrf=vrf,[0m
[30;1m95 | [0m[35m                                                   cache_ip=kwargs.get([0m
[30;1m96 | [0m[35m                                                       'cache_ip', True))[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        # Extract the server address to be used later for authentication[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        source = self.validate_and_update_url(source,[0m
[30;1m88 | [0m[35m                                              device=device,[0m
[30;1m89 | [0m[35m                                              vrf=vrf,[0m
[30;1m90 | [0m[35m                                              cache_ip=kwargs.get([0m
[30;1m91 | [0m[35m                                                  'cache_ip', True))[0m
[30;1m92 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m93 | [0m[35m                                                   device=device,[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        """[0m
[30;1m82 | [0m[35m        # use a device passed as an argument, or the device saved as an[0m
[30;1m83 | [0m[35m        # attribute[0m
[30;1m84 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m87 | [0m[35m        source = self.validate_and_update_url(source,[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m545 | [0m[35m                    url = protocol + url[len(protocol):].replace([0m
[30;1m546 | [0m[35m                        parsed_url.hostname, hostname, 1)[0m
[30;1m547 | [0m[35m                else:[0m
[30;1m548 | [0m[35m                    url = url.replace(parsed_url.hostname, hostname, 1)[0m
[30;1m549 | [0m[35m                return url[0m
[30;1m550 | [0m[35m[0m
[30;1m551 | [0m[35m            # just return url if it's local[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m545 | [0m[35m                    url = protocol + url[len(protocol):].replace([0m
[30;1m546 | [0m[35m                        parsed_url.hostname, hostname, 1)[0m
[30;1m547 | [0m[35m                else:[0m
[30;1m548 | [0m[35m                    url = url.replace(parsed_url.hostname, hostname, 1)[0m
[30;1m549 | [0m[35m                return url[0m
[30;1m550 | [0m[35m[0m
[30;1m551 | [0m[35m            # just return url if it's local[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m543 | [0m[35m                # same name eg. ftp://ftp/path/to/file[0m
[30;1m544 | [0m[35m                if protocol and url.startswith(protocol):[0m
[30;1m545 | [0m[35m                    url = protocol + url[len(protocol):].replace([0m
[30;1m546 | [0m[35m                        parsed_url.hostname, hostname, 1)[0m
[30;1m547 | [0m[35m                else:[0m
[30;1m548 | [0m[35m                    url = url.replace(parsed_url.hostname, hostname, 1)[0m
[30;1m549 | [0m[35m                return url[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m543 | [0m[35m                # same name eg. ftp://ftp/path/to/file[0m
[30;1m544 | [0m[35m                if protocol and url.startswith(protocol):[0m
[30;1m545 | [0m[35m                    url = protocol + url[len(protocol):].replace([0m
[30;1m546 | [0m[35m                        parsed_url.hostname, hostname, 1)[0m
[30;1m547 | [0m[35m                else:[0m
[30;1m548 | [0m[35m                    url = url.replace(parsed_url.hostname, hostname, 1)[0m
[30;1m549 | [0m[35m                return url[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m539 | [0m[35m                port = server_block.get('port')[0m
[30;1m540 | [0m[35m                if port and port != DEFAULT_PORTS[protocol]:[0m
[30;1m541 | [0m[35m                    hostname = '%s:%s' % (hostname, str(port))[0m
[30;1m542 | [0m[35m                # Make sure we don't replace the protocol when the hostname has the[0m
[30;1m543 | [0m[35m                # same name eg. ftp://ftp/path/to/file[0m
[30;1m544 | [0m[35m                if protocol and url.startswith(protocol):[0m
[30;1m545 | [0m[35m                    url = protocol + url[len(protocol):].replace([0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m538 | [0m[35m                server_name_or_ip = parsed_url.hostname, device = device)[0m
[30;1m539 | [0m[35m                port = server_block.get('port')[0m
[30;1m540 | [0m[35m                if port and port != DEFAULT_PORTS[protocol]:[0m
[30;1m541 | [0m[35m                    hostname = '%s:%s' % (hostname, str(port))[0m
[30;1m542 | [0m[35m                # Make sure we don't replace the protocol when the hostname has the[0m
[30;1m543 | [0m[35m                # same name eg. ftp://ftp/path/to/file[0m
[30;1m544 | [0m[35m                if protocol and url.startswith(protocol):[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m538 | [0m[35m                server_name_or_ip = parsed_url.hostname, device = device)[0m
[30;1m539 | [0m[35m                port = server_block.get('port')[0m
[30;1m540 | [0m[35m                if port and port != DEFAULT_PORTS[protocol]:[0m
[30;1m541 | [0m[35m                    hostname = '%s:%s' % (hostname, str(port))[0m
[30;1m542 | [0m[35m                # Make sure we don't replace the protocol when the hostname has the[0m
[30;1m543 | [0m[35m                # same name eg. ftp://ftp/path/to/file[0m
[30;1m544 | [0m[35m                if protocol and url.startswith(protocol):[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m535 | [0m[35m                    [0m
[30;1m536 | [0m[35m                # Append port if it's defined[0m
[30;1m537 | [0m[35m                server_block = self.get_server_block([0m
[30;1m538 | [0m[35m                server_name_or_ip = parsed_url.hostname, device = device)[0m
[30;1m539 | [0m[35m                port = server_block.get('port')[0m
[30;1m540 | [0m[35m                if port and port != DEFAULT_PORTS[protocol]:[0m
[30;1m541 | [0m[35m                    hostname = '%s:%s' % (hostname, str(port))[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m531 | [0m[35m            # if there is a host name, this means the address is remote[0m
[30;1m532 | [0m[35m            if parsed_url.hostname:[0m
[30;1m533 | [0m[35m                # get hostname to check for valid ip[0m
[30;1m534 | [0m[35m                hostname = self.get_hostname(parsed_url.hostname, device=device, **kwargs)[0m
[30;1m535 | [0m[35m                    [0m
[30;1m536 | [0m[35m                # Append port if it's defined[0m
[30;1m537 | [0m[35m                server_block = self.get_server_block([0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m531 | [0m[35m            # if there is a host name, this means the address is remote[0m
[30;1m532 | [0m[35m            if parsed_url.hostname:[0m
[30;1m533 | [0m[35m                # get hostname to check for valid ip[0m
[30;1m534 | [0m[35m                hostname = self.get_hostname(parsed_url.hostname, device=device, **kwargs)[0m
[30;1m535 | [0m[35m                    [0m
[30;1m536 | [0m[35m                # Append port if it's defined[0m
[30;1m537 | [0m[35m                server_block = self.get_server_block([0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m531 | [0m[35m            # if there is a host name, this means the address is remote[0m
[30;1m532 | [0m[35m            if parsed_url.hostname:[0m
[30;1m533 | [0m[35m                # get hostname to check for valid ip[0m
[30;1m534 | [0m[35m                hostname = self.get_hostname(parsed_url.hostname, device=device, **kwargs)[0m
[30;1m535 | [0m[35m                    [0m
[30;1m536 | [0m[35m                # Append port if it's defined[0m
[30;1m537 | [0m[35m                server_block = self.get_server_block([0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m530 | [0m[35m        if version and int(version.split('.')[0]) >= 7:[0m
[30;1m531 | [0m[35m            # if there is a host name, this means the address is remote[0m
[30;1m532 | [0m[35m            if parsed_url.hostname:[0m
[30;1m533 | [0m[35m                # get hostname to check for valid ip[0m
[30;1m534 | [0m[35m                hostname = self.get_hostname(parsed_url.hostname, device=device, **kwargs)[0m
[30;1m535 | [0m[35m                    [0m
[30;1m536 | [0m[35m                # Append port if it's defined[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m529 | [0m[35m            version = out.get('software_version')[0m
[30;1m530 | [0m[35m        if version and int(version.split('.')[0]) >= 7:[0m
[30;1m531 | [0m[35m            # if there is a host name, this means the address is remote[0m
[30;1m532 | [0m[35m            if parsed_url.hostname:[0m
[30;1m533 | [0m[35m                # get hostname to check for valid ip[0m
[30;1m534 | [0m[35m                hostname = self.get_hostname(parsed_url.hostname, device=device, **kwargs)[0m
[30;1m535 | [0m[35m                    [0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m.hostname[0m
[30;1m512 | [0m[35m            raise SubCommandFailure('File was not successfully copied')[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    def validate_and_update_url(self, url, device=None, **kwargs ):[0m
[30;1m515 | [0m[35m        """Validate the url and replace the hostname/address with a[0m
[30;1m516 | [0m[35m        reachable address from the testbed"""[0m
[30;1m517 | [0m[35m        parsed_url = urlparse(url)[0m
[30;1m518 | [0m[35m        protocol = self.get_protocol(url)[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m        # Build copy command[0m
[30;1m479 | [0m[35m        # Example - copy running-configuration bootflash:tempfile1[0m
[30;1m480 | [0m[35m        cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m
[30;1m481 | [0m[35m[0m
[30;1m482 | [0m[35m        super().copyconfiguration(source=source,[0m
[30;1m483 | [0m[35m                                  destination=destination,[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35m        # Patch up the command together[0m
[30;1m399 | [0m[35m        # show clock | file ftp://10.1.6.242//auto/tftp-ssr/show_clock[0m
[30;1m400 | [0m[35m        cmd = "show clock | file {e}".format(e=target)[0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m        super().validateserver(cmd=cmd,[0m
[30;1m403 | [0m[35m                               target=target,[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m134 | [0m[35m    def dir(self, target, timeout_seconds=300, *args, **kwargs):[0m
[30;1m135 | [0m[35m        """ Retrieve filenames contained in a directory.[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m            Do not recurse into subdirectories, only list files at the top level[0m
[30;1m138 | [0m[35m            of the given directory.[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m                                                        t=destination,[0m
[30;1m121 | [0m[35m                                                        vrf_value=vrf)[0m
[30;1m122 | [0m[35m        else:[0m
[30;1m123 | [0m[35m            cmd = 'copy {f} {t}'.format(f=source, t=destination)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m        return super().copyfile(source=source,[0m
[30;1m126 | [0m[35m                         destination=destination,[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35m            else:[0m
[30;1m117 | [0m[35m                cmd = '{p} {s} {d}'.format(p=p, s=s, d=d)[0m
[30;1m118 | [0m[35m        elif vrf:[0m
[30;1m119 | [0m[35m            cmd = 'copy {f} {t} vrf {vrf_value}'.format(f=source,[0m
[30;1m120 | [0m[35m                                                        t=destination,[0m
[30;1m121 | [0m[35m                                                        vrf_value=vrf)[0m
[30;1m122 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m114 | [0m[35m                                                           d=d,[0m
[30;1m115 | [0m[35m                                                           vrf_value=vrf)[0m
[30;1m116 | [0m[35m            else:[0m
[30;1m117 | [0m[35m                cmd = '{p} {s} {d}'.format(p=p, s=s, d=d)[0m
[30;1m118 | [0m[35m        elif vrf:[0m
[30;1m119 | [0m[35m            cmd = 'copy {f} {t} vrf {vrf_value}'.format(f=source,[0m
[30;1m120 | [0m[35m                                                        t=destination,[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35m            s = source.replace('{}://'.format(p), '').replace('//', ':/')[0m
[30;1m110 | [0m[35m            d = destination.replace('{}://'.format(p), '').replace('//', ':/')[0m
[30;1m111 | [0m[35m            if vrf:[0m
[30;1m112 | [0m[35m                cmd = '{p} {s} {d} vrf {vrf_value}'.format(p=p,[0m
[30;1m113 | [0m[35m                                                           s=s,[0m
[30;1m114 | [0m[35m                                                           d=d,[0m
[30;1m115 | [0m[35m                                                           vrf_value=vrf)[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m        # attribute[0m
[30;1m84 | [0m[35m        device = kwargs.get('device') or getattr(self, 'device', None)[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m87 | [0m[35m        source = self.validate_and_update_url(source,[0m
[30;1m88 | [0m[35m                                              device=device,[0m
[30;1m89 | [0m[35m                                              vrf=vrf,[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m530 | [0m[35m        if version and int(version.split('.')[0]) >= 7:[0m
[30;1m531 | [0m[35m            # if there is a host name, this means the address is remote[0m
[30;1m532 | [0m[35m            if parsed_url.hostname:[0m
[30;1m533 | [0m[35m                # get hostname to check for valid ip[0m
[30;1m534 | [0m[35m                hostname = self.get_hostname(parsed_url.hostname, device=device, **kwargs)[0m
[30;1m535 | [0m[35m                    [0m
[30;1m536 | [0m[35m                # Append port if it's defined[0m
[30;1m537 | [0m[35m                server_block = self.get_server_block([0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m                    Same format as `os.chmod`.[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m                timeout_seconds : `int`[0m
[30;1m345 | [0m[35m                    Maximum allowed amount of time for the operation.[0m
[30;1m346 | [0m[35m[0m
[30;1m347 | [0m[35m            Returns[0m
[30;1m348 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m299 | [0m[35m                    The URL of the new file name.[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m                timeout_seconds : `int`[0m
[30;1m302 | [0m[35m                    Maximum allowed amount of time for the operation.[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m            Returns[0m
[30;1m305 | [0m[35m            -------[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m    def dir(self, target, timeout_seconds=300, *args, **kwargs):[0m
[30;1m135 | [0m[35m        """ Retrieve filenames contained in a directory.[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m            Do not recurse into subdirectories, only list files at the top level[0m
[30;1m138 | [0m[35m            of the given directory.[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m            Parameters[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m        used_server = self.get_server(source, destination)[0m
[30;1m100 | [0m[35m        ssh_protocol = {'scp', 'sftp'}[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m103 | [0m[35m        # get_protocol will not return both result from source and destination[0m
[30;1m104 | [0m[35m        # so checking both here.[0m
[30;1m105 | [0m[35m        p = self.get_protocol(source)[0m
[30;1m106 | [0m[35m        if p not in ssh_protocol:[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxr/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m        used_server = self.get_server(source, destination)[0m
[30;1m100 | [0m[35m        ssh_protocol = {'scp', 'sftp'}[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        # if protocol is scp or sftp[0m
[30;1m103 | [0m[35m        # get_protocol will not return both result from source and destination[0m
[30;1m104 | [0m[35m        # so checking both here.[0m
[30;1m105 | [0m[35m        p = self.get_protocol(source)[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/scp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = ['ip scp source-interface {interface}'][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = ['ip scp source-interface {interface}'][0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/scp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mclass FileUtils(FileUtilsXEBase):[0m
[30;1m7 | [0m[35m    COPY_CONFIG_TEMPLATE = ['ip scp source-interface {interface}'][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m    COPY_CONFIG_VRF_TEMPLATE = ['ip scp source-interface {interface}'][0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/iosxe/scp/fileutils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m""" File utils base class for SCP on IOSXE devices. """[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..fileutils import FileUtils as FileUtilsXEBase[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/plugin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m                server['protocol'] = protocol[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m            # Set up log file for file transfer server[0m
[30;1m37 | [0m[35m            if 'logfile' in server.get('custom', {}):[0m
[30;1m38 | [0m[35m                server['logfile'] = server['custom']['logfile'][0m
[30;1m39 | [0m[35m            else:[0m
[30;1m40 | [0m[35m                server['logfile'] = os.path.join([0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/plugin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m            # Ensure dynamic server has a file copy protocol[0m
[30;1m29 | [0m[35m            if not 'protocol' in server:[0m
[30;1m30 | [0m[35m                protocol = cfg.get(FILETRANSFER_PROTOCOL_CFG)[0m
[30;1m31 | [0m[35m                if not protocol:[0m
[30;1m32 | [0m[35m                    raise TypeError('Dynamic server %s missing "protocol"'[0m
[30;1m33 | [0m[35m                                    % name)[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/fileserver/plugin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    file_servers = [][0m
[30;1m22 | [0m[35m    # servers may not exist[0m
[30;1m23 | [0m[35m    for name, server in getattr(testbed, 'servers', {}).items():[0m
[30;1m24 | [0m[35m        if server.get('dynamic'):[0m
[30;1m25 | [0m[35m            # Make log dir if it doesn't already exist[0m
[30;1m26 | [0m[35m            os.makedirs(log_dir, exist_ok=True)[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m                                              cache_ip=kwargs.get('cache_ip', True))[0m
[30;1m32 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m33 | [0m[35m                                                   device=kwargs.get('device'), vrf=vrf,[0m
[30;1m34 | [0m[35m                                                   cache_ip=kwargs.get('cache_ip', True))[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        # Build command[0m
[30;1m37 | [0m[35m        parsed_source = self.parse_url(source)[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m                                              vrf=vrf,[0m
[30;1m28 | [0m[35m                                              cache_ip=kwargs.get('cache_ip', True))[0m
[30;1m29 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m30 | [0m[35m                                                   device=kwargs.get('device'), vrf=vrf,[0m
[30;1m31 | [0m[35m                                                   cache_ip=kwargs.get('cache_ip', True))[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        # Build command[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m26 | [0m[35m        source = self.validate_and_update_url(source, device=kwargs.get('device'),[0m
[30;1m27 | [0m[35m                                              vrf=vrf,[0m
[30;1m28 | [0m[35m                                              cache_ip=kwargs.get('cache_ip', True))[0m
[30;1m29 | [0m[35m        destination = self.validate_and_update_url(destination,[0m
[30;1m30 | [0m[35m                                                   device=kwargs.get('device'), vrf=vrf,[0m
[30;1m31 | [0m[35m                                                   cache_ip=kwargs.get('cache_ip', True))[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        ''' Copy a file to/from JunOS device '''[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m26 | [0m[35m        source = self.validate_and_update_url(source, device=kwargs.get('device'),[0m
[30;1m27 | [0m[35m                                              vrf=vrf,[0m
[30;1m28 | [0m[35m                                              cache_ip=kwargs.get('cache_ip', True))[0m
[30;1m29 | [0m[35m        destination = self.validate_and_update_url(destination,[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m141 | [0m[35m        ''' Copy configuration to/from device '''[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m        # Build copy command[0m
[30;1m144 | [0m[35m        cmd = 'show {s} | save {d}'.format(s=source, d=destination)[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m        # Extract the server address to be used later for authentication[0m
[30;1m147 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m        ''' Rename a file '''[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        # Build command[0m
[30;1m114 | [0m[35m        cmd = "file rename {s} {d}".format(s=source, d=destination)[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m        # Configure[0m
[30;1m117 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m        ''' Delete a file '''[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # Build command[0m
[30;1m98 | [0m[35m        cmd = "file delete {}".format(target)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # Configure[0m
[30;1m101 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m48 | [0m[35m        if parsed_source.netloc and '@' in source:[0m
[30;1m49 | [0m[35m            # Remove any password in source[0m
[30;1m50 | [0m[35m            source = source.replace(auth, username, 1)[0m
[30;1m51 | [0m[35m        cmd = 'file copy {s} {d}'.format(s=source, d=destination)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        super().copyfile(source=source, destination=destination,[0m
[30;1m54 | [0m[35m                         timeout_seconds=timeout_seconds, cmd=cmd,[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m304[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/genie/libs/filetransferutils/plugins/junos/fileutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22 | [0m[35m                 **kwargs):[0m
[30;1m23 | [0m[35m        ''' Copy a file to/from JunOS device '''[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m        # update source and destination with the valid address from testbed[0m
[30;1m26 | [0m[35m        source = self.validate_and_update_url(source, device=kwargs.get('device'),[0m
[30;1m27 | [0m[35m                                              vrf=vrf,[0m
[30;1m28 | [0m[35m                                              cache_ip=kwargs.get('cache_ip', True))[0m

304 matches found.
