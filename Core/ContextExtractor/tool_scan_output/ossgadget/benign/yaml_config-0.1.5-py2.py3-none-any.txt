[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    def __deepcopy__(self, memo):[0m
[30;1m171 | [0m[35m        if self.section:[0m
[30;1m172 | [0m[35m            config = self.config.get(self.section, {})[0m
[30;1m173 | [0m[35m        else:[0m
[30;1m174 | [0m[35m            config = self.config[0m
[30;1m175 | [0m[35m        return deepcopy(config, memo)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m        """Provide dict like values method"""[0m
[30;1m158 | [0m[35m        if not section and self.section:[0m
[30;1m159 | [0m[35m            section = self.section[0m
[30;1m160 | [0m[35m        config = self.config.get(section, {}) if section else self.config[0m
[30;1m161 | [0m[35m        return config.values()[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    def __copy__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m        """Provide dict like items method"""[0m
[30;1m151 | [0m[35m        if not section and self.section:[0m
[30;1m152 | [0m[35m            section = self.section[0m
[30;1m153 | [0m[35m        config = self.config.get(section, {}) if section else self.config[0m
[30;1m154 | [0m[35m        return config.items()[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    def values(self, section=None):[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        """Provide dict like keys method"""[0m
[30;1m144 | [0m[35m        if not section and self.section:[0m
[30;1m145 | [0m[35m            section = self.section[0m
[30;1m146 | [0m[35m        config = self.config.get(section, {}) if section else self.config[0m
[30;1m147 | [0m[35m        return config.keys()[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def items(self, section=None):[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m            alphasnake(str(var))[0m
[30;1m124 | [0m[35m        ).upper()[0m
[30;1m125 | [0m[35m        config = self.config.get(section, {}) if section else self.config[0m
[30;1m126 | [0m[35m        result = config.get(var, default)[0m
[30;1m127 | [0m[35m        result = os.getenv(env_var, default=result)[0m
[30;1m128 | [0m[35m        # no default keyword supplied (and no result)[0m
[30;1m129 | [0m[35m        #  use is None to allow empty lists etc[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m            _suffix(alphasnake(section)) if section else '',[0m
[30;1m123 | [0m[35m            alphasnake(str(var))[0m
[30;1m124 | [0m[35m        ).upper()[0m
[30;1m125 | [0m[35m        config = self.config.get(section, {}) if section else self.config[0m
[30;1m126 | [0m[35m        result = config.get(var, default)[0m
[30;1m127 | [0m[35m        result = os.getenv(env_var, default=result)[0m
[30;1m128 | [0m[35m        # no default keyword supplied (and no result)[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        # between a default set to None and no default sets[0m
[30;1m117 | [0m[35m        if not section and self.section:[0m
[30;1m118 | [0m[35m            section = self.section[0m
[30;1m119 | [0m[35m        default = kwargs.get('default', None)[0m
[30;1m120 | [0m[35m        env_var = "{}{}{}".format([0m
[30;1m121 | [0m[35m            _suffix(self.prefix) if self.prefix else '',[0m
[30;1m122 | [0m[35m            _suffix(alphasnake(section)) if section else '',[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m                    if os.path.exists(path):[0m
[30;1m94 | [0m[35m                        with open(path) as conf:[0m
[30;1m95 | [0m[35m                            config = yaml.load(conf, Loader=self.loader)[0m
[30;1m96 | [0m[35m                            prefix = config.get([0m
[30;1m97 | [0m[35m                                self.config_prefix.lower(), None[0m
[30;1m98 | [0m[35m                            )[0m
[30;1m99 | [0m[35m                            if prefix:[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m            # no config file (use environment variables)[0m
[30;1m82 | [0m[35m            pass[0m
[30;1m83 | [0m[35m        if self.config:[0m
[30;1m84 | [0m[35m            self.prefix = self.config.get('config_prefix', None)[0m
[30;1m85 | [0m[35m        if not self.prefix:[0m
[30;1m86 | [0m[35m            if os.getenv(self.config_prefix):[0m
[30;1m87 | [0m[35m                self.prefix = os.getenv(self.config_prefix)[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m        config_file = None[0m
[30;1m208 | [0m[35m        config_dir_env_var = self.env_prefix + '_DIR'[0m
[30;1m209 | [0m[35m        if not filename:[0m
[30;1m210 | [0m[35m            # Check env vars for config[0m
[30;1m211 | [0m[35m            filename = os.getenv(self.env_prefix, default=self.default_file)[0m
[30;1m212 | [0m[35m            # contains path so try directly[0m
[30;1m213 | [0m[35m            if os.path.dirname(filename) and os.path.exists(filename):[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m128 | [0m[35m        # no default keyword supplied (and no result)[0m
[30;1m129 | [0m[35m        #  use is None to allow empty lists etc[0m
[30;1m130 | [0m[35m        if result is None and 'default' not in kwargs:[0m
[30;1m131 | [0m[35m            msg = "Could not find '{}'".format(var)[0m
[30;1m132 | [0m[35m            if section:[0m
[30;1m133 | [0m[35m                msg = "{} in section '{}'.".format([0m
[30;1m134 | [0m[35m                    msg, section[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m            create=True[0m
[30;1m308 | [0m[35m        ):[0m
[30;1m309 | [0m[35m            conf = TESTConfig()[0m
[30;1m310 | [0m[35m        result = conf.get('test2', section='test', default='default')[0m
[30;1m311 | [0m[35m        self.assertEqual('foo', result)[0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m    @mock.patch('yamlconf.config.yaml.load')[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m        self.assertEqual(expected, str(exception))[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m        with self.assertRaises(ConfigError) as conm:[0m
[30;1m289 | [0m[35m            conf.get('FOO !3', section='test')[0m
[30;1m290 | [0m[35m        exception = conm.exception[0m
[30;1m291 | [0m[35m        expected = "Could not find 'FOO !3' in section 'test'. "[0m
[30;1m292 | [0m[35m        expected += "Checked environment variable: TEST_TEST_FOO_3"[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m        conf = TESTConfig()[0m
[30;1m280 | [0m[35m        conf.config_file = None     # in case a local file exists[0m
[30;1m281 | [0m[35m        with self.assertRaises(ConfigError) as conm:[0m
[30;1m282 | [0m[35m            conf.get('foo !3', section='test')[0m
[30;1m283 | [0m[35m        exception = conm.exception[0m
[30;1m284 | [0m[35m        expected = "Could not find 'foo !3' in section 'test'. "[0m
[30;1m285 | [0m[35m        expected += "Checked environment variable: TEST_TEST_FOO_3"[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m    def test_get_env_default(self):[0m
[30;1m271 | [0m[35m        """Test get from default"""[0m
[30;1m272 | [0m[35m        conf = TESTConfig()[0m
[30;1m273 | [0m[35m        result = conf.get('value2', section='test', default='default')[0m
[30;1m274 | [0m[35m        self.assertEqual('default', result)[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m    def test_get_exception(self):[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m        os.environ['TEST_CONFIG_PREFIX'] = 'TEST'[0m
[30;1m265 | [0m[35m        os.environ['TEST_TEST_TEST_VALUE'] = expected[0m
[30;1m266 | [0m[35m        conf = TESTConfig()[0m
[30;1m267 | [0m[35m        result = conf.get('test_value', section='test')[0m
[30;1m268 | [0m[35m        self.assertEqual(expected, result)[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    def test_get_env_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m        os.environ['TEST_CONFIG_PREFIX'] = 'TEST'[0m
[30;1m256 | [0m[35m        os.environ['TEST_TEST_VALUE'] = expected[0m
[30;1m257 | [0m[35m        conf = TESTConfig()[0m
[30;1m258 | [0m[35m        result = conf.get('value', section='test')[0m
[30;1m259 | [0m[35m        self.assertEqual(expected, result)[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    def test_get_env_var_underscore(self):[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m        with self.assertRaises(ConfigError) as conm:[0m
[30;1m289 | [0m[35m            conf.get('FOO !3', section='test')[0m
[30;1m290 | [0m[35m        exception = conm.exception[0m
[30;1m291 | [0m[35m        expected = "Could not find 'FOO !3' in section 'test'. "[0m
[30;1m292 | [0m[35m        expected += "Checked environment variable: TEST_TEST_FOO_3"[0m
[30;1m293 | [0m[35m        self.assertEqual(expected, str(exception))[0m
[30;1m294 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m281 | [0m[35m        with self.assertRaises(ConfigError) as conm:[0m
[30;1m282 | [0m[35m            conf.get('foo !3', section='test')[0m
[30;1m283 | [0m[35m        exception = conm.exception[0m
[30;1m284 | [0m[35m        expected = "Could not find 'foo !3' in section 'test'. "[0m
[30;1m285 | [0m[35m        expected += "Checked environment variable: TEST_TEST_FOO_3"[0m
[30;1m286 | [0m[35m        self.assertEqual(expected, str(exception))[0m
[30;1m287 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m    @mock.patch('yamlconf.config.os.path.exists')[0m
[30;1m189 | [0m[35m    @mock.patch('yamlconf.config.os.path.dirname')[0m
[30;1m190 | [0m[35m    def test_get_filepath_with_gbr_config(self, mock_dirname, mock_exists):[0m
[30;1m191 | [0m[35m        """Test _get_filepath method with TEST_CONFIG env var"""[0m
[30;1m192 | [0m[35m        mock_dirname.side_effect = ['foo/bar/baz', 'foo/bar/', 'foo', '/etc/'][0m
[30;1m193 | [0m[35m        mock_exists.side_effect = [True, False, False][0m
[30;1m194 | [0m[35m        gbr_config = '/etc/gbr.yaml'[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m            result = conf._get_filepath()[0m
[30;1m146 | [0m[35m            self.assertEqual(expected, result)[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m            # TEST_CONFIG_PATH env var set, with filename, found in basepath[0m
[30;1m149 | [0m[35m            mock_exists.side_effect = [True, False][0m
[30;1m150 | [0m[35m            expected = os.path.join(gbr_config_path, 'test.yaml')[0m
[30;1m151 | [0m[35m            result = conf._get_filepath(filename='test.yaml')[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m            result = conf._get_filepath(filename='test.yaml')[0m
[30;1m140 | [0m[35m            self.assertEqual(expected, result)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m            # TEST_CONFIG_PATH env var set, no filename, found in basepath[0m
[30;1m143 | [0m[35m            mock_exists.side_effect = [True, False][0m
[30;1m144 | [0m[35m            expected = os.path.join(gbr_config_path, 'config.yaml')[0m
[30;1m145 | [0m[35m            result = conf._get_filepath()[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m            result = conf._get_filepath()[0m
[30;1m133 | [0m[35m            self.assertEqual(expected, result)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m            # TEST_CONFIG_PATH env var set, with filename, not found in[0m
[30;1m136 | [0m[35m            # basepath[0m
[30;1m137 | [0m[35m            mock_exists.side_effect = [False, True][0m
[30;1m138 | [0m[35m            expected = os.path.join(TEST_CONFIG_ROOT, 'test.yaml')[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m        os.environ['TEST_CONFIG_PATH'] = gbr_config_path[0m
[30;1m127 | [0m[35m        conf = TESTConfig()[0m
[30;1m128 | [0m[35m        with mock.patch('yamlconf.config.os.path.exists') as mock_exists:[0m
[30;1m129 | [0m[35m            # TEST_CONFIG_PATH env var set, no filename, not found in basepath[0m
[30;1m130 | [0m[35m            mock_exists.side_effect = [False, True][0m
[30;1m131 | [0m[35m            expected = os.path.join(TEST_CONFIG_ROOT, 'config.yaml')[0m
[30;1m132 | [0m[35m            result = conf._get_filepath()[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m            self.assertEqual(expected, result)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def test_get_filepath_with_config_path(self):[0m
[30;1m124 | [0m[35m        """Test _get_filepath method with TEST_CONFIG_PATH env var set."""[0m
[30;1m125 | [0m[35m        gbr_config_path = '/var/lib/gbr/'[0m
[30;1m126 | [0m[35m        os.environ['TEST_CONFIG_PATH'] = gbr_config_path[0m
[30;1m127 | [0m[35m        conf = TESTConfig()[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m            result = conf._get_filepath()[0m
[30;1m115 | [0m[35m            self.assertEqual(expected, result)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m            # TEST_CONFIG_ROOT env var set, with filename, found in basepath[0m
[30;1m118 | [0m[35m            mock_exists.side_effect = [True, False][0m
[30;1m119 | [0m[35m            expected = os.path.join(conf.basepath, 'test.yaml')[0m
[30;1m120 | [0m[35m            result = conf._get_filepath(filename='test.yaml')[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m            result = conf._get_filepath(filename='test.yaml')[0m
[30;1m109 | [0m[35m            self.assertEqual(expected, result)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m            # TEST_CONFIG_ROOT env var set, no filename, found in basepath[0m
[30;1m112 | [0m[35m            mock_exists.side_effect = [True, False][0m
[30;1m113 | [0m[35m            expected = os.path.join(conf.basepath, 'config.yaml')[0m
[30;1m114 | [0m[35m            result = conf._get_filepath()[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m            result = conf._get_filepath()[0m
[30;1m102 | [0m[35m            self.assertEqual(expected, result)[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m            # TEST_CONFIG_ROOT env var set, with filename, not found in[0m
[30;1m105 | [0m[35m            # basepath[0m
[30;1m106 | [0m[35m            mock_exists.side_effect = [False, True][0m
[30;1m107 | [0m[35m            expected = os.path.join(gbr_config_root, 'test.yaml')[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m        os.environ['TEST_CONFIG_ROOT'] = gbr_config_root[0m
[30;1m96 | [0m[35m        conf = TESTConfig()[0m
[30;1m97 | [0m[35m        with mock.patch('yamlconf.config.os.path.exists') as mock_exists:[0m
[30;1m98 | [0m[35m            # TEST_CONFIG_ROOT env var set, no filename, not found in basepath[0m
[30;1m99 | [0m[35m            mock_exists.side_effect = [False, True][0m
[30;1m100 | [0m[35m            expected = os.path.join(gbr_config_root, 'config.yaml')[0m
[30;1m101 | [0m[35m            result = conf._get_filepath()[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m30[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/yamlconf/tests/test_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m            self.assertEqual(expected, result)[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    def test_get_filepath_with_config_root(self):[0m
[30;1m93 | [0m[35m        """Test _get_filepath method with TEST_CONFIG_ROOT env var set."""[0m
[30;1m94 | [0m[35m        gbr_config_root = '/var/lib/gbr/'[0m
[30;1m95 | [0m[35m        os.environ['TEST_CONFIG_ROOT'] = gbr_config_root[0m
[30;1m96 | [0m[35m        conf = TESTConfig()[0m

30 matches found.
