[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35mWhen you run the `data-sources` command, redash-migrate creates "stub" data sources at your[0m
[30;1m117 | [0m[35mdestination instance. Stub data sources mirror the name, type, any other non-secret fields[0m
[30;1m118 | [0m[35mfrom your origin. But the secret fields _will be blank on the destination instance_. This[0m
[30;1m119 | [0m[35mincludes passwords, key files, and auth tokens. In all likelihood, you will not be able to[0m
[30;1m120 | [0m[35mrun queries on your destination instance until you fill in any missing secret fields with[0m
[30;1m121 | [0m[35mthe UI.[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m                        users logging-in to the destination instance for the first time will need[0m
[30;1m78 | [0m[35m                        to click the "I forgot my password" link to receive an email. If true,[0m
[30;1m79 | [0m[35m                        invite links will be written to meta.json. These links can be used to set a[0m
[30;1m80 | [0m[35m                        new password directly without using the forgotten password workflow. The[0m
[30;1m81 | [0m[35m                        default value is true.[0m
[30;1m82 | [0m[35m```[0m
[30;1m83 | [0m[35m### READING THE METAFILE[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m                        users logging-in to the destination instance for the first time will need[0m
[30;1m78 | [0m[35m                        to click the "I forgot my password" link to receive an email. If true,[0m
[30;1m79 | [0m[35m                        invite links will be written to meta.json. These links can be used to set a[0m
[30;1m80 | [0m[35m                        new password directly without using the forgotten password workflow. The[0m
[30;1m81 | [0m[35m                        default value is true.[0m
[30;1m82 | [0m[35m```[0m
[30;1m83 | [0m[35m### READING THE METAFILE[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m                        http://localhost[0m
[30;1m76 | [0m[35mpreserve_invite_links   Whether or not to write user invitation links into meta.json. If false,[0m
[30;1m77 | [0m[35m                        users logging-in to the destination instance for the first time will need[0m
[30;1m78 | [0m[35m                        to click the "I forgot my password" link to receive an email. If true,[0m
[30;1m79 | [0m[35m                        invite links will be written to meta.json. These links can be used to set a[0m
[30;1m80 | [0m[35m                        new password directly without using the forgotten password workflow. The[0m
[30;1m81 | [0m[35m                        default value is true.[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/find_table_names.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    queries = [[0m
[30;1m23 | [0m[35m        query[0m
[30;1m24 | [0m[35m        for query in client.paginate(client.queries)[0m
[30;1m25 | [0m[35m        if query.get("data_source_id", None) == int(data_source_id)[0m
[30;1m26 | [0m[35m    ][0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    tables_by_qry = {[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/find_table_names.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m        token.get("name")[0m
[30;1m17 | [0m[35m        for token in client._get(f"api/data_sources/{data_source_id}/schema")[0m
[30;1m18 | [0m[35m        .json()[0m
[30;1m19 | [0m[35m        .get("schema", [])[0m
[30;1m20 | [0m[35m    ][0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    queries = [[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/find_table_names.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m    client = Redash(url, key)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    schema_tables = [[0m
[30;1m16 | [0m[35m        token.get("name")[0m
[30;1m17 | [0m[35m        for token in client._get(f"api/data_sources/{data_source_id}/schema")[0m
[30;1m18 | [0m[35m        .json()[0m
[30;1m19 | [0m[35m        .get("schema", [])[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/find_table_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m    split_matches = [i.split(",") for i in regex_matches][0m
[30;1m65 | [0m[35m    flattened_split_matches = [i for i in itertools.chain(*split_matches)][0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    # For test_8 and test_9: expand aliased comma-delimitted matches[0m
[30;1m68 | [0m[35m    #   1. Find all text between FROM->WHERE and FROM->JOIN keywords[0m
[30;1m69 | [0m[35m    #   2. Replace any commas with `FROM` keywords[0m
[30;1m70 | [0m[35m    #   3. Apply the same PATTERN match used above which ignores aliases[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/find_table_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    regex_matches = [match for match in re.findall(PATTERN, fmt_sql)][0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    # For test_6: expand any comma-delimitted matches[0m
[30;1m64 | [0m[35m    split_matches = [i.split(",") for i in regex_matches][0m
[30;1m65 | [0m[35m    flattened_split_matches = [i for i in itertools.chain(*split_matches)][0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/find_table_names.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m    flattened_split_matches = [i for i in itertools.chain(*split_matches)][0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    # For test_8 and test_9: expand aliased comma-delimitted matches[0m
[30;1m68 | [0m[35m    #   1. Find all text between FROM->WHERE and FROM->JOIN keywords[0m
[30;1m69 | [0m[35m    #   2. Replace any commas with `FROM` keywords[0m
[30;1m70 | [0m[35m    #   3. Apply the same PATTERN match used above which ignores aliases[0m
[30;1m71 | [0m[35m    after_from_before_keyword = [[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/find_table_names.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m    split_matches = [i.split(",") for i in regex_matches][0m
[30;1m65 | [0m[35m    flattened_split_matches = [i for i in itertools.chain(*split_matches)][0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    # For test_8 and test_9: expand aliased comma-delimitted matches[0m
[30;1m68 | [0m[35m    #   1. Find all text between FROM->WHERE and FROM->JOIN keywords[0m
[30;1m69 | [0m[35m    #   2. Replace any commas with `FROM` keywords[0m
[30;1m70 | [0m[35m    #   3. Apply the same PATTERN match used above which ignores aliases[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/find_table_names.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    regex_matches = [match for match in re.findall(PATTERN, fmt_sql)][0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    # For test_6: expand any comma-delimitted matches[0m
[30;1m64 | [0m[35m    split_matches = [i.split(",") for i in regex_matches][0m
[30;1m65 | [0m[35m    flattened_split_matches = [i for i in itertools.chain(*split_matches)][0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_dashboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35mdef is_dynamic_param(dates, param):[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    return "date" in param.get("type") and param.get("value") in dates._fields[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mdef is_date_range(value):[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_dashboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35mdef is_dynamic_param(dates, param):[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    return "date" in param.get("type") and param.get("value") in dates._fields[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mdef is_date_range(value):[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_dashboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    if not is_dynamic_param(dates, p):[0m
[30;1m51 | [0m[35m        return p.get("value")[0m
[30;1m52 | [0m[35m    dyn_val = getattr(dates, p.get("value"))[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    if is_date_range(dyn_val):[0m
[30;1m55 | [0m[35m        return format_date_range(dyn_val)[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_dashboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m	"""[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    if not is_dynamic_param(dates, p):[0m
[30;1m51 | [0m[35m        return p.get("value")[0m
[30;1m52 | [0m[35m    dyn_val = getattr(dates, p.get("value"))[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    if is_date_range(dyn_val):[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_dashboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        params = {[0m
[30;1m15 | [0m[35m            p.get("name"): fill_dynamic_val(todays_dates, p)[0m
[30;1m16 | [0m[35m            for p in qry["options"].get("parameters", [])[0m
[30;1m17 | [0m[35m        }[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m        # Pass max_age to ensure a new result is provided.[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_dashboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m    for idx, qry in queries_dict.items():[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m        params = {[0m
[30;1m15 | [0m[35m            p.get("name"): fill_dynamic_val(todays_dates, p)[0m
[30;1m16 | [0m[35m            for p in qry["options"].get("parameters", [])[0m
[30;1m17 | [0m[35m        }[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_dashboard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35mdef get_queries_on_dashboard(client, slug):[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    # Get a list of queries on this dashboard[0m
[30;1m30 | [0m[35m    dash = client.dashboard(slug=slug)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    # Dashboards have visualization and text box widgets. Get the viz widgets.[0m
[30;1m33 | [0m[35m    viz_widgets = [i for i in dash["widgets"] if "visualization" in i.keys()][0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_query.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m    result_id = poll_job(s, redash_url, response.json()['job'])[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    if result_id:[0m
[30;1m35 | [0m[35m        response = s.get('{}/api/queries/{}/results/{}.json'.format(redash_url, query_id, result_id)[0m
[30;1m36 | [0m[35m        if response.status_code != 200:[0m
[30;1m37 | [0m[35m            raise Exception('Failed getting results.')[0m
[30;1m38 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_query.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    payload = dict(max_age=0, parameters=params)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    response = s.post('{}/api/queries/{}/results'.format(redash_url, query_id), data=json.dumps(payl[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    if response.status_code != 200:[0m
[30;1m30 | [0m[35m        raise Exception('Refresh failed.')[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_query.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35mdef poll_job(s, redash_url, job):[0m
[30;1m9 | [0m[35m    # TODO: add timeout[0m
[30;1m10 | [0m[35m    while job['status'] not in (3,4):[0m
[30;1m11 | [0m[35m        response = s.get('{}/api/jobs/{}'.format(redash_url, job['id']))[0m
[30;1m12 | [0m[35m        job = response.json()['job'][0m
[30;1m13 | [0m[35m        time.sleep(1)[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_query.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mdef poll_job(s, redash_url, job):[0m
[30;1m9 | [0m[35m    # TODO: add timeout[0m
[30;1m10 | [0m[35m    while job['status'] not in (3,4):[0m
[30;1m11 | [0m[35m        response = s.get('{}/api/jobs/{}'.format(redash_url, job['id']))[0m
[30;1m12 | [0m[35m        job = response.json()['job'][0m
[30;1m13 | [0m[35m        time.sleep(1)[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/refresh_query.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport requests[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom pprint import pprint[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m14 | [0m[35mpip install --upgrade redash-toolbelt[0m
[30;1m15 | [0m[35m```[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mThis command will update `redash-toolbelt` if you have already installed it.[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[virtual environment]: https://pythonbasics.org/virtualenv/[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m                            the search term you provide[0m
[30;1m32 | [0m[35mfind-tables                 Search the text of queries against a data source[0m
[30;1m33 | [0m[35m                            to see which table names are used in queries of[0m
[30;1m34 | [0m[35m                            that source. This script relies on regex that is[0m
[30;1m35 | [0m[35m                            tested against ANSI SQL.[0m
[30;1m36 | [0m[35mclone-dashboard-and-queries Completely duplicate a dashboard by copying all [0m
[30;1m37 | [0m[35m                            its queries and visualizations.[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m```text[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mgdpr-scrub                  Search for a string term in  your Redash queries[0m
[30;1m29 | [0m[35m                            and query results. The script returns a list of[0m
[30;1m30 | [0m[35m                            URLs in your instance that contain references to[0m
[30;1m31 | [0m[35m                            the search term you provide[0m
[30;1m32 | [0m[35mfind-tables                 Search the text of queries against a data source[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mTo install it you will need Python 3.6 or above. We recommend that you use a [virtual environment].[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m```bash[0m
[30;1m14 | [0m[35mpip install --upgrade redash-toolbelt[0m
[30;1m15 | [0m[35m```[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mThis command will update `redash-toolbelt` if you have already installed it.[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    def _request(self, method, path, **kwargs):[0m
[30;1m212 | [0m[35m        url = "{}/{}".format(self.redash_url, path)[0m
[30;1m213 | [0m[35m        response = self.session.request(method, url, **kwargs)[0m
[30;1m214 | [0m[35m        response.raise_for_status()[0m
[30;1m215 | [0m[35m        return response[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m        new_query["name"] = new_name[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        return self.update_query(new_query.get("id"), new_query).json()[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    def scheduled_queries(self):[0m
[30;1m143 | [0m[35m        """Loads all queries and returns only the scheduled ones."""[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1399 | [0m[35m        print(f"{command} is not a valid command. See --help for instructions")[0m
[30;1m1400 | [0m[35m        return[0m
[30;1m1401 | [0m[35m[0m
[30;1m1402 | [0m[35m    wrapped = save_meta_wrapper(command_map.get(command))[0m
[30;1m1403 | [0m[35m[0m
[30;1m1404 | [0m[35m    if wrapped is None:[0m
[30;1m1405 | [0m[35m        print("No command provided. See --help for instructions")[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1394 | [0m[35m        "disable-users": disable_users,[0m
[30;1m1395 | [0m[35m    }[0m
[30;1m1396 | [0m[35m[0m
[30;1m1397 | [0m[35m    _command = command_map.get(command)[0m
[30;1m1398 | [0m[35m    if _command is None:[0m
[30;1m1399 | [0m[35m        print(f"{command} is not a valid command. See --help for instructions")[0m
[30;1m1400 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1049 | [0m[35m[0m
[30;1m1050 | [0m[35mdef get_from_dictlist_by_key(l, key, value):[0m
[30;1m1051 | [0m[35m[0m
[30;1m1052 | [0m[35m    return [i for i in l if i.get(key) == value][0][0m
[30;1m1053 | [0m[35m[0m
[30;1m1054 | [0m[35m[0m
[30;1m1055 | [0m[35mdef progress_bar(it, prefix="", size=60):[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1010 | [0m[35m[0m
[30;1m1011 | [0m[35m    The destination client must be an admin to have access to the user API key.[0m
[30;1m1012 | [0m[35m    """[0m
[30;1m1013 | [0m[35m    user = meta["users"].get(origin_user_id)[0m
[30;1m1014 | [0m[35m[0m
[30;1m1015 | [0m[35m    if user is None:[0m
[30;1m1016 | [0m[35m        raise UserNotFoundException([0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m915 | [0m[35m        d_counter = 0[0m
[30;1m916 | [0m[35m        for d in favorite_dashboards:[0m
[30;1m917 | [0m[35m            try:[0m
[30;1m918 | [0m[35m                dest_target_slug = meta["dashboards"].get(d["slug"])[0m
[30;1m919 | [0m[35m                if dest_target_slug is None:[0m
[30;1m920 | [0m[35m                    continue[0m
[30;1m921 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m900 | [0m[35m        q_counter = 0[0m
[30;1m901 | [0m[35m        for q in favorite_queries:[0m
[30;1m902 | [0m[35m            try:[0m
[30;1m903 | [0m[35m                dest_target_id = meta["queries"].get(q["id"])[0m
[30;1m904 | [0m[35m                if dest_target_id is None:[0m
[30;1m905 | [0m[35m                    continue[0m
[30;1m906 | [0m[35m                dest_user_client.create_favorite(_type="query", id=dest_target_id)[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m863 | [0m[35m                # This points to an alert destination that exits[0m
[30;1m864 | [0m[35m                sub_args = {[0m
[30;1m865 | [0m[35m                    **subscriptions_base_kwargs,[0m
[30;1m866 | [0m[35m                    "destination_id": meta["destinations"].get([0m
[30;1m867 | [0m[35m                        sub["destination"]["id"][0m
[30;1m868 | [0m[35m                    ),[0m
[30;1m869 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m845 | [0m[35m        meta["alerts"][this_alert.get("id")] = dest_id[0m
[30;1m846 | [0m[35m[0m
[30;1m847 | [0m[35m        if this_alert.get("rearm"):[0m
[30;1m848 | [0m[35m            dest_client.update_alert(id=dest_id, rearm=this_alert.get("rearm"))[0m
[30;1m849 | [0m[35m            print(f'Alert {this_alert["id"]} - OK - Fixed rearm')[0m
[30;1m850 | [0m[35m[0m
[30;1m851 | [0m[35m        # A post to the subscriptions handler endpoint automatically subscribes the current user[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m844 | [0m[35m[0m
[30;1m845 | [0m[35m        meta["alerts"][this_alert.get("id")] = dest_id[0m
[30;1m846 | [0m[35m[0m
[30;1m847 | [0m[35m        if this_alert.get("rearm"):[0m
[30;1m848 | [0m[35m            dest_client.update_alert(id=dest_id, rearm=this_alert.get("rearm"))[0m
[30;1m849 | [0m[35m            print(f'Alert {this_alert["id"]} - OK - Fixed rearm')[0m
[30;1m850 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m842 | [0m[35m        except Exception as e:[0m
[30;1m843 | [0m[35m            print(f'Alert {this_alert["id"]} - ERROR - {e}')[0m
[30;1m844 | [0m[35m[0m
[30;1m845 | [0m[35m        meta["alerts"][this_alert.get("id")] = dest_id[0m
[30;1m846 | [0m[35m[0m
[30;1m847 | [0m[35m        if this_alert.get("rearm"):[0m
[30;1m848 | [0m[35m            dest_client.update_alert(id=dest_id, rearm=this_alert.get("rearm"))[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m832 | [0m[35m        data = {[0m
[30;1m833 | [0m[35m            "name": this_alert.get("name"),[0m
[30;1m834 | [0m[35m            "query_id": target_query_id,[0m
[30;1m835 | [0m[35m            "options": this_alert.get("options"),[0m
[30;1m836 | [0m[35m        }[0m
[30;1m837 | [0m[35m[0m
[30;1m838 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m830 | [0m[35m            continue[0m
[30;1m831 | [0m[35m[0m
[30;1m832 | [0m[35m        data = {[0m
[30;1m833 | [0m[35m            "name": this_alert.get("name"),[0m
[30;1m834 | [0m[35m            "query_id": target_query_id,[0m
[30;1m835 | [0m[35m            "options": this_alert.get("options"),[0m
[30;1m836 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m821 | [0m[35m        orig_target_query_id = this_alert.get("query", {}).get("id")[0m
[30;1m822 | [0m[35m[0m
[30;1m823 | [0m[35m        # Check the target query is already present[0m
[30;1m824 | [0m[35m        target_query_id = meta["queries"].get(orig_target_query_id)[0m
[30;1m825 | [0m[35m[0m
[30;1m826 | [0m[35m        if target_query_id is None:[0m
[30;1m827 | [0m[35m            print([0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m        this_alert = orig_client.get_alert(a.get("id"))[0m
[30;1m820 | [0m[35m[0m
[30;1m821 | [0m[35m        orig_target_query_id = this_alert.get("query", {}).get("id")[0m
[30;1m822 | [0m[35m[0m
[30;1m823 | [0m[35m        # Check the target query is already present[0m
[30;1m824 | [0m[35m        target_query_id = meta["queries"].get(orig_target_query_id)[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m        this_alert = orig_client.get_alert(a.get("id"))[0m
[30;1m820 | [0m[35m[0m
[30;1m821 | [0m[35m        orig_target_query_id = this_alert.get("query", {}).get("id")[0m
[30;1m822 | [0m[35m[0m
[30;1m823 | [0m[35m        # Check the target query is already present[0m
[30;1m824 | [0m[35m        target_query_id = meta["queries"].get(orig_target_query_id)[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m816 | [0m[35m            print(f"Alert {orig_id} - SKIP - Already imported with new id {dest_id}")[0m
[30;1m817 | [0m[35m            continue[0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m        this_alert = orig_client.get_alert(a.get("id"))[0m
[30;1m820 | [0m[35m[0m
[30;1m821 | [0m[35m        orig_target_query_id = this_alert.get("query", {}).get("id")[0m
[30;1m822 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m811 | [0m[35m[0m
[30;1m812 | [0m[35m        orig_id = a.get("id")[0m
[30;1m813 | [0m[35m[0m
[30;1m814 | [0m[35m        dest_id = meta["alerts"].get(orig_id)[0m
[30;1m815 | [0m[35m        if dest_id:[0m
[30;1m816 | [0m[35m            print(f"Alert {orig_id} - SKIP - Already imported with new id {dest_id}")[0m
[30;1m817 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m809 | [0m[35m    alerts = sorted(alerts, key=lambda x: x.get("created_at", 0))[0m
[30;1m810 | [0m[35m    for a in alerts:[0m
[30;1m811 | [0m[35m[0m
[30;1m812 | [0m[35m        orig_id = a.get("id")[0m
[30;1m813 | [0m[35m[0m
[30;1m814 | [0m[35m        dest_id = meta["alerts"].get(orig_id)[0m
[30;1m815 | [0m[35m        if dest_id:[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m806 | [0m[35mdef import_alerts(orig_client, dest_client):[0m
[30;1m807 | [0m[35m[0m
[30;1m808 | [0m[35m    alerts = orig_client.alerts()[0m
[30;1m809 | [0m[35m    alerts = sorted(alerts, key=lambda x: x.get("created_at", 0))[0m
[30;1m810 | [0m[35m    for a in alerts:[0m
[30;1m811 | [0m[35m[0m
[30;1m812 | [0m[35m        orig_id = a.get("id")[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m784 | [0m[35m            }[0m
[30;1m785 | [0m[35m[0m
[30;1m786 | [0m[35m            if "visualization" in widget:[0m
[30;1m787 | [0m[35m                data["visualization_id"] = meta["visualizations"].get([0m
[30;1m788 | [0m[35m                    str(widget["visualization"]["id"])[0m
[30;1m789 | [0m[35m                )[0m
[30;1m790 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m740 | [0m[35m    print("Importing dashboards...")[0m
[30;1m741 | [0m[35m[0m
[30;1m742 | [0m[35m    dashboards = orig_client.paginate(orig_client.dashboards)[0m
[30;1m743 | [0m[35m    dashboards = sorted(dashboards, key=lambda x: x.get("created_at", 0))[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m    for dashboard in dashboards:[0m
[30;1m746 | [0m[35m        if dashboard["slug"] in meta["dashboards"]:[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m657 | [0m[35m[0m
[30;1m658 | [0m[35m    for query_id, new_query_id in meta["queries"].items():[0m
[30;1m659 | [0m[35m[0m
[30;1m660 | [0m[35m        if meta["flags"]["viz_import_complete"].get(query_id):[0m
[30;1m661 | [0m[35m            print([0m
[30;1m662 | [0m[35m                "Query {} - SKIP - All visualisations already imported".format(query_id)[0m
[30;1m663 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m640 | [0m[35m        options = query["options"][0m
[30;1m641 | [0m[35m        for p in options.get("parameters", []):[0m
[30;1m642 | [0m[35m            if "queryId" in p:[0m
[30;1m643 | [0m[35m                p["queryId"] = meta["queries"].get(str(p["queryId"]))[0m
[30;1m644 | [0m[35m[0m
[30;1m645 | [0m[35m        user_api_key = user_with_api_key([0m
[30;1m646 | [0m[35m            orig_user_id,[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m638 | [0m[35m        print("   Fixing: {}".format(query_id))[0m
[30;1m639 | [0m[35m[0m
[30;1m640 | [0m[35m        options = query["options"][0m
[30;1m641 | [0m[35m        for p in options.get("parameters", []):[0m
[30;1m642 | [0m[35m            if "queryId" in p:[0m
[30;1m643 | [0m[35m                p["queryId"] = meta["queries"].get(str(p["queryId"]))[0m
[30;1m644 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m        query = orig_client.get_query(query_id)[0m
[30;1m634 | [0m[35m        orig_user_id = query["user"]["id"][0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m        dest_user_id = meta["users"].get(orig_user_id).get("id")[0m
[30;1m637 | [0m[35m[0m
[30;1m638 | [0m[35m        print("   Fixing: {}".format(query_id))[0m
[30;1m639 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m        query = orig_client.get_query(query_id)[0m
[30;1m634 | [0m[35m        orig_user_id = query["user"]["id"][0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m        dest_user_id = meta["users"].get(orig_user_id).get("id")[0m
[30;1m637 | [0m[35m[0m
[30;1m638 | [0m[35m        print("   Fixing: {}".format(query_id))[0m
[30;1m639 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m621 | [0m[35m    """[0m
[30;1m622 | [0m[35m    print("Updating queries options...")[0m
[30;1m623 | [0m[35m[0m
[30;1m624 | [0m[35m    if not meta["flags"].get("fixed_queries"):[0m
[30;1m625 | [0m[35m        meta["flags"]["fixed_queries"] = [][0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m    for query_id, new_query_id in meta["queries"].items():[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m605 | [0m[35m        options = query["options"][0m
[30;1m606 | [0m[35m        for p in options.get("parameters", []):[0m
[30;1m607 | [0m[35m            if "queryId" in p:[0m
[30;1m608 | [0m[35m                p["queryId"] = meta["queries"].get(p["queryId"])[0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35m        query["options"] = options[0m
[30;1m611 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35m[0m
[30;1m604 | [0m[35m        # fix query reference[0m
[30;1m605 | [0m[35m        options = query["options"][0m
[30;1m606 | [0m[35m        for p in options.get("parameters", []):[0m
[30;1m607 | [0m[35m            if "queryId" in p:[0m
[30;1m608 | [0m[35m                p["queryId"] = meta["queries"].get(p["queryId"])[0m
[30;1m609 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m        def import_query_subroutine(query):[0m
[30;1m543 | [0m[35m            origin_id = query["id"][0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35m            data_source_id = DATA_SOURCES.get(query["data_source_id"])[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m            if origin_id in meta["queries"] or str(origin_id) in meta["queries"]:[0m
[30;1m548 | [0m[35m                print("Query {} - SKIP - was already imported".format(origin_id))[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m        options = query["options"][0m
[30;1m531 | [0m[35m        already_delayed = False[0m
[30;1m532 | [0m[35m        for p in options.get("parameters", []):[0m
[30;1m533 | [0m[35m            if not already_delayed and "queryId" in p:[0m
[30;1m534 | [0m[35m                queries_that_depend_on_queries.append(query)[0m
[30;1m535 | [0m[35m                already_delayed = True[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m523 | [0m[35m    print("Import queries...")[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m    queries = orig_client.paginate(orig_client.queries)[0m
[30;1m526 | [0m[35m    queries = sorted(queries, key=lambda x: x.get("created_at", 0))[0m
[30;1m527 | [0m[35m[0m
[30;1m528 | [0m[35m    for query in queries:[0m
[30;1m529 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m481 | [0m[35m                except:[0m
[30;1m482 | [0m[35m                    continue[0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m                dest_id = meta["queries"].get(_origin_id)[0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m                if dest_id is None:[0m
[30;1m487 | [0m[35m                    print([0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m    count_disabled = 0[0m
[30;1m419 | [0m[35m    for orig_id, dest_user in meta["users"].items():[0m
[30;1m420 | [0m[35m        if dest_user.get("disabled") is True:[0m
[30;1m421 | [0m[35m            print([0m
[30;1m422 | [0m[35m                f'Origin user {orig_id} is disabled at origin. Disabling {dest_user["id"]} at destin[0m
[30;1m423 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m370 | [0m[35m    # Users are missing from dest and meta (default case)[0m
[30;1m371 | [0m[35m    # Add these users to the dest instance and add them to meta.json[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    orig_users = sorted(orig_users, key=lambda x: x.get("created_at", 0))[0m
[30;1m374 | [0m[35m    for user in orig_users:[0m
[30;1m375 | [0m[35m        print("   importing: {}".format(user["id"]))[0m
[30;1m376 | [0m[35m        data = {"name": user["name"], "email": user["email"]}[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m            )[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m            # Post to GroupDataSourceResource[0m
[30;1m325 | [0m[35m            view_only = d.get("view_only", False)[0m
[30;1m326 | [0m[35m            resp = dest_client._post([0m
[30;1m327 | [0m[35m                f"api/groups/{dest_id}/data_sources/{dest_ds_id}",[0m
[30;1m328 | [0m[35m                json={"view_only": view_only},[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        for d in data_sources:[0m
[30;1m306 | [0m[35m            ds_id = d["id"][0m
[30;1m307 | [0m[35m            dest_ds_id = meta["data_sources"].get(ds_id)[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m            if dest_ds_id is None:[0m
[30;1m310 | [0m[35m                print([0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m            # Allows for an origin group to have no members but still get the[0m
[30;1m273 | [0m[35m            # proper data sources associated with it correctly migrated[0m
[30;1m274 | [0m[35m            for m in members:[0m
[30;1m275 | [0m[35m                dest_member_id = meta["users"].get(m["id"]).get("id")[0m
[30;1m276 | [0m[35m                if dest_member_id is None:[0m
[30;1m277 | [0m[35m                    print([0m
[30;1m278 | [0m[35m                        f"Origin group {id} -- ERROR -- Origin group member {m['id']} not present in[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m            # Allows for an origin group to have no members but still get the[0m
[30;1m273 | [0m[35m            # proper data sources associated with it correctly migrated[0m
[30;1m274 | [0m[35m            for m in members:[0m
[30;1m275 | [0m[35m                dest_member_id = meta["users"].get(m["id"]).get("id")[0m
[30;1m276 | [0m[35m                if dest_member_id is None:[0m
[30;1m277 | [0m[35m                    print([0m
[30;1m278 | [0m[35m                        f"Origin group {id} -- ERROR -- Origin group member {m['id']} not present in[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m        # Check if current origin group belongs to the default ones[0m
[30;1m219 | [0m[35m        # If so, skip posting to GroupListResource and restore it to a blank slate[0m
[30;1m220 | [0m[35m        elif type_ == "builtin":[0m
[30;1m221 | [0m[35m            dest_id = BUILTINS.get(name)[0m
[30;1m222 | [0m[35m            print(f"Origin group {id} -- MERGING -- Belongs to builtins group")[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m            initial_sources = dest_client._get([0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    for ds in orig_data_sources:[0m
[30;1m63 | [0m[35m        dest_id = DATA_SOURCES.get(ds["id"])[0m
[30;1m64 | [0m[35m        this_ds = dest_ds_map.get(dest_id)[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        if dest_id is not None:[0m
[30;1m67 | [0m[35m            if this_ds is None:[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m    dest_ds_map = {i["id"]: i for i in dest_data_sources}[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    for ds in orig_data_sources:[0m
[30;1m63 | [0m[35m        dest_id = DATA_SOURCES.get(ds["id"])[0m
[30;1m64 | [0m[35m        this_ds = dest_ds_map.get(dest_id)[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        if dest_id is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35mdef check_data_sources(orig_client, dest_client):[0m
[30;1m28 | [0m[35m    """Checks for obvious issues with the data source map that can cause issues further on"""[0m
[30;1m29 | [0m[35m    if len(DATA_SOURCES) == 0 or ([0m
[30;1m30 | [0m[35m        len(DATA_SOURCES) == 1 and DATA_SOURCES.get(-1) == -1234[0m
[30;1m31 | [0m[35m    ):[0m
[30;1m32 | [0m[35m        print("\n\nYou have not set up the data source map in meta.json")[0m
[30;1m33 | [0m[35m        print("\n\nCheck complete: ERROR")[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1347 | [0m[35m[0m
[30;1m1348 | [0m[35m      \b[0m
[30;1m1349 | [0m[35m      fix-qrds-refs         Replace references to origin query id's in query results data source[0m
[30;1m1350 | [0m[35m                            (QRDS) queries with their new id at the destination. Does nothing if[0m
[30;1m1351 | [0m[35m                            the destination has no QRDS sources.[0m
[30;1m1352 | [0m[35m[0m
[30;1m1353 | [0m[35m      \b[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35mdef fix_queries(orig_client, dest_client):[0m
[30;1m618 | [0m[35m    """[0m
[30;1m619 | [0m[35m    This runs after importing all queries, so we can update the query id reference[0m
[30;1m620 | [0m[35m    in parameter definitions.[0m
[30;1m621 | [0m[35m    """[0m
[30;1m622 | [0m[35m    print("Updating queries options...")[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m583 | [0m[35m                response = user_client.create_query(data)[0m
[30;1m584 | [0m[35m            except Exception as e:[0m
[30;1m585 | [0m[35m                print([0m
[30;1m586 | [0m[35m                    "Query {} - FAIL - Query creation at destination failed: {}".format([0m
[30;1m587 | [0m[35m                        origin_id, e[0m
[30;1m588 | [0m[35m                    )[0m
[30;1m589 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m510 | [0m[35m            )[0m
[30;1m511 | [0m[35m        except Exception as e:[0m
[30;1m512 | [0m[35m            print([0m
[30;1m513 | [0m[35m                "Destination Query {} - FAIL - Could not update query text: {}".format([0m
[30;1m514 | [0m[35m                    query_id, e[0m
[30;1m515 | [0m[35m                )[0m
[30;1m516 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m419 | [0m[35m    for orig_id, dest_user in meta["users"].items():[0m
[30;1m420 | [0m[35m        if dest_user.get("disabled") is True:[0m
[30;1m421 | [0m[35m            print([0m
[30;1m422 | [0m[35m                f'Origin user {orig_id} is disabled at origin. Disabling {dest_user["id"]} at destin[0m
[30;1m423 | [0m[35m            )[0m
[30;1m424 | [0m[35m            dest_client.disable_user(dest_user["id"])[0m
[30;1m425 | [0m[35m            count_disabled += 1[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m419 | [0m[35m    for orig_id, dest_user in meta["users"].items():[0m
[30;1m420 | [0m[35m        if dest_user.get("disabled") is True:[0m
[30;1m421 | [0m[35m            print([0m
[30;1m422 | [0m[35m                f'Origin user {orig_id} is disabled at origin. Disabling {dest_user["id"]} at destin[0m
[30;1m423 | [0m[35m            )[0m
[30;1m424 | [0m[35m            dest_client.disable_user(dest_user["id"])[0m
[30;1m425 | [0m[35m            count_disabled += 1[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m259 | [0m[35m            dest_id = resp["id"][0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m            print([0m
[30;1m262 | [0m[35m                f"Origin group {id} -- OK -- Group created at destination with id {dest_id}"[0m
[30;1m263 | [0m[35m            )[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        meta["groups"][id] = dest_id[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35mdef import_destinations(orig_client, dest_client):[0m
[30;1m160 | [0m[35m    """Create stub alert destinations at DESTINATION based on the alert destinations in ORIGIN."""[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m    ALLOWED_TYPES = [[0m
[30;1m163 | [0m[35m        i["type"] for i in dest_client._get("api/destinations/types").json()[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m130 | [0m[35m                textwrap.dedent([0m
[30;1m131 | [0m[35m                    """[0m
[30;1m132 | [0m[35m                INFO: Origin data source type {} is not supported, but queries can be mapped to type[0m
[30;1m133 | [0m[35m                Run {} to update query text for this new query runner.""".format([0m
[30;1m134 | [0m[35m                        origin_type,[0m
[30;1m135 | [0m[35m                        target_type,[0m
[30;1m136 | [0m[35m                        migratable_types[origin_type]["command-name"],[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mdef import_data_sources(orig_client, dest_client):[0m
[30;1m91 | [0m[35m    """Create stub data sources at DESTINATION based on the data sources in ORIGIN."""[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    orig_data_sources = orig_client.get_data_sources()[0m
[30;1m94 | [0m[35m    allowed_types = {[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1160 | [0m[35m    It's important to provide the correct information here to ensure that all objects are copied[0m
[30;1m1161 | [0m[35m    correctly from the ORIGIN instance to the DESTINATION instance.[0m
[30;1m1162 | [0m[35m[0m
[30;1m1163 | [0m[35m    Please note that this script will solicit an email address from you. But NO EMAILS WILL BE SENT.[0m
[30;1m1164 | [0m[35m    """[0m
[30;1m1165 | [0m[35m    )[0m
[30;1m1166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m958 | [0m[35m    ][0m
[30;1m959 | [0m[35m[0m
[30;1m960 | [0m[35m    if not csv_queries:[0m
[30;1m961 | [0m[35m        print("WARNING - Could not find any queries against csv data sources")[0m
[30;1m962 | [0m[35m        return[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m    for query in progress_bar(csv_queries, "Queries"):[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m688 | [0m[35m        dest_query = user_client.get_query(new_query_id)[0m
[30;1m689 | [0m[35m        dest_query_id = dest_query["id"][0m
[30;1m690 | [0m[35m[0m
[30;1m691 | [0m[35m        # Sort this table like orig_table_visualizations.[0m
[30;1m692 | [0m[35m        # The first elements in these lists should mirror[0m
[30;1m693 | [0m[35m        # one another.[0m
[30;1m694 | [0m[35m        dest_table_visualizations = sorted([0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m668 | [0m[35m        query = orig_client.get_query(query_id)[0m
[30;1m669 | [0m[35m        orig_user_id = query["user"]["id"][0m
[30;1m670 | [0m[35m[0m
[30;1m671 | [0m[35m        # Sort both lists to retain visualization order on the query screen[0m
[30;1m672 | [0m[35m        orig_table_visualizations = sorted([0m
[30;1m673 | [0m[35m            [i for i in query["visualizations"] if i["type"] == "TABLE"],[0m
[30;1m674 | [0m[35m            key=lambda x: x["id"],[0m
[30;1m675 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m668 | [0m[35m        query = orig_client.get_query(query_id)[0m
[30;1m669 | [0m[35m        orig_user_id = query["user"]["id"][0m
[30;1m670 | [0m[35m[0m
[30;1m671 | [0m[35m        # Sort both lists to retain visualization order on the query screen[0m
[30;1m672 | [0m[35m        orig_table_visualizations = sorted([0m
[30;1m673 | [0m[35m            [i for i in query["visualizations"] if i["type"] == "TABLE"],[0m
[30;1m674 | [0m[35m            key=lambda x: x["id"],[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/migrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m448 | [0m[35m    ][0m
[30;1m449 | [0m[35m[0m
[30;1m450 | [0m[35m    if not qrds_queries:[0m
[30;1m451 | [0m[35m        print("WARNING - Could not find any queries against QRDS data sources")[0m
[30;1m452 | [0m[35m        return[0m
[30;1m453 | [0m[35m[0m
[30;1m454 | [0m[35m    for query in qrds_queries:[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/setup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m# Build the package with Poetry. This will create a .tar.gz file in the /dist directory[0m
[30;1m253 | [0m[35mpoetry build[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m# Use to pip to install the .tar.gz archive created in the previous step[0m
[30;1m256 | [0m[35mpip install dist/redash_toolbelt-x.x.x.tar.gz[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m# If everything works, please open a PR.[0m
[30;1m259 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m# Build the package with Poetry. This will create a .tar.gz file in the /dist directory[0m
[30;1m253 | [0m[35mpoetry build[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m# Use to pip to install the .tar.gz archive created in the previous step[0m
[30;1m256 | [0m[35mpip install dist/redash_toolbelt-x.x.x.tar.gz[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m# If everything works, please open a PR.[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m# We use Poetry to build redash-toolbelt for distribution on PyPi[0m
[30;1m248 | [0m[35mpip install poetry[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m# Make your changes to the script. When it's time to test your changes.[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m# Build the package with Poetry. This will create a .tar.gz file in the /dist directory[0m
[30;1m253 | [0m[35mpoetry build[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m244 | [0m[35m. ${env_name}/bin/activate # macOS[0m
[30;1m245 | [0m[35m${env_name}\scripts\activate # Windows[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m# We use Poetry to build redash-toolbelt for distribution on PyPi[0m
[30;1m248 | [0m[35mpip install poetry[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m# Make your changes to the script. When it's time to test your changes.[0m
[30;1m251 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35mTo develop modifications to this script you should do the following:[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m```shell[0m
[30;1m237 | [0m[35m# Clone redash-toolbelt to your disk[0m
[30;1m238 | [0m[35mgit clone https://github.com/getredash/redash-toolbelt.git[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m# Create a Python virtual environment using version 3.6+[0m
[30;1m241 | [0m[35mpython3 -m virtualenv ${env_name}[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m## DEVELOPING THIS SCRIPT[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35mTo develop modifications to this script you should do the following:[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m```shell[0m
[30;1m237 | [0m[35m# Clone redash-toolbelt to your disk[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m229 | [0m[35mNo. See [who _shouldn't_ use redash-migrate](#who-shouldnt-use-redash-migrate) above.[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m## DEVELOPING THIS SCRIPT[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35mTo develop modifications to this script you should do the following:[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m```shell[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m### I found a different script online, why should I use redash-migrate instead?[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35mredash-migrate is the officially supported migration tool. We wrote it because the previous[0m
[30;1m220 | [0m[35mmigration script did not  work reliably with newer versions of Redash (since V7). But you can use[0m
[30;1m221 | [0m[35many tool you want. Or fork this one and modify it for your needs.[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m### Can I use redash-migrate on Redash versions older than V10?[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35mNot yet. But we're making one. It will be linked here as soon as it's ready.[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m### I found a different script online, why should I use redash-migrate instead?[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35mredash-migrate is the officially supported migration tool. We wrote it because the previous[0m
[30;1m220 | [0m[35mmigration script did not  work reliably with newer versions of Redash (since V7). But you can use[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35mcommands are shown in the output of the `--help` option.[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35mWith exception of `init` and `check-data-sources`, each command modifies the destination instance.[0m
[30;1m172 | [0m[35m_The origin instance is never modified_. The script only emits GET requests to the origin instance.[0m
[30;1m173 | [0m[35mIt only emits POST requests to the destination instance.[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35mtion_url         The base URL for your destination Redash instance. For example:[0m
[30;1m75 | [0m[35m                        http://localhost[0m
[30;1m76 | [0m[35mpreserve_invite_links   Whether or not to write user invitation links into meta.json. If false,[0m
[30;1m77 | [0m[35m                        users logging-in to the destination instance for the first time will need[0m
[30;1m78 | [0m[35m                        to click the "I forgot my password" link to receive an email. If true,[0m
[30;1m79 | [0m[35m                        invite links will be written to meta.json. These links can be used to set a[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[virtual environment]: https://pythonbasics.org/virtualenv/[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m```bash[0m
[30;1m26 | [0m[35mpip install --upgrade redash-toolbelt[0m
[30;1m27 | [0m[35m```[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mThis command will update `redash-toolbelt` if you have already installed it. See the [PyPi page] for[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m189 | [0m[35mwere not successfully migrated during a previous execution.[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m**Note**: due to the volume of network requests it creates, redash-migrate may trip the rate limit[0m
[30;1m192 | [0m[35mon your destination Redash instance. We recommend you disable rate limiting at the destination [0m
[30;1m193 | [0m[35mfor the duration of your migration. On Redash V10 this can be disabled by setting an environment[0m
[30;1m194 | [0m[35mvariable named `REDASH_RATELIMIT_ENABLED=false`.[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m155 | [0m[35mdisable-users         Disable users in the destination instance that are disabled in the[0m
[30;1m156 | [0m[35m                      origin instance.[0m
[30;1m157 | [0m[35mfix-qrds-refs         Replace references to origin query id's in query results data source[0m
[30;1m158 | [0m[35m                      (QRDS) queries with their new id at the destination. Does nothing if[0m
[30;1m159 | [0m[35m                      the destination has no QRDS sources.[0m
[30;1m160 | [0m[35mfix-csv-queries       Reformat queries against app.redash.io's csvurl data source so they are[0m
[30;1m161 | [0m[35m                      compatible with OSS Redash's csv data source. Do not use this command if[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m### DATA SOURCES[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35mWhen you run the `data-sources` command, redash-migrate creates "stub" data sources at your[0m
[30;1m117 | [0m[35mdestination instance. Stub data sources mirror the name, type, any other non-secret fields[0m
[30;1m118 | [0m[35mfrom your origin. But the secret fields _will be blank on the destination instance_. This[0m
[30;1m119 | [0m[35mincludes passwords, key files, and auth tokens. In all likelihood, you will not be able to[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35myou must manually add them to `meta.json` so that it can associate their id at the[0m
[30;1m110 | [0m[35morigin instance with their id at the destination. [0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35mIf you don't do this, you will potentially create a duplicate user at the destination.[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m### DATA SOURCES[0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mAdditionally, if you created any users in the destination instance before using redash-migrate,[0m
[30;1m109 | [0m[35myou must manually add them to `meta.json` so that it can associate their id at the[0m
[30;1m110 | [0m[35morigin instance with their id at the destination. [0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35mIf you don't do this, you will potentially create a duplicate user at the destination.[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35morigin and the destination instance.[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mAdditionally, if you created any users in the destination instance before using redash-migrate,[0m
[30;1m109 | [0m[35myou must manually add them to `meta.json` so that it can associate their id at the[0m
[30;1m110 | [0m[35morigin instance with their id at the destination. [0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35mIf you don't do this, you will potentially create a duplicate user at the destination.[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mredash-migrate assumes your destination is a fresh instance of Redash. But the destination cannot[0m
[30;1m104 | [0m[35mbe entirely blank because you need at least one admin user to already exist at the destination. As[0m
[30;1m105 | [0m[35mpart of the `init` command, you will be asked to provide the user id for your admin user at both the[0m
[30;1m106 | [0m[35morigin and the destination instance.[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mAdditionally, if you created any users in the destination instance before using redash-migrate,[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m### FIRST USER[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mredash-migrate assumes your destination is a fresh instance of Redash. But the destination cannot[0m
[30;1m104 | [0m[35mbe entirely blank because you need at least one admin user to already exist at the destination. As[0m
[30;1m105 | [0m[35mpart of the `init` command, you will be asked to provide the user id for your admin user at both the[0m
[30;1m106 | [0m[35morigin and the destination instance.[0m
[30;1m107 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m### FIRST USER[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mredash-migrate assumes your destination is a fresh instance of Redash. But the destination cannot[0m
[30;1m104 | [0m[35mbe entirely blank because you need at least one admin user to already exist at the destination. As[0m
[30;1m105 | [0m[35mpart of the `init` command, you will be asked to provide the user id for your admin user at both the[0m
[30;1m106 | [0m[35morigin and the destination instance.[0m
[30;1m107 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/docs/redash-migrate/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m26 | [0m[35mpip install --upgrade redash-toolbelt[0m
[30;1m27 | [0m[35m```[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mThis command will update `redash-toolbelt` if you have already installed it. See the [PyPi page] for[0m
[30;1m30 | [0m[35mmore information. The `redash-migrate` command will now be available.[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[PyPi page]: https://pypi.org/project/redash-toolbelt/[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m    for widget in current_dashboard["widgets"]:[0m
[30;1m54 | [0m[35m        visualization_id = None[0m
[30;1m55 | [0m[35m        if "visualization" in widget:[0m
[30;1m56 | [0m[35m            visualization_id = old_viz_vs_new_viz.get(widget["visualization"]["id"])[0m
[30;1m57 | [0m[35m        client.create_widget([0m
[30;1m58 | [0m[35m            new_dashboard["id"], visualization_id, widget["text"], widget["options"][0m
[30;1m59 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        for pair in old_vs_new_query_pairs[0m
[30;1m46 | [0m[35m        for old_viz in pair["old_query"].get("visualizations")[0m
[30;1m47 | [0m[35m        for new_viz in pair["new_query"].get("visualizations")[0m
[30;1m48 | [0m[35m        if old_viz.get("options") == new_viz.get("options")[0m
[30;1m49 | [0m[35m    }[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # This is a version of the same logic from Redash.duplicate_dashboard[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        for pair in old_vs_new_query_pairs[0m
[30;1m46 | [0m[35m        for old_viz in pair["old_query"].get("visualizations")[0m
[30;1m47 | [0m[35m        for new_viz in pair["new_query"].get("visualizations")[0m
[30;1m48 | [0m[35m        if old_viz.get("options") == new_viz.get("options")[0m
[30;1m49 | [0m[35m    }[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # This is a version of the same logic from Redash.duplicate_dashboard[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m        old_viz.get("id"): new_viz.get("id")[0m
[30;1m45 | [0m[35m        for pair in old_vs_new_query_pairs[0m
[30;1m46 | [0m[35m        for old_viz in pair["old_query"].get("visualizations")[0m
[30;1m47 | [0m[35m        for new_viz in pair["new_query"].get("visualizations")[0m
[30;1m48 | [0m[35m        if old_viz.get("options") == new_viz.get("options")[0m
[30;1m49 | [0m[35m    }[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    old_viz_vs_new_viz = {[0m
[30;1m44 | [0m[35m        old_viz.get("id"): new_viz.get("id")[0m
[30;1m45 | [0m[35m        for pair in old_vs_new_query_pairs[0m
[30;1m46 | [0m[35m        for old_viz in pair["old_query"].get("visualizations")[0m
[30;1m47 | [0m[35m        for new_viz in pair["new_query"].get("visualizations")[0m
[30;1m48 | [0m[35m        if old_viz.get("options") == new_viz.get("options")[0m
[30;1m49 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    # Compare old visualizations to new ones[0m
[30;1m42 | [0m[35m    # Create a mapping of old visualization IDs to new ones[0m
[30;1m43 | [0m[35m    old_viz_vs_new_viz = {[0m
[30;1m44 | [0m[35m        old_viz.get("id"): new_viz.get("id")[0m
[30;1m45 | [0m[35m        for pair in old_vs_new_query_pairs[0m
[30;1m46 | [0m[35m        for old_viz in pair["old_query"].get("visualizations")[0m
[30;1m47 | [0m[35m        for new_viz in pair["new_query"].get("visualizations")[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    # Compare old visualizations to new ones[0m
[30;1m42 | [0m[35m    # Create a mapping of old visualization IDs to new ones[0m
[30;1m43 | [0m[35m    old_viz_vs_new_viz = {[0m
[30;1m44 | [0m[35m        old_viz.get("id"): new_viz.get("id")[0m
[30;1m45 | [0m[35m        for pair in old_vs_new_query_pairs[0m
[30;1m46 | [0m[35m        for old_viz in pair["old_query"].get("visualizations")[0m
[30;1m47 | [0m[35m        for new_viz in pair["new_query"].get("visualizations")[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m        {[0m
[30;1m33 | [0m[35m            "old_query": client._get(f"api/queries/{old_query.get('id')}").json(),[0m
[30;1m34 | [0m[35m            "new_query": client.duplicate_query([0m
[30;1m35 | [0m[35m                old_query.get("id"), new_name=" ".join([prefix + old_query.get("name")])[0m
[30;1m36 | [0m[35m            ),[0m
[30;1m37 | [0m[35m        }[0m
[30;1m38 | [0m[35m        for old_query in queries_to_duplicate.values()[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m        {[0m
[30;1m33 | [0m[35m            "old_query": client._get(f"api/queries/{old_query.get('id')}").json(),[0m
[30;1m34 | [0m[35m            "new_query": client.duplicate_query([0m
[30;1m35 | [0m[35m                old_query.get("id"), new_name=" ".join([prefix + old_query.get("name")])[0m
[30;1m36 | [0m[35m            ),[0m
[30;1m37 | [0m[35m        }[0m
[30;1m38 | [0m[35m        for old_query in queries_to_duplicate.values()[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m    # Duplicate the query and store the result[0m
[30;1m31 | [0m[35m    old_vs_new_query_pairs = [[0m
[30;1m32 | [0m[35m        {[0m
[30;1m33 | [0m[35m            "old_query": client._get(f"api/queries/{old_query.get('id')}").json(),[0m
[30;1m34 | [0m[35m            "new_query": client.duplicate_query([0m
[30;1m35 | [0m[35m                old_query.get("id"), new_name=" ".join([prefix + old_query.get("name")])[0m
[30;1m36 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    # I use a dictionary here because it de-duplicates query IDs[0m
[30;1m23 | [0m[35m    queries_to_duplicate = {[0m
[30;1m24 | [0m[35m        widget["visualization"]["query"]["id"]: widget["visualization"]["query"][0m
[30;1m25 | [0m[35m        for widget in current_dashboard.get("widgets", [])[0m
[30;1m26 | [0m[35m        if "visualization" in widget[0m
[30;1m27 | [0m[35m    }[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/clone_dashboard_and_queries.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35m    }[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # This is a version of the same logic from Redash.duplicate_dashboard[0m
[30;1m52 | [0m[35m    # But it substitutes in the new visualiation ID pointing at the copied query.[0m
[30;1m53 | [0m[35m    for widget in current_dashboard["widgets"]:[0m
[30;1m54 | [0m[35m        visualization_id = None[0m
[30;1m55 | [0m[35m        if "visualization" in widget:[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m                            the search term you provide[0m
[30;1m52 | [0m[35mfind-tables                 Search the text of queries against a data source[0m
[30;1m53 | [0m[35m                            to see which table names are used in queries of[0m
[30;1m54 | [0m[35m                            that source. This script relies on regex that is[0m
[30;1m55 | [0m[35m                            tested against ANSI SQL.[0m
[30;1m56 | [0m[35mclone-dashboard-and-queries Completely duplicate a dashboard by copying all [0m
[30;1m57 | [0m[35m                            its queries and visualizations.[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m```text[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mgdpr-scrub                  Search for a string term in  your Redash queries[0m
[30;1m49 | [0m[35m                            and query results. The script returns a list of[0m
[30;1m50 | [0m[35m                            URLs in your instance that contain references to[0m
[30;1m51 | [0m[35m                            the search term you provide[0m
[30;1m52 | [0m[35mfind-tables                 Search the text of queries against a data source[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35mTo install it you will need Python 3.6 or above. We recommend that you use a [virtual environment].[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m```bash[0m
[30;1m34 | [0m[35mpip install --upgrade redash-toolbelt[0m
[30;1m35 | [0m[35m```[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mThis command will update `redash-toolbelt` if you have already installed it.[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35mpip install --upgrade redash-toolbelt[0m
[30;1m35 | [0m[35m```[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mThis command will update `redash-toolbelt` if you have already installed it.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[virtual environment]: https://pythonbasics.org/virtualenv/[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/gdpr_scrub.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        dash_widgets = ([0m
[30;1m62 | [0m[35m            self.redash._get("api/dashboards/{}".format(dashboard["slug"]))[0m
[30;1m63 | [0m[35m            .json()[0m
[30;1m64 | [0m[35m            .get("widgets", [])[0m
[30;1m65 | [0m[35m        )[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        # Check text widgets[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/gdpr_scrub.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m        with click.progressbar(dashboards, label="Dashboards") as bar:[0m
[30;1m92 | [0m[35m            found_d = [dash for dash in bar if self.check_dashboard(dash)][0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        for dash in found_d:[0m
[30;1m95 | [0m[35m            dash_url = "{}/dashboards/{}".format(self.redash.redash_url, dash["slug"])[0m
[30;1m96 | [0m[35m            print(dash_url)[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m133[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/redash_toolbelt-0.1.9/redash_toolbelt/examples/gdpr_scrub.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m        dashboards = self.redash.paginate(self.redash.dashboards)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        with click.progressbar(dashboards, label="Dashboards") as bar:[0m
[30;1m92 | [0m[35m            found_d = [dash for dash in bar if self.check_dashboard(dash)][0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        for dash in found_d:[0m
[30;1m95 | [0m[35m            dash_url = "{}/dashboards/{}".format(self.redash.redash_url, dash["slug"])[0m

133 matches found.
