[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m216 | [0m[35m        :param encode_data_to_base64: encode data to base64 if True[0m
[30;1m217 | [0m[35m        """[0m
[30;1m218 | [0m[35m        if encode_data_to_base64:[0m
[30;1m219 | [0m[35m            data = base64.standard_b64encode(data.encode()).decode()[0m
[30;1m220 | [0m[35m        self.embeddings.append({"data": data, "mime_type": mime_type})[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m213 | [0m[35m        :param mime_type: image/png, image/bmp, text/plain, text/html[0m
[30;1m214 | [0m[35m            - mime types with special support by Cucumber reporting[0m
[30;1m215 | [0m[35m            - other mime types will be handled with default handling[0m
[30;1m216 | [0m[35m        :param encode_data_to_base64: encode data to base64 if True[0m
[30;1m217 | [0m[35m        """[0m
[30;1m218 | [0m[35m        if encode_data_to_base64:[0m
[30;1m219 | [0m[35m            data = base64.standard_b64encode(data.encode()).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        :param data: data attached to report[0m
[30;1m211 | [0m[35m            data needs to be encoded in base64 for proper handling by tests reporting tools[0m
[30;1m212 | [0m[35m            if not encoded in base64 encoded_data_to_base64 needs to be True (default value)[0m
[30;1m213 | [0m[35m        :param mime_type: image/png, image/bmp, text/plain, text/html[0m
[30;1m214 | [0m[35m            - mime types with special support by Cucumber reporting[0m
[30;1m215 | [0m[35m            - other mime types will be handled with default handling[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m208 | [0m[35m                - allow to attach text, html or images[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        :param data: data attached to report[0m
[30;1m211 | [0m[35m            data needs to be encoded in base64 for proper handling by tests reporting tools[0m
[30;1m212 | [0m[35m            if not encoded in base64 encoded_data_to_base64 needs to be True (default value)[0m
[30;1m213 | [0m[35m        :param mime_type: image/png, image/bmp, text/plain, text/html[0m
[30;1m214 | [0m[35m            - mime types with special support by Cucumber reporting[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom __future__ import unicode_literals[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport base64[0m
[30;1m10 | [0m[35mimport re[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom radish.model import Model[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/common/error_handling.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m31 | [0m[35m        else:[0m
[30;1m32 | [0m[35m            self.exit_on_failure = literal_eval(world.config.user_data['exit_on_failure'])[0m
[30;1m33 | [0m[35m            self.no_failure = literal_eval(world.config.user_data['no_failure'])[0m
[30;1m34 | [0m[35m        _TFC_ERROR = os.environ.get('TFC_ERROR')[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        if step_obj.context.no_failure:[0m
[30;1m37 | [0m[35m            self.exception = type(step_obj.context.failure_class, (Exception, ), {})[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/main.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m    # SSH Key is given for git authentication[0m
[30;1m78 | [0m[35m    ssh_cmd = {}[0m
[30;1m79 | [0m[35m    if args.ssh_key:[0m
[30;1m80 | [0m[35m        ssh_cmd = {'GIT_SSH_COMMAND': 'ssh -l {} -i {}'.format('git', args.ssh_key)}[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    features_dir = '/'[0m
[30;1m83 | [0m[35m    # A remote repository used here[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/main.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    # SSH Key is given for git authentication[0m
[30;1m78 | [0m[35m    ssh_cmd = {}[0m
[30;1m79 | [0m[35m    if args.ssh_key:[0m
[30;1m80 | [0m[35m        ssh_cmd = {'GIT_SSH_COMMAND': 'ssh -l {} -i {}'.format('git', args.ssh_key)}[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    features_dir = '/'[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/terraform_compliance/main.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m        # Clone repository[0m
[30;1m106 | [0m[35m        args.features = mkdtemp()[0m
[30;1m107 | [0m[35m        Repo.clone_from(url=features_git_repo, to_path=args.features, env=ssh_cmd, depth=1, branch=f[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    features_directory = os.path.join(os.path.abspath(args.features) + features_dir)[0m
[30;1m110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m513 | [0m[35m            resource['values'] = {}[0m
[30;1m514 | [0m[35m        tag = resource.get('values', {}).get('tag')[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        if not resource.get('values', {}).get('tags'):[0m
[30;1m517 | [0m[35m            resource['values']['tags'] = {}[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m        if tag:[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m513 | [0m[35m            resource['values'] = {}[0m
[30;1m514 | [0m[35m        tag = resource.get('values', {}).get('tag')[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        if not resource.get('values', {}).get('tags'):[0m
[30;1m517 | [0m[35m            resource['values']['tags'] = {}[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m        if tag:[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m511 | [0m[35m    for resource in resource_list:[0m
[30;1m512 | [0m[35m        if resource.get('values', {}) is None:[0m
[30;1m513 | [0m[35m            resource['values'] = {}[0m
[30;1m514 | [0m[35m        tag = resource.get('values', {}).get('tag')[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        if not resource.get('values', {}).get('tags'):[0m
[30;1m517 | [0m[35m            resource['values']['tags'] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m511 | [0m[35m    for resource in resource_list:[0m
[30;1m512 | [0m[35m        if resource.get('values', {}) is None:[0m
[30;1m513 | [0m[35m            resource['values'] = {}[0m
[30;1m514 | [0m[35m        tag = resource.get('values', {}).get('tag')[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        if not resource.get('values', {}).get('tags'):[0m
[30;1m517 | [0m[35m            resource['values']['tags'] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m509 | [0m[35m        return resource_list[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m    for resource in resource_list:[0m
[30;1m512 | [0m[35m        if resource.get('values', {}) is None:[0m
[30;1m513 | [0m[35m            resource['values'] = {}[0m
[30;1m514 | [0m[35m        tag = resource.get('values', {}).get('tag')[0m
[30;1m515 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m455 | [0m[35m        findings.append(dict(values=needle, address=None))[0m
[30;1m456 | [0m[35m[0m
[30;1m457 | [0m[35m    elif isinstance(haystack, dict):[0m
[30;1m458 | [0m[35m        address = haystack.get('address') if address is None else address[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        for key, value in haystack.items():[0m
[30;1m461 | [0m[35m            if isinstance(value, (dict, list)):[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m        for key, value in haystack.items():[0m
[30;1m357 | [0m[35m            if not _depth:[0m
[30;1m358 | [0m[35m                _inherited_key = key[0m
[30;1m359 | [0m[35m                _return_value = key if not return_key else haystack[_inherited_key].get(return_key, [0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m            if key.lower() == needle.lower():[0m
[30;1m362 | [0m[35m                found.append(_return_value)[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m            findings.append(dict(values=needle, address=None))[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        elif isinstance(haystack, dict):[0m
[30;1m123 | [0m[35m            address = haystack.get('address') if address is None else address[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m            for key, value in haystack.items():[0m
[30;1m126 | [0m[35m                if isinstance(value, (dict, list)):[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m568 | [0m[35m        if all elements are singular[0m
[30;1m569 | [0m[35m            return {**target, **source}[0m
[30;1m570 | [0m[35m        merged = {**target, **source} # source has priority over conflicts[0m
[30;1m571 | [0m[35m        # find conflicting lists[0m
[30;1m572 | [0m[35m        for all conflicting lists,[0m
[30;1m573 | [0m[35m            # merged[key] = source[key] + target[key] # honestly depends on the situation[0m
[30;1m574 | [0m[35m            merged[key] = merge_dicts(source[key], target[key])[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m554 | [0m[35m        dictionaries: merge conflicting dictionaries[0m
[30;1m555 | [0m[35m        lists: higher prio overrides for regular values, merge any matching dictionary/list elements[0m
[30;1m556 | [0m[35m            if len(target) > len(source):[0m
[30;1m557 | [0m[35m                append the tail to the source[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35m[0m
[30;1m560 | [0m[35m    # Confusing and less important comments:[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        return False[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m    # IP is a possible regex string[0m
[30;1m236 | [0m[35m    else:[0m
[30;1m237 | [0m[35m        # The given regex is matching the CIDR within the plan[0m
[30;1m238 | [0m[35m        for elem in cidr:[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m                  r'\/' \[0m
[30;1m225 | [0m[35m                  r'(3[0-2]|2[0-9]|1[0-9]|[0-9])'[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    # IP is a not a regex string[0m
[30;1m228 | [0m[35m    if re.match(is_ip_regex, ip_cidr) is not None:[0m
[30;1m229 | [0m[35m        for ip_network in cidr:[0m
[30;1m230 | [0m[35m            if check_if_cidr(ip_cidr) and check_if_cidr(ip_network) and IPNetwork(ip_cidr) in IPNetw[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/steps.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m201 | [0m[35m@then(u'its value must be {operator:ANY} than {number:d}')[0m
[30;1m202 | [0m[35m@then(u'I expect the result is {operator:ANY} than {number:d}')[0m
[30;1m203 | [0m[35m@then(u'its value must be {operator:ANY} to {number:d}')[0m
[30;1m204 | [0m[35m@then(u'I expect the result is {operator:ANY} to {number:d}')[0m
[30;1m205 | [0m[35mdef wrapper(_step_obj, operator, number, _stash=EmptyStash):[0m
[30;1m206 | [0m[35m    return i_expect_the_result_is_operator_than_number(_step_obj, operator, number, _stash=EmptyStas[0m
[30;1m207 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/steps.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m@then(u'its value must be {operator:ANY} than {number:d}')[0m
[30;1m202 | [0m[35m@then(u'I expect the result is {operator:ANY} than {number:d}')[0m
[30;1m203 | [0m[35m@then(u'its value must be {operator:ANY} to {number:d}')[0m
[30;1m204 | [0m[35m@then(u'I expect the result is {operator:ANY} to {number:d}')[0m
[30;1m205 | [0m[35mdef wrapper(_step_obj, operator, number, _stash=EmptyStash):[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m                    found_values[i] = found_val['constant_value'][0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m            if resource_passed:[0m
[30;1m223 | [0m[35m                Error(_step_obj, '{} property exists in {} ({}).'.format(something, resource['addres[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m    elif _step_obj.context.type == 'provider':[0m
[30;1m226 | [0m[35m        for provider_data in _step_obj.context.stash:[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m                        for found_key_instance in found_key:[0m
[30;1m213 | [0m[35m                            if isinstance(found_key_instance, dict):[0m
[30;1m214 | [0m[35m                                if match.get(found_key_instance, something, Null) not in (Null, [], [0m
[30;1m215 | [0m[35m                                    found_values.append(match.get(found_key_instance, something))[0m
[30;1m216 | [0m[35m                                    resource_passed = True[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m            for i, found_val in enumerate(found_values):[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m                        for found_key_instance in found_key:[0m
[30;1m213 | [0m[35m                            if isinstance(found_key_instance, dict):[0m
[30;1m214 | [0m[35m                                if match.get(found_key_instance, something, Null) not in (Null, [], [0m
[30;1m215 | [0m[35m                                    found_values.append(match.get(found_key_instance, something))[0m
[30;1m216 | [0m[35m                                    resource_passed = True[0m
[30;1m217 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m                            if found_key:[0m
[30;1m196 | [0m[35m                                found_key = found_key[0][0m
[30;1m197 | [0m[35m                                found_values.extend(value.get('value'))[0m
[30;1m198 | [0m[35m                                resource_passed = True[0m
[30;1m199 | [0m[35m                                continue[0m
[30;1m200 | [0m[35m                    elif isinstance(value, list):[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m                    # Following line could be problematic, how to determine if something is set to b[0m
[30;1m178 | [0m[35m                    # For now, allow '' and don't allow [] as per user cases.[0m
[30;1m179 | [0m[35m                    if match.get(kv_pair, something) not in ([],):[0m
[30;1m180 | [0m[35m                        found_values.append(match.get(kv_pair, something))[0m
[30;1m181 | [0m[35m                        resource_passed = True[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m            elif isinstance(values, list):[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m                    # ignore the values that correspond to Null [0m
[30;1m177 | [0m[35m                    # Following line could be problematic, how to determine if something is set to b[0m
[30;1m178 | [0m[35m                    # For now, allow '' and don't allow [] as per user cases.[0m
[30;1m179 | [0m[35m                    if match.get(kv_pair, something) not in ([],):[0m
[30;1m180 | [0m[35m                        found_values.append(match.get(kv_pair, something))[0m
[30;1m181 | [0m[35m                        resource_passed = True[0m
[30;1m182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m            # set this to True if you get anything from the resource, don't set it to False if you g[0m
[30;1m164 | [0m[35m            if isinstance(values, dict):[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m                found_key = match.get(values, something, Null)[0m
[30;1m167 | [0m[35m                if found_key is not Null:[0m
[30;1m168 | [0m[35m                    found_key = [{something: found_key}][0m
[30;1m169 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m                            'address': resource,[0m
[30;1m154 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m157 | [0m[35m            if not values:[0m
[30;1m158 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m159 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m                            'address': resource,[0m
[30;1m154 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m157 | [0m[35m            if not values:[0m
[30;1m158 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m159 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m                prop_list.extend(values)[0m
[30;1m120 | [0m[35m                _step_obj.context.property_name = something[0m
[30;1m121 | [0m[35m                _step_obj.context.address = '{}.{}'.format(provider_data.get('name', _step_obj.conte[0m
[30;1m122 | [0m[35m                                                           provider_data.get('alias', "\b"))[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m            else:[0m
[30;1m125 | [0m[35m                Error(_step_obj, '{} {} does not have {} property.'.format(_step_obj.context.address[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m            if values:[0m
[30;1m119 | [0m[35m                prop_list.extend(values)[0m
[30;1m120 | [0m[35m                _step_obj.context.property_name = something[0m
[30;1m121 | [0m[35m                _step_obj.context.address = '{}.{}'.format(provider_data.get('name', _step_obj.conte[0m
[30;1m122 | [0m[35m                                                           provider_data.get('alias', "\b"))[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m            # do not check prop list here because every resource should contain it.[0m
[30;1m103 | [0m[35m            if not resource_passed and not child: # if nothing was found in this resource, don't err[0m
[30;1m104 | [0m[35m                Error(_step_obj, '{} ({}) does not have {} property.'.format(resource['address'],[0m
[30;1m105 | [0m[35m                                                                             resource.get('type', ''[0m
[30;1m106 | [0m[35m                                                                             something))[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        if prop_list:[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m                        for found_key_instance in found_key:[0m
[30;1m88 | [0m[35m                            if isinstance(found_key_instance, dict):[0m
[30;1m89 | [0m[35m                                if match.get(found_key_instance, something, Null) not in (Null, [], [0m
[30;1m90 | [0m[35m                                    found_values.append(match.get(found_key_instance, something))[0m
[30;1m91 | [0m[35m                                    resource_passed = True[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m            for i, found_val in enumerate(found_values):[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m                        for found_key_instance in found_key:[0m
[30;1m88 | [0m[35m                            if isinstance(found_key_instance, dict):[0m
[30;1m89 | [0m[35m                                if match.get(found_key_instance, something, Null) not in (Null, [], [0m
[30;1m90 | [0m[35m                                    found_values.append(match.get(found_key_instance, something))[0m
[30;1m91 | [0m[35m                                    resource_passed = True[0m
[30;1m92 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m                            if found_key:[0m
[30;1m70 | [0m[35m                                found_key = found_key[0][0m
[30;1m71 | [0m[35m                                # not going to use match.get here because the following line is an e[0m
[30;1m72 | [0m[35m                                found_values.extend(value.get('value'))[0m
[30;1m73 | [0m[35m                                resource_passed = True[0m
[30;1m74 | [0m[35m                                continue[0m
[30;1m75 | [0m[35m                    elif isinstance(value, list):[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m                    # Following line could be problematic, how to determine if something is set to b[0m
[30;1m51 | [0m[35m                    # For now, allow '' and don't allow [] as per user cases.[0m
[30;1m52 | [0m[35m                    if match.get(kv_pair, something) not in ([],):[0m
[30;1m53 | [0m[35m                        found_values.append(match.get(kv_pair, something))[0m
[30;1m54 | [0m[35m                        resource_passed = True[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m            elif isinstance(values, list):[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m                    # ignore the values that correspond to Null [0m
[30;1m50 | [0m[35m                    # Following line could be problematic, how to determine if something is set to b[0m
[30;1m51 | [0m[35m                    # For now, allow '' and don't allow [] as per user cases.[0m
[30;1m52 | [0m[35m                    if match.get(kv_pair, something) not in ([],):[0m
[30;1m53 | [0m[35m                        found_values.append(match.get(kv_pair, something))[0m
[30;1m54 | [0m[35m                        resource_passed = True[0m
[30;1m55 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m            # set this to True if you get anything from the resource, don't set it to False if you g[0m
[30;1m37 | [0m[35m            if isinstance(values, dict):[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m                found_key = match.get(values, something, Null)[0m
[30;1m40 | [0m[35m                if found_key is not Null:[0m
[30;1m41 | [0m[35m                    found_key = [{something: found_key}][0m
[30;1m42 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m            # not going to use match.get here because the following line is an edge case[0m
[30;1m29 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m30 | [0m[35m            if not values:[0m
[30;1m31 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_contain_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m            # not going to use match.get here because the following line is an edge case[0m
[30;1m29 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m30 | [0m[35m            if not values:[0m
[30;1m31 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m        """[0m
[30;1m64 | [0m[35m            Returns the expanded sentence of this step[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m                * Expand constants[0m
[30;1m67 | [0m[35m        """[0m
[30;1m68 | [0m[35m        sentence = self.sentence[0m
[30;1m69 | [0m[35m        for name, value in self.parent.constants:[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m        :param mime_type: image/png, image/bmp, text/plain, text/html[0m
[30;1m214 | [0m[35m            - mime types with special support by Cucumber reporting[0m
[30;1m215 | [0m[35m            - other mime types will be handled with default handling[0m
[30;1m216 | [0m[35m        :param encode_data_to_base64: encode data to base64 if True[0m
[30;1m217 | [0m[35m        """[0m
[30;1m218 | [0m[35m        if encode_data_to_base64:[0m
[30;1m219 | [0m[35m            data = base64.standard_b64encode(data.encode()).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        :param data: data attached to report[0m
[30;1m211 | [0m[35m            data needs to be encoded in base64 for proper handling by tests reporting tools[0m
[30;1m212 | [0m[35m            if not encoded in base64 encoded_data_to_base64 needs to be True (default value)[0m
[30;1m213 | [0m[35m        :param mime_type: image/png, image/bmp, text/plain, text/html[0m
[30;1m214 | [0m[35m            - mime types with special support by Cucumber reporting[0m
[30;1m215 | [0m[35m            - other mime types will be handled with default handling[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m                - allow to attach text, html or images[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        :param data: data attached to report[0m
[30;1m211 | [0m[35m            data needs to be encoded in base64 for proper handling by tests reporting tools[0m
[30;1m212 | [0m[35m            if not encoded in base64 encoded_data_to_base64 needs to be True (default value)[0m
[30;1m213 | [0m[35m        :param mime_type: image/png, image/bmp, text/plain, text/html[0m
[30;1m214 | [0m[35m            - mime types with special support by Cucumber reporting[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m        """[0m
[30;1m64 | [0m[35m            Returns the expanded sentence of this step[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m                * Expand constants[0m
[30;1m67 | [0m[35m        """[0m
[30;1m68 | [0m[35m        sentence = self.sentence[0m
[30;1m69 | [0m[35m        for name, value in self.parent.constants:[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_step.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom __future__ import unicode_literals[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport base64[0m
[30;1m10 | [0m[35mimport re[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom radish.model import Model[0m
[30;1m13 | [0m[35mfrom radish.exceptions import RadishError[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/it_must_have_reference_address_referenced.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m            else:[0m
[30;1m19 | [0m[35m                raise TerraformComplianceInternalFailure('Unexpected resource structure: {}'.format([0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m            Error(_step_obj, '{} is not referenced within {}.'.format(reference_address, resource.ge[0m
[30;1m22 | [0m[35m    else:[0m
[30;1m23 | [0m[35m        Error(_step_obj, 'No entities found for this step to process. Check your filtering steps in [0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/given/i_have_name_section_configured.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m            return True[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    elif type_name == 'output':[0m
[30;1m129 | [0m[35m        found_output = match.get(_terraform_config.config.terraform.outputs, name, None)[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        if found_output:[0m
[30;1m132 | [0m[35m            _step_obj.context.type = type_name[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/given/i_have_name_section_configured.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m            return True[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    elif type_name == 'variable':[0m
[30;1m117 | [0m[35m        found_variable = match.get(_terraform_config.config.terraform.variables, name, None)[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        if found_variable:[0m
[30;1m120 | [0m[35m            _step_obj.context.type = type_name[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/override_radish_hookerrors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m        {[0m
[30;1m74 | [0m[35m            'class': FeatureFileSyntaxError,[0m
[30;1m75 | [0m[35m            'text': 'You have a SyntaxError in your feature file! Please have a look into terraform-[0m
[30;1m76 | [0m[35m                    'radish documentation to find out which features are supported and how you could[0m
[30;1m77 | [0m[35m                    'https://terraform-compliance.com  https://radish.readthedocs.io/en/stable/'[0m
[30;1m78 | [0m[35m        },[0m
[30;1m79 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m            found_list.append(obj)[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        elif isinstance(object_key, dict):[0m
[30;1m128 | [0m[35m            if not match.contains(object_key, value) or (dict_value is not None and not match.equals[0m
[30;1m129 | [0m[35m                found_list.append(obj)[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        elif object_key is None and not match.equals('None', value):[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m            object_key = match.get(obj, key, Null)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        if address is not Null and isinstance(object_key, dict) and match.contains(object_key, addre[0m
[30;1m112 | [0m[35m            object_key = match.get(object_key, address, Null)[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m        if isinstance(object_key, str):[0m
[30;1m115 | [0m[35m            if "[" in object_key:[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m        # temporary logic[0m
[30;1m107 | [0m[35m        # check metadata if key is not in values[0m
[30;1m108 | [0m[35m        if object_key is Null:[0m
[30;1m109 | [0m[35m            object_key = match.get(obj, key, Null)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        if address is not Null and isinstance(object_key, dict) and match.contains(object_key, addre[0m
[30;1m112 | [0m[35m            object_key = match.get(object_key, address, Null)[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m            object_key = [keys for keys in object_keys if keys is not Null][0m
[30;1m103 | [0m[35m        else:[0m
[30;1m104 | [0m[35m            object_key = match.get(object_key, key, Null)[0m
[30;1m105 | [0m[35m        [0m
[30;1m106 | [0m[35m        # temporary logic[0m
[30;1m107 | [0m[35m        # check metadata if key is not in values[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m            object_keys = [][0m
[30;1m98 | [0m[35m            for object_key_element in object_key:[0m
[30;1m99 | [0m[35m                if not match.equals(match.get(object_key_element, key, Null), value):[0m
[30;1m100 | [0m[35m                    object_keys.append(match.get(object_key_element, key, Null))[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m            object_key = [keys for keys in object_keys if keys is not Null][0m
[30;1m103 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m        if isinstance(object_key, list):[0m
[30;1m97 | [0m[35m            object_keys = [][0m
[30;1m98 | [0m[35m            for object_key_element in object_key:[0m
[30;1m99 | [0m[35m                if not match.equals(match.get(object_key_element, key, Null), value):[0m
[30;1m100 | [0m[35m                    object_keys.append(match.get(object_key_element, key, Null))[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m            object_key = [keys for keys in object_keys if keys is not Null][0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    found_list = [][0m
[30;1m93 | [0m[35m    for obj in _step_obj.context.stash:[0m
[30;1m94 | [0m[35m        object_key = obj.get('values', {})[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        if isinstance(object_key, list):[0m
[30;1m97 | [0m[35m            object_keys = [][0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m                found_list.append(obj)[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        elif isinstance(object_key, dict):[0m
[30;1m55 | [0m[35m            candidate_value = match.get(object_key, value)[0m
[30;1m56 | [0m[35m            if candidate_value is not None and ([0m
[30;1m57 | [0m[35m                    dict_value is None or ([0m
[30;1m58 | [0m[35m                    match.equals(candidate_value, dict_value))[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m        if object_key is Null:[0m
[30;1m35 | [0m[35m            object_key = match.get(obj, key, Null)[0m
[30;1m36 | [0m[35m            if address is not Null and isinstance(object_key, dict) and match.contains(object_key, a[0m
[30;1m37 | [0m[35m                object_key = match.get(object_key, address, Null)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        if isinstance(object_key, str):[0m
[30;1m40 | [0m[35m            if "[" in object_key:[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m            object_key = match.get(object_key, key, Null)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m        if object_key is Null:[0m
[30;1m35 | [0m[35m            object_key = match.get(obj, key, Null)[0m
[30;1m36 | [0m[35m            if address is not Null and isinstance(object_key, dict) and match.contains(object_key, a[0m
[30;1m37 | [0m[35m                object_key = match.get(object_key, address, Null)[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m                    if isinstance(filtered_key, (str, int, bool)) and match.equals(filtered_key, val[0m
[30;1m30 | [0m[35m                        found_list.append(el)[0m
[30;1m31 | [0m[35m        else:[0m
[30;1m32 | [0m[35m            object_key = match.get(object_key, key, Null)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m        if object_key is Null:[0m
[30;1m35 | [0m[35m            object_key = match.get(obj, key, Null)[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        if isinstance(object_key, list):[0m
[30;1m26 | [0m[35m            for el in object_key:[0m
[30;1m27 | [0m[35m                if isinstance(el, dict):[0m
[30;1m28 | [0m[35m                    filtered_key = match.get(el, key)[0m
[30;1m29 | [0m[35m                    if isinstance(filtered_key, (str, int, bool)) and match.equals(filtered_key, val[0m
[30;1m30 | [0m[35m                        found_list.append(el)[0m
[30;1m31 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    found_list = [][0m
[30;1m23 | [0m[35m    for obj in _step_obj.context.stash:[0m
[30;1m24 | [0m[35m        object_key = obj.get('values', {})[0m
[30;1m25 | [0m[35m        if isinstance(object_key, list):[0m
[30;1m26 | [0m[35m            for el in object_key:[0m
[30;1m27 | [0m[35m                if isinstance(el, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m    else:[0m
[30;1m138 | [0m[35m        _step_obj.context.addresses = _step_obj.context.addresses if isinstance(_step_obj.context.ad[0m
[30;1m139 | [0m[35m        if object_key is Null:[0m
[30;1m140 | [0m[35m            skip_step(_step_obj, message='Could not find {} in {}.'.format(key,[0m
[30;1m141 | [0m[35m                                                                     ', '.join(_step_obj.context.add[0m
[30;1m142 | [0m[35m        elif dict_value is None:[0m
[30;1m143 | [0m[35m            skip_step(_step_obj, message='Found {} {} in {}.'.format(value, orig_key,[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m            skip_step(_step_obj, message='Can not find {} {} in {}.'.format(value, orig_key,[0m
[30;1m75 | [0m[35m                                                                            ', '.join(_step_obj.cont[0m
[30;1m76 | [0m[35m        else:[0m
[30;1m77 | [0m[35m            skip_step(_step_obj, message='Can not find {}={} {} in {}.'.format(value, dict_value, or[0m
[30;1m78 | [0m[35m                                                                               ', '.join(_step_obj.c[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m            skip_step(_step_obj, message='Could not find {} in {}.'.format(key,[0m
[30;1m72 | [0m[35m                                                                           ', '.join(_step_obj.conte[0m
[30;1m73 | [0m[35m        elif dict_value is None:[0m
[30;1m74 | [0m[35m            skip_step(_step_obj, message='Can not find {} {} in {}.'.format(value, orig_key,[0m
[30;1m75 | [0m[35m                                                                            ', '.join(_step_obj.cont[0m
[30;1m76 | [0m[35m        else:[0m
[30;1m77 | [0m[35m            skip_step(_step_obj, message='Can not find {}={} {} in {}.'.format(value, dict_value, or[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_is_value.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m    else:[0m
[30;1m69 | [0m[35m        _step_obj.context.addresses = _step_obj.context.addresses if isinstance(_step_obj.context.ad[0m
[30;1m70 | [0m[35m        if object_key is Null:[0m
[30;1m71 | [0m[35m            skip_step(_step_obj, message='Could not find {} in {}.'.format(key,[0m
[30;1m72 | [0m[35m                                                                           ', '.join(_step_obj.conte[0m
[30;1m73 | [0m[35m        elif dict_value is None:[0m
[30;1m74 | [0m[35m            skip_step(_step_obj, message='Can not find {} {} in {}.'.format(value, orig_key,[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/ext_radish_bdd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m        message = '{} {} {}'.format(Defaults().yellow('Can not find'),[0m
[30;1m15 | [0m[35m                                    Defaults().green(resource),[0m
[30;1m16 | [0m[35m                                    Defaults().yellow('defined in target terraform plan.'))[0m
[30;1m17 | [0m[35m        e_message = 'Can not find {} defined in target terraform plan.'.format(resource)[0m
[30;1m18 | [0m[35m    else:[0m
[30;1m19 | [0m[35m        e_message = message[0m
[30;1m20 | [0m[35m        message = Defaults().yellow(message)[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m                        found_key = found_key[0] if len(found_key) == 1 else found_key[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m                        if isinstance(found_key, dict):[0m
[30;1m290 | [0m[35m                            found_value.append(match.get(found_key, something, found_key))[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m            if isinstance(found_value, dict) and 'constant_value' in found_value:[0m
[30;1m293 | [0m[35m                found_value = found_value['constant_value'][0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m                            if found_key:[0m
[30;1m280 | [0m[35m                                found_key = found_key[0][0m
[30;1m281 | [0m[35m                                found_value = value.get('value')[0m
[30;1m282 | [0m[35m                                break[0m
[30;1m283 | [0m[35m                    elif isinstance(value, list):[0m
[30;1m284 | [0m[35m                        found_key, found_value = it_has_something(_step_obj, something, value)[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m                    found_key = found_key[0] if len(found_key) == 1 and match.contains(found_key[0],[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m                    if isinstance(found_key, dict):[0m
[30;1m263 | [0m[35m                        found_value = match.get(found_key, something, found_key)[0m
[30;1m264 | [0m[35m                    else:[0m
[30;1m265 | [0m[35m                        found_value = found_key[0m
[30;1m266 | [0m[35m            elif isinstance(values, list):[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m            found_value = Null[0m
[30;1m251 | [0m[35m            found_key = Null[0m
[30;1m252 | [0m[35m            if isinstance(values, dict):[0m
[30;1m253 | [0m[35m                found_key = match.get(values, something, Null)[0m
[30;1m254 | [0m[35m                if found_key is not Null:[0m
[30;1m255 | [0m[35m                    found_key = [{something: found_key}][0m
[30;1m256 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m                            'address': resource,[0m
[30;1m244 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m247 | [0m[35m            if not values:[0m
[30;1m248 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m                            'address': resource,[0m
[30;1m244 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m247 | [0m[35m            if not values:[0m
[30;1m248 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m                prop_list.extend(values)[0m
[30;1m212 | [0m[35m                _step_obj.context.property_name = something[0m
[30;1m213 | [0m[35m                _step_obj.context.address = '{}.{}'.format(provider_data.get('name', _step_obj.conte[0m
[30;1m214 | [0m[35m                                                           provider_data.get('alias', "\b"))[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m        if prop_list:[0m
[30;1m217 | [0m[35m            _step_obj.context.stash = prop_list[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m            if values:[0m
[30;1m211 | [0m[35m                prop_list.extend(values)[0m
[30;1m212 | [0m[35m                _step_obj.context.property_name = something[0m
[30;1m213 | [0m[35m                _step_obj.context.address = '{}.{}'.format(provider_data.get('name', _step_obj.conte[0m
[30;1m214 | [0m[35m                                                           provider_data.get('alias', "\b"))[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m        if prop_list:[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m                        found_key = found_key[0] if len(found_key) == 1 else found_key[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m                        if isinstance(found_key, dict):[0m
[30;1m186 | [0m[35m                            found_value.append(match.get(found_key, something, found_key))[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m            if isinstance(found_value, dict) and 'constant_value' in found_value:[0m
[30;1m189 | [0m[35m                found_value = found_value['constant_value'][0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m                            if found_key:[0m
[30;1m173 | [0m[35m                                found_key = found_key[0][0m
[30;1m174 | [0m[35m                                found_value = value.get('value')[0m
[30;1m175 | [0m[35m                                break[0m
[30;1m176 | [0m[35m                    elif isinstance(value, list):[0m
[30;1m177 | [0m[35m                        found_key, found_value = it_has_something(_step_obj, something, value)[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m                    found_key = found_key[0] if len(found_key) == 1 and match.contains(found_key[0],[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m                    if isinstance(found_key, dict):[0m
[30;1m156 | [0m[35m                        found_value = match.get(found_key, something, found_key)[0m
[30;1m157 | [0m[35m                    else:[0m
[30;1m158 | [0m[35m                        found_value = found_key[0m
[30;1m159 | [0m[35m            elif isinstance(values, list):[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m            found_value = Null[0m
[30;1m144 | [0m[35m            found_key = Null[0m
[30;1m145 | [0m[35m            if isinstance(values, dict):[0m
[30;1m146 | [0m[35m                found_key = match.get(values, something, Null)[0m
[30;1m147 | [0m[35m                if found_key is not Null:[0m
[30;1m148 | [0m[35m                    found_key = [{something: found_key}][0m
[30;1m149 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                            'address': resource,[0m
[30;1m137 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m140 | [0m[35m            if not values:[0m
[30;1m141 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                            'address': resource,[0m
[30;1m137 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m140 | [0m[35m            if not values:[0m
[30;1m141 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m                _step_obj.context.stash = values[0m
[30;1m108 | [0m[35m                _step_obj.context.property_name = something[0m
[30;1m109 | [0m[35m                _step_obj.context.address = '{}.{}'.format(provider_data.get('name', _step_obj.conte[0m
[30;1m110 | [0m[35m                                                           provider_data.get('alias', "\b"))[0m
[30;1m111 | [0m[35m                return True[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    if _step_obj.state != Step.State.FAILED:[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m            if values:[0m
[30;1m107 | [0m[35m                _step_obj.context.stash = values[0m
[30;1m108 | [0m[35m                _step_obj.context.property_name = something[0m
[30;1m109 | [0m[35m                _step_obj.context.address = '{}.{}'.format(provider_data.get('name', _step_obj.conte[0m
[30;1m110 | [0m[35m                                                           provider_data.get('alias', "\b"))[0m
[30;1m111 | [0m[35m                return True[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m                        found_key = found_key[0] if len(found_key) == 1 else found_key[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m                        if isinstance(found_key, dict):[0m
[30;1m80 | [0m[35m                            found_value.append(match.get(found_key, something, found_key))[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m            if isinstance(found_value, dict) and 'constant_value' in found_value:[0m
[30;1m83 | [0m[35m                found_value = found_value['constant_value'][0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m                            if found_key:[0m
[30;1m70 | [0m[35m                                found_key = found_key[0][0m
[30;1m71 | [0m[35m                                found_value = value.get('value')[0m
[30;1m72 | [0m[35m                                break[0m
[30;1m73 | [0m[35m                    elif isinstance(value, list):[0m
[30;1m74 | [0m[35m                        found_key, found_value = it_contains_something_old(_step_obj, something, val[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m                    found_key = found_key[0] if len(found_key) == 1 and match.contains(found_key[0],[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m                    if isinstance(found_key, dict):[0m
[30;1m53 | [0m[35m                        found_value = match.get(found_key, something, found_key)[0m
[30;1m54 | [0m[35m                    else:[0m
[30;1m55 | [0m[35m                        found_value = found_key[0m
[30;1m56 | [0m[35m            elif isinstance(values, list):[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m            found_value = Null[0m
[30;1m43 | [0m[35m            found_key = Null[0m
[30;1m44 | [0m[35m            if isinstance(values, dict):[0m
[30;1m45 | [0m[35m                found_key = match.get(values, something, seek_key_in_dict(values, something))[0m
[30;1m46 | [0m[35m                if not isinstance(found_key, list):[0m
[30;1m47 | [0m[35m                    found_key = [{something: found_key}][0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m                            'address': resource,[0m
[30;1m36 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m39 | [0m[35m            if not values:[0m
[30;1m40 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m                            'address': resource,[0m
[30;1m36 | [0m[35m                            'type': _step_obj.context.name}[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m            values = resource.get('values', resource.get('expressions', {}))[0m
[30;1m39 | [0m[35m            if not values:[0m
[30;1m40 | [0m[35m                values = seek_key_in_dict(resource, something)[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m        if _step_obj.state != Step.State.FAILED:[0m
[30;1m201 | [0m[35m            skip_step(_step_obj,[0m
[30;1m202 | [0m[35m                      resource=_step_obj.context.name,[0m
[30;1m203 | [0m[35m                      message='Can not find any {} property for {} resource in '[0m
[30;1m204 | [0m[35m                              'terraform plan.'.format(something, _step_obj.context.name))[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    elif _step_obj.context.type == 'provider':[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/it_contains_something.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m        if _step_obj.state != Step.State.FAILED:[0m
[30;1m97 | [0m[35m            skip_step(_step_obj,[0m
[30;1m98 | [0m[35m                      resource=_step_obj.context.name,[0m
[30;1m99 | [0m[35m                      message='Can not find any {} property for {} resource in '[0m
[30;1m100 | [0m[35m                              'terraform plan.'.format(something, _step_obj.context.name))[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    elif _step_obj.context.type == 'provider':[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m        'provider_name': rule_obj.get('provider_name'),[0m
[30;1m318 | [0m[35m        'values': {[0m
[30;1m319 | [0m[35m            'description': rule_obj['values'].get('decription'),[0m
[30;1m320 | [0m[35m            'name': '{}'.format(rule_obj.get('address')),[0m
[30;1m321 | [0m[35m            rule_obj['values']['type']: [[0m
[30;1m322 | [0m[35m                {[0m
[30;1m323 | [0m[35m                    'cidr_blocks': rule_obj['values']['cidr_blocks'],[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m        'name': '{}'.format(rule_obj.get('address')),[0m
[30;1m317 | [0m[35m        'provider_name': rule_obj.get('provider_name'),[0m
[30;1m318 | [0m[35m        'values': {[0m
[30;1m319 | [0m[35m            'description': rule_obj['values'].get('decription'),[0m
[30;1m320 | [0m[35m            'name': '{}'.format(rule_obj.get('address')),[0m
[30;1m321 | [0m[35m            rule_obj['values']['type']: [[0m
[30;1m322 | [0m[35m                {[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m        'mode': 'managed',[0m
[30;1m315 | [0m[35m        'type': 'aws_security_group',[0m
[30;1m316 | [0m[35m        'name': '{}'.format(rule_obj.get('address')),[0m
[30;1m317 | [0m[35m        'provider_name': rule_obj.get('provider_name'),[0m
[30;1m318 | [0m[35m        'values': {[0m
[30;1m319 | [0m[35m            'description': rule_obj['values'].get('decription'),[0m
[30;1m320 | [0m[35m            'name': '{}'.format(rule_obj.get('address')),[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m        'address': '{}'.format(rule_obj.get('address')),[0m
[30;1m314 | [0m[35m        'mode': 'managed',[0m
[30;1m315 | [0m[35m        'type': 'aws_security_group',[0m
[30;1m316 | [0m[35m        'name': '{}'.format(rule_obj.get('address')),[0m
[30;1m317 | [0m[35m        'provider_name': rule_obj.get('provider_name'),[0m
[30;1m318 | [0m[35m        'values': {[0m
[30;1m319 | [0m[35m            'description': rule_obj['values'].get('decription'),[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m310 | [0m[35m        return False[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m    return {[0m
[30;1m313 | [0m[35m        'address': '{}'.format(rule_obj.get('address')),[0m
[30;1m314 | [0m[35m        'mode': 'managed',[0m
[30;1m315 | [0m[35m        'type': 'aws_security_group',[0m
[30;1m316 | [0m[35m        'name': '{}'.format(rule_obj.get('address')),[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35mdef convert_single_rule_to_a_sg(rule_obj):[0m
[30;1m309 | [0m[35m    if not rule_obj.get('values'):[0m
[30;1m310 | [0m[35m        return False[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m    return {[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m        self.multiple_check = False[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        self.given_rule = SecurityGroupRule(**given_reqs)[0m
[30;1m133 | [0m[35m        self.plan_rules = [SecurityGroupRule(**rule_data) for rule_data in self.sgs if rule_data.get[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        self.found_ports = set()[0m
[30;1m136 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m
[30;1m20 | [0m[35m        self.port_is_single = False[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m        self._normalise_protocols()[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m
[30;1m20 | [0m[35m        self.port_is_single = False[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m        self._normalise_protocols()[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m
[30;1m20 | [0m[35m        self.port_is_single = False[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m
[30;1m20 | [0m[35m        self.port_is_single = False[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m
[30;1m20 | [0m[35m        self.port_is_single = False[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m
[30;1m20 | [0m[35m        self.port_is_single = False[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m
[30;1m20 | [0m[35m        self.port_is_single = False[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m
[30;1m19 | [0m[35m        self.description = kwargs.get('description', kwargs.get('values', {}). get('description'))[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m
[30;1m18 | [0m[35m        self.address = kwargs.get('values', {}).get('address')[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35mclass SecurityGroupRule(object):[0m
[30;1m12 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35mclass SecurityGroupRule(object):[0m
[30;1m12 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35mclass SecurityGroupRule(object):[0m
[30;1m12 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m
[30;1m17 | [0m[35m        self.cidr_blocks = kwargs.get('cidr_blocks', kwargs.get('values', {}).get('cidr_blocks', [])[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mclass SecurityGroupRule(object):[0m
[30;1m12 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mclass SecurityGroupRule(object):[0m
[30;1m12 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mclass SecurityGroupRule(object):[0m
[30;1m12 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m13 | [0m[35m        self.from_port = kwargs.get('from_port', kwargs.get('values', {}).get('from_port'))[0m
[30;1m14 | [0m[35m        self.to_port = kwargs.get('to_port', kwargs.get('values', {}).get('to_port'))[0m
[30;1m15 | [0m[35m        self.ports = str(kwargs.get('port'))[0m
[30;1m16 | [0m[35m        self.protocol = [proto for proto in [kwargs.get('protocol', kwargs.get('values', {}).get('pr[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/security_groups.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m232 | [0m[35m                                               e['address']))[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m            # If the scenario is 'must have', then given ports must be a subset (or equal) of ports_[0m
[30;1m235 | [0m[35m            # If not, found which ports are missing via GIVEN->FOUND diff[0m
[30;1m236 | [0m[35m            else:[0m
[30;1m237 | [0m[35m                if self.given_rule.ports <= ports_found:[0m
[30;1m238 | [0m[35m                    return True, None[0m
[30;1m239 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m        return self.cache.add(bytes(key, encoding='utf8'), value)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    def get(self, key):[0m
[30;1m13 | [0m[35m        return self.cache.get(bytes(key, encoding='utf8'))[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    def delete(self, key):[0m
[30;1m16 | [0m[35m        del self.cache[bytes(key, encoding='utf8')][0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_metadata_has_something.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m    found_list = [][0m
[30;1m13 | [0m[35m    for resource in _step_obj.context.stash:[0m
[30;1m14 | [0m[35m        # document this behavior[0m
[30;1m15 | [0m[35m        key_metadata = match.get(resource, key, default={})[0m
[30;1m16 | [0m[35m        if not isinstance(key_metadata, (list, dict, set)):[0m
[30;1m17 | [0m[35m            key_metadata = [key_metadata][0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/its_key_metadata_has_something.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    if not found_list:[0m
[30;1m29 | [0m[35m        if has_step:[0m
[30;1m30 | [0m[35m            skip_step(_step_obj, message='Could not find "{}" in "{}" metadata.'.format(value, key))[0m
[30;1m31 | [0m[35m        if not has_step:[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mproperty_match_list = {[0m
[30;1m2 | [0m[35m    'encryption at rest': {[0m
[30;1m3 | [0m[35m        'aws_db_instance': 'storage_encrypted',[0m
[30;1m4 | [0m[35m        'ebs_block_device': 'encrypted',[0m
[30;1m5 | [0m[35m        'aws_ebs_volume': 'encrypted',[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_key_condition_be_value.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m found_values = [][0m
[30;1m32 | [0m[35m    for entity in stash:[0m
[30;1m33 | [0m[35m        if isinstance(entity, dict):[0m
[30;1m34 | [0m[35m            found_value = seek_regex_key_in_dict_values(entity, key, value)[0m
[30;1m35 | [0m[35m            if not found_value and condition:[0m
[30;1m36 | [0m[35m                Error(_step_obj, 'Can not find {} in {} property of {}.'.format(value, key, match.ge[0m
[30;1m37 | [0m[35m                Error(_step_obj, 'Can not find {} in {} property of {}.'.format(value, key, obj_addr[0m
[30;1m38 | [0m[35m            elif found_value and not condition:[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_key_condition_be_value.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m            if (match.equals(entity, key) or match.equals(entity, value)) and condition:[0m
[30;1m56 | [0m[35m                Error(_step_obj, 'Value {} found in {} property of {}, but is not in {{key: value}} [0m
[30;1m57 | [0m[35m            if condition:[0m
[30;1m58 | [0m[35m                Error(_step_obj, 'Can not find {} in {} property of {}.'.format(value, key, obj_addr[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    _step_obj.context.stash = found_values[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_key_condition_be_value.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m            dict_entity = {f'not_{str(key)}': entity}[0m
[30;1m45 | [0m[35m            found_value = seek_regex_key_in_dict_values(dict_entity, key, value)[0m
[30;1m46 | [0m[35m            if not found_value and condition:[0m
[30;1m47 | [0m[35m                Error(_step_obj, 'Can not find {} in {} property of {}.'.format(value, key, obj_addr[0m
[30;1m48 | [0m[35m            elif found_value and not condition:[0m
[30;1m49 | [0m[35m                Error(_step_obj, 'Found {}({}) in {} property of {}.'.format(value, ', '.join(found_[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_key_condition_be_value.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m            found_value = seek_regex_key_in_dict_values(entity, key, value)[0m
[30;1m35 | [0m[35m            if not found_value and condition:[0m
[30;1m36 | [0m[35m                Error(_step_obj, 'Can not find {} in {} property of {}.'.format(value, key, match.ge[0m
[30;1m37 | [0m[35m                Error(_step_obj, 'Can not find {} in {} property of {}.'.format(value, key, obj_addr[0m
[30;1m38 | [0m[35m            elif found_value and not condition:[0m
[30;1m39 | [0m[35m                Error(_step_obj, 'Found {}({}) in {} property of {}.'.format(value, ', '.join(found_[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_key_condition_be_value.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35mbj_address = ', '.join(_step_obj.context.addresses)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    found_values = [][0m
[30;1m32 | [0m[35m    for entity in stash:[0m
[30;1m33 | [0m[35m        if isinstance(entity, dict):[0m
[30;1m34 | [0m[35m            found_value = seek_regex_key_in_dict_values(entity, key, value)[0m
[30;1m35 | [0m[35m            if not found_value and condition:[0m
[30;1m36 | [0m[35m                Error(_step_obj, 'Can not find {} in {} property of {}.'.format(value, key, match.ge[0m
[30;1m37 | [0m[35m                Error(_step_obj, 'Can not find {} in {} property of {}.'.format(value, key, obj_addr[0m
[30;1m38 | [0m[35m            elif found_value and not condition:[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_be_null.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35mll_null and condition_must):[0m
[30;1m35 | [0m[35m                Error(_step_obj, 'Multivalued {} property in {} is considered to be {}. It is set to[0m
[30;1m36 | [0m[35m                                                                                                    [0m
[30;1m37 | [0m[35m                                                                                                    [0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_be_null.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m condition_must) or (not values_is_null and condition_must):[0m
[30;1m22 | [0m[35m            Error(_step_obj, '{} property in {} is considered to be {}. It is set to "{}".'.format(_[0m
[30;1m23 | [0m[35m                                                                                                   r[0m
[30;1m24 | [0m[35m                                                                                                   '[0m
[30;1m25 | [0m[35m                                                                                                   v[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_be_null.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m    is_null = lambda x: x in ([], {}, None, Null) or (isinstance(x, str) and match.regex_match(regex[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    for resource in _step_obj.context.stash:[0m
[30;1m18 | [0m[35m        values = resource.get('values', {})[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m        values_is_null = is_null(values)[0m
[30;1m21 | [0m[35m        if (values_is_null and not condition_must) or (not values_is_null and condition_must):[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m            # Check if this is a state file[0m
[30;1m79 | [0m[35m            if 'values' in data:[0m
[30;1m80 | [0m[35m                assert data['values']['root_module'].get('resources', data['values']['root_module'].[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m            # Then it must be a terraform plan file[0m
[30;1m83 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m            # Check if this is a state file[0m
[30;1m79 | [0m[35m            if 'values' in data:[0m
[30;1m80 | [0m[35m                assert data['values']['root_module'].get('resources', data['values']['root_module'].[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m            # Then it must be a terraform plan file[0m
[30;1m83 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m25 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m26 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m
[30;1m27 | [0m[35m        self.parser = kwargs.get('parser', None)[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def __call__(self, parser, namespace, values, option_string=None):[0m
[30;1m30 | [0m[35m        # Check if the given path is a file[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m24 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m25 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m26 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m
[30;1m27 | [0m[35m        self.parser = kwargs.get('parser', None)[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def __call__(self, parser, namespace, values, option_string=None):[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m23 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m24 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m25 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m26 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m
[30;1m27 | [0m[35m        self.parser = kwargs.get('parser', None)[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m22 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m23 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m24 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m25 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m26 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m
[30;1m27 | [0m[35m        self.parser = kwargs.get('parser', None)[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m21 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m22 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m23 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m24 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m25 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m26 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m        self.nargs = kwargs.get('nargs', None)[0m
[30;1m20 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m21 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m22 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m23 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m24 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m25 | [0m[35m        self.help = kwargs.get('help', None)[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        self.dest = dest[0m
[30;1m19 | [0m[35m        self.nargs = kwargs.get('nargs', None)[0m
[30;1m20 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m21 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m22 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m23 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m24 | [0m[35m        self.required = kwargs.get('required', None)[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m        self.option_strings = option_strings[0m
[30;1m18 | [0m[35m        self.dest = dest[0m
[30;1m19 | [0m[35m        self.nargs = kwargs.get('nargs', None)[0m
[30;1m20 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m21 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m22 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m23 | [0m[35m        self.choices = kwargs.get('choices', None)[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_plan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m        super(ReadablePlan, self).__init__(option_strings, dest, **kwargs)[0m
[30;1m17 | [0m[35m        self.option_strings = option_strings[0m
[30;1m18 | [0m[35m        self.dest = dest[0m
[30;1m19 | [0m[35m        self.nargs = kwargs.get('nargs', None)[0m
[30;1m20 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m21 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m22 | [0m[35m        self.type = kwargs.get('type', None)[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m    def _fetch_resource_by_a_variable(self, module, variable):[0m
[30;1m742 | [0m[35m        target_module = get_most_child_module(module)[0m
[30;1m743 | [0m[35m        stripped_variable = variable.replace('var.', '')[0m
[30;1m744 | [0m[35m        var = self.raw['configuration'].get('root_module', {}).get('module_calls', {}).get(target_mo[0m
[30;1m745 | [0m[35m        return var[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m    def _fetch_resource_by_a_variable(self, module, variable):[0m
[30;1m742 | [0m[35m        target_module = get_most_child_module(module)[0m
[30;1m743 | [0m[35m        stripped_variable = variable.replace('var.', '')[0m
[30;1m744 | [0m[35m        var = self.raw['configuration'].get('root_module', {}).get('module_calls', {}).get(target_mo[0m
[30;1m745 | [0m[35m        return var[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m    def _fetch_resource_by_a_variable(self, module, variable):[0m
[30;1m742 | [0m[35m        target_module = get_most_child_module(module)[0m
[30;1m743 | [0m[35m        stripped_variable = variable.replace('var.', '')[0m
[30;1m744 | [0m[35m        var = self.raw['configuration'].get('root_module', {}).get('module_calls', {}).get(target_mo[0m
[30;1m745 | [0m[35m        return var[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m    def _fetch_resource_by_a_variable(self, module, variable):[0m
[30;1m742 | [0m[35m        target_module = get_most_child_module(module)[0m
[30;1m743 | [0m[35m        stripped_variable = variable.replace('var.', '')[0m
[30;1m744 | [0m[35m        var = self.raw['configuration'].get('root_module', {}).get('module_calls', {}).get(target_mo[0m
[30;1m745 | [0m[35m        return var[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m    def _fetch_resource_by_a_variable(self, module, variable):[0m
[30;1m742 | [0m[35m        target_module = get_most_child_module(module)[0m
[30;1m743 | [0m[35m        stripped_variable = variable.replace('var.', '')[0m
[30;1m744 | [0m[35m        var = self.raw['configuration'].get('root_module', {}).get('module_calls', {}).get(target_mo[0m
[30;1m745 | [0m[35m        return var[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m    def _fetch_resource_by_a_variable(self, module, variable):[0m
[30;1m742 | [0m[35m        target_module = get_most_child_module(module)[0m
[30;1m743 | [0m[35m        stripped_variable = variable.replace('var.', '')[0m
[30;1m744 | [0m[35m        var = self.raw['configuration'].get('root_module', {}).get('module_calls', {}).get(target_mo[0m
[30;1m745 | [0m[35m        return var[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m708 | [0m[35m                    resources.append(resource)[0m
[30;1m709 | [0m[35m[0m
[30;1m710 | [0m[35m            # Dive deeper, its not finished yet.[0m
[30;1m711 | [0m[35m            if 'module_calls' in v.get('module', {}):[0m
[30;1m712 | [0m[35m                resources.extend(self.process_module_calls(v['module']['module_calls'], current_modu[0m
[30;1m713 | [0m[35m[0m
[30;1m714 | [0m[35m        return resources[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m701 | [0m[35m            module_source = v.get('source', '')[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m            # Register the resource (along with module naming)[0m
[30;1m704 | [0m[35m            if 'resources' in v.get('module', {}):[0m
[30;1m705 | [0m[35m                for resource in v['module']['resources']:[0m
[30;1m706 | [0m[35m                    resource['address'] = '{}.{}'.format(module_name, resource['address'])[0m
[30;1m707 | [0m[35m                    resource['source'] = module_source[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m698 | [0m[35m            current_module_level.append('module.{}'.format(k))[0m
[30;1m699 | [0m[35m            module_name = ".".join(current_module_level)[0m
[30;1m700 | [0m[35m            # Pull module's source to be later used in metadata[0m
[30;1m701 | [0m[35m            module_source = v.get('source', '')[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m            # Register the resource (along with module naming)[0m
[30;1m704 | [0m[35m            if 'resources' in v.get('module', {}):[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    def _expand_resource_tags(self, resource):[0m
[30;1m665 | [0m[35m        if isinstance((resource.get('values') or {}).get('tags'), list):[0m
[30;1m666 | [0m[35m            for tag in resource.get('values', {}).get('tags', {}):[0m
[30;1m667 | [0m[35m                if isinstance(tag, dict) and 'key' in tag and 'value' in tag:[0m
[30;1m668 | [0m[35m                    tag[tag['key']] = tag['value'][0m
[30;1m669 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    def _expand_resource_tags(self, resource):[0m
[30;1m665 | [0m[35m        if isinstance((resource.get('values') or {}).get('tags'), list):[0m
[30;1m666 | [0m[35m            for tag in resource.get('values', {}).get('tags', {}):[0m
[30;1m667 | [0m[35m                if isinstance(tag, dict) and 'key' in tag and 'value' in tag:[0m
[30;1m668 | [0m[35m                    tag[tag['key']] = tag['value'][0m
[30;1m669 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m662 | [0m[35m        return providers[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    def _expand_resource_tags(self, resource):[0m
[30;1m665 | [0m[35m        if isinstance((resource.get('values') or {}).get('tags'), list):[0m
[30;1m666 | [0m[35m            for tag in resource.get('values', {}).get('tags', {}):[0m
[30;1m667 | [0m[35m                if isinstance(tag, dict) and 'key' in tag and 'value' in tag:[0m
[30;1m668 | [0m[35m                    tag[tag['key']] = tag['value'][0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m662 | [0m[35m        return providers[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    def _expand_resource_tags(self, resource):[0m
[30;1m665 | [0m[35m        if isinstance((resource.get('values') or {}).get('tags'), list):[0m
[30;1m666 | [0m[35m            for tag in resource.get('values', {}).get('tags', {}):[0m
[30;1m667 | [0m[35m                if isinstance(tag, dict) and 'key' in tag and 'value' in tag:[0m
[30;1m668 | [0m[35m                    tag[tag['key']] = tag['value'][0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m656 | [0m[35m        '''[0m
[30;1m657 | [0m[35m        providers = [][0m
[30;1m658 | [0m[35m        for provider_alias, values in self.configuration['providers'].items():[0m
[30;1m659 | [0m[35m            if isinstance(values, dict) and match.equals(values.get('name'), provider_type):[0m
[30;1m660 | [0m[35m                providers.append(values)[0m
[30;1m661 | [0m[35m[0m
[30;1m662 | [0m[35m        return providers[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m613 | [0m[35m            # module.a["index_1"].b.c -> module.a.b.c[0m
[30;1m614 | [0m[35m            fixed_module_name = '.'.join([word.split('[')[0] for word in resource['address'].split('[0m
[30;1m615 | [0m[35m[0m
[30;1m616 | [0m[35m            if 'source' in self.configuration['resources'].get(fixed_module_name, ''):[0m
[30;1m617 | [0m[35m                resource['source'] = self.configuration['resources'][fixed_module_name]['source'][0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m560 | [0m[35m[0m
[30;1m561 | [0m[35m        cache_mounted_resources = self.cache.get('mounted_resources') if self.parse_it else None[0m
[30;1m562 | [0m[35m        cache_raw_resources = self.cache.get('resources_raw') if self.parse_it else None[0m
[30;1m563 | [0m[35m        cache_type_to_after_unknown_properties = self.cache.get('type_to_after_unknown_properties') [0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m        if cache_mounted_resources and cache_raw_resources:[0m
[30;1m566 | [0m[35m            # print('Read from cache, instead of re-mounting.')[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m559 | [0m[35m            self._parse_configurations()[0m
[30;1m560 | [0m[35m[0m
[30;1m561 | [0m[35m        cache_mounted_resources = self.cache.get('mounted_resources') if self.parse_it else None[0m
[30;1m562 | [0m[35m        cache_raw_resources = self.cache.get('resources_raw') if self.parse_it else None[0m
[30;1m563 | [0m[35m        cache_type_to_after_unknown_properties = self.cache.get('type_to_after_unknown_properties') [0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m        if cache_mounted_resources and cache_raw_resources:[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m558 | [0m[35m            self._parse_variables()[0m
[30;1m559 | [0m[35m            self._parse_configurations()[0m
[30;1m560 | [0m[35m[0m
[30;1m561 | [0m[35m        cache_mounted_resources = self.cache.get('mounted_resources') if self.parse_it else None[0m
[30;1m562 | [0m[35m        cache_raw_resources = self.cache.get('resources_raw') if self.parse_it else None[0m
[30;1m563 | [0m[35m        cache_type_to_after_unknown_properties = self.cache.get('type_to_after_unknown_properties') [0m
[30;1m564 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m                                merge_dicts(self.resources[t_r]['values'][key], value)[0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m                if ref_list:[0m
[30;1m506 | [0m[35m                    ref_type = self.configuration['resources'][resource]['expressions'].get('type', [0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m                    if 'references' in ref_type:[0m
[30;1m509 | [0m[35m                        ref_type = resource.split('.')[0][0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m498 | [0m[35m                    for t_r in target_resource:[0m
[30;1m499 | [0m[35m                        if self.resources[t_r].get('values') is None:[0m
[30;1m500 | [0m[35m                            continue[0m
[30;1m501 | [0m[35m                        if type(value) is type(self.resources[t_r]['values'].get(key)) and self.reso[0m
[30;1m502 | [0m[35m                            if isinstance(value, (list, dict)):[0m
[30;1m503 | [0m[35m                                merge_dicts(self.resources[t_r]['values'][key], value)[0m
[30;1m504 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m498 | [0m[35m                    for t_r in target_resource:[0m
[30;1m499 | [0m[35m                        if self.resources[t_r].get('values') is None:[0m
[30;1m500 | [0m[35m                            continue[0m
[30;1m501 | [0m[35m                        if type(value) is type(self.resources[t_r]['values'].get(key)) and self.reso[0m
[30;1m502 | [0m[35m                            if isinstance(value, (list, dict)):[0m
[30;1m503 | [0m[35m                                merge_dicts(self.resources[t_r]['values'][key], value)[0m
[30;1m504 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m496 | [0m[35m                        target_resource = [k for k in self.resources.keys() if k.startswith(resource[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m                    for t_r in target_resource:[0m
[30;1m499 | [0m[35m                        if self.resources[t_r].get('values') is None:[0m
[30;1m500 | [0m[35m                            continue[0m
[30;1m501 | [0m[35m                        if type(value) is type(self.resources[t_r]['values'].get(key)) and self.reso[0m
[30;1m502 | [0m[35m                            if isinstance(value, (list, dict)):[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m491 | [0m[35m                    # This is where we synchronise constant_value in the configuration section with [0m
[30;1m492 | [0m[35m                    # for filling up the missing elements that hasn't been defined in the resource d[0m
[30;1m493 | [0m[35m                    # implementation.[0m
[30;1m494 | [0m[35m                    target_resource = [t for t in [self.resources.get(resource, {}).get('address')] [0m
[30;1m495 | [0m[35m                    if not target_resource:[0m
[30;1m496 | [0m[35m                        target_resource = [k for k in self.resources.keys() if k.startswith(resource[0m
[30;1m497 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m491 | [0m[35m                    # This is where we synchronise constant_value in the configuration section with [0m
[30;1m492 | [0m[35m                    # for filling up the missing elements that hasn't been defined in the resource d[0m
[30;1m493 | [0m[35m                    # implementation.[0m
[30;1m494 | [0m[35m                    target_resource = [t for t in [self.resources.get(resource, {}).get('address')] [0m
[30;1m495 | [0m[35m                    if not target_resource:[0m
[30;1m496 | [0m[35m                        target_resource = [k for k in self.resources.keys() if k.startswith(resource[0m
[30;1m497 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m                    valid_references = [][0m
[30;1m431 | [0m[35m                    for ref in references:[0m
[30;1m432 | [0m[35m                        if isinstance(ref, dict) and ref.get('references'):[0m
[30;1m433 | [0m[35m                            valid_references = [][0m
[30;1m434 | [0m[35m                            for r in ref['references']:[0m
[30;1m435 | [0m[35m                                if r.startswith('var'):[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            output_value = module.get('module', {}).get('outputs', {}).get(output_id, {})[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m            resources = output_value.get('expression', {}).get('references', []) if 'expression' in [0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m            resources = ['{}.{}.{}'.format(resource_type, module_name, res) for res in resources][0m
[30;1m394 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            output_value = module.get('module', {}).get('outputs', {}).get(output_id, {})[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m            resources = output_value.get('expression', {}).get('references', []) if 'expression' in [0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m            resources = ['{}.{}.{}'.format(resource_type, module_name, res) for res in resources][0m
[30;1m394 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            output_value = module.get('module', {}).get('outputs', {}).get(output_id, {})[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m            resources = output_value.get('expression', {}).get('references', []) if 'expression' in [0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m            resources = ['{}.{}.{}'.format(resource_type, module_name, res) for res in resources][0m
[30;1m394 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m            module_name, output_id = resource_name.split('.')[1:3][0m
[30;1m387 | [0m[35m            module = self.raw['configuration']['root_module'].get('module_calls', {}).get(module_nam[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            output_value = module.get('module', {}).get('outputs', {}).get(output_id, {})[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m            resources = output_value.get('expression', {}).get('references', []) if 'expression' in [0m
[30;1m392 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m            module_name, output_id = resource_name.split('.')[1:3][0m
[30;1m387 | [0m[35m            module = self.raw['configuration']['root_module'].get('module_calls', {}).get(module_nam[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            output_value = module.get('module', {}).get('outputs', {}).get(output_id, {})[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m            resources = output_value.get('expression', {}).get('references', []) if 'expression' in [0m
[30;1m392 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m            module_name, output_id = resource_name.split('.')[1:3][0m
[30;1m387 | [0m[35m            module = self.raw['configuration']['root_module'].get('module_calls', {}).get(module_nam[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            output_value = module.get('module', {}).get('outputs', {}).get(output_id, {})[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m            resources = output_value.get('expression', {}).get('references', []) if 'expression' in [0m
[30;1m392 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m            # TODO: This wont work correctly, if an output is used within a module, coming from anot[0m
[30;1m385 | [0m[35m            #       Fix multi-layer module structure for the outputs ?[0m
[30;1m386 | [0m[35m            module_name, output_id = resource_name.split('.')[1:3][0m
[30;1m387 | [0m[35m            module = self.raw['configuration']['root_module'].get('module_calls', {}).get(module_nam[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            output_value = module.get('module', {}).get('outputs', {}).get(output_id, {})[0m
[30;1m390 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m            # TODO: This wont work correctly, if an output is used within a module, coming from anot[0m
[30;1m385 | [0m[35m            #       Fix multi-layer module structure for the outputs ?[0m
[30;1m386 | [0m[35m            module_name, output_id = resource_name.split('.')[1:3][0m
[30;1m387 | [0m[35m            module = self.raw['configuration']['root_module'].get('module_calls', {}).get(module_nam[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            output_value = module.get('module', {}).get('outputs', {}).get(output_id, {})[0m
[30;1m390 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m289 | [0m[35m        '''[0m
[30;1m290 | [0m[35m        for source_resource in source:[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m            if 'values' not in self.resources.get(source_resource, {}):[0m
[30;1m293 | [0m[35m                continue[0m
[30;1m294 | [0m[35m            for parameter, target_resources in target.items():[0m
[30;1m295 | [0m[35m                for target_resource in target_resources:[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m        # Outputs[0m
[30;1m246 | [0m[35m        self.configuration['outputs'] = {}[0m
[30;1m247 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('configuration', {}), 'outputs'):[0m
[30;1m248 | [0m[35m            for key, value in findings.get('outputs', {}).items():[0m
[30;1m249 | [0m[35m                tmp_output = dict(address=key, value={})[0m
[30;1m250 | [0m[35m                if 'expression' in value:[0m
[30;1m251 | [0m[35m                    if 'references' in value['expression']:[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        # Outputs[0m
[30;1m246 | [0m[35m        self.configuration['outputs'] = {}[0m
[30;1m247 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('configuration', {}), 'outputs'):[0m
[30;1m248 | [0m[35m            for key, value in findings.get('outputs', {}).items():[0m
[30;1m249 | [0m[35m                tmp_output = dict(address=key, value={})[0m
[30;1m250 | [0m[35m                if 'expression' in value:[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m        # Providers[0m
[30;1m241 | [0m[35m        self.configuration['providers'] = {}[0m
[30;1m242 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('configuration', {}), 'provider_config'):[0m
[30;1m243 | [0m[35m            self.configuration['providers'] = findings.get('provider_config', {})[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        # Outputs[0m
[30;1m246 | [0m[35m        self.configuration['outputs'] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m        # Providers[0m
[30;1m241 | [0m[35m        self.configuration['providers'] = {}[0m
[30;1m242 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('configuration', {}), 'provider_config'):[0m
[30;1m243 | [0m[35m            self.configuration['providers'] = findings.get('provider_config', {})[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        # Outputs[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m        # Variables[0m
[30;1m236 | [0m[35m        self.configuration['variables'] = {}[0m
[30;1m237 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('configuration', {}).get('root_module', {}), '[0m
[30;1m238 | [0m[35m            self.configuration['variables'] = findings.get('variables')[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m        # Providers[0m
[30;1m241 | [0m[35m        self.configuration['providers'] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m        # Variables[0m
[30;1m236 | [0m[35m        self.configuration['variables'] = {}[0m
[30;1m237 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('configuration', {}).get('root_module', {}), '[0m
[30;1m238 | [0m[35m            self.configuration['variables'] = findings.get('variables')[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m        # Providers[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m        # Variables[0m
[30;1m236 | [0m[35m        self.configuration['variables'] = {}[0m
[30;1m237 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('configuration', {}).get('root_module', {}), '[0m
[30;1m238 | [0m[35m            self.configuration['variables'] = findings.get('variables')[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m        # Providers[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        resources = self.raw.get('configuration', {}).get('root_module', {}).get('resources', [])[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Append module resources[0m
[30;1m225 | [0m[35m        resources.extend(self.process_module_calls(self.raw.get('configuration', {}).get('root_modul[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m        remove_constant_values(resources)[0m
[30;1m228 | [0m[35m        for resource in resources:[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        resources = self.raw.get('configuration', {}).get('root_module', {}).get('resources', [])[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Append module resources[0m
[30;1m225 | [0m[35m        resources.extend(self.process_module_calls(self.raw.get('configuration', {}).get('root_modul[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m        remove_constant_values(resources)[0m
[30;1m228 | [0m[35m        for resource in resources:[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        resources = self.raw.get('configuration', {}).get('root_module', {}).get('resources', [])[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Append module resources[0m
[30;1m225 | [0m[35m        resources.extend(self.process_module_calls(self.raw.get('configuration', {}).get('root_modul[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m        remove_constant_values(resources)[0m
[30;1m228 | [0m[35m        for resource in resources:[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m        self.configuration['resources'] = {}[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m        # root resources[0m
[30;1m222 | [0m[35m        resources = self.raw.get('configuration', {}).get('root_module', {}).get('resources', [])[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Append module resources[0m
[30;1m225 | [0m[35m        resources.extend(self.process_module_calls(self.raw.get('configuration', {}).get('root_modul[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m        self.configuration['resources'] = {}[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m        # root resources[0m
[30;1m222 | [0m[35m        resources = self.raw.get('configuration', {}).get('root_module', {}).get('resources', [])[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Append module resources[0m
[30;1m225 | [0m[35m        resources.extend(self.process_module_calls(self.raw.get('configuration', {}).get('root_modul[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m        self.configuration['resources'] = {}[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m        # root resources[0m
[30;1m222 | [0m[35m        resources = self.raw.get('configuration', {}).get('root_module', {}).get('resources', [])[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Append module resources[0m
[30;1m225 | [0m[35m        resources.extend(self.process_module_calls(self.raw.get('configuration', {}).get('root_modul[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        # Read Cache[0m
[30;1m212 | [0m[35m        if self.parse_it:[0m
[30;1m213 | [0m[35m            cache = self.cache.get('configuration')[0m
[30;1m214 | [0m[35m            if cache:[0m
[30;1m215 | [0m[35m                self.configuration = cache[0m
[30;1m216 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m        # if resource doesn't have type field, try to extract it from address (ideally, this if neve[0m
[30;1m183 | [0m[35m        if not resource_type and 'address' in resource and resource['address']:[0m
[30;1m184 | [0m[35m            parsed_address = resource.get('address').split('.')[0m
[30;1m185 | [0m[35m            if parsed_address != 'module':[0m
[30;1m186 | [0m[35m                resource_type = parsed_address[0][0m
[30;1m187 | [0m[35m            elif len(parsed_address) >= 3:[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m        '''[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m        # get type[0m
[30;1m180 | [0m[35m        resource_type = resource.get('type', '')[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m        # if resource doesn't have type field, try to extract it from address (ideally, this if neve[0m
[30;1m183 | [0m[35m        if not resource_type and 'address' in resource and resource['address']:[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m            actions = change.get('actions', [])[0m
[30;1m156 | [0m[35m            if actions != ['delete']:[0m
[30;1m157 | [0m[35m                resource['values'] = change.get('after', {}) # dict_merge(change.get('after', {}), c[0m
[30;1m158 | [0m[35m                self.remember_after_unknown(resource, change.get('after_unknown', {}))[0m
[30;1m159 | [0m[35m                if 'change' in resource:[0m
[30;1m160 | [0m[35m                    del resource['change'][0m
[30;1m161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m            change = resource.get('change', {})[0m
[30;1m155 | [0m[35m            actions = change.get('actions', [])[0m
[30;1m156 | [0m[35m            if actions != ['delete']:[0m
[30;1m157 | [0m[35m                resource['values'] = change.get('after', {}) # dict_merge(change.get('after', {}), c[0m
[30;1m158 | [0m[35m                self.remember_after_unknown(resource, change.get('after_unknown', {}))[0m
[30;1m159 | [0m[35m                if 'change' in resource:[0m
[30;1m160 | [0m[35m                    del resource['change'][0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m            change = resource.get('change', {})[0m
[30;1m155 | [0m[35m            actions = change.get('actions', [])[0m
[30;1m156 | [0m[35m            if actions != ['delete']:[0m
[30;1m157 | [0m[35m                resource['values'] = change.get('after', {}) # dict_merge(change.get('after', {}), c[0m
[30;1m158 | [0m[35m                self.remember_after_unknown(resource, change.get('after_unknown', {}))[0m
[30;1m159 | [0m[35m                if 'change' in resource:[0m
[30;1m160 | [0m[35m                    del resource['change'][0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m            change = resource.get('change', {})[0m
[30;1m155 | [0m[35m            actions = change.get('actions', [])[0m
[30;1m156 | [0m[35m            if actions != ['delete']:[0m
[30;1m157 | [0m[35m                resource['values'] = change.get('after', {}) # dict_merge(change.get('after', {}), c[0m
[30;1m158 | [0m[35m                self.remember_after_unknown(resource, change.get('after_unknown', {}))[0m
[30;1m159 | [0m[35m                if 'change' in resource:[0m
[30;1m160 | [0m[35m                    del resource['change'][0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        for finding in self.raw.get('resource_changes', {}):[0m
[30;1m153 | [0m[35m            resource = deepcopy(finding)[0m
[30;1m154 | [0m[35m            change = resource.get('change', {})[0m
[30;1m155 | [0m[35m            actions = change.get('actions', [])[0m
[30;1m156 | [0m[35m            if actions != ['delete']:[0m
[30;1m157 | [0m[35m                resource['values'] = change.get('after', {}) # dict_merge(change.get('after', {}), c[0m
[30;1m158 | [0m[35m                self.remember_after_unknown(resource, change.get('after_unknown', {}))[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m        # Resource Changes ( exists in Plan )[0m
[30;1m152 | [0m[35m        for finding in self.raw.get('resource_changes', {}):[0m
[30;1m153 | [0m[35m            resource = deepcopy(finding)[0m
[30;1m154 | [0m[35m            change = resource.get('change', {})[0m
[30;1m155 | [0m[35m            actions = change.get('actions', [])[0m
[30;1m156 | [0m[35m            if actions != ['delete']:[0m
[30;1m157 | [0m[35m                resource['values'] = change.get('after', {}) # dict_merge(change.get('after', {}), c[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        # Resource Changes ( exists in Plan )[0m
[30;1m152 | [0m[35m        for finding in self.raw.get('resource_changes', {}):[0m
[30;1m153 | [0m[35m            resource = deepcopy(finding)[0m
[30;1m154 | [0m[35m            change = resource.get('change', {})[0m
[30;1m155 | [0m[35m            actions = change.get('actions', [])[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m        # Child Modules Resources ( exists in State )[0m
[30;1m144 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('values', {}).get('root_module', {}), 'child_m[0m
[30;1m145 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m146 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m147 | [0m[35m                    self.data[resource['address']] = resource[0m
[30;1m148 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m        # Child Modules Resources ( exists in State )[0m
[30;1m144 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('values', {}).get('root_module', {}), 'child_m[0m
[30;1m145 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m146 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m147 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m        # Child Modules Resources ( exists in State )[0m
[30;1m144 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('values', {}).get('root_module', {}), 'child_m[0m
[30;1m145 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m146 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m147 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        # Resources ( exists in Prior State )[0m
[30;1m136 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('prior_state', {}).get('values', {}).get('root[0m
[30;1m137 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m138 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m139 | [0m[35m                    self.data[resource['address']] = resource[0m
[30;1m140 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        # Resources ( exists in Prior State )[0m
[30;1m136 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('prior_state', {}).get('values', {}).get('root[0m
[30;1m137 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m138 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m139 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        # Resources ( exists in Prior State )[0m
[30;1m136 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('prior_state', {}).get('values', {}).get('root[0m
[30;1m137 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m138 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m139 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        # Resources ( exists in Prior State )[0m
[30;1m136 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('prior_state', {}).get('values', {}).get('root[0m
[30;1m137 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m138 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m139 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        # Resources ( exists in Prior State )[0m
[30;1m136 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('prior_state', {}).get('values', {}).get('root[0m
[30;1m137 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m138 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m139 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        # Resources ( exists in State )[0m
[30;1m128 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('values', {}).get('root_module', {}), 'resourc[0m
[30;1m129 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m130 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m131 | [0m[35m                    self.data[resource['address']] = resource[0m
[30;1m132 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        # Resources ( exists in State )[0m
[30;1m128 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('values', {}).get('root_module', {}), 'resourc[0m
[30;1m129 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m130 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m131 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m                    self.resources[resource['address']] = resource[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        # Resources ( exists in State )[0m
[30;1m128 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('values', {}).get('root_module', {}), 'resourc[0m
[30;1m129 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m130 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m131 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        # Resources ( exists in Plan )[0m
[30;1m120 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('planned_values', {}).get('root_module', {}), [0m
[30;1m121 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m122 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m123 | [0m[35m                    self.data[resource['address']] = resource[0m
[30;1m124 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m                return[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        # Resources ( exists in Plan )[0m
[30;1m120 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('planned_values', {}).get('root_module', {}), [0m
[30;1m121 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m122 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m123 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m                return[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        # Resources ( exists in Plan )[0m
[30;1m120 | [0m[35m        for findings in seek_key_in_dict(self.raw.get('planned_values', {}).get('root_module', {}), [0m
[30;1m121 | [0m[35m            for resource in findings.get('resources', []):[0m
[30;1m122 | [0m[35m                if self.is_type(resource, 'data'):[0m
[30;1m123 | [0m[35m                    self.data[resource['address']] = resource[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m        # Read Cache[0m
[30;1m113 | [0m[35m        if self.parse_it:[0m
[30;1m114 | [0m[35m            cache = self.cache.get('resources')[0m
[30;1m115 | [0m[35m            if cache:[0m
[30;1m116 | [0m[35m                self.resources = cache[0m
[30;1m117 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        :return: none[0m
[30;1m102 | [0m[35m        '''[0m
[30;1m103 | [0m[35m        self.variables = self.raw.get('variables', {})[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def _parse_resources(self):[0m
[30;1m106 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m568 | [0m[35m            self.resources_raw = cache_raw_resources[0m
[30;1m569 | [0m[35m            self.type_to_after_unknown_properties = cache_type_to_after_unknown_properties[0m
[30;1m570 | [0m[35m        else:[0m
[30;1m571 | [0m[35m            # print('Building cache for mounted resources at {}'.format(Defaults.cache_dir))[0m
[30;1m572 | [0m[35m            self._mount_references()[0m
[30;1m573 | [0m[35m            # metadata related calls[0m
[30;1m574 | [0m[35m            self._add_action_status()[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m    def _mount_references(self):[0m
[30;1m410 | [0m[35m        '''[0m
[30;1m411 | [0m[35m        Find the references that is defined in self.configuration[0m
[30;1m412 | [0m[35m        :return:[0m
[30;1m413 | [0m[35m        '''[0m
[30;1m414 | [0m[35m        self.resources_raw = deepcopy(self.resources)[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/extensions/terraform.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m            return [resource_name][0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m        resource_list = [][0m
[30;1m355 | [0m[35m        # Try to find the resource with the module address in self.resources[0m
[30;1m356 | [0m[35m        if module_address is not None:[0m
[30;1m357 | [0m[35m            full_address = '{}.{}'.format(module_address, resource_name)[0m
[30;1m358 | [0m[35m            if full_address in self.resources:[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_match_the_search_regex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m    elif isinstance(resources, list):[0m
[30;1m133 | [0m[35m        for resource in resources:[0m
[30;1m134 | [0m[35m            if isinstance(resource, dict):[0m
[30;1m135 | [0m[35m                resource = resource.get('values', resource)[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m            if isinstance(resource, (dict, list)) and len(resource) > 1:[0m
[30;1m138 | [0m[35m                Error(_step_obj, '{} is multivalued! Please use any/all versions of this step instea[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_match_the_search_regex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    if not search(values):[0m
[30;1m118 | [0m[35m        _stash = get_resource_name_from_stash(_step_obj.context.stash, _stash, _step_obj.context.add[0m
[30;1m119 | [0m[35m        fail(condition, name=_stash.get('address'))[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35mdef its_singular_value_condition_match_the_search_regex_regex(_step_obj, condition, search_regex, _s[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_match_the_search_regex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m            if not hasattr(_step_obj.context, 'address'):[0m
[30;1m101 | [0m[35m                _step_obj.context.address = None[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m            _step_obj.context.address = values.get('address', _step_obj.context.address)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m            if 'values' in values:[0m
[30;1m106 | [0m[35m                return search(values['values'])[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_match_the_search_regex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m                its_value_condition_match_the_search_regex_regex(_step_obj,[0m
[30;1m56 | [0m[35m                                                                 condition,[0m
[30;1m57 | [0m[35m                                                                 search_regex,[0m
[30;1m58 | [0m[35m                                                                 values.get('values'))[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        else:[0m
[30;1m61 | [0m[35m            for key, value in values.items():[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_match_the_search_regex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m        if 'values' in values:[0m
[30;1m51 | [0m[35m            if values['values'] is None and regex == '\x00' and condition == 'must not':[0m
[30;1m52 | [0m[35m                values = values['values'][0m
[30;1m53 | [0m[35m                fail(condition, name=_stash.get('address'))[0m
[30;1m54 | [0m[35m            else:[0m
[30;1m55 | [0m[35m                its_value_condition_match_the_search_regex_regex(_step_obj,[0m
[30;1m56 | [0m[35m                                                                 condition,[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_match_the_search_regex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        if not hasattr(_step_obj.context, 'address'):[0m
[30;1m46 | [0m[35m            _step_obj.context.address = None[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        _step_obj.context.address = values.get('address', _step_obj.context.address)[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m        if 'values' in values:[0m
[30;1m51 | [0m[35m            if values['values'] is None and regex == '\x00' and condition == 'must not':[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_match_the_search_regex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        if (condition == 'must' and matches is None) or (condition == "must not" and matches is not [0m
[30;1m34 | [0m[35m            _stash = get_resource_name_from_stash(_step_obj.context.stash, _stash, _step_obj.context[0m
[30;1m35 | [0m[35m            fail(condition, name=_stash.get('address'))[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    elif isinstance(values, list):[0m
[30;1m38 | [0m[35m        for value in values:[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/interpolations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35m    addresses_flattened = [][0m
[30;1m7 | [0m[35m    for each in _step_obj.context.stash:[0m
[30;1m8 | [0m[35m        flattened_list.append(each.get('values', each))[0m
[30;1m9 | [0m[35m        addresses_flattened.append(each.get('address', each))[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    if flattened_list:[0m
[30;1m12 | [0m[35m        _step_obj.context.stash = {[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/interpolations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35m    flattened_list = [][0m
[30;1m6 | [0m[35m    addresses_flattened = [][0m
[30;1m7 | [0m[35m    for each in _step_obj.context.stash:[0m
[30;1m8 | [0m[35m        flattened_list.append(each.get('values', each))[0m
[30;1m9 | [0m[35m        addresses_flattened.append(each.get('address', each))[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    if flattened_list:[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/bdd_tags.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m    if _step_obj.context.no_failure and _step_obj.context.no_skip:[0m
[30;1m65 | [0m[35m        _step_obj.context.no_failure = False[0m
[30;1m66 | [0m[35m        _step_obj.context.bad_tags = True[0m
[30;1m67 | [0m[35m        Error(_step_obj, f'@{_step_obj.context.failure_class} and @{_step_obj.context.skip_class} ta[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    ## set the match here[0m
[30;1m70 | [0m[35m    case_sensitive = True if hasattr(_step_obj.context, 'case_insensitivity') and not _step_obj.cont[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/bdd_tags.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m                _step_obj.context.lines_to_noskip = [-1][0m
[30;1m31 | [0m[35m            # noskip[0m
[30;1m32 | [0m[35m            elif re.search(r'({})_at_lines?_.*'.format('|'.join(defaults.no_skip_tags)), tag.name.lo[0m
[30;1m33 | [0m[35m                # check for '@noskip at line x'[0m
[30;1m34 | [0m[35m                regex = r'({})_at_lines?((_\d*)*)'.format('|'.join(defaults.no_skip_tags))[0m
[30;1m35 | [0m[35m                [0m
[30;1m36 | [0m[35m                m = re.search(regex, tag.name.lower())[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/maths.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        if isinstance(_step_obj.context.address, list) and len(_step_obj.context.address) == 1:[0m
[30;1m62 | [0m[35m            _step_obj.context.address = _step_obj.context.address[0][0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        i_expect_the_result_is_operator_than_number(_step_obj, operator, number, values.get('values'[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    elif isinstance(values, (int, str)):[0m
[30;1m67 | [0m[35m        values = int(values)[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/maths.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    elif isinstance(values, dict):[0m
[30;1m58 | [0m[35m        _step_obj.context.property_name = values.get('type', _step_obj.context.property_name)[0m
[30;1m59 | [0m[35m        _step_obj.context.address = values.get('address', _step_obj.context.addresses)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        if isinstance(_step_obj.context.address, list) and len(_step_obj.context.address) == 1:[0m
[30;1m62 | [0m[35m            _step_obj.context.address = _step_obj.context.address[0][0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/maths.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m            i_expect_the_result_is_operator_than_number(_step_obj, operator, number, _stash=value_se[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    elif isinstance(values, dict):[0m
[30;1m58 | [0m[35m        _step_obj.context.property_name = values.get('type', _step_obj.context.property_name)[0m
[30;1m59 | [0m[35m        _step_obj.context.address = values.get('address', _step_obj.context.addresses)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        if isinstance(_step_obj.context.address, list) and len(_step_obj.context.address) == 1:[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/maths.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m                        _step_obj.context.stash = seek_key_in_dict(_step_obj.context.stash, 'values'[0m
[30;1m29 | [0m[35m                        count = 0[0m
[30;1m30 | [0m[35m                        for result in _step_obj.context.stash:[0m
[30;1m31 | [0m[35m                            count += len(result.get('values', {})) if result.get('values') and not i[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m                        _step_obj.context.stash = dict(values=count)[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/maths.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m                        _step_obj.context.stash = seek_key_in_dict(_step_obj.context.stash, 'values'[0m
[30;1m29 | [0m[35m                        count = 0[0m
[30;1m30 | [0m[35m                        for result in _step_obj.context.stash:[0m
[30;1m31 | [0m[35m                            count += len(result.get('values', {})) if result.get('values') and not i[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m                        _step_obj.context.stash = dict(values=count)[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/maths.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m                        _step_obj.context.stash = seek_key_in_dict(_step_obj.context.stash, 'values'[0m
[30;1m29 | [0m[35m                        count = 0[0m
[30;1m30 | [0m[35m                        for result in _step_obj.context.stash:[0m
[30;1m31 | [0m[35m                            count += len(result.get('values', {})) if result.get('values') and not i[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m                        _step_obj.context.stash = dict(values=count)[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/when/maths.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m            else:[0m
[30;1m26 | [0m[35m                if isinstance(_step_obj.context.stash[0], dict):[0m
[30;1m27 | [0m[35m                    if _step_obj.context.stash[0].get('values'):[0m
[30;1m28 | [0m[35m                        _step_obj.context.stash = seek_key_in_dict(_step_obj.context.stash, 'values'[0m
[30;1m29 | [0m[35m                        count = 0[0m
[30;1m30 | [0m[35m                        for result in _step_obj.context.stash:[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/property_is_enabled.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m            if not property_value:[0m
[30;1m28 | [0m[35m                Error(_step_obj, 'Resource {} does not have {} property enabled '[0m
[30;1m29 | [0m[35m                                 '({}={}).'.format(resource.get('address', "resource"),[0m
[30;1m30 | [0m[35m                                                   something,[0m
[30;1m31 | [0m[35m                                                   something,[0m
[30;1m32 | [0m[35m                                                   property_value))[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/property_is_enabled.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m                property_value = property_value[0][0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m                if isinstance(property_value, dict):[0m
[30;1m25 | [0m[35m                    property_value = match.get(property_value, something, Null)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m            if not property_value:[0m
[30;1m28 | [0m[35m                Error(_step_obj, 'Resource {} does not have {} property enabled '[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/property_is_enabled.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m            if match.contains(property_match_list, something):[0m
[30;1m17 | [0m[35m                something = match.get(match.get(property_match_list, something), resource['type'], s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m            property_value = seek_key_in_dict(match.get(resource, 'values', {}), something)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m            if len(property_value):[0m
[30;1m22 | [0m[35m                property_value = property_value[0][0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/property_is_enabled.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m    for resource in _step_obj.context.stash:[0m
[30;1m15 | [0m[35m        if isinstance(resource, dict):[0m
[30;1m16 | [0m[35m            if match.contains(property_match_list, something):[0m
[30;1m17 | [0m[35m                something = match.get(match.get(property_match_list, something), resource['type'], s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m            property_value = seek_key_in_dict(match.get(resource, 'values', {}), something)[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/property_is_enabled.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m    for resource in _step_obj.context.stash:[0m
[30;1m15 | [0m[35m        if isinstance(resource, dict):[0m
[30;1m16 | [0m[35m            if match.contains(property_match_list, something):[0m
[30;1m17 | [0m[35m                something = match.get(match.get(property_match_list, something), resource['type'], s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m            property_value = seek_key_in_dict(match.get(resource, 'values', {}), something)[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/terraform_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m        print('. Using {} as terraform executable.'.format(terraform_executable))[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    if terraform_executable is None:[0m
[30;1m40 | [0m[35m        sys.stderr.write('ERROR: Could not find "terraform" executable in PATH. Please either use "-[0m
[30;1m41 | [0m[35m                         'or add terraform executable to your PATH.\n')[0m
[30;1m42 | [0m[35m        sys.exit(1)[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/terrain.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m    resources = [][0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    for resource in step.context.stash:[0m
[30;1m98 | [0m[35m        address = resource.get('address', '')[0m
[30;1m99 | [0m[35m        if match.regex_match(resources_to_exclude, address) is None:[0m
[30;1m100 | [0m[35m            resources.append(resource)[0m
[30;1m101 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/terrain.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m                    query_result = [item for resource in temp_query_result for item in resource][0m
[30;1m71 | [0m[35m                    [0m
[30;1m72 | [0m[35m            else:[0m
[30;1m73 | [0m[35m                query_result = [match.get(resource, q) for resource in query_result if match.contain[0m
[30;1m74 | [0m[35m        [0m
[30;1m75 | [0m[35m        if matches.group(1) or matches.group(3):[0m
[30;1m76 | [0m[35m            if not all(isinstance(resource, (str, bool, int, float)) for resource in query_result):[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/terrain.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m124 | [0m[35m            embed()[0m
[30;1m125 | [0m[35m        elif cmd == 's':[0m
[30;1m126 | [0m[35m            print(json.dumps(step.context.stash, indent=4))[0m
[30;1m127 | [0m[35m        elif cmd != '':[0m
[30;1m128 | [0m[35m            print([0m
[30;1m129 | [0m[35m                """[0m
[30;1m130 | [0m[35mCommands[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/terrain.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m122 | [0m[35m        [0m
[30;1m123 | [0m[35m        if cmd == 'd':[0m
[30;1m124 | [0m[35m            embed()[0m
[30;1m125 | [0m[35m        elif cmd == 's':[0m
[30;1m126 | [0m[35m            print(json.dumps(step.context.stash, indent=4))[0m
[30;1m127 | [0m[35m        elif cmd != '':[0m
[30;1m128 | [0m[35m            print([0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/terrain.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m            print()[0m
[30;1m121 | [0m[35m            return[0m
[30;1m122 | [0m[35m        [0m
[30;1m123 | [0m[35m        if cmd == 'd':[0m
[30;1m124 | [0m[35m            embed()[0m
[30;1m125 | [0m[35m        elif cmd == 's':[0m
[30;1m126 | [0m[35m            print(json.dumps(step.context.stash, indent=4))[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/terrain.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m115 | [0m[35m    cmd = 'cmd'[0m
[30;1m116 | [0m[35m    while cmd != '':[0m
[30;1m117 | [0m[35m        try:[0m
[30;1m118 | [0m[35m            cmd = input(">> Press enter to continue")[0m
[30;1m119 | [0m[35m        except EOFError:[0m
[30;1m120 | [0m[35m            print()[0m
[30;1m121 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/terrain.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m        return[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    cmd = 'cmd'[0m
[30;1m116 | [0m[35m    while cmd != '':[0m
[30;1m117 | [0m[35m        try:[0m
[30;1m118 | [0m[35m            cmd = input(">> Press enter to continue")[0m
[30;1m119 | [0m[35m        except EOFError:[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/terrain.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m    if world.config.user_data['debugging_mode_enabled'] == 'False':[0m
[30;1m113 | [0m[35m        return[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    cmd = 'cmd'[0m
[30;1m116 | [0m[35m    while cmd != '':[0m
[30;1m117 | [0m[35m        try:[0m
[30;1m118 | [0m[35m            cmd = input(">> Press enter to continue")[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/error_handling.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        else:[0m
[30;1m32 | [0m[35m            self.exit_on_failure = literal_eval(world.config.user_data['exit_on_failure'])[0m
[30;1m33 | [0m[35m            self.no_failure = literal_eval(world.config.user_data['no_failure'])[0m
[30;1m34 | [0m[35m        _TFC_ERROR = os.environ.get('TFC_ERROR')[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        if step_obj.context.no_failure:[0m
[30;1m37 | [0m[35m            self.exception = type(step_obj.context.failure_class, (Exception, ), {})[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/main.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    python_version_check()[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    # SSH Key is given for git authentication[0m
[30;1m78 | [0m[35m    ssh_cmd = {}[0m
[30;1m79 | [0m[35m    if args.ssh_key:[0m
[30;1m80 | [0m[35m        ssh_cmd = {'GIT_SSH_COMMAND': 'ssh -l {} -i {}'.format('git', args.ssh_key)}[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/main.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    python_version_check()[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    # SSH Key is given for git authentication[0m
[30;1m78 | [0m[35m    ssh_cmd = {}[0m
[30;1m79 | [0m[35m    if args.ssh_key:[0m
[30;1m80 | [0m[35m        ssh_cmd = {'GIT_SSH_COMMAND': 'ssh -l {} -i {}'.format('git', args.ssh_key)}[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/main.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m    parser.add_argument('--silent', '-S', dest='silence', action='store_true',[0m
[30;1m63 | [0m[35m                        help='Do not output any scenarios, just write results or failures', required[0m
[30;1m64 | [0m[35m    parser.add_argument('--identity', '-i', dest='ssh_key', metavar='ssh private key', type=str, nar[0m
[30;1m65 | [0m[35m                        help='SSH Private key that will be use on git authentication.', required=Fal[0m
[30;1m66 | [0m[35m    parser.add_argument('--debug', '-d', dest='debug', action='store_true', help='Turns on debugging[0m
[30;1m67 | [0m[35m                        required=False)[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/main.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35mle', metavar='terraform_file', type=str, nargs='?',[0m
[30;1m53 | [0m[35m                        help='The absolute path to the terraform executable.', required=False)[0m
[30;1m54 | [0m[35m    parser.add_argument('--features', '-f', dest='features', metavar='feature directory', action=Rea[0m
[30;1m55 | [0m[35m                        help='Directory (or git repository with "git:" prefix) consists of BDD featu[0m
[30;1m56 | [0m[35m    parser.add_argument('--planfile', '-p', dest='plan_file', metavar='plan_file', action=ReadablePl[0m
[30;1m57 | [0m[35m                        help='Plan output file generated by Terraform', required=True)[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/main.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport atexit[0m
[30;1m5 | [0m[35mfrom argparse import ArgumentParser[0m
[30;1m6 | [0m[35mfrom tempfile import mkdtemp[0m
[30;1m7 | [0m[35mfrom git import Repo[0m
[30;1m8 | [0m[35mfrom terraform_compliance import __app_name__, __version__[0m
[30;1m9 | [0m[35mfrom terraform_compliance.common.readable_dir import ReadableDir[0m
[30;1m10 | [0m[35mfrom terraform_compliance.common.readable_plan import ReadablePlan[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m16 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m17 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m18 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    def __call__(self, parser, namespace, values, option_string=None):[0m
[30;1m21 | [0m[35m        prospective_dir = values[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m15 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m16 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m17 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m18 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    def __call__(self, parser, namespace, values, option_string=None):[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m14 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m15 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m16 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m17 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m18 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m13 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m14 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m15 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m16 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m17 | [0m[35m        self.help = kwargs.get('help', None)[0m
[30;1m18 | [0m[35m        self.metavar = kwargs.get('metavar', None)[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m        self.nargs = kwargs.get('nargs', None)[0m
[30;1m12 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m13 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m14 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m15 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m16 | [0m[35m        self.required = kwargs.get('required', None)[0m
[30;1m17 | [0m[35m        self.help = kwargs.get('help', None)[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m        self.dest = dest[0m
[30;1m11 | [0m[35m        self.nargs = kwargs.get('nargs', None)[0m
[30;1m12 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m13 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m14 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m15 | [0m[35m        self.choices = kwargs.get('choices', None)[0m
[30;1m16 | [0m[35m        self.required = kwargs.get('required', None)[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m        self.option_strings = option_strings[0m
[30;1m10 | [0m[35m        self.dest = dest[0m
[30;1m11 | [0m[35m        self.nargs = kwargs.get('nargs', None)[0m
[30;1m12 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m13 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m14 | [0m[35m        self.type = kwargs.get('type', None)[0m
[30;1m15 | [0m[35m        self.choices = kwargs.get('choices', None)[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35m        super(ReadableDir, self).__init__(option_strings, dest, **kwargs)[0m
[30;1m9 | [0m[35m        self.option_strings = option_strings[0m
[30;1m10 | [0m[35m        self.dest = dest[0m
[30;1m11 | [0m[35m        self.nargs = kwargs.get('nargs', None)[0m
[30;1m12 | [0m[35m        self.const = kwargs.get('const', None)[0m
[30;1m13 | [0m[35m        self.default = kwargs.get('default', None)[0m
[30;1m14 | [0m[35m        self.type = kwargs.get('type', None)[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m        # Check if the given directory is actually a git repo[0m
[30;1m24 | [0m[35m        if prospective_dir.startswith('git:'):[0m
[30;1m25 | [0m[35m            print('Using remote git repository: {}'.format(prospective_dir[4:]))[0m
[30;1m26 | [0m[35m            setattr(namespace, self.dest, prospective_dir[4:])[0m
[30;1m27 | [0m[35m            return True[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/common/readable_dir.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m    def __call__(self, parser, namespace, values, option_string=None):[0m
[30;1m21 | [0m[35m        prospective_dir = values[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m        # Check if the given directory is actually a git repo[0m
[30;1m24 | [0m[35m        if prospective_dir.startswith('git:'):[0m
[30;1m25 | [0m[35m            print('Using remote git repository: {}'.format(prospective_dir[4:]))[0m
[30;1m26 | [0m[35m            setattr(namespace, self.dest, prospective_dir[4:])[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_contain.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    elif not condition and found_values:[0m
[30;1m45 | [0m[35m        Error(_step_obj, '{} found in {}.'.format(value,[0m
[30;1m46 | [0m[35m                                                  get_resource_name_from_stash(found_values).get('ad[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    return values[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_contain.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m                objects.append(elem.get('address', '???'))[0m
[30;1m38 | [0m[35m            objects = ', '.join(objects)[0m
[30;1m39 | [0m[35m        else:[0m
[30;1m40 | [0m[35m            objects = values.get('address')[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m        Error(_step_obj, '{} could not found in {}.'.format(value, objects))[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_contain.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m        if isinstance(values, list):[0m
[30;1m35 | [0m[35m            objects = [][0m
[30;1m36 | [0m[35m            for elem in values:[0m
[30;1m37 | [0m[35m                objects.append(elem.get('address', '???'))[0m
[30;1m38 | [0m[35m            objects = ', '.join(objects)[0m
[30;1m39 | [0m[35m        else:[0m
[30;1m40 | [0m[35m            objects = values.get('address')[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m271[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/terraform_compliance/steps/then/its_value_condition_contain.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35m        raise TerraformComplianceNotImplemented('Condition should be one of: `must`, `must not`')[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    values = _step_obj.context.stash if _stash is EmptyStash else _stash[0m
[30;1m20 | [0m[35m    # TODO: Update here for checking values in a list or dict.[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    if isinstance(values, list):[0m
[30;1m23 | [0m[35m        for elem in values:[0m

271 matches found.
