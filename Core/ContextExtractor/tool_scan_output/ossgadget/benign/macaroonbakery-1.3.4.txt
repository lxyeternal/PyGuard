[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m709 | [0m[35m[0m
[30;1m710 | [0m[35m        m_id = json.loads(ms[0].identifier_bytes.decode('utf-8'))[0m
[30;1m711 | [0m[35m        root_key = self._root_key_store.get([0m
[30;1m712 | [0m[35m            base64.urlsafe_b64decode(m_id['id'].encode('utf-8')))[0m
[30;1m713 | [0m[35m[0m
[30;1m714 | [0m[35m        v = Verifier()[0m
[30;1m715 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m694 | [0m[35m[0m
[30;1m695 | [0m[35m    def new_macaroon(self, caveats, namespace, ops):[0m
[30;1m696 | [0m[35m        root_key, id = self._root_key_store.root_key()[0m
[30;1m697 | [0m[35m        m_id = {'id': base64.urlsafe_b64encode(id).decode('utf-8'), 'ops': ops}[0m
[30;1m698 | [0m[35m        data = json.dumps(m_id)[0m
[30;1m699 | [0m[35m        m = bakery.Macaroon([0m
[30;1m700 | [0m[35m            root_key=root_key, id=data, location='',[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mfrom collections import namedtuple[0m
[30;1m6 | [0m[35mfrom datetime import timedelta[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m914 | [0m[35m[0m
[30;1m915 | [0m[35mdef _basic_auth_from_context(ctx):[0m
[30;1m916 | [0m[35m    auth = ctx.get(_BASIC_AUTH_KEY, _BasicAuth('', ''))[0m
[30;1m917 | [0m[35m    return auth.user, auth.password[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m[0m
[30;1m920 | [0m[35mdef _macaroon_conditions(caveats, allow_third):[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m909 | [0m[35m[0m
[30;1m910 | [0m[35m[0m
[30;1m911 | [0m[35mdef _context_with_basic_auth(ctx, user, password):[0m
[30;1m912 | [0m[35m    return ctx.with_value(_BASIC_AUTH_KEY, _BasicAuth(user, password))[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m[0m
[30;1m915 | [0m[35mdef _basic_auth_from_context(ctx):[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m908 | [0m[35m        self.password = password[0m
[30;1m909 | [0m[35m[0m
[30;1m910 | [0m[35m[0m
[30;1m911 | [0m[35mdef _context_with_basic_auth(ctx, user, password):[0m
[30;1m912 | [0m[35m    return ctx.with_value(_BASIC_AUTH_KEY, _BasicAuth(user, password))[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m905 | [0m[35mclass _BasicAuth(object):[0m
[30;1m906 | [0m[35m    def __init__(self, user, password):[0m
[30;1m907 | [0m[35m        self.user = user[0m
[30;1m908 | [0m[35m        self.password = password[0m
[30;1m909 | [0m[35m[0m
[30;1m910 | [0m[35m[0m
[30;1m911 | [0m[35mdef _context_with_basic_auth(ctx, user, password):[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m905 | [0m[35mclass _BasicAuth(object):[0m
[30;1m906 | [0m[35m    def __init__(self, user, password):[0m
[30;1m907 | [0m[35m        self.user = user[0m
[30;1m908 | [0m[35m        self.password = password[0m
[30;1m909 | [0m[35m[0m
[30;1m910 | [0m[35m[0m
[30;1m911 | [0m[35mdef _context_with_basic_auth(ctx, user, password):[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m903 | [0m[35m[0m
[30;1m904 | [0m[35m[0m
[30;1m905 | [0m[35mclass _BasicAuth(object):[0m
[30;1m906 | [0m[35m    def __init__(self, user, password):[0m
[30;1m907 | [0m[35m        self.user = user[0m
[30;1m908 | [0m[35m        self.password = password[0m
[30;1m909 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m155 | [0m[35m        fp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m156 | [0m[35m            base64.b64decode([0m
[30;1m157 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m158 | [0m[35m        root_key = base64.b64decode(b'oqOXI3/Mz/pKjCuFOt2eYxb7ndLq66GY')[0m
[30;1m159 | [0m[35m        # This caveat has been generated from the go code[0m
[30;1m160 | [0m[35m        # to check the compatibilty[0m
[30;1m161 | [0m[35m        encrypted_cav = bakery.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m153 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m154 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m155 | [0m[35m        fp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m156 | [0m[35m            base64.b64decode([0m
[30;1m157 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m158 | [0m[35m        root_key = base64.b64decode(b'oqOXI3/Mz/pKjCuFOt2eYxb7ndLq66GY')[0m
[30;1m159 | [0m[35m        # This caveat has been generated from the go code[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    def test_decode_caveat_v3_from_go(self):[0m
[30;1m152 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m153 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m154 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m155 | [0m[35m        fp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m156 | [0m[35m            base64.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m128 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m129 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m130 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m131 | [0m[35m        root_key = base64.b64decode('wh0HSM65wWHOIxoGjgJJOFvQKn2jJFhC')[0m
[30;1m132 | [0m[35m        # This caveat has been generated from the go code[0m
[30;1m133 | [0m[35m        # to check the compatibilty[0m
[30;1m134 | [0m[35m        encrypted_cav = bakery.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m126 | [0m[35m            base64.b64decode([0m
[30;1m127 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m128 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m129 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m130 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m131 | [0m[35m        root_key = base64.b64decode('wh0HSM65wWHOIxoGjgJJOFvQKn2jJFhC')[0m
[30;1m132 | [0m[35m        # This caveat has been generated from the go code[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def test_decode_caveat_v2_from_go(self):[0m
[30;1m125 | [0m[35m        tp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m126 | [0m[35m            base64.b64decode([0m
[30;1m127 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m128 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m129 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m95 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m96 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m97 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m98 | [0m[35m        root_key = base64.b64decode('vDxEmWZEkgiNEFlJ+8ruXe3qDSLf1H+o')[0m
[30;1m99 | [0m[35m        # This caveat has been generated from the go code[0m
[30;1m100 | [0m[35m        # to check the compatibilty[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m96 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m97 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m98 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m99 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m100 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m101 | [0m[35m        root_key = base64.b64decode('vDxEmWZEkgiNEFlJ+8ruXe3qDSLf1H+o')[0m
[30;1m102 | [0m[35m        # This caveat has been generated from the go code[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def test_decode_caveat_v1_from_go(self):[0m
[30;1m92 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m93 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m94 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m95 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m96 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mfrom unittest import TestCase[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport macaroonbakery.bakery as bakery[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m153 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m154 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m155 | [0m[35m        fp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m156 | [0m[35m            base64.b64decode([0m
[30;1m157 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m158 | [0m[35m        root_key = base64.b64decode(b'oqOXI3/Mz/pKjCuFOt2eYxb7ndLq66GY')[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m153 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m154 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m155 | [0m[35m        fp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m156 | [0m[35m            base64.b64decode([0m
[30;1m157 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m158 | [0m[35m        root_key = base64.b64decode(b'oqOXI3/Mz/pKjCuFOt2eYxb7ndLq66GY')[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    def test_decode_caveat_v3_from_go(self):[0m
[30;1m152 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m153 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m154 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m155 | [0m[35m        fp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m156 | [0m[35m            base64.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m149 | [0m[35m        ))[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    def test_decode_caveat_v3_from_go(self):[0m
[30;1m152 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m153 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m154 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m155 | [0m[35m        fp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m            base64.b64decode([0m
[30;1m127 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m128 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m129 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m130 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m131 | [0m[35m        root_key = base64.b64decode('wh0HSM65wWHOIxoGjgJJOFvQKn2jJFhC')[0m
[30;1m132 | [0m[35m        # This caveat has been generated from the go code[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m        tp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m126 | [0m[35m            base64.b64decode([0m
[30;1m127 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m128 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m129 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m130 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m131 | [0m[35m        root_key = base64.b64decode('wh0HSM65wWHOIxoGjgJJOFvQKn2jJFhC')[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m        ))[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def test_decode_caveat_v2_from_go(self):[0m
[30;1m125 | [0m[35m        tp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m126 | [0m[35m            base64.b64decode([0m
[30;1m127 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m128 | [0m[35m        fp_key = bakery.PrivateKey([0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m        ))[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def test_decode_caveat_v2_from_go(self):[0m
[30;1m125 | [0m[35m        tp_key = bakery.PrivateKey(nacl.public.PrivateKey([0m
[30;1m126 | [0m[35m            base64.b64decode([0m
[30;1m127 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m128 | [0m[35m        fp_key = bakery.PrivateKey([0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m97 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m98 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m99 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m100 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m101 | [0m[35m        root_key = base64.b64decode('vDxEmWZEkgiNEFlJ+8ruXe3qDSLf1H+o')[0m
[30;1m102 | [0m[35m        # This caveat has been generated from the go code[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m93 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m94 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m95 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m96 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m97 | [0m[35m                'KXpsoJ9ujZYi/O2Cca6kaWh65MSawzy79LWkrjOfzcs=')))[0m
[30;1m98 | [0m[35m        root_key = base64.b64decode('vDxEmWZEkgiNEFlJ+8ruXe3qDSLf1H+o')[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def test_decode_caveat_v1_from_go(self):[0m
[30;1m92 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m93 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m94 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m95 | [0m[35m        fp_key = bakery.PrivateKey([0m
[30;1m96 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m89 | [0m[35m        self.assertTrue('empty third party caveat' in str(context.exception))[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def test_decode_caveat_v1_from_go(self):[0m
[30;1m92 | [0m[35m        tp_key = bakery.PrivateKey([0m
[30;1m93 | [0m[35m            nacl.public.PrivateKey(base64.b64decode([0m
[30;1m94 | [0m[35m                'TSpvLpQkRj+T3JXnsW2n43n5zP/0X4zn0RvDiWC3IJ0=')))[0m
[30;1m95 | [0m[35m        fp_key = bakery.PrivateKey([0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m189 | [0m[35m        caveat_data = {}[0m
[30;1m190 | [0m[35m        for id in self._caveat_data:[0m
[30;1m191 | [0m[35m            key = base64.b64encode(id).decode('utf-8')[0m
[30;1m192 | [0m[35m            value = base64.b64encode(self._caveat_data[id]).decode('utf-8')[0m
[30;1m193 | [0m[35m            caveat_data[key] = value[0m
[30;1m194 | [0m[35m        if len(caveat_data) > 0:[0m
[30;1m195 | [0m[35m            serialized['cdata'] = caveat_data[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m188 | [0m[35m            serialized['ns'] = self._namespace.serialize_text().decode('utf-8')[0m
[30;1m189 | [0m[35m        caveat_data = {}[0m
[30;1m190 | [0m[35m        for id in self._caveat_data:[0m
[30;1m191 | [0m[35m            key = base64.b64encode(id).decode('utf-8')[0m
[30;1m192 | [0m[35m            value = base64.b64encode(self._caveat_data[id]).decode('utf-8')[0m
[30;1m193 | [0m[35m            caveat_data[key] = value[0m
[30;1m194 | [0m[35m        if len(caveat_data) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m94 | [0m[35m        and by looking up the location using the given locator.[0m
[30;1m95 | [0m[35m        As a special case, if the caveat's Location field has the prefix[0m
[30;1m96 | [0m[35m        "local " the caveat is added as a client self-discharge caveat using[0m
[30;1m97 | [0m[35m        the public key base64-encoded in the rest of the location. In this[0m
[30;1m98 | [0m[35m        case, the Condition field must be empty. The resulting third-party[0m
[30;1m99 | [0m[35m        caveat will encode the condition "true" encrypted with that public[0m
[30;1m100 | [0m[35m        key.[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport abc[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    It holds the agent's private key and information about the username[0m
[30;1m182 | [0m[35m    associated with each known agent-authentication server.[0m
[30;1m183 | [0m[35m    @param key the agent's private key (bakery.PrivateKey).[0m
[30;1m184 | [0m[35m    @param agents information about the known agents (list of Agent).[0m
[30;1m185 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m    try:[0m
[30;1m47 | [0m[35m        data = json.loads(agent_file_content)[0m
[30;1m48 | [0m[35m        return AuthInfo([0m
[30;1m49 | [0m[35m            key=bakery.PrivateKey.deserialize(data['key']['private']),[0m
[30;1m50 | [0m[35m            agents=list([0m
[30;1m51 | [0m[35m                Agent(url=a['url'], username=a['username'])[0m
[30;1m52 | [0m[35m                for a in data.get('agents', [])[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m74 | [0m[35m        }, {[0m
[30;1m75 | [0m[35m            'about': 'standard encoding, not enough much padding',[0m
[30;1m76 | [0m[35m            'input': 'Z29+IQ=',[0m
[30;1m77 | [0m[35m            'expect_error': 'illegal base64 data at input byte 8',[0m
[30;1m78 | [0m[35m        }][0m
[30;1m79 | [0m[35m        for test in test_cases:[0m
[30;1m80 | [0m[35m            if test.get('expect_error'):[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m202 | [0m[35m        condition=record.get('Condition'),[0m
[30;1m203 | [0m[35m        first_party_public_key=PublicKey(fp_key),[0m
[30;1m204 | [0m[35m        third_party_key_pair=key,[0m
[30;1m205 | [0m[35m        root_key=base64.b64decode(record.get('RootKey')),[0m
[30;1m206 | [0m[35m        caveat=caveat,[0m
[30;1m207 | [0m[35m        id=None,[0m
[30;1m208 | [0m[35m        version=VERSION_1,[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m197 | [0m[35m    c = box.decrypt(secret, nonce)[0m
[30;1m198 | [0m[35m    record = json.loads(c.decode('utf-8'))[0m
[30;1m199 | [0m[35m    fp_key = nacl.public.PublicKey([0m
[30;1m200 | [0m[35m        base64.b64decode(wrapper.get('FirstPartyPublicKey')))[0m
[30;1m201 | [0m[35m    return ThirdPartyCaveatInfo([0m
[30;1m202 | [0m[35m        condition=record.get('Condition'),[0m
[30;1m203 | [0m[35m        first_party_public_key=PublicKey(fp_key),[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m190 | [0m[35m    secret = base64.b64decode(wrapper.get('Id'))[0m
[30;1m191 | [0m[35m    nonce = base64.b64decode(wrapper.get('Nonce'))[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    fp_public_key = nacl.public.PublicKey(base64.b64decode([0m
[30;1m194 | [0m[35m        wrapper.get('FirstPartyPublicKey')))[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    box = nacl.public.Box(key.key, fp_public_key)[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # The encrypted string is base64 encoded in the JSON representation.[0m
[30;1m190 | [0m[35m    secret = base64.b64decode(wrapper.get('Id'))[0m
[30;1m191 | [0m[35m    nonce = base64.b64decode(wrapper.get('Nonce'))[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    fp_public_key = nacl.public.PublicKey(base64.b64decode([0m
[30;1m194 | [0m[35m        wrapper.get('FirstPartyPublicKey')))[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m187 | [0m[35m        raise Exception('target service public key not specified')[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # The encrypted string is base64 encoded in the JSON representation.[0m
[30;1m190 | [0m[35m    secret = base64.b64decode(wrapper.get('Id'))[0m
[30;1m191 | [0m[35m    nonce = base64.b64decode(wrapper.get('Nonce'))[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    fp_public_key = nacl.public.PublicKey(base64.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m186 | [0m[35m    if wrapper.get('FirstPartyPublicKey', None) is None:[0m
[30;1m187 | [0m[35m        raise Exception('target service public key not specified')[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # The encrypted string is base64 encoded in the JSON representation.[0m
[30;1m190 | [0m[35m    secret = base64.b64decode(wrapper.get('Id'))[0m
[30;1m191 | [0m[35m    nonce = base64.b64decode(wrapper.get('Nonce'))[0m
[30;1m192 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m179 | [0m[35m    data = base64.b64decode(caveat).decode('utf-8')[0m
[30;1m180 | [0m[35m    wrapper = json.loads(data)[0m
[30;1m181 | [0m[35m    tp_public_key = nacl.public.PublicKey([0m
[30;1m182 | [0m[35m        base64.b64decode(wrapper['ThirdPartyPublicKey']))[0m
[30;1m183 | [0m[35m    if key.public_key.key != tp_public_key:[0m
[30;1m184 | [0m[35m        raise Exception('public key mismatch')  # TODO[0m
[30;1m185 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m176 | [0m[35m    @param caveat a base64 encoded JSON string.[0m
[30;1m177 | [0m[35m    '''[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    data = base64.b64decode(caveat).decode('utf-8')[0m
[30;1m180 | [0m[35m    wrapper = json.loads(data)[0m
[30;1m181 | [0m[35m    tp_public_key = nacl.public.PublicKey([0m
[30;1m182 | [0m[35m        base64.b64decode(wrapper['ThirdPartyPublicKey']))[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m173 | [0m[35m    '''Decode a base64 encoded JSON id.[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    @param key the nacl private key to decode.[0m
[30;1m176 | [0m[35m    @param caveat a base64 encoded JSON string.[0m
[30;1m177 | [0m[35m    '''[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    data = base64.b64decode(caveat).decode('utf-8')[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35mdef _decode_caveat_v1(key, caveat):[0m
[30;1m173 | [0m[35m    '''Decode a base64 encoded JSON id.[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    @param key the nacl private key to decode.[0m
[30;1m176 | [0m[35m    @param caveat a base64 encoded JSON string.[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    first = caveat[:1][0m
[30;1m154 | [0m[35m    if first == b'e':[0m
[30;1m155 | [0m[35m        # 'e' will be the first byte if the caveatid is a base64[0m
[30;1m156 | [0m[35m        # encoded JSON object.[0m
[30;1m157 | [0m[35m        return _decode_caveat_v1(key, caveat)[0m
[30;1m158 | [0m[35m    first_as_int = six.byte2int(first)[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m72 | [0m[35m        'ThirdPartyPublicKey': str(third_party_pub_key),[0m
[30;1m73 | [0m[35m        'FirstPartyPublicKey': str(key.public_key),[0m
[30;1m74 | [0m[35m        'Nonce': base64.b64encode(nonce).decode('ascii'),[0m
[30;1m75 | [0m[35m        'Id': base64.b64encode(encrypted).decode('ascii')[0m
[30;1m76 | [0m[35m    })))[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m71 | [0m[35m    return base64.b64encode(six.b(json.dumps({[0m
[30;1m72 | [0m[35m        'ThirdPartyPublicKey': str(third_party_pub_key),[0m
[30;1m73 | [0m[35m        'FirstPartyPublicKey': str(key.public_key),[0m
[30;1m74 | [0m[35m        'Nonce': base64.b64encode(nonce).decode('ascii'),[0m
[30;1m75 | [0m[35m        'Id': base64.b64encode(encrypted).decode('ascii')[0m
[30;1m76 | [0m[35m    })))[0m
[30;1m77 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m68 | [0m[35m    encrypted = box.encrypt(six.b(plain_data))[0m
[30;1m69 | [0m[35m    nonce = encrypted[0:nacl.public.Box.NONCE_SIZE][0m
[30;1m70 | [0m[35m    encrypted = encrypted[nacl.public.Box.NONCE_SIZE:][0m
[30;1m71 | [0m[35m    return base64.b64encode(six.b(json.dumps({[0m
[30;1m72 | [0m[35m        'ThirdPartyPublicKey': str(third_party_pub_key),[0m
[30;1m73 | [0m[35m        'FirstPartyPublicKey': str(key.public_key),[0m
[30;1m74 | [0m[35m        'Nonce': base64.b64encode(nonce).decode('ascii'),[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m60 | [0m[35m    @return a base64 encoded bytes[0m
[30;1m61 | [0m[35m    '''[0m
[30;1m62 | [0m[35m    plain_data = json.dumps({[0m
[30;1m63 | [0m[35m        'RootKey': base64.b64encode(root_key).decode('ascii'),[0m
[30;1m64 | [0m[35m        'Condition': condition[0m
[30;1m65 | [0m[35m    })[0m
[30;1m66 | [0m[35m    box = nacl.public.Box(key.key, third_party_pub_key.key)[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m57 | [0m[35m    @param root_key bytes[0m
[30;1m58 | [0m[35m    @param third_party_pub_key (PublicKey)[0m
[30;1m59 | [0m[35m    @param key (PrivateKey)[0m
[30;1m60 | [0m[35m    @return a base64 encoded bytes[0m
[30;1m61 | [0m[35m    '''[0m
[30;1m62 | [0m[35m    plain_data = json.dumps({[0m
[30;1m63 | [0m[35m        'RootKey': base64.b64encode(root_key).decode('ascii'),[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom ._versions import (VERSION_1, VERSION_2, VERSION_3)[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m    @param condition string[0m
[30;1m57 | [0m[35m    @param root_key bytes[0m
[30;1m58 | [0m[35m    @param third_party_pub_key (PublicKey)[0m
[30;1m59 | [0m[35m    @param key (PrivateKey)[0m
[30;1m60 | [0m[35m    @return a base64 encoded bytes[0m
[30;1m61 | [0m[35m    '''[0m
[30;1m62 | [0m[35m    plain_data = json.dumps({[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m105 | [0m[35m    @return bytes decoded[0m
[30;1m106 | [0m[35m    '''[0m
[30;1m107 | [0m[35m    b = to_bytes(b)[0m
[30;1m108 | [0m[35m    b = base64.urlsafe_b64encode(b)[0m
[30;1m109 | [0m[35m    b = b.rstrip(b'=')  # strip padding[0m
[30;1m110 | [0m[35m    return b[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35mdef raw_urlsafe_b64encode(b):[0m
[30;1m102 | [0m[35m    '''Base64 encode using URL-safe encoding with padding removed.[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    @param b bytes to decode[0m
[30;1m105 | [0m[35m    @return bytes decoded[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m93 | [0m[35m        if '_' or '-' in s:[0m
[30;1m94 | [0m[35m            return base64.urlsafe_b64decode(s)[0m
[30;1m95 | [0m[35m        else:[0m
[30;1m96 | [0m[35m            return base64.b64decode(s)[0m
[30;1m97 | [0m[35m    except (TypeError, binascii.Error) as e:[0m
[30;1m98 | [0m[35m        raise ValueError(str(e))[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m91 | [0m[35m        s = s + b'=' * (-len(s) % 4)[0m
[30;1m92 | [0m[35m    try:[0m
[30;1m93 | [0m[35m        if '_' or '-' in s:[0m
[30;1m94 | [0m[35m            return base64.urlsafe_b64decode(s)[0m
[30;1m95 | [0m[35m        else:[0m
[30;1m96 | [0m[35m            return base64.b64decode(s)[0m
[30;1m97 | [0m[35m    except (TypeError, binascii.Error) as e:[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35mdef b64decode(s):[0m
[30;1m80 | [0m[35m    '''Base64 decodes a base64-encoded string in URL-safe[0m
[30;1m81 | [0m[35m    or normal format, with or without padding.[0m
[30;1m82 | [0m[35m    The argument may be string or bytes.[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35mdef b64decode(s):[0m
[30;1m80 | [0m[35m    '''Base64 decodes a base64-encoded string in URL-safe[0m
[30;1m81 | [0m[35m    or normal format, with or without padding.[0m
[30;1m82 | [0m[35m    The argument may be string or bytes.[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m68 | [0m[35mdef _remove_base64_padding(b):[0m
[30;1m69 | [0m[35m    '''Remove padding from base64 encoded bytes.[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    pymacaroons does not give padded base64 bytes from serialization.[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    @param bytes b to be padded.[0m
[30;1m74 | [0m[35m    @return a padded bytes.[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mdef _remove_base64_padding(b):[0m
[30;1m69 | [0m[35m    '''Remove padding from base64 encoded bytes.[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    pymacaroons does not give padded base64 bytes from serialization.[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m57 | [0m[35mdef _add_base64_padding(b):[0m
[30;1m58 | [0m[35m    '''Add padding to base64 encoded bytes.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    pymacaroons does not give padded base64 bytes from serialization.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    @param bytes b to be padded.[0m
[30;1m63 | [0m[35m    @return a padded bytes.[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35mdef _add_base64_padding(b):[0m
[30;1m58 | [0m[35m    '''Add padding to base64 encoded bytes.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    pymacaroons does not give padded base64 bytes from serialization.[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport binascii[0m
[30;1m5 | [0m[35mimport ipaddress[0m
[30;1m6 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m365 | [0m[35m        val = b.decode('utf-8')[0m
[30;1m366 | [0m[35m        serialized[field] = val[0m
[30;1m367 | [0m[35m    except UnicodeDecodeError:[0m
[30;1m368 | [0m[35m        val = base64.b64encode(b).decode('utf-8')[0m
[30;1m369 | [0m[35m        serialized[field + '64'] = val[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m358 | [0m[35mdef _add_json_binary_field(b, serialized, field):[0m
[30;1m359 | [0m[35m    '''' Set the given field to the given val (bytes) in the serialized[0m
[30;1m360 | [0m[35m    dictionary.[0m
[30;1m361 | [0m[35m    If the value isn't valid utf-8, we base64 encode it and use field+"64"[0m
[30;1m362 | [0m[35m    as the field name.[0m
[30;1m363 | [0m[35m    '''[0m
[30;1m364 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m168 | [0m[35m            _add_json_binary_field(token.value, req, 'token')[0m
[30;1m169 | [0m[35m            req['token-kind'] = token.kind[0m
[30;1m170 | [0m[35m        if payload is not None:[0m
[30;1m171 | [0m[35m            req['caveat64'] = base64.urlsafe_b64encode(payload).rstrip([0m
[30;1m172 | [0m[35m                b'=').decode('utf-8')[0m
[30;1m173 | [0m[35m        loc = cav.location[0m
[30;1m174 | [0m[35m        if not loc.endswith('/'):[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m105 | [0m[35m        )[0m
[30;1m106 | [0m[35m        macaroons = '[' + ','.join(map(utils.macaroon_to_json_string,[0m
[30;1m107 | [0m[35m                                       discharges)) + ']'[0m
[30;1m108 | [0m[35m        all_macaroons = base64.urlsafe_b64encode(utils.to_bytes(macaroons))[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        full_path = urljoin(url, error.info.macaroon_path)[0m
[30;1m111 | [0m[35m        if error.info.cookie_name_suffix is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m252 | [0m[35m    def __init__(self, client):[0m
[30;1m253 | [0m[35m        '''[0m
[30;1m254 | [0m[35m        @param interaction_methods A list of Interactor implementations.[0m
[30;1m255 | [0m[35m        @param key The private key of the client (macaroonbakery.PrivateKey)[0m
[30;1m256 | [0m[35m        @param cookies storage for the cookies {CookieJar}. It should be the[0m
[30;1m257 | [0m[35m        same as in the requests cookies.[0m
[30;1m258 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m                            cookies=client.cookies,[0m
[30;1m52 | [0m[35m                            auth=client.auth())[0m
[30;1m53 | [0m[35m    @param interaction_methods A list of Interactor implementations.[0m
[30;1m54 | [0m[35m    @param key The private key of the client {bakery.PrivateKey}[0m
[30;1m55 | [0m[35m    @param cookies storage for the cookies {CookieJar}. It should be the[0m
[30;1m56 | [0m[35m    same as in the requests cookies. If not provided, one[0m
[30;1m57 | [0m[35m    will be created.[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m65 | [0m[35m            if token_val is None:[0m
[30;1m66 | [0m[35m                raise InteractionError([0m
[30;1m67 | [0m[35m                    'cannot get token from {}'.format(wait_token_url))[0m
[30;1m68 | [0m[35m            token_val = base64.b64decode(token_val)[0m
[30;1m69 | [0m[35m        return DischargeToken(kind=kind, value=token_val)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mfrom collections import namedtuple[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport requests[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m212 | [0m[35m        # The first byte is not a version number and it's 'A', which is the[0m
[30;1m213 | [0m[35m        # base64 encoding of the top 6 bits (all zero) of the version number 2[0m
[30;1m214 | [0m[35m        # or 3, so we assume that it's the base64 encoding of a new-style[0m
[30;1m215 | [0m[35m        # macaroon id, so we base64 decode it.[0m
[30;1m216 | [0m[35m        #[0m
[30;1m217 | [0m[35m        # Note that old-style ids always start with an ASCII character >= 4[0m
[30;1m218 | [0m[35m        # (> 32 in fact) so this logic won't be triggered for those.[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m211 | [0m[35m    if first == b'A':[0m
[30;1m212 | [0m[35m        # The first byte is not a version number and it's 'A', which is the[0m
[30;1m213 | [0m[35m        # base64 encoding of the top 6 bits (all zero) of the version number 2[0m
[30;1m214 | [0m[35m        # or 3, so we assume that it's the base64 encoding of a new-style[0m
[30;1m215 | [0m[35m        # macaroon id, so we base64 decode it.[0m
[30;1m216 | [0m[35m        #[0m
[30;1m217 | [0m[35m        # Note that old-style ids always start with an ASCII character >= 4[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m210 | [0m[35m    first = id[:1][0m
[30;1m211 | [0m[35m    if first == b'A':[0m
[30;1m212 | [0m[35m        # The first byte is not a version number and it's 'A', which is the[0m
[30;1m213 | [0m[35m        # base64 encoding of the top 6 bits (all zero) of the version number 2[0m
[30;1m214 | [0m[35m        # or 3, so we assume that it's the base64 encoding of a new-style[0m
[30;1m215 | [0m[35m        # macaroon id, so we base64 decode it.[0m
[30;1m216 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m147 | [0m[35m        for op in ops:[0m
[30;1m148 | [0m[35m            hash_entity.update('{}\n{}\n'.format([0m
[30;1m149 | [0m[35m                op.action, op.entity).encode())[0m
[30;1m150 | [0m[35m        hash_encoded = base64.urlsafe_b64encode(hash_entity.digest())[0m
[30;1m151 | [0m[35m        return 'multi-' + hash_encoded.decode('utf-8').rstrip('=')[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def macaroon_ops(self, macaroons):[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        if macaroon_version(version) < MACAROON_V2:[0m
[30;1m103 | [0m[35m            # The old macaroon format required valid text for the macaroon id,[0m
[30;1m104 | [0m[35m            # so base64-encode it.[0m
[30;1m105 | [0m[35m            id_bytes = raw_urlsafe_b64encode(id_bytes)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        m = Macaroon([0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport hashlib[0m
[30;1m6 | [0m[35mimport itertools[0m
[30;1m7 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_third_party.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m28 | [0m[35m    that created the third party caveat. {PublicKey}[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    @param third_party_key_pair holds the nacl private used to decrypt[0m
[30;1m31 | [0m[35m    the caveat - the key pair of the discharging service. {PrivateKey}[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    @param root_key holds the secret root key encoded by the caveat. {bytes}[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    @classmethod[0m
[30;1m84 | [0m[35m    def deserialize(cls, serialized):[0m
[30;1m85 | [0m[35m        ''' Create a PublicKey from a base64 encoded bytes.[0m
[30;1m86 | [0m[35m        :return: a PublicKey[0m
[30;1m87 | [0m[35m        '''[0m
[30;1m88 | [0m[35m        return PublicKey([0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m77 | [0m[35m        return self._key.encode(nacl.encoding.Base64Encoder)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    def __str__(self):[0m
[30;1m80 | [0m[35m        '''Return the key as a base64-encoded string'''[0m
[30;1m81 | [0m[35m        return self.serialize().decode('utf-8')[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m68 | [0m[35m        return self._key[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    def serialize(self, raw=False):[0m
[30;1m71 | [0m[35m        '''Encode the private part of the key in a base64 format by default,[0m
[30;1m72 | [0m[35m        but when raw is True it will return hex encoded bytes.[0m
[30;1m73 | [0m[35m        @return: bytes[0m
[30;1m74 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m44 | [0m[35m        return self._key.encode(nacl.encoding.Base64Encoder)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def __str__(self):[0m
[30;1m47 | [0m[35m        '''Return the private part of the key key as a base64-encoded string'''[0m
[30;1m48 | [0m[35m        return self.serialize().decode('utf-8')[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    def __eq__(self, other):[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m35 | [0m[35m                                   encoder=nacl.encoding.Base64Encoder))[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def serialize(self, raw=False):[0m
[30;1m38 | [0m[35m        '''Encode the private part of the key in a base64 format by default,[0m
[30;1m39 | [0m[35m        but when raw is True it will return hex encoded bytes.[0m
[30;1m40 | [0m[35m        @return: bytes[0m
[30;1m41 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    @classmethod[0m
[30;1m29 | [0m[35m    def deserialize(cls, serialized):[0m
[30;1m30 | [0m[35m        ''' Create a PrivateKey from a base64 encoded bytes.[0m
[30;1m31 | [0m[35m        :return: a PrivateKey[0m
[30;1m32 | [0m[35m        '''[0m
[30;1m33 | [0m[35m        return PrivateKey([0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m    '''GenerateKey generates a new PrivateKey.[0m
[30;1m98 | [0m[35m    :return: a PrivateKey[0m
[30;1m99 | [0m[35m    '''[0m
[30;1m100 | [0m[35m    return PrivateKey(nacl.public.PrivateKey.generate())[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m    '''GenerateKey generates a new PrivateKey.[0m
[30;1m98 | [0m[35m    :return: a PrivateKey[0m
[30;1m99 | [0m[35m    '''[0m
[30;1m100 | [0m[35m    return PrivateKey(nacl.public.PrivateKey.generate())[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef generate_key():[0m
[30;1m97 | [0m[35m    '''GenerateKey generates a new PrivateKey.[0m
[30;1m98 | [0m[35m    :return: a PrivateKey[0m
[30;1m99 | [0m[35m    '''[0m
[30;1m100 | [0m[35m    return PrivateKey(nacl.public.PrivateKey.generate())[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef generate_key():[0m
[30;1m97 | [0m[35m    '''GenerateKey generates a new PrivateKey.[0m
[30;1m98 | [0m[35m    :return: a PrivateKey[0m
[30;1m99 | [0m[35m    '''[0m
[30;1m100 | [0m[35m    return PrivateKey(nacl.public.PrivateKey.generate())[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m        :return: a PrivateKey[0m
[30;1m32 | [0m[35m        '''[0m
[30;1m33 | [0m[35m        return PrivateKey([0m
[30;1m34 | [0m[35m            nacl.public.PrivateKey(serialized,[0m
[30;1m35 | [0m[35m                                   encoder=nacl.encoding.Base64Encoder))[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def serialize(self, raw=False):[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m        ''' Create a PrivateKey from a base64 encoded bytes.[0m
[30;1m31 | [0m[35m        :return: a PrivateKey[0m
[30;1m32 | [0m[35m        '''[0m
[30;1m33 | [0m[35m        return PrivateKey([0m
[30;1m34 | [0m[35m            nacl.public.PrivateKey(serialized,[0m
[30;1m35 | [0m[35m                                   encoder=nacl.encoding.Base64Encoder))[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m28 | [0m[35m    @classmethod[0m
[30;1m29 | [0m[35m    def deserialize(cls, serialized):[0m
[30;1m30 | [0m[35m        ''' Create a PrivateKey from a base64 encoded bytes.[0m
[30;1m31 | [0m[35m        :return: a PrivateKey[0m
[30;1m32 | [0m[35m        '''[0m
[30;1m33 | [0m[35m        return PrivateKey([0m
[30;1m34 | [0m[35m            nacl.public.PrivateKey(serialized,[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    @classmethod[0m
[30;1m29 | [0m[35m    def deserialize(cls, serialized):[0m
[30;1m30 | [0m[35m        ''' Create a PrivateKey from a base64 encoded bytes.[0m
[30;1m31 | [0m[35m        :return: a PrivateKey[0m
[30;1m32 | [0m[35m        '''[0m
[30;1m33 | [0m[35m        return PrivateKey([0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4 | [0m[35mimport nacl.public[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mclass PrivateKey(object):[0m
[30;1m8 | [0m[35m    ''' A private key used by the bakery to encrypt and decrypt[0m
[30;1m9 | [0m[35m    third party caveats.[0m
[30;1m10 | [0m[35m    Internally, it is a 256-bit Ed25519 private key.[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m571 | [0m[35m    def test_extract_macaroons_from_request(self):[0m
[30;1m572 | [0m[35m        def encode_macaroon(m):[0m
[30;1m573 | [0m[35m            macaroons = '[' + utils.macaroon_to_json_string(m) + ']'[0m
[30;1m574 | [0m[35m            return base64.urlsafe_b64encode(utils.to_bytes(macaroons)).decode('ascii')[0m
[30;1m575 | [0m[35m[0m
[30;1m576 | [0m[35m        req = Request('http://example.com')[0m
[30;1m577 | [0m[35m        m1 = pymacaroons.Macaroon(version=pymacaroons.MACAROON_V2, identifier='one')[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m314 | [0m[35m                    auth=client.auth())[0m
[30;1m315 | [0m[35m            resp.raise_for_status()[0m
[30;1m316 | [0m[35m            m = bakery.Macaroon.from_dict(json.loads([0m
[30;1m317 | [0m[35m                base64.b64decode(client.cookies.get('macaroon-test')).decode('utf-8'))[0])[0m
[30;1m318 | [0m[35m            t = checkers.macaroons_expiry_time([0m
[30;1m319 | [0m[35m                checkers.Namespace(), [m.macaroon])[0m
[30;1m320 | [0m[35m            self.assertEqual(ages, t)[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m256 | [0m[35m                expiry=AGES, caveats=None, ops=[TEST_OP])[0m
[30;1m257 | [0m[35m            self.assertEqual(srv_macaroon.macaroon.location, 'loc')[0m
[30;1m258 | [0m[35m            headers = {[0m
[30;1m259 | [0m[35m                'Macaroons': base64.b64encode(json.dumps([[0m
[30;1m260 | [0m[35m                    srv_macaroon.to_dict().get('m')[0m
[30;1m261 | [0m[35m                ]).encode('utf-8'))[0m
[30;1m262 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m54 | [0m[35m            self.assertEqual(srv_macaroon.macaroon.location, 'loc')[0m
[30;1m55 | [0m[35m            client = httpbakery.Client()[0m
[30;1m56 | [0m[35m            client.cookies.set_cookie(requests.cookies.create_cookie([0m
[30;1m57 | [0m[35m                'macaroon-test', base64.b64encode(json.dumps([[0m
[30;1m58 | [0m[35m                    srv_macaroon.to_dict().get('m')[0m
[30;1m59 | [0m[35m                ]).encode('utf-8')).decode('utf-8')[0m
[30;1m60 | [0m[35m            ))[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport datetime[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport platform[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.get\(.*(fromhex|decode)[0m
[30;1m314 | [0m[35m                    auth=client.auth())[0m
[30;1m315 | [0m[35m            resp.raise_for_status()[0m
[30;1m316 | [0m[35m            m = bakery.Macaroon.from_dict(json.loads([0m
[30;1m317 | [0m[35m                base64.b64decode(client.cookies.get('macaroon-test')).decode('utf-8'))[0])[0m
[30;1m318 | [0m[35m            t = checkers.macaroons_expiry_time([0m
[30;1m319 | [0m[35m                checkers.Namespace(), [m.macaroon])[0m
[30;1m320 | [0m[35m            self.assertEqual(ages, t)[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m    'Op',[0m
[30;1m115 | [0m[35m    'Oven',[0m
[30;1m116 | [0m[35m    'PermissionDenied',[0m
[30;1m117 | [0m[35m    'PrivateKey',[0m
[30;1m118 | [0m[35m    'PublicKey',[0m
[30;1m119 | [0m[35m    'SimpleIdentity',[0m
[30;1m120 | [0m[35m    'ThirdPartyCaveatCheckFailed',[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m)[0m
[30;1m47 | [0m[35mfrom ._keys import ([0m
[30;1m48 | [0m[35m    generate_key,[0m
[30;1m49 | [0m[35m    PrivateKey,[0m
[30;1m50 | [0m[35m    PublicKey,[0m
[30;1m51 | [0m[35m)[0m
[30;1m52 | [0m[35mfrom ._store import ([0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_agent.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    def test_load_auth_info(self):[0m
[30;1m46 | [0m[35m        auth_info = agent.load_auth_info(self.agent_filename)[0m
[30;1m47 | [0m[35m        self.assertEqual(str(auth_info.key), PRIVATE_KEY)[0m
[30;1m48 | [0m[35m        self.assertEqual(str(auth_info.key.public_key), PUBLIC_KEY)[0m
[30;1m49 | [0m[35m        self.assertEqual(auth_info.agents, [[0m
[30;1m50 | [0m[35m            agent.Agent(url='https://1.example.com/', username='user-1'),[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_agent.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mlog = logging.getLogger(__name__)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mPRIVATE_KEY = 'CqoSgj06Zcgb4/S6RT4DpTjLAfKoznEY3JsShSjKJEU='[0m
[30;1m22 | [0m[35mPUBLIC_KEY = 'YAhRSsth3a36mRYqQGQaLiS4QJax0p356nd+B8x7UQE='[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m107 | [0m[35m            'Ii9lWTRTTWR6TGFxbDlsRFc3bHUyZTZuSzJnVG9veVl0IiwiS'[0m
[30;1m108 | [0m[35m            'WQiOiJra0ZuOGJEaEt4RUxtUjd0NkJxTU0vdHhMMFVqaEZjR1'[0m
[30;1m109 | [0m[35m            'BORldUUExGdjVla1dWUjA4Uk1sbGJhc3c4VGdFbkhzM0laeVo'[0m
[30;1m110 | [0m[35m            '0V2lEOHhRUWdjU3ljOHY4eUt4dEhxejVEczJOYmh1ZDJhUFdt'[0m
[30;1m111 | [0m[35m            'UTVMcVlNWitmZ2FNaTAxdE9DIn0=')[0m
[30;1m112 | [0m[35m        cav = bakery.decode_caveat(tp_key, encrypted_cav)[0m
[30;1m113 | [0m[35m        self.assertEqual(cav, bakery.ThirdPartyCaveatInfo([0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m106 | [0m[35m            '5VGtDWk9qeW5oVmtTdHVsaUFRT2d6Y0NoZz0iLCJOb25jZSI6'[0m
[30;1m107 | [0m[35m            'Ii9lWTRTTWR6TGFxbDlsRFc3bHUyZTZuSzJnVG9veVl0IiwiS'[0m
[30;1m108 | [0m[35m            'WQiOiJra0ZuOGJEaEt4RUxtUjd0NkJxTU0vdHhMMFVqaEZjR1'[0m
[30;1m109 | [0m[35m            'BORldUUExGdjVla1dWUjA4Uk1sbGJhc3c4VGdFbkhzM0laeVo'[0m
[30;1m110 | [0m[35m            '0V2lEOHhRUWdjU3ljOHY4eUt4dEhxejVEczJOYmh1ZDJhUFdt'[0m
[30;1m111 | [0m[35m            'UTVMcVlNWitmZ2FNaTAxdE9DIn0=')[0m
[30;1m112 | [0m[35m        cav = bakery.decode_caveat(tp_key, encrypted_cav)[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m105 | [0m[35m            'JzdFBhcnR5UHVibGljS2V5IjoiSDlqSFJqSUxidXppa1VKd2o'[0m
[30;1m106 | [0m[35m            '5VGtDWk9qeW5oVmtTdHVsaUFRT2d6Y0NoZz0iLCJOb25jZSI6'[0m
[30;1m107 | [0m[35m            'Ii9lWTRTTWR6TGFxbDlsRFc3bHUyZTZuSzJnVG9veVl0IiwiS'[0m
[30;1m108 | [0m[35m            'WQiOiJra0ZuOGJEaEt4RUxtUjd0NkJxTU0vdHhMMFVqaEZjR1'[0m
[30;1m109 | [0m[35m            'BORldUUExGdjVla1dWUjA4Uk1sbGJhc3c4VGdFbkhzM0laeVo'[0m
[30;1m110 | [0m[35m            '0V2lEOHhRUWdjU3ljOHY4eUt4dEhxejVEczJOYmh1ZDJhUFdt'[0m
[30;1m111 | [0m[35m            'UTVMcVlNWitmZ2FNaTAxdE9DIn0=')[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m104 | [0m[35m            '3hFdmJsSVFFSTFqdTBTSWl0WlIrRFdhWE40cmxocz0iLCJGaX'[0m
[30;1m105 | [0m[35m            'JzdFBhcnR5UHVibGljS2V5IjoiSDlqSFJqSUxidXppa1VKd2o'[0m
[30;1m106 | [0m[35m            '5VGtDWk9qeW5oVmtTdHVsaUFRT2d6Y0NoZz0iLCJOb25jZSI6'[0m
[30;1m107 | [0m[35m            'Ii9lWTRTTWR6TGFxbDlsRFc3bHUyZTZuSzJnVG9veVl0IiwiS'[0m
[30;1m108 | [0m[35m            'WQiOiJra0ZuOGJEaEt4RUxtUjd0NkJxTU0vdHhMMFVqaEZjR1'[0m
[30;1m109 | [0m[35m            'BORldUUExGdjVla1dWUjA4Uk1sbGJhc3c4VGdFbkhzM0laeVo'[0m
[30;1m110 | [0m[35m            '0V2lEOHhRUWdjU3ljOHY4eUt4dEhxejVEczJOYmh1ZDJhUFdt'[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m103 | [0m[35m            'eyJUaGlyZFBhcnR5UHVibGljS2V5IjoiOFA3R1ZZc3BlWlN4c'[0m
[30;1m104 | [0m[35m            '3hFdmJsSVFFSTFqdTBTSWl0WlIrRFdhWE40cmxocz0iLCJGaX'[0m
[30;1m105 | [0m[35m            'JzdFBhcnR5UHVibGljS2V5IjoiSDlqSFJqSUxidXppa1VKd2o'[0m
[30;1m106 | [0m[35m            '5VGtDWk9qeW5oVmtTdHVsaUFRT2d6Y0NoZz0iLCJOb25jZSI6'[0m
[30;1m107 | [0m[35m            'Ii9lWTRTTWR6TGFxbDlsRFc3bHUyZTZuSzJnVG9veVl0IiwiS'[0m
[30;1m108 | [0m[35m            'WQiOiJra0ZuOGJEaEt4RUxtUjd0NkJxTU0vdHhMMFVqaEZjR1'[0m
[30;1m109 | [0m[35m            'BORldUUExGdjVla1dWUjA4Uk1sbGJhc3c4VGdFbkhzM0laeVo'[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m102 | [0m[35m        encrypted_cav = six.b([0m
[30;1m103 | [0m[35m            'eyJUaGlyZFBhcnR5UHVibGljS2V5IjoiOFA3R1ZZc3BlWlN4c'[0m
[30;1m104 | [0m[35m            '3hFdmJsSVFFSTFqdTBTSWl0WlIrRFdhWE40cmxocz0iLCJGaX'[0m
[30;1m105 | [0m[35m            'JzdFBhcnR5UHVibGljS2V5IjoiSDlqSFJqSUxidXppa1VKd2o'[0m
[30;1m106 | [0m[35m            '5VGtDWk9qeW5oVmtTdHVsaUFRT2d6Y0NoZz0iLCJOb25jZSI6'[0m
[30;1m107 | [0m[35m            'Ii9lWTRTTWR6TGFxbDlsRFc3bHUyZTZuSzJnVG9veVl0IiwiS'[0m
[30;1m108 | [0m[35m            'WQiOiJra0ZuOGJEaEt4RUxtUjd0NkJxTU0vdHhMMFVqaEZjR1'[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        encrypted_cav = six.b([0m
[30;1m103 | [0m[35m            'eyJUaGlyZFBhcnR5UHVibGljS2V5IjoiOFA3R1ZZc3BlWlN4c'[0m
[30;1m104 | [0m[35m            '3hFdmJsSVFFSTFqdTBTSWl0WlIrRFdhWE40cmxocz0iLCJGaX'[0m
[30;1m105 | [0m[35m            'JzdFBhcnR5UHVibGljS2V5IjoiSDlqSFJqSUxidXppa1VKd2o'[0m
[30;1m106 | [0m[35m            '5VGtDWk9qeW5oVmtTdHVsaUFRT2d6Y0NoZz0iLCJOb25jZSI6'[0m
[30;1m107 | [0m[35m            'Ii9lWTRTTWR6TGFxbDlsRFc3bHUyZTZuSzJnVG9veVl0IiwiS'[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m100 | [0m[35m        # to check the compatibilty[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        encrypted_cav = six.b([0m
[30;1m103 | [0m[35m            'eyJUaGlyZFBhcnR5UHVibGljS2V5IjoiOFA3R1ZZc3BlWlN4c'[0m
[30;1m104 | [0m[35m            '3hFdmJsSVFFSTFqdTBTSWl0WlIrRFdhWE40cmxocz0iLCJGaX'[0m
[30;1m105 | [0m[35m            'JzdFBhcnR5UHVibGljS2V5IjoiSDlqSFJqSUxidXppa1VKd2o'[0m
[30;1m106 | [0m[35m            '5VGtDWk9qeW5oVmtTdHVsaUFRT2d6Y0NoZz0iLCJOb25jZSI6'[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m[0m
[30;1m915 | [0m[35mdef _basic_auth_from_context(ctx):[0m
[30;1m916 | [0m[35m    auth = ctx.get(_BASIC_AUTH_KEY, _BasicAuth('', ''))[0m
[30;1m917 | [0m[35m    return auth.user, auth.password[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m878 | [0m[35m[0m
[30;1m879 | [0m[35m    def _discharge_all(self, ctx, m):[0m
[30;1m880 | [0m[35m        def get_discharge(cav, payload):[0m
[30;1m881 | [0m[35m            d = self._dischargers.get(cav.location)[0m
[30;1m882 | [0m[35m            if d is None:[0m
[30;1m883 | [0m[35m                raise ValueError('third party discharger '[0m
[30;1m884 | [0m[35m                                 '{} not found'.format(cav.location))[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m864 | [0m[35m        self._macaroons[svc.name()][name] = m[0m
[30;1m865 | [0m[35m[0m
[30;1m866 | [0m[35m    def _request_macaroons(self, svc):[0m
[30;1m867 | [0m[35m        mmap = self._macaroons.get(svc.name(), [])[0m
[30;1m868 | [0m[35m        # Put all the macaroons in the slice ordered by key[0m
[30;1m869 | [0m[35m        # so that we have deterministic behaviour in the tests.[0m
[30;1m870 | [0m[35m        names = [][0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m708 | [0m[35m            raise ValueError('no macaroons provided')[0m
[30;1m709 | [0m[35m[0m
[30;1m710 | [0m[35m        m_id = json.loads(ms[0].identifier_bytes.decode('utf-8'))[0m
[30;1m711 | [0m[35m        root_key = self._root_key_store.get([0m
[30;1m712 | [0m[35m            base64.urlsafe_b64decode(m_id['id'].encode('utf-8')))[0m
[30;1m713 | [0m[35m[0m
[30;1m714 | [0m[35m        v = Verifier()[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m679 | [0m[35m    def authorize(self, ctx, id, ops):[0m
[30;1m680 | [0m[35m        return bakery.ACLAuthorizer([0m
[30;1m681 | [0m[35m            allow_public=True,[0m
[30;1m682 | [0m[35m            get_acl=lambda ctx, op: self._auth.get(op, [])).authorize([0m
[30;1m683 | [0m[35m            ctx, id, ops)[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m                                      condition='is-authenticated-user')][0m
[30;1m634 | [0m[35m[0m
[30;1m635 | [0m[35m    def declared_identity(self, ctx, declared):[0m
[30;1m636 | [0m[35m        user = declared.get('username')[0m
[30;1m637 | [0m[35m        if user is None:[0m
[30;1m638 | [0m[35m            raise bakery.IdentityError('no username declared')[0m
[30;1m639 | [0m[35m        return bakery.SimpleIdentity(user)[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m621 | [0m[35m            raise bakery.CaveatNotRecognizedError([0m
[30;1m622 | [0m[35m                'third party condition not recognized')[0m
[30;1m623 | [0m[35m[0m
[30;1m624 | [0m[35m        username = ctx.get(_DISCHARGE_USER_KEY, '')[0m
[30;1m625 | [0m[35m        if username == '':[0m
[30;1m626 | [0m[35m            raise bakery.ThirdPartyCaveatCheckFailed('no current user')[0m
[30;1m627 | [0m[35m        self._test._discharges.append([0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m604 | [0m[35m        return self._dischargers[key][0m
[30;1m605 | [0m[35m[0m
[30;1m606 | [0m[35m    def get(self, key):[0m
[30;1m607 | [0m[35m        return self._dischargers.get(key)[0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35mclass _IdService(bakery.IdentityClient,[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m589 | [0m[35m        self._dischargers = dischargers[0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m    def third_party_info(self, loc):[0m
[30;1m592 | [0m[35m        d = self._dischargers.get(loc)[0m
[30;1m593 | [0m[35m        if d is None:[0m
[30;1m594 | [0m[35m            return None[0m
[30;1m595 | [0m[35m        return bakery.ThirdPartyInfo([0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m                    raise ValueError('third party condition not recognized')[0m
[30;1m254 | [0m[35m                self._discharges.append(_DischargeRecord([0m
[30;1m255 | [0m[35m                    location='other third party',[0m
[30;1m256 | [0m[35m                    user=ctx.get(_DISCHARGE_USER_KEY)[0m
[30;1m257 | [0m[35m                ))[0m
[30;1m258 | [0m[35m                return [][0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        # Acquire two capabilities as different users and check[0m
[30;1m150 | [0m[35m        # that we can combine them together to do both operations[0m
[30;1m151 | [0m[35m        # at once.[0m
[30;1m152 | [0m[35m        ctx = test_context.with_value(_DISCHARGE_USER_KEY, 'alice')[0m
[30;1m153 | [0m[35m        m1 = _Client(locator).discharged_capability(ctx, ts, [[0m
[30;1m154 | [0m[35m            bakery.Op(entity='e1', action='read'),[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m762 | [0m[35m        return authInfo[0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m    def do_any(self, ctx, ms, ops):[0m
[30;1m765 | [0m[35m        # makes a request to the service to perform any of the given[0m
[30;1m766 | [0m[35m        # operations. It reports which operations have succeeded.[0m
[30;1m767 | [0m[35m        try:[0m
[30;1m768 | [0m[35m            authInfo, allowed = self._checker.auth(ms).allow_any(ctx, ops)[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m737 | [0m[35mclass _Service(object):[0m
[30;1m738 | [0m[35m    '''Represents a service that requires authorization.[0m
[30;1m739 | [0m[35m[0m
[30;1m740 | [0m[35m    Clients can make requests to the service to perform operations[0m
[30;1m741 | [0m[35m    and may receive a macaroon to discharge if the authorization[0m
[30;1m742 | [0m[35m    process requires it.[0m
[30;1m743 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m735 | [0m[35m[0m
[30;1m736 | [0m[35m[0m
[30;1m737 | [0m[35mclass _Service(object):[0m
[30;1m738 | [0m[35m    '''Represents a service that requires authorization.[0m
[30;1m739 | [0m[35m[0m
[30;1m740 | [0m[35m    Clients can make requests to the service to perform operations[0m
[30;1m741 | [0m[35m    and may receive a macaroon to discharge if the authorization[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m                checkers.Caveat(condition='true 1', namespace='testns'),[0m
[30;1m328 | [0m[35m                checkers.Caveat(condition='true 2', namespace='testns'),[0m
[30;1m329 | [0m[35m                checkers.Caveat(condition='true 3', namespace='testns'),[0m
[30;1m330 | [0m[35m            ]), ('earliest time before', [[0m
[30;1m331 | [0m[35m                checkers.time_before_caveat(epoch + timedelta(days=1)),[0m
[30;1m332 | [0m[35m                checkers.Caveat(condition='true 1', namespace='testns'),[0m
[30;1m333 | [0m[35m                checkers.time_before_caveat([0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m        self.assertEqual(self._discharges,[0m
[30;1m121 | [0m[35m                         [_DischargeRecord(location='ids', user='bob')])[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        # Check that we can exercise the capability directly on the service[0m
[30;1m124 | [0m[35m        # with no discharging required.[0m
[30;1m125 | [0m[35m        ts.do(test_context, [m], [[0m
[30;1m126 | [0m[35m            bakery.Op(entity='e1', action='read'),[0m
[30;1m127 | [0m[35m            bakery.Op(entity='e2', action='read'),[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m        ctx = test_context.with_value(_DISCHARGE_USER_KEY, 'bob')[0m
[30;1m91 | [0m[35m        m = client.discharged_capability([0m
[30;1m92 | [0m[35m            ctx, ts, [bakery.Op(entity='something', action='read')])[0m
[30;1m93 | [0m[35m        # Check that we can exercise the capability directly on the service[0m
[30;1m94 | [0m[35m        # with no discharging required.[0m
[30;1m95 | [0m[35m        auth_info = ts.do(test_context, [m], [[0m
[30;1m96 | [0m[35m            bakery.Op(entity='something', action='read'),[0m
[30;1m97 | [0m[35m        ])[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mfrom collections import namedtuple[0m
[30;1m6 | [0m[35mfrom datetime import timedelta[0m
[30;1m7 | [0m[35mfrom unittest import TestCase[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_checkers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m    whether we require all the operations in the caveat to be declared in[0m
[30;1m213 | [0m[35m    the context.[0m
[30;1m214 | [0m[35m    '''[0m
[30;1m215 | [0m[35m    ctx_ops = ctx.get(OP_KEY, [])[0m
[30;1m216 | [0m[35m    if len(ctx_ops) == 0:[0m
[30;1m217 | [0m[35m        if need_ops:[0m
[30;1m218 | [0m[35m            f = arg.split()[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_checkers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m    if len(parts) != 2:[0m
[30;1m187 | [0m[35m        return 'declared caveat has no value'[0m
[30;1m188 | [0m[35m    attrs = ctx.get(DECLARED_KEY, {})[0m
[30;1m189 | [0m[35m    val = attrs.get(parts[0])[0m
[30;1m190 | [0m[35m    if val is None:[0m
[30;1m191 | [0m[35m        return 'got {}=null, expected "{}"'.format(parts[0], parts[1])[0m
[30;1m192 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_checkers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m    parts = arg.split(' ', 1)[0m
[30;1m186 | [0m[35m    if len(parts) != 2:[0m
[30;1m187 | [0m[35m        return 'declared caveat has no value'[0m
[30;1m188 | [0m[35m    attrs = ctx.get(DECLARED_KEY, {})[0m
[30;1m189 | [0m[35m    val = attrs.get(parts[0])[0m
[30;1m190 | [0m[35m    if val is None:[0m
[30;1m191 | [0m[35m        return 'got {}=null, expected "{}"'.format(parts[0], parts[1])[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_checkers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35mdef _check_time_before(ctx, cond, arg):[0m
[30;1m166 | [0m[35m    clock = ctx.get(TIME_KEY)[0m
[30;1m167 | [0m[35m    if clock is None:[0m
[30;1m168 | [0m[35m        now = datetime.utcnow()[0m
[30;1m169 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_checkers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m                ' prefix is empty'.format(cond, uri))[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m        full_cond = condition_with_prefix(prefix, cond)[0m
[30;1m126 | [0m[35m        info = self._checkers.get(full_cond)[0m
[30;1m127 | [0m[35m        if info is not None:[0m
[30;1m128 | [0m[35m            raise RegisterError([0m
[30;1m129 | [0m[35m                'checker for {} (namespace {}) already registered in '[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_checkers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m            # If we can't parse it, perhaps it's in some other format,[0m
[30;1m75 | [0m[35m            # return a not-recognised error.[0m
[30;1m76 | [0m[35m            return 'cannot parse caveat "{}": {}'.format(cav, ex.args[0])[0m
[30;1m77 | [0m[35m        checker = self._checkers.get(cond)[0m
[30;1m78 | [0m[35m        if checker is None:[0m
[30;1m79 | [0m[35m            return 'caveat "{}" not satisfied: caveat not recognized'.format([0m
[30;1m80 | [0m[35m                cav)[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_codec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mfrom unittest import TestCase[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport macaroonbakery.bakery as bakery[0m
[30;1m7 | [0m[35mimport macaroonbakery.checkers as checkers[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m354 | [0m[35m        self._store = {}[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m    def third_party_info(self, loc):[0m
[30;1m357 | [0m[35m        info = self._store.get(loc.rstrip('/'))[0m
[30;1m358 | [0m[35m        if info is None:[0m
[30;1m359 | [0m[35m            raise ThirdPartyInfoNotFound([0m
[30;1m360 | [0m[35m                'cannot retrieve the info for location {}'.format(loc))[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m                'underlying macaroon has inconsistent version; '[0m
[30;1m226 | [0m[35m                'got {} want {}'.format(m.version, macaroon_version(version)))[0m
[30;1m227 | [0m[35m        namespace = checkers.deserialize_namespace(json_dict.get('ns'))[0m
[30;1m228 | [0m[35m        cdata = json_dict.get('cdata', {})[0m
[30;1m229 | [0m[35m        caveat_data = {}[0m
[30;1m230 | [0m[35m        for id64 in cdata:[0m
[30;1m231 | [0m[35m            id = b64decode(id64)[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m            raise ValueError([0m
[30;1m225 | [0m[35m                'underlying macaroon has inconsistent version; '[0m
[30;1m226 | [0m[35m                'got {} want {}'.format(m.version, macaroon_version(version)))[0m
[30;1m227 | [0m[35m        namespace = checkers.deserialize_namespace(json_dict.get('ns'))[0m
[30;1m228 | [0m[35m        cdata = json_dict.get('cdata', {})[0m
[30;1m229 | [0m[35m        caveat_data = {}[0m
[30;1m230 | [0m[35m        for id64 in cdata:[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m            macaroon._macaroon = m[0m
[30;1m213 | [0m[35m            return macaroon[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        version = json_dict.get('v', None)[0m
[30;1m216 | [0m[35m        if version is None:[0m
[30;1m217 | [0m[35m            raise ValueError('no version specified')[0m
[30;1m218 | [0m[35m        if (version < VERSION_3 or[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m        deserialized from JSON.[0m
[30;1m202 | [0m[35m        @param json_dict The deserialized JSON object.[0m
[30;1m203 | [0m[35m        '''[0m
[30;1m204 | [0m[35m        json_macaroon = json_dict.get('m')[0m
[30;1m205 | [0m[35m        if json_macaroon is None:[0m
[30;1m206 | [0m[35m            # Try the v1 format if we don't have a macaroon field.[0m
[30;1m207 | [0m[35m            m = pymacaroons.Macaroon.deserialize([0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m    @abc.abstractmethod[0m
[30;1m340 | [0m[35m    def third_party_info(self, loc):[0m
[30;1m341 | [0m[35m        '''Return information on the third party at the given location.[0m
[30;1m342 | [0m[35m        @param loc string[0m
[30;1m343 | [0m[35m        @return: a ThirdPartyInfo[0m
[30;1m344 | [0m[35m        @raise: ThirdPartyInfoNotFound[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m262 | [0m[35m        else:[0m
[30;1m263 | [0m[35m            # Add a version byte to the caveat id. Technically[0m
[30;1m264 | [0m[35m            # this is unnecessary as the caveat-decoding logic[0m
[30;1m265 | [0m[35m            # that looks at versions should never see this id,[0m
[30;1m266 | [0m[35m            # but if the caveat payload isn't provided with the[0m
[30;1m267 | [0m[35m            # payload, having this version gives a strong indication[0m
[30;1m268 | [0m[35m            # that the payload has been omitted so we can produce[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35mclass ThirdPartyLocator(object):[0m
[30;1m335 | [0m[35m    '''Used to find information on third party discharge services.[0m
[30;1m336 | [0m[35m    '''[0m
[30;1m337 | [0m[35m    __metaclass__ = abc.ABCMeta[0m
[30;1m338 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m        This method does not mutate the current object.[0m
[30;1m156 | [0m[35m        @param cavs arrary of caveats.[0m
[30;1m157 | [0m[35m        @param key the PublicKey to encrypt third party caveat.[0m
[30;1m158 | [0m[35m        @param loc locator to find the location object that has a method[0m
[30;1m159 | [0m[35m        third_party_info.[0m
[30;1m160 | [0m[35m        '''[0m
[30;1m161 | [0m[35m        if cavs is None:[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        @param cav the checkers.Caveat to be added.[0m
[30;1m103 | [0m[35m        @param key the public key to encrypt third party caveat.[0m
[30;1m104 | [0m[35m        @param loc locator to find information on third parties when adding[0m
[30;1m105 | [0m[35m        third party caveats. It is expected to have a third_party_info method[0m
[30;1m106 | [0m[35m        that will be called with a location string and should return a[0m
[30;1m107 | [0m[35m        ThirdPartyInfo instance holding the requested information.[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        @param id bytes or string[0m
[30;1m51 | [0m[35m        @param location bytes or string[0m
[30;1m52 | [0m[35m        @param version the bakery version.[0m
[30;1m53 | [0m[35m        @param namespace is that of the service creating it[0m
[30;1m54 | [0m[35m        '''[0m
[30;1m55 | [0m[35m        if version > LATEST_VERSION:[0m
[30;1m56 | [0m[35m            log.info('use last known version:{} instead of: {}'.format([0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        If the version is more than the latest known version,[0m
[30;1m47 | [0m[35m        the latest known version will be used. The namespace should hold the[0m
[30;1m48 | [0m[35m        namespace of the service that is creating the macaroon.[0m
[30;1m49 | [0m[35m        @param root_key bytes or string[0m
[30;1m50 | [0m[35m        @param id bytes or string[0m
[30;1m51 | [0m[35m        @param location bytes or string[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_macaroon.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport abc[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m        if resp.status_code != 200:[0m
[30;1m163 | [0m[35m            raise httpbakery.InteractionError([0m
[30;1m164 | [0m[35m                'cannot acquire agent macaroon from {}: {} (response body: {!r})'.format(visit_url, [0m
[30;1m165 | [0m[35m        if not resp.json().get('agent_login', False):[0m
[30;1m166 | [0m[35m            raise httpbakery.InteractionError('agent login failed')[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m        # we're sure that client.key is the same as self._auth_info.key.[0m
[30;1m152 | [0m[35m        client = copy.copy(client)[0m
[30;1m153 | [0m[35m        client.key = self._auth_info.key[0m
[30;1m154 | [0m[35m        resp = client.request([0m
[30;1m155 | [0m[35m            method='POST',[0m
[30;1m156 | [0m[35m            url=visit_url,[0m
[30;1m157 | [0m[35m            json={[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m                'cannot acquire agent macaroon: {} {}'.format([0m
[30;1m120 | [0m[35m                    resp.status_code, resp.text)[0m
[30;1m121 | [0m[35m            )[0m
[30;1m122 | [0m[35m        m = resp.json().get('macaroon')[0m
[30;1m123 | [0m[35m        if m is None:[0m
[30;1m124 | [0m[35m            raise httpbakery.InteractionError('no macaroon in response')[0m
[30;1m125 | [0m[35m        m = bakery.Macaroon.from_dict(m)[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        if not location.endswith('/'):[0m
[30;1m110 | [0m[35m            location += '/'[0m
[30;1m111 | [0m[35m        login_url = urljoin(location, p.login_url)[0m
[30;1m112 | [0m[35m        resp = requests.get([0m
[30;1m113 | [0m[35m            login_url, params={[0m
[30;1m114 | [0m[35m                'username': agent.username,[0m
[30;1m115 | [0m[35m                'public-key': str(self._auth_info.key.public_key)},[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        deserialized from JSON.[0m
[30;1m83 | [0m[35m        @param json_dict The deserialized JSON object.[0m
[30;1m84 | [0m[35m        '''[0m
[30;1m85 | [0m[35m        return InteractionInfo(json_dict.get('login-url'))[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35mclass AgentInteractor(httpbakery.Interactor, httpbakery.LegacyInteractor):[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m            key=bakery.PrivateKey.deserialize(data['key']['private']),[0m
[30;1m50 | [0m[35m            agents=list([0m
[30;1m51 | [0m[35m                Agent(url=a['url'], username=a['username'])[0m
[30;1m52 | [0m[35m                for a in data.get('agents', [])[0m
[30;1m53 | [0m[35m            ),[0m
[30;1m54 | [0m[35m        )[0m
[30;1m55 | [0m[35m    except ([0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/agent/_agent.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m            if a.url.rstrip('/') == location.rstrip('/'):[0m
[30;1m139 | [0m[35m                return a[0m
[30;1m140 | [0m[35m        raise httpbakery.InteractionMethodNotFound([0m
[30;1m141 | [0m[35m            'cannot find username for discharge location {}'.format(location))[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    def legacy_interact(self, client, location, visit_url):[0m
[30;1m144 | [0m[35m        '''Implement LegacyInteractor.legacy_interact by obtaining[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m            'expect_error': 'illegal base64 data at input byte 8',[0m
[30;1m78 | [0m[35m        }][0m
[30;1m79 | [0m[35m        for test in test_cases:[0m
[30;1m80 | [0m[35m            if test.get('expect_error'):[0m
[30;1m81 | [0m[35m                with self.assertRaises(ValueError, msg=test['about']) as e:[0m
[30;1m82 | [0m[35m                    bakery.b64decode(test['input'])[0m
[30;1m83 | [0m[35m                self.assertEqual(str(e.exception), 'Incorrect padding')[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m44 | [0m[35m        c = cookie('http://1.2.3.4.com', 'test', 'value')[0m
[30;1m45 | [0m[35m        self.assertEqual(c.domain, '1.2.3.4.com')[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    def test_cookie_with_hostname_not_ascii(self):[0m
[30;1m48 | [0m[35m        c = cookie('http://κουλουράκι', 'test', 'value')[0m
[30;1m49 | [0m[35m        self.assertEqual(c.domain, 'κουλουράκι.local')[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m40 | [0m[35m        c = cookie('http://[dead::beef]', 'test', 'value')[0m
[30;1m41 | [0m[35m        self.assertEqual(c.domain, 'dead::beef')[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    def test_cookie_with_hostname_like_ipv4(self):[0m
[30;1m44 | [0m[35m        c = cookie('http://1.2.3.4.com', 'test', 'value')[0m
[30;1m45 | [0m[35m        self.assertEqual(c.domain, '1.2.3.4.com')[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m36 | [0m[35m        c = cookie('http://1.2.3.4', 'test', 'value')[0m
[30;1m37 | [0m[35m        self.assertEqual(c.domain, '1.2.3.4')[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    def test_cookie_with_hostname_ipv6(self):[0m
[30;1m40 | [0m[35m        c = cookie('http://[dead::beef]', 'test', 'value')[0m
[30;1m41 | [0m[35m        self.assertEqual(c.domain, 'dead::beef')[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m32 | [0m[35m        c = cookie('http://myhost', 'test', 'value')[0m
[30;1m33 | [0m[35m        self.assertEqual(c.domain, 'myhost.local')[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def test_cookie_with_hostname_ipv4(self):[0m
[30;1m36 | [0m[35m        c = cookie('http://1.2.3.4', 'test', 'value')[0m
[30;1m37 | [0m[35m        self.assertEqual(c.domain, '1.2.3.4')[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m28 | [0m[35m            ValueError, cookie, 'http://example.com', 'test', 'value',[0m
[30;1m29 | [0m[35m            expires=timestamp)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    def test_cookie_with_hostname_not_fqdn(self):[0m
[30;1m32 | [0m[35m        c = cookie('http://myhost', 'test', 'value')[0m
[30;1m33 | [0m[35m        self.assertEqual(c.domain, 'myhost.local')[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m        }, {[0m
[30;1m75 | [0m[35m            'about': 'standard encoding, not enough much padding',[0m
[30;1m76 | [0m[35m            'input': 'Z29+IQ=',[0m
[30;1m77 | [0m[35m            'expect_error': 'illegal base64 data at input byte 8',[0m
[30;1m78 | [0m[35m        }][0m
[30;1m79 | [0m[35m        for test in test_cases:[0m
[30;1m80 | [0m[35m            if test.get('expect_error'):[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m        }, {[0m
[30;1m75 | [0m[35m            'about': 'standard encoding, not enough much padding',[0m
[30;1m76 | [0m[35m            'input': 'Z29+IQ=',[0m
[30;1m77 | [0m[35m            'expect_error': 'illegal base64 data at input byte 8',[0m
[30;1m78 | [0m[35m        }][0m
[30;1m79 | [0m[35m        for test in test_cases:[0m
[30;1m80 | [0m[35m            if test.get('expect_error'):[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mdef expiry_time(ns, cavs):[0m
[30;1m41 | [0m[35m    ''' Returns the minimum time of any time-before caveats found[0m
[30;1m42 | [0m[35m    in the given list or None if no such caveats were found.[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    The ns parameter is[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef macaroons_expiry_time(ns, ms):[0m
[30;1m26 | [0m[35m    ''' Returns the minimum time of any time-before caveats found in the given[0m
[30;1m27 | [0m[35m    macaroons or None if no such caveats were found.[0m
[30;1m28 | [0m[35m    :param ns: a Namespace, used to resolve caveats.[0m
[30;1m29 | [0m[35m    :param ms: a list of pymacaroons.Macaroon[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m    ''' Returns a copy of ctx with a key added that associates it with the[0m
[30;1m15 | [0m[35m    given clock implementation, which will be used by the time-before checker[0m
[30;1m16 | [0m[35m    to determine the current time.[0m
[30;1m17 | [0m[35m    The clock should have a utcnow method that returns the current time[0m
[30;1m18 | [0m[35m    as a datetime value in UTC.[0m
[30;1m19 | [0m[35m    '''[0m
[30;1m20 | [0m[35m    if clock is None:[0m
[30;1m21 | [0m[35m        return ctx[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m            # Note also that there may not be any macaroons if the[0m
[30;1m272 | [0m[35m            # identity client decided on an identity even with no[0m
[30;1m273 | [0m[35m            # macaroons.[0m
[30;1m274 | [0m[35m            for i in self._auth_indexes.get(LOGIN_OP, []):[0m
[30;1m275 | [0m[35m                used[i] = True[0m
[30;1m276 | [0m[35m        if num_authed == len(ops):[0m
[30;1m277 | [0m[35m            # All operations allowed.[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_checker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m        num_authed = 0[0m
[30;1m248 | [0m[35m        errors = [][0m
[30;1m249 | [0m[35m        for i, op in enumerate(ops):[0m
[30;1m250 | [0m[35m            for mindex in self._auth_indexes.get(op, []):[0m
[30;1m251 | [0m[35m                _, err = self._check_conditions(ctx, op,[0m
[30;1m252 | [0m[35m                                                self._conditions[mindex])[0m
[30;1m253 | [0m[35m                if err is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_checker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m326 | [0m[35m        declaration caveat too - in general, clients should not create[0m
[30;1m327 | [0m[35m        capabilities that grant LOGIN_OP rights.[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m        The operations must include at least one non-LOGIN_OP operation.[0m
[30;1m330 | [0m[35m        '''[0m
[30;1m331 | [0m[35m        nops = 0[0m
[30;1m332 | [0m[35m        for op in ops:[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m    The identity is authenticated only once, the first time any method[0m
[30;1m88 | [0m[35m    of the AuthChecker is called, using the context passed in then.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    To find out any declared identity without requiring a login,[0m
[30;1m91 | [0m[35m    use allow(ctx); to require authentication but no additional operations,[0m
[30;1m92 | [0m[35m    use allow(ctx, LOGIN_OP).[0m
[30;1m93 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35mclass AuthChecker(object):[0m
[30;1m85 | [0m[35m    '''Authorizes operations with respect to a user's request.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    The identity is authenticated only once, the first time any method[0m
[30;1m88 | [0m[35m    of the AuthChecker is called, using the context passed in then.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    To find out any declared identity without requiring a login,[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        The identity parameter passed to authorizer.allow will always have been[0m
[30;1m55 | [0m[35m        obtained from a call to identity_client.declared_identity.[0m
[30;1m56 | [0m[35m        :param identity_client (IdentityClient) used for interactions with the[0m
[30;1m57 | [0m[35m        external identity service used for authentication.[0m
[30;1m58 | [0m[35m        If this is None, no authentication will be possible.[0m
[30;1m59 | [0m[35m        :param macaroon_opstore (object with new_macaroon and macaroon_ops[0m
[30;1m60 | [0m[35m        method): used to retrieve macaroon root keys and other associated[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_checker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m    entity names will be prefixed with the entity type followed[0m
[30;1m26 | [0m[35m    by a hyphen.[0m
[30;1m27 | [0m[35m    @param action string holds the action to perform on the entity,[0m
[30;1m28 | [0m[35m    such as "read" or "delete". It is up to the service using a checker[0m
[30;1m29 | [0m[35m    to define a set of operations and keep them consistent over time.[0m
[30;1m30 | [0m[35m    '''[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/docs/index.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m.. bakery documentation master file, created by[0m
[30;1m2 | [0m[35m   sphinx-quickstart on Tue Jul  9 22:26:36 2013.[0m
[30;1m3 | [0m[35m   You can adapt this file completely to your liking, but it should at least[0m
[30;1m4 | [0m[35m   contain the root `toctree` directive.[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mWelcome to Macaroon Bakery Library's documentation![0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_caveat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef time_before_caveat(t):[0m
[30;1m93 | [0m[35m    '''Return a caveat that specifies that the time that it is checked at[0m
[30;1m94 | [0m[35m    should be before t.[0m
[30;1m95 | [0m[35m    :param t is a a UTC date in - use datetime.utcnow, not datetime.now[0m
[30;1m96 | [0m[35m    '''[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_caveat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35m    only use it in cases where a panic might possibly be appropriate.[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    This mechanism means that caveats can be created without error[0m
[30;1m59 | [0m[35m    checking and a later systematic check at a higher level (in the[0m
[30;1m60 | [0m[35m    bakery package) can produce an error instead.[0m
[30;1m61 | [0m[35m    '''[0m
[30;1m62 | [0m[35m    return _first_party(COND_ERROR, f)[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_caveat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m18 | [0m[35m    successfully.[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    If location is provided, the caveat must be discharged by[0m
[30;1m21 | [0m[35m    a third party at the given location (a URL string).[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    The namespace parameter holds the namespace URI string of the[0m
[30;1m24 | [0m[35m    condition - if it is provided, it will be converted to a namespace prefix[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_caveat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef time_before_caveat(t):[0m
[30;1m93 | [0m[35m    '''Return a caveat that specifies that the time that it is checked at[0m
[30;1m94 | [0m[35m    should be before t.[0m
[30;1m95 | [0m[35m    :param t is a a UTC date in - use datetime.utcnow, not datetime.now[0m
[30;1m96 | [0m[35m    '''[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        condition=record.get('Condition'),[0m
[30;1m203 | [0m[35m        first_party_public_key=PublicKey(fp_key),[0m
[30;1m204 | [0m[35m        third_party_key_pair=key,[0m
[30;1m205 | [0m[35m        root_key=base64.b64decode(record.get('RootKey')),[0m
[30;1m206 | [0m[35m        caveat=caveat,[0m
[30;1m207 | [0m[35m        id=None,[0m
[30;1m208 | [0m[35m        version=VERSION_1,[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m    fp_key = nacl.public.PublicKey([0m
[30;1m200 | [0m[35m        base64.b64decode(wrapper.get('FirstPartyPublicKey')))[0m
[30;1m201 | [0m[35m    return ThirdPartyCaveatInfo([0m
[30;1m202 | [0m[35m        condition=record.get('Condition'),[0m
[30;1m203 | [0m[35m        first_party_public_key=PublicKey(fp_key),[0m
[30;1m204 | [0m[35m        third_party_key_pair=key,[0m
[30;1m205 | [0m[35m        root_key=base64.b64decode(record.get('RootKey')),[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m    c = box.decrypt(secret, nonce)[0m
[30;1m198 | [0m[35m    record = json.loads(c.decode('utf-8'))[0m
[30;1m199 | [0m[35m    fp_key = nacl.public.PublicKey([0m
[30;1m200 | [0m[35m        base64.b64decode(wrapper.get('FirstPartyPublicKey')))[0m
[30;1m201 | [0m[35m    return ThirdPartyCaveatInfo([0m
[30;1m202 | [0m[35m        condition=record.get('Condition'),[0m
[30;1m203 | [0m[35m        first_party_public_key=PublicKey(fp_key),[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m    nonce = base64.b64decode(wrapper.get('Nonce'))[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    fp_public_key = nacl.public.PublicKey(base64.b64decode([0m
[30;1m194 | [0m[35m        wrapper.get('FirstPartyPublicKey')))[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    box = nacl.public.Box(key.key, fp_public_key)[0m
[30;1m197 | [0m[35m    c = box.decrypt(secret, nonce)[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # The encrypted string is base64 encoded in the JSON representation.[0m
[30;1m190 | [0m[35m    secret = base64.b64decode(wrapper.get('Id'))[0m
[30;1m191 | [0m[35m    nonce = base64.b64decode(wrapper.get('Nonce'))[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    fp_public_key = nacl.public.PublicKey(base64.b64decode([0m
[30;1m194 | [0m[35m        wrapper.get('FirstPartyPublicKey')))[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m        raise Exception('target service public key not specified')[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # The encrypted string is base64 encoded in the JSON representation.[0m
[30;1m190 | [0m[35m    secret = base64.b64decode(wrapper.get('Id'))[0m
[30;1m191 | [0m[35m    nonce = base64.b64decode(wrapper.get('Nonce'))[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    fp_public_key = nacl.public.PublicKey(base64.b64decode([0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m    if key.public_key.key != tp_public_key:[0m
[30;1m184 | [0m[35m        raise Exception('public key mismatch')  # TODO[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    if wrapper.get('FirstPartyPublicKey', None) is None:[0m
[30;1m187 | [0m[35m        raise Exception('target service public key not specified')[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # The encrypted string is base64 encoded in the JSON representation.[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m    if wrapper.get('FirstPartyPublicKey', None) is None:[0m
[30;1m187 | [0m[35m        raise Exception('target service public key not specified')[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # The encrypted string is base64 encoded in the JSON representation.[0m
[30;1m190 | [0m[35m    secret = base64.b64decode(wrapper.get('Id'))[0m
[30;1m191 | [0m[35m    nonce = base64.b64decode(wrapper.get('Nonce'))[0m
[30;1m192 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m184 | [0m[35m        raise Exception('public key mismatch')  # TODO[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    if wrapper.get('FirstPartyPublicKey', None) is None:[0m
[30;1m187 | [0m[35m        raise Exception('target service public key not specified')[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # The encrypted string is base64 encoded in the JSON representation.[0m
[30;1m190 | [0m[35m    secret = base64.b64decode(wrapper.get('Id'))[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m    '''Decode a base64 encoded JSON id.[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    @param key the nacl private key to decode.[0m
[30;1m176 | [0m[35m    @param caveat a base64 encoded JSON string.[0m
[30;1m177 | [0m[35m    '''[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    data = base64.b64decode(caveat).decode('utf-8')[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35mdef _decode_caveat_v1(key, caveat):[0m
[30;1m173 | [0m[35m    '''Decode a base64 encoded JSON id.[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    @param key the nacl private key to decode.[0m
[30;1m176 | [0m[35m    @param caveat a base64 encoded JSON string.[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    first = caveat[:1][0m
[30;1m154 | [0m[35m    if first == b'e':[0m
[30;1m155 | [0m[35m        # 'e' will be the first byte if the caveatid is a base64[0m
[30;1m156 | [0m[35m        # encoded JSON object.[0m
[30;1m157 | [0m[35m        return _decode_caveat_v1(key, caveat)[0m
[30;1m158 | [0m[35m    first_as_int = six.byte2int(first)[0m
[30;1m159 | [0m[35m    if (first_as_int == VERSION_2 or[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    @param root_key bytes[0m
[30;1m58 | [0m[35m    @param third_party_pub_key (PublicKey)[0m
[30;1m59 | [0m[35m    @param key (PrivateKey)[0m
[30;1m60 | [0m[35m    @return a base64 encoded bytes[0m
[30;1m61 | [0m[35m    '''[0m
[30;1m62 | [0m[35m    plain_data = json.dumps({[0m
[30;1m63 | [0m[35m        'RootKey': base64.b64encode(root_key).decode('ascii'),[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_codec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom ._versions import (VERSION_1, VERSION_2, VERSION_3)[0m
[30;1m7 | [0m[35mfrom ._third_party import legacy_namespace, ThirdPartyCaveatInfo[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    >>> from macaroonbakery import httpbakery[0m
[30;1m47 | [0m[35m    >>> jar = requests.cookies.RequestsCookieJar()[0m
[30;1m48 | [0m[35m    >>> resp = requests.get('some protected url',[0m
[30;1m49 | [0m[35m                            cookies=jar,[0m
[30;1m50 | [0m[35m                            auth=httpbakery.BakeryAuth(cookies=jar))[0m
[30;1m51 | [0m[35m    >>> resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35mcan get libsodium from a ppa::[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m	$ sudo add-apt-repository ppa:yellow/ppa -y[0m
[30;1m39 | [0m[35m	$ apt-get install libsodium13[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mUsage[0m
[30;1m42 | [0m[35m-----[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m------------[0m
[30;1m31 | [0m[35mThe easiest way to install macaroonbakery is via pip::[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    $ pip install macaroonbakery[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mmacaroonbakery was developed around pymacaroons. On ubuntu, you[0m
[30;1m36 | [0m[35mcan get libsodium from a ppa::[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_bakery.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m        Note that that is almost certain insufficient for production services[0m
[30;1m26 | [0m[35m        that are spread across multiple instances or that need[0m
[30;1m27 | [0m[35m        to persist keys across restarts.[0m
[30;1m28 | [0m[35m        @param locator is used to find out information on third parties when[0m
[30;1m29 | [0m[35m        adding third party caveats. If this is None, no non-local third[0m
[30;1m30 | [0m[35m        party caveats can be added.[0m
[30;1m31 | [0m[35m        @param key holds the private key of the oven. If this is None,[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_bakery.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m                 identity_client=None, checker=None, root_key_store=None,[0m
[30;1m15 | [0m[35m                 authorizer=ClosedAuthorizer()):[0m
[30;1m16 | [0m[35m        '''Returns a new Bakery instance which combines an Oven with a[0m
[30;1m17 | [0m[35m        Checker for the convenience of callers that wish to use both[0m
[30;1m18 | [0m[35m        together.[0m
[30;1m19 | [0m[35m        @param checker holds the checker used to check first party caveats.[0m
[30;1m20 | [0m[35m        If this is None, it will use checkers.Checker(None).[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/docs/Makefile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35mdoctest:[0m
[30;1m165 | [0m[35m	$(SPHINXBUILD) -b doctest $(ALLSPHINXOPTS) $(BUILDDIR)/doctest[0m
[30;1m166 | [0m[35m	@echo "Testing of doctests in the sources finished, look at the " \[0m
[30;1m167 | [0m[35m	      "results in $(BUILDDIR)/doctest/output.txt."[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35mxml:[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m135 | [0m[35m        it must be a naive timestamp in UTC.[0m
[30;1m136 | [0m[35m    '''[0m
[30;1m137 | [0m[35m    u = urlparse(url)[0m
[30;1m138 | [0m[35m    domain = u.hostname[0m
[30;1m139 | [0m[35m    if '.' not in domain and not _is_ip_addr(domain):[0m
[30;1m140 | [0m[35m        domain += ".local"[0m
[30;1m141 | [0m[35m    port = str(u.port) if u.port is not None else None[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m    @param name The cookie name {str}[0m
[30;1m132 | [0m[35m    @param value The cookie value {str}[0m
[30;1m133 | [0m[35m    @param url The URL path of the cookie {str}[0m
[30;1m134 | [0m[35m    @param expires The expiry time of the cookie {datetime}. If provided,[0m
[30;1m135 | [0m[35m        it must be a naive timestamp in UTC.[0m
[30;1m136 | [0m[35m    '''[0m
[30;1m137 | [0m[35m    u = urlparse(url)[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35mdef _remove_base64_padding(b):[0m
[30;1m69 | [0m[35m    '''Remove padding from base64 encoded bytes.[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    pymacaroons does not give padded base64 bytes from serialization.[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    @param bytes b to be padded.[0m
[30;1m74 | [0m[35m    @return a padded bytes.[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mdef _remove_base64_padding(b):[0m
[30;1m69 | [0m[35m    '''Remove padding from base64 encoded bytes.[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    pymacaroons does not give padded base64 bytes from serialization.[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35mdef _add_base64_padding(b):[0m
[30;1m58 | [0m[35m    '''Add padding to base64 encoded bytes.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    pymacaroons does not give padded base64 bytes from serialization.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    @param bytes b to be padded.[0m
[30;1m63 | [0m[35m    @return a padded bytes.[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35mdef _add_base64_padding(b):[0m
[30;1m58 | [0m[35m    '''Add padding to base64 encoded bytes.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    pymacaroons does not give padded base64 bytes from serialization.[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/_utils/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport binascii[0m
[30;1m5 | [0m[35mimport ipaddress[0m
[30;1m6 | [0m[35mimport json[0m
[30;1m7 | [0m[35mimport webbrowser[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_discharge.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        if id is not None:[0m
[30;1m24 | [0m[35m            id = utils.b64decode(id)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    caveat = content.get('caveat64')[0m
[30;1m27 | [0m[35m    if caveat is not None:[0m
[30;1m28 | [0m[35m        caveat = utils.b64decode(caveat)[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_discharge.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    if id is not None:[0m
[30;1m20 | [0m[35m        id = id.encode('utf-8')[0m
[30;1m21 | [0m[35m    else:[0m
[30;1m22 | [0m[35m        id = content.get('id64')[0m
[30;1m23 | [0m[35m        if id is not None:[0m
[30;1m24 | [0m[35m            id = utils.b64decode(id)[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_discharge.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m    party caveats.[0m
[30;1m16 | [0m[35m    @return The discharge macaroon {macaroonbakery.Macaroon}[0m
[30;1m17 | [0m[35m    '''[0m
[30;1m18 | [0m[35m    id = content.get('id')[0m
[30;1m19 | [0m[35m    if id is not None:[0m
[30;1m20 | [0m[35m        id = id.encode('utf-8')[0m
[30;1m21 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m        self.assertEqual(key1, key)[0m
[30;1m18 | [0m[35m        self.assertEqual(id1, id)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m        key2 = st.get(id)[0m
[30;1m21 | [0m[35m        self.assertEqual(key2, key)[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_declared.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        if len(parts) != 2:[0m
[30;1m60 | [0m[35m            continue[0m
[30;1m61 | [0m[35m        key, val = parts[0], parts[1][0m
[30;1m62 | [0m[35m        old_val = info.get(key)[0m
[30;1m63 | [0m[35m        if old_val is not None and old_val != val:[0m
[30;1m64 | [0m[35m            conflicts.append(key)[0m
[30;1m65 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_discharge.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m    # Add empty declarations for everything mentioned in need-declared[0m
[30;1m222 | [0m[35m    # that was not actually declared.[0m
[30;1m223 | [0m[35m    for d in need_declared:[0m
[30;1m224 | [0m[35m        if not declared.get(d, False):[0m
[30;1m225 | [0m[35m            caveats.append(checkers.declared_caveat(d, ''))[0m
[30;1m226 | [0m[35m    return caveats[0m
[30;1m227 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_discharge.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        for cav in m.macaroon.caveats:[0m
[30;1m54 | [0m[35m            if cav.location is None or cav.location == '':[0m
[30;1m55 | [0m[35m                continue[0m
[30;1m56 | [0m[35m            encrypted_caveat = m.caveat_data.get(cav.caveat_id, None)[0m
[30;1m57 | [0m[35m            need.append([0m
[30;1m58 | [0m[35m                _NeedCaveat(cav=cav,[0m
[30;1m59 | [0m[35m                            encrypted_caveat=encrypted_caveat))[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35m    for cav in caveats:[0m
[30;1m207 | [0m[35m        if cav.location is not None and cav.location != '':[0m
[30;1m208 | [0m[35m            continue[0m
[30;1m209 | [0m[35m        # Note that we ignore the error. We allow the service to[0m
[30;1m210 | [0m[35m        # generate caveats that we don't understand here.[0m
[30;1m211 | [0m[35m        try:[0m
[30;1m212 | [0m[35m            cond, arg = checkers.parse_caveat(cav.condition)[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_authorizer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m                return False[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        def get_acl(ctx, acl):[0m
[30;1m114 | [0m[35m            self.assertEqual(ctx.get('a'), 'aval')[0m
[30;1m115 | [0m[35m            Visited.in_get_acl = True[0m
[30;1m116 | [0m[35m            return [][0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_authorizer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        class TestIdentity(SimplestIdentity, bakery.ACLIdentity):[0m
[30;1m108 | [0m[35m            def allow(other, ctx, acls):[0m
[30;1m109 | [0m[35m                self.assertEqual(ctx.get('a'), 'aval')[0m
[30;1m110 | [0m[35m                Visited.in_allow = True[0m
[30;1m111 | [0m[35m                return False[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_authorizer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m            in_get_acl = False[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        def f(ctx, identity, op):[0m
[30;1m98 | [0m[35m            self.assertEqual(ctx.get('a'), 'aval')[0m
[30;1m99 | [0m[35m            Visited.in_f = True[0m
[30;1m100 | [0m[35m            return False, None[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checkers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m313 | [0m[35m        register('other', 'three')[0m
[30;1m314 | [0m[35m        register('xxx', 'four')[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m        expect = [[0m
[30;1m317 | [0m[35m            checkers.CheckerInfo(ns='four', name='xxx', prefix='s'),[0m
[30;1m318 | [0m[35m            checkers.CheckerInfo(ns='one', name='x', prefix='t'),[0m
[30;1m319 | [0m[35m            checkers.CheckerInfo(ns='one', name='y', prefix='t'),[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_checkers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport six[0m
[30;1m8 | [0m[35mfrom pymacaroons import MACAROON_V2, Macaroon[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m# A frozen time for the tests.[0m
[30;1m11 | [0m[35mNOW = datetime([0m
[30;1m12 | [0m[35m    year=2006, month=1, day=2, hour=15, minute=4, second=5, microsecond=123)[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m        cookie_name_suffix = serialized.get('CookieNameSuffix')[0m
[30;1m191 | [0m[35m        visit_url = serialized.get('VisitURL')[0m
[30;1m192 | [0m[35m        wait_url = serialized.get('WaitURL')[0m
[30;1m193 | [0m[35m        interaction_methods = serialized.get('InteractionMethods')[0m
[30;1m194 | [0m[35m        return ErrorInfo(macaroon=macaroon, macaroon_path=path,[0m
[30;1m195 | [0m[35m                         cookie_name_suffix=cookie_name_suffix,[0m
[30;1m196 | [0m[35m                         visit_url=visit_url, wait_url=wait_url,[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m        path = serialized.get('MacaroonPath')[0m
[30;1m190 | [0m[35m        cookie_name_suffix = serialized.get('CookieNameSuffix')[0m
[30;1m191 | [0m[35m        visit_url = serialized.get('VisitURL')[0m
[30;1m192 | [0m[35m        wait_url = serialized.get('WaitURL')[0m
[30;1m193 | [0m[35m        interaction_methods = serialized.get('InteractionMethods')[0m
[30;1m194 | [0m[35m        return ErrorInfo(macaroon=macaroon, macaroon_path=path,[0m
[30;1m195 | [0m[35m                         cookie_name_suffix=cookie_name_suffix,[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m            macaroon = bakery.Macaroon.from_dict(macaroon)[0m
[30;1m189 | [0m[35m        path = serialized.get('MacaroonPath')[0m
[30;1m190 | [0m[35m        cookie_name_suffix = serialized.get('CookieNameSuffix')[0m
[30;1m191 | [0m[35m        visit_url = serialized.get('VisitURL')[0m
[30;1m192 | [0m[35m        wait_url = serialized.get('WaitURL')[0m
[30;1m193 | [0m[35m        interaction_methods = serialized.get('InteractionMethods')[0m
[30;1m194 | [0m[35m        return ErrorInfo(macaroon=macaroon, macaroon_path=path,[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m        if macaroon is not None:[0m
[30;1m188 | [0m[35m            macaroon = bakery.Macaroon.from_dict(macaroon)[0m
[30;1m189 | [0m[35m        path = serialized.get('MacaroonPath')[0m
[30;1m190 | [0m[35m        cookie_name_suffix = serialized.get('CookieNameSuffix')[0m
[30;1m191 | [0m[35m        visit_url = serialized.get('VisitURL')[0m
[30;1m192 | [0m[35m        wait_url = serialized.get('WaitURL')[0m
[30;1m193 | [0m[35m        interaction_methods = serialized.get('InteractionMethods')[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m        macaroon = serialized.get('Macaroon')[0m
[30;1m187 | [0m[35m        if macaroon is not None:[0m
[30;1m188 | [0m[35m            macaroon = bakery.Macaroon.from_dict(macaroon)[0m
[30;1m189 | [0m[35m        path = serialized.get('MacaroonPath')[0m
[30;1m190 | [0m[35m        cookie_name_suffix = serialized.get('CookieNameSuffix')[0m
[30;1m191 | [0m[35m        visit_url = serialized.get('VisitURL')[0m
[30;1m192 | [0m[35m        wait_url = serialized.get('WaitURL')[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m        '''[0m
[30;1m184 | [0m[35m        if serialized is None:[0m
[30;1m185 | [0m[35m            return None[0m
[30;1m186 | [0m[35m        macaroon = serialized.get('Macaroon')[0m
[30;1m187 | [0m[35m        if macaroon is not None:[0m
[30;1m188 | [0m[35m            macaroon = bakery.Macaroon.from_dict(macaroon)[0m
[30;1m189 | [0m[35m        path = serialized.get('MacaroonPath')[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m                'not an interaction-required error (code {})'.format([0m
[30;1m133 | [0m[35m                    self.code)[0m
[30;1m134 | [0m[35m            )[0m
[30;1m135 | [0m[35m        entry = self.info.interaction_methods.get(kind)[0m
[30;1m136 | [0m[35m        if entry is None:[0m
[30;1m137 | [0m[35m            raise InteractionMethodNotFound([0m
[30;1m138 | [0m[35m                'interaction method {} not found'.format(kind)[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        # Some servers return lower case field names for message and code.[0m
[30;1m110 | [0m[35m        # The Go client is tolerant of this, so be similarly tolerant here.[0m
[30;1m111 | [0m[35m        def field(name):[0m
[30;1m112 | [0m[35m            return serialized.get(name) or serialized.get(name.lower())[0m
[30;1m113 | [0m[35m        return Error([0m
[30;1m114 | [0m[35m            code=field('Code'),[0m
[30;1m115 | [0m[35m            message=field('Message'),[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        # Some servers return lower case field names for message and code.[0m
[30;1m110 | [0m[35m        # The Go client is tolerant of this, so be similarly tolerant here.[0m
[30;1m111 | [0m[35m        def field(name):[0m
[30;1m112 | [0m[35m            return serialized.get(name) or serialized.get(name.lower())[0m
[30;1m113 | [0m[35m        return Error([0m
[30;1m114 | [0m[35m            code=field('Code'),[0m
[30;1m115 | [0m[35m            message=field('Message'),[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    @param req_headers: the request headers as a dict.[0m
[30;1m82 | [0m[35m    @return: bakery protocol version (for example macaroonbakery.VERSION_1)[0m
[30;1m83 | [0m[35m    '''[0m
[30;1m84 | [0m[35m    vs = req_headers.get(BAKERY_PROTOCOL_HEADER)[0m
[30;1m85 | [0m[35m    if vs is None:[0m
[30;1m86 | [0m[35m        # No header - use backward compatibility mode.[0m
[30;1m87 | [0m[35m        return bakery.VERSION_1[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_error.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mclass InteractionMethodNotFound(Exception):[0m
[30;1m13 | [0m[35m    '''This is thrown by client-side interaction methods when[0m
[30;1m14 | [0m[35m    they find that a given interaction isn't supported by the[0m
[30;1m15 | [0m[35m    client for a location'''[0m
[30;1m16 | [0m[35m    pass[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m    def test_secure_cookie_for_https(self):[0m
[30;1m277 | [0m[35m        client = httpbakery.Client()[0m
[30;1m278 | [0m[35m        with HTTMock(first_407_then_200_with_port), HTTMock(discharge_200):[0m
[30;1m279 | [0m[35m                resp = requests.get([0m
[30;1m280 | [0m[35m                    'https://example.com:8000/someprotecteurl',[0m
[30;1m281 | [0m[35m                    cookies=client.cookies,[0m
[30;1m282 | [0m[35m                    auth=client.auth())[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m        client = httpbakery.Client()[0m
[30;1m268 | [0m[35m        with HTTMock(first_407_then_200_with_port):[0m
[30;1m269 | [0m[35m            with HTTMock(discharge_200):[0m
[30;1m270 | [0m[35m                resp = requests.get('http://example.com:8000/someprotecteurl',[0m
[30;1m271 | [0m[35m                                    cookies=client.cookies,[0m
[30;1m272 | [0m[35m                                    auth=client.auth())[0m
[30;1m273 | [0m[35m        resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m        with HTTMock(first_407_then_200), HTTMock(discharge_401),\[0m
[30;1m253 | [0m[35m                HTTMock(visit_200):[0m
[30;1m254 | [0m[35m            with self.assertRaises(httpbakery.InteractionError) as exc:[0m
[30;1m255 | [0m[35m                requests.get([0m
[30;1m256 | [0m[35m                    ID_PATH,[0m
[30;1m257 | [0m[35m                    cookies=client.cookies,[0m
[30;1m258 | [0m[35m                    auth=client.auth(),[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m        client = httpbakery.Client(interaction_methods=[])[0m
[30;1m236 | [0m[35m        with HTTMock(first_407_then_200), HTTMock(discharge_401):[0m
[30;1m237 | [0m[35m            with self.assertRaises(httpbakery.InteractionError) as exc:[0m
[30;1m238 | [0m[35m                requests.get([0m
[30;1m239 | [0m[35m                    ID_PATH,[0m
[30;1m240 | [0m[35m                    cookies=client.cookies,[0m
[30;1m241 | [0m[35m                    auth=client.auth(),[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        with HTTMock(first_407_then_200), HTTMock(discharge_401),\[0m
[30;1m222 | [0m[35m                HTTMock(wait_on_error):[0m
[30;1m223 | [0m[35m            with self.assertRaises(httpbakery.InteractionError) as exc:[0m
[30;1m224 | [0m[35m                requests.get([0m
[30;1m225 | [0m[35m                    ID_PATH,[0m
[30;1m226 | [0m[35m                    cookies=client.cookies,[0m
[30;1m227 | [0m[35m                    auth=client.auth(),[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        client = httpbakery.Client()[0m
[30;1m207 | [0m[35m        with HTTMock(first_407_then_200), HTTMock(discharge_401), \[0m
[30;1m208 | [0m[35m                HTTMock(wait_after_401):[0m
[30;1m209 | [0m[35m                resp = requests.get([0m
[30;1m210 | [0m[35m                    ID_PATH,[0m
[30;1m211 | [0m[35m                    cookies=client.cookies,[0m
[30;1m212 | [0m[35m                    auth=client.auth(),[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m    def test_discharge(self):[0m
[30;1m194 | [0m[35m        client = httpbakery.Client()[0m
[30;1m195 | [0m[35m        with HTTMock(first_407_then_200), HTTMock(discharge_200):[0m
[30;1m196 | [0m[35m                resp = requests.get(ID_PATH,[0m
[30;1m197 | [0m[35m                                    cookies=client.cookies,[0m
[30;1m198 | [0m[35m                                    auth=client.auth())[0m
[30;1m199 | [0m[35m        resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m@urlmatch(netloc='example.com:8000', path='.*/someprotecteurl')[0m
[30;1m86 | [0m[35mdef first_407_then_200_with_port(url, request):[0m
[30;1m87 | [0m[35m    if request.headers.get('cookie', '').startswith('macaroon-'):[0m
[30;1m88 | [0m[35m        return {[0m
[30;1m89 | [0m[35m            'status_code': 200,[0m
[30;1m90 | [0m[35m            'content': {[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_bakery.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m@urlmatch(path='.*/someprotecteurl')[0m
[30;1m61 | [0m[35mdef first_407_then_200(url, request):[0m
[30;1m62 | [0m[35m    if request.headers.get('cookie', '').startswith('macaroon-'):[0m
[30;1m63 | [0m[35m        return {[0m
[30;1m64 | [0m[35m            'status_code': 200,[0m
[30;1m65 | [0m[35m            'content': {[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m        for m in json_resp:[0m
[30;1m401 | [0m[35m            method_urls[m] = urljoin(u, json_resp[m])[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m    if method_urls.get('interactive') is None:[0m
[30;1m404 | [0m[35m        # There's no "interactive" method returned, but we know[0m
[30;1m405 | [0m[35m        # the server does actually support it, because all dischargers[0m
[30;1m406 | [0m[35m        # are required to, so fill it in with the original URL.[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m        BAKERY_PROTOCOL_HEADER: str(bakery.LATEST_VERSION),[0m
[30;1m394 | [0m[35m        'Accept': 'application/json'[0m
[30;1m395 | [0m[35m    }[0m
[30;1m396 | [0m[35m    resp = requests.get(url=u, headers=headers)[0m
[30;1m397 | [0m[35m    method_urls = {}[0m
[30;1m398 | [0m[35m    if resp.status_code == 200:[0m
[30;1m399 | [0m[35m        json_resp = resp.json()[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m    if resp.status_code != 200:[0m
[30;1m380 | [0m[35m        raise InteractionError('cannot get {}'.format(wait_url))[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m    return bakery.Macaroon.from_dict(resp.json().get('Macaroon'))[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35mdef _legacy_get_interaction_methods(u):[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m    headers = {[0m
[30;1m376 | [0m[35m        BAKERY_PROTOCOL_HEADER: str(bakery.LATEST_VERSION)[0m
[30;1m377 | [0m[35m    }[0m
[30;1m378 | [0m[35m    resp = requests.get(url=wait_url, headers=headers)[0m
[30;1m379 | [0m[35m    if resp.status_code != 200:[0m
[30;1m380 | [0m[35m        raise InteractionError('cannot get {}'.format(wait_url))[0m
[30;1m381 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m        try:[0m
[30;1m323 | [0m[35m            return headers_or_request.get_header(key, default)[0m
[30;1m324 | [0m[35m        except AttributeError:[0m
[30;1m325 | [0m[35m            return headers_or_request.get(key, default)[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m    mss = [][0m
[30;1m328 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        if response.headers.get('Content-Type') != 'application/json':[0m
[30;1m291 | [0m[35m            return response[0m
[30;1m292 | [0m[35m        errorJSON = response.json()[0m
[30;1m293 | [0m[35m        if errorJSON.get('Code') != ERR_DISCHARGE_REQUIRED:[0m
[30;1m294 | [0m[35m            return response[0m
[30;1m295 | [0m[35m        error = Error.from_dict(errorJSON)[0m
[30;1m296 | [0m[35m        Retry.count += 1[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m                'Macaroon'):[0m
[30;1m288 | [0m[35m            return response[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m        if response.headers.get('Content-Type') != 'application/json':[0m
[30;1m291 | [0m[35m            return response[0m
[30;1m292 | [0m[35m        errorJSON = response.json()[0m
[30;1m293 | [0m[35m        if errorJSON.get('Code') != ERR_DISCHARGE_REQUIRED:[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        if status_code != 407 and status_code != 401:[0m
[30;1m285 | [0m[35m            return response[0m
[30;1m286 | [0m[35m        if (status_code == 401 and response.headers.get('WWW-Authenticate') !=[0m
[30;1m287 | [0m[35m                'Macaroon'):[0m
[30;1m288 | [0m[35m            return response[0m
[30;1m289 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m                # Legacy interaction mode isn't supported.[0m
[30;1m232 | [0m[35m                continue[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m            visit_url = method_urls.get(kind)[0m
[30;1m235 | [0m[35m            if visit_url is None:[0m
[30;1m236 | [0m[35m                continue[0m
[30;1m237 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m            # It's an old-style error; deal with it differently.[0m
[30;1m195 | [0m[35m            return None, self._legacy_interact(location, error_info)[0m
[30;1m196 | [0m[35m        for interactor in self._interaction_methods:[0m
[30;1m197 | [0m[35m            found = error_info.info.interaction_methods.get(interactor.kind())[0m
[30;1m198 | [0m[35m            if found is None:[0m
[30;1m199 | [0m[35m                continue[0m
[30;1m200 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m        headers = {[0m
[30;1m178 | [0m[35m            BAKERY_PROTOCOL_HEADER: str(bakery.LATEST_VERSION)[0m
[30;1m179 | [0m[35m        }[0m
[30;1m180 | [0m[35m        return self.request('POST', target, data=req, headers=headers)[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    def _interact(self, location, error_info, payload):[0m
[30;1m183 | [0m[35m        '''Gathers a macaroon by directing the user to interact with a[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        # the token acquired by the interaction method.[0m
[30;1m157 | [0m[35m        resp = self._acquire_discharge_with_token(cav, payload, token)[0m
[30;1m158 | [0m[35m        if resp.status_code == 200:[0m
[30;1m159 | [0m[35m            return bakery.Macaroon.from_dict(resp.json().get('Macaroon'))[0m
[30;1m160 | [0m[35m        else:[0m
[30;1m161 | [0m[35m            raise DischargeError([0m
[30;1m162 | [0m[35m                'discharge failed with code {}'.format(resp.status_code))[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m        resp = self._acquire_discharge_with_token(cav, payload, None)[0m
[30;1m131 | [0m[35m        # TODO Fabrice what is the other http response possible ??[0m
[30;1m132 | [0m[35m        if resp.status_code == 200:[0m
[30;1m133 | [0m[35m            return bakery.Macaroon.from_dict(resp.json().get('Macaroon'))[0m
[30;1m134 | [0m[35m        # A 5xx error might not return json.[0m
[30;1m135 | [0m[35m        try:[0m
[30;1m136 | [0m[35m            cause = Error.from_dict(resp.json())[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        # mentioned in kwargs?[0m
[30;1m85 | [0m[35m        kwargs['auth'] = self.auth()[0m
[30;1m86 | [0m[35m        kwargs['cookies'] = self.cookies[0m
[30;1m87 | [0m[35m        return requests.request(method=method, url=url, **kwargs)[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    def handle_error(self, error, url):[0m
[30;1m90 | [0m[35m        '''Try to resolve the given error, which should be a response[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        '''Use the requests library to make a request.[0m
[30;1m79 | [0m[35m        Using this method is like doing:[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m            requests.request(method, url, auth=client.auth())[0m
[30;1m82 | [0m[35m        '''[0m
[30;1m83 | [0m[35m        # TODO should we raise an exception if auth or cookies are explicitly[0m
[30;1m84 | [0m[35m        # mentioned in kwargs?[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m    For example:[0m
[30;1m48 | [0m[35m        import macaroonbakery.httpbakery[0m
[30;1m49 | [0m[35m        client = httpbakery.Client()[0m
[30;1m50 | [0m[35m        resp = requests.get('some protected url',[0m
[30;1m51 | [0m[35m                            cookies=client.cookies,[0m
[30;1m52 | [0m[35m                            auth=client.auth())[0m
[30;1m53 | [0m[35m    @param interaction_methods A list of Interactor implementations.[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35mdef _legacy_get_interaction_methods(u):[0m
[30;1m386 | [0m[35m    ''' Queries a URL as found in an ErrInteractionRequired VisitURL field to[0m
[30;1m387 | [0m[35m    find available interaction methods.[0m
[30;1m388 | [0m[35m    It does this by sending a GET request to the URL with the Accept[0m
[30;1m389 | [0m[35m    header set to "application/json" and parsing the resulting[0m
[30;1m390 | [0m[35m    response as a dict.[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m358 | [0m[35mdef _add_json_binary_field(b, serialized, field):[0m
[30;1m359 | [0m[35m    '''' Set the given field to the given val (bytes) in the serialized[0m
[30;1m360 | [0m[35m    dictionary.[0m
[30;1m361 | [0m[35m    If the value isn't valid utf-8, we base64 encode it and use field+"64"[0m
[30;1m362 | [0m[35m    as the field name.[0m
[30;1m363 | [0m[35m    '''[0m
[30;1m364 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m        if m is not None:[0m
[30;1m153 | [0m[35m            # We've acquired the macaroon directly via legacy interaction.[0m
[30;1m154 | [0m[35m            return m[0m
[30;1m155 | [0m[35m        # Try to acquire the discharge again, but this time with[0m
[30;1m156 | [0m[35m        # the token acquired by the interaction method.[0m
[30;1m157 | [0m[35m        resp = self._acquire_discharge_with_token(cav, payload, token)[0m
[30;1m158 | [0m[35m        if resp.status_code == 200:[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport macaroonbakery.bakery as bakery[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/CONTRIBUTING.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m43 | [0m[35mSubmit Feedback[0m
[30;1m44 | [0m[35m~~~~~~~~~~~~~~~[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mThe best way to send feedback is to file an issue at[0m
[30;1m47 | [0m[35mhttps://github.com/go-macaroon-bakery/py-macaroon-bakery/issues.[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mIf you are proposing a feature:[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/CONTRIBUTING.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m13 | [0m[35mReport Bugs[0m
[30;1m14 | [0m[35m~~~~~~~~~~~[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mReport bugs at https://github.com/go-macaroon-bakery/py-macaroon-bakery/issues.[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mIf you are reporting a bug, please include:[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/CONTRIBUTING.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    $ git add .[0m
[30;1m83 | [0m[35m    $ git commit -m "Your detailed description of your changes."[0m
[30;1m84 | [0m[35m    $ git push origin name-of-your-bugfix-or-feature[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m7. Submit a pull request through the GitHub website.[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/CONTRIBUTING.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m6. Commit your changes and push your branch to GitHub::[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    $ git add .[0m
[30;1m83 | [0m[35m    $ git commit -m "Your detailed description of your changes."[0m
[30;1m84 | [0m[35m    $ git push origin name-of-your-bugfix-or-feature[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m7. Submit a pull request through the GitHub website.[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/CONTRIBUTING.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m6. Commit your changes and push your branch to GitHub::[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    $ git add .[0m
[30;1m83 | [0m[35m    $ git commit -m "Your detailed description of your changes."[0m
[30;1m84 | [0m[35m    $ git push origin name-of-your-bugfix-or-feature[0m
[30;1m85 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/CONTRIBUTING.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m4. Create a branch for local development::[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    $ git checkout -b name-of-your-bugfix-or-feature[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m   Now you can make your changes locally.[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/CONTRIBUTING.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m1. Fork the `py-macaroon-bakery` repo on GitHub.[0m
[30;1m61 | [0m[35m2. Clone your fork locally::[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    $ git clone git@github.com:your_name_here/py-macaroon-bakery.git[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m3. Prepare your development environment::[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        '''[0m
[30;1m88 | [0m[35m        return WebBrowserInteractionInfo([0m
[30;1m89 | [0m[35m            visit_url=info_dict.get('VisitURL'),[0m
[30;1m90 | [0m[35m            wait_token_url=info_dict.get('WaitTokenURL'))[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        @return a new WebBrowserInteractionInfo object.[0m
[30;1m87 | [0m[35m        '''[0m
[30;1m88 | [0m[35m        return WebBrowserInteractionInfo([0m
[30;1m89 | [0m[35m            visit_url=info_dict.get('VisitURL'),[0m
[30;1m90 | [0m[35m            wait_token_url=info_dict.get('WaitTokenURL'))[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m                'cannot get kind token from {}'.format(wait_token_url))[0m
[30;1m62 | [0m[35m        token_val = json_resp.get('token')[0m
[30;1m63 | [0m[35m        if token_val is None:[0m
[30;1m64 | [0m[35m            token_val = json_resp.get('token64')[0m
[30;1m65 | [0m[35m            if token_val is None:[0m
[30;1m66 | [0m[35m                raise InteractionError([0m
[30;1m67 | [0m[35m                    'cannot get token from {}'.format(wait_token_url))[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        if kind is None:[0m
[30;1m60 | [0m[35m            raise InteractionError([0m
[30;1m61 | [0m[35m                'cannot get kind token from {}'.format(wait_token_url))[0m
[30;1m62 | [0m[35m        token_val = json_resp.get('token')[0m
[30;1m63 | [0m[35m        if token_val is None:[0m
[30;1m64 | [0m[35m            token_val = json_resp.get('token64')[0m
[30;1m65 | [0m[35m            if token_val is None:[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        if resp.status_code != 200:[0m
[30;1m56 | [0m[35m            raise InteractionError('cannot get {}'.format(wait_token_url))[0m
[30;1m57 | [0m[35m        json_resp = resp.json()[0m
[30;1m58 | [0m[35m        kind = json_resp.get('kind')[0m
[30;1m59 | [0m[35m        if kind is None:[0m
[30;1m60 | [0m[35m            raise InteractionError([0m
[30;1m61 | [0m[35m                'cannot get kind token from {}'.format(wait_token_url))[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m        @param wait_token_url URL to wait for (string)[0m
[30;1m52 | [0m[35m        :return DischargeToken[0m
[30;1m53 | [0m[35m        '''[0m
[30;1m54 | [0m[35m        resp = requests.get(wait_token_url)[0m
[30;1m55 | [0m[35m        if resp.status_code != 200:[0m
[30;1m56 | [0m[35m            raise InteractionError('cannot get {}'.format(wait_token_url))[0m
[30;1m57 | [0m[35m        json_resp = resp.json()[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_browser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mfrom collections import namedtuple[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport requests[0m
[30;1m7 | [0m[35mfrom ._error import InteractionError[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    def get_ops(self, key):[0m
[30;1m20 | [0m[35m        ''' Returns ops from the key if found otherwise raises a KeyError.[0m
[30;1m21 | [0m[35m        '''[0m
[30;1m22 | [0m[35m        ops = self._store.get(key)[0m
[30;1m23 | [0m[35m        if ops is None:[0m
[30;1m24 | [0m[35m            raise KeyError([0m
[30;1m25 | [0m[35m                'cannot get operations for {}'.format(key))[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_store.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m    def put_ops(self, key, time, ops):[0m
[30;1m14 | [0m[35m        ''' Put an ops only if not already there, otherwise it's a no op.[0m
[30;1m15 | [0m[35m        '''[0m
[30;1m16 | [0m[35m        if self._store.get(key) is None:[0m
[30;1m17 | [0m[35m            self._store[key] = ops[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    def get_ops(self, key):[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_store.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m        Note that the root keys should remain available for as long as the[0m
[30;1m49 | [0m[35m        macaroons using them are valid.[0m
[30;1m50 | [0m[35m        Note that there is no need for it to return a new root key for every[0m
[30;1m51 | [0m[35m        call - keys may be reused, although some key cycling is over time is[0m
[30;1m52 | [0m[35m        advisable.[0m
[30;1m53 | [0m[35m        @return: bytes[0m
[30;1m54 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_keyring.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m            version=version,[0m
[30;1m58 | [0m[35m            public_key=idm_pk[0m
[30;1m59 | [0m[35m        )[0m
[30;1m60 | [0m[35m        return self._cache.get(loc)[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_keyring.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m            raise bakery.ThirdPartyInfoNotFound([0m
[30;1m53 | [0m[35m                'no public key found in /discharge/info')[0m
[30;1m54 | [0m[35m        idm_pk = bakery.PublicKey.deserialize(pk)[0m
[30;1m55 | [0m[35m        version = json_resp.get('Version', bakery.VERSION_1)[0m
[30;1m56 | [0m[35m        self._cache[loc] = bakery.ThirdPartyInfo([0m
[30;1m57 | [0m[35m            version=version,[0m
[30;1m58 | [0m[35m            public_key=idm_pk[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_keyring.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m        if json_resp is None:[0m
[30;1m48 | [0m[35m            raise bakery.ThirdPartyInfoNotFound([0m
[30;1m49 | [0m[35m                'no response from /discharge/info')[0m
[30;1m50 | [0m[35m        pk = json_resp.get('PublicKey')[0m
[30;1m51 | [0m[35m        if pk is None:[0m
[30;1m52 | [0m[35m            raise bakery.ThirdPartyInfoNotFound([0m
[30;1m53 | [0m[35m                'no public key found in /discharge/info')[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_keyring.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        status_code = resp.status_code[0m
[30;1m39 | [0m[35m        if status_code == 404:[0m
[30;1m40 | [0m[35m            url_endpoint = '/publickey'[0m
[30;1m41 | [0m[35m            resp = requests.get(url=loc + url_endpoint, headers=headers)[0m
[30;1m42 | [0m[35m            status_code = resp.status_code[0m
[30;1m43 | [0m[35m        if status_code != 200:[0m
[30;1m44 | [0m[35m            raise bakery.ThirdPartyInfoNotFound([0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_keyring.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m        headers = {[0m
[30;1m35 | [0m[35m            BAKERY_PROTOCOL_HEADER: str(bakery.LATEST_VERSION)[0m
[30;1m36 | [0m[35m        }[0m
[30;1m37 | [0m[35m        resp = requests.get(url=loc + url_endpoint, headers=headers)[0m
[30;1m38 | [0m[35m        status_code = resp.status_code[0m
[30;1m39 | [0m[35m        if status_code == 404:[0m
[30;1m40 | [0m[35m            url_endpoint = '/publickey'[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_keyring.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m            raise bakery.ThirdPartyInfoNotFound([0m
[30;1m28 | [0m[35m                'untrusted discharge URL {}'.format(loc))[0m
[30;1m29 | [0m[35m        loc = loc.rstrip('/')[0m
[30;1m30 | [0m[35m        info = self._cache.get(loc)[0m
[30;1m31 | [0m[35m        if info is not None:[0m
[30;1m32 | [0m[35m            return info[0m
[30;1m33 | [0m[35m        url_endpoint = '/discharge/info'[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/httpbakery/_keyring.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mclass ThirdPartyLocator(bakery.ThirdPartyLocator):[0m
[30;1m11 | [0m[35m    ''' Implements macaroonbakery.ThirdPartyLocator by first looking in the[0m
[30;1m12 | [0m[35m    backing cache and, if that fails, making an HTTP request to find the[0m
[30;1m13 | [0m[35m    information associated with the given discharge location.[0m
[30;1m14 | [0m[35m    '''[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m            raise ValueError('no macaroons provided')[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m        storage_id, ops = _decode_macaroon_id(macaroons[0].identifier_bytes)[0m
[30;1m167 | [0m[35m        root_key = self.root_keystore_for_ops(ops).get(storage_id)[0m
[30;1m168 | [0m[35m        if root_key is None:[0m
[30;1m169 | [0m[35m            raise VerificationError([0m
[30;1m170 | [0m[35m                'macaroon key not found in storage')[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m279 | [0m[35mdef _macaroon_id_ops(ops):[0m
[30;1m280 | [0m[35m    '''Return operations suitable for serializing as part of a MacaroonId.[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m    It assumes that ops has been canonicalized and that there's at least[0m
[30;1m283 | [0m[35m    one operation.[0m
[30;1m284 | [0m[35m    '''[0m
[30;1m285 | [0m[35m    id_ops = [][0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m231 | [0m[35m    # they're using the same root key.[0m
[30;1m232 | [0m[35m    first = six.byte2int(id[:1])[0m
[30;1m233 | [0m[35m    if first == VERSION_2:[0m
[30;1m234 | [0m[35m        # Skip the UUID at the start of the id.[0m
[30;1m235 | [0m[35m        storage_id = id[1 + 16:][0m
[30;1m236 | [0m[35m    if first == VERSION_3:[0m
[30;1m237 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35m        try:[0m
[30;1m181 | [0m[35m            v.verify(macaroons[0], root_key, macaroons[1:])[0m
[30;1m182 | [0m[35m        except Exception as exc:[0m
[30;1m183 | [0m[35m            # Unfortunately pymacaroons doesn't control[0m
[30;1m184 | [0m[35m            # the set of exceptions that can be raised here.[0m
[30;1m185 | [0m[35m            # Possible candidates are:[0m
[30;1m186 | [0m[35m            # pymacaroons.exceptions.MacaroonUnmetCaveatException[0m
[30;1m187 | [0m[35m            # pymacaroons.exceptions.MacaroonInvalidSignatureException[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m136 | [0m[35m        ''' Returns a new multi-op entity name string that represents[0m
[30;1m137 | [0m[35m        all the given operations and caveats. It returns the same value[0m
[30;1m138 | [0m[35m        regardless of the ordering of the operations. It assumes that the[0m
[30;1m139 | [0m[35m        operations have been canonicalized and that there's at least one[0m
[30;1m140 | [0m[35m        operation.[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        :param ops:[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m        ''' Takes a macaroon with the given version from the oven,[0m
[30;1m83 | [0m[35m        associates it with the given operations and attaches the given caveats.[0m
[30;1m84 | [0m[35m        There must be at least one operation specified.[0m
[30;1m85 | [0m[35m        The macaroon will expire at the given time - a time_before first party[0m
[30;1m86 | [0m[35m        caveat will be added with that time.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        @return: a new Macaroon object.[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m    def macaroon(self, version, expiry, caveats, ops):[0m
[30;1m82 | [0m[35m        ''' Takes a macaroon with the given version from the oven,[0m
[30;1m83 | [0m[35m        associates it with the given operations and attaches the given caveats.[0m
[30;1m84 | [0m[35m        There must be at least one operation specified.[0m
[30;1m85 | [0m[35m        The macaroon will expire at the given time - a time_before first party[0m
[30;1m86 | [0m[35m        caveat will be added with that time.[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m212 | [0m[35m        # The first byte is not a version number and it's 'A', which is the[0m
[30;1m213 | [0m[35m        # base64 encoding of the top 6 bits (all zero) of the version number 2[0m
[30;1m214 | [0m[35m        # or 3, so we assume that it's the base64 encoding of a new-style[0m
[30;1m215 | [0m[35m        # macaroon id, so we base64 decode it.[0m
[30;1m216 | [0m[35m        #[0m
[30;1m217 | [0m[35m        # Note that old-style ids always start with an ASCII character >= 4[0m
[30;1m218 | [0m[35m        # (> 32 in fact) so this logic won't be triggered for those.[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m    if first == b'A':[0m
[30;1m212 | [0m[35m        # The first byte is not a version number and it's 'A', which is the[0m
[30;1m213 | [0m[35m        # base64 encoding of the top 6 bits (all zero) of the version number 2[0m
[30;1m214 | [0m[35m        # or 3, so we assume that it's the base64 encoding of a new-style[0m
[30;1m215 | [0m[35m        # macaroon id, so we base64 decode it.[0m
[30;1m216 | [0m[35m        #[0m
[30;1m217 | [0m[35m        # Note that old-style ids always start with an ASCII character >= 4[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m    first = id[:1][0m
[30;1m211 | [0m[35m    if first == b'A':[0m
[30;1m212 | [0m[35m        # The first byte is not a version number and it's 'A', which is the[0m
[30;1m213 | [0m[35m        # base64 encoding of the top 6 bits (all zero) of the version number 2[0m
[30;1m214 | [0m[35m        # or 3, so we assume that it's the base64 encoding of a new-style[0m
[30;1m215 | [0m[35m        # macaroon id, so we base64 decode it.[0m
[30;1m216 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m    first = id[:1][0m
[30;1m211 | [0m[35m    if first == b'A':[0m
[30;1m212 | [0m[35m        # The first byte is not a version number and it's 'A', which is the[0m
[30;1m213 | [0m[35m        # base64 encoding of the top 6 bits (all zero) of the version number 2[0m
[30;1m214 | [0m[35m        # or 3, so we assume that it's the base64 encoding of a new-style[0m
[30;1m215 | [0m[35m        # macaroon id, so we base64 decode it.[0m
[30;1m216 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m        ''' Takes a macaroon with the given version from the oven,[0m
[30;1m83 | [0m[35m        associates it with the given operations and attaches the given caveats.[0m
[30;1m84 | [0m[35m        There must be at least one operation specified.[0m
[30;1m85 | [0m[35m        The macaroon will expire at the given time - a time_before first party[0m
[30;1m86 | [0m[35m        caveat will be added with that time.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        @return: a new Macaroon object.[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        caveats. If it is None, no third party caveats can be created.[0m
[30;1m63 | [0m[35m        @param location string holds the location that will be associated with[0m
[30;1m64 | [0m[35m        new macaroons (as returned by Macaroon.Location).[0m
[30;1m65 | [0m[35m        @param locator is used to find out information on third parties when[0m
[30;1m66 | [0m[35m        adding third party caveats. If this is None, no non-local third[0m
[30;1m67 | [0m[35m        party caveats can be added.[0m
[30;1m68 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_oven.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport hashlib[0m
[30;1m6 | [0m[35mimport itertools[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_authorizer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mclass ACLAuthorizer(Authorizer):[0m
[30;1m65 | [0m[35m    ''' ACLAuthorizer is an Authorizer implementation that will check access[0m
[30;1m66 | [0m[35m    control list (ACL) membership of users. It uses get_acl to find out[0m
[30;1m67 | [0m[35m    the ACLs that apply to the requested operations and will authorize an[0m
[30;1m68 | [0m[35m    operation if an ACL contains the group "everyone" or if the identity is[0m
[30;1m69 | [0m[35m    an instance of ACLIdentity and its allow method returns True for the ACL.[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_authorizer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m    def __init__(self, f):[0m
[30;1m42 | [0m[35m        '''[0m
[30;1m43 | [0m[35m        :param f: a function that takes an identity that operates on a single[0m
[30;1m44 | [0m[35m        operation at a time. Will return if this op is allowed as a boolean and[0m
[30;1m45 | [0m[35m        and a list of caveat that holds any additional third party caveats[0m
[30;1m46 | [0m[35m        that apply.[0m
[30;1m47 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_authorizer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mclass AuthorizerFunc(Authorizer):[0m
[30;1m38 | [0m[35m    ''' Implements a simplified version of Authorizer that operates on a single[0m
[30;1m39 | [0m[35m    operation at a time.[0m
[30;1m40 | [0m[35m    '''[0m
[30;1m41 | [0m[35m    def __init__(self, f):[0m
[30;1m42 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_authorizer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mclass ACLAuthorizer(Authorizer):[0m
[30;1m65 | [0m[35m    ''' ACLAuthorizer is an Authorizer implementation that will check access[0m
[30;1m66 | [0m[35m    control list (ACL) membership of users. It uses get_acl to find out[0m
[30;1m67 | [0m[35m    the ACLs that apply to the requested operations and will authorize an[0m
[30;1m68 | [0m[35m    operation if an ACL contains the group "everyone" or if the identity is[0m
[30;1m69 | [0m[35m    an instance of ACLIdentity and its allow method returns True for the ACL.[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m            identity_client=common.OneIdentity(),[0m
[30;1m122 | [0m[35m        )[0m
[30;1m123 | [0m[35m        key, id = root_key_store.root_key()[0m
[30;1m124 | [0m[35m        root_key_store.get(id)[0m
[30;1m125 | [0m[35m        m = Macaroon(key=key, version=MACAROON_V1, location='',[0m
[30;1m126 | [0m[35m                     identifier=id + b'-deadl00f')[0m
[30;1m127 | [0m[35m        b.checker.auth([[m]]).allow(common.test_context,[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m        d = bakery.discharge_all(ts_macaroon, get_discharge)[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m        # The authorization should succeed at first.[0m
[30;1m511 | [0m[35m        ts.checker.auth([d]).allow(common.test_context, [bakery.LOGIN_OP])[0m
[30;1m512 | [0m[35m        # Corrupt the root key and try again.[0m
[30;1m513 | [0m[35m        # We should get a DischargeRequiredError because the verification has failed.[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m272 | [0m[35m        ctx = checkers.context_with_declared(common.test_context, declared)[0m
[30;1m273 | [0m[35m        first_party.checker.auth([d]).allow(ctx, [bakery.LOGIN_OP])[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m        # Try again, but this time pretend a client is sneakily trying[0m
[30;1m276 | [0m[35m        # to add another 'declared' attribute to alter the declarations.[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m        def get_discharge(cav, payload):[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m        The client obtains a macaroon from fs (minted by ts, with a third party[0m
[30;1m40 | [0m[35m         caveat addressed to bs).[0m
[30;1m41 | [0m[35m        The client obtains a discharge macaroon from bs to satisfy this caveat.[0m
[30;1m42 | [0m[35m        The target service verifies the original macaroon it delegated to fs[0m
[30;1m43 | [0m[35m        No direct contact between bs and ts is required[0m
[30;1m44 | [0m[35m        '''[0m
[30;1m45 | [0m[35m        locator = bakery.ThirdPartyStore()[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m        ts is a store service which has deligated authority to a forum[0m
[30;1m35 | [0m[35m        service fs.[0m
[30;1m36 | [0m[35m        The forum service wants to require its users to be logged into to an[0m
[30;1m37 | [0m[35m        authentication service bs.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        The client obtains a macaroon from fs (minted by ts, with a third party[0m
[30;1m40 | [0m[35m         caveat addressed to bs).[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m        There are three services, ts, fs, bs:[0m
[30;1m34 | [0m[35m        ts is a store service which has deligated authority to a forum[0m
[30;1m35 | [0m[35m        service fs.[0m
[30;1m36 | [0m[35m        The forum service wants to require its users to be logged into to an[0m
[30;1m37 | [0m[35m        authentication service bs.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        The client obtains a macaroon from fs (minted by ts, with a third party[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m        http://theory.stanford.edu/~ataly/Papers/macaroons.pdf[0m
[30;1m33 | [0m[35m        There are three services, ts, fs, bs:[0m
[30;1m34 | [0m[35m        ts is a store service which has deligated authority to a forum[0m
[30;1m35 | [0m[35m        service fs.[0m
[30;1m36 | [0m[35m        The forum service wants to require its users to be logged into to an[0m
[30;1m37 | [0m[35m        authentication service bs.[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m        ''' Implements an example flow as described in the macaroons paper:[0m
[30;1m32 | [0m[35m        http://theory.stanford.edu/~ataly/Papers/macaroons.pdf[0m
[30;1m33 | [0m[35m        There are three services, ts, fs, bs:[0m
[30;1m34 | [0m[35m        ts is a store service which has deligated authority to a forum[0m
[30;1m35 | [0m[35m        service fs.[0m
[30;1m36 | [0m[35m        The forum service wants to require its users to be logged into to an[0m
[30;1m37 | [0m[35m        authentication service bs.[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m    def test_single_service_first_party(self):[0m
[30;1m14 | [0m[35m        ''' Creates a single service with a macaroon with one first party[0m
[30;1m15 | [0m[35m        caveat.[0m
[30;1m16 | [0m[35m        It creates a request with this macaroon and checks that the service[0m
[30;1m17 | [0m[35m        can verify this macaroon as valid.[0m
[30;1m18 | [0m[35m        '''[0m
[30;1m19 | [0m[35m        oc = common.new_bakery('bakerytest')[0m
[30;1m20 | [0m[35m        primary = oc.oven.macaroon(bakery.LATEST_VERSION,[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_discharge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mclass TestDischarge(unittest.TestCase):[0m
[30;1m13 | [0m[35m    def test_single_service_first_party(self):[0m
[30;1m14 | [0m[35m        ''' Creates a single service with a macaroon with one first party[0m
[30;1m15 | [0m[35m        caveat.[0m
[30;1m16 | [0m[35m        It creates a request with this macaroon and checks that the service[0m
[30;1m17 | [0m[35m        can verify this macaroon as valid.[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery.egg-info/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    >>> from macaroonbakery import httpbakery[0m
[30;1m47 | [0m[35m    >>> jar = requests.cookies.RequestsCookieJar()[0m
[30;1m48 | [0m[35m    >>> resp = requests.get('some protected url',[0m
[30;1m49 | [0m[35m                            cookies=jar,[0m
[30;1m50 | [0m[35m                            auth=httpbakery.BakeryAuth(cookies=jar))[0m
[30;1m51 | [0m[35m    >>> resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35mcan get libsodium from a ppa::[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m	$ sudo add-apt-repository ppa:yellow/ppa -y[0m
[30;1m39 | [0m[35m	$ apt-get install libsodium13[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mUsage[0m
[30;1m42 | [0m[35m-----[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m------------[0m
[30;1m31 | [0m[35mThe easiest way to install macaroonbakery is via pip::[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    $ pip install macaroonbakery[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mmacaroonbakery was developed around pymacaroons. On ubuntu, you[0m
[30;1m36 | [0m[35mcan get libsodium from a ppa::[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/docs/installation.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m============[0m
[30;1m2 | [0m[35mInstallation[0m
[30;1m3 | [0m[35m============[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mAt the command line::[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m    $ pip install macaroonbakery[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/docs/installation.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mAt the command line::[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m    $ pip install macaroonbakery[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_namespace.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        :param uri: string[0m
[30;1m73 | [0m[35m        :return: string[0m
[30;1m74 | [0m[35m        '''[0m
[30;1m75 | [0m[35m        return self._uri_to_prefix.get(uri)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    def resolve_caveat(self, cav):[0m
[30;1m78 | [0m[35m        ''' Resolves the given caveat(string) by using resolve to map from its[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_namespace.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m            raise ValueError([0m
[30;1m63 | [0m[35m                'cannot register invalid prefix %q for URI %q'.format([0m
[30;1m64 | [0m[35m                    prefix, uri))[0m
[30;1m65 | [0m[35m        if self._uri_to_prefix.get(uri) is None:[0m
[30;1m66 | [0m[35m            self._uri_to_prefix[uri] = prefix[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    def resolve(self, uri):[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/checkers/_namespace.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m        '''[0m
[30;1m41 | [0m[35m        if self._uri_to_prefix is None or len(self._uri_to_prefix) == 0:[0m
[30;1m42 | [0m[35m            return b''[0m
[30;1m43 | [0m[35m        od = collections.OrderedDict(sorted(self._uri_to_prefix.items()))[0m
[30;1m44 | [0m[35m        data = [][0m
[30;1m45 | [0m[35m        for uri in od:[0m
[30;1m46 | [0m[35m            data.append(uri + ':' + od[uri])[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    @classmethod[0m
[30;1m84 | [0m[35m    def deserialize(cls, serialized):[0m
[30;1m85 | [0m[35m        ''' Create a PublicKey from a base64 encoded bytes.[0m
[30;1m86 | [0m[35m        :return: a PublicKey[0m
[30;1m87 | [0m[35m        '''[0m
[30;1m88 | [0m[35m        return PublicKey([0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m        return self._key[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    def serialize(self, raw=False):[0m
[30;1m71 | [0m[35m        '''Encode the private part of the key in a base64 format by default,[0m
[30;1m72 | [0m[35m        but when raw is True it will return hex encoded bytes.[0m
[30;1m73 | [0m[35m        @return: bytes[0m
[30;1m74 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m                                   encoder=nacl.encoding.Base64Encoder))[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def serialize(self, raw=False):[0m
[30;1m38 | [0m[35m        '''Encode the private part of the key in a base64 format by default,[0m
[30;1m39 | [0m[35m        but when raw is True it will return hex encoded bytes.[0m
[30;1m40 | [0m[35m        @return: bytes[0m
[30;1m41 | [0m[35m        '''[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/bakery/_keys.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    @classmethod[0m
[30;1m29 | [0m[35m    def deserialize(cls, serialized):[0m
[30;1m30 | [0m[35m        ''' Create a PrivateKey from a base64 encoded bytes.[0m
[30;1m31 | [0m[35m        :return: a PrivateKey[0m
[30;1m32 | [0m[35m        '''[0m
[30;1m33 | [0m[35m        return PrivateKey([0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/README.rst[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    >>> from macaroonbakery import httpbakery[0m
[30;1m26 | [0m[35m    >>> jar = requests.cookies.RequestsCookieJar()[0m
[30;1m27 | [0m[35m    >>> resp = requests.get('some protected url',[0m
[30;1m28 | [0m[35m                            cookies=jar,[0m
[30;1m29 | [0m[35m                            auth=httpbakery.BakeryAuth(cookies=jar))[0m
[30;1m30 | [0m[35m    >>> resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mcan get libsodium from a ppa::[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m	$ sudo add-apt-repository ppa:yellow/ppa -y[0m
[30;1m18 | [0m[35m	$ apt-get install libsodium13[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mUsage[0m
[30;1m21 | [0m[35m-----[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m------------[0m
[30;1m10 | [0m[35mThe easiest way to install macaroonbakery is via pip::[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    $ pip install macaroonbakery[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mmacaroonbakery was developed around pymacaroons. On ubuntu, you[0m
[30;1m15 | [0m[35mcan get libsodium from a ppa::[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m656 | [0m[35m            return self._write_discharge_error(exc)[0m
[30;1m657 | [0m[35m        self.send_response(200)[0m
[30;1m658 | [0m[35m        self.end_headers()[0m
[30;1m659 | [0m[35m        content_len = int(self.headers.get('content-length', 0))[0m
[30;1m660 | [0m[35m        content = 'done'[0m
[30;1m661 | [0m[35m        if self.path != '/no-body'and content_len > 0:[0m
[30;1m662 | [0m[35m            body = self.rfile.read(content_len)[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m            with HTTMock(discharge):[0m
[30;1m553 | [0m[35m                with self.assertRaises(DischargeError) as discharge_error:[0m
[30;1m554 | [0m[35m                    requests.get([0m
[30;1m555 | [0m[35m                        'http://' + httpd.server_address[0] + ':' + str([0m
[30;1m556 | [0m[35m                            httpd.server_address[1]),[0m
[30;1m557 | [0m[35m                        cookies=client.cookies,[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m            with HTTMock(discharge):[0m
[30;1m512 | [0m[35m                with self.assertRaises(httpbakery.InteractionError):[0m
[30;1m513 | [0m[35m                    requests.get([0m
[30;1m514 | [0m[35m                        'http://' + httpd.server_address[0] + ':' + str([0m
[30;1m515 | [0m[35m                            httpd.server_address[1]),[0m
[30;1m516 | [0m[35m                        cookies=client.cookies,[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m452 | [0m[35m            client = httpbakery.Client()[0m
[30;1m453 | [0m[35m            with HTTMock(discharge):[0m
[30;1m454 | [0m[35m                with self.assertRaises(bakery.ThirdPartyCaveatCheckFailed):[0m
[30;1m455 | [0m[35m                    requests.get([0m
[30;1m456 | [0m[35m                        url='http://' + httpd.server_address[0] + ':' +[0m
[30;1m457 | [0m[35m                            str(httpd.server_address[1]),[0m
[30;1m458 | [0m[35m                        cookies=client.cookies,[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m            client = httpbakery.Client()[0m
[30;1m409 | [0m[35m            with HTTMock(discharge):[0m
[30;1m410 | [0m[35m                with self.assertRaises(httpbakery.BakeryException) as ctx:[0m
[30;1m411 | [0m[35m                    requests.get([0m
[30;1m412 | [0m[35m                        url='http://' + httpd.server_address[0] + ':' +[0m
[30;1m413 | [0m[35m                            str(httpd.server_address[1]),[0m
[30;1m414 | [0m[35m                        cookies=client.cookies,[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m            client = httpbakery.Client()[0m
[30;1m362 | [0m[35m            with HTTMock(discharge):[0m
[30;1m363 | [0m[35m                with self.assertRaises(httpbakery.BakeryException) as ctx:[0m
[30;1m364 | [0m[35m                    requests.get([0m
[30;1m365 | [0m[35m                        url='http://' + httpd.server_address[0] + ':' +[0m
[30;1m366 | [0m[35m                            str(httpd.server_address[1]),[0m
[30;1m367 | [0m[35m                        cookies=client.cookies,[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m                    auth=client.auth())[0m
[30;1m315 | [0m[35m            resp.raise_for_status()[0m
[30;1m316 | [0m[35m            m = bakery.Macaroon.from_dict(json.loads([0m
[30;1m317 | [0m[35m                base64.b64decode(client.cookies.get('macaroon-test')).decode('utf-8'))[0])[0m
[30;1m318 | [0m[35m            t = checkers.macaroons_expiry_time([0m
[30;1m319 | [0m[35m                checkers.Namespace(), [m.macaroon])[0m
[30;1m320 | [0m[35m            self.assertEqual(ages, t)[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m            thread.start()[0m
[30;1m308 | [0m[35m            client = httpbakery.Client()[0m
[30;1m309 | [0m[35m            with HTTMock(discharge):[0m
[30;1m310 | [0m[35m                resp = requests.get([0m
[30;1m311 | [0m[35m                    url='http://' + httpd.server_address[0] + ':' +[0m
[30;1m312 | [0m[35m                        str(httpd.server_address[1]),[0m
[30;1m313 | [0m[35m                    cookies=client.cookies,[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m                    srv_macaroon.to_dict().get('m')[0m
[30;1m261 | [0m[35m                ]).encode('utf-8'))[0m
[30;1m262 | [0m[35m            }[0m
[30;1m263 | [0m[35m            resp = requests.get([0m
[30;1m264 | [0m[35m                url='http://' + httpd.server_address[0] + ':' +[0m
[30;1m265 | [0m[35m                    str(httpd.server_address[1]),[0m
[30;1m266 | [0m[35m                headers=headers)[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m            self.assertEqual(srv_macaroon.macaroon.location, 'loc')[0m
[30;1m258 | [0m[35m            headers = {[0m
[30;1m259 | [0m[35m                'Macaroons': base64.b64encode(json.dumps([[0m
[30;1m260 | [0m[35m                    srv_macaroon.to_dict().get('m')[0m
[30;1m261 | [0m[35m                ]).encode('utf-8'))[0m
[30;1m262 | [0m[35m            }[0m
[30;1m263 | [0m[35m            resp = requests.get([0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m            # Note: by using "localhost" instead of the presumably numeric address held[0m
[30;1m228 | [0m[35m            # in httpd.server_address, we're triggering the no-FQDN logic in the cookie[0m
[30;1m229 | [0m[35m            # code.[0m
[30;1m230 | [0m[35m            resp = requests.get([0m
[30;1m231 | [0m[35m                url='http://localhost:' + str(httpd.server_address[1]),[0m
[30;1m232 | [0m[35m                cookies=client.cookies, auth=client.auth())[0m
[30;1m233 | [0m[35m            resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m            thread.start()[0m
[30;1m199 | [0m[35m            client = httpbakery.Client()[0m
[30;1m200 | [0m[35m            with HTTMock(discharge):[0m
[30;1m201 | [0m[35m                resp = requests.get([0m
[30;1m202 | [0m[35m                    url=server_url,[0m
[30;1m203 | [0m[35m                    cookies=client.cookies,[0m
[30;1m204 | [0m[35m                    auth=client.auth())[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m            thread.start()[0m
[30;1m153 | [0m[35m            client = httpbakery.Client()[0m
[30;1m154 | [0m[35m            with HTTMock(discharge):[0m
[30;1m155 | [0m[35m                resp = requests.get([0m
[30;1m156 | [0m[35m                    url=server_url,[0m
[30;1m157 | [0m[35m                    cookies=client.cookies,[0m
[30;1m158 | [0m[35m                    auth=client.auth())[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m            thread.start()[0m
[30;1m106 | [0m[35m            client = httpbakery.Client()[0m
[30;1m107 | [0m[35m            with HTTMock(discharge):[0m
[30;1m108 | [0m[35m                resp = requests.get([0m
[30;1m109 | [0m[35m                    url=server_url,[0m
[30;1m110 | [0m[35m                    cookies=client.cookies,[0m
[30;1m111 | [0m[35m                    auth=client.auth())[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m                    srv_macaroon.to_dict().get('m')[0m
[30;1m59 | [0m[35m                ]).encode('utf-8')).decode('utf-8')[0m
[30;1m60 | [0m[35m            ))[0m
[30;1m61 | [0m[35m            resp = requests.get([0m
[30;1m62 | [0m[35m                url='http://' + httpd.server_address[0] + ':' +[0m
[30;1m63 | [0m[35m                    str(httpd.server_address[1]),[0m
[30;1m64 | [0m[35m                cookies=client.cookies, auth=client.auth())[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m            client = httpbakery.Client()[0m
[30;1m56 | [0m[35m            client.cookies.set_cookie(requests.cookies.create_cookie([0m
[30;1m57 | [0m[35m                'macaroon-test', base64.b64encode(json.dumps([[0m
[30;1m58 | [0m[35m                    srv_macaroon.to_dict().get('m')[0m
[30;1m59 | [0m[35m                ]).encode('utf-8')).decode('utf-8')[0m
[30;1m60 | [0m[35m            ))[0m
[30;1m61 | [0m[35m            resp = requests.get([0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright 2017 Canonical Ltd.[0m
[30;1m2 | [0m[35m# Licensed under the LGPLv3, see LICENCE file for details.[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport datetime[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport platform[0m
[30;1m7 | [0m[35mimport threading[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mdef str_check(ctx, cond, args):[0m
[30;1m40 | [0m[35m    expect = ctx[_str_key][0m
[30;1m41 | [0m[35m    if args != expect:[0m
[30;1m42 | [0m[35m        return '{} doesn\'t match {}'.format(cond, expect)[0m
[30;1m43 | [0m[35m    return None[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m                    ),[0m
[30;1m349 | [0m[35m                ),[0m
[30;1m350 | [0m[35m            ])[0m
[30;1m351 | [0m[35m            resp = requests.get([0m
[30;1m352 | [0m[35m                'http://0.1.2.3/here',[0m
[30;1m353 | [0m[35m                cookies=client.cookies,[0m
[30;1m354 | [0m[35m                auth=client.auth(),[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m        @urlmatch(path='.*/visit')[0m
[30;1m270 | [0m[35m        def visit(url, request):[0m
[30;1m271 | [0m[35m            if request.headers.get('Accept') == 'application/json':[0m
[30;1m272 | [0m[35m                return {[0m
[30;1m273 | [0m[35m                    'status_code': 200,[0m
[30;1m274 | [0m[35m                    'content': {[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m        @urlmatch(path='.*/discharge')[0m
[30;1m224 | [0m[35m        def discharge(url, request):[0m
[30;1m225 | [0m[35m            qs = parse_qs(request.body)[0m
[30;1m226 | [0m[35m            if qs.get('caveat64') is not None:[0m
[30;1m227 | [0m[35m                content = {q: qs[q][0] for q in qs}[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m                class InteractionRequiredError(Exception):[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m            client = httpbakery.Client(interaction_methods=[[0m
[30;1m168 | [0m[35m                agent.AgentInteractor(auth_info),[0m
[30;1m169 | [0m[35m            ])[0m
[30;1m170 | [0m[35m            resp = requests.get([0m
[30;1m171 | [0m[35m                'http://0.1.2.3/here',[0m
[30;1m172 | [0m[35m                cookies=client.cookies,[0m
[30;1m173 | [0m[35m                auth=client.auth())[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m354[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/macaroonbakery-1.3.4/macaroonbakery/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m        @urlmatch(path='.*/discharge')[0m
[30;1m114 | [0m[35m        def discharge(url, request):[0m
[30;1m115 | [0m[35m            qs = parse_qs(request.body)[0m
[30;1m116 | [0m[35m            if qs.get('token64') is None:[0m
[30;1m117 | [0m[35m                return response([0m
[30;1m118 | [0m[35m                    status_code=401,[0m
[30;1m119 | [0m[35m                    content={[0m

354 matches found.
