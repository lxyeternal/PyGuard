[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m            with open(sibling("certificate-with-password.pem")) as f:[0m
[30;1m48 | [0m[35m                _load_private_key_from_pem_str(f.read(), passphrase_bytes)[0m
[30;1m49 | [0m[35m            pfx = sibling("certificate-with-password.pfx")  # Created by:[0m
[30;1m50 | [0m[35m                # openssl pkcs12 -export -inkey test/certificate-with-password.pem -in tests/certifi[0m
[30;1m51 | [0m[35m            _parse_pfx(pfx, passphrase_bytes)[0m
[30;1m52 | [0m[35m            self.assertEqual(0, len(encountered_warnings),[0m
[30;1m53 | [0m[35m                "Did cryptography deprecate the functions that we used?")[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m            with open(sibling("certificate-with-password.pem")) as f:[0m
[30;1m48 | [0m[35m                _load_private_key_from_pem_str(f.read(), passphrase_bytes)[0m
[30;1m49 | [0m[35m            pfx = sibling("certificate-with-password.pfx")  # Created by:[0m
[30;1m50 | [0m[35m                # openssl pkcs12 -export -inkey test/certificate-with-password.pem -in tests/certifi[0m
[30;1m51 | [0m[35m            _parse_pfx(pfx, passphrase_bytes)[0m
[30;1m52 | [0m[35m            self.assertEqual(0, len(encountered_warnings),[0m
[30;1m53 | [0m[35m                "Did cryptography deprecate the functions that we used?")[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m            with open(sibling("certificate-with-password.pem")) as f:[0m
[30;1m48 | [0m[35m                _load_private_key_from_pem_str(f.read(), passphrase_bytes)[0m
[30;1m49 | [0m[35m            pfx = sibling("certificate-with-password.pfx")  # Created by:[0m
[30;1m50 | [0m[35m                # openssl pkcs12 -export -inkey test/certificate-with-password.pem -in tests/certifi[0m
[30;1m51 | [0m[35m            _parse_pfx(pfx, passphrase_bytes)[0m
[30;1m52 | [0m[35m            self.assertEqual(0, len(encountered_warnings),[0m
[30;1m53 | [0m[35m                "Did cryptography deprecate the functions that we used?")[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m        with warnings.catch_warnings(record=True) as encountered_warnings:[0m
[30;1m47 | [0m[35m            with open(sibling("certificate-with-password.pem")) as f:[0m
[30;1m48 | [0m[35m                _load_private_key_from_pem_str(f.read(), passphrase_bytes)[0m
[30;1m49 | [0m[35m            pfx = sibling("certificate-with-password.pfx")  # Created by:[0m
[30;1m50 | [0m[35m                # openssl pkcs12 -export -inkey test/certificate-with-password.pem -in tests/certifi[0m
[30;1m51 | [0m[35m            _parse_pfx(pfx, passphrase_bytes)[0m
[30;1m52 | [0m[35m            self.assertEqual(0, len(encountered_warnings),[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m        passphrase_bytes = _str2bytes("password")[0m
[30;1m46 | [0m[35m        with warnings.catch_warnings(record=True) as encountered_warnings:[0m
[30;1m47 | [0m[35m            with open(sibling("certificate-with-password.pem")) as f:[0m
[30;1m48 | [0m[35m                _load_private_key_from_pem_str(f.read(), passphrase_bytes)[0m
[30;1m49 | [0m[35m            pfx = sibling("certificate-with-password.pfx")  # Created by:[0m
[30;1m50 | [0m[35m                # openssl pkcs12 -export -inkey test/certificate-with-password.pem -in tests/certifi[0m
[30;1m51 | [0m[35m            _parse_pfx(pfx, passphrase_bytes)[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m    def test_latest_cryptography_should_support_our_usage_without_warnings(self):[0m
[30;1m45 | [0m[35m        passphrase_bytes = _str2bytes("password")[0m
[30;1m46 | [0m[35m        with warnings.catch_warnings(record=True) as encountered_warnings:[0m
[30;1m47 | [0m[35m            with open(sibling("certificate-with-password.pem")) as f:[0m
[30;1m48 | [0m[35m                _load_private_key_from_pem_str(f.read(), passphrase_bytes)[0m
[30;1m49 | [0m[35m            pfx = sibling("certificate-with-password.pfx")  # Created by:[0m
[30;1m50 | [0m[35m                # openssl pkcs12 -export -inkey test/certificate-with-password.pem -in tests/certifi[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35m            cryptography.__version__, latest_cryptography_version))[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    def test_latest_cryptography_should_support_our_usage_without_warnings(self):[0m
[30;1m45 | [0m[35m        passphrase_bytes = _str2bytes("password")[0m
[30;1m46 | [0m[35m        with warnings.catch_warnings(record=True) as encountered_warnings:[0m
[30;1m47 | [0m[35m            with open(sibling("certificate-with-password.pem")) as f:[0m
[30;1m48 | [0m[35m                _load_private_key_from_pem_str(f.read(), passphrase_bytes)[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35mimport requests[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom msal.application import ([0m
[30;1m11 | [0m[35m    _str2bytes, _load_private_key_from_pem_str, _parse_pfx)[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mlatest_cryptography_version = ET.fromstring([0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m93 | [0m[35m        resp1 = http_client.post("https://example.com", data={[0m
[30;1m94 | [0m[35m            "scope": "one", "claims": "bar", "grant_type": "authorization_code"})[0m
[30;1m95 | [0m[35m        resp2 = http_client.post("https://example.com", data={[0m
[30;1m96 | [0m[35m            "scope": "one", "claims": "foo", "grant_type": "password"})[0m
[30;1m97 | [0m[35m        logger.debug(http_cache)[0m
[30;1m98 | [0m[35m        self.assertEqual(resp1.text, resp2.text, "Should return a cached response")[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_mex.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11 | [0m[35m    def _test_parser(self, sample, expected_endpoint):[0m
[30;1m12 | [0m[35m        with open(os.path.join(THIS_FOLDER, sample)) as sample_file:[0m
[30;1m13 | [0m[35m            endpoint = Mex(mex_document=sample_file.read()[0m
[30;1m14 | [0m[35m                ).get_wstrust_username_password_endpoint()["address"][0m
[30;1m15 | [0m[35m            self.assertEqual(expected_endpoint, endpoint)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def test_happy_path_1(self):[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/region.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mdef _detect_region(http_client=None):[0m
[30;1m8 | [0m[35m    region = os.environ.get("REGION_NAME", "").replace(" ", "").lower()  # e.g. westus2[0m
[30;1m9 | [0m[35m    if region:[0m
[30;1m10 | [0m[35m        return region[0m
[30;1m11 | [0m[35m    if http_client:[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m818 | [0m[35m        'token_type': 'pop',[0m
[30;1m819 | [0m[35m        'key_id': key,[0m
[30;1m820 | [0m[35m        "req_cnf": base64.urlsafe_b64encode(raw_req_cnf.encode('utf-8')).decode('utf-8').rstrip('=')[0m
[30;1m821 | [0m[35m            # Note: Sending raw_req_cnf without base64 encoding would result in an http 500 error[0m
[30;1m822 | [0m[35m    }  # See also https://github.com/Azure/azure-cli-extensions/blob/main/src/connectedk8s/azext_con[0m
[30;1m823 | [0m[35m[0m
[30;1m824 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m817 | [0m[35m    return {  # Sampled from Azure CLI's plugin connectedk8s[0m
[30;1m818 | [0m[35m        'token_type': 'pop',[0m
[30;1m819 | [0m[35m        'key_id': key,[0m
[30;1m820 | [0m[35m        "req_cnf": base64.urlsafe_b64encode(raw_req_cnf.encode('utf-8')).decode('utf-8').rstrip('=')[0m
[30;1m821 | [0m[35m            # Note: Sending raw_req_cnf without base64 encoding would result in an http 500 error[0m
[30;1m822 | [0m[35m    }  # See also https://github.com/Azure/azure-cli-extensions/blob/main/src/connectedk8s/azext_con[0m
[30;1m823 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m10 | [0m[35m    load_dotenv()  # take environment variables from .env.[0m
[30;1m11 | [0m[35mexcept:[0m
[30;1m12 | [0m[35m    pass[0m
[30;1m13 | [0m[35mimport base64[0m
[30;1m14 | [0m[35mimport logging[0m
[30;1m15 | [0m[35mimport os[0m
[30;1m16 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1344 | [0m[35m            )[0m
[30;1m1345 | [0m[35m        config = self.get_lab_user(usertype="cloud")[0m
[30;1m1346 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m1347 | [0m[35m        result = self._test_username_password(auth_scheme=auth_scheme, **config)[0m
[30;1m1348 | [0m[35m        self.assertEqual(result["token_type"], "pop")[0m
[30;1m1349 | [0m[35m        shr = result["access_token"][0m
[30;1m1350 | [0m[35m        payload = json.loads(decode_part(result["access_token"].split(".")[1]))[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1343 | [0m[35m                "https://testingsts.azurewebsites.net/servernonce/get").text,[0m
[30;1m1344 | [0m[35m            )[0m
[30;1m1345 | [0m[35m        config = self.get_lab_user(usertype="cloud")[0m
[30;1m1346 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m1347 | [0m[35m        result = self._test_username_password(auth_scheme=auth_scheme, **config)[0m
[30;1m1348 | [0m[35m        self.assertEqual(result["token_type"], "pop")[0m
[30;1m1349 | [0m[35m        shr = result["access_token"][0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1284 | [0m[35m        config_pca = self.get_lab_user(usertype="cloud", azureenvironment=self.environment, publicCl[0m
[30;1m1285 | [0m[35m        obo_app_object = self.get_lab_app_object([0m
[30;1m1286 | [0m[35m            usertype="cloud", azureenvironment=self.environment, publicClient="no")[0m
[30;1m1287 | [0m[35m        config_pca["password"] = self.get_lab_user_secret(config_pca["lab_name"])[0m
[30;1m1288 | [0m[35m        config_pca["scope"] = ["{app_uri}/files.read".format(app_uri=obo_app_object.get("identifierU[0m
[30;1m1289 | [0m[35m[0m
[30;1m1290 | [0m[35m        self._test_acquire_token_obo(config_pca, config_cca)[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1268 | [0m[35m    def test_acquire_token_by_ropc(self):[0m
[30;1m1269 | [0m[35m        config = self.get_lab_user(azureenvironment=self.environment)[0m
[30;1m1270 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m1271 | [0m[35m        self._test_username_password(**config)[0m
[30;1m1272 | [0m[35m[0m
[30;1m1273 | [0m[35m    def test_acquire_token_by_client_secret(self):[0m
[30;1m1274 | [0m[35m        config = self.get_lab_user(usertype="cloud", azureenvironment=self.environment, publicClient[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1267 | [0m[35m[0m
[30;1m1268 | [0m[35m    def test_acquire_token_by_ropc(self):[0m
[30;1m1269 | [0m[35m        config = self.get_lab_user(azureenvironment=self.environment)[0m
[30;1m1270 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m1271 | [0m[35m        self._test_username_password(**config)[0m
[30;1m1272 | [0m[35m[0m
[30;1m1273 | [0m[35m    def test_acquire_token_by_client_secret(self):[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1256 | [0m[35m        config["client_id"] = os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID")[0m
[30;1m1257 | [0m[35m        config["scope"] = ["https://graph.microsoft.com/.default"][0m
[30;1m1258 | [0m[35m        config["client_secret"] = os.getenv("LAB_OBO_CLIENT_SECRET")[0m
[30;1m1259 | [0m[35m        self._test_username_password([0m
[30;1m1260 | [0m[35m            azure_region=self.region,[0m
[30;1m1261 | [0m[35m            http_client=MinimalHttpClient(timeout=self.timeout),[0m
[30;1m1262 | [0m[35m            **config)[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1250 | [0m[35m    def test_cca_ropc_should_bypass_regional_endpoint_therefore_still_work(self):[0m
[30;1m1251 | [0m[35m        """We test ROPC because it is implemented in base class ClientApplication"""[0m
[30;1m1252 | [0m[35m        config = self.get_lab_user(usertype="cloud")[0m
[30;1m1253 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m1254 | [0m[35m        # We repurpose the obo confidential app to test ROPC[0m
[30;1m1255 | [0m[35m        # Swap in the OBO confidential app[0m
[30;1m1256 | [0m[35m        config["client_id"] = os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID")[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1232 | [0m[35m        config_pca = {}[0m
[30;1m1233 | [0m[35m        config_pca.update(config)[0m
[30;1m1234 | [0m[35m        config_pca["client_id"] = os.getenv("LAB_OBO_PUBLIC_CLIENT_ID")[0m
[30;1m1235 | [0m[35m        config_pca["password"] = self.get_lab_user_secret(config_pca["lab_name"])[0m
[30;1m1236 | [0m[35m        config_pca["scope"] = ["api://%s/read" % config_cca["client_id"]][0m
[30;1m1237 | [0m[35m[0m
[30;1m1238 | [0m[35m        self._test_acquire_token_obo([0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1116 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1117 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1118 | [0m[35m            username=self.user["username"],[0m
[30;1m1119 | [0m[35m            password=self.get_lab_user_secret(self.user["lab_name"]),[0m
[30;1m1120 | [0m[35m            scope=self.app_config["scopes"],[0m
[30;1m1121 | [0m[35m            )[0m
[30;1m1122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1111 | [0m[35m        # Somehow, this would only work after creating a secret for the test app[0m
[30;1m1112 | [0m[35m        # and enabling "Allow public client flows".[0m
[30;1m1113 | [0m[35m        # Otherwise it would hit AADSTS7000218.[0m
[30;1m1114 | [0m[35m        self._test_username_password([0m
[30;1m1115 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1116 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1117 | [0m[35m            client_id=self.app_config["appId"],[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1057 | [0m[35m            authority=self._build_b2c_authority("B2C_1_ROPC_Auth"),[0m
[30;1m1058 | [0m[35m            client_id=config["appId"],[0m
[30;1m1059 | [0m[35m            username="b2clocal@msidlabb2c.onmicrosoft.com",[0m
[30;1m1060 | [0m[35m            password=self.get_lab_user_secret("msidlabb2c"),[0m
[30;1m1061 | [0m[35m            scope=config["scopes"],[0m
[30;1m1062 | [0m[35m            )[0m
[30;1m1063 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1053 | [0m[35m        # See also https://learn.microsoft.com/en-us/azure/active-directory-b2c/access-tokens#openid[0m
[30;1m1054 | [0m[35m        config = self.get_lab_app_object(azureenvironment="azureb2ccloud")[0m
[30;1m1055 | [0m[35m        config["scopes"] = [config["appId"]][0m
[30;1m1056 | [0m[35m        self._test_username_password([0m
[30;1m1057 | [0m[35m            authority=self._build_b2c_authority("B2C_1_ROPC_Auth"),[0m
[30;1m1058 | [0m[35m            client_id=config["appId"],[0m
[30;1m1059 | [0m[35m            username="b2clocal@msidlabb2c.onmicrosoft.com",[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1045 | [0m[35m            authority=self._build_b2c_authority("B2C_1_ROPC_Auth"),[0m
[30;1m1046 | [0m[35m            client_id=config["appId"],[0m
[30;1m1047 | [0m[35m            username="b2clocal@msidlabb2c.onmicrosoft.com",[0m
[30;1m1048 | [0m[35m            password=self.get_lab_user_secret("msidlabb2c"),[0m
[30;1m1049 | [0m[35m            scope=config["scopes"],[0m
[30;1m1050 | [0m[35m            )[0m
[30;1m1051 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1041 | [0m[35m[0m
[30;1m1042 | [0m[35m    def test_b2c_acquire_token_by_ropc(self):[0m
[30;1m1043 | [0m[35m        config = self.get_lab_app_object(azureenvironment="azureb2ccloud")[0m
[30;1m1044 | [0m[35m        self._test_username_password([0m
[30;1m1045 | [0m[35m            authority=self._build_b2c_authority("B2C_1_ROPC_Auth"),[0m
[30;1m1046 | [0m[35m            client_id=config["appId"],[0m
[30;1m1047 | [0m[35m            username="b2clocal@msidlabb2c.onmicrosoft.com",[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1021 | [0m[35m[0m
[30;1m1022 | [0m[35m            username="b2clocal@msidlabb2c.onmicrosoft.com"[0m
[30;1m1023 | [0m[35m                # This won't work https://msidlab.com/api/user?usertype=b2c[0m
[30;1m1024 | [0m[35m            password="***"  # From https://aka.ms/GetLabSecret?Secret=msidlabb2c[0m
[30;1m1025 | [0m[35m        """[0m
[30;1m1026 | [0m[35m        config = self.get_lab_app_object(azureenvironment="azureb2ccloud")[0m
[30;1m1027 | [0m[35m        self._test_acquire_token_by_auth_code([0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1009 | [0m[35m        config["client_id"] = os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID")[0m
[30;1m1010 | [0m[35m        config["scope"] = ["https://graph.microsoft.com/.default"][0m
[30;1m1011 | [0m[35m        config["client_secret"] = os.getenv("LAB_OBO_CLIENT_SECRET")[0m
[30;1m1012 | [0m[35m        self._test_username_password(**config)[0m
[30;1m1013 | [0m[35m[0m
[30;1m1014 | [0m[35m    def _build_b2c_authority(self, policy):[0m
[30;1m1015 | [0m[35m        base = "https://msidlabb2c.b2clogin.com/msidlabb2c.onmicrosoft.com"[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1004 | [0m[35m        #       config = self.get_lab_user(usertype="cloud", publicClient="no")[0m
[30;1m1005 | [0m[35m        # so we repurpose the obo confidential app to test ROPC[0m
[30;1m1006 | [0m[35m        config = self.get_lab_user(usertype="cloud")[0m
[30;1m1007 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m1008 | [0m[35m        # Swap in the OBO confidential app[0m
[30;1m1009 | [0m[35m        config["client_id"] = os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID")[0m
[30;1m1010 | [0m[35m        config["scope"] = ["https://graph.microsoft.com/.default"][0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m999 | [0m[35m    @unittest.skipUnless([0m
[30;1m1000 | [0m[35m        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),[0m
[30;1m1001 | [0m[35m        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html[0m
[30;1m1002 | [0m[35m    def test_confidential_client_acquire_token_by_username_password(self):[0m
[30;1m1003 | [0m[35m        # This approach won't work:[0m
[30;1m1004 | [0m[35m        #       config = self.get_lab_user(usertype="cloud", publicClient="no")[0m
[30;1m1005 | [0m[35m        # so we repurpose the obo confidential app to test ROPC[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m962 | [0m[35m        authority = "https://login.windows-ppe.net/f686d426-8d16-42db-81b7-ab578e110ccd"[0m
[30;1m963 | [0m[35m        with open("tests/sp_obo.pem") as pem:[0m
[30;1m964 | [0m[35m            client_secret = {[0m
[30;1m965 | [0m[35m                "private_key": pem.read(),[0m
[30;1m966 | [0m[35m                "thumbprint": "378938210C976692D7F523B8C4FFBB645D17CE92",[0m
[30;1m967 | [0m[35m                }[0m
[30;1m968 | [0m[35m        midtier_app = {[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m950 | [0m[35m        config_pca = {}[0m
[30;1m951 | [0m[35m        config_pca.update(config)[0m
[30;1m952 | [0m[35m        config_pca["client_id"] = os.getenv("LAB_OBO_PUBLIC_CLIENT_ID")[0m
[30;1m953 | [0m[35m        config_pca["password"] = self.get_lab_user_secret(config_pca["lab_name"])[0m
[30;1m954 | [0m[35m        config_pca["scope"] = ["api://%s/read" % config_cca["client_id"]][0m
[30;1m955 | [0m[35m[0m
[30;1m956 | [0m[35m        self._test_acquire_token_obo(config_pca, config_cca)[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m903 | [0m[35m[0m
[30;1m904 | [0m[35m        # https://msidlab.com/api/user?usertype=onprem&federationprovider=ADFSv2019[0m
[30;1m905 | [0m[35m        username = "..."  # The upn from the link above[0m
[30;1m906 | [0m[35m        password="***"  # From https://aka.ms/GetLabSecret?Secret=msidlabXYZ[0m
[30;1m907 | [0m[35m        """[0m
[30;1m908 | [0m[35m        config = self.get_lab_user(usertype="onprem", federationProvider="ADFSv2019")[0m
[30;1m909 | [0m[35m        config["authority"] = "https://fs.%s.com/adfs" % config["lab_name"][0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m896 | [0m[35m        config["authority"] = "https://fs.%s.com/adfs" % config["lab_name"][0m
[30;1m897 | [0m[35m        config["scope"] = self.adfs2019_scopes[0m
[30;1m898 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m899 | [0m[35m        self._test_username_password(**config)[0m
[30;1m900 | [0m[35m[0m
[30;1m901 | [0m[35m    def test_adfs2019_onprem_acquire_token_by_auth_code(self):[0m
[30;1m902 | [0m[35m        """When prompted, you can manually login using this account:[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m895 | [0m[35m        config = self.get_lab_user(usertype="onprem", federationProvider="ADFSv2019")[0m
[30;1m896 | [0m[35m        config["authority"] = "https://fs.%s.com/adfs" % config["lab_name"][0m
[30;1m897 | [0m[35m        config["scope"] = self.adfs2019_scopes[0m
[30;1m898 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m899 | [0m[35m        self._test_username_password(**config)[0m
[30;1m900 | [0m[35m[0m
[30;1m901 | [0m[35m    def test_adfs2019_onprem_acquire_token_by_auth_code(self):[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m866 | [0m[35m        try:[0m
[30;1m867 | [0m[35m            config = self.get_lab_user(usertype="federated", federationProvider="ADFSv2019")[0m
[30;1m868 | [0m[35m            config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m869 | [0m[35m            self._test_username_password(**config)[0m
[30;1m870 | [0m[35m        except requests.exceptions.HTTPError:[0m
[30;1m871 | [0m[35m            if os.getenv("TRAVIS"):[0m
[30;1m872 | [0m[35m                self.skipTest("MEX endpoint in our test environment tends to fail")[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m865 | [0m[35m    def test_adfs2019_fed_user(self):[0m
[30;1m866 | [0m[35m        try:[0m
[30;1m867 | [0m[35m            config = self.get_lab_user(usertype="federated", federationProvider="ADFSv2019")[0m
[30;1m868 | [0m[35m            config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m869 | [0m[35m            self._test_username_password(**config)[0m
[30;1m870 | [0m[35m        except requests.exceptions.HTTPError:[0m
[30;1m871 | [0m[35m            if os.getenv("TRAVIS"):[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m860 | [0m[35m    def test_adfs2_fed_user(self):[0m
[30;1m861 | [0m[35m        config = self.get_lab_user(usertype="federated", federationProvider="ADFSv2")[0m
[30;1m862 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m863 | [0m[35m        self._test_username_password(**config)[0m
[30;1m864 | [0m[35m[0m
[30;1m865 | [0m[35m    def test_adfs2019_fed_user(self):[0m
[30;1m866 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m859 | [0m[35m    @unittest.skip("ADFSv2 is decommissioned in our test environment")[0m
[30;1m860 | [0m[35m    def test_adfs2_fed_user(self):[0m
[30;1m861 | [0m[35m        config = self.get_lab_user(usertype="federated", federationProvider="ADFSv2")[0m
[30;1m862 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m863 | [0m[35m        self._test_username_password(**config)[0m
[30;1m864 | [0m[35m[0m
[30;1m865 | [0m[35m    def test_adfs2019_fed_user(self):[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m854 | [0m[35m    def test_adfs3_fed_user(self):[0m
[30;1m855 | [0m[35m        config = self.get_lab_user(usertype="federated", federationProvider="ADFSv3")[0m
[30;1m856 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m857 | [0m[35m        self._test_username_password(**config)[0m
[30;1m858 | [0m[35m[0m
[30;1m859 | [0m[35m    @unittest.skip("ADFSv2 is decommissioned in our test environment")[0m
[30;1m860 | [0m[35m    def test_adfs2_fed_user(self):[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m853 | [0m[35m    @unittest.skip("ADFSv3 is decommissioned in our test environment")[0m
[30;1m854 | [0m[35m    def test_adfs3_fed_user(self):[0m
[30;1m855 | [0m[35m        config = self.get_lab_user(usertype="federated", federationProvider="ADFSv3")[0m
[30;1m856 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m857 | [0m[35m        self._test_username_password(**config)[0m
[30;1m858 | [0m[35m[0m
[30;1m859 | [0m[35m    @unittest.skip("ADFSv2 is decommissioned in our test environment")[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m848 | [0m[35m    def test_adfs4_fed_user(self):[0m
[30;1m849 | [0m[35m        config = self.get_lab_user(usertype="federated", federationProvider="ADFSv4")[0m
[30;1m850 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m851 | [0m[35m        self._test_username_password(**config)[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m    @unittest.skip("ADFSv3 is decommissioned in our test environment")[0m
[30;1m854 | [0m[35m    def test_adfs3_fed_user(self):[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m    def test_adfs4_fed_user(self):[0m
[30;1m849 | [0m[35m        config = self.get_lab_user(usertype="federated", federationProvider="ADFSv4")[0m
[30;1m850 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m851 | [0m[35m        self._test_username_password(**config)[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m    @unittest.skip("ADFSv3 is decommissioned in our test environment")[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m843 | [0m[35m    def test_aad_managed_user(self):  # Pure cloud[0m
[30;1m844 | [0m[35m        config = self.get_lab_user(usertype="cloud")[0m
[30;1m845 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m846 | [0m[35m        self._test_username_password(**config)[0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m    def test_adfs4_fed_user(self):[0m
[30;1m849 | [0m[35m        config = self.get_lab_user(usertype="federated", federationProvider="ADFSv4")[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m842 | [0m[35m[0m
[30;1m843 | [0m[35m    def test_aad_managed_user(self):  # Pure cloud[0m
[30;1m844 | [0m[35m        config = self.get_lab_user(usertype="cloud")[0m
[30;1m845 | [0m[35m        config["password"] = self.get_lab_user_secret(config["lab_name"])[0m
[30;1m846 | [0m[35m        self._test_username_password(**config)[0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m    def test_adfs4_fed_user(self):[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m654 | [0m[35m                azure_region=azure_region,[0m
[30;1m655 | [0m[35m                http_client=http_client or MinimalHttpClient(),[0m
[30;1m656 | [0m[35m                ).acquire_token_by_username_password([0m
[30;1m657 | [0m[35m                    config_pca["username"], config_pca["password"],[0m
[30;1m658 | [0m[35m                    scopes=config_pca["scope"],[0m
[30;1m659 | [0m[35m                )[0m
[30;1m660 | [0m[35m        else:  # We repurpose the config_pca to contain client_secret for cca app 1[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m653 | [0m[35m                config_pca["client_id"], authority=config_pca["authority"],[0m
[30;1m654 | [0m[35m                azure_region=azure_region,[0m
[30;1m655 | [0m[35m                http_client=http_client or MinimalHttpClient(),[0m
[30;1m656 | [0m[35m                ).acquire_token_by_username_password([0m
[30;1m657 | [0m[35m                    config_pca["username"], config_pca["password"],[0m
[30;1m658 | [0m[35m                    scopes=config_pca["scope"],[0m
[30;1m659 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m544 | [0m[35m    def get_lab_user_secret(cls, lab_name="msidlab4"):[0m
[30;1m545 | [0m[35m        lab_name = lab_name.lower()[0m
[30;1m546 | [0m[35m        if lab_name not in cls._secrets:[0m
[30;1m547 | [0m[35m            logger.info("Querying lab user password for %s", lab_name)[0m
[30;1m548 | [0m[35m            url = "https://msidlab.com/api/LabSecret?secret=%s" % lab_name[0m
[30;1m549 | [0m[35m            resp = cls.session.get(url)[0m
[30;1m550 | [0m[35m            cls._secrets[lab_name] = resp.json()["value"][0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m475 | [0m[35m        # id came from https://docs.msidlab.com/accounts/confidentialclient.html[0m
[30;1m476 | [0m[35m        client_id = os.getenv(env_client_id)[0m
[30;1m477 | [0m[35m        client_credential = {[0m
[30;1m478 | [0m[35m            "private_key_pfx_path":[0m
[30;1m479 | [0m[35m                # Cert came from https://ms.portal.azure.com/#@microsoft.onmicrosoft.com/asset/Micro[0m
[30;1m480 | [0m[35m                os.getenv(env_client_cert_path),[0m
[30;1m481 | [0m[35m            "public_certificate": True,  # Opt in for SNI[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m423 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m
[30;1m424 | [0m[35m            self.config['client_id'], authority=self.config["authority"],[0m
[30;1m425 | [0m[35m            client_credential={[0m
[30;1m426 | [0m[35m                "private_key": private_key,[0m
[30;1m427 | [0m[35m                "thumbprint": self.config["thumbprint"],[0m
[30;1m428 | [0m[35m                "public_certificate": public_certificate,[0m
[30;1m429 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m423 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m
[30;1m424 | [0m[35m            self.config['client_id'], authority=self.config["authority"],[0m
[30;1m425 | [0m[35m            client_credential={[0m
[30;1m426 | [0m[35m                "private_key": private_key,[0m
[30;1m427 | [0m[35m                "thumbprint": self.config["thumbprint"],[0m
[30;1m428 | [0m[35m                "public_certificate": public_certificate,[0m
[30;1m429 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m417 | [0m[35m        if not "public_certificate" in client_cert:[0m
[30;1m418 | [0m[35m            self.skipTest("Skipping SNI test due to lack of public_certificate")[0m
[30;1m419 | [0m[35m        with open(os.path.join(THIS_FOLDER, client_cert['private_key_path'])) as f:[0m
[30;1m420 | [0m[35m            private_key = f.read()  # Should be in PEM format[0m
[30;1m421 | [0m[35m        with open(os.path.join(THIS_FOLDER, client_cert['public_certificate'])) as f:[0m
[30;1m422 | [0m[35m            public_certificate = f.read()[0m
[30;1m423 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m416 | [0m[35m        assert "private_key_path" in client_cert and "thumbprint" in client_cert[0m
[30;1m417 | [0m[35m        if not "public_certificate" in client_cert:[0m
[30;1m418 | [0m[35m            self.skipTest("Skipping SNI test due to lack of public_certificate")[0m
[30;1m419 | [0m[35m        with open(os.path.join(THIS_FOLDER, client_cert['private_key_path'])) as f:[0m
[30;1m420 | [0m[35m            private_key = f.read()  # Should be in PEM format[0m
[30;1m421 | [0m[35m        with open(os.path.join(THIS_FOLDER, client_cert['public_certificate'])) as f:[0m
[30;1m422 | [0m[35m            public_certificate = f.read()[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m413 | [0m[35m    def test_subject_name_issuer_authentication(self):[0m
[30;1m414 | [0m[35m        self.skipUnlessWithConfig(["client_id", "client_certificate"])[0m
[30;1m415 | [0m[35m        client_cert = self.config["client_certificate"][0m
[30;1m416 | [0m[35m        assert "private_key_path" in client_cert and "thumbprint" in client_cert[0m
[30;1m417 | [0m[35m        if not "public_certificate" in client_cert:[0m
[30;1m418 | [0m[35m            self.skipTest("Skipping SNI test due to lack of public_certificate")[0m
[30;1m419 | [0m[35m        with open(os.path.join(THIS_FOLDER, client_cert['private_key_path'])) as f:[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m403 | [0m[35m            private_key = f.read()  # Should be in PEM format[0m
[30;1m404 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m
[30;1m405 | [0m[35m            self.config['client_id'],[0m
[30;1m406 | [0m[35m            {"private_key": private_key, "thumbprint": client_cert["thumbprint"]},[0m
[30;1m407 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m408 | [0m[35m        scope = self.config.get("scope", [])[0m
[30;1m409 | [0m[35m        result = self.app.acquire_token_for_client(scope)[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m403 | [0m[35m            private_key = f.read()  # Should be in PEM format[0m
[30;1m404 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m
[30;1m405 | [0m[35m            self.config['client_id'],[0m
[30;1m406 | [0m[35m            {"private_key": private_key, "thumbprint": client_cert["thumbprint"]},[0m
[30;1m407 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m408 | [0m[35m        scope = self.config.get("scope", [])[0m
[30;1m409 | [0m[35m        result = self.app.acquire_token_for_client(scope)[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m400 | [0m[35m        client_cert = self.config["client_certificate"][0m
[30;1m401 | [0m[35m        assert "private_key_path" in client_cert and "thumbprint" in client_cert[0m
[30;1m402 | [0m[35m        with open(os.path.join(THIS_FOLDER, client_cert['private_key_path'])) as f:[0m
[30;1m403 | [0m[35m            private_key = f.read()  # Should be in PEM format[0m
[30;1m404 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m
[30;1m405 | [0m[35m            self.config['client_id'],[0m
[30;1m406 | [0m[35m            {"private_key": private_key, "thumbprint": client_cert["thumbprint"]},[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m399 | [0m[35m        self.skipUnlessWithConfig(["client_id", "client_certificate"])[0m
[30;1m400 | [0m[35m        client_cert = self.config["client_certificate"][0m
[30;1m401 | [0m[35m        assert "private_key_path" in client_cert and "thumbprint" in client_cert[0m
[30;1m402 | [0m[35m        with open(os.path.join(THIS_FOLDER, client_cert['private_key_path'])) as f:[0m
[30;1m403 | [0m[35m            private_key = f.read()  # Should be in PEM format[0m
[30;1m404 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m
[30;1m405 | [0m[35m            self.config['client_id'],[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m398 | [0m[35m    def test_client_certificate(self):[0m
[30;1m399 | [0m[35m        self.skipUnlessWithConfig(["client_id", "client_certificate"])[0m
[30;1m400 | [0m[35m        client_cert = self.config["client_certificate"][0m
[30;1m401 | [0m[35m        assert "private_key_path" in client_cert and "thumbprint" in client_cert[0m
[30;1m402 | [0m[35m        with open(os.path.join(THIS_FOLDER, client_cert['private_key_path'])) as f:[0m
[30;1m403 | [0m[35m            private_key = f.read()  # Should be in PEM format[0m
[30;1m404 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    def test_username_password(self):[0m
[30;1m346 | [0m[35m        self.skipUnlessWithConfig(["client_id", "username", "password", "scope"])[0m
[30;1m347 | [0m[35m        self._test_username_password(**self.config)[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    def _get_app_and_auth_code(self, scopes=None, **kwargs):[0m
[30;1m350 | [0m[35m        return _get_app_and_auth_code([0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m343 | [0m[35m                self.skipTest('Skipping due to lack of configuration "%s"' % field)[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    def test_username_password(self):[0m
[30;1m346 | [0m[35m        self.skipUnlessWithConfig(["client_id", "username", "password", "scope"])[0m
[30;1m347 | [0m[35m        self._test_username_password(**self.config)[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    def _get_app_and_auth_code(self, scopes=None, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m342 | [0m[35m            if field not in self.config:[0m
[30;1m343 | [0m[35m                self.skipTest('Skipping due to lack of configuration "%s"' % field)[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    def test_username_password(self):[0m
[30;1m346 | [0m[35m        self.skipUnlessWithConfig(["client_id", "username", "password", "scope"])[0m
[30;1m347 | [0m[35m        self._test_username_password(**self.config)[0m
[30;1m348 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m214 | [0m[35m        self.assertEqual([0m
[30;1m215 | [0m[35m            self.app.get_accounts(username=username), [], "Cache starts empty")[0m
[30;1m216 | [0m[35m        result = self.app.acquire_token_by_username_password([0m
[30;1m217 | [0m[35m            username, password, scopes=scope, auth_scheme=auth_scheme)[0m
[30;1m218 | [0m[35m        self.assertLoosely(result)[0m
[30;1m219 | [0m[35m        self.assertCacheWorksForUser([0m
[30;1m220 | [0m[35m            result, scope,[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m213 | [0m[35m            client_credential=client_secret)[0m
[30;1m214 | [0m[35m        self.assertEqual([0m
[30;1m215 | [0m[35m            self.app.get_accounts(username=username), [], "Cache starts empty")[0m
[30;1m216 | [0m[35m        result = self.app.acquire_token_by_username_password([0m
[30;1m217 | [0m[35m            username, password, scopes=scope, auth_scheme=auth_scheme)[0m
[30;1m218 | [0m[35m        self.assertLoosely(result)[0m
[30;1m219 | [0m[35m        self.assertCacheWorksForUser([0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m203 | [0m[35m            http_client=None,[0m
[30;1m204 | [0m[35m            auth_scheme=None,[0m
[30;1m205 | [0m[35m            **ignored):[0m
[30;1m206 | [0m[35m        assert client_id and username and password and scope and ([0m
[30;1m207 | [0m[35m            authority or oidc_authority)[0m
[30;1m208 | [0m[35m        self.app = self._build_app([0m
[30;1m209 | [0m[35m            client_id, authority=authority, oidc_authority=oidc_authority,[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m196 | [0m[35m                )[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    def _test_username_password(self,[0m
[30;1m199 | [0m[35m            authority=None, client_id=None, username=None, password=None, scope=None,[0m
[30;1m200 | [0m[35m            oidc_authority=None,[0m
[30;1m201 | [0m[35m            client_secret=None,  # Since MSAL 1.11, confidential client has ROPC too[0m
[30;1m202 | [0m[35m            azure_region=None,[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m                enable_broker_on_mac=_PYMSALRUNTIME_INSTALLED,[0m
[30;1m196 | [0m[35m                )[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    def _test_username_password(self,[0m
[30;1m199 | [0m[35m            authority=None, client_id=None, username=None, password=None, scope=None,[0m
[30;1m200 | [0m[35m            oidc_authority=None,[0m
[30;1m201 | [0m[35m            client_secret=None,  # Since MSAL 1.11, confidential client has ROPC too[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m                username_uri, description="here" if html_mode else None)),[0m
[30;1m81 | [0m[35m        lab=_render([0m
[30;1m82 | [0m[35m            "https://aka.ms/GetLabSecret?Secret=" + (lab_name or "msidlabXYZ"),[0m
[30;1m83 | [0m[35m            description="this password api" if html_mode else None,[0m
[30;1m84 | [0m[35m            ),[0m
[30;1m85 | [0m[35m        )[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35mdef _get_hint(html_mode=None, username=None, lab_name=None, username_uri=None):[0m
[30;1m76 | [0m[35m    return "Sign in with {user} whose password is available from {lab}".format([0m
[30;1m77 | [0m[35m        user=("<b>{}</b>".format(username) if html_mode else username)[0m
[30;1m78 | [0m[35m            if username[0m
[30;1m79 | [0m[35m            else "the upn from {}".format(_render([0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m556 | [0m[35m        result = resp.json()[0][0m
[30;1m557 | [0m[35m        assert result.get("upn"), "Found no test user but {}".format([0m
[30;1m558 | [0m[35m            json.dumps(result, indent=2))[0m
[30;1m559 | [0m[35m        _env = query.get("azureenvironment", "").lower()[0m
[30;1m560 | [0m[35m        authority_base = {[0m
[30;1m561 | [0m[35m            "azureusgovernment": "https://login.microsoftonline.us/"[0m
[30;1m562 | [0m[35m            }.get(_env, "https://login.microsoftonline.com/")[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m480 | [0m[35m                os.getenv(env_client_cert_path),[0m
[30;1m481 | [0m[35m            "public_certificate": True,  # Opt in for SNI[0m
[30;1m482 | [0m[35m            }[0m
[30;1m483 | [0m[35m    elif os.getenv(env_client_id) and os.getenv(env_name2):[0m
[30;1m484 | [0m[35m        # Data came from here[0m
[30;1m485 | [0m[35m        # https://docs.msidlab.com/accounts/confidentialclient.html[0m
[30;1m486 | [0m[35m        client_id = os.getenv(env_client_id)[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m471 | [0m[35m        "Reading ENV variables %s and %s for lab app defined at "[0m
[30;1m472 | [0m[35m        "https://docs.msidlab.com/accounts/confidentialclient.html",[0m
[30;1m473 | [0m[35m        env_client_id, env_name2)[0m
[30;1m474 | [0m[35m    if os.getenv(env_client_id) and os.getenv(env_client_cert_path):[0m
[30;1m475 | [0m[35m        # id came from https://docs.msidlab.com/accounts/confidentialclient.html[0m
[30;1m476 | [0m[35m        client_id = os.getenv(env_client_id)[0m
[30;1m477 | [0m[35m        client_credential = {[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m        username = "johndoe@contoso.com"[0m
[30;1m66 | [0m[35m        with patch.object(app.http_client, "post", return_value=MinimalResponse([0m
[30;1m67 | [0m[35m                status_code=400, text='{"error": "mock"}')) as mocked_method:[0m
[30;1m68 | [0m[35m            app.acquire_token_by_username_password(username, "password", ["scope"])[0m
[30;1m69 | [0m[35m            self.assertEqual([0m
[30;1m70 | [0m[35m                "upn:" + username,[0m
[30;1m71 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m        username = "johndoe@contoso.com"[0m
[30;1m66 | [0m[35m        with patch.object(app.http_client, "post", return_value=MinimalResponse([0m
[30;1m67 | [0m[35m                status_code=400, text='{"error": "mock"}')) as mocked_method:[0m
[30;1m68 | [0m[35m            app.acquire_token_by_username_password(username, "password", ["scope"])[0m
[30;1m69 | [0m[35m            self.assertEqual([0m
[30;1m70 | [0m[35m                "upn:" + username,[0m
[30;1m71 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m
[30;1m61 | [0m[35m                "CSS routing info should be derived from home_account_id")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def test_acquire_token_by_username_password(self):[0m
[30;1m64 | [0m[35m        app = msal.ClientApplication("client_id")[0m
[30;1m65 | [0m[35m        username = "johndoe@contoso.com"[0m
[30;1m66 | [0m[35m        with patch.object(app.http_client, "post", return_value=MinimalResponse([0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m740 | [0m[35m        """The Resource Owner Password Credentials Grant, used by legacy app."""[0m
[30;1m741 | [0m[35m        data = kwargs.pop("data", {})[0m
[30;1m742 | [0m[35m        data.update(username=username, password=password, scope=scope)[0m
[30;1m743 | [0m[35m        return self._obtain_token("password", data=data, **kwargs)[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m    def obtain_token_for_client(self, scope=None, **kwargs):[0m
[30;1m746 | [0m[35m        """Obtain token for this client (rather than for an end user),[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m739 | [0m[35m            self, username, password, scope=None, **kwargs):[0m
[30;1m740 | [0m[35m        """The Resource Owner Password Credentials Grant, used by legacy app."""[0m
[30;1m741 | [0m[35m        data = kwargs.pop("data", {})[0m
[30;1m742 | [0m[35m        data.update(username=username, password=password, scope=scope)[0m
[30;1m743 | [0m[35m        return self._obtain_token("password", data=data, **kwargs)[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m    def obtain_token_for_client(self, scope=None, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m739 | [0m[35m            self, username, password, scope=None, **kwargs):[0m
[30;1m740 | [0m[35m        """The Resource Owner Password Credentials Grant, used by legacy app."""[0m
[30;1m741 | [0m[35m        data = kwargs.pop("data", {})[0m
[30;1m742 | [0m[35m        data.update(username=username, password=password, scope=scope)[0m
[30;1m743 | [0m[35m        return self._obtain_token("password", data=data, **kwargs)[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m    def obtain_token_for_client(self, scope=None, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m    def obtain_token_by_username_password([0m
[30;1m739 | [0m[35m            self, username, password, scope=None, **kwargs):[0m
[30;1m740 | [0m[35m        """The Resource Owner Password Credentials Grant, used by legacy app."""[0m
[30;1m741 | [0m[35m        data = kwargs.pop("data", {})[0m
[30;1m742 | [0m[35m        data.update(username=username, password=password, scope=scope)[0m
[30;1m743 | [0m[35m        return self._obtain_token("password", data=data, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m736 | [0m[35m        return self._obtain_token("authorization_code", data=data, **kwargs)[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m    def obtain_token_by_username_password([0m
[30;1m739 | [0m[35m            self, username, password, scope=None, **kwargs):[0m
[30;1m740 | [0m[35m        """The Resource Owner Password Credentials Grant, used by legacy app."""[0m
[30;1m741 | [0m[35m        data = kwargs.pop("data", {})[0m
[30;1m742 | [0m[35m        data.update(username=username, password=password, scope=scope)[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m735 | [0m[35m            data["client_id"] = self.client_id[0m
[30;1m736 | [0m[35m        return self._obtain_token("authorization_code", data=data, **kwargs)[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m    def obtain_token_by_username_password([0m
[30;1m739 | [0m[35m            self, username, password, scope=None, **kwargs):[0m
[30;1m740 | [0m[35m        """The Resource Owner Password Credentials Grant, used by legacy app."""[0m
[30;1m741 | [0m[35m        data = kwargs.pop("data", {})[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m216 | [0m[35m        _headers.update(headers or {})[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        # Quoted from https://tools.ietf.org/html/rfc6749#section-2.3.1[0m
[30;1m219 | [0m[35m        # Clients in possession of a client password MAY use the HTTP Basic[0m
[30;1m220 | [0m[35m        # authentication.[0m
[30;1m221 | [0m[35m        # Alternatively, (but NOT RECOMMENDED,)[0m
[30;1m222 | [0m[35m        # the authorization server MAY support including the[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m281 | [0m[35m        random.sample(string.ascii_letters + string.digits + "-._~", length))[0m
[30;1m282 | [0m[35m    code_challenge = ([0m
[30;1m283 | [0m[35m        # https://tools.ietf.org/html/rfc7636#section-4.2[0m
[30;1m284 | [0m[35m        base64.urlsafe_b64encode(hashlib.sha256(verifier.encode("ascii")).digest())[0m
[30;1m285 | [0m[35m        .rstrip(b"="))  # Required by https://tools.ietf.org/html/rfc7636#section-3[0m
[30;1m286 | [0m[35m    return {[0m
[30;1m287 | [0m[35m        "code_verifier": verifier,[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m223 | [0m[35m        # client credentials in the request-body using the following[0m
[30;1m224 | [0m[35m        # parameters: client_id, client_secret.[0m
[30;1m225 | [0m[35m        if self.client_secret and self.client_id:[0m
[30;1m226 | [0m[35m            _headers["Authorization"] = "Basic " + base64.b64encode("{}:{}".format([0m
[30;1m227 | [0m[35m                # Per https://tools.ietf.org/html/rfc6749#section-2.3.1[0m
[30;1m228 | [0m[35m                # client_id and client_secret needs to be encoded by[0m
[30;1m229 | [0m[35m                # "application/x-www-form-urlencoded"[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m100 | [0m[35m            client_secret (str):  Triggers HTTP AUTH for Confidential Client[0m
[30;1m101 | [0m[35m            client_assertion (bytes, callable):[0m
[30;1m102 | [0m[35m                The client assertion to authenticate this client, per RFC 7521.[0m
[30;1m103 | [0m[35m                It can be a raw SAML2 assertion (we will base64 encode it for you),[0m
[30;1m104 | [0m[35m                or a raw JWT assertion in bytes (which we will relay to http layer).[0m
[30;1m105 | [0m[35m                It can also be a callable (recommended),[0m
[30;1m106 | [0m[35m                so that we will do lazy creation of an assertion.[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    @staticmethod[0m
[30;1m40 | [0m[35m    def encode_saml_assertion(assertion):[0m
[30;1m41 | [0m[35m        return base64.urlsafe_b64encode(assertion).rstrip(b'=')  # Per RFC 7522[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    CLIENT_ASSERTION_TYPE_JWT = "urn:ietf:params:oauth:client-assertion-type:jwt-bearer"[0m
[30;1m44 | [0m[35m    CLIENT_ASSERTION_TYPE_SAML2 = "urn:ietf:params:oauth:client-assertion-type:saml2-bearer"[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m10 | [0m[35mimport logging[0m
[30;1m11 | [0m[35mimport warnings[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mimport base64[0m
[30;1m14 | [0m[35mimport sys[0m
[30;1m15 | [0m[35mimport functools[0m
[30;1m16 | [0m[35mimport random[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m29 | [0m[35m        # On Python 2.7, argument of urlsafe_b64decode must be str, not unicode.[0m
[30;1m30 | [0m[35m        # This is not required on Python 3.[0m
[30;1m31 | [0m[35m        raw)[0m
[30;1m32 | [0m[35m    output = base64.urlsafe_b64decode(raw)[0m
[30;1m33 | [0m[35m    if encoding:[0m
[30;1m34 | [0m[35m        output = output.decode(encoding)[0m
[30;1m35 | [0m[35m    return output[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport random[0m
[30;1m5 | [0m[35mimport string[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m34 | [0m[35m        ):[0m
[30;1m35 | [0m[35m    response = {}[0m
[30;1m36 | [0m[35m    if uid and utid:  # Mimic the AAD behavior for "client_info=1" request[0m
[30;1m37 | [0m[35m        response["client_info"] = base64.b64encode(json.dumps({[0m
[30;1m38 | [0m[35m            "uid": uid, "utid": utid,[0m
[30;1m39 | [0m[35m            }).encode()).decode('utf-8')[0m
[30;1m40 | [0m[35m    if access_token:[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m18 | [0m[35mdef build_id_token([0m
[30;1m19 | [0m[35m        iss="issuer", sub="subject", aud="my_client_id", exp=None, iat=None,[0m
[30;1m20 | [0m[35m        **claims):  # AAD issues "preferred_username", ADFS issues "upn"[0m
[30;1m21 | [0m[35m    return "header.%s.signature" % base64.b64encode(json.dumps(dict({[0m
[30;1m22 | [0m[35m        "iss": iss,[0m
[30;1m23 | [0m[35m        "sub": sub,[0m
[30;1m24 | [0m[35m        "aud": aud,[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m720 | [0m[35m        self.assertEqual([0m
[30;1m721 | [0m[35m            1, len(cca.token_cache.find(msal.TokenCache.CredentialType.ACCESS_TOKEN)))[0m
[30;1m722 | [0m[35m        cca.acquire_token_by_username_password([0m
[30;1m723 | [0m[35m            "johndoe", "password", ["scope"],[0m
[30;1m724 | [0m[35m            post=lambda url, **kwargs: MinimalResponse([0m
[30;1m725 | [0m[35m                status_code=200, text=json.dumps(build_response([0m
[30;1m726 | [0m[35m                    access_token=at_for_user, expires_in=3600,[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m719 | [0m[35m                status_code=200, text=json.dumps({"access_token": "AT for client"})))[0m
[30;1m720 | [0m[35m        self.assertEqual([0m
[30;1m721 | [0m[35m            1, len(cca.token_cache.find(msal.TokenCache.CredentialType.ACCESS_TOKEN)))[0m
[30;1m722 | [0m[35m        cca.acquire_token_by_username_password([0m
[30;1m723 | [0m[35m            "johndoe", "password", ["scope"],[0m
[30;1m724 | [0m[35m            post=lambda url, **kwargs: MinimalResponse([0m
[30;1m725 | [0m[35m                status_code=200, text=json.dumps(build_response([0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m581 | [0m[35m            self.assertEqual("4|301,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m582 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m583 | [0m[35m        result = self.app.acquire_token_by_username_password([0m
[30;1m584 | [0m[35m            "username", "password", ["scope"], post=mock_post)[0m
[30;1m585 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m586 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m587 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m580 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m581 | [0m[35m            self.assertEqual("4|301,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m582 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m583 | [0m[35m        result = self.app.acquire_token_by_username_password([0m
[30;1m584 | [0m[35m            "username", "password", ["scope"], post=mock_post)[0m
[30;1m585 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m586 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m575 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m576 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m577 | [0m[35m[0m
[30;1m578 | [0m[35m    def test_acquire_token_by_username_password(self):[0m
[30;1m579 | [0m[35m        at = "this is an access token"[0m
[30;1m580 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m581 | [0m[35m            self.assertEqual("4|301,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m268 | [0m[35m    def test_get_accounts_should_find_accounts_under_different_alias(self):[0m
[30;1m269 | [0m[35m        accounts = self.app.get_accounts()[0m
[30;1m270 | [0m[35m        self.assertNotEqual([], accounts)[0m
[30;1m271 | [0m[35m        self.assertEqual(self.environment_in_cache, accounts[0].get("environment"),[0m
[30;1m272 | [0m[35m            "We should be able to find an account under an authority alias")[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    def test_acquire_token_silent_should_find_at_under_different_alias(self):[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m77 | [0m[35m        Args:[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m            key (str):[0m
[30;1m80 | [0m[35m                An unencrypted private key for signing, in a base64 encoded string.[0m
[30;1m81 | [0m[35m                It can also be a cryptography ``PrivateKey`` object,[0m
[30;1m82 | [0m[35m                which is how you can work with a previously-encrypted key.[0m
[30;1m83 | [0m[35m                See also https://github.com/jpadilla/pyjwt/pull/525[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m16 | [0m[35m        return raw[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mdef _encode_thumbprint(thumbprint):[0m
[30;1m19 | [0m[35m    return base64.urlsafe_b64encode(binascii.a2b_hex(thumbprint)).decode()[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mclass AssertionCreator(object):[0m
[30;1m22 | [0m[35m    def create_normal_assertion([0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport binascii[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport uuid[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m            key (str):[0m
[30;1m80 | [0m[35m                An unencrypted private key for signing, in a base64 encoded string.[0m
[30;1m81 | [0m[35m                It can also be a cryptography ``PrivateKey`` object,[0m
[30;1m82 | [0m[35m                which is how you can work with a previously-encrypted key.[0m
[30;1m83 | [0m[35m                See also https://github.com/jpadilla/pyjwt/pull/525[0m
[30;1m84 | [0m[35m            algorithm (str):[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m288 | [0m[35m                target=[resource],[0m
[30;1m289 | [0m[35m                query=dict([0m
[30;1m290 | [0m[35m                    client_id=client_id_in_cache,[0m
[30;1m291 | [0m[35m                    environment=self._get_instance(),[0m
[30;1m292 | [0m[35m                    realm=self._tenant,[0m
[30;1m293 | [0m[35m                    home_account_id=None,[0m
[30;1m294 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m195 | [0m[35m    'token_type': 'pop',[0m
[30;1m196 | [0m[35m    'key_id': _POP_KEY_ID,[0m
[30;1m197 | [0m[35m    "req_cnf": base64.urlsafe_b64encode(_RAW_REQ_CNF.encode('utf-8')).decode('utf-8').rstrip('='),[0m
[30;1m198 | [0m[35m        # Note: Sending _RAW_REQ_CNF without base64 encoding would result in an http 500 error[0m
[30;1m199 | [0m[35m}  # See also https://github.com/Azure/azure-cli-extensions/blob/main/src/connectedk8s/azext_connect[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35mdef _acquire_pop_token_interactive(app):[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m194 | [0m[35m_POP_DATA = {  # Sampled from Azure CLI's plugin connectedk8s[0m
[30;1m195 | [0m[35m    'token_type': 'pop',[0m
[30;1m196 | [0m[35m    'key_id': _POP_KEY_ID,[0m
[30;1m197 | [0m[35m    "req_cnf": base64.urlsafe_b64encode(_RAW_REQ_CNF.encode('utf-8')).decode('utf-8').rstrip('='),[0m
[30;1m198 | [0m[35m        # Note: Sending _RAW_REQ_CNF without base64 encoding would result in an http 500 error[0m
[30;1m199 | [0m[35m}  # See also https://github.com/Azure/azure-cli-extensions/blob/main/src/connectedk8s/azext_connect[0m
[30;1m200 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m10 | [0m[35mUsage 2: Build an all-in-one executable file for bug bash.[0m
[30;1m11 | [0m[35m    shiv -e msal.__main__._main -o msaltest-on-os-name.pyz .[0m
[30;1m12 | [0m[35m"""[0m
[30;1m13 | [0m[35mimport base64, getpass, json, logging, sys, os, atexit, msal[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m_token_cache_filename = "msal_cache.bin"[0m
[30;1m16 | [0m[35mglobal_cache = msal.SerializableTokenCache()[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m320 | [0m[35m            _acquire_pop_token_interactive,[0m
[30;1m321 | [0m[35m            ] if isinstance(app, msal.PublicClientApplication) else [][0m
[30;1m322 | [0m[35m        ) + [[0m
[30;1m323 | [0m[35m            _acquire_token_by_username_password,[0m
[30;1m324 | [0m[35m            _remove_account,[0m
[30;1m325 | [0m[35m        ] + ([[0m
[30;1m326 | [0m[35m            _acquire_token_for_client,[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m151 | [0m[35mdef _acquire_token_by_username_password(app):[0m
[30;1m152 | [0m[35m    """acquire_token_by_username_password() - See constraints here: https://docs.microsoft.com/en-us[0m
[30;1m153 | [0m[35m    print_json(app.acquire_token_by_username_password([0m
[30;1m154 | [0m[35m        _input("username: "), getpass.getpass("password: "), scopes=_input_scopes()))[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35mdef _acquire_token_by_device_flow(app):[0m
[30;1m157 | [0m[35m    """acquire_token_by_device_flow() - Note that this one does not go through broker"""[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35mdef _acquire_token_by_username_password(app):[0m
[30;1m152 | [0m[35m    """acquire_token_by_username_password() - See constraints here: https://docs.microsoft.com/en-us[0m
[30;1m153 | [0m[35m    print_json(app.acquire_token_by_username_password([0m
[30;1m154 | [0m[35m        _input("username: "), getpass.getpass("password: "), scopes=_input_scopes()))[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35mdef _acquire_token_by_device_flow(app):[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m149 | [0m[35m    return result[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35mdef _acquire_token_by_username_password(app):[0m
[30;1m152 | [0m[35m    """acquire_token_by_username_password() - See constraints here: https://docs.microsoft.com/en-us[0m
[30;1m153 | [0m[35m    print_json(app.acquire_token_by_username_password([0m
[30;1m154 | [0m[35m        _input("username: "), getpass.getpass("password: "), scopes=_input_scopes()))[0m
[30;1m155 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m148 | [0m[35m    print_json(result)[0m
[30;1m149 | [0m[35m    return result[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35mdef _acquire_token_by_username_password(app):[0m
[30;1m152 | [0m[35m    """acquire_token_by_username_password() - See constraints here: https://docs.microsoft.com/en-us[0m
[30;1m153 | [0m[35m    print_json(app.acquire_token_by_username_password([0m
[30;1m154 | [0m[35m        _input("username: "), getpass.getpass("password: "), scopes=_input_scopes()))[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35m            endpoint_address=endpoint_address,[0m
[30;1m117 | [0m[35m            time_now=wsu_time_format(now),[0m
[30;1m118 | [0m[35m            time_expire=wsu_time_format(now + timedelta(minutes=10)),[0m
[30;1m119 | [0m[35m            username=username, password=escape_password(password),[0m
[30;1m120 | [0m[35m            wst=Mex.NS["wst"] if soap_action == Mex.ACTION_13 else Mex.NS["wst2005"],[0m
[30;1m121 | [0m[35m            applies_to=cloud_audience_urn,[0m
[30;1m122 | [0m[35m            key_type='http://docs.oasis-open.org/ws-sx/ws-trust/200512/Bearer'[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35m            endpoint_address=endpoint_address,[0m
[30;1m117 | [0m[35m            time_now=wsu_time_format(now),[0m
[30;1m118 | [0m[35m            time_expire=wsu_time_format(now + timedelta(minutes=10)),[0m
[30;1m119 | [0m[35m            username=username, password=escape_password(password),[0m
[30;1m120 | [0m[35m            wst=Mex.NS["wst"] if soap_action == Mex.ACTION_13 else Mex.NS["wst2005"],[0m
[30;1m121 | [0m[35m            applies_to=cloud_audience_urn,[0m
[30;1m122 | [0m[35m            key_type='http://docs.oasis-open.org/ws-sx/ws-trust/200512/Bearer'[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35m            endpoint_address=endpoint_address,[0m
[30;1m117 | [0m[35m            time_now=wsu_time_format(now),[0m
[30;1m118 | [0m[35m            time_expire=wsu_time_format(now + timedelta(minutes=10)),[0m
[30;1m119 | [0m[35m            username=username, password=escape_password(password),[0m
[30;1m120 | [0m[35m            wst=Mex.NS["wst"] if soap_action == Mex.ACTION_13 else Mex.NS["wst2005"],[0m
[30;1m121 | [0m[35m            applies_to=cloud_audience_urn,[0m
[30;1m122 | [0m[35m            key_type='http://docs.oasis-open.org/ws-sx/ws-trust/200512/Bearer'[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m                </wsu:Timestamp>[0m
[30;1m95 | [0m[35m                <wsse:UsernameToken wsu:Id='ADALUsernameToken'>[0m
[30;1m96 | [0m[35m                    <wsse:Username>{username}</wsse:Username>[0m
[30;1m97 | [0m[35m                    <wsse:Password>{password}</wsse:Password>[0m
[30;1m98 | [0m[35m                </wsse:UsernameToken>[0m
[30;1m99 | [0m[35m            </wsse:Security>[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m                </wsu:Timestamp>[0m
[30;1m95 | [0m[35m                <wsse:UsernameToken wsu:Id='ADALUsernameToken'>[0m
[30;1m96 | [0m[35m                    <wsse:Username>{username}</wsse:Username>[0m
[30;1m97 | [0m[35m                    <wsse:Password>{password}</wsse:Password>[0m
[30;1m98 | [0m[35m                </wsse:UsernameToken>[0m
[30;1m99 | [0m[35m            </wsse:Security>[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m                </wsu:Timestamp>[0m
[30;1m95 | [0m[35m                <wsse:UsernameToken wsu:Id='ADALUsernameToken'>[0m
[30;1m96 | [0m[35m                    <wsse:Username>{username}</wsse:Username>[0m
[30;1m97 | [0m[35m                    <wsse:Password>{password}</wsse:Password>[0m
[30;1m98 | [0m[35m                </wsse:UsernameToken>[0m
[30;1m99 | [0m[35m            </wsse:Security>[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m    return datetime_obj.strftime('%Y-%m-%dT%H:%M:%SZ')[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef _build_rst(username, password, cloud_audience_urn, endpoint_address, soap_action):[0m
[30;1m79 | [0m[35m    now = datetime.utcnow()[0m
[30;1m80 | [0m[35m    return """<s:Envelope xmlns:s='{s}' xmlns:wsa='{wsa}' xmlns:wsu='{wsu}'>[0m
[30;1m81 | [0m[35m        <s:Header>[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35mdef escape_password(password):[0m
[30;1m64 | [0m[35m    return (password.replace('&', '&amp;').replace('"', '&quot;')[0m
[30;1m65 | [0m[35m        .replace("'", '&apos;')  # the only one not provided by cgi.escape(s, True)[0m
[30;1m66 | [0m[35m        .replace('<', '&lt;').replace('>', '&gt;'))[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m    return parse_response(resp.text)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35mdef escape_password(password):[0m
[30;1m64 | [0m[35m    return (password.replace('&', '&amp;').replace('"', '&quot;')[0m
[30;1m65 | [0m[35m        .replace("'", '&apos;')  # the only one not provided by cgi.escape(s, True)[0m
[30;1m66 | [0m[35m        .replace('<', '&lt;').replace('>', '&gt;'))[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m    return parse_response(resp.text)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35mdef escape_password(password):[0m
[30;1m64 | [0m[35m    return (password.replace('&', '&amp;').replace('"', '&quot;')[0m
[30;1m65 | [0m[35m        .replace("'", '&apos;')  # the only one not provided by cgi.escape(s, True)[0m
[30;1m66 | [0m[35m        .replace('<', '&lt;').replace('>', '&gt;'))[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m            }, **kwargs)[0m
[30;1m56 | [0m[35m    if resp.status_code >= 400:[0m
[30;1m57 | [0m[35m        logger.debug("Unsuccessful WsTrust request receives: %s", resp.text)[0m
[30;1m58 | [0m[35m    # It turns out ADFS uses 5xx status code even with client-side incorrect password error[0m
[30;1m59 | [0m[35m    # resp.raise_for_status()[0m
[30;1m60 | [0m[35m    return parse_response(resp.text)[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m        raise ValueError("Unsupported soap action: %s. "[0m
[30;1m49 | [0m[35m            "Contact your administrator to check your ADFS's MEX settings." % soap_action)[0m
[30;1m50 | [0m[35m    data = _build_rst([0m
[30;1m51 | [0m[35m        username, password, cloud_audience_urn, endpoint_address, soap_action)[0m
[30;1m52 | [0m[35m    resp = http_client.post(endpoint_address, data=data, headers={[0m
[30;1m53 | [0m[35m            'Content-type':'application/soap+xml; charset=utf-8',[0m
[30;1m54 | [0m[35m            'SOAPAction': soap_action,[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mdef send_request([0m
[30;1m38 | [0m[35m        username, password, cloud_audience_urn, endpoint_address, soap_action, http_client,[0m
[30;1m39 | [0m[35m        **kwargs):[0m
[30;1m40 | [0m[35m    if not endpoint_address:[0m
[30;1m41 | [0m[35m        raise ValueError("WsTrust endpoint address can not be empty")[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1884 | [0m[35m                    "https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Use[0m
[30;1m1885 | [0m[35m        logger.debug("wstrust_endpoint = %s", wstrust_endpoint)[0m
[30;1m1886 | [0m[35m        wstrust_result = wst_send_request([0m
[30;1m1887 | [0m[35m            username, password,[0m
[30;1m1888 | [0m[35m            user_realm_result.get("cloud_audience_urn", "urn:federation:MicrosoftOnline"),[0m
[30;1m1889 | [0m[35m            wstrust_endpoint.get("address",[0m
[30;1m1890 | [0m[35m                # Fallback to an AAD supplied endpoint[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1881 | [0m[35m                raise ValueError("Unable to find wstrust endpoint from MEX. "[0m
[30;1m1882 | [0m[35m                    "This typically happens when attempting MSA accounts. "[0m
[30;1m1883 | [0m[35m                    "More details available here. "[0m
[30;1m1884 | [0m[35m                    "https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Use[0m
[30;1m1885 | [0m[35m        logger.debug("wstrust_endpoint = %s", wstrust_endpoint)[0m
[30;1m1886 | [0m[35m        wstrust_result = wst_send_request([0m
[30;1m1887 | [0m[35m            username, password,[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1871 | [0m[35m        return response[0m
[30;1m1872 | [0m[35m[0m
[30;1m1873 | [0m[35m    def _acquire_token_by_username_password_federated([0m
[30;1m1874 | [0m[35m            self, user_realm_result, username, password, scopes=None, **kwargs):[0m
[30;1m1875 | [0m[35m        wstrust_endpoint = {}[0m
[30;1m1876 | [0m[35m        if user_realm_result.get("federation_metadata_url"):[0m
[30;1m1877 | [0m[35m            wstrust_endpoint = mex_send_request([0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1870 | [0m[35m        telemetry_context.update_telemetry(response)[0m
[30;1m1871 | [0m[35m        return response[0m
[30;1m1872 | [0m[35m[0m
[30;1m1873 | [0m[35m    def _acquire_token_by_username_password_federated([0m
[30;1m1874 | [0m[35m            self, user_realm_result, username, password, scopes=None, **kwargs):[0m
[30;1m1875 | [0m[35m        wstrust_endpoint = {}[0m
[30;1m1876 | [0m[35m        if user_realm_result.get("federation_metadata_url"):[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1861 | [0m[35m                    headers=headers, **kwargs))[0m
[30;1m1862 | [0m[35m        if response is None:  # Either ADFS or not federated[0m
[30;1m1863 | [0m[35m            response = _clean_up(self.client.obtain_token_by_username_password([0m
[30;1m1864 | [0m[35m                username, password, scope=scopes,[0m
[30;1m1865 | [0m[35m                headers=headers,[0m
[30;1m1866 | [0m[35m                data=data,[0m
[30;1m1867 | [0m[35m                **kwargs))[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1860 | [0m[35m                    data=data,[0m
[30;1m1861 | [0m[35m                    headers=headers, **kwargs))[0m
[30;1m1862 | [0m[35m        if response is None:  # Either ADFS or not federated[0m
[30;1m1863 | [0m[35m            response = _clean_up(self.client.obtain_token_by_username_password([0m
[30;1m1864 | [0m[35m                username, password, scope=scopes,[0m
[30;1m1865 | [0m[35m                headers=headers,[0m
[30;1m1866 | [0m[35m                data=data,[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1856 | [0m[35m                username, correlation_id=headers[msal.telemetry.CLIENT_REQUEST_ID])[0m
[30;1m1857 | [0m[35m            if user_realm_result.get("account_type") == "Federated":[0m
[30;1m1858 | [0m[35m                response = _clean_up(self._acquire_token_by_username_password_federated([0m
[30;1m1859 | [0m[35m                    user_realm_result, username, password, scopes=scopes,[0m
[30;1m1860 | [0m[35m                    data=data,[0m
[30;1m1861 | [0m[35m                    headers=headers, **kwargs))[0m
[30;1m1862 | [0m[35m        if response is None:  # Either ADFS or not federated[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1855 | [0m[35m            user_realm_result = self.authority.user_realm_discovery([0m
[30;1m1856 | [0m[35m                username, correlation_id=headers[msal.telemetry.CLIENT_REQUEST_ID])[0m
[30;1m1857 | [0m[35m            if user_realm_result.get("account_type") == "Federated":[0m
[30;1m1858 | [0m[35m                response = _clean_up(self._acquire_token_by_username_password_federated([0m
[30;1m1859 | [0m[35m                    user_realm_result, username, password, scopes=scopes,[0m
[30;1m1860 | [0m[35m                    data=data,[0m
[30;1m1861 | [0m[35m                    headers=headers, **kwargs))[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1847 | [0m[35m            raise ValueError(self._AUTH_SCHEME_UNSUPPORTED)[0m
[30;1m1848 | [0m[35m        scopes = self._decorate_scope(scopes)[0m
[30;1m1849 | [0m[35m        telemetry_context = self._build_telemetry_context([0m
[30;1m1850 | [0m[35m            self.ACQUIRE_TOKEN_BY_USERNAME_PASSWORD_ID)[0m
[30;1m1851 | [0m[35m        headers = telemetry_context.generate_headers()[0m
[30;1m1852 | [0m[35m        data = dict(kwargs.pop("data", {}), claims=claims)[0m
[30;1m1853 | [0m[35m        response = None[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1834 | [0m[35m                self.client_id,[0m
[30;1m1835 | [0m[35m                scopes,  # Decorated scopes won't work due to offline_access[0m
[30;1m1836 | [0m[35m                MSALRuntime_Username=username,[0m
[30;1m1837 | [0m[35m                MSALRuntime_Password=password,[0m
[30;1m1838 | [0m[35m                validateAuthority="no" if ([0m
[30;1m1839 | [0m[35m                    self.authority._is_known_to_developer[0m
[30;1m1840 | [0m[35m                    or self._instance_discovery is False) else None,[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1834 | [0m[35m                self.client_id,[0m
[30;1m1835 | [0m[35m                scopes,  # Decorated scopes won't work due to offline_access[0m
[30;1m1836 | [0m[35m                MSALRuntime_Username=username,[0m
[30;1m1837 | [0m[35m                MSALRuntime_Password=password,[0m
[30;1m1838 | [0m[35m                validateAuthority="no" if ([0m
[30;1m1839 | [0m[35m                    self.authority._is_known_to_developer[0m
[30;1m1840 | [0m[35m                    or self._instance_discovery is False) else None,[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1805 | [0m[35m        https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Username-Passwor[0m
[30;1m1806 | [0m[35m[0m
[30;1m1807 | [0m[35m        :param str username: Typically a UPN in the form of an email address.[0m
[30;1m1808 | [0m[35m        :param str password: The password.[0m
[30;1m1809 | [0m[35m        :param list[str] scopes:[0m
[30;1m1810 | [0m[35m            Scopes requested to access a protected API (a resource).[0m
[30;1m1811 | [0m[35m        :param claims_challenge:[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1805 | [0m[35m        https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Username-Passwor[0m
[30;1m1806 | [0m[35m[0m
[30;1m1807 | [0m[35m        :param str username: Typically a UPN in the form of an email address.[0m
[30;1m1808 | [0m[35m        :param str password: The password.[0m
[30;1m1809 | [0m[35m        :param list[str] scopes:[0m
[30;1m1810 | [0m[35m            Scopes requested to access a protected API (a resource).[0m
[30;1m1811 | [0m[35m        :param claims_challenge:[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1802 | [0m[35m        """Gets a token for a given resource via user credentials.[0m
[30;1m1803 | [0m[35m[0m
[30;1m1804 | [0m[35m        See this page for constraints of Username Password Flow.[0m
[30;1m1805 | [0m[35m        https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Username-Passwor[0m
[30;1m1806 | [0m[35m[0m
[30;1m1807 | [0m[35m        :param str username: Typically a UPN in the form of an email address.[0m
[30;1m1808 | [0m[35m        :param str password: The password.[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1801 | [0m[35m            **kwargs):[0m
[30;1m1802 | [0m[35m        """Gets a token for a given resource via user credentials.[0m
[30;1m1803 | [0m[35m[0m
[30;1m1804 | [0m[35m        See this page for constraints of Username Password Flow.[0m
[30;1m1805 | [0m[35m        https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Username-Passwor[0m
[30;1m1806 | [0m[35m[0m
[30;1m1807 | [0m[35m        :param str username: Typically a UPN in the form of an email address.[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1794 | [0m[35m        return response[0m
[30;1m1795 | [0m[35m[0m
[30;1m1796 | [0m[35m    def acquire_token_by_username_password([0m
[30;1m1797 | [0m[35m            self, username, password, scopes, claims_challenge=None,[0m
[30;1m1798 | [0m[35m            # Note: We shouldn't need to surface enable_msa_passthrough,[0m
[30;1m1799 | [0m[35m            # because this ROPC won't work with MSA account anyway.[0m
[30;1m1800 | [0m[35m            auth_scheme=None,[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1793 | [0m[35m        telemetry_context.update_telemetry(response)[0m
[30;1m1794 | [0m[35m        return response[0m
[30;1m1795 | [0m[35m[0m
[30;1m1796 | [0m[35m    def acquire_token_by_username_password([0m
[30;1m1797 | [0m[35m            self, username, password, scopes, claims_challenge=None,[0m
[30;1m1798 | [0m[35m            # Note: We shouldn't need to surface enable_msa_passthrough,[0m
[30;1m1799 | [0m[35m            # because this ROPC won't work with MSA account anyway.[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m829 | [0m[35m                        "algorithm": "RS256", "sha1_thumbprint": sha1_thumbprint,[0m
[30;1m830 | [0m[35m                    }[0m
[30;1m831 | [0m[35m                assertion = JwtAssertionCreator([0m
[30;1m832 | [0m[35m                    private_key, headers=headers, **assertion_params)[0m
[30;1m833 | [0m[35m                client_assertion = assertion.create_regenerative_assertion([0m
[30;1m834 | [0m[35m                    audience=authority.token_endpoint, issuer=self.client_id,[0m
[30;1m835 | [0m[35m                    additional_claims=self.client_claims or {})[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m809 | [0m[35m                        private_key = _load_private_key_from_pem_str([0m
[30;1m810 | [0m[35m                            client_credential['private_key'], passphrase_bytes)[0m
[30;1m811 | [0m[35m                    else:  # PEM without passphrase[0m
[30;1m812 | [0m[35m                        private_key = client_credential['private_key'][0m
[30;1m813 | [0m[35m                else:[0m
[30;1m814 | [0m[35m                    raise ValueError([0m
[30;1m815 | [0m[35m                        "client_credential needs to follow this format "[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m809 | [0m[35m                        private_key = _load_private_key_from_pem_str([0m
[30;1m810 | [0m[35m                            client_credential['private_key'], passphrase_bytes)[0m
[30;1m811 | [0m[35m                    else:  # PEM without passphrase[0m
[30;1m812 | [0m[35m                        private_key = client_credential['private_key'][0m
[30;1m813 | [0m[35m                else:[0m
[30;1m814 | [0m[35m                    raise ValueError([0m
[30;1m815 | [0m[35m                        "client_credential needs to follow this format "[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m807 | [0m[35m                    sha1_thumbprint = client_credential["thumbprint"][0m
[30;1m808 | [0m[35m                    if passphrase_bytes:[0m
[30;1m809 | [0m[35m                        private_key = _load_private_key_from_pem_str([0m
[30;1m810 | [0m[35m                            client_credential['private_key'], passphrase_bytes)[0m
[30;1m811 | [0m[35m                    else:  # PEM without passphrase[0m
[30;1m812 | [0m[35m                        private_key = client_credential['private_key'][0m
[30;1m813 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m806 | [0m[35m                        and client_credential.get("thumbprint")):[0m
[30;1m807 | [0m[35m                    sha1_thumbprint = client_credential["thumbprint"][0m
[30;1m808 | [0m[35m                    if passphrase_bytes:[0m
[30;1m809 | [0m[35m                        private_key = _load_private_key_from_pem_str([0m
[30;1m810 | [0m[35m                            client_credential['private_key'], passphrase_bytes)[0m
[30;1m811 | [0m[35m                    else:  # PEM without passphrase[0m
[30;1m812 | [0m[35m                        private_key = client_credential['private_key'][0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m806 | [0m[35m                        and client_credential.get("thumbprint")):[0m
[30;1m807 | [0m[35m                    sha1_thumbprint = client_credential["thumbprint"][0m
[30;1m808 | [0m[35m                    if passphrase_bytes:[0m
[30;1m809 | [0m[35m                        private_key = _load_private_key_from_pem_str([0m
[30;1m810 | [0m[35m                            client_credential['private_key'], passphrase_bytes)[0m
[30;1m811 | [0m[35m                    else:  # PEM without passphrase[0m
[30;1m812 | [0m[35m                        private_key = client_credential['private_key'][0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m802 | [0m[35m                    if client_credential.get("public_certificate") is True and x5c:[0m
[30;1m803 | [0m[35m                        headers["x5c"] = x5c[0m
[30;1m804 | [0m[35m                elif ([0m
[30;1m805 | [0m[35m                        client_credential.get("private_key")  # PEM blob[0m
[30;1m806 | [0m[35m                        and client_credential.get("thumbprint")):[0m
[30;1m807 | [0m[35m                    sha1_thumbprint = client_credential["thumbprint"][0m
[30;1m808 | [0m[35m                    if passphrase_bytes:[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m797 | [0m[35m                    ) if client_credential.get("passphrase") else None[0m
[30;1m798 | [0m[35m                if client_credential.get("private_key_pfx_path"):[0m
[30;1m799 | [0m[35m                    private_key, sha256_thumbprint, sha1_thumbprint, x5c = _parse_pfx([0m
[30;1m800 | [0m[35m                        client_credential["private_key_pfx_path"],[0m
[30;1m801 | [0m[35m                        passphrase_bytes)[0m
[30;1m802 | [0m[35m                    if client_credential.get("public_certificate") is True and x5c:[0m
[30;1m803 | [0m[35m                        headers["x5c"] = x5c[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m796 | [0m[35m                    client_credential["passphrase"][0m
[30;1m797 | [0m[35m                    ) if client_credential.get("passphrase") else None[0m
[30;1m798 | [0m[35m                if client_credential.get("private_key_pfx_path"):[0m
[30;1m799 | [0m[35m                    private_key, sha256_thumbprint, sha1_thumbprint, x5c = _parse_pfx([0m
[30;1m800 | [0m[35m                        client_credential["private_key_pfx_path"],[0m
[30;1m801 | [0m[35m                        passphrase_bytes)[0m
[30;1m802 | [0m[35m                    if client_credential.get("public_certificate") is True and x5c:[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m795 | [0m[35m                passphrase_bytes = _str2bytes([0m
[30;1m796 | [0m[35m                    client_credential["passphrase"][0m
[30;1m797 | [0m[35m                    ) if client_credential.get("passphrase") else None[0m
[30;1m798 | [0m[35m                if client_credential.get("private_key_pfx_path"):[0m
[30;1m799 | [0m[35m                    private_key, sha256_thumbprint, sha1_thumbprint, x5c = _parse_pfx([0m
[30;1m800 | [0m[35m                        client_credential["private_key_pfx_path"],[0m
[30;1m801 | [0m[35m                        passphrase_bytes)[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m352 | [0m[35m                    {[0m
[30;1m353 | [0m[35m                        "private_key_pfx_path": "/path/to/your.pfx",[0m
[30;1m354 | [0m[35m                        "public_certificate": True,[0m
[30;1m355 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional)",[0m
[30;1m356 | [0m[35m                    }[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m        :type client_credential: Union[dict, str, None][0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m350 | [0m[35m                you can opt in for Subject Name/Issuer Auth like this::[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m                    {[0m
[30;1m353 | [0m[35m                        "private_key_pfx_path": "/path/to/your.pfx",[0m
[30;1m354 | [0m[35m                        "public_certificate": True,[0m
[30;1m355 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional)",[0m
[30;1m356 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m                The following command will generate a .pfx file from your .key and .pem file::[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m                    openssl pkcs12 -export -out certificate.pfx -inkey privateKey.key -in certificat[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m            .. admonition:: Support Subject Name/Issuer Auth with a cert in .pfx[0m
[30;1m347 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m                    {[0m
[30;1m338 | [0m[35m                        "private_key_pfx_path": "/path/to/your.pfx",[0m
[30;1m339 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional)",[0m
[30;1m340 | [0m[35m                    }[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m                The following command will generate a .pfx file from your .key and .pem file::[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m335 | [0m[35m                Feed in a dictionary containing the path to a PFX file::[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m                    {[0m
[30;1m338 | [0m[35m                        "private_key_pfx_path": "/path/to/your.pfx",[0m
[30;1m339 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional)",[0m
[30;1m340 | [0m[35m                    }[0m
[30;1m341 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m301 | [0m[35m                        "private_key": "...-----BEGIN PRIVATE KEY-----... in PEM format",[0m
[30;1m302 | [0m[35m                        "thumbprint": "A1B2C3D4E5F6...",[0m
[30;1m303 | [0m[35m                        "public_certificate": "...-----BEGIN CERTIFICATE-----...",[0m
[30;1m304 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional. Added i[0m
[30;1m305 | [0m[35m                    }[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m                ``public_certificate`` (optional) is public key certificate[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m298 | [0m[35m                *Added in version 0.5.0*::[0m
[30;1m299 | [0m[35m[0m
[30;1m300 | [0m[35m                    {[0m
[30;1m301 | [0m[35m                        "private_key": "...-----BEGIN PRIVATE KEY-----... in PEM format",[0m
[30;1m302 | [0m[35m                        "thumbprint": "A1B2C3D4E5F6...",[0m
[30;1m303 | [0m[35m                        "public_certificate": "...-----BEGIN CERTIFICATE-----...",[0m
[30;1m304 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional. Added i[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m281 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional. Added i[0m
[30;1m282 | [0m[35m                    }[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m                MSAL Python requires a "private_key" in PEM format.[0m
[30;1m285 | [0m[35m                If your cert is in PKCS12 (.pfx) format,[0m
[30;1m286 | [0m[35m                you can convert it to X.509 (.pem) format,[0m
[30;1m287 | [0m[35m                by ``openssl pkcs12 -in file.pfx -out file.pem -nodes``.[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m278 | [0m[35m                    {[0m
[30;1m279 | [0m[35m                        "private_key": "...-----BEGIN PRIVATE KEY-----... in PEM format",[0m
[30;1m280 | [0m[35m                        "thumbprint": "A1B2C3D4E5F6...",[0m
[30;1m281 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional. Added i[0m
[30;1m282 | [0m[35m                    }[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m                MSAL Python requires a "private_key" in PEM format.[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m276 | [0m[35m                Feed in a dict in this form::[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m                    {[0m
[30;1m279 | [0m[35m                        "private_key": "...-----BEGIN PRIVATE KEY-----... in PEM format",[0m
[30;1m280 | [0m[35m                        "thumbprint": "A1B2C3D4E5F6...",[0m
[30;1m281 | [0m[35m                        "passphrase": "Passphrase if the private_key is encrypted (Optional. Added i[0m
[30;1m282 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m216 | [0m[35m    """[0m
[30;1m217 | [0m[35m    ACQUIRE_TOKEN_SILENT_ID = "84"[0m
[30;1m218 | [0m[35m    ACQUIRE_TOKEN_BY_REFRESH_TOKEN = "85"[0m
[30;1m219 | [0m[35m    ACQUIRE_TOKEN_BY_USERNAME_PASSWORD_ID = "301"[0m
[30;1m220 | [0m[35m    ACQUIRE_TOKEN_ON_BEHALF_OF_ID = "523"[0m
[30;1m221 | [0m[35m    ACQUIRE_TOKEN_BY_DEVICE_FLOW_ID = "622"[0m
[30;1m222 | [0m[35m    ACQUIRE_TOKEN_FOR_CLIENT_ID = "730"[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m192 | [0m[35m        headers = kwargs.pop("headers", {})[0m
[30;1m193 | [0m[35m        headers["X-AnchorMailbox"] = "upn:{}".format(username)[0m
[30;1m194 | [0m[35m        return super(_ClientWithCcsRoutingInfo, self).obtain_token_by_username_password([0m
[30;1m195 | [0m[35m            username, password, headers=headers, **kwargs)[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35mdef _msal_extension_check():[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m191 | [0m[35m    def obtain_token_by_username_password(self, username, password, **kwargs):[0m
[30;1m192 | [0m[35m        headers = kwargs.pop("headers", {})[0m
[30;1m193 | [0m[35m        headers["X-AnchorMailbox"] = "upn:{}".format(username)[0m
[30;1m194 | [0m[35m        return super(_ClientWithCcsRoutingInfo, self).obtain_token_by_username_password([0m
[30;1m195 | [0m[35m            username, password, headers=headers, **kwargs)[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m188 | [0m[35m        return super(_ClientWithCcsRoutingInfo, self).obtain_token_by_auth_code_flow([0m
[30;1m189 | [0m[35m            auth_code_flow, auth_response, headers=headers, **kwargs)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def obtain_token_by_username_password(self, username, password, **kwargs):[0m
[30;1m192 | [0m[35m        headers = kwargs.pop("headers", {})[0m
[30;1m193 | [0m[35m        headers["X-AnchorMailbox"] = "upn:{}".format(username)[0m
[30;1m194 | [0m[35m        return super(_ClientWithCcsRoutingInfo, self).obtain_token_by_username_password([0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m188 | [0m[35m        return super(_ClientWithCcsRoutingInfo, self).obtain_token_by_auth_code_flow([0m
[30;1m189 | [0m[35m            auth_code_flow, auth_response, headers=headers, **kwargs)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def obtain_token_by_username_password(self, username, password, **kwargs):[0m
[30;1m192 | [0m[35m        headers = kwargs.pop("headers", {})[0m
[30;1m193 | [0m[35m        headers["X-AnchorMailbox"] = "upn:{}".format(username)[0m
[30;1m194 | [0m[35m        return super(_ClientWithCcsRoutingInfo, self).obtain_token_by_username_password([0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m    from cryptography.hazmat.primitives import serialization[0m
[30;1m92 | [0m[35m    from cryptography.hazmat.backends import default_backend[0m
[30;1m93 | [0m[35m    return serialization.load_pem_private_key(  # cryptography 0.6+[0m
[30;1m94 | [0m[35m        _str2bytes(private_key_pem_str),[0m
[30;1m95 | [0m[35m        passphrase_bytes,[0m
[30;1m96 | [0m[35m        backend=default_backend(),  # It was a required param until 2020[0m
[30;1m97 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35mdef _load_private_key_from_pem_str(private_key_pem_str, passphrase_bytes):[0m
[30;1m91 | [0m[35m    from cryptography.hazmat.primitives import serialization[0m
[30;1m92 | [0m[35m    from cryptography.hazmat.backends import default_backend[0m
[30;1m93 | [0m[35m    return serialization.load_pem_private_key(  # cryptography 0.6+[0m
[30;1m94 | [0m[35m        _str2bytes(private_key_pem_str),[0m
[30;1m95 | [0m[35m        passphrase_bytes,[0m
[30;1m96 | [0m[35m        backend=default_backend(),  # It was a required param until 2020[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m    return private_key, sha256_thumbprint, sha1_thumbprint, x5c[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mdef _load_private_key_from_pem_str(private_key_pem_str, passphrase_bytes):[0m
[30;1m91 | [0m[35m    from cryptography.hazmat.primitives import serialization[0m
[30;1m92 | [0m[35m    from cryptography.hazmat.backends import default_backend[0m
[30;1m93 | [0m[35m    return serialization.load_pem_private_key(  # cryptography 0.6+[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m    return private_key, sha256_thumbprint, sha1_thumbprint, x5c[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mdef _load_private_key_from_pem_str(private_key_pem_str, passphrase_bytes):[0m
[30;1m91 | [0m[35m    from cryptography.hazmat.primitives import serialization[0m
[30;1m92 | [0m[35m    from cryptography.hazmat.backends import default_backend[0m
[30;1m93 | [0m[35m    return serialization.load_pem_private_key(  # cryptography 0.6+[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m    sha256_thumbprint = cert.fingerprint(hashes.SHA256()).hex()  # cryptography 0.7+[0m
[30;1m85 | [0m[35m    sha1_thumbprint = cert.fingerprint(hashes.SHA1()).hex()  # cryptography 0.7+[0m
[30;1m86 | [0m[35m        # https://cryptography.io/en/latest/x509/reference/#x-509-certificate-object[0m
[30;1m87 | [0m[35m    return private_key, sha256_thumbprint, sha1_thumbprint, x5c[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mdef _load_private_key_from_pem_str(private_key_pem_str, passphrase_bytes):[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m        private_key, cert, _ = pkcs12.load_key_and_certificates(  # cryptography 2.5+[0m
[30;1m76 | [0m[35m            # https://cryptography.io/en/latest/hazmat/primitives/asymmetric/serialization/#cryptogr[0m
[30;1m77 | [0m[35m            f.read(), passphrase_bytes)[0m
[30;1m78 | [0m[35m    if not (private_key and cert):[0m
[30;1m79 | [0m[35m        raise ValueError("Your PFX file shall contain both private key and cert")[0m
[30;1m80 | [0m[35m    cert_pem = cert.public_bytes(encoding=serialization.Encoding.PEM).decode()  # cryptography 1.0+[0m
[30;1m81 | [0m[35m    x5c = [[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m72 | [0m[35m    from cryptography.hazmat.primitives import hashes, serialization[0m
[30;1m73 | [0m[35m    from cryptography.hazmat.primitives.serialization import pkcs12[0m
[30;1m74 | [0m[35m    with open(pfx_path, 'rb') as f:[0m
[30;1m75 | [0m[35m        private_key, cert, _ = pkcs12.load_key_and_certificates(  # cryptography 2.5+[0m
[30;1m76 | [0m[35m            # https://cryptography.io/en/latest/hazmat/primitives/asymmetric/serialization/#cryptogr[0m
[30;1m77 | [0m[35m            f.read(), passphrase_bytes)[0m
[30;1m78 | [0m[35m    if not (private_key and cert):[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2403 | [0m[35m    def remove_tokens_for_client(self):[0m
[30;1m2404 | [0m[35m        """Remove all tokens that were previously acquired via[0m
[30;1m2405 | [0m[35m        :func:`~acquire_token_for_client()` for the current client."""[0m
[30;1m2406 | [0m[35m        for env in [self.authority.instance] + self._get_authority_aliases([0m
[30;1m2407 | [0m[35m                self.authority.instance):[0m
[30;1m2408 | [0m[35m            for at in list(self.token_cache.search(  # Remove ATs from a snapshot[0m
[30;1m2409 | [0m[35m                TokenCache.CredentialType.ACCESS_TOKEN, query={[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1908 | [0m[35m            wstrust_result["token"], grant_type, scope=scopes,[0m
[30;1m1909 | [0m[35m            on_obtaining_tokens=lambda event: self.token_cache.add(dict([0m
[30;1m1910 | [0m[35m                event,[0m
[30;1m1911 | [0m[35m                environment=self.authority.instance,[0m
[30;1m1912 | [0m[35m                username=username,  # Useful in case IDT contains no such info[0m
[30;1m1913 | [0m[35m                )),[0m
[30;1m1914 | [0m[35m            **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1718 | [0m[35m                    # the RT could still be useful for other MFA-less scope or tenant[0m
[30;1m1719 | [0m[35m                on_obtaining_tokens=lambda event: self.token_cache.add(dict([0m
[30;1m1720 | [0m[35m                    event,[0m
[30;1m1721 | [0m[35m                    environment=authority.instance,[0m
[30;1m1722 | [0m[35m                    skip_account_creation=True,  # To honor a concurrent remove_account()[0m
[30;1m1723 | [0m[35m                    )),[0m
[30;1m1724 | [0m[35m                scope=scopes,[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1639 | [0m[35m    def _acquire_token_silent_by_finding_rt_belongs_to_me_or_my_family([0m
[30;1m1640 | [0m[35m            self, authority, scopes, account, **kwargs):[0m
[30;1m1641 | [0m[35m        query = {[0m
[30;1m1642 | [0m[35m            "environment": authority.instance,[0m
[30;1m1643 | [0m[35m            "home_account_id": (account or {}).get("home_account_id"),[0m
[30;1m1644 | [0m[35m            # "realm": authority.tenant,  # AAD RTs are tenant-independent[0m
[30;1m1645 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1630 | [0m[35m                response=response,[0m
[30;1m1631 | [0m[35m                data=data,[0m
[30;1m1632 | [0m[35m                _account_id=response["_account_id"],[0m
[30;1m1633 | [0m[35m                environment=self.authority.instance,  # Be consistent with non-broker flows[0m
[30;1m1634 | [0m[35m                grant_type=_GRANT_TYPE_BROKER,  # A pseudo grant type for TokenCache to mark account[0m
[30;1m1635 | [0m[35m                ))[0m
[30;1m1636 | [0m[35m            response[self._TOKEN_SOURCE] = self._TOKEN_SOURCE_BROKER[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1528 | [0m[35m        if not (force_refresh or claims_challenge or auth_scheme):  # Then attempt AT cache[0m
[30;1m1529 | [0m[35m            query={[0m
[30;1m1530 | [0m[35m                    "client_id": self.client_id,[0m
[30;1m1531 | [0m[35m                    "environment": authority.instance,[0m
[30;1m1532 | [0m[35m                    "realm": authority.tenant,[0m
[30;1m1533 | [0m[35m                    "home_account_id": (account or {}).get("home_account_id"),[0m
[30;1m1534 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1252 | [0m[35m            a.get("home_account_id"):  # Grouped by home tenant's id[0m
[30;1m1253 | [0m[35m                {  # These are minimal amount of non-tenant-specific account info[0m
[30;1m1254 | [0m[35m                    "home_account_id": a.get("home_account_id"),[0m
[30;1m1255 | [0m[35m                    "environment": a.get("environment"),[0m
[30;1m1256 | [0m[35m                    "username": a.get("username"),[0m
[30;1m1257 | [0m[35m                    "account_source": a.get("account_source"),[0m
[30;1m1258 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1218 | [0m[35m            Your app can choose to display those information to end user,[0m
[30;1m1219 | [0m[35m            and allow user to choose one of his/her accounts to proceed.[0m
[30;1m1220 | [0m[35m        """[0m
[30;1m1221 | [0m[35m        accounts = self._find_msal_accounts(environment=self.authority.instance)[0m
[30;1m1222 | [0m[35m        if not accounts:  # Now try other aliases of this authority instance[0m
[30;1m1223 | [0m[35m            for alias in self._get_authority_aliases(self.authority.instance):[0m
[30;1m1224 | [0m[35m                accounts = self._find_msal_accounts(environment=alias)[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m873 | [0m[35m                    client_assertion=client_assertion,[0m
[30;1m874 | [0m[35m                    client_assertion_type=client_assertion_type,[0m
[30;1m875 | [0m[35m                    on_obtaining_tokens=lambda event: self.token_cache.add(dict([0m
[30;1m876 | [0m[35m                        event, environment=authority.instance)),[0m
[30;1m877 | [0m[35m                    on_removing_rt=self.token_cache.remove_rt,[0m
[30;1m878 | [0m[35m                    on_updating_rt=self.token_cache.update_rt)[0m
[30;1m879 | [0m[35m        return central_client, regional_client[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m849 | [0m[35m            client_assertion=client_assertion,[0m
[30;1m850 | [0m[35m            client_assertion_type=client_assertion_type,[0m
[30;1m851 | [0m[35m            on_obtaining_tokens=lambda event: self.token_cache.add(dict([0m
[30;1m852 | [0m[35m                event, environment=authority.instance)),[0m
[30;1m853 | [0m[35m            on_removing_rt=self.token_cache.remove_rt,[0m
[30;1m854 | [0m[35m            on_updating_rt=self.token_cache.update_rt)[0m
[30;1m855 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m134 | [0m[35m        # /opt/microsoft/msedge/msedge or /opt/microsoft/msedge-beta/msedge.[0m
[30;1m135 | [0m[35m        # Either method can be used to detect an Edge installation.[0m
[30;1m136 | [0m[35m    user_has_no_preference = "BROWSER" not in os.environ[0m
[30;1m137 | [0m[35m    user_wont_mind_edge = "microsoft-edge" in os.environ.get("BROWSER", "")  # Note:[0m
[30;1m138 | [0m[35m        # BROWSER could contain "microsoft-edge" or "/path/to/microsoft-edge".[0m
[30;1m139 | [0m[35m        # Python documentation (https://docs.python.org/3/library/webbrowser.html)[0m
[30;1m140 | [0m[35m        # does not document the name being implicitly register,[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m110 | [0m[35m                }[0m
[30;1m111 | [0m[35m        except ValueError:[0m
[30;1m112 | [0m[35m            logger.debug("Unable to decode jwt payload: %s", parts[1])[0m
[30;1m113 | [0m[35m    oauth2_response["client_info"] = base64.b64encode([0m
[30;1m114 | [0m[35m        # Mimic a client_info, so that MSAL would create an account[0m
[30;1m115 | [0m[35m        json.dumps(client_info).encode("utf-8")).decode("utf-8")[0m
[30;1m116 | [0m[35m    oauth2_response["id_token_claims"]["tid"] = client_info["utid"]  # TBD[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m4 | [0m[35m# This code is licensed under the MIT License.[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m"""This module wraps Cloud Shell's IMDS-like interface inside an OAuth2-like helper"""[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport logging[0m
[30;1m10 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mdef _is_running_in_cloud_shell():[0m
[30;1m23 | [0m[35m    return os.environ.get("AZUREPS_HOST_ENVIRONMENT", "").startswith("cloud-shell")[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef _scope_to_resource(scope):  # This is an experimental reasonable-effort approach[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m194 | [0m[35m                # FWIW, AAD's browser interactive flow would honor select_account[0m
[30;1m195 | [0m[35m                # and ignore login_hint in such a case.[0m
[30;1m196 | [0m[35m                # But pymsalruntime 0.3.x would pop up a meaningless account picker[0m
[30;1m197 | [0m[35m                # and then force the account_hint user to re-input password. Not what we want.[0m
[30;1m198 | [0m[35m                # https://identitydivision.visualstudio.com/Engineering/_workitems/edit/1744492[0m
[30;1m199 | [0m[35m                login_hint = None  # Mimicing the AAD behavior[0m
[30;1m200 | [0m[35m                logger.warning("Using both select_account and login_hint is ambiguous. Ignoring logi[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m    def get_wstrust_username_password_endpoint(self):[0m
[30;1m130 | [0m[35m        """Returns {"address": "https://...", "action": "the soapAction value"}"""[0m
[30;1m131 | [0m[35m        endpoints = self._get_endpoints([0m
[30;1m132 | [0m[35m                self._get_bindings(), self._get_username_password_policy_ids())[0m
[30;1m133 | [0m[35m        for e in endpoints:[0m
[30;1m134 | [0m[35m            if e["action"] == self.ACTION_13:[0m
[30;1m135 | [0m[35m                return e  # Historically, we prefer ACTION_13 a.k.a. WsTrust13[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m                        {"address": address.text, "action": binding["action"]})[0m
[30;1m127 | [0m[35m        return endpoints[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    def get_wstrust_username_password_endpoint(self):[0m
[30;1m130 | [0m[35m        """Returns {"address": "https://...", "action": "the soapAction value"}"""[0m
[30;1m131 | [0m[35m        endpoints = self._get_endpoints([0m
[30;1m132 | [0m[35m                self._get_bindings(), self._get_username_password_policy_ids())[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m            # If we did not find any binding, this is potentially bad.[0m
[30;1m86 | [0m[35m            if policy.find(binding_xpath, self.NS) is not None])[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    def _get_username_password_policy_ids(self):[0m
[30;1m89 | [0m[35m        path = ['wsp:Policy', 'wsp:ExactlyOne', 'wsp:All',[0m
[30;1m90 | [0m[35m            'sp:SignedEncryptedSupportingTokens', 'wsp:Policy',[0m
[30;1m91 | [0m[35m            'sp:UsernameToken', 'wsp:Policy', 'sp:WssUsernameToken10'][0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m    mex_resp = http_client.get(mex_endpoint, **kwargs)[0m
[30;1m48 | [0m[35m    mex_resp.raise_for_status()[0m
[30;1m49 | [0m[35m    try:[0m
[30;1m50 | [0m[35m        return Mex(mex_resp.text).get_wstrust_username_password_endpoint()[0m
[30;1m51 | [0m[35m    except ET.ParseError:[0m
[30;1m52 | [0m[35m        logger.exception([0m
[30;1m53 | [0m[35m            "Malformed MEX document: %s, %s", mex_resp.status_code, mex_resp.text)[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m297 | [0m[35m                    # "client_info": response.get("client_info"),  # Optional[0m
[30;1m298 | [0m[35m                    }[0m
[30;1m299 | [0m[35m                grant_types_that_establish_an_account = ([0m
[30;1m300 | [0m[35m                    _GRANT_TYPE_BROKER, "authorization_code", "password",[0m
[30;1m301 | [0m[35m                    Client.DEVICE_FLOW["GRANT_TYPE"])[0m
[30;1m302 | [0m[35m                if event.get("grant_type") in grant_types_that_establish_an_account:[0m
[30;1m303 | [0m[35m                    account["account_source"] = event["grant_type"][0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m269 | [0m[35m                    }[0m
[30;1m270 | [0m[35m                at.update({k: data[k] for k in data if k in {[0m
[30;1m271 | [0m[35m                    # Also store extra data which we explicitly allow[0m
[30;1m272 | [0m[35m                    # So that we won't accidentally store a user's password etc.[0m
[30;1m273 | [0m[35m                    "key_id",  # It happens in SSH-cert or POP scenario[0m
[30;1m274 | [0m[35m                }})[0m
[30;1m275 | [0m[35m                if "refresh_in" in response:[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m194 | [0m[35m        clean_event = dict([0m
[30;1m195 | [0m[35m            event,[0m
[30;1m196 | [0m[35m            data=make_clean_copy(event.get("data", {}), ([0m
[30;1m197 | [0m[35m                "password", "client_secret", "refresh_token", "assertion",[0m
[30;1m198 | [0m[35m            )),[0m
[30;1m199 | [0m[35m            response=make_clean_copy(event.get("response", {}), ([0m
[30;1m200 | [0m[35m                "id_token_claims",  # Provided by broker[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def _get_access_token([0m
[30;1m99 | [0m[35m        self,[0m
[30;1m100 | [0m[35m        home_account_id, environment, client_id, realm, target,  # Together they form a compound key[0m
[30;1m101 | [0m[35m        default=None,[0m
[30;1m102 | [0m[35m    ):  # O(1)[0m
[30;1m103 | [0m[35m        return self._get([0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m133 | [0m[35m        "username/password missing")[0m
[30;1m134 | [0m[35m    def test_username_password(self):[0m
[30;1m135 | [0m[35m        result = self.client.obtain_token_by_username_password([0m
[30;1m136 | [0m[35m            CONFIG["username"], CONFIG["password"],[0m
[30;1m137 | [0m[35m            data={"resource": CONFIG.get("resource")},  # MSFT AAD V1 only[0m
[30;1m138 | [0m[35m            scope=CONFIG.get("scope"))[0m
[30;1m139 | [0m[35m        self.assertLoosely(result)[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m132 | [0m[35m        not ("username" in CONFIG and "password" in CONFIG),[0m
[30;1m133 | [0m[35m        "username/password missing")[0m
[30;1m134 | [0m[35m    def test_username_password(self):[0m
[30;1m135 | [0m[35m        result = self.client.obtain_token_by_username_password([0m
[30;1m136 | [0m[35m            CONFIG["username"], CONFIG["password"],[0m
[30;1m137 | [0m[35m            data={"resource": CONFIG.get("resource")},  # MSFT AAD V1 only[0m
[30;1m138 | [0m[35m            scope=CONFIG.get("scope"))[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m    @unittest.skipIf([0m
[30;1m132 | [0m[35m        not ("username" in CONFIG and "password" in CONFIG),[0m
[30;1m133 | [0m[35m        "username/password missing")[0m
[30;1m134 | [0m[35m    def test_username_password(self):[0m
[30;1m135 | [0m[35m        result = self.client.obtain_token_by_username_password([0m
[30;1m136 | [0m[35m            CONFIG["username"], CONFIG["password"],[0m
[30;1m137 | [0m[35m            data={"resource": CONFIG.get("resource")},  # MSFT AAD V1 only[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m130 | [0m[35m        "token_endpoint missing")[0m
[30;1m131 | [0m[35m    @unittest.skipIf([0m
[30;1m132 | [0m[35m        not ("username" in CONFIG and "password" in CONFIG),[0m
[30;1m133 | [0m[35m        "username/password missing")[0m
[30;1m134 | [0m[35m    def test_username_password(self):[0m
[30;1m135 | [0m[35m        result = self.client.obtain_token_by_username_password([0m
[30;1m136 | [0m[35m            CONFIG["username"], CONFIG["password"],[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        "token_endpoint" not in CONFIG.get("openid_configuration", {}),[0m
[30;1m130 | [0m[35m        "token_endpoint missing")[0m
[30;1m131 | [0m[35m    @unittest.skipIf([0m
[30;1m132 | [0m[35m        not ("username" in CONFIG and "password" in CONFIG),[0m
[30;1m133 | [0m[35m        "username/password missing")[0m
[30;1m134 | [0m[35m    def test_username_password(self):[0m
[30;1m135 | [0m[35m        result = self.client.obtain_token_by_username_password([0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m                CONFIG['client_id'],[0m
[30;1m103 | [0m[35m                http_client=http_client,[0m
[30;1m104 | [0m[35m                client_assertion=JwtSigner([0m
[30;1m105 | [0m[35m                        private_key,[0m
[30;1m106 | [0m[35m                        algorithm="RS256",[0m
[30;1m107 | [0m[35m                        sha1_thumbprint=CONFIG["client_certificate"]["thumbprint"][0m
[30;1m108 | [0m[35m                    ).sign_assertion([0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m        elif "client_certificate" in CONFIG:[0m
[30;1m97 | [0m[35m            private_key_path = CONFIG["client_certificate"]["private_key_path"][0m
[30;1m98 | [0m[35m            with open(os.path.join(THIS_FOLDER, private_key_path)) as f:[0m
[30;1m99 | [0m[35m                private_key = f.read()  # Expecting PEM format[0m
[30;1m100 | [0m[35m            cls.client = Client([0m
[30;1m101 | [0m[35m                CONFIG["openid_configuration"],[0m
[30;1m102 | [0m[35m                CONFIG['client_id'],[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m                )[0m
[30;1m96 | [0m[35m        elif "client_certificate" in CONFIG:[0m
[30;1m97 | [0m[35m            private_key_path = CONFIG["client_certificate"]["private_key_path"][0m
[30;1m98 | [0m[35m            with open(os.path.join(THIS_FOLDER, private_key_path)) as f:[0m
[30;1m99 | [0m[35m                private_key = f.read()  # Expecting PEM format[0m
[30;1m100 | [0m[35m            cls.client = Client([0m
[30;1m101 | [0m[35m                CONFIG["openid_configuration"],[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m                client_assertion_type=Client.CLIENT_ASSERTION_TYPE_JWT,[0m
[30;1m95 | [0m[35m                )[0m
[30;1m96 | [0m[35m        elif "client_certificate" in CONFIG:[0m
[30;1m97 | [0m[35m            private_key_path = CONFIG["client_certificate"]["private_key_path"][0m
[30;1m98 | [0m[35m            with open(os.path.join(THIS_FOLDER, private_key_path)) as f:[0m
[30;1m99 | [0m[35m                private_key = f.read()  # Expecting PEM format[0m
[30;1m100 | [0m[35m            cls.client = Client([0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m                client_assertion_type=Client.CLIENT_ASSERTION_TYPE_JWT,[0m
[30;1m95 | [0m[35m                )[0m
[30;1m96 | [0m[35m        elif "client_certificate" in CONFIG:[0m
[30;1m97 | [0m[35m            private_key_path = CONFIG["client_certificate"]["private_key_path"][0m
[30;1m98 | [0m[35m            with open(os.path.join(THIS_FOLDER, private_key_path)) as f:[0m
[30;1m99 | [0m[35m                private_key = f.read()  # Expecting PEM format[0m
[30;1m100 | [0m[35m            cls.client = Client([0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        "oidp": "https://example.com/tenant/",[0m
[30;1m42 | [0m[35m        "username": "you@example.com",[0m
[30;1m43 | [0m[35m        "password": "I could tell you but then I would have to kill you",[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        "placeholder": null[0m
[30;1m46 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/msal-1.32.0/tests/test_account_source.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def test_ropc_flow_and_its_silent_call_should_invoke_broker(self, _, mocked_broker_ats):[0m
[30;1m56 | [0m[35m        with patch("msal.broker._signin_silently", return_value=dict(TOKEN_RESPONSE, _account_id="pl[0m
[30;1m57 | [0m[35m            result = self.app.acquire_token_by_username_password([0m
[30;1m58 | [0m[35m                "username", "placeholder", [SCOPE], post=_mock_post)[0m
[30;1m59 | [0m[35m        self.assertEqual(result["token_source"], "broker")[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m963 | [0m[35m        with open("tests/sp_obo.pem") as pem:[0m
[30;1m964 | [0m[35m            client_secret = {[0m
[30;1m965 | [0m[35m                "private_key": pem.read(),[0m
[30;1m966 | [0m[35m                "thumbprint": "378938210C976692D7F523B8C4FFBB645D17CE92",[0m
[30;1m967 | [0m[35m                }[0m
[30;1m968 | [0m[35m        midtier_app = {[0m
[30;1m969 | [0m[35m            "authority": authority,[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m23 | [0m[35m                "state": state,[0m
[30;1m24 | [0m[35m                "code": "bar",[0m
[30;1m25 | [0m[35m                "client_info":  # MSAL asks for client_info, so it would be available[0m
[30;1m26 | [0m[35m                    "eyJ1aWQiOiJhYTkwNTk0OS1hMmI4LTRlMGEtOGFlYS1iMzJlNTNjY2RiNDEiLCJ1dGlkIjoiNzJmOTg[0m
[30;1m27 | [0m[35m                })[0m
[30;1m28 | [0m[35m            self.assertEqual([0m
[30;1m29 | [0m[35m                "Oid:aa905949-a2b8-4e0a-8aea-b32e53ccdb41@72f988bf-86f1-41af-91ab-2d7cd011db47",[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mlatest_cryptography_version = ET.fromstring([0m
[30;1m15 | [0m[35m    requests.get("https://pypi.org/rss/project/cryptography/releases.xml").text[0m
[30;1m16 | [0m[35m    ).findall("./channel/item/title")[0].text[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m            with open(sibling("certificate-with-password.pem")) as f:[0m
[30;1m48 | [0m[35m                _load_private_key_from_pem_str(f.read(), passphrase_bytes)[0m
[30;1m49 | [0m[35m            pfx = sibling("certificate-with-password.pfx")  # Created by:[0m
[30;1m50 | [0m[35m                # openssl pkcs12 -export -inkey test/certificate-with-password.pem -in tests/certifi[0m
[30;1m51 | [0m[35m            _parse_pfx(pfx, passphrase_bytes)[0m
[30;1m52 | [0m[35m            self.assertEqual(0, len(encountered_warnings),[0m
[30;1m53 | [0m[35m                "Did cryptography deprecate the functions that we used?")[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_cryptography.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m            match = re.search(r"<(\d+)", line)[0m
[30;1m25 | [0m[35m            if match:[0m
[30;1m26 | [0m[35m                return int(match.group(1))[0m
[30;1m27 | [0m[35m    raise RuntimeError("Unable to find cryptography info from setup.cfg")[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef sibling(filename):[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m   else:[0m
[30;1m97 | [0m[35m       print(result.get("error"))[0m
[30;1m98 | [0m[35m       print(result.get("error_description"))[0m
[30;1m99 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m100 | [0m[35m   ```[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35mRefer the [Wiki](https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki) pages [0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m       print(result["access_token"])  # Yay![0m
[30;1m96 | [0m[35m   else:[0m
[30;1m97 | [0m[35m       print(result.get("error"))[0m
[30;1m98 | [0m[35m       print(result.get("error_description"))[0m
[30;1m99 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m100 | [0m[35m   ```[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m   if "access_token" in result:[0m
[30;1m95 | [0m[35m       print(result["access_token"])  # Yay![0m
[30;1m96 | [0m[35m   else:[0m
[30;1m97 | [0m[35m       print(result.get("error"))[0m
[30;1m98 | [0m[35m       print(result.get("error_description"))[0m
[30;1m99 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m100 | [0m[35m   ```[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mst Q&A on Stack Overflow for MSAL:[0m
[30;1m  | [0m[35m[http://stackoverflow.com/questions/tagged/msal](http://stackoverflow.com/questions/tagged/msal)[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m## Submit Feedback[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mWe'd like your thoughts on this library. Please complete [this short survey.](https://forms.office.c[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m## Security Reporting[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m   ```[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m3. Either there is no suitable token in the cache, or you chose to skip the previous step,[0m
[30;1m87 | [0m[35m   now it is time to actually send a request to AAD to obtain a token.[0m
[30;1m88 | [0m[35m   There are different methods based on your client type and scenario. Here we demonstrate a placeho[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m   ```python[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m           print(a["username"])[0m
[30;1m80 | [0m[35m       # Assuming the end user chose this one[0m
[30;1m81 | [0m[35m       chosen = accounts[0][0m
[30;1m82 | [0m[35m       # Now let's try to find a token in cache for this account[0m
[30;1m83 | [0m[35m       result = app.acquire_token_silent(["your_scope"], account=chosen)[0m
[30;1m84 | [0m[35m   ```[0m
[30;1m85 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m       authority="https://login.microsoftonline.com/Enter_the_Tenant_Name_Here")[0m
[30;1m60 | [0m[35m   ```[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m   Later, each time you would want an access token, you start by:[0m
[30;1m63 | [0m[35m   ```python[0m
[30;1m64 | [0m[35m   result = None  # It is just an initial value. Please follow instructions below.[0m
[30;1m65 | [0m[35m   ```[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mThis library follows [Semantic Versioning](http://semver.org/).[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mYou can find the changes for each version under[0m
[30;1m36 | [0m[35m[Releases](https://github.com/AzureAD/microsoft-authentication-library-for-python/releases).[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m## Usage[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35mYou can find MSAL Python on [Pypi](https://pypi.org/project/msal/).[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m1. If you haven't already, [install and/or upgrade the pip](https://pip.pypa.io/en/stable/installing[0m
[30;1m28 | [0m[35m   of your Python environment to a recent version. We tested with pip 18.1.[0m
[30;1m29 | [0m[35m1. As usual, just run `pip install msal`.[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m## Versions[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m## Installation[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mYou can find MSAL Python on [Pypi](https://pypi.org/project/msal/).[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m1. If you haven't already, [install and/or upgrade the pip](https://pip.pypa.io/en/stable/installing[0m
[30;1m28 | [0m[35m   of your Python environment to a recent version. We tested with pip 18.1.[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m## Migrating from ADAL[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35mIf your application is using ADAL Python, we recommend you to update to use MSAL Python. No new feat[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mSee the [ADAL to MSAL migration](https://github.com/AzureAD/microsoft-authentication-library-for-pyt[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m   result = None  # It is just an initial value. Please follow instructions below.[0m
[30;1m65 | [0m[35m   ```[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m2. The API model in MSAL provides you explicit control on how to utilize token cache.[0m
[30;1m68 | [0m[35m   This cache part is technically optional, but we highly recommend you to harness the power of MSAL[0m
[30;1m69 | [0m[35m   It will automatically handle the token refresh for you.[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/setup.cfg[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m	Changelog = https://github.com/AzureAD/microsoft-authentication-library-for-python/releases[0m
[30;1m29 | [0m[35m	Documentation = https://msal-python.readthedocs.io/[0m
[30;1m30 | [0m[35m	Questions = https://stackoverflow.com/questions/tagged/azure-ad-msal+python[0m
[30;1m31 | [0m[35m	Feature/Bug Tracker = https://github.com/AzureAD/microsoft-authentication-library-for-python/issues[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m[options][0m
[30;1m34 | [0m[35minclude_package_data = False  # We used to ship LICENSE, but our __init__.py already mentions MIT[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m159 | [0m[35m        resp1 = http_client.post([0m
[30;1m160 | [0m[35m            "https://example.com", data={"grant_type": DEVICE_AUTH_GRANT})[0m
[30;1m161 | [0m[35m        resp2 = http_client.post([0m
[30;1m162 | [0m[35m            "https://example.com", data={"grant_type": DEVICE_AUTH_GRANT})[0m
[30;1m163 | [0m[35m        logger.debug(http_cache)[0m
[30;1m164 | [0m[35m        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        http_cache = {}[0m
[30;1m157 | [0m[35m        http_client = DummyHttpClient(status_code=400)[0m
[30;1m158 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m159 | [0m[35m        resp1 = http_client.post([0m
[30;1m160 | [0m[35m            "https://example.com", data={"grant_type": DEVICE_AUTH_GRANT})[0m
[30;1m161 | [0m[35m        resp2 = http_client.post([0m
[30;1m162 | [0m[35m            "https://example.com", data={"grant_type": DEVICE_AUTH_GRANT})[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m            status_code=200)  # It covers UserRealm discovery and OIDC discovery[0m
[30;1m148 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m149 | [0m[35m        resp1 = http_client.get("https://example.com?foo=bar")[0m
[30;1m150 | [0m[35m        resp2 = http_client.get("https://example.com?foo=bar")[0m
[30;1m151 | [0m[35m        logger.debug(http_cache)[0m
[30;1m152 | [0m[35m        self.assertEqual(resp1.text, resp2.text, "Should return a cached response")[0m
[30;1m153 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m        http_client = DummyHttpClient([0m
[30;1m147 | [0m[35m            status_code=200)  # It covers UserRealm discovery and OIDC discovery[0m
[30;1m148 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m149 | [0m[35m        resp1 = http_client.get("https://example.com?foo=bar")[0m
[30;1m150 | [0m[35m        resp2 = http_client.get("https://example.com?foo=bar")[0m
[30;1m151 | [0m[35m        logger.debug(http_cache)[0m
[30;1m152 | [0m[35m        self.assertEqual(resp1.text, resp2.text, "Should return a cached response")[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        self.assertEqual(resp1.text, resp1_again.text, "Should return a cached response")[0m
[30;1m119 | [0m[35m        resp2 = http_client.post("https://example.com", data={"claims": "bar"})[0m
[30;1m120 | [0m[35m        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")[0m
[30;1m121 | [0m[35m        resp2_again = http_client.post("https://example.com", data={"claims": "bar"})[0m
[30;1m122 | [0m[35m        self.assertEqual(resp2.text, resp2_again.text, "Should return a cached response")[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def test_one_foci_app_recovering_from_invalid_grant_should_also_unblock_another(self):[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        logger.debug(http_cache)[0m
[30;1m117 | [0m[35m        resp1_again = http_client.post("https://example.com", data={"claims": "foo"})[0m
[30;1m118 | [0m[35m        self.assertEqual(resp1.text, resp1_again.text, "Should return a cached response")[0m
[30;1m119 | [0m[35m        resp2 = http_client.post("https://example.com", data={"claims": "bar"})[0m
[30;1m120 | [0m[35m        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")[0m
[30;1m121 | [0m[35m        resp2_again = http_client.post("https://example.com", data={"claims": "bar"})[0m
[30;1m122 | [0m[35m        self.assertEqual(resp2.text, resp2_again.text, "Should return a cached response")[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m115 | [0m[35m        resp1 = http_client.post("https://example.com", data={"claims": "foo"})[0m
[30;1m116 | [0m[35m        logger.debug(http_cache)[0m
[30;1m117 | [0m[35m        resp1_again = http_client.post("https://example.com", data={"claims": "foo"})[0m
[30;1m118 | [0m[35m        self.assertEqual(resp1.text, resp1_again.text, "Should return a cached response")[0m
[30;1m119 | [0m[35m        resp2 = http_client.post("https://example.com", data={"claims": "bar"})[0m
[30;1m120 | [0m[35m        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        http_client = DummyHttpClient([0m
[30;1m113 | [0m[35m            status_code=400)  # It covers invalid_grant and interaction_required[0m
[30;1m114 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m115 | [0m[35m        resp1 = http_client.post("https://example.com", data={"claims": "foo"})[0m
[30;1m116 | [0m[35m        logger.debug(http_cache)[0m
[30;1m117 | [0m[35m        resp1_again = http_client.post("https://example.com", data={"claims": "foo"})[0m
[30;1m118 | [0m[35m        self.assertEqual(resp1.text, resp1_again.text, "Should return a cached response")[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m            status_code=429, response_headers={"Retry-After": 2})[0m
[30;1m104 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m105 | [0m[35m        resp1 = http_client.post("https://example.com", data={"scope": "one"})[0m
[30;1m106 | [0m[35m        resp2 = http_client.post("https://example.com", data={"scope": "two"})[0m
[30;1m107 | [0m[35m        logger.debug(http_cache)[0m
[30;1m108 | [0m[35m        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m        http_client = DummyHttpClient([0m
[30;1m103 | [0m[35m            status_code=429, response_headers={"Retry-After": 2})[0m
[30;1m104 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m105 | [0m[35m        resp1 = http_client.post("https://example.com", data={"scope": "one"})[0m
[30;1m106 | [0m[35m        resp2 = http_client.post("https://example.com", data={"scope": "two"})[0m
[30;1m107 | [0m[35m        logger.debug(http_cache)[0m
[30;1m108 | [0m[35m        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m93 | [0m[35m        resp1 = http_client.post("https://example.com", data={[0m
[30;1m94 | [0m[35m            "scope": "one", "claims": "bar", "grant_type": "authorization_code"})[0m
[30;1m95 | [0m[35m        resp2 = http_client.post("https://example.com", data={[0m
[30;1m96 | [0m[35m            "scope": "one", "claims": "foo", "grant_type": "password"})[0m
[30;1m97 | [0m[35m        logger.debug(http_cache)[0m
[30;1m98 | [0m[35m        self.assertEqual(resp1.text, resp2.text, "Should return a cached response")[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m        http_client = DummyHttpClient([0m
[30;1m91 | [0m[35m            status_code=429, response_headers={"Retry-After": 2})[0m
[30;1m92 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m93 | [0m[35m        resp1 = http_client.post("https://example.com", data={[0m
[30;1m94 | [0m[35m            "scope": "one", "claims": "bar", "grant_type": "authorization_code"})[0m
[30;1m95 | [0m[35m        resp2 = http_client.post("https://example.com", data={[0m
[30;1m96 | [0m[35m            "scope": "one", "claims": "foo", "grant_type": "password"})[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        logger.debug(http_cache)[0m
[30;1m60 | [0m[35m        self.assertEqual(resp1.text, resp2.text, "Should return a cached response")[0m
[30;1m61 | [0m[35m        sleep(retry_after + 1)[0m
[30;1m62 | [0m[35m        resp3 = http_client.post("https://example.com")  # We implemented POST only[0m
[30;1m63 | [0m[35m        self.assertNotEqual(resp1.text, resp3.text, "Should return a new response")[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    def test_429_with_RetryAfter_N_seconds_should_keep_entry_for_N_seconds(self):[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        http_cache = {}[0m
[30;1m56 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m57 | [0m[35m        resp1 = http_client.post("https://example.com")  # We implemented POST only[0m
[30;1m58 | [0m[35m        resp2 = http_client.post("https://example.com")  # We implemented POST only[0m
[30;1m59 | [0m[35m        logger.debug(http_cache)[0m
[30;1m60 | [0m[35m        self.assertEqual(resp1.text, resp2.text, "Should return a cached response")[0m
[30;1m61 | [0m[35m        sleep(retry_after + 1)[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m            self, http_client, retry_after):[0m
[30;1m55 | [0m[35m        http_cache = {}[0m
[30;1m56 | [0m[35m        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)[0m
[30;1m57 | [0m[35m        resp1 = http_client.post("https://example.com")  # We implemented POST only[0m
[30;1m58 | [0m[35m        resp2 = http_client.post("https://example.com")  # We implemented POST only[0m
[30;1m59 | [0m[35m        logger.debug(http_cache)[0m
[30;1m60 | [0m[35m        self.assertEqual(resp1.text, resp2.text, "Should return a cached response")[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_throttled_http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Test cases for https://identitydivision.visualstudio.com/devex/_git/AuthLibrariesApiReview?version[0m
[30;1m2 | [0m[35mfrom time import sleep[0m
[30;1m3 | [0m[35mfrom random import random[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mfrom msal.throttled_http_client import ThrottledHttpClient[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/region.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m        'azure_region=is_deployed_in_azure)"'.format(url))[0m
[30;1m36 | [0m[35m    try:[0m
[30;1m37 | [0m[35m        # https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service?[0m
[30;1m38 | [0m[35m        resp = http_client.get(url, headers={"Metadata": "true"})[0m
[30;1m39 | [0m[35m    except:[0m
[30;1m40 | [0m[35m        logger.info([0m
[30;1m41 | [0m[35m            "IMDS {} unavailable. Perhaps not running in Azure VM?".format(url))[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/region.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mdef _detect_region(http_client=None):[0m
[30;1m8 | [0m[35m    region = os.environ.get("REGION_NAME", "").replace(" ", "").lower()  # e.g. westus2[0m
[30;1m9 | [0m[35m    if region:[0m
[30;1m10 | [0m[35m        return region[0m
[30;1m11 | [0m[35m    if http_client:[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1392 | [0m[35m                nonce=self._extract_pop_nonce(resp.headers.get("WWW-Authenticate")),[0m
[30;1m1393 | [0m[35m                ),[0m
[30;1m1394 | [0m[35m            ))[0m
[30;1m1395 | [0m[35m        resp = requests.get([0m
[30;1m1396 | [0m[35m            api_endpoint,[0m
[30;1m1397 | [0m[35m            # CodeQL [SM03157][0m
[30;1m1398 | [0m[35m            verify=verify,  # @suppress py/bandit/requests-ssl-verify-disabled[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1389 | [0m[35m            auth_scheme=msal.PopAuthScheme([0m
[30;1m1390 | [0m[35m                http_method=msal.PopAuthScheme.HTTP_GET,[0m
[30;1m1391 | [0m[35m                url=api_endpoint,[0m
[30;1m1392 | [0m[35m                nonce=self._extract_pop_nonce(resp.headers.get("WWW-Authenticate")),[0m
[30;1m1393 | [0m[35m                ),[0m
[30;1m1394 | [0m[35m            ))[0m
[30;1m1395 | [0m[35m        resp = requests.get([0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1381 | [0m[35m            but it did not work.[0m
[30;1m1382 | [0m[35m            """)[0m
[30;1m1383 | [0m[35m        # @suppress py/bandit/requests-ssl-verify-disabled[0m
[30;1m1384 | [0m[35m        resp = requests.get(api_endpoint, verify=verify)  # CodeQL [SM03157][0m
[30;1m1385 | [0m[35m        self.assertEqual(resp.status_code, 401, "Initial call should end with an http 401 error")[0m
[30;1m1386 | [0m[35m        result = self._get_shr_pop(**dict([0m
[30;1m1387 | [0m[35m            self.get_lab_user(usertype="cloud"),  # This is generally not the current laptop's defau[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1354 | [0m[35m        self.assertEqual(payload["p"], auth_scheme._url.path)[0m
[30;1m1355 | [0m[35m        self.assertEqual(payload["nonce"], auth_scheme._nonce)[0m
[30;1m1356 | [0m[35m[0m
[30;1m1357 | [0m[35m        validation = requests.post([0m
[30;1m1358 | [0m[35m            # TODO: This endpoint does not seem to validate the url[0m
[30;1m1359 | [0m[35m            "https://testingsts.azurewebsites.net/servernonce/validateshr",[0m
[30;1m1360 | [0m[35m            data={"SHR": shr},[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1338 | [0m[35m        auth_scheme = msal.PopAuthScheme([0m
[30;1m1339 | [0m[35m            http_method="POST",[0m
[30;1m1340 | [0m[35m            url="https://www.Contoso.com/Path1/Path2?queryParam1=a&queryParam2=b",[0m
[30;1m1341 | [0m[35m            nonce=requests.get([0m
[30;1m1342 | [0m[35m                # TODO: Could use ".../missing" and then parse its WWW-Authenticate header[0m
[30;1m1343 | [0m[35m                "https://testingsts.azurewebsites.net/servernonce/get").text,[0m
[30;1m1344 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1285 | [0m[35m        obo_app_object = self.get_lab_app_object([0m
[30;1m1286 | [0m[35m            usertype="cloud", azureenvironment=self.environment, publicClient="no")[0m
[30;1m1287 | [0m[35m        config_pca["password"] = self.get_lab_user_secret(config_pca["lab_name"])[0m
[30;1m1288 | [0m[35m        config_pca["scope"] = ["{app_uri}/files.read".format(app_uri=obo_app_object.get("identifierU[0m
[30;1m1289 | [0m[35m[0m
[30;1m1290 | [0m[35m        self._test_acquire_token_obo(config_pca, config_cca)[0m
[30;1m1291 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1125 | [0m[35m    def test_ciam_device_flow(self):[0m
[30;1m1126 | [0m[35m        self._test_device_flow([0m
[30;1m1127 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1128 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1129 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1130 | [0m[35m            scope=self.app_config["scopes"],[0m
[30;1m1131 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1124 | [0m[35mAADSTS500208: The domain is not a valid login domain for the account type.""")[0m
[30;1m1125 | [0m[35m    def test_ciam_device_flow(self):[0m
[30;1m1126 | [0m[35m        self._test_device_flow([0m
[30;1m1127 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1128 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1129 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1130 | [0m[35m            scope=self.app_config["scopes"],[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1113 | [0m[35m        # Otherwise it would hit AADSTS7000218.[0m
[30;1m1114 | [0m[35m        self._test_username_password([0m
[30;1m1115 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1116 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1117 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1118 | [0m[35m            username=self.user["username"],[0m
[30;1m1119 | [0m[35m            password=self.get_lab_user_secret(self.user["lab_name"]),[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1112 | [0m[35m        # and enabling "Allow public client flows".[0m
[30;1m1113 | [0m[35m        # Otherwise it would hit AADSTS7000218.[0m
[30;1m1114 | [0m[35m        self._test_username_password([0m
[30;1m1115 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1116 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1117 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1118 | [0m[35m            username=self.user["username"],[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1099 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1100 | [0m[35m            client_secret=self.get_lab_user_secret(secret_name),[0m
[30;1m1101 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1102 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1103 | [0m[35m            scope=self.app_config["scopes"],  # It shall ends with "/.default"[0m
[30;1m1104 | [0m[35m            )[0m
[30;1m1105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1098 | [0m[35m        self._test_acquire_token_by_client_secret([0m
[30;1m1099 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1100 | [0m[35m            client_secret=self.get_lab_user_secret(secret_name),[0m
[30;1m1101 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1102 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1103 | [0m[35m            scope=self.app_config["scopes"],  # It shall ends with "/.default"[0m
[30;1m1104 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1080 | [0m[35m    def test_ciam_acquire_token_interactive(self):[0m
[30;1m1081 | [0m[35m        self._test_acquire_token_interactive([0m
[30;1m1082 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1083 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1084 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1085 | [0m[35m            scope=self.app_config["scopes"],[0m
[30;1m1086 | [0m[35m            username=self.user["username"],[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1079 | [0m[35m[0m
[30;1m1080 | [0m[35m    def test_ciam_acquire_token_interactive(self):[0m
[30;1m1081 | [0m[35m        self._test_acquire_token_interactive([0m
[30;1m1082 | [0m[35m            authority=self.app_config.get("authority"),[0m
[30;1m1083 | [0m[35m            oidc_authority=self.app_config.get("oidc_authority"),[0m
[30;1m1084 | [0m[35m            client_id=self.app_config["appId"],[0m
[30;1m1085 | [0m[35m            scope=self.app_config["scopes"],[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m767 | [0m[35m            )   # It already tests reading AT from cache, and using RT to refresh[0m
[30;1m768 | [0m[35m                # acquire_token_silent() would work because we pass in the same key[0m
[30;1m769 | [0m[35m        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m770 | [0m[35m            result.get("error"), result.get("error_description")))[0m
[30;1m771 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])[0m
[30;1m772 | [0m[35m        self.assertEqual(result["token_source"], "identity_provider")[0m
[30;1m773 | [0m[35m        logger.debug("%s.cache = %s",[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m767 | [0m[35m            )   # It already tests reading AT from cache, and using RT to refresh[0m
[30;1m768 | [0m[35m                # acquire_token_silent() would work because we pass in the same key[0m
[30;1m769 | [0m[35m        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m770 | [0m[35m            result.get("error"), result.get("error_description")))[0m
[30;1m771 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])[0m
[30;1m772 | [0m[35m        self.assertEqual(result["token_source"], "identity_provider")[0m
[30;1m773 | [0m[35m        logger.debug("%s.cache = %s",[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m766 | [0m[35m            prompt="none" if msal.application._is_running_in_cloud_shell() else None,[0m
[30;1m767 | [0m[35m            )   # It already tests reading AT from cache, and using RT to refresh[0m
[30;1m768 | [0m[35m                # acquire_token_silent() would work because we pass in the same key[0m
[30;1m769 | [0m[35m        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m770 | [0m[35m            result.get("error"), result.get("error_description")))[0m
[30;1m771 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])[0m
[30;1m772 | [0m[35m        self.assertEqual(result["token_source"], "identity_provider")[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m749 | [0m[35m        refreshed_result = app.acquire_token_for_client(self.SCOPE, data=self.DATA2)[0m
[30;1m750 | [0m[35m        self.assertIsNotNone([0m
[30;1m751 | [0m[35m            refreshed_result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m752 | [0m[35m            refreshed_result.get("error"), refreshed_result.get("error_description")))[0m
[30;1m753 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, refreshed_result["token_type"])[0m
[30;1m754 | [0m[35m        self.assertEqual(refreshed_result["token_source"], "identity_provider")[0m
[30;1m755 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m749 | [0m[35m        refreshed_result = app.acquire_token_for_client(self.SCOPE, data=self.DATA2)[0m
[30;1m750 | [0m[35m        self.assertIsNotNone([0m
[30;1m751 | [0m[35m            refreshed_result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m752 | [0m[35m            refreshed_result.get("error"), refreshed_result.get("error_description")))[0m
[30;1m753 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, refreshed_result["token_type"])[0m
[30;1m754 | [0m[35m        self.assertEqual(refreshed_result["token_source"], "identity_provider")[0m
[30;1m755 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m748 | [0m[35m        # refresh_token grant can fetch an ssh-cert bound to a different key[0m
[30;1m749 | [0m[35m        refreshed_result = app.acquire_token_for_client(self.SCOPE, data=self.DATA2)[0m
[30;1m750 | [0m[35m        self.assertIsNotNone([0m
[30;1m751 | [0m[35m            refreshed_result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m752 | [0m[35m            refreshed_result.get("error"), refreshed_result.get("error_description")))[0m
[30;1m753 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, refreshed_result["token_type"])[0m
[30;1m754 | [0m[35m        self.assertEqual(refreshed_result["token_source"], "identity_provider")[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m        cached_result = app.acquire_token_for_client(self.SCOPE, data=self.DATA1)[0m
[30;1m742 | [0m[35m        self.assertIsNotNone([0m
[30;1m743 | [0m[35m            cached_result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m744 | [0m[35m            cached_result.get("error"), cached_result.get("error_description")))[0m
[30;1m745 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, cached_result["token_type"])[0m
[30;1m746 | [0m[35m        self.assertEqual(cached_result["token_source"], "cache")[0m
[30;1m747 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m        cached_result = app.acquire_token_for_client(self.SCOPE, data=self.DATA1)[0m
[30;1m742 | [0m[35m        self.assertIsNotNone([0m
[30;1m743 | [0m[35m            cached_result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m744 | [0m[35m            cached_result.get("error"), cached_result.get("error_description")))[0m
[30;1m745 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, cached_result["token_type"])[0m
[30;1m746 | [0m[35m        self.assertEqual(cached_result["token_source"], "cache")[0m
[30;1m747 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m740 | [0m[35m        # Test cache hit[0m
[30;1m741 | [0m[35m        cached_result = app.acquire_token_for_client(self.SCOPE, data=self.DATA1)[0m
[30;1m742 | [0m[35m        self.assertIsNotNone([0m
[30;1m743 | [0m[35m            cached_result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m744 | [0m[35m            cached_result.get("error"), cached_result.get("error_description")))[0m
[30;1m745 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, cached_result["token_type"])[0m
[30;1m746 | [0m[35m        self.assertEqual(cached_result["token_source"], "cache")[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m733 | [0m[35m        app = get_lab_app()  # Any SP can obtain an ssh-cert. Here we use the lab app.[0m
[30;1m734 | [0m[35m        result = app.acquire_token_for_client(self.SCOPE, data=self.DATA1)[0m
[30;1m735 | [0m[35m        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m736 | [0m[35m            result.get("error"), result.get("error_description")))[0m
[30;1m737 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])[0m
[30;1m738 | [0m[35m        self.assertEqual(result["token_source"], "identity_provider")[0m
[30;1m739 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m733 | [0m[35m        app = get_lab_app()  # Any SP can obtain an ssh-cert. Here we use the lab app.[0m
[30;1m734 | [0m[35m        result = app.acquire_token_for_client(self.SCOPE, data=self.DATA1)[0m
[30;1m735 | [0m[35m        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m736 | [0m[35m            result.get("error"), result.get("error_description")))[0m
[30;1m737 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])[0m
[30;1m738 | [0m[35m        self.assertEqual(result["token_source"], "identity_provider")[0m
[30;1m739 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m732 | [0m[35m    def _test_service_principal(self):[0m
[30;1m733 | [0m[35m        app = get_lab_app()  # Any SP can obtain an ssh-cert. Here we use the lab app.[0m
[30;1m734 | [0m[35m        result = app.acquire_token_for_client(self.SCOPE, data=self.DATA1)[0m
[30;1m735 | [0m[35m        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m736 | [0m[35m            result.get("error"), result.get("error_description")))[0m
[30;1m737 | [0m[35m        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])[0m
[30;1m738 | [0m[35m        self.assertEqual(result["token_source"], "identity_provider")[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m724 | [0m[35m            oidc_authority=oidc_authority,[0m
[30;1m725 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m726 | [0m[35m        result = self.app.acquire_token_for_client(scope)[0m
[30;1m727 | [0m[35m        self.assertIsNotNone(result.get("access_token"), "Got %s instead" % result)[0m
[30;1m728 | [0m[35m        self.assertCacheWorksForApp(result, scope)[0m
[30;1m729 | [0m[35m[0m
[30;1m730 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m698 | [0m[35m        account = accounts[0]  # Alternatively, cca app could just loop through each account[0m
[30;1m699 | [0m[35m        result = cca.acquire_token_silent(config_cca["scope"], account)[0m
[30;1m700 | [0m[35m        self.assertTrue([0m
[30;1m701 | [0m[35m            result and result.get("access_token") == cca_result["access_token"],[0m
[30;1m702 | [0m[35m            "CCA should hit an access token from cache: {}".format([0m
[30;1m703 | [0m[35m                json.dumps(cca.token_cache._cache, indent=2)))[0m
[30;1m704 | [0m[35m        if "refresh_token" in cca_result:[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m690 | [0m[35m        #    now it is the time to persist current cache state for current user.[0m
[30;1m691 | [0m[35m        #    Assuming you already did that (which is not shown in this test case),[0m
[30;1m692 | [0m[35m        #    the following part shows one of the ways to obtain an AT from cache.[0m
[30;1m693 | [0m[35m        username = cca_result.get("id_token_claims", {}).get("preferred_username")[0m
[30;1m694 | [0m[35m        accounts = cca.get_accounts(username=username)[0m
[30;1m695 | [0m[35m        if username is not None:  # It means CCA have requested an IDT w/ "profile" scope[0m
[30;1m696 | [0m[35m            assert config_cca["username"] == username, "Incorrect test case configuration"[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m690 | [0m[35m        #    now it is the time to persist current cache state for current user.[0m
[30;1m691 | [0m[35m        #    Assuming you already did that (which is not shown in this test case),[0m
[30;1m692 | [0m[35m        #    the following part shows one of the ways to obtain an AT from cache.[0m
[30;1m693 | [0m[35m        username = cca_result.get("id_token_claims", {}).get("preferred_username")[0m
[30;1m694 | [0m[35m        accounts = cca.get_accounts(username=username)[0m
[30;1m695 | [0m[35m        if username is not None:  # It means CCA have requested an IDT w/ "profile" scope[0m
[30;1m696 | [0m[35m            assert config_cca["username"] == username, "Incorrect test case configuration"[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m681 | [0m[35m                # Otherwise, the OBO app need to implement a one-cache-per-user setup.[0m
[30;1m682 | [0m[35m            )[0m
[30;1m683 | [0m[35m        cca_result = cca.acquire_token_on_behalf_of(assertion, config_cca["scope"])[0m
[30;1m684 | [0m[35m        self.assertIsNotNone(cca_result.get("access_token"), "OBO call failed: {}".format([0m
[30;1m685 | [0m[35m            json.dumps(cca_result, indent=2)))[0m
[30;1m686 | [0m[35m[0m
[30;1m687 | [0m[35m        # 3. Now the OBO app can simply store downstream token(s) in same session.[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m665 | [0m[35m                azure_region=azure_region,[0m
[30;1m666 | [0m[35m                http_client=http_client or MinimalHttpClient(),[0m
[30;1m667 | [0m[35m                ).acquire_token_for_client(scopes=config_pca["scope"])[0m
[30;1m668 | [0m[35m        assertion = result.get("access_token")[0m
[30;1m669 | [0m[35m        self.assertIsNotNone(assertion, "First app failed to get AT. {}".format([0m
[30;1m670 | [0m[35m            json.dumps(result, indent=2)))[0m
[30;1m671 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m636 | [0m[35m                error=result.get("error"),[0m
[30;1m637 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m638 | [0m[35m        if username and result.get("id_token_claims", {}).get("preferred_username"):[0m
[30;1m639 | [0m[35m            self.assertEqual([0m
[30;1m640 | [0m[35m                username, result["id_token_claims"]["preferred_username"],[0m
[30;1m641 | [0m[35m                "You are expected to sign in as account {}, but tokens returned is for {}".format([0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m636 | [0m[35m                error=result.get("error"),[0m
[30;1m637 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m638 | [0m[35m        if username and result.get("id_token_claims", {}).get("preferred_username"):[0m
[30;1m639 | [0m[35m            self.assertEqual([0m
[30;1m640 | [0m[35m                username, result["id_token_claims"]["preferred_username"],[0m
[30;1m641 | [0m[35m                "You are expected to sign in as account {}, but tokens returned is for {}".format([0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m            "{error}: {error_description}".format([0m
[30;1m635 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m636 | [0m[35m                error=result.get("error"),[0m
[30;1m637 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m638 | [0m[35m        if username and result.get("id_token_claims", {}).get("preferred_username"):[0m
[30;1m639 | [0m[35m            self.assertEqual([0m
[30;1m640 | [0m[35m                username, result["id_token_claims"]["preferred_username"],[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m            "access_token", result,[0m
[30;1m634 | [0m[35m            "{error}: {error_description}".format([0m
[30;1m635 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m636 | [0m[35m                error=result.get("error"),[0m
[30;1m637 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m638 | [0m[35m        if username and result.get("id_token_claims", {}).get("preferred_username"):[0m
[30;1m639 | [0m[35m            self.assertEqual([0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m627 | [0m[35m            "%s: cache = %s, id_token_claims = %s",[0m
[30;1m628 | [0m[35m            self.id(),[0m
[30;1m629 | [0m[35m            json.dumps(self.app.token_cache._cache, indent=4),[0m
[30;1m630 | [0m[35m            json.dumps(result.get("id_token_claims"), indent=4),[0m
[30;1m631 | [0m[35m            )[0m
[30;1m632 | [0m[35m        self.assertIn([0m
[30;1m633 | [0m[35m            "access_token", result,[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m621 | [0m[35m            self.skipTest("Timed out. Did not have test settings in hand? Prepare and retry.")[0m
[30;1m622 | [0m[35m        self.assertIsNotNone([0m
[30;1m623 | [0m[35m            auth_response.get("code"), "Error: {}, Detail: {}".format([0m
[30;1m624 | [0m[35m                auth_response.get("error"), auth_response))[0m
[30;1m625 | [0m[35m        result = self.app.acquire_token_by_auth_code_flow(flow, auth_response)[0m
[30;1m626 | [0m[35m        logger.debug([0m
[30;1m627 | [0m[35m            "%s: cache = %s, id_token_claims = %s",[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m620 | [0m[35m        if auth_response is None:[0m
[30;1m621 | [0m[35m            self.skipTest("Timed out. Did not have test settings in hand? Prepare and retry.")[0m
[30;1m622 | [0m[35m        self.assertIsNotNone([0m
[30;1m623 | [0m[35m            auth_response.get("code"), "Error: {}, Detail: {}".format([0m
[30;1m624 | [0m[35m                auth_response.get("error"), auth_response))[0m
[30;1m625 | [0m[35m        result = self.app.acquire_token_by_auth_code_flow(flow, auth_response)[0m
[30;1m626 | [0m[35m        logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m591 | [0m[35m            "{error}: {error_description}".format([0m
[30;1m592 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m593 | [0m[35m                error=result.get("error"),[0m
[30;1m594 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m595 | [0m[35m        self.assertCacheWorksForUser(result, scope, username=None)[0m
[30;1m596 | [0m[35m[0m
[30;1m597 | [0m[35m    @unittest.skipIf(os.getenv("TRAVIS"), "Browser automation is not yet implemented")[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m590 | [0m[35m            "access_token", result,[0m
[30;1m591 | [0m[35m            "{error}: {error_description}".format([0m
[30;1m592 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m593 | [0m[35m                error=result.get("error"),[0m
[30;1m594 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m595 | [0m[35m        self.assertCacheWorksForUser(result, scope, username=None)[0m
[30;1m596 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m            "%s: cache = %s, id_token_claims = %s",[0m
[30;1m585 | [0m[35m            self.id(),[0m
[30;1m586 | [0m[35m            json.dumps(self.app.token_cache._cache, indent=4),[0m
[30;1m587 | [0m[35m            json.dumps(result.get("id_token_claims"), indent=4),[0m
[30;1m588 | [0m[35m            )[0m
[30;1m589 | [0m[35m        self.assertIn([0m
[30;1m590 | [0m[35m            "access_token", result,[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m562 | [0m[35m            }.get(_env, "https://login.microsoftonline.com/")[0m
[30;1m563 | [0m[35m        scope = {[0m
[30;1m564 | [0m[35m            "azureusgovernment": ["https://graph.microsoft.us/.default"],[0m
[30;1m565 | [0m[35m            }.get(_env, ["https://graph.microsoft.com/.default"])[0m
[30;1m566 | [0m[35m        return {  # Mapping lab API response to our simplified configuration format[0m
[30;1m567 | [0m[35m            "authority": authority_base + result["tenantID"],[0m
[30;1m568 | [0m[35m            "client_id": result["appId"],[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m559 | [0m[35m        _env = query.get("azureenvironment", "").lower()[0m
[30;1m560 | [0m[35m        authority_base = {[0m
[30;1m561 | [0m[35m            "azureusgovernment": "https://login.microsoftonline.us/"[0m
[30;1m562 | [0m[35m            }.get(_env, "https://login.microsoftonline.com/")[0m
[30;1m563 | [0m[35m        scope = {[0m
[30;1m564 | [0m[35m            "azureusgovernment": ["https://graph.microsoft.us/.default"],[0m
[30;1m565 | [0m[35m            }.get(_env, ["https://graph.microsoft.com/.default"])[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m556 | [0m[35m        result = resp.json()[0][0m
[30;1m557 | [0m[35m        assert result.get("upn"), "Found no test user but {}".format([0m
[30;1m558 | [0m[35m            json.dumps(result, indent=2))[0m
[30;1m559 | [0m[35m        _env = query.get("azureenvironment", "").lower()[0m
[30;1m560 | [0m[35m        authority_base = {[0m
[30;1m561 | [0m[35m            "azureusgovernment": "https://login.microsoftonline.us/"[0m
[30;1m562 | [0m[35m            }.get(_env, "https://login.microsoftonline.com/")[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m554 | [0m[35m    def get_lab_user(cls, **query):  # https://docs.msidlab.com/labapi/userapi.html[0m
[30;1m555 | [0m[35m        resp = cls.session.get("https://msidlab.com/api/user", params=query)[0m
[30;1m556 | [0m[35m        result = resp.json()[0][0m
[30;1m557 | [0m[35m        assert result.get("upn"), "Found no test user but {}".format([0m
[30;1m558 | [0m[35m            json.dumps(result, indent=2))[0m
[30;1m559 | [0m[35m        _env = query.get("azureenvironment", "").lower()[0m
[30;1m560 | [0m[35m        authority_base = {[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m    @classmethod[0m
[30;1m554 | [0m[35m    def get_lab_user(cls, **query):  # https://docs.msidlab.com/labapi/userapi.html[0m
[30;1m555 | [0m[35m        resp = cls.session.get("https://msidlab.com/api/user", params=query)[0m
[30;1m556 | [0m[35m        result = resp.json()[0][0m
[30;1m557 | [0m[35m        assert result.get("upn"), "Found no test user but {}".format([0m
[30;1m558 | [0m[35m            json.dumps(result, indent=2))[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m        if lab_name not in cls._secrets:[0m
[30;1m547 | [0m[35m            logger.info("Querying lab user password for %s", lab_name)[0m
[30;1m548 | [0m[35m            url = "https://msidlab.com/api/LabSecret?secret=%s" % lab_name[0m
[30;1m549 | [0m[35m            resp = cls.session.get(url)[0m
[30;1m550 | [0m[35m            cls._secrets[lab_name] = resp.json()["value"][0m
[30;1m551 | [0m[35m        return cls._secrets[lab_name][0m
[30;1m552 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m    @classmethod[0m
[30;1m535 | [0m[35m    def get_lab_app_object(cls, client_id=None, **query):  # https://msidlab.com/swagger/index.html[0m
[30;1m536 | [0m[35m        url = "https://msidlab.com/api/app/{}".format(client_id or "")[0m
[30;1m537 | [0m[35m        resp = cls.session.get(url, params=query)[0m
[30;1m538 | [0m[35m        result = resp.json()[0][0m
[30;1m539 | [0m[35m        result["scopes"] = [  # Raw data has extra space, such as "s1, s2"[0m
[30;1m540 | [0m[35m            s.strip() for s in result["defaultScopes"].split(',')][0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m    if not result.get("access_token"):[0m
[30;1m506 | [0m[35m        raise LabTokenError([0m
[30;1m507 | [0m[35m            "Unable to obtain token for lab. Encountered {}: {}".format([0m
[30;1m508 | [0m[35m            result.get("error"), result.get("error_description")[0m
[30;1m509 | [0m[35m        ))[0m
[30;1m510 | [0m[35m    session = requests.Session()[0m
[30;1m511 | [0m[35m    session.headers.update({"Authorization": "Bearer %s" % result["access_token"]})[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m    if not result.get("access_token"):[0m
[30;1m506 | [0m[35m        raise LabTokenError([0m
[30;1m507 | [0m[35m            "Unable to obtain token for lab. Encountered {}: {}".format([0m
[30;1m508 | [0m[35m            result.get("error"), result.get("error_description")[0m
[30;1m509 | [0m[35m        ))[0m
[30;1m510 | [0m[35m    session = requests.Session()[0m
[30;1m511 | [0m[35m    session.headers.update({"Authorization": "Bearer %s" % result["access_token"]})[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m502 | [0m[35mdef get_session(lab_app, scopes):  # BTW, this infrastructure tests the confidential client flow[0m
[30;1m503 | [0m[35m    logger.info("Creating session")[0m
[30;1m504 | [0m[35m    result = lab_app.acquire_token_for_client(scopes)[0m
[30;1m505 | [0m[35m    if not result.get("access_token"):[0m
[30;1m506 | [0m[35m        raise LabTokenError([0m
[30;1m507 | [0m[35m            "Unable to obtain token for lab. Encountered {}: {}".format([0m
[30;1m508 | [0m[35m            result.get("error"), result.get("error_description")[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m            self.config['client_id'], authority=self.config["authority"],[0m
[30;1m440 | [0m[35m            client_credential={"client_assertion": self.config["client_assertion"]},[0m
[30;1m441 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m442 | [0m[35m        scope = self.config.get("scope", [])[0m
[30;1m443 | [0m[35m        result = self.app.acquire_token_for_client(scope)[0m
[30;1m444 | [0m[35m        self.assertIn('access_token', result)[0m
[30;1m445 | [0m[35m        self.assertCacheWorksForApp(result, scope)[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m428 | [0m[35m                "public_certificate": public_certificate,[0m
[30;1m429 | [0m[35m                },[0m
[30;1m430 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m431 | [0m[35m        scope = self.config.get("scope", [])[0m
[30;1m432 | [0m[35m        result = self.app.acquire_token_for_client(scope)[0m
[30;1m433 | [0m[35m        self.assertIn('access_token', result)[0m
[30;1m434 | [0m[35m        self.assertCacheWorksForApp(result, scope)[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m            self.config['client_id'],[0m
[30;1m406 | [0m[35m            {"private_key": private_key, "thumbprint": client_cert["thumbprint"]},[0m
[30;1m407 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m408 | [0m[35m        scope = self.config.get("scope", [])[0m
[30;1m409 | [0m[35m        result = self.app.acquire_token_for_client(scope)[0m
[30;1m410 | [0m[35m        self.assertIn('access_token', result)[0m
[30;1m411 | [0m[35m        self.assertCacheWorksForApp(result, scope)[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m            client_credential=self.config.get("client_secret"),[0m
[30;1m391 | [0m[35m            authority=self.config.get("authority"),[0m
[30;1m392 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m393 | [0m[35m        scope = self.config.get("scope", [])[0m
[30;1m394 | [0m[35m        result = self.app.acquire_token_for_client(scope)[0m
[30;1m395 | [0m[35m        self.assertIn('access_token', result)[0m
[30;1m396 | [0m[35m        self.assertCacheWorksForApp(result, scope)[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m
[30;1m389 | [0m[35m            self.config["client_id"],[0m
[30;1m390 | [0m[35m            client_credential=self.config.get("client_secret"),[0m
[30;1m391 | [0m[35m            authority=self.config.get("authority"),[0m
[30;1m392 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m393 | [0m[35m        scope = self.config.get("scope", [])[0m
[30;1m394 | [0m[35m        result = self.app.acquire_token_for_client(scope)[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m        self.skipUnlessWithConfig(["client_id", "client_secret"])[0m
[30;1m388 | [0m[35m        self.app = msal.ConfidentialClientApplication([0m
[30;1m389 | [0m[35m            self.config["client_id"],[0m
[30;1m390 | [0m[35m            client_credential=self.config.get("client_secret"),[0m
[30;1m391 | [0m[35m            authority=self.config.get("authority"),[0m
[30;1m392 | [0m[35m            http_client=MinimalHttpClient())[0m
[30;1m393 | [0m[35m        scope = self.config.get("scope", [])[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m            "{error}: {error_description}".format([0m
[30;1m368 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m369 | [0m[35m                error=result.get("error"),[0m
[30;1m370 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m371 | [0m[35m        self.assertCacheWorksForUser(result, self.config["scope"], username=None)[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    def test_auth_code(self):[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35m            "access_token", result,[0m
[30;1m367 | [0m[35m            "{error}: {error_description}".format([0m
[30;1m368 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m369 | [0m[35m                error=result.get("error"),[0m
[30;1m370 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m371 | [0m[35m        self.assertCacheWorksForUser(result, self.config["scope"], username=None)[0m
[30;1m372 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m            self.config["client_id"],[0m
[30;1m352 | [0m[35m            client_secret=self.config.get("client_secret"),[0m
[30;1m353 | [0m[35m            authority=self.config.get("authority"),[0m
[30;1m354 | [0m[35m            port=self.config.get("listen_port", 44331),[0m
[30;1m355 | [0m[35m            scopes=scopes or self.config["scope"],[0m
[30;1m356 | [0m[35m            **kwargs)[0m
[30;1m357 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35m        return _get_app_and_auth_code([0m
[30;1m351 | [0m[35m            self.config["client_id"],[0m
[30;1m352 | [0m[35m            client_secret=self.config.get("client_secret"),[0m
[30;1m353 | [0m[35m            authority=self.config.get("authority"),[0m
[30;1m354 | [0m[35m            port=self.config.get("listen_port", 44331),[0m
[30;1m355 | [0m[35m            scopes=scopes or self.config["scope"],[0m
[30;1m356 | [0m[35m            **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m    def _get_app_and_auth_code(self, scopes=None, **kwargs):[0m
[30;1m350 | [0m[35m        return _get_app_and_auth_code([0m
[30;1m351 | [0m[35m            self.config["client_id"],[0m
[30;1m352 | [0m[35m            client_secret=self.config.get("client_secret"),[0m
[30;1m353 | [0m[35m            authority=self.config.get("authority"),[0m
[30;1m354 | [0m[35m            port=self.config.get("listen_port", 44331),[0m
[30;1m355 | [0m[35m            scopes=scopes or self.config["scope"],[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m            [self.scope_that_requires_no_managed_device], prompt="none")[0m
[30;1m323 | [0m[35m        self.assertEqual([0m
[30;1m324 | [0m[35m            "Bearer", result.get("token_type"), "Unexpected result: %s" % result)[0m
[30;1m325 | [0m[35m        self.assertIsNotNone(result.get("access_token"))[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35mTHIS_FOLDER = os.path.dirname(__file__)[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m        result = self.app.acquire_token_interactive([0m
[30;1m322 | [0m[35m            [self.scope_that_requires_no_managed_device], prompt="none")[0m
[30;1m323 | [0m[35m        self.assertEqual([0m
[30;1m324 | [0m[35m            "Bearer", result.get("token_type"), "Unexpected result: %s" % result)[0m
[30;1m325 | [0m[35m        self.assertIsNotNone(result.get("access_token"))[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m297 | [0m[35m                error=result.get("error"),[0m
[30;1m298 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m299 | [0m[35m        if username and result.get("id_token_claims", {}).get("preferred_username"):[0m
[30;1m300 | [0m[35m            self.assertEqual([0m
[30;1m301 | [0m[35m                username, result["id_token_claims"]["preferred_username"],[0m
[30;1m302 | [0m[35m                "You are expected to sign in as account {}, but tokens returned is for {}".format([0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m297 | [0m[35m                error=result.get("error"),[0m
[30;1m298 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m299 | [0m[35m        if username and result.get("id_token_claims", {}).get("preferred_username"):[0m
[30;1m300 | [0m[35m            self.assertEqual([0m
[30;1m301 | [0m[35m                username, result["id_token_claims"]["preferred_username"],[0m
[30;1m302 | [0m[35m                "You are expected to sign in as account {}, but tokens returned is for {}".format([0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m            "{error}: {error_description}".format([0m
[30;1m296 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m297 | [0m[35m                error=result.get("error"),[0m
[30;1m298 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m299 | [0m[35m        if username and result.get("id_token_claims", {}).get("preferred_username"):[0m
[30;1m300 | [0m[35m            self.assertEqual([0m
[30;1m301 | [0m[35m                username, result["id_token_claims"]["preferred_username"],[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m            "access_token", result,[0m
[30;1m295 | [0m[35m            "{error}: {error_description}".format([0m
[30;1m296 | [0m[35m                # Note: No interpolation here, cause error won't always present[0m
[30;1m297 | [0m[35m                error=result.get("error"),[0m
[30;1m298 | [0m[35m                error_description=result.get("error_description")))[0m
[30;1m299 | [0m[35m        if username and result.get("id_token_claims", {}).get("preferred_username"):[0m
[30;1m300 | [0m[35m            self.assertEqual([0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m            "%s: cache = %s, id_token_claims = %s",[0m
[30;1m156 | [0m[35m            self.id(),[0m
[30;1m157 | [0m[35m            json.dumps(self.app.token_cache._cache, indent=4),[0m
[30;1m158 | [0m[35m            json.dumps(result_from_wire.get("id_token_claims"), indent=4),[0m
[30;1m159 | [0m[35m            )[0m
[30;1m160 | [0m[35m        self.assertIsNone([0m
[30;1m161 | [0m[35m            self.app.acquire_token_silent(scope, account=None),[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m                scope, account=account, data=data or {}, auth_scheme=auth_scheme)[0m
[30;1m126 | [0m[35m            self.assertIsNotNone(silent_result)[0m
[30;1m127 | [0m[35m            self.assertIsNone([0m
[30;1m128 | [0m[35m                silent_result.get("refresh_token"), "acquire_token_silent() should return no RT")[0m
[30;1m129 | [0m[35m            if auth_scheme:[0m
[30;1m130 | [0m[35m                self.assertNotEqual([0m
[30;1m131 | [0m[35m                    self.app._TOKEN_SOURCE_CACHE, silent_result[self.app._TOKEN_SOURCE])[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            "%s: cache = %s, id_token_claims = %s",[0m
[30;1m111 | [0m[35m            self.id(),[0m
[30;1m112 | [0m[35m            json.dumps(self.app.token_cache._cache, indent=4),[0m
[30;1m113 | [0m[35m            json.dumps(result_from_wire.get("id_token_claims"), indent=4),[0m
[30;1m114 | [0m[35m            )[0m
[30;1m115 | [0m[35m        # You can filter by predefined username, or let end user to choose one[0m
[30;1m116 | [0m[35m        accounts = self.app.get_accounts(username=username)[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m                    "{error}: {error_description}".format([0m
[30;1m102 | [0m[35m                        # Do explicit response.get(...) rather than **response[0m
[30;1m103 | [0m[35m                        error=response.get("error"),[0m
[30;1m104 | [0m[35m                        error_description=response.get("error_description")))[0m
[30;1m105 | [0m[35m            assertion()[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    def assertCacheWorksForUser([0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m                    "access_token", response,[0m
[30;1m101 | [0m[35m                    "{error}: {error_description}".format([0m
[30;1m102 | [0m[35m                        # Do explicit response.get(...) rather than **response[0m
[30;1m103 | [0m[35m                        error=response.get("error"),[0m
[30;1m104 | [0m[35m                        error_description=response.get("error_description")))[0m
[30;1m105 | [0m[35m            assertion()[0m
[30;1m106 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m                assertion = lambda: self.assertIn([0m
[30;1m100 | [0m[35m                    "access_token", response,[0m
[30;1m101 | [0m[35m                    "{error}: {error_description}".format([0m
[30;1m102 | [0m[35m                        # Do explicit response.get(...) rather than **response[0m
[30;1m103 | [0m[35m                        error=response.get("error"),[0m
[30;1m104 | [0m[35m                        error_description=response.get("error_description")))[0m
[30;1m105 | [0m[35m            assertion()[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m        if response.get("error") in skippable_errors:[0m
[30;1m94 | [0m[35m            logger.debug("Response = %s", response)[0m
[30;1m95 | [0m[35m            # Some of these errors are configuration issues, not library issues[0m
[30;1m96 | [0m[35m            raise unittest.SkipTest(response.get("error_description"))[0m
[30;1m97 | [0m[35m        else:[0m
[30;1m98 | [0m[35m            if assertion is None:[0m
[30;1m99 | [0m[35m                assertion = lambda: self.assertIn([0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def assertLoosely(self, response, assertion=None,[0m
[30;1m92 | [0m[35m            skippable_errors=("invalid_grant", "interaction_required")):[0m
[30;1m93 | [0m[35m        if response.get("error") in skippable_errors:[0m
[30;1m94 | [0m[35m            logger.debug("Response = %s", response)[0m
[30;1m95 | [0m[35m            # Some of these errors are configuration issues, not library issues[0m
[30;1m96 | [0m[35m            raise unittest.SkipTest(response.get("error_description"))[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1154 | [0m[35m            #validate_authority=False,[0m
[30;1m1155 | [0m[35m            authority="https://login.microsoftonline.com/microsoft.onmicrosoft.com",[0m
[30;1m1156 | [0m[35m            azure_region=configured_region,[0m
[30;1m1157 | [0m[35m            timeout=2,  # Short timeout makes this test case responsive on non-VM[0m
[30;1m1158 | [0m[35m            )[0m
[30;1m1159 | [0m[35m        scopes = ["https://graph.microsoft.com/.default"][0m
[30;1m1160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1143 | [0m[35m[0m
[30;1m1144 | [0m[35mclass WorldWideRegionalEndpointTestCase(LabBasedTestCase):[0m
[30;1m1145 | [0m[35m    region = "westus"[0m
[30;1m1146 | [0m[35m    timeout = 2  # Short timeout makes this test case responsive on non-VM[0m
[30;1m1147 | [0m[35m[0m
[30;1m1148 | [0m[35m    def _test_acquire_token_for_client(self, configured_region, expected_region):[0m
[30;1m1149 | [0m[35m        """This is the only grant supported by regional endpoint, for now"""[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1143 | [0m[35m[0m
[30;1m1144 | [0m[35mclass WorldWideRegionalEndpointTestCase(LabBasedTestCase):[0m
[30;1m1145 | [0m[35m    region = "westus"[0m
[30;1m1146 | [0m[35m    timeout = 2  # Short timeout makes this test case responsive on non-VM[0m
[30;1m1147 | [0m[35m[0m
[30;1m1148 | [0m[35m    def _test_acquire_token_for_client(self, configured_region, expected_region):[0m
[30;1m1149 | [0m[35m        """This is the only grant supported by regional endpoint, for now"""[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m818 | [0m[35m        'token_type': 'pop',[0m
[30;1m819 | [0m[35m        'key_id': key,[0m
[30;1m820 | [0m[35m        "req_cnf": base64.urlsafe_b64encode(raw_req_cnf.encode('utf-8')).decode('utf-8').rstrip('=')[0m
[30;1m821 | [0m[35m            # Note: Sending raw_req_cnf without base64 encoding would result in an http 500 error[0m
[30;1m822 | [0m[35m    }  # See also https://github.com/Azure/azure-cli-extensions/blob/main/src/connectedk8s/azext_con[0m
[30;1m823 | [0m[35m[0m
[30;1m824 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m757 | [0m[35m        lab_user = self.get_lab_user(usertype="cloud")[0m
[30;1m758 | [0m[35m        result = self._test_acquire_token_interactive([0m
[30;1m759 | [0m[35m            client_id="04b07795-8ddb-461a-bbee-02f9e1bf7b46",  # Azure CLI is one[0m
[30;1m760 | [0m[35m                # of the only 2 clients that are PreAuthz to use ssh cert feature[0m
[30;1m761 | [0m[35m            authority="https://login.microsoftonline.com/common",[0m
[30;1m762 | [0m[35m            scope=self.SCOPE,[0m
[30;1m763 | [0m[35m            data=self.DATA1,[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m687 | [0m[35m        # 3. Now the OBO app can simply store downstream token(s) in same session.[0m
[30;1m688 | [0m[35m        #    Alternatively, if you want to persist the downstream AT, and possibly[0m
[30;1m689 | [0m[35m        #    the RT (if any) for prolonged access even after your own AT expires,[0m
[30;1m690 | [0m[35m        #    now it is the time to persist current cache state for current user.[0m
[30;1m691 | [0m[35m        #    Assuming you already did that (which is not shown in this test case),[0m
[30;1m692 | [0m[35m        #    the following part shows one of the ways to obtain an AT from cache.[0m
[30;1m693 | [0m[35m        username = cca_result.get("id_token_claims", {}).get("preferred_username")[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m669 | [0m[35m        self.assertIsNotNone(assertion, "First app failed to get AT. {}".format([0m
[30;1m670 | [0m[35m            json.dumps(result, indent=2)))[0m
[30;1m671 | [0m[35m[0m
[30;1m672 | [0m[35m        # 2. Our mid-tier service uses OBO to obtain a token for downstream service[0m
[30;1m673 | [0m[35m        cca = msal.ConfidentialClientApplication([0m
[30;1m674 | [0m[35m            config_cca["client_id"],[0m
[30;1m675 | [0m[35m            client_credential=config_cca["client_secret"],[0m
[30;1m676 | [0m[35m            authority=config_cca["authority"],[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m669 | [0m[35m        self.assertIsNotNone(assertion, "First app failed to get AT. {}".format([0m
[30;1m670 | [0m[35m            json.dumps(result, indent=2)))[0m
[30;1m671 | [0m[35m[0m
[30;1m672 | [0m[35m        # 2. Our mid-tier service uses OBO to obtain a token for downstream service[0m
[30;1m673 | [0m[35m        cca = msal.ConfidentialClientApplication([0m
[30;1m674 | [0m[35m            config_cca["client_id"],[0m
[30;1m675 | [0m[35m            client_credential=config_cca["client_secret"],[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m658 | [0m[35m                    scopes=config_pca["scope"],[0m
[30;1m659 | [0m[35m                )[0m
[30;1m660 | [0m[35m        else:  # We repurpose the config_pca to contain client_secret for cca app 1[0m
[30;1m661 | [0m[35m            # 1.b An app obtains a token representing itself, for our mid-tier service[0m
[30;1m662 | [0m[35m            result = msal.ConfidentialClientApplication([0m
[30;1m663 | [0m[35m                config_pca["client_id"], authority=config_pca["authority"],[0m
[30;1m664 | [0m[35m                client_credential=config_pca["client_secret"],[0m
[30;1m665 | [0m[35m                azure_region=azure_region,[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m648 | [0m[35m            http_client=None,[0m
[30;1m649 | [0m[35m            ):[0m
[30;1m650 | [0m[35m        if "client_secret" not in config_pca:[0m
[30;1m651 | [0m[35m            # 1.a An app obtains a token representing a user, for our mid-tier service[0m
[30;1m652 | [0m[35m            result = msal.PublicClientApplication([0m
[30;1m653 | [0m[35m                config_pca["client_id"], authority=config_pca["authority"],[0m
[30;1m654 | [0m[35m                azure_region=azure_region,[0m
[30;1m655 | [0m[35m                http_client=http_client or MinimalHttpClient(),[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m468 | [0m[35m    Get it from environment variables if defined, otherwise fall back to use MSI.[0m
[30;1m469 | [0m[35m    """[0m
[30;1m470 | [0m[35m    logger.info([0m
[30;1m471 | [0m[35m        "Reading ENV variables %s and %s for lab app defined at "[0m
[30;1m472 | [0m[35m        "https://docs.msidlab.com/accounts/confidentialclient.html",[0m
[30;1m473 | [0m[35m        env_client_id, env_name2)[0m
[30;1m474 | [0m[35m    if os.getenv(env_client_id) and os.getenv(env_client_cert_path):[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        duration = 60[0m
[30;1m244 | [0m[35m        logger.info("We will wait up to %d seconds for you to sign in" % duration)[0m
[30;1m245 | [0m[35m        flow["expires_at"] = min(  # Shorten the time for quick test[0m
[30;1m246 | [0m[35m            flow["expires_at"], time.time() + duration)[0m
[30;1m247 | [0m[35m        result = self.app.acquire_token_by_device_flow(flow)[0m
[30;1m248 | [0m[35m        self.assertLoosely(  # It will skip this test if there is no user interaction[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    from dotenv import load_dotenv  # Use this only in local dev machine[0m
[30;1m40 | [0m[35m    load_dotenv()  # take environment variables from .env.[0m
[30;1m41 | [0m[35mexcept ImportError:[0m
[30;1m42 | [0m[35m    logger.warn("Run pip install -r requirements.txt for optional dependency")[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m_PYMSALRUNTIME_INSTALLED = is_pymsalruntime_installed()[0m
[30;1m45 | [0m[35m_AZURE_CLI = "04b07795-8ddb-461a-bbee-02f9e1bf7b46"[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mimport logging[0m
[30;1m15 | [0m[35mimport os[0m
[30;1m16 | [0m[35mimport json[0m
[30;1m17 | [0m[35mimport time[0m
[30;1m18 | [0m[35mimport unittest[0m
[30;1m19 | [0m[35mfrom urllib.parse import urlparse, parse_qs[0m
[30;1m20 | [0m[35mimport sys[0m
[30;1m21 | [0m[35mtry:[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    load_dotenv()  # take environment variables from .env.[0m
[30;1m11 | [0m[35mexcept:[0m
[30;1m12 | [0m[35m    pass[0m
[30;1m13 | [0m[35mimport base64[0m
[30;1m14 | [0m[35mimport logging[0m
[30;1m15 | [0m[35mimport os[0m
[30;1m16 | [0m[35mimport json[0m
[30;1m17 | [0m[35mimport time[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""If the following ENV VAR were available, many end-to-end test cases would run.[0m
[30;1m2 | [0m[35mLAB_OBO_CLIENT_SECRET=...[0m
[30;1m3 | [0m[35mLAB_APP_CLIENT_ID=...[0m
[30;1m4 | [0m[35mLAB_APP_CLIENT_CERT_PFX_PATH=...[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m878 | [0m[35m    def test_msa_pt_app_signin_via_organizations_authority_without_login_hint(self):[0m
[30;1m879 | [0m[35m        """There is/was an upstream bug. See test case full docstring for the details.[0m
[30;1m880 | [0m[35m[0m
[30;1m881 | [0m[35m        When a MSAL-PT flow that account control is launched, user has 2+ AAD accounts in WAM,[0m
[30;1m882 | [0m[35m        selects an AAD account that is NOT the default AAD account from the OS,[0m
[30;1m883 | [0m[35m        it will incorrectly get tokens for default AAD account.[0m
[30;1m884 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m803 | [0m[35m    DATA2 = {"token_type": "ssh-cert", "key_id": "key2", "req_cnf": _JWK2}[0m
[30;1m804 | [0m[35m    _SCOPE_USER = ["https://pas.windows.net/CheckMyAccess/Linux/user_impersonation"][0m
[30;1m805 | [0m[35m    _SCOPE_SP = ["https://pas.windows.net/CheckMyAccess/Linux/.default"][0m
[30;1m806 | [0m[35m    SCOPE = _SCOPE_SP  # Historically there was a separation, at 2021 it is unified[0m
[30;1m807 | [0m[35m[0m
[30;1m808 | [0m[35m    def test_service_principal(self):[0m
[30;1m809 | [0m[35m        self._test_service_principal()[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m764 | [0m[35m            username=lab_user["username"],[0m
[30;1m765 | [0m[35m            lab_name=lab_user["lab_name"],[0m
[30;1m766 | [0m[35m            prompt="none" if msal.application._is_running_in_cloud_shell() else None,[0m
[30;1m767 | [0m[35m            )   # It already tests reading AT from cache, and using RT to refresh[0m
[30;1m768 | [0m[35m                # acquire_token_silent() would work because we pass in the same key[0m
[30;1m769 | [0m[35m        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format([0m
[30;1m770 | [0m[35m            result.get("error"), result.get("error_description")))[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m706 | [0m[35m                config_cca["scope"], account=account, force_refresh=True)[0m
[30;1m707 | [0m[35m            self.assertTrue([0m
[30;1m708 | [0m[35m                result and "access_token" in result,[0m
[30;1m709 | [0m[35m                "CCA should get an AT silently, but we got this instead: {}".format(result))[0m
[30;1m710 | [0m[35m            self.assertNotEqual([0m
[30;1m711 | [0m[35m                result["access_token"], cca_result["access_token"],[0m
[30;1m712 | [0m[35m                "CCA should get a new AT")[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m689 | [0m[35m        #    the RT (if any) for prolonged access even after your own AT expires,[0m
[30;1m690 | [0m[35m        #    now it is the time to persist current cache state for current user.[0m
[30;1m691 | [0m[35m        #    Assuming you already did that (which is not shown in this test case),[0m
[30;1m692 | [0m[35m        #    the following part shows one of the ways to obtain an AT from cache.[0m
[30;1m693 | [0m[35m        username = cca_result.get("id_token_claims", {}).get("preferred_username")[0m
[30;1m694 | [0m[35m        accounts = cca.get_accounts(username=username)[0m
[30;1m695 | [0m[35m        if username is not None:  # It means CCA have requested an IDT w/ "profile" scope[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m686 | [0m[35m[0m
[30;1m687 | [0m[35m        # 3. Now the OBO app can simply store downstream token(s) in same session.[0m
[30;1m688 | [0m[35m        #    Alternatively, if you want to persist the downstream AT, and possibly[0m
[30;1m689 | [0m[35m        #    the RT (if any) for prolonged access even after your own AT expires,[0m
[30;1m690 | [0m[35m        #    now it is the time to persist current cache state for current user.[0m
[30;1m691 | [0m[35m        #    Assuming you already did that (which is not shown in this test case),[0m
[30;1m692 | [0m[35m        #    the following part shows one of the ways to obtain an AT from cache.[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m468 | [0m[35m    Get it from environment variables if defined, otherwise fall back to use MSI.[0m
[30;1m469 | [0m[35m    """[0m
[30;1m470 | [0m[35m    logger.info([0m
[30;1m471 | [0m[35m        "Reading ENV variables %s and %s for lab app defined at "[0m
[30;1m472 | [0m[35m        "https://docs.msidlab.com/accounts/confidentialclient.html",[0m
[30;1m473 | [0m[35m        env_client_id, env_name2)[0m
[30;1m474 | [0m[35m    if os.getenv(env_client_id) and os.getenv(env_client_cert_path):[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m160 | [0m[35m        self.assertIsNone([0m
[30;1m161 | [0m[35m            self.app.acquire_token_silent(scope, account=None),[0m
[30;1m162 | [0m[35m            "acquire_token_silent(..., account=None) shall always return None")[0m
[30;1m163 | [0m[35m        # Going to test acquire_token_for_client(...) to locate an AT from cache[0m
[30;1m164 | [0m[35m        silent_result = self.app.acquire_token_for_client(scope)[0m
[30;1m165 | [0m[35m        self.assertIsNotNone(silent_result)[0m
[30;1m166 | [0m[35m        self.assertEqual(self.app._TOKEN_SOURCE_CACHE, silent_result[self.app._TOKEN_SOURCE])[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m            self.assertEqual([0m
[30;1m145 | [0m[35m                # We used to assert it this way:[0m
[30;1m146 | [0m[35m                #   result_from_wire['access_token'] != silent_result['access_token'][0m
[30;1m147 | [0m[35m                # but ROPC in B2C tends to return the same AT we obtained seconds ago.[0m
[30;1m148 | [0m[35m                # Now looking back, "refresh_token grant would return a brand new AT"[0m
[30;1m149 | [0m[35m                # was just an empirical observation but never a commitment in specs,[0m
[30;1m150 | [0m[35m                # so we adjust our way to assert here.[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        if "refresh_token" in result_from_wire:[0m
[30;1m137 | [0m[35m            assert auth_scheme is None[0m
[30;1m138 | [0m[35m            # Going to test acquire_token_silent(...) to obtain an AT by a RT from cache[0m
[30;1m139 | [0m[35m            self.app.token_cache._cache["AccessToken"] = {}  # A hacky way to clear ATs[0m
[30;1m140 | [0m[35m            silent_result = self.app.acquire_token_silent([0m
[30;1m141 | [0m[35m                scope, account=account, data=data or {})[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_e2e.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m                or  # Authority server could return different set of scopes[0m
[30;1m121 | [0m[35m                set(scope) <= set(result_from_wire["scope"].split(" "))[0m
[30;1m122 | [0m[35m                ):[0m
[30;1m123 | [0m[35m            # Going to test acquire_token_silent(...) to locate an AT from cache[0m
[30;1m124 | [0m[35m            silent_result = self.app.acquire_token_silent([0m
[30;1m125 | [0m[35m                scope, account=account, data=data or {}, auth_scheme=auth_scheme)[0m
[30;1m126 | [0m[35m            self.assertIsNotNone(silent_result)[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_individual_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    def test_should_disallow_accessing_reserved_keyword(self):[0m
[30;1m14 | [0m[35m        with self.assertRaises(ValueError):[0m
[30;1m15 | [0m[35m            self.m.get(ExpiringMapping._INDEX)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def test_setitem(self):[0m
[30;1m18 | [0m[35m        self.assertEqual(0, len(self.m))[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_individual_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom time import sleep[0m
[30;1m2 | [0m[35mfrom random import random[0m
[30;1m3 | [0m[35mimport unittest[0m
[30;1m4 | [0m[35mfrom msal.individual_cache import _ExpiringMapping as ExpiringMapping[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m   else:[0m
[30;1m131 | [0m[35m       print(result.get("error"))[0m
[30;1m132 | [0m[35m       print(result.get("error_description"))[0m
[30;1m133 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m134 | [0m[35m   ```[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35mRefer the [Wiki](https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki) pages [0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m       print(result["access_token"])  # Yay![0m
[30;1m130 | [0m[35m   else:[0m
[30;1m131 | [0m[35m       print(result.get("error"))[0m
[30;1m132 | [0m[35m       print(result.get("error_description"))[0m
[30;1m133 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m134 | [0m[35m   ```[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m   if "access_token" in result:[0m
[30;1m129 | [0m[35m       print(result["access_token"])  # Yay![0m
[30;1m130 | [0m[35m   else:[0m
[30;1m131 | [0m[35m       print(result.get("error"))[0m
[30;1m132 | [0m[35m       print(result.get("error_description"))[0m
[30;1m133 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m134 | [0m[35m   ```[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mst Q&A on Stack Overflow for MSAL:[0m
[30;1m  | [0m[35m[http://stackoverflow.com/questions/tagged/msal](http://stackoverflow.com/questions/tagged/msal)[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m## Submit Feedback[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mWe'd like your thoughts on this library. Please complete [this short survey.](https://forms.office.c[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m## Security Reporting[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m   ```[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m3. Either there is no suitable token in the cache, or you chose to skip the previous step,[0m
[30;1m121 | [0m[35m   now it is time to actually send a request to AAD to obtain a token.[0m
[30;1m122 | [0m[35m   There are different methods based on your client type and scenario. Here we demonstrate a placeho[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m   ```python[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m           print(a["username"])[0m
[30;1m114 | [0m[35m       # Assuming the end user chose this one[0m
[30;1m115 | [0m[35m       chosen = accounts[0][0m
[30;1m116 | [0m[35m       # Now let's try to find a token in cache for this account[0m
[30;1m117 | [0m[35m       result = app.acquire_token_silent(["your_scope"], account=chosen)[0m
[30;1m118 | [0m[35m   ```[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m       authority="https://login.microsoftonline.com/Enter_the_Tenant_Name_Here")[0m
[30;1m94 | [0m[35m   ```[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m   Later, each time you would want an access token, you start by:[0m
[30;1m97 | [0m[35m   ```python[0m
[30;1m98 | [0m[35m   result = None  # It is just an initial value. Please follow instructions below.[0m
[30;1m99 | [0m[35m   ```[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mThis library follows [Semantic Versioning](http://semver.org/).[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mYou can find the changes for each version under[0m
[30;1m70 | [0m[35m[Releases](https://github.com/AzureAD/microsoft-authentication-library-for-python/releases).[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m## Usage[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35mYou can find MSAL Python on [Pypi](https://pypi.org/project/msal/).[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m1. If you haven't already, [install and/or upgrade the pip](https://pip.pypa.io/en/stable/installing[0m
[30;1m62 | [0m[35m   of your Python environment to a recent version. We tested with pip 18.1.[0m
[30;1m63 | [0m[35m1. As usual, just run `pip install msal`.[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m## Versions[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m## Installation[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mYou can find MSAL Python on [Pypi](https://pypi.org/project/msal/).[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m1. If you haven't already, [install and/or upgrade the pip](https://pip.pypa.io/en/stable/installing[0m
[30;1m62 | [0m[35m   of your Python environment to a recent version. We tested with pip 18.1.[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m## Migrating from ADAL[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35mIf your application is using ADAL Python, we recommend you to update to use MSAL Python. No new feat[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35mSee the [ADAL to MSAL migration](https://github.com/AzureAD/microsoft-authentication-library-for-pyt[0m
[30;1m143 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m98 | [0m[35m   result = None  # It is just an initial value. Please follow instructions below.[0m
[30;1m99 | [0m[35m   ```[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m2. The API model in MSAL provides you explicit control on how to utilize token cache.[0m
[30;1m102 | [0m[35m   This cache part is technically optional, but we highly recommend you to harness the power of MSAL[0m
[30;1m103 | [0m[35m   It will automatically handle the token refresh for you.[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_authcode.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m                1,  # Delay it until the receiver is activated by get_auth_response()[0m
[30;1m32 | [0m[35m                lambda: self.assertEqual([0m
[30;1m33 | [0m[35m                    "<html>&lt;tag&gt;foo&lt;/tag&gt;</html>",[0m
[30;1m34 | [0m[35m                    requests.get("http://localhost:{}?error=<tag>foo</tag>".format([0m
[30;1m35 | [0m[35m                        receiver.get_port())).text,[0m
[30;1m36 | [0m[35m                    "Unsafe data in HTML should be escaped",[0m
[30;1m37 | [0m[35m            ))][0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m                        receiver.get_port())).text,[0m
[30;1m36 | [0m[35m                    "Unsafe data in HTML should be escaped",[0m
[30;1m37 | [0m[35m            ))][0m
[30;1m38 | [0m[35m            receiver.get_auth_response(  # Starts server and hang until timeout[0m
[30;1m39 | [0m[35m                timeout=3,[0m
[30;1m40 | [0m[35m                error_template="<html>$error</html>",[0m
[30;1m41 | [0m[35m            )[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    def test_signin_silently(self):[0m
[30;1m66 | [0m[35m        result = _signin_silently(self._authority, self._client_id, self._scopes)[0m
[30;1m67 | [0m[35m        self.assertIsNotNone(result.get("access_token"), result)[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        print("An account picker UI will pop up. See whether the auth result matches your account")[0m
[30;1m58 | [0m[35m        result = _signin_interactively([0m
[30;1m59 | [0m[35m            self._authority, self._client_id, self._scopes, None, prompt="select_account")[0m
[30;1m60 | [0m[35m        self.assertIsNotNone(result.get("access_token"), result)[0m
[30;1m61 | [0m[35m        if "access_token" in result:[0m
[30;1m62 | [0m[35m            result["access_token"] = "********"[0m
[30;1m63 | [0m[35m        import pprint; pprint.pprint(result)[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        self.assertIsNotNone(account, msg="pymsalruntime still has this account")[0m
[30;1m39 | [0m[35m        result = _acquire_token_silently([0m
[30;1m40 | [0m[35m                self._authority, self._client_id, account_id, self._scopes)[0m
[30;1m41 | [0m[35m        self.assertIn("Status_AccountUnusable", result.get("error_description", ""))[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    def test_unconfigured_app_should_raise_exception(self):[0m
[30;1m44 | [0m[35m        self.skipTest([0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        self.assertIsNotNone(_read_account_by_id(account_id, "correlation_id"))[0m
[30;1m31 | [0m[35m        result = _acquire_token_silently([0m
[30;1m32 | [0m[35m                self._authority, self._client_id, account_id, self._scopes)[0m
[30;1m33 | [0m[35m        self.assertIsNotNone(result.get("access_token"), result)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        signout_error = _signout_silently(self._client_id, account_id)[0m
[30;1m36 | [0m[35m        self.assertIsNone(signout_error, msg=signout_error)[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    def test_signin_interactive_then_acquire_token_silent_then_signout(self):[0m
[30;1m26 | [0m[35m        result = _signin_interactively(self._authority, self._client_id, self._scopes, None)[0m
[30;1m27 | [0m[35m        self.assertIsNotNone(result.get("access_token"), result)[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m        account_id = result["_account_id"][0m
[30;1m30 | [0m[35m        self.assertIsNotNone(_read_account_by_id(account_id, "correlation_id"))[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m            app.acquire_token_by_username_password(username, "password", ["scope"])[0m
[30;1m69 | [0m[35m            self.assertEqual([0m
[30;1m70 | [0m[35m                "upn:" + username,[0m
[30;1m71 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m
[30;1m72 | [0m[35m                "CSS routing info should be derived from client_info")[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m            app.acquire_token_by_username_password(username, "password", ["scope"])[0m
[30;1m69 | [0m[35m            self.assertEqual([0m
[30;1m70 | [0m[35m                "upn:" + username,[0m
[30;1m71 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m
[30;1m72 | [0m[35m                "CSS routing info should be derived from client_info")[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m            self.assertEqual([0m
[30;1m58 | [0m[35m                "Oid:{}@{}".format(  # Server accepts case-insensitive value[0m
[30;1m59 | [0m[35m                    uid, utid),  # It would look like "Oid:foo@bar"[0m
[30;1m60 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m
[30;1m61 | [0m[35m                "CSS routing info should be derived from home_account_id")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def test_acquire_token_by_username_password(self):[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m            self.assertEqual([0m
[30;1m58 | [0m[35m                "Oid:{}@{}".format(  # Server accepts case-insensitive value[0m
[30;1m59 | [0m[35m                    uid, utid),  # It would look like "Oid:foo@bar"[0m
[30;1m60 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m
[30;1m61 | [0m[35m                "CSS routing info should be derived from home_account_id")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def test_acquire_token_by_username_password(self):[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m                })[0m
[30;1m28 | [0m[35m            self.assertEqual([0m
[30;1m29 | [0m[35m                "Oid:aa905949-a2b8-4e0a-8aea-b32e53ccdb41@72f988bf-86f1-41af-91ab-2d7cd011db47",[0m
[30;1m30 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m
[30;1m31 | [0m[35m                "CSS routing info should be derived from client_info")[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # I've manually tested acquire_token_interactive. No need to automate it,[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m                })[0m
[30;1m28 | [0m[35m            self.assertEqual([0m
[30;1m29 | [0m[35m                "Oid:aa905949-a2b8-4e0a-8aea-b32e53ccdb41@72f988bf-86f1-41af-91ab-2d7cd011db47",[0m
[30;1m30 | [0m[35m                mocked_method.call_args[1].get("headers", {}).get('X-AnchorMailbox'),[0m
[30;1m31 | [0m[35m                "CSS routing info should be derived from client_info")[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # I've manually tested acquire_token_interactive. No need to automate it,[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_ccs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m45 | [0m[35m            "scope": scopes,[0m
[30;1m46 | [0m[35m            "token_endpoint": "{}/oauth2/v2.0/token".format(authority_url),[0m
[30;1m47 | [0m[35m            "response": build_response([0m
[30;1m48 | [0m[35m                access_token="an expired AT to trigger refresh", expires_in=-99,[0m
[30;1m49 | [0m[35m                uid=uid, utid=utid, refresh_token="this is a RT"),[0m
[30;1m50 | [0m[35m            })  # The add(...) helper populates correct home_account_id for future searching[0m
[30;1m51 | [0m[35m        app = msal.ClientApplication([0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m   else:[0m
[30;1m131 | [0m[35m       print(result.get("error"))[0m
[30;1m132 | [0m[35m       print(result.get("error_description"))[0m
[30;1m133 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m134 | [0m[35m   ```[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35mRefer the [Wiki](https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki) pages [0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m       print(result["access_token"])  # Yay![0m
[30;1m130 | [0m[35m   else:[0m
[30;1m131 | [0m[35m       print(result.get("error"))[0m
[30;1m132 | [0m[35m       print(result.get("error_description"))[0m
[30;1m133 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m134 | [0m[35m   ```[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m   if "access_token" in result:[0m
[30;1m129 | [0m[35m       print(result["access_token"])  # Yay![0m
[30;1m130 | [0m[35m   else:[0m
[30;1m131 | [0m[35m       print(result.get("error"))[0m
[30;1m132 | [0m[35m       print(result.get("error_description"))[0m
[30;1m133 | [0m[35m       print(result.get("correlation_id"))  # You may need this when reporting a bug[0m
[30;1m134 | [0m[35m   ```[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m## Migrating from ADAL[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35mIf your application is using ADAL Python, we recommend you to update to use MSAL Python. No new feat[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35mSee the [ADAL to MSAL migration](https://github.com/AzureAD/microsoft-authentication-library-for-pyt[0m
[30;1m143 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m98 | [0m[35m   result = None  # It is just an initial value. Please follow instructions below.[0m
[30;1m99 | [0m[35m   ```[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m2. The API model in MSAL provides you explicit control on how to utilize token cache.[0m
[30;1m102 | [0m[35m   This cache part is technically optional, but we highly recommend you to harness the power of MSAL[0m
[30;1m103 | [0m[35m   It will automatically handle the token refresh for you.[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mst Q&A on Stack Overflow for MSAL:[0m
[30;1m  | [0m[35m[http://stackoverflow.com/questions/tagged/msal](http://stackoverflow.com/questions/tagged/msal)[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m## Submit Feedback[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mWe'd like your thoughts on this library. Please complete [this short survey.](https://forms.office.c[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m## Security Reporting[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m   ```[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m3. Either there is no suitable token in the cache, or you chose to skip the previous step,[0m
[30;1m121 | [0m[35m   now it is time to actually send a request to AAD to obtain a token.[0m
[30;1m122 | [0m[35m   There are different methods based on your client type and scenario. Here we demonstrate a placeho[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m   ```python[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m           print(a["username"])[0m
[30;1m114 | [0m[35m       # Assuming the end user chose this one[0m
[30;1m115 | [0m[35m       chosen = accounts[0][0m
[30;1m116 | [0m[35m       # Now let's try to find a token in cache for this account[0m
[30;1m117 | [0m[35m       result = app.acquire_token_silent(["your_scope"], account=chosen)[0m
[30;1m118 | [0m[35m   ```[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m       authority="https://login.microsoftonline.com/Enter_the_Tenant_Name_Here")[0m
[30;1m94 | [0m[35m   ```[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m   Later, each time you would want an access token, you start by:[0m
[30;1m97 | [0m[35m   ```python[0m
[30;1m98 | [0m[35m   result = None  # It is just an initial value. Please follow instructions below.[0m
[30;1m99 | [0m[35m   ```[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mThis library follows [Semantic Versioning](http://semver.org/).[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mYou can find the changes for each version under[0m
[30;1m70 | [0m[35m[Releases](https://github.com/AzureAD/microsoft-authentication-library-for-python/releases).[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m## Usage[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35mYou can find MSAL Python on [Pypi](https://pypi.org/project/msal/).[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m1. If you haven't already, [install and/or upgrade the pip](https://pip.pypa.io/en/stable/installing[0m
[30;1m62 | [0m[35m   of your Python environment to a recent version. We tested with pip 18.1.[0m
[30;1m63 | [0m[35m1. As usual, just run `pip install msal`.[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m## Versions[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m## Installation[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mYou can find MSAL Python on [Pypi](https://pypi.org/project/msal/).[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m1. If you haven't already, [install and/or upgrade the pip](https://pip.pypa.io/en/stable/installing[0m
[30;1m62 | [0m[35m   of your Python environment to a recent version. We tested with pip 18.1.[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m858 | [0m[35m            or :attr:`GRANT_TYPE_JWT`, the only two profiles defined in RFC 7521.[0m
[30;1m859 | [0m[35m        :param scope: Optional. It must be a subset of previously granted scopes.[0m
[30;1m860 | [0m[35m        """[0m
[30;1m861 | [0m[35m        encoder = self.grant_assertion_encoders.get(grant_type, lambda a: a)[0m
[30;1m862 | [0m[35m        data = kwargs.pop("data", {})[0m
[30;1m863 | [0m[35m        data.update(scope=scope, assertion=encoder(assertion))[0m
[30;1m864 | [0m[35m        return self._obtain_token(grant_type, data=data, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m838 | [0m[35m            scope=scope,[0m
[30;1m839 | [0m[35m            also_save_rt=on_updating_rt is False,[0m
[30;1m840 | [0m[35m            **kwargs)[0m
[30;1m841 | [0m[35m        if resp.get('error') == 'invalid_grant':[0m
[30;1m842 | [0m[35m            (on_removing_rt or self.on_removing_rt)(token_item)  # Discard old RT[0m
[30;1m843 | [0m[35m        RT = "refresh_token"[0m
[30;1m844 | [0m[35m        if on_updating_rt is not False and RT in resp:[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m789 | [0m[35m                # Note: The scope will generally be absent in authorization grant,[0m
[30;1m790 | [0m[35m                #       but our obtain_token_by_authorization_code(...) encourages[0m
[30;1m791 | [0m[35m                #       app developer to still explicitly provide a scope here.[0m
[30;1m792 | [0m[35m                scope = _data.get("scope")[0m
[30;1m793 | [0m[35m            (on_obtaining_tokens or self.on_obtaining_tokens)({[0m
[30;1m794 | [0m[35m                "client_id": self.client_id,[0m
[30;1m795 | [0m[35m                "scope": scope,[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m694 | [0m[35m            "Use obtain_token_by_auth_code_flow() instead", DeprecationWarning)[0m
[30;1m695 | [0m[35m        if not isinstance(params, dict):[0m
[30;1m696 | [0m[35m            params = parse_qs(params)[0m
[30;1m697 | [0m[35m        if params.get('state') != state:[0m
[30;1m698 | [0m[35m            raise ValueError('state mismatch')[0m
[30;1m699 | [0m[35m        return params[0m
[30;1m700 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m567 | [0m[35m            error = {"error": auth_response["error"]}[0m
[30;1m568 | [0m[35m            if auth_response.get("error_description"):[0m
[30;1m569 | [0m[35m                error["error_description"] = auth_response["error_description"][0m
[30;1m570 | [0m[35m            if auth_response.get("error_uri"):[0m
[30;1m571 | [0m[35m                error["error_uri"] = auth_response["error_uri"][0m
[30;1m572 | [0m[35m            return error[0m
[30;1m573 | [0m[35m        raise ValueError('auth_response must contain either "code" or "error"')[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m            # Here we do NOT return original auth_response as-is, to prevent a[0m
[30;1m566 | [0m[35m            # potential {..., "access_token": "attacker's AT"} input being leaked[0m
[30;1m567 | [0m[35m            error = {"error": auth_response["error"]}[0m
[30;1m568 | [0m[35m            if auth_response.get("error_description"):[0m
[30;1m569 | [0m[35m                error["error_description"] = auth_response["error_description"][0m
[30;1m570 | [0m[35m            if auth_response.get("error_uri"):[0m
[30;1m571 | [0m[35m                error["error_uri"] = auth_response["error_uri"][0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m561 | [0m[35m                    code_verifier=auth_code_flow["code_verifier"],[0m
[30;1m562 | [0m[35m                    ),[0m
[30;1m563 | [0m[35m                **kwargs)[0m
[30;1m564 | [0m[35m        if auth_response.get("error"):  # It means the first leg encountered error[0m
[30;1m565 | [0m[35m            # Here we do NOT return original auth_response as-is, to prevent a[0m
[30;1m566 | [0m[35m            # potential {..., "access_token": "attacker's AT"} input being leaked[0m
[30;1m567 | [0m[35m            error = {"error": auth_response["error"]}[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m552 | [0m[35m                redirect_uri=auth_code_flow.get("redirect_uri"),[0m
[30;1m553 | [0m[35m                    # Required, if "redirect_uri" parameter was included in the[0m
[30;1m554 | [0m[35m                    # authorization request, and their values MUST be identical.[0m
[30;1m555 | [0m[35m                scope=scope or auth_code_flow.get("scope"),[0m
[30;1m556 | [0m[35m                    # It is both unnecessary and harmless, per RFC 6749.[0m
[30;1m557 | [0m[35m                    # We use the same scope already used in auth request uri,[0m
[30;1m558 | [0m[35m                    # thus token cache can know what scope the tokens are for.[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m549 | [0m[35m        if auth_response.get("code"):  # i.e. the first leg was successful[0m
[30;1m550 | [0m[35m            return self._obtain_token_by_authorization_code([0m
[30;1m551 | [0m[35m                auth_response["code"],[0m
[30;1m552 | [0m[35m                redirect_uri=auth_code_flow.get("redirect_uri"),[0m
[30;1m553 | [0m[35m                    # Required, if "redirect_uri" parameter was included in the[0m
[30;1m554 | [0m[35m                    # authorization request, and their values MUST be identical.[0m
[30;1m555 | [0m[35m                scope=scope or auth_code_flow.get("scope"),[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m        if scope and set(scope) - set(auth_code_flow.get("scope", [])):[0m
[30;1m547 | [0m[35m            raise ValueError([0m
[30;1m548 | [0m[35m                "scope must be None or a subset of %s" % auth_code_flow.get("scope"))[0m
[30;1m549 | [0m[35m        if auth_response.get("code"):  # i.e. the first leg was successful[0m
[30;1m550 | [0m[35m            return self._obtain_token_by_authorization_code([0m
[30;1m551 | [0m[35m                auth_response["code"],[0m
[30;1m552 | [0m[35m                redirect_uri=auth_code_flow.get("redirect_uri"),[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m545 | [0m[35m                auth_code_flow.get("state"), auth_response.get("state")))[0m
[30;1m546 | [0m[35m        if scope and set(scope) - set(auth_code_flow.get("scope", [])):[0m
[30;1m547 | [0m[35m            raise ValueError([0m
[30;1m548 | [0m[35m                "scope must be None or a subset of %s" % auth_code_flow.get("scope"))[0m
[30;1m549 | [0m[35m        if auth_response.get("code"):  # i.e. the first leg was successful[0m
[30;1m550 | [0m[35m            return self._obtain_token_by_authorization_code([0m
[30;1m551 | [0m[35m                auth_response["code"],[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m543 | [0m[35m        if auth_code_flow.get("state") != auth_response.get("state"):[0m
[30;1m544 | [0m[35m            raise ValueError("state mismatch: {} vs {}".format([0m
[30;1m545 | [0m[35m                auth_code_flow.get("state"), auth_response.get("state")))[0m
[30;1m546 | [0m[35m        if scope and set(scope) - set(auth_code_flow.get("scope", [])):[0m
[30;1m547 | [0m[35m            raise ValueError([0m
[30;1m548 | [0m[35m                "scope must be None or a subset of %s" % auth_code_flow.get("scope"))[0m
[30;1m549 | [0m[35m        if auth_response.get("code"):  # i.e. the first leg was successful[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m            raise ValueError("state missing from auth_code_flow")[0m
[30;1m543 | [0m[35m        if auth_code_flow.get("state") != auth_response.get("state"):[0m
[30;1m544 | [0m[35m            raise ValueError("state mismatch: {} vs {}".format([0m
[30;1m545 | [0m[35m                auth_code_flow.get("state"), auth_response.get("state")))[0m
[30;1m546 | [0m[35m        if scope and set(scope) - set(auth_code_flow.get("scope", [])):[0m
[30;1m547 | [0m[35m            raise ValueError([0m
[30;1m548 | [0m[35m                "scope must be None or a subset of %s" % auth_code_flow.get("scope"))[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m            raise ValueError("state missing from auth_code_flow")[0m
[30;1m543 | [0m[35m        if auth_code_flow.get("state") != auth_response.get("state"):[0m
[30;1m544 | [0m[35m            raise ValueError("state mismatch: {} vs {}".format([0m
[30;1m545 | [0m[35m                auth_code_flow.get("state"), auth_response.get("state")))[0m
[30;1m546 | [0m[35m        if scope and set(scope) - set(auth_code_flow.get("scope", [])):[0m
[30;1m547 | [0m[35m            raise ValueError([0m
[30;1m548 | [0m[35m                "scope must be None or a subset of %s" % auth_code_flow.get("scope"))[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m540 | [0m[35m            # obtain_token_by_auth_code_flow(session.get("flow", {}), auth_resp)[0m
[30;1m541 | [0m[35m            # which further simplifies their usage.[0m
[30;1m542 | [0m[35m            raise ValueError("state missing from auth_code_flow")[0m
[30;1m543 | [0m[35m        if auth_code_flow.get("state") != auth_response.get("state"):[0m
[30;1m544 | [0m[35m            raise ValueError("state mismatch: {} vs {}".format([0m
[30;1m545 | [0m[35m                auth_code_flow.get("state"), auth_response.get("state")))[0m
[30;1m546 | [0m[35m        if scope and set(scope) - set(auth_code_flow.get("scope", [])):[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m540 | [0m[35m            # obtain_token_by_auth_code_flow(session.get("flow", {}), auth_resp)[0m
[30;1m541 | [0m[35m            # which further simplifies their usage.[0m
[30;1m542 | [0m[35m            raise ValueError("state missing from auth_code_flow")[0m
[30;1m543 | [0m[35m        if auth_code_flow.get("state") != auth_response.get("state"):[0m
[30;1m544 | [0m[35m            raise ValueError("state mismatch: {} vs {}".format([0m
[30;1m545 | [0m[35m                auth_code_flow.get("state"), auth_response.get("state")))[0m
[30;1m546 | [0m[35m        if scope and set(scope) - set(auth_code_flow.get("scope", [])):[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m537 | [0m[35m        if not auth_code_flow.get("state"):[0m
[30;1m538 | [0m[35m            # initiate_auth_code_flow() already guarantees a state to be available.[0m
[30;1m539 | [0m[35m            # This check will also allow a web app to blindly call this method with[0m
[30;1m540 | [0m[35m            # obtain_token_by_auth_code_flow(session.get("flow", {}), auth_resp)[0m
[30;1m541 | [0m[35m            # which further simplifies their usage.[0m
[30;1m542 | [0m[35m            raise ValueError("state missing from auth_code_flow")[0m
[30;1m543 | [0m[35m        if auth_code_flow.get("state") != auth_response.get("state"):[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m        """[0m
[30;1m535 | [0m[35m        assert isinstance(auth_code_flow, dict) and isinstance(auth_response, dict)[0m
[30;1m536 | [0m[35m            # This is app developer's error which we do NOT want to map to ValueError[0m
[30;1m537 | [0m[35m        if not auth_code_flow.get("state"):[0m
[30;1m538 | [0m[35m            # initiate_auth_code_flow() already guarantees a state to be available.[0m
[30;1m539 | [0m[35m            # This check will also allow a web app to blindly call this method with[0m
[30;1m540 | [0m[35m            # obtain_token_by_auth_code_flow(session.get("flow", {}), auth_resp)[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m524 | [0m[35m                def authorize():  # A controller in a web app[0m
[30;1m525 | [0m[35m                    try:[0m
[30;1m526 | [0m[35m                        result = client.obtain_token_by_auth_code_flow([0m
[30;1m527 | [0m[35m                            session.get("flow", {}), auth_resp)[0m
[30;1m528 | [0m[35m                        if "error" in result:[0m
[30;1m529 | [0m[35m                            return render_template("error.html", result)[0m
[30;1m530 | [0m[35m                        store_tokens()[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m            result = self._obtain_token_by_device_flow(flow, **kwargs)[0m
[30;1m387 | [0m[35m            if result.get("error") not in self.DEVICE_FLOW_RETRIABLE_ERRORS:[0m
[30;1m388 | [0m[35m                return result[0m
[30;1m389 | [0m[35m            for i in range(flow.get("interval", 5)):  # Wait interval seconds[0m
[30;1m390 | [0m[35m                if exit_condition(flow):[0m
[30;1m391 | [0m[35m                    return result[0m
[30;1m392 | [0m[35m                time.sleep(1)  # Shorten each round, to make exit more responsive[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        """[0m
[30;1m385 | [0m[35m        while True:[0m
[30;1m386 | [0m[35m            result = self._obtain_token_by_device_flow(flow, **kwargs)[0m
[30;1m387 | [0m[35m            if result.get("error") not in self.DEVICE_FLOW_RETRIABLE_ERRORS:[0m
[30;1m388 | [0m[35m                return result[0m
[30;1m389 | [0m[35m            for i in range(flow.get("interval", 5)):  # Wait interval seconds[0m
[30;1m390 | [0m[35m                if exit_condition(flow):[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m    def obtain_token_by_device_flow(self,[0m
[30;1m357 | [0m[35m            flow,[0m
[30;1m358 | [0m[35m            exit_condition=lambda flow: flow.get("expires_at", 0) < time.time(),[0m
[30;1m359 | [0m[35m            **kwargs):[0m
[30;1m360 | [0m[35m        # type: (dict, Callable) -> dict[0m
[30;1m361 | [0m[35m        """Obtain token by a device flow object, with customizable polling effect.[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m            self.DEVICE_FLOW["GRANT_TYPE"], data=data, **kwargs)[0m
[30;1m350 | [0m[35m        if result.get("error") == "slow_down":[0m
[30;1m351 | [0m[35m            # Respecting https://tools.ietf.org/html/draft-ietf-oauth-device-flow-12#section-3.5[0m
[30;1m352 | [0m[35m            flow["interval"] = flow.get("interval", 5) + 5[0m
[30;1m353 | [0m[35m        flow["latest_attempt_at"] = now[0m
[30;1m354 | [0m[35m        return result[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m            })[0m
[30;1m348 | [0m[35m        result = self._obtain_token([0m
[30;1m349 | [0m[35m            self.DEVICE_FLOW["GRANT_TYPE"], data=data, **kwargs)[0m
[30;1m350 | [0m[35m        if result.get("error") == "slow_down":[0m
[30;1m351 | [0m[35m            # Respecting https://tools.ietf.org/html/draft-ietf-oauth-device-flow-12#section-3.5[0m
[30;1m352 | [0m[35m            flow["interval"] = flow.get("interval", 5) + 5[0m
[30;1m353 | [0m[35m        flow["latest_attempt_at"] = now[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m        # This method updates flow during each run. And it is non-blocking.[0m
[30;1m339 | [0m[35m        now = time.time()[0m
[30;1m340 | [0m[35m        skew = 1[0m
[30;1m341 | [0m[35m        if flow.get("latest_attempt_at", 0) + flow.get("interval", 5) - skew > now:[0m
[30;1m342 | [0m[35m            warnings.warn('Attempted too soon. Please do time.sleep(flow["interval"])')[0m
[30;1m343 | [0m[35m        data = kwargs.pop("data", {})[0m
[30;1m344 | [0m[35m        data.update({[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m        # This method updates flow during each run. And it is non-blocking.[0m
[30;1m339 | [0m[35m        now = time.time()[0m
[30;1m340 | [0m[35m        skew = 1[0m
[30;1m341 | [0m[35m        if flow.get("latest_attempt_at", 0) + flow.get("interval", 5) - skew > now:[0m
[30;1m342 | [0m[35m            warnings.warn('Attempted too soon. Please do time.sleep(flow["interval"])')[0m
[30;1m343 | [0m[35m        data = kwargs.pop("data", {})[0m
[30;1m344 | [0m[35m        data.update({[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m            **kwargs)[0m
[30;1m330 | [0m[35m        flow = json.loads(resp.text)[0m
[30;1m331 | [0m[35m        flow["interval"] = int(flow.get("interval", 5))  # Some IdP returns string[0m
[30;1m332 | [0m[35m        flow["expires_in"] = int(flow.get("expires_in", 1800))[0m
[30;1m333 | [0m[35m        flow["expires_at"] = time.time() + flow["expires_in"]  # We invent this[0m
[30;1m334 | [0m[35m        return flow[0m
[30;1m335 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m            headers=dict(self.default_headers, **kwargs.pop("headers", {})),[0m
[30;1m329 | [0m[35m            **kwargs)[0m
[30;1m330 | [0m[35m        flow = json.loads(resp.text)[0m
[30;1m331 | [0m[35m        flow["interval"] = int(flow.get("interval", 5))  # Some IdP returns string[0m
[30;1m332 | [0m[35m        flow["expires_in"] = int(flow.get("expires_in", 1800))[0m
[30;1m333 | [0m[35m        flow["expires_at"] = time.time() + flow["expires_in"]  # We invent this[0m
[30;1m334 | [0m[35m        return flow[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m323 | [0m[35m        DAE = "device_authorization_endpoint"[0m
[30;1m324 | [0m[35m        if not self.configuration.get(DAE):[0m
[30;1m325 | [0m[35m            raise ValueError("You need to provide device authorization endpoint")[0m
[30;1m326 | [0m[35m        resp = self._http_client.post(self.configuration[DAE],[0m
[30;1m327 | [0m[35m            data={"client_id": self.client_id, "scope": self._stringify(scope or [])},[0m
[30;1m328 | [0m[35m            headers=dict(self.default_headers, **kwargs.pop("headers", {})),[0m
[30;1m329 | [0m[35m            **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m        https://tools.ietf.org/html/draft-ietf-oauth-device-flow-12#section-3.3.1[0m
[30;1m322 | [0m[35m        """[0m
[30;1m323 | [0m[35m        DAE = "device_authorization_endpoint"[0m
[30;1m324 | [0m[35m        if not self.configuration.get(DAE):[0m
[30;1m325 | [0m[35m            raise ValueError("You need to provide device authorization endpoint")[0m
[30;1m326 | [0m[35m        resp = self._http_client.post(self.configuration[DAE],[0m
[30;1m327 | [0m[35m            data={"client_id": self.client_id, "scope": self._stringify(scope or [])},[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        _data.update(data or {})  # So the content in data param prevails[0m
[30;1m209 | [0m[35m        _data = {k: v for k, v in _data.items() if v}  # Clean up None values[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        if _data.get('scope'):[0m
[30;1m212 | [0m[35m            _data['scope'] = self._stringify(_data['scope'])[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        _headers = {'Accept': 'application/json'}[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m        if self.default_body.get("client_assertion_type") and self.client_assertion:[0m
[30;1m198 | [0m[35m            # See https://tools.ietf.org/html/rfc7521#section-4.2[0m
[30;1m199 | [0m[35m            encoder = self.client_assertion_encoders.get([0m
[30;1m200 | [0m[35m                    self.default_body["client_assertion_type"], lambda a: a)[0m
[30;1m201 | [0m[35m            _data["client_assertion"] = encoder([0m
[30;1m202 | [0m[35m                self.client_assertion()  # Do lazy on-the-fly computation[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m            ):  # Returns the json object came from the OAUTH2 response[0m
[30;1m195 | [0m[35m        _data = {'client_id': self.client_id, 'grant_type': grant_type}[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m        if self.default_body.get("client_assertion_type") and self.client_assertion:[0m
[30;1m198 | [0m[35m            # See https://tools.ietf.org/html/rfc7521#section-4.2[0m
[30;1m199 | [0m[35m            encoder = self.client_assertion_encoders.get([0m
[30;1m200 | [0m[35m                    self.default_body["client_assertion_type"], lambda a: a)[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m            params=None,  # a dict to be sent as query string to the endpoint[0m
[30;1m188 | [0m[35m            data=None,  # All relevant data, which will go into the http body[0m
[30;1m189 | [0m[35m            headers=None,  # a dict to be sent as request headers[0m
[30;1m190 | [0m[35m            post=None,  # A callable to replace requests.post(), for testing.[0m
[30;1m191 | [0m[35m                        # Such as: lambda url, **kwargs:[0m
[30;1m192 | [0m[35m                        #   Mock(status_code=200, text='{}')[0m
[30;1m193 | [0m[35m            **kwargs  # Relay all extra parameters to underlying requests[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m        params = {'client_id': self.client_id, 'response_type': response_type}[0m
[30;1m179 | [0m[35m        params.update(kwargs)  # Note: None values will override params[0m
[30;1m180 | [0m[35m        params = {k: v for k, v in params.items() if v is not None}  # clean up[0m
[30;1m181 | [0m[35m        if params.get('scope'):[0m
[30;1m182 | [0m[35m            params['scope'] = self._stringify(params['scope'])[0m
[30;1m183 | [0m[35m        return params  # A dict suitable to be used in http request[0m
[30;1m184 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m.hostname[0m
[30;1m632 | [0m[35m            with _AuthCodeReceiver(port=listen_port) as receiver:[0m
[30;1m633 | [0m[35m                uri = redirect_uri if _redirect_uri.port != 0 else urlunparse(([0m
[30;1m634 | [0m[35m                    _redirect_uri.scheme,[0m
[30;1m635 | [0m[35m                    "{}:{}".format(_redirect_uri.hostname, receiver.get_port()),[0m
[30;1m636 | [0m[35m                    _redirect_uri.path,[0m
[30;1m637 | [0m[35m                    _redirect_uri.params,[0m
[30;1m638 | [0m[35m                    _redirect_uri.query,[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m.hostname[0m
[30;1m625 | [0m[35m        # Otherwise we will listen on _redirect_uri.port[0m
[30;1m626 | [0m[35m        _redirect_uri = urlparse(redirect_uri or "http://127.0.0.1:0")[0m
[30;1m627 | [0m[35m        if not _redirect_uri.hostname:[0m
[30;1m628 | [0m[35m            raise ValueError("redirect_uri should contain hostname")[0m
[30;1m629 | [0m[35m        listen_port = (  # Conventionally, port-less uri would mean port 80[0m
[30;1m630 | [0m[35m            80 if _redirect_uri.port is None else _redirect_uri.port)[0m
[30;1m631 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m.hostname[0m
[30;1m624 | [0m[35m                auth_code_receiver, redirect_uri=redirect_uri, **kwargs)[0m
[30;1m625 | [0m[35m        # Otherwise we will listen on _redirect_uri.port[0m
[30;1m626 | [0m[35m        _redirect_uri = urlparse(redirect_uri or "http://127.0.0.1:0")[0m
[30;1m627 | [0m[35m        if not _redirect_uri.hostname:[0m
[30;1m628 | [0m[35m            raise ValueError("redirect_uri should contain hostname")[0m
[30;1m629 | [0m[35m        listen_port = (  # Conventionally, port-less uri would mean port 80[0m
[30;1m630 | [0m[35m            80 if _redirect_uri.port is None else _redirect_uri.port)[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m849 | [0m[35m            self, assertion, grant_type, scope=None, **kwargs):[0m
[30;1m850 | [0m[35m        # type: (bytes, Union[str, None], Union[str, list, set, tuple]) -> dict[0m
[30;1m851 | [0m[35m        """This method implements Assertion Framework for OAuth2 (RFC 7521).[0m
[30;1m852 | [0m[35m        See details at https://tools.ietf.org/html/rfc7521#section-4.1[0m
[30;1m853 | [0m[35m[0m
[30;1m854 | [0m[35m        :param assertion:[0m
[30;1m855 | [0m[35m            The assertion bytes can be a raw SAML2 assertion, or a JWT assertion.[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m        This is typically used by a server-side app (Confidential Client),[0m
[30;1m706 | [0m[35m        but it can also be used by a device-side native app (Public Client).[0m
[30;1m707 | [0m[35m        See more detail at https://tools.ietf.org/html/rfc6749#section-4.1.3[0m
[30;1m708 | [0m[35m[0m
[30;1m709 | [0m[35m        You are encouraged to use its higher level method[0m
[30;1m710 | [0m[35m        :func:`~obtain_token_by_auth_code_flow` instead.[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m556 | [0m[35m                    # It is both unnecessary and harmless, per RFC 6749.[0m
[30;1m557 | [0m[35m                    # We use the same scope already used in auth request uri,[0m
[30;1m558 | [0m[35m                    # thus token cache can know what scope the tokens are for.[0m
[30;1m559 | [0m[35m                data=dict(  # Extract and update the data[0m
[30;1m560 | [0m[35m                    kwargs.pop("data", {}),[0m
[30;1m561 | [0m[35m                    code_verifier=auth_code_flow["code_verifier"],[0m
[30;1m562 | [0m[35m                    ),[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35mclass BaseClient(object):[0m
[30;1m35 | [0m[35m    # This low-level interface works. Yet you'll find its sub-class[0m
[30;1m36 | [0m[35m    # more friendly to remind you what parameters are needed in each scenario.[0m
[30;1m37 | [0m[35m    # More on Client Types at https://tools.ietf.org/html/rfc6749#section-2.1[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    @staticmethod[0m
[30;1m40 | [0m[35m    def encode_saml_assertion(assertion):[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m615 | [0m[35m            ``webbrowser.register("xyz", None, BackgroundBrowser("/path/to/browser"))``[0m
[30;1m616 | [0m[35m            beforehand, you can pass in the name "xyz" to use that browser.[0m
[30;1m617 | [0m[35m            The default value ``None`` means using default browser,[0m
[30;1m618 | [0m[35m            which is customizable by env var $BROWSER.[0m
[30;1m619 | [0m[35m[0m
[30;1m620 | [0m[35m        :return: Same as :func:`~obtain_token_by_auth_code_flow()`[0m
[30;1m621 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m            self._http_client.verify = True if verify is None else verify[0m
[30;1m166 | [0m[35m            self._http_client.proxies = proxies[0m
[30;1m167 | [0m[35m            self._http_client.request = functools.partial([0m
[30;1m168 | [0m[35m                # A workaround for requests not supporting session-wide timeout[0m
[30;1m169 | [0m[35m                self._http_client.request, timeout=timeout)[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    def _build_auth_request_params(self, response_type, **kwargs):[0m
[30;1m172 | [0m[35m        # response_type is a string defined in[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m        if http_client:[0m
[30;1m156 | [0m[35m            if verify is not None or proxies is not None or timeout is not None:[0m
[30;1m157 | [0m[35m                raise ValueError([0m
[30;1m158 | [0m[35m                    "verify, proxies, or timeout is not allowed "[0m
[30;1m159 | [0m[35m                    "when http_client is in use")[0m
[30;1m160 | [0m[35m            self._http_client = http_client[0m
[30;1m161 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m            self.default_body["client_assertion_type"] = client_assertion_type[0m
[30;1m154 | [0m[35m        self.logger = logging.getLogger(__name__)[0m
[30;1m155 | [0m[35m        if http_client:[0m
[30;1m156 | [0m[35m            if verify is not None or proxies is not None or timeout is not None:[0m
[30;1m157 | [0m[35m                raise ValueError([0m
[30;1m158 | [0m[35m                    "verify, proxies, or timeout is not allowed "[0m
[30;1m159 | [0m[35m                    "when http_client is in use")[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m                This does not apply if you have chosen to pass your own Http client.[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m            timeout (object):[0m
[30;1m136 | [0m[35m                It will be passed to the[0m
[30;1m137 | [0m[35m                `timeout parameter in the underlying requests library[0m
[30;1m138 | [0m[35m                <http://docs.python-requests.org/en/v2.9.1/user/advanced/#timeouts>`_.[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m            client_secret (str):  Triggers HTTP AUTH for Confidential Client[0m
[30;1m101 | [0m[35m            client_assertion (bytes, callable):[0m
[30;1m102 | [0m[35m                The client assertion to authenticate this client, per RFC 7521.[0m
[30;1m103 | [0m[35m                It can be a raw SAML2 assertion (we will base64 encode it for you),[0m
[30;1m104 | [0m[35m                or a raw JWT assertion in bytes (which we will relay to http layer).[0m
[30;1m105 | [0m[35m                It can also be a callable (recommended),[0m
[30;1m106 | [0m[35m                so that we will do lazy creation of an assertion.[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m                There is no session-wide `timeout` parameter defined here.[0m
[30;1m91 | [0m[35m                Timeout behavior is determined by the actual http client you use.[0m
[30;1m92 | [0m[35m                If you happen to use Requests, it disallows session-wide timeout[0m
[30;1m93 | [0m[35m                (https://github.com/psf/requests/issues/3341). The workaround is:[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m                    s = requests.Session()[0m
[30;1m96 | [0m[35m                    s.request = functools.partial(s.request, timeout=3)[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m                Defaults to a requests session instance.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m                There is no session-wide `timeout` parameter defined here.[0m
[30;1m91 | [0m[35m                Timeout behavior is determined by the actual http client you use.[0m
[30;1m92 | [0m[35m                If you happen to use Requests, it disallows session-wide timeout[0m
[30;1m93 | [0m[35m                (https://github.com/psf/requests/issues/3341). The workaround is:[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m    pass[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mclass BaseClient(object):[0m
[30;1m35 | [0m[35m    # This low-level interface works. Yet you'll find its sub-class[0m
[30;1m36 | [0m[35m    # more friendly to remind you what parameters are needed in each scenario.[0m
[30;1m37 | [0m[35m    # More on Client Types at https://tools.ietf.org/html/rfc6749#section-2.1[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport logging[0m
[30;1m11 | [0m[35mimport warnings[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mimport base64[0m
[30;1m14 | [0m[35mimport sys[0m
[30;1m15 | [0m[35mimport functools[0m
[30;1m16 | [0m[35mimport random[0m
[30;1m17 | [0m[35mimport string[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    from urllib import urlencode, quote_plus[0m
[30;1m10 | [0m[35mimport logging[0m
[30;1m11 | [0m[35mimport warnings[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mimport base64[0m
[30;1m14 | [0m[35mimport sys[0m
[30;1m15 | [0m[35mimport functools[0m
[30;1m16 | [0m[35mimport random[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m                    (nonce_in_id_token, expected_hash))[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m            if auth_code_flow.get("max_age") is not None:[0m
[30;1m270 | [0m[35m                auth_time = result.get("id_token_claims", {}).get("auth_time")[0m
[30;1m271 | [0m[35m                if not auth_time:[0m
[30;1m272 | [0m[35m                    raise RuntimeError([0m
[30;1m273 | [0m[35m                        "13. max_age was requested, ID token should contain auth_time")[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m                    (nonce_in_id_token, expected_hash))[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m            if auth_code_flow.get("max_age") is not None:[0m
[30;1m270 | [0m[35m                auth_time = result.get("id_token_claims", {}).get("auth_time")[0m
[30;1m271 | [0m[35m                if not auth_time:[0m
[30;1m272 | [0m[35m                    raise RuntimeError([0m
[30;1m273 | [0m[35m                        "13. max_age was requested, ID token should contain auth_time")[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m                    'The nonce in id token ("%s") should match our nonce ("%s")' %[0m
[30;1m267 | [0m[35m                    (nonce_in_id_token, expected_hash))[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m            if auth_code_flow.get("max_age") is not None:[0m
[30;1m270 | [0m[35m                auth_time = result.get("id_token_claims", {}).get("auth_time")[0m
[30;1m271 | [0m[35m                if not auth_time:[0m
[30;1m272 | [0m[35m                    raise RuntimeError([0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m        result = super(Client, self).obtain_token_by_auth_code_flow([0m
[30;1m260 | [0m[35m            auth_code_flow, auth_response, **kwargs)[0m
[30;1m261 | [0m[35m        if "id_token_claims" in result:[0m
[30;1m262 | [0m[35m            nonce_in_id_token = result.get("id_token_claims", {}).get("nonce")[0m
[30;1m263 | [0m[35m            expected_hash = _nonce_hash(auth_code_flow["nonce"])[0m
[30;1m264 | [0m[35m            if nonce_in_id_token != expected_hash:[0m
[30;1m265 | [0m[35m                raise RuntimeError([0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m        result = super(Client, self).obtain_token_by_auth_code_flow([0m
[30;1m260 | [0m[35m            auth_code_flow, auth_response, **kwargs)[0m
[30;1m261 | [0m[35m        if "id_token_claims" in result:[0m
[30;1m262 | [0m[35m            nonce_in_id_token = result.get("id_token_claims", {}).get("nonce")[0m
[30;1m263 | [0m[35m            expected_hash = _nonce_hash(auth_code_flow["nonce"])[0m
[30;1m264 | [0m[35m            if nonce_in_id_token != expected_hash:[0m
[30;1m265 | [0m[35m                raise RuntimeError([0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m        flow = super(Client, self).initiate_auth_code_flow([0m
[30;1m243 | [0m[35m            scope=_scope, nonce=_nonce_hash(nonce), **kwargs)[0m
[30;1m244 | [0m[35m        flow["nonce"] = nonce[0m
[30;1m245 | [0m[35m        if kwargs.get("max_age") is not None:[0m
[30;1m246 | [0m[35m            flow["max_age"] = kwargs["max_age"][0m
[30;1m247 | [0m[35m        return flow[0m
[30;1m248 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m        See :func:`oauth2.Client.initiate_auth_code_flow` in parent class[0m
[30;1m226 | [0m[35m        for descriptions on other parameters and return value.[0m
[30;1m227 | [0m[35m        """[0m
[30;1m228 | [0m[35m        if "id_token" in kwargs.get("response_type", ""):[0m
[30;1m229 | [0m[35m            # Implicit grant would cause auth response coming back in #fragment,[0m
[30;1m230 | [0m[35m            # but fragment won't reach a web service.[0m
[30;1m231 | [0m[35m            raise ValueError('response_type="id_token ..." is not allowed')[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m            "Use obtain_token_by_auth_code_flow() instead", DeprecationWarning)[0m
[30;1m203 | [0m[35m        result = super(Client, self).obtain_token_by_authorization_code([0m
[30;1m204 | [0m[35m            code, **kwargs)[0m
[30;1m205 | [0m[35m        nonce_in_id_token = result.get("id_token_claims", {}).get("nonce")[0m
[30;1m206 | [0m[35m        if "id_token_claims" in result and nonce and nonce != nonce_in_id_token:[0m
[30;1m207 | [0m[35m            raise ValueError([0m
[30;1m208 | [0m[35m                'The nonce in id token ("%s") should match your nonce ("%s")' %[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m            "Use obtain_token_by_auth_code_flow() instead", DeprecationWarning)[0m
[30;1m203 | [0m[35m        result = super(Client, self).obtain_token_by_authorization_code([0m
[30;1m204 | [0m[35m            code, **kwargs)[0m
[30;1m205 | [0m[35m        nonce_in_id_token = result.get("id_token_claims", {}).get("nonce")[0m
[30;1m206 | [0m[35m        if "id_token_claims" in result and nonce and nonce != nonce_in_id_token:[0m
[30;1m207 | [0m[35m            raise ValueError([0m
[30;1m208 | [0m[35m                'The nonce in id token ("%s") should match your nonce ("%s")' %[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m        """See :func:`~decode_id_token`."""[0m
[30;1m162 | [0m[35m        return decode_id_token([0m
[30;1m163 | [0m[35m            id_token, nonce=nonce,[0m
[30;1m164 | [0m[35m            client_id=self.client_id, issuer=self.configuration.get("issuer"))[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    def _obtain_token(self, grant_type, *args, **kwargs):[0m
[30;1m167 | [0m[35m        """The result will also contain one more key "id_token_claims",[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m    if _now - skew > decoded["exp"]:[0m
[30;1m124 | [0m[35m        _IdTokenTimeError("9. The ID token already expires.", _now, decoded).log()[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    if nonce and nonce != decoded.get("nonce"):[0m
[30;1m127 | [0m[35m        raise IdTokenNonceError([0m
[30;1m128 | [0m[35m            "11. Nonce must be the same value "[0m
[30;1m129 | [0m[35m            "as the one that was sent in the Authentication Request.",[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m    _now = int(now or time.time())[0m
[30;1m89 | [0m[35m    skew = 120  # 2 minutes[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    if _now + skew < decoded.get("nbf", _now - 1):  # nbf is optional per JWT specs[0m
[30;1m92 | [0m[35m        # This is not an ID token validation, but a JWT validation[0m
[30;1m93 | [0m[35m        # https://tools.ietf.org/html/rfc7519#section-4.1.5[0m
[30;1m94 | [0m[35m        _IdTokenTimeError("0. The ID token is not yet valid.", _now, decoded).log()[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m            reason, _epoch_to_local(now), json.dumps(dict([0m
[30;1m48 | [0m[35m                claims,[0m
[30;1m49 | [0m[35m                iat=_epoch_to_local(claims["iat"]) if claims.get("iat") else None,[0m
[30;1m50 | [0m[35m                exp=_epoch_to_local(claims["exp"]) if claims.get("exp") else None,[0m
[30;1m51 | [0m[35m            ), indent=2)))[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mclass _IdTokenTimeError(IdTokenError):  # This is not intended to be raised and caught[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m            "%s Current epoch = %s.  The id_token was approximately: %s" % ([0m
[30;1m47 | [0m[35m            reason, _epoch_to_local(now), json.dumps(dict([0m
[30;1m48 | [0m[35m                claims,[0m
[30;1m49 | [0m[35m                iat=_epoch_to_local(claims["iat"]) if claims.get("iat") else None,[0m
[30;1m50 | [0m[35m                exp=_epoch_to_local(claims["exp"]) if claims.get("exp") else None,[0m
[30;1m51 | [0m[35m            ), indent=2)))[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35mclass Client(oauth2.Client):[0m
[30;1m155 | [0m[35m    """OpenID Connect is a layer on top of the OAuth2.[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    See its specs at https://openid.net/connect/[0m
[30;1m158 | [0m[35m    """[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m    def decode_id_token(self, id_token, nonce=None):[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35mdef decode_id_token(id_token, client_id=None, issuer=None, nonce=None, now=None):[0m
[30;1m79 | [0m[35m    """Decodes and validates an id_token and returns its claims as a dictionary.[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    ID token claims would at least contain: "iss", "sub", "aud", "exp", "iat",[0m
[30;1m82 | [0m[35m    per `specs <https://openid.net/specs/openid-connect-core-1_0.html#IDToken>`_[0m
[30;1m83 | [0m[35m    and it may contain other optional content such as "preferred_username",[0m
[30;1m84 | [0m[35m    `maybe more <https://openid.net/specs/openid-connect-core-1_0.html#Claims>`_[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m            `OIDC <https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest>`_.[0m
[30;1m308 | [0m[35m        :param string prompt: Defined in[0m
[30;1m309 | [0m[35m            `OIDC <https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest>`_.[0m
[30;1m310 | [0m[35m            You can find the valid string values defined in :class:`oidc.Prompt`.[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m        :param int max_age: Defined in[0m
[30;1m313 | [0m[35m            `OIDC <https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest>`_.[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m277 | [0m[35m                    raise RuntimeError([0m
[30;1m278 | [0m[35m                            "13. auth_time ({auth_time}) was requested, "[0m
[30;1m279 | [0m[35m                            "by using max_age ({max_age}) parameter, "[0m
[30;1m280 | [0m[35m                            "and now ({now}) too much time has elasped "[0m
[30;1m281 | [0m[35m                            "since last end-user authentication. "[0m
[30;1m282 | [0m[35m                            "The ID token was: {id_token}".format([0m
[30;1m283 | [0m[35m                        auth_time=auth_time,[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35mclass Client(oauth2.Client):[0m
[30;1m155 | [0m[35m    """OpenID Connect is a layer on top of the OAuth2.[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    See its specs at https://openid.net/connect/[0m
[30;1m158 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m            ), indent=2)))[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mclass _IdTokenTimeError(IdTokenError):  # This is not intended to be raised and caught[0m
[30;1m54 | [0m[35m    _SUGGESTION = "Make sure your computer's time and time zone are both correct."[0m
[30;1m55 | [0m[35m    def __init__(self, reason, now, claims):[0m
[30;1m56 | [0m[35m        super(_IdTokenTimeError, self).__init__(reason+ " " + self._SUGGESTION, now, claims)[0m
[30;1m57 | [0m[35m    def log(self):[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m            ), indent=2)))[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mclass _IdTokenTimeError(IdTokenError):  # This is not intended to be raised and caught[0m
[30;1m54 | [0m[35m    _SUGGESTION = "Make sure your computer's time and time zone are both correct."[0m
[30;1m55 | [0m[35m    def __init__(self, reason, now, claims):[0m
[30;1m56 | [0m[35m        super(_IdTokenTimeError, self).__init__(reason+ " " + self._SUGGESTION, now, claims)[0m
[30;1m57 | [0m[35m    def log(self):[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport random[0m
[30;1m5 | [0m[35mimport string[0m
[30;1m6 | [0m[35mimport warnings[0m
[30;1m7 | [0m[35mimport hashlib[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/oidc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport random[0m
[30;1m5 | [0m[35mimport string[0m
[30;1m6 | [0m[35mimport warnings[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m        self.assertEqual(output.get("customized"), "whatever",[0m
[30;1m317 | [0m[35m            "Undefined cache keys and their values should be intact")[0m
[30;1m318 | [0m[35m        self.assertEqual([0m
[30;1m319 | [0m[35m            output.get("AccessToken", {}).get("an-entry"), {"foo": "bar"},[0m
[30;1m320 | [0m[35m            "Undefined token keys and their values should be intact")[0m
[30;1m321 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m        self.assertEqual(output.get("customized"), "whatever",[0m
[30;1m317 | [0m[35m            "Undefined cache keys and their values should be intact")[0m
[30;1m318 | [0m[35m        self.assertEqual([0m
[30;1m319 | [0m[35m            output.get("AccessToken", {}).get("an-entry"), {"foo": "bar"},[0m
[30;1m320 | [0m[35m            "Undefined token keys and their values should be intact")[0m
[30;1m321 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m        logger.debug("serialize() = %s", state)[0m
[30;1m314 | [0m[35m        # Now assert all extended content are kept intact[0m
[30;1m315 | [0m[35m        output = json.loads(state)[0m
[30;1m316 | [0m[35m        self.assertEqual(output.get("customized"), "whatever",[0m
[30;1m317 | [0m[35m            "Undefined cache keys and their values should be intact")[0m
[30;1m318 | [0m[35m        self.assertEqual([0m
[30;1m319 | [0m[35m            output.get("AccessToken", {}).get("an-entry"), {"foo": "bar"},[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m281 | [0m[35m            self.cache.CredentialType.REFRESH_TOKEN, sample, {"secret": new_rt})[0m
[30;1m282 | [0m[35m        self.assertEqual([0m
[30;1m283 | [0m[35m            dict(sample, secret=new_rt),[0m
[30;1m284 | [0m[35m            self.cache._cache["RefreshToken"].get([0m
[30;1m285 | [0m[35m                'uid.utid-login.example.com-refreshtoken-my_client_id--s2 s1 s3')[0m
[30;1m286 | [0m[35m            )[0m
[30;1m287 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m            realm="contoso",[0m
[30;1m265 | [0m[35m            home_account_id="uid.utid",[0m
[30;1m266 | [0m[35m        ))[0m
[30;1m267 | [0m[35m        self.assertEqual("2800", at.get("refresh_on"), "Should save refresh_on")[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    def test_old_rt_data_with_wrong_key_should_still_be_salvaged_into_new_rt(self):[0m
[30;1m270 | [0m[35m        sample = {[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m                target=scopes, query=query, now=now,[0m
[30;1m212 | [0m[35m        ):[0m
[30;1m213 | [0m[35m            for k, v in (data or {}).items():  # The extra data, if any[0m
[30;1m214 | [0m[35m                self.assertEqual(cached_at.get(k), v, f"AT should contain {k}={v}")[0m
[30;1m215 | [0m[35m        self.assertTrue(cached_at, "AT should be cached and searchable")[0m
[30;1m216 | [0m[35m        return cached_at[0m
[30;1m217 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m                "client_id": "my_client_id",[0m
[30;1m201 | [0m[35m                'environment': 'fs.msidlab8.com',[0m
[30;1m202 | [0m[35m            },[0m
[30;1m203 | [0m[35m            self.cache._cache.get("AppMetadata", {}).get([0m
[30;1m204 | [0m[35m                "appmetadata-fs.msidlab8.com-my_client_id")[0m
[30;1m205 | [0m[35m            )[0m
[30;1m206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m                "client_id": "my_client_id",[0m
[30;1m201 | [0m[35m                'environment': 'fs.msidlab8.com',[0m
[30;1m202 | [0m[35m            },[0m
[30;1m203 | [0m[35m            self.cache._cache.get("AppMetadata", {}).get([0m
[30;1m204 | [0m[35m                "appmetadata-fs.msidlab8.com-my_client_id")[0m
[30;1m205 | [0m[35m            )[0m
[30;1m206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m                'realm': 'adfs',[0m
[30;1m193 | [0m[35m                'client_id': 'my_client_id',[0m
[30;1m194 | [0m[35m            },[0m
[30;1m195 | [0m[35m            self.cache._cache["IdToken"].get([0m
[30;1m196 | [0m[35m                'subject-fs.msidlab8.com-idtoken-my_client_id-adfs-')[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m        self.assertEqual([0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m                'username': "JaneDoe@example.com",[0m
[30;1m182 | [0m[35m                'authority_type': "ADFS",[0m
[30;1m183 | [0m[35m            },[0m
[30;1m184 | [0m[35m            self.cache._cache["Account"].get('subject-fs.msidlab8.com-adfs')[0m
[30;1m185 | [0m[35m            )[0m
[30;1m186 | [0m[35m        self.assertEqual([0m
[30;1m187 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m                'secret': 'a refresh token',[0m
[30;1m170 | [0m[35m                'target': 's1 s2 s3',  # Sorted[0m
[30;1m171 | [0m[35m            },[0m
[30;1m172 | [0m[35m            self.cache._cache["RefreshToken"].get([0m
[30;1m173 | [0m[35m                'subject-fs.msidlab8.com-refreshtoken-my_client_id--s1 s2 s3')[0m
[30;1m174 | [0m[35m            )[0m
[30;1m175 | [0m[35m        self.assertEqual([0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m                'target': 's1 s2 s3',  # Sorted[0m
[30;1m158 | [0m[35m                'token_type': 'some type',[0m
[30;1m159 | [0m[35m            }[0m
[30;1m160 | [0m[35m        self.assertEqual(access_token_entry, self.cache._cache["AccessToken"].get([0m
[30;1m161 | [0m[35m            self.at_key_maker(**access_token_entry)))[0m
[30;1m162 | [0m[35m        self.assertEqual([0m
[30;1m163 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m                "client_id": "my_client_id",[0m
[30;1m129 | [0m[35m                'environment': 'login.example.com',[0m
[30;1m130 | [0m[35m            },[0m
[30;1m131 | [0m[35m            self.cache._cache.get("AppMetadata", {}).get([0m
[30;1m132 | [0m[35m                "appmetadata-login.example.com-my_client_id")[0m
[30;1m133 | [0m[35m            )[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m                "client_id": "my_client_id",[0m
[30;1m129 | [0m[35m                'environment': 'login.example.com',[0m
[30;1m130 | [0m[35m            },[0m
[30;1m131 | [0m[35m            self.cache._cache.get("AppMetadata", {}).get([0m
[30;1m132 | [0m[35m                "appmetadata-login.example.com-my_client_id")[0m
[30;1m133 | [0m[35m            )[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m                'realm': 'contoso',[0m
[30;1m121 | [0m[35m                'client_id': 'my_client_id',[0m
[30;1m122 | [0m[35m            },[0m
[30;1m123 | [0m[35m            self.cache._cache["IdToken"].get([0m
[30;1m124 | [0m[35m                'uid.utid-login.example.com-idtoken-my_client_id-contoso-')[0m
[30;1m125 | [0m[35m            )[0m
[30;1m126 | [0m[35m        self.assertEqual([0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m                'username': "John Doe",[0m
[30;1m110 | [0m[35m                'authority_type': "MSSTS",[0m
[30;1m111 | [0m[35m            },[0m
[30;1m112 | [0m[35m            self.cache._cache["Account"].get('uid.utid-login.example.com-contoso')[0m
[30;1m113 | [0m[35m            )[0m
[30;1m114 | [0m[35m        self.assertEqual([0m
[30;1m115 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m                'secret': 'a refresh token',[0m
[30;1m98 | [0m[35m                'target': 's1 s2 s3',  # Sorted[0m
[30;1m99 | [0m[35m            },[0m
[30;1m100 | [0m[35m            self.cache._cache["RefreshToken"].get([0m
[30;1m101 | [0m[35m                'uid.utid-login.example.com-refreshtoken-my_client_id--s1 s2 s3')[0m
[30;1m102 | [0m[35m            )[0m
[30;1m103 | [0m[35m        self.assertEqual([0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m                'target': 's1 s2 s3',  # Sorted[0m
[30;1m82 | [0m[35m                'token_type': 'some type',[0m
[30;1m83 | [0m[35m            }[0m
[30;1m84 | [0m[35m        self.assertEqual(access_token_entry, self.cache._cache["AccessToken"].get([0m
[30;1m85 | [0m[35m            self.at_key_maker(**access_token_entry)))[0m
[30;1m86 | [0m[35m        self.assertIn([0m
[30;1m87 | [0m[35m            access_token_entry,[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m                expires_in=3600, refresh_in=1800, access_token="an access token",[0m
[30;1m259 | [0m[35m                ),  #refresh_token="a refresh token"),[0m
[30;1m260 | [0m[35m            }, now=1000)[0m
[30;1m261 | [0m[35m        at = self.assertFoundAccessToken(scopes=scopes, query=dict([0m
[30;1m262 | [0m[35m            client_id="my_client_id",[0m
[30;1m263 | [0m[35m            environment="login.example.com",[0m
[30;1m264 | [0m[35m            realm="contoso",[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom msal.token_cache import TokenCache, SerializableTokenCache[0m
[30;1m7 | [0m[35mfrom tests import unittest[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_token_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom msal.token_cache import TokenCache, SerializableTokenCache[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m873 | [0m[35m                ["scope"],[0m
[30;1m874 | [0m[35m                parent_window_handle=app.CONSOLE_WINDOW_HANDLE,[0m
[30;1m875 | [0m[35m                )[0m
[30;1m876 | [0m[35m            self.assertEqual(result.get("error"), "broker_error")[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m731 | [0m[35m        cca.remove_tokens_for_client()[0m
[30;1m732 | [0m[35m        remaining_tokens = cca.token_cache.find(msal.TokenCache.CredentialType.ACCESS_TOKEN)[0m
[30;1m733 | [0m[35m        self.assertEqual(1, len(remaining_tokens))[0m
[30;1m734 | [0m[35m        self.assertEqual(at_for_user, remaining_tokens[0].get("secret"))[0m
[30;1m735 | [0m[35m[0m
[30;1m736 | [0m[35m[0m
[30;1m737 | [0m[35m@patch(_OIDC_DISCOVERY, new=_OIDC_DISCOVERY_MOCK)[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m632 | [0m[35m        result = self.app.acquire_token_on_behalf_of("assertion", ["s"], post=mock_post)[0m
[30;1m633 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m634 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m@patch(_OIDC_DISCOVERY, new=_OIDC_DISCOVERY_MOCK)[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m627 | [0m[35m    def test_acquire_token_on_behalf_of(self):[0m
[30;1m628 | [0m[35m        at = "this is an access token"[0m
[30;1m629 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m630 | [0m[35m            self.assertEqual("4|523,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m631 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m632 | [0m[35m        result = self.app.acquire_token_on_behalf_of("assertion", ["s"], post=mock_post)[0m
[30;1m633 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m622 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": "foo"}))[0m
[30;1m623 | [0m[35m        result = self.app.acquire_token_for_client(["scope"], post=mock_post)[0m
[30;1m624 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_CACHE)[0m
[30;1m625 | [0m[35m        self.assertEqual("AT 2", result.get("access_token"), "Shall get aging token")[0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m    def test_acquire_token_on_behalf_of(self):[0m
[30;1m628 | [0m[35m        at = "this is an access token"[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m620 | [0m[35m            # 1/0  # TODO: Make sure this was called[0m
[30;1m621 | [0m[35m            self.assertEqual("4|730,4|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m622 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": "foo"}))[0m
[30;1m623 | [0m[35m        result = self.app.acquire_token_for_client(["scope"], post=mock_post)[0m
[30;1m624 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_CACHE)[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m614 | [0m[35m                }))[0m
[30;1m615 | [0m[35m        result = self.app.acquire_token_for_client(["scope"], post=mock_post)[0m
[30;1m616 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m617 | [0m[35m        self.assertEqual("AT 2", result.get("access_token"), "Shall get a new token")[0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m620 | [0m[35m            # 1/0  # TODO: Make sure this was called[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m606 | [0m[35m        self.assertEqual("AT 1", result.get("access_token"), "Shall get a new token")[0m
[30;1m607 | [0m[35m[0m
[30;1m608 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m609 | [0m[35m            self.assertEqual("4|730,3|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m610 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({[0m
[30;1m611 | [0m[35m                "access_token": "AT 2",[0m
[30;1m612 | [0m[35m                "expires_in": 3600,[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35m                }))[0m
[30;1m604 | [0m[35m        result = self.app.acquire_token_for_client(["scope"], post=mock_post)[0m
[30;1m605 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m606 | [0m[35m        self.assertEqual("AT 1", result.get("access_token"), "Shall get a new token")[0m
[30;1m607 | [0m[35m[0m
[30;1m608 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m609 | [0m[35m            self.assertEqual("4|730,3|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m596 | [0m[35m[0m
[30;1m597 | [0m[35m    def test_acquire_token_for_client(self):[0m
[30;1m598 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m599 | [0m[35m            self.assertEqual("4|730,2|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m600 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({[0m
[30;1m601 | [0m[35m                "access_token": "AT 1",[0m
[30;1m602 | [0m[35m                "expires_in": 0,[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m583 | [0m[35m        result = self.app.acquire_token_by_username_password([0m
[30;1m584 | [0m[35m            "username", "password", ["scope"], post=mock_post)[0m
[30;1m585 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m586 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m587 | [0m[35m[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35mclass TestTelemetryOnConfidentialClientApplication(unittest.TestCase):[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m578 | [0m[35m    def test_acquire_token_by_username_password(self):[0m
[30;1m579 | [0m[35m        at = "this is an access token"[0m
[30;1m580 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m581 | [0m[35m            self.assertEqual("4|301,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m582 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m583 | [0m[35m        result = self.app.acquire_token_by_username_password([0m
[30;1m584 | [0m[35m            "username", "password", ["scope"], post=mock_post)[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m573 | [0m[35m        result = self.app.acquire_token_by_device_flow([0m
[30;1m574 | [0m[35m            {"device_code": "123"}, post=mock_post)[0m
[30;1m575 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m576 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m577 | [0m[35m[0m
[30;1m578 | [0m[35m    def test_acquire_token_by_username_password(self):[0m
[30;1m579 | [0m[35m        at = "this is an access token"[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m568 | [0m[35m    def test_acquire_token_by_device_flow(self):[0m
[30;1m569 | [0m[35m        at = "this is an access token"[0m
[30;1m570 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m571 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m572 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m573 | [0m[35m        result = self.app.acquire_token_by_device_flow([0m
[30;1m574 | [0m[35m            {"device_code": "123"}, post=mock_post)[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m553 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m554 | [0m[35m        result = self.app.acquire_token_by_refresh_token("rt", ["s"], post=mock_post)[0m
[30;1m555 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m556 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m557 | [0m[35m[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35mclass TestTelemetryOnPublicClientApplication(unittest.TestCase):[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m549 | [0m[35m    def test_acquire_token_by_refresh_token(self):[0m
[30;1m550 | [0m[35m        at = "this is an access token"[0m
[30;1m551 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m552 | [0m[35m            self.assertEqual("4|85,1|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m553 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m554 | [0m[35m        result = self.app.acquire_token_by_refresh_token("rt", ["s"], post=mock_post)[0m
[30;1m555 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m544 | [0m[35m            {"state": state, "code_verifier": "bar"}, {"state": state, "code": "012"},[0m
[30;1m545 | [0m[35m            post=mock_post)[0m
[30;1m546 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m547 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m548 | [0m[35m[0m
[30;1m549 | [0m[35m    def test_acquire_token_by_refresh_token(self):[0m
[30;1m550 | [0m[35m        at = "this is an access token"[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m537 | [0m[35m    def test_acquire_token_by_auth_code_flow(self):[0m
[30;1m538 | [0m[35m        at = "this is an access token"[0m
[30;1m539 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m540 | [0m[35m            self.assertEqual("4|832,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m541 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m542 | [0m[35m        state = "foo"[0m
[30;1m543 | [0m[35m        result = self.app.acquire_token_by_auth_code_flow([0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m524 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m525 | [0m[35m        result = app.acquire_token_by_device_flow({"device_code": "123"}, post=mock_post)[0m
[30;1m526 | [0m[35m        self.assertEqual(result[app._TOKEN_SOURCE], app._TOKEN_SOURCE_IDP)[0m
[30;1m527 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35mclass TestTelemetryOnClientApplication(unittest.TestCase):[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m521 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m522 | [0m[35m            self.assertEqual("4|0|||", (headers or {}).get(CLIENT_LAST_TELEMETRY),[0m
[30;1m523 | [0m[35m                "The previous success should reset all offline telemetry counters")[0m
[30;1m524 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m525 | [0m[35m        result = app.acquire_token_by_device_flow({"device_code": "123"}, post=mock_post)[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m518 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m521 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m522 | [0m[35m            self.assertEqual("4|0|||", (headers or {}).get(CLIENT_LAST_TELEMETRY),[0m
[30;1m523 | [0m[35m                "The previous success should reset all offline telemetry counters")[0m
[30;1m524 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m515 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m
[30;1m516 | [0m[35m        result = app.acquire_token_by_device_flow({"device_code": "123"}, post=mock_post)[0m
[30;1m517 | [0m[35m        self.assertEqual(result[app._TOKEN_SOURCE], app._TOKEN_SOURCE_IDP)[0m
[30;1m518 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m521 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m "ensures the successful path (which includes the mock) been used"[0m
[30;1m511 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m512 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m513 | [0m[35m            self.assertEqual("4|1|622,id_1,622,id_2|error_1,error_2|", (headers or {}).get(CLIENT_LA[0m
[30;1m514 | [0m[35m                "The previous error should result in same success counter plus latest error info")[0m
[30;1m515 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m        at = "ensures the successful path (which includes the mock) been used"[0m
[30;1m511 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m512 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m513 | [0m[35m            self.assertEqual("4|1|622,id_1,622,id_2|error_1,error_2|", (headers or {}).get(CLIENT_LA[0m
[30;1m514 | [0m[35m                "The previous error should result in same success counter plus latest error info")[0m
[30;1m515 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m            "device_code": "123",[0m
[30;1m506 | [0m[35m            PublicClientApplication.DEVICE_FLOW_CORRELATION_ID: "id_2",[0m
[30;1m507 | [0m[35m            }, post=mock_post)[0m
[30;1m508 | [0m[35m        self.assertEqual(error2, result.get("error"))[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m        at = "ensures the successful path (which includes the mock) been used"[0m
[30;1m511 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m498 | [0m[35m        error2 = "error_2"[0m
[30;1m499 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m500 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m501 | [0m[35m            self.assertEqual("4|1|622,id_1|error_1|", (headers or {}).get(CLIENT_LAST_TELEMETRY),[0m
[30;1m502 | [0m[35m                "The previous error should result in same success counter plus latest error info")[0m
[30;1m503 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": error2}))[0m
[30;1m504 | [0m[35m        result = app.acquire_token_by_device_flow({[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m        error2 = "error_2"[0m
[30;1m499 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m500 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m501 | [0m[35m            self.assertEqual("4|1|622,id_1|error_1|", (headers or {}).get(CLIENT_LAST_TELEMETRY),[0m
[30;1m502 | [0m[35m                "The previous error should result in same success counter plus latest error info")[0m
[30;1m503 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": error2}))[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m493 | [0m[35m            "device_code": "123",[0m
[30;1m494 | [0m[35m            PublicClientApplication.DEVICE_FLOW_CORRELATION_ID: "id_1",[0m
[30;1m495 | [0m[35m            }, post=mock_post)[0m
[30;1m496 | [0m[35m        self.assertEqual(error1, result.get("error"))[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m        error2 = "error_2"[0m
[30;1m499 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m        error1 = "error_1"[0m
[30;1m487 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m488 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m489 | [0m[35m            self.assertEqual("4|1|||", (headers or {}).get(CLIENT_LAST_TELEMETRY),[0m
[30;1m490 | [0m[35m                "The previous cache hit should result in success counter value as 1")[0m
[30;1m491 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": error1}))[0m
[30;1m492 | [0m[35m        result = app.acquire_token_by_device_flow({  # It allows customizing correlation_id[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m        error1 = "error_1"[0m
[30;1m487 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m488 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m489 | [0m[35m            self.assertEqual("4|1|||", (headers or {}).get(CLIENT_LAST_TELEMETRY),[0m
[30;1m490 | [0m[35m                "The previous cache hit should result in success counter value as 1")[0m
[30;1m491 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": error1}))[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m481 | [0m[35m                self.fail("I/O shouldn't happen in cache hit AT scenario")[0m
[30;1m482 | [0m[35m            )[0m
[30;1m483 | [0m[35m        self.assertEqual(result[app._TOKEN_SOURCE], app._TOKEN_SOURCE_CACHE)[0m
[30;1m484 | [0m[35m        self.assertEqual(cached_access_token, result.get("access_token"))[0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m        error1 = "error_1"[0m
[30;1m487 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m443 | [0m[35m                }))[0m
[30;1m444 | [0m[35m        result = self.app.acquire_token_silent(['s1'], self.account, post=mock_post)[0m
[30;1m445 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m446 | [0m[35m        self.assertEqual(new_access_token, result.get("access_token"))[0m
[30;1m447 | [0m[35m        self.assertNotIn("refresh_in", result, "Customers need not know refresh_in")[0m
[30;1m448 | [0m[35m        self.assertRefreshOn(result, new_refresh_in)[0m
[30;1m449 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m436 | [0m[35m        new_access_token = "new AT"[0m
[30;1m437 | [0m[35m        new_refresh_in = 123[0m
[30;1m438 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m439 | [0m[35m            self.assertEqual("4|84,3|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m440 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({[0m
[30;1m441 | [0m[35m                "access_token": new_access_token,[0m
[30;1m442 | [0m[35m                "refresh_in": new_refresh_in,[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m427 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": error}))[0m
[30;1m428 | [0m[35m        result = self.app.acquire_token_silent_with_error([0m
[30;1m429 | [0m[35m            ['s1'], self.account, post=mock_post)[0m
[30;1m430 | [0m[35m        self.assertEqual(error, result.get("error"), "Error should be returned")[0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m    def test_expired_token_and_available_aad_should_return_new_token(self):[0m
[30;1m433 | [0m[35m        # a.k.a. Attempt refresh expired token when AAD available[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m            access_token="expired at", expires_in=self.soon, refresh_in=-900)[0m
[30;1m424 | [0m[35m        error = "something went wrong"[0m
[30;1m425 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m426 | [0m[35m            self.assertEqual("4|84,3|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m427 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": error}))[0m
[30;1m428 | [0m[35m        result = self.app.acquire_token_silent_with_error([0m
[30;1m429 | [0m[35m            ['s1'], self.account, post=mock_post)[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m414 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": "foo"}))[0m
[30;1m415 | [0m[35m        result = self.app.acquire_token_silent(['s1'], self.account, post=mock_post)[0m
[30;1m416 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_CACHE)[0m
[30;1m417 | [0m[35m        self.assertEqual(old_at, result.get("access_token"))[0m
[30;1m418 | [0m[35m        self.assertRefreshOn(result, refresh_in)[0m
[30;1m419 | [0m[35m[0m
[30;1m420 | [0m[35m    def test_expired_token_and_unavailable_aad_should_return_error(self):[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m        self.populate_cache([0m
[30;1m411 | [0m[35m            access_token=old_at, expires_in=3599, refresh_in=refresh_in)[0m
[30;1m412 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m413 | [0m[35m            self.assertEqual("4|84,4|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m414 | [0m[35m            return MinimalResponse(status_code=400, text=json.dumps({"error": "foo"}))[0m
[30;1m415 | [0m[35m        result = self.app.acquire_token_silent(['s1'], self.account, post=mock_post)[0m
[30;1m416 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_CACHE)[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m                }))[0m
[30;1m400 | [0m[35m        result = self.app.acquire_token_silent(['s1'], self.account, post=mock_post)[0m
[30;1m401 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_IDP)[0m
[30;1m402 | [0m[35m        self.assertEqual(new_access_token, result.get("access_token"))[0m
[30;1m403 | [0m[35m        self.assertNotIn("refresh_in", result, "Customers need not know refresh_in")[0m
[30;1m404 | [0m[35m        self.assertRefreshOn(result, new_refresh_in)[0m
[30;1m405 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m        new_access_token = "new AT"[0m
[30;1m393 | [0m[35m        new_refresh_in = 123[0m
[30;1m394 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m395 | [0m[35m            self.assertEqual("4|84,4|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m396 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({[0m
[30;1m397 | [0m[35m                "access_token": new_access_token,[0m
[30;1m398 | [0m[35m                "refresh_in": new_refresh_in,[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m382 | [0m[35m                self.fail("I/O shouldn't happen in cache hit AT scenario")[0m
[30;1m383 | [0m[35m            )[0m
[30;1m384 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_CACHE)[0m
[30;1m385 | [0m[35m        self.assertEqual(access_token, result.get("access_token"))[0m
[30;1m386 | [0m[35m        self.assertNotIn("refresh_in", result, "Customers need not know refresh_in")[0m
[30;1m387 | [0m[35m        self.assertRefreshOn(result, refresh_in)[0m
[30;1m388 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m    def assertRefreshOn(self, result, refresh_in):[0m
[30;1m368 | [0m[35m        refresh_on = int(time.time() + refresh_in)[0m
[30;1m369 | [0m[35m        self.assertTrue([0m
[30;1m370 | [0m[35m            refresh_on - 1 < result.get("refresh_on", 0) < refresh_on + 1,[0m
[30;1m371 | [0m[35m            "refresh_on should be set properly")[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    def test_fresh_token_should_be_returned_from_cache(self):[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m        result = self.app.acquire_token_silent(self.scopes, self.account)[0m
[30;1m276 | [0m[35m        self.assertNotEqual(None, result)[0m
[30;1m277 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_CACHE)[0m
[30;1m278 | [0m[35m        self.assertEqual(self.access_token, result.get('access_token'))[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m    def test_acquire_token_silent_should_find_rt_under_different_alias(self):[0m
[30;1m281 | [0m[35m        self.cache._cache["AccessToken"] = {}  # A hacky way to clear ATs[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m    def test_get_accounts_should_find_accounts_under_different_alias(self):[0m
[30;1m269 | [0m[35m        accounts = self.app.get_accounts()[0m
[30;1m270 | [0m[35m        self.assertNotEqual([], accounts)[0m
[30;1m271 | [0m[35m        self.assertEqual(self.environment_in_cache, accounts[0].get("environment"),[0m
[30;1m272 | [0m[35m            "We should be able to find an account under an authority alias")[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    def test_acquire_token_silent_should_find_at_under_different_alias(self):[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m        error_response = '{"error": "invalid_grant", "error_description": "xyz"}'[0m
[30;1m202 | [0m[35m        def tester(url, data=None, **kwargs):[0m
[30;1m203 | [0m[35m            self.assertEqual([0m
[30;1m204 | [0m[35m                self.frt, data.get("refresh_token"), "Should attempt the FRT")[0m
[30;1m205 | [0m[35m            return MinimalResponse(status_code=400, text=error_response)[0m
[30;1m206 | [0m[35m        app = ClientApplication([0m
[30;1m207 | [0m[35m            "preexisting_family_app", authority=self.authority_url, token_cache=self.cache)[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            msal.TokenCache.CredentialType.APP_METADATA,[0m
[30;1m192 | [0m[35m            query={"client_id": app.client_id})[0m
[30;1m193 | [0m[35m        self.assertNotEqual([], app_metadata, "Should record new app's metadata")[0m
[30;1m194 | [0m[35m        self.assertEqual("1", app_metadata[0].get("family_id"),[0m
[30;1m195 | [0m[35m            "The new family app should be recorded as in the same family")[0m
[30;1m196 | [0m[35m    # Known family app will simply use FRT, which is largely the same as this one[0m
[30;1m197 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m        at = app._acquire_token_silent_by_finding_rt_belongs_to_me_or_my_family([0m
[30;1m187 | [0m[35m            app.authority, self.scopes, self.account, post=tester)[0m
[30;1m188 | [0m[35m        logger.debug("%s.cache = %s", self.id(), self.cache.serialize())[0m
[30;1m189 | [0m[35m        self.assertEqual("at", at.get("access_token"), "New app should get a new AT")[0m
[30;1m190 | [0m[35m        app_metadata = app.token_cache.find([0m
[30;1m191 | [0m[35m            msal.TokenCache.CredentialType.APP_METADATA,[0m
[30;1m192 | [0m[35m            query={"client_id": app.client_id})[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m    def test_unknown_family_app_will_attempt_frt_and_join_family(self):[0m
[30;1m178 | [0m[35m        def tester(url, data=None, **kwargs):[0m
[30;1m179 | [0m[35m            self.assertEqual([0m
[30;1m180 | [0m[35m                self.frt, data.get("refresh_token"), "Should attempt the FRT")[0m
[30;1m181 | [0m[35m            return MinimalResponse([0m
[30;1m182 | [0m[35m                status_code=200, text=json.dumps(build_response([0m
[30;1m183 | [0m[35m                    uid=self.uid, utid=self.utid, foci="1", access_token="at")))[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m            })[0m
[30;1m170 | [0m[35m        logger.debug("%s.cache = %s", self.id(), self.cache.serialize())[0m
[30;1m171 | [0m[35m        def tester(url, data=None, **kwargs):[0m
[30;1m172 | [0m[35m            self.assertEqual(rt, data.get("refresh_token"), "Should attempt the RT")[0m
[30;1m173 | [0m[35m            return MinimalResponse(status_code=200, text='{}')[0m
[30;1m174 | [0m[35m        app._acquire_token_silent_by_finding_rt_belongs_to_me_or_my_family([0m
[30;1m175 | [0m[35m            app.authority, self.scopes, self.account, post=tester)[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m        logger.debug("%s.cache = %s", self.id(), self.cache.serialize())[0m
[30;1m150 | [0m[35m        error_response = '{"error": "invalid_grant","error_description": "Was issued to another clie[0m
[30;1m151 | [0m[35m        def tester(url, data=None, **kwargs):[0m
[30;1m152 | [0m[35m            self.assertEqual(self.frt, data.get("refresh_token"), "Should attempt the FRT")[0m
[30;1m153 | [0m[35m            return MinimalResponse(status_code=400, text=error_response)[0m
[30;1m154 | [0m[35m        app._acquire_token_silent_by_finding_rt_belongs_to_me_or_my_family([0m
[30;1m155 | [0m[35m            app.authority, self.scopes, self.account, post=tester)[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m            return MinimalResponse(status_code=400, text=error_response)[0m
[30;1m119 | [0m[35m        result = self.app.acquire_token_silent_with_error([0m
[30;1m120 | [0m[35m            self.scopes, self.account, post=tester)[0m
[30;1m121 | [0m[35m        self.assertEqual("", result.get("classification"))[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m@patch(_OIDC_DISCOVERY, new=_OIDC_DISCOVERY_MOCK)[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            return MinimalResponse(status_code=400, text=error_response)[0m
[30;1m111 | [0m[35m        result = self.app.acquire_token_silent_with_error([0m
[30;1m112 | [0m[35m            self.scopes, self.account, post=tester)[0m
[30;1m113 | [0m[35m        self.assertEqual("basic_action", result.get("classification"))[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    def test_atswe_will_map_some_suberror_to_classification_to_empty_string(self):[0m
[30;1m116 | [0m[35m        error_response = '{"error": "invalid_grant", "suberror": "client_mismatch"}'[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m625 | [0m[35m        self.assertEqual("AT 2", result.get("access_token"), "Shall get aging token")[0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m    def test_acquire_token_on_behalf_of(self):[0m
[30;1m628 | [0m[35m        at = "this is an access token"[0m
[30;1m629 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m630 | [0m[35m            self.assertEqual("4|523,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m631 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m589 | [0m[35mclass TestTelemetryOnConfidentialClientApplication(unittest.TestCase):[0m
[30;1m590 | [0m[35m    @classmethod[0m
[30;1m591 | [0m[35m    @patch(_OIDC_DISCOVERY, new=_OIDC_DISCOVERY_MOCK)[0m
[30;1m592 | [0m[35m    def setUpClass(cls):  # Initialization at runtime, not interpret-time[0m
[30;1m593 | [0m[35m        cls.app = ConfidentialClientApplication([0m
[30;1m594 | [0m[35m            "client_id", client_credential="secret",[0m
[30;1m595 | [0m[35m            authority="https://login.microsoftonline.com/common")[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m576 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m577 | [0m[35m[0m
[30;1m578 | [0m[35m    def test_acquire_token_by_username_password(self):[0m
[30;1m579 | [0m[35m        at = "this is an access token"[0m
[30;1m580 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m581 | [0m[35m            self.assertEqual("4|301,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m582 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m566 | [0m[35m    # For now, acquire_token_interactive() is verified by code review.[0m
[30;1m567 | [0m[35m[0m
[30;1m568 | [0m[35m    def test_acquire_token_by_device_flow(self):[0m
[30;1m569 | [0m[35m        at = "this is an access token"[0m
[30;1m570 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m571 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m572 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m559 | [0m[35mclass TestTelemetryOnPublicClientApplication(unittest.TestCase):[0m
[30;1m560 | [0m[35m    @classmethod[0m
[30;1m561 | [0m[35m    @patch(_OIDC_DISCOVERY, new=_OIDC_DISCOVERY_MOCK)[0m
[30;1m562 | [0m[35m    def setUpClass(cls):  # Initialization at runtime, not interpret-time[0m
[30;1m563 | [0m[35m        cls.app = PublicClientApplication([0m
[30;1m564 | [0m[35m            "client_id", authority="https://login.microsoftonline.com/common")[0m
[30;1m565 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m547 | [0m[35m        self.assertEqual(at, result.get("access_token"))[0m
[30;1m548 | [0m[35m[0m
[30;1m549 | [0m[35m    def test_acquire_token_by_refresh_token(self):[0m
[30;1m550 | [0m[35m        at = "this is an access token"[0m
[30;1m551 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m552 | [0m[35m            self.assertEqual("4|85,1|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m553 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m535 | [0m[35m            "client_id", authority="https://login.microsoftonline.com/common")[0m
[30;1m536 | [0m[35m[0m
[30;1m537 | [0m[35m    def test_acquire_token_by_auth_code_flow(self):[0m
[30;1m538 | [0m[35m        at = "this is an access token"[0m
[30;1m539 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m540 | [0m[35m            self.assertEqual("4|832,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m541 | [0m[35m            return MinimalResponse(status_code=200, text=json.dumps({"access_token": at}))[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m530 | [0m[35mclass TestTelemetryOnClientApplication(unittest.TestCase):[0m
[30;1m531 | [0m[35m    @classmethod[0m
[30;1m532 | [0m[35m    @patch(_OIDC_DISCOVERY, new=_OIDC_DISCOVERY_MOCK)[0m
[30;1m533 | [0m[35m    def setUpClass(cls):  # Initialization at runtime, not interpret-time[0m
[30;1m534 | [0m[35m        cls.app = ClientApplication([0m
[30;1m535 | [0m[35m            "client_id", authority="https://login.microsoftonline.com/common")[0m
[30;1m536 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m507 | [0m[35m            }, post=mock_post)[0m
[30;1m508 | [0m[35m        self.assertEqual(error2, result.get("error"))[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m        at = "ensures the successful path (which includes the mock) been used"[0m
[30;1m511 | [0m[35m        def mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m512 | [0m[35m            self.assertEqual("4|622,0|", (headers or {}).get(CLIENT_CURRENT_TELEMETRY))[0m
[30;1m513 | [0m[35m            self.assertEqual("4|1|622,id_1,622,id_2|error_1,error_2|", (headers or {}).get(CLIENT_LA[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m478 | [0m[35m        result = app.acquire_token_silent([0m
[30;1m479 | [0m[35m            self.scopes, self.account,[0m
[30;1m480 | [0m[35m            post=lambda url, *args, **kwargs:  # Utilize the undocumented test feature[0m
[30;1m481 | [0m[35m                self.fail("I/O shouldn't happen in cache hit AT scenario")[0m
[30;1m482 | [0m[35m            )[0m
[30;1m483 | [0m[35m        self.assertEqual(result[app._TOKEN_SOURCE], app._TOKEN_SOURCE_CACHE)[0m
[30;1m484 | [0m[35m        self.assertEqual(cached_access_token, result.get("access_token"))[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m379 | [0m[35m        result = self.app.acquire_token_silent([0m
[30;1m380 | [0m[35m            ['s1'], self.account,[0m
[30;1m381 | [0m[35m            post=lambda url, *args, **kwargs:  # Utilize the undocumented test feature[0m
[30;1m382 | [0m[35m                self.fail("I/O shouldn't happen in cache hit AT scenario")[0m
[30;1m383 | [0m[35m            )[0m
[30;1m384 | [0m[35m        self.assertEqual(result[self.app._TOKEN_SOURCE], self.app._TOKEN_SOURCE_CACHE)[0m
[30;1m385 | [0m[35m        self.assertEqual(access_token, result.get("access_token"))[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m347 | [0m[35m    soon = 60  # application.py considers tokens within 5 minutes as expired[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    @classmethod[0m
[30;1m350 | [0m[35m    def setUpClass(cls):  # Initialization at runtime, not interpret-time[0m
[30;1m351 | [0m[35m        cls.app = ClientApplication(cls.client_id, authority=cls.authority_url)[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m    def setUp(self):[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m183 | [0m[35m                    uid=self.uid, utid=self.utid, foci="1", access_token="at")))[0m
[30;1m184 | [0m[35m        app = ClientApplication([0m
[30;1m185 | [0m[35m            "unknown_family_app", authority=self.authority_url, token_cache=self.cache)[0m
[30;1m186 | [0m[35m        at = app._acquire_token_silent_by_finding_rt_belongs_to_me_or_my_family([0m
[30;1m187 | [0m[35m            app.authority, self.scopes, self.account, post=tester)[0m
[30;1m188 | [0m[35m        logger.debug("%s.cache = %s", self.id(), self.cache.serialize())[0m
[30;1m189 | [0m[35m        self.assertEqual("at", at.get("access_token"), "New app should get a new AT")[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m79 | [0m[35m            "scope": self.scopes,[0m
[30;1m80 | [0m[35m            "token_endpoint": "{}/oauth2/v2.0/token".format(self.authority_url),[0m
[30;1m81 | [0m[35m            "response": build_response([0m
[30;1m82 | [0m[35m                access_token="an expired AT to trigger refresh", expires_in=-99,[0m
[30;1m83 | [0m[35m                uid=self.uid, utid=self.utid, refresh_token=self.rt),[0m
[30;1m84 | [0m[35m            })  # The add(...) helper populates correct home_account_id for future searching[0m
[30;1m85 | [0m[35m        self.app = ClientApplication([0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m        accounts = self.app.get_accounts()[0m
[30;1m270 | [0m[35m        self.assertNotEqual([], accounts)[0m
[30;1m271 | [0m[35m        self.assertEqual(self.environment_in_cache, accounts[0].get("environment"),[0m
[30;1m272 | [0m[35m            "We should be able to find an account under an authority alias")[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    def test_acquire_token_silent_should_find_at_under_different_alias(self):[0m
[30;1m275 | [0m[35m        result = self.app.acquire_token_silent(self.scopes, self.account)[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport sys[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom unittest.mock import patch, Mock[0m
[30;1m8 | [0m[35mimport msal[0m
[30;1m9 | [0m[35mfrom msal.application import ([0m
[30;1m10 | [0m[35m    extract_certs,[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m.hostname[0m
[30;1m189 | [0m[35m            return authority, authority.hostname, tenant[0m
[30;1m190 | [0m[35m        # AAD[0m
[30;1m191 | [0m[35m        if len(parts) >= 2 and parts[1]:[0m
[30;1m192 | [0m[35m            return authority, authority.hostname, parts[1][0m
[30;1m193 | [0m[35m    raise ValueError([0m
[30;1m194 | [0m[35m        "Your given address (%s) should consist of "[0m
[30;1m195 | [0m[35m        "an https url with a minimum of one segment in a path: e.g. "[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m.hostname[0m
[30;1m186 | [0m[35m            tenant = first_part if first_part else "{}.onmicrosoft.com".format([0m
[30;1m187 | [0m[35m                # Fallback to sub domain name. This variation may not be advertised[0m
[30;1m188 | [0m[35m                authority.hostname.rsplit(_CIAM_DOMAIN_SUFFIX, 1)[0])[0m
[30;1m189 | [0m[35m            return authority, authority.hostname, tenant[0m
[30;1m190 | [0m[35m        # AAD[0m
[30;1m191 | [0m[35m        if len(parts) >= 2 and parts[1]:[0m
[30;1m192 | [0m[35m            return authority, authority.hostname, parts[1][0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m.hostname[0m
[30;1m185 | [0m[35m            # Use path in CIAM authority. It will be validated by OIDC Discovery soon[0m
[30;1m186 | [0m[35m            tenant = first_part if first_part else "{}.onmicrosoft.com".format([0m
[30;1m187 | [0m[35m                # Fallback to sub domain name. This variation may not be advertised[0m
[30;1m188 | [0m[35m                authority.hostname.rsplit(_CIAM_DOMAIN_SUFFIX, 1)[0])[0m
[30;1m189 | [0m[35m            return authority, authority.hostname, tenant[0m
[30;1m190 | [0m[35m        # AAD[0m
[30;1m191 | [0m[35m        if len(parts) >= 2 and parts[1]:[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m.hostname[0m
[30;1m181 | [0m[35m    if authority.scheme == "https":[0m
[30;1m182 | [0m[35m        parts = authority.path.split("/")[0m
[30;1m183 | [0m[35m        first_part = parts[1] if len(parts) >= 2 and parts[1] else None[0m
[30;1m184 | [0m[35m        if authority.hostname.endswith(_CIAM_DOMAIN_SUFFIX):  # CIAM[0m
[30;1m185 | [0m[35m            # Use path in CIAM authority. It will be validated by OIDC Discovery soon[0m
[30;1m186 | [0m[35m            tenant = first_part if first_part else "{}.onmicrosoft.com".format([0m
[30;1m187 | [0m[35m                # Fallback to sub domain name. This variation may not be advertised[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m.hostname[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35mdef canonicalize(authority_or_auth_endpoint):[0m
[30;1m179 | [0m[35m    # Returns (url_parsed_result, hostname_in_lowercase, tenant)[0m
[30;1m180 | [0m[35m    authority = urlparse(authority_or_auth_endpoint)[0m
[30;1m181 | [0m[35m    if authority.scheme == "https":[0m
[30;1m182 | [0m[35m        parts = authority.path.split("/")[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35mdef tenant_discovery(tenant_discovery_endpoint, http_client, **kwargs):[0m
[30;1m209 | [0m[35m    # Returns Openid Configuration[0m
[30;1m210 | [0m[35m    resp = http_client.get(tenant_discovery_endpoint, **kwargs)[0m
[30;1m211 | [0m[35m    if resp.status_code == 200:[0m
[30;1m212 | [0m[35m        return json.loads(resp.text)  # It could raise ValueError[0m
[30;1m213 | [0m[35m    if 400 <= resp.status_code < 500:[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m        % authority_or_auth_endpoint)[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35mdef _instance_discovery(url, http_client, instance_discovery_endpoint, **kwargs):[0m
[30;1m202 | [0m[35m    resp = http_client.get([0m
[30;1m203 | [0m[35m        instance_discovery_endpoint,[0m
[30;1m204 | [0m[35m        params={'authorization_endpoint': url, 'api-version': '1.0'},[0m
[30;1m205 | [0m[35m        **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        # "federation_protocol", "cloud_audience_urn",[0m
[30;1m164 | [0m[35m        # "federation_metadata_url", "federation_active_auth_url", etc.[0m
[30;1m165 | [0m[35m        if self.instance not in self.__class__._domains_without_user_realm_discovery:[0m
[30;1m166 | [0m[35m            resp = response or self._http_client.get([0m
[30;1m167 | [0m[35m                "https://{netloc}/common/userrealm/{username}?api-version=1.0".format([0m
[30;1m168 | [0m[35m                    netloc=self.instance, username=username),[0m
[30;1m169 | [0m[35m                headers={'Accept': 'application/json',[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m                    self.instance, authority.path),[0m
[30;1m140 | [0m[35m                self._http_client,[0m
[30;1m141 | [0m[35m                instance_discovery_endpoint)[0m
[30;1m142 | [0m[35m            if payload.get("error") == "invalid_instance":[0m
[30;1m143 | [0m[35m                raise ValueError([0m
[30;1m144 | [0m[35m                    "invalid_instance: "[0m
[30;1m145 | [0m[35m                    "The authority you provided, %s, is not whitelisted. "[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m            'openid_config("%s") = %s', tenant_discovery_endpoint, openid_config)[0m
[30;1m98 | [0m[35m        self.authorization_endpoint = openid_config['authorization_endpoint'][0m
[30;1m99 | [0m[35m        self.token_endpoint = openid_config['token_endpoint'][0m
[30;1m100 | [0m[35m        self.device_authorization_endpoint = openid_config.get('device_authorization_endpoint')[0m
[30;1m101 | [0m[35m        _, _, self.tenant = canonicalize(self.token_endpoint)  # Usually a GUID[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    def _initialize_oidc_authority(self, oidc_authority_url):[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m            self, authority_url, validate_authority, instance_discovery):[0m
[30;1m114 | [0m[35m        # :param instance_discovery:[0m
[30;1m115 | [0m[35m        #    By default, the known-to-Microsoft validation will use an[0m
[30;1m116 | [0m[35m        #    instance discovery endpoint located at ``login.microsoftonline.com``.[0m
[30;1m117 | [0m[35m        #    You can customize the endpoint by providing a url as a string.[0m
[30;1m118 | [0m[35m        #    Or you can turn this behavior off by passing in a False here.[0m
[30;1m119 | [0m[35m        if isinstance(authority_url, AuthorityBuilder):[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/authority.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m        except ValueError:[0m
[30;1m83 | [0m[35m            error_message = ([0m
[30;1m84 | [0m[35m                "Unable to get OIDC authority configuration for {url} "[0m
[30;1m85 | [0m[35m                "because its OIDC Discovery endpoint is unavailable at "[0m
[30;1m86 | [0m[35m                "{url}/.well-known/openid-configuration ".format(url=oidc_authority_url)[0m
[30;1m87 | [0m[35m                if oidc_authority_url else[0m
[30;1m88 | [0m[35m                "Unable to get authority configuration for {}. "[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_wstrust.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m            rst_body = f.read()[0m
[30;1m95 | [0m[35m        result = parse_token_by_re(rst_body)[0m
[30;1m96 | [0m[35m        self.assertEqual(result.get("type"), SAML_TOKEN_TYPE_V1)[0m
[30;1m97 | [0m[35m        self.assertIn(b"<saml:Assertion", result.get("token", ""))[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_wstrust.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m        with open(os.path.join(os.path.dirname(__file__), "rst_response.xml")) as f:[0m
[30;1m94 | [0m[35m            rst_body = f.read()[0m
[30;1m95 | [0m[35m        result = parse_token_by_re(rst_body)[0m
[30;1m96 | [0m[35m        self.assertEqual(result.get("type"), SAML_TOKEN_TYPE_V1)[0m
[30;1m97 | [0m[35m        self.assertIn(b"<saml:Assertion", result.get("token", ""))[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m            self._buf = {VALUE: self._factory(), EXPIRES_AT: now + self._expires_in}[0m
[30;1m64 | [0m[35m        else:[0m
[30;1m65 | [0m[35m            logger.debug("Reusing still valid assertion")[0m
[30;1m66 | [0m[35m        return self._buf.get(VALUE)[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mclass JwtAssertionCreator(AssertionCreator):[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m    def __call__(self):[0m
[30;1m59 | [0m[35m        EXPIRES_AT, VALUE = "expires_at", "value"[0m
[30;1m60 | [0m[35m        now = time.time()[0m
[30;1m61 | [0m[35m        if self._buf.get(EXPIRES_AT, 0) <= now:[0m
[30;1m62 | [0m[35m            logger.debug("Regenerating new assertion")[0m
[30;1m63 | [0m[35m            self._buf = {VALUE: self._factory(), EXPIRES_AT: now + self._expires_in}[0m
[30;1m64 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m        Args:[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m            key (str):[0m
[30;1m80 | [0m[35m                An unencrypted private key for signing, in a base64 encoded string.[0m
[30;1m81 | [0m[35m                It can also be a cryptography ``PrivateKey`` object,[0m
[30;1m82 | [0m[35m                which is how you can work with a previously-encrypted key.[0m
[30;1m83 | [0m[35m                See also https://github.com/jpadilla/pyjwt/pull/525[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport binascii[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport uuid[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/assertion.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport binascii[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport uuid[0m
[30;1m5 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m642 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m643 | [0m[35m                "expires_in": int(payload["expires_in"]),[0m
[30;1m644 | [0m[35m                "token_type": payload.get("token_type", "Bearer"),[0m
[30;1m645 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m646 | [0m[35m                }[0m
[30;1m647 | [0m[35m    except json.decoder.JSONDecodeError:[0m
[30;1m648 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m641 | [0m[35m            return {[0m
[30;1m642 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m643 | [0m[35m                "expires_in": int(payload["expires_in"]),[0m
[30;1m644 | [0m[35m                "token_type": payload.get("token_type", "Bearer"),[0m
[30;1m645 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m646 | [0m[35m                }[0m
[30;1m647 | [0m[35m    except json.decoder.JSONDecodeError:[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m636 | [0m[35m        )[0m
[30;1m637 | [0m[35m    try:[0m
[30;1m638 | [0m[35m        payload = json.loads(response.text)[0m
[30;1m639 | [0m[35m        if payload.get("access_token") and payload.get("expires_in"):[0m
[30;1m640 | [0m[35m            # Example: https://learn.microsoft.com/en-us/azure/azure-arc/servers/media/managed-ident[0m
[30;1m641 | [0m[35m            return {[0m
[30;1m642 | [0m[35m                "access_token": payload["access_token"],[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m636 | [0m[35m        )[0m
[30;1m637 | [0m[35m    try:[0m
[30;1m638 | [0m[35m        payload = json.loads(response.text)[0m
[30;1m639 | [0m[35m        if payload.get("access_token") and payload.get("expires_in"):[0m
[30;1m640 | [0m[35m            # Example: https://learn.microsoft.com/en-us/azure/azure-arc/servers/media/managed-ident[0m
[30;1m641 | [0m[35m            return {[0m
[30;1m642 | [0m[35m                "access_token": payload["access_token"],[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m629 | [0m[35m        raise ManagedIdentityError("Local key file shall not be larger than 4KB")[0m
[30;1m630 | [0m[35m    with open(filename) as f:[0m
[30;1m631 | [0m[35m        secret = f.read()[0m
[30;1m632 | [0m[35m    response = http_client.get([0m
[30;1m633 | [0m[35m        endpoint,[0m
[30;1m634 | [0m[35m        params={"api-version": "2020-06-01", "resource": resource},[0m
[30;1m635 | [0m[35m        headers={"Metadata": "true", "Authorization": "Basic {}".format(secret)},[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m613 | [0m[35m        # Normalized to lowercase, because header names are case-insensitive[0m
[30;1m614 | [0m[35m        # https://datatracker.ietf.org/doc/html/rfc7230#section-3.2[0m
[30;1m615 | [0m[35m        k.lower(): v for k, v in resp.headers.items() if k.lower() == www_auth[0m
[30;1m616 | [0m[35m        }.get(www_auth, "").split("=")  # Output will be ["Basic realm", "content"][0m
[30;1m617 | [0m[35m    if not (  # https://datatracker.ietf.org/doc/html/rfc7617#section-2[0m
[30;1m618 | [0m[35m            len(challenge) == 2 and challenge[0].lower() == "basic realm"):[0m
[30;1m619 | [0m[35m        raise ManagedIdentityError([0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35mdef _obtain_token_on_arc(http_client, endpoint, resource):[0m
[30;1m604 | [0m[35m    # https://learn.microsoft.com/en-us/azure/azure-arc/servers/managed-identity-authentication[0m
[30;1m605 | [0m[35m    logger.debug("Obtaining token via managed identity on Azure Arc")[0m
[30;1m606 | [0m[35m    resp = http_client.get([0m
[30;1m607 | [0m[35m        endpoint,[0m
[30;1m608 | [0m[35m        params={"api-version": "2020-06-01", "resource": resource},[0m
[30;1m609 | [0m[35m        headers={"Metadata": "true"},[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m            "ArgumentNullOrEmpty": "invalid_scope",[0m
[30;1m585 | [0m[35m            }[0m
[30;1m586 | [0m[35m        return {[0m
[30;1m587 | [0m[35m            "error": error_mapping.get(payload["error"]["code"], "invalid_request"),[0m
[30;1m588 | [0m[35m            "error_description": resp.text,[0m
[30;1m589 | [0m[35m            }[0m
[30;1m590 | [0m[35m    except json.decoder.JSONDecodeError:[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m577 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m578 | [0m[35m                "token_type": payload["token_type"],[0m
[30;1m579 | [0m[35m                }[0m
[30;1m580 | [0m[35m        error = payload.get("error", {})  # https://learn.microsoft.com/en-us/azure/service-fabric/h[0m
[30;1m581 | [0m[35m        error_mapping = {  # Map Service Fabric errors into OAuth2 errors  https://www.rfc-editor.or[0m
[30;1m582 | [0m[35m            "SecretHeaderNotFound": "unauthorized_client",[0m
[30;1m583 | [0m[35m            "ManagedIdentityNotFound": "invalid_client",[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m574 | [0m[35m                "expires_in": int(  # Despite the example in docs shows an integer,[0m
[30;1m575 | [0m[35m                    payload["expires_on"]  # Azure SDK team's test obtained a string.[0m
[30;1m576 | [0m[35m                    ) - int(time.time()),[0m
[30;1m577 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m578 | [0m[35m                "token_type": payload["token_type"],[0m
[30;1m579 | [0m[35m                }[0m
[30;1m580 | [0m[35m        error = payload.get("error", {})  # https://learn.microsoft.com/en-us/azure/service-fabric/h[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m568 | [0m[35m        )[0m
[30;1m569 | [0m[35m    try:[0m
[30;1m570 | [0m[35m        payload = json.loads(resp.text)[0m
[30;1m571 | [0m[35m        if payload.get("access_token") and payload.get("expires_on"):[0m
[30;1m572 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m573 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m574 | [0m[35m                "expires_in": int(  # Despite the example in docs shows an integer,[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m568 | [0m[35m        )[0m
[30;1m569 | [0m[35m    try:[0m
[30;1m570 | [0m[35m        payload = json.loads(resp.text)[0m
[30;1m571 | [0m[35m        if payload.get("access_token") and payload.get("expires_on"):[0m
[30;1m572 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m573 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m574 | [0m[35m                "expires_in": int(  # Despite the example in docs shows an integer,[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m561 | [0m[35m    # See also https://github.com/Azure/azure-sdk-for-python/blob/main/sdk/identity/azure-identity/t[0m
[30;1m562 | [0m[35m    # Protocol https://learn.microsoft.com/en-us/azure/service-fabric/how-to-managed-identity-servic[0m
[30;1m563 | [0m[35m    logger.debug("Obtaining token via managed identity on Azure Service Fabric")[0m
[30;1m564 | [0m[35m    resp = http_client.get([0m
[30;1m565 | [0m[35m        endpoint,[0m
[30;1m566 | [0m[35m        params={"api-version": "2019-07-01-preview", "resource": resource},[0m
[30;1m567 | [0m[35m        headers={"Secret": identity_header},[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m540 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m541 | [0m[35m                "expires_in": int(payload["expires_on"]) - int(time.time()),[0m
[30;1m542 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m543 | [0m[35m                "token_type": payload.get("token_type", "Bearer"),[0m
[30;1m544 | [0m[35m                }[0m
[30;1m545 | [0m[35m        return {[0m
[30;1m546 | [0m[35m            "error": "invalid_scope",  # TODO: To be tested[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m539 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m540 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m541 | [0m[35m                "expires_in": int(payload["expires_on"]) - int(time.time()),[0m
[30;1m542 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m543 | [0m[35m                "token_type": payload.get("token_type", "Bearer"),[0m
[30;1m544 | [0m[35m                }[0m
[30;1m545 | [0m[35m        return {[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m535 | [0m[35m        )[0m
[30;1m536 | [0m[35m    try:[0m
[30;1m537 | [0m[35m        payload = json.loads(resp.text)[0m
[30;1m538 | [0m[35m        if payload.get("access_token") and payload.get("expires_on"):[0m
[30;1m539 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m540 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m541 | [0m[35m                "expires_in": int(payload["expires_on"]) - int(time.time()),[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m535 | [0m[35m        )[0m
[30;1m536 | [0m[35m    try:[0m
[30;1m537 | [0m[35m        payload = json.loads(resp.text)[0m
[30;1m538 | [0m[35m        if payload.get("access_token") and payload.get("expires_on"):[0m
[30;1m539 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m540 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m541 | [0m[35m                "expires_in": int(payload["expires_on"]) - int(time.time()),[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m528 | [0m[35m    if params["api-version"] == "2017-09-01" and "client_id" in params:[0m
[30;1m529 | [0m[35m        # Workaround for a known bug in Azure ML 2017 API[0m
[30;1m530 | [0m[35m        params["clientid"] = params.pop("client_id")[0m
[30;1m531 | [0m[35m    resp = http_client.get([0m
[30;1m532 | [0m[35m        endpoint,[0m
[30;1m533 | [0m[35m        params=params,[0m
[30;1m534 | [0m[35m        headers={"secret": secret},[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m511 | [0m[35m        return {[0m
[30;1m512 | [0m[35m            "error": "invalid_scope",  # Empirically, wrong resource ends up with a vague statusCode[0m
[30;1m513 | [0m[35m            "error_description": "{}, {}".format([0m
[30;1m514 | [0m[35m                payload.get("statusCode"), payload.get("message")),[0m
[30;1m515 | [0m[35m            }[0m
[30;1m516 | [0m[35m    except json.decoder.JSONDecodeError:[0m
[30;1m517 | [0m[35m        logger.debug("IMDS emits unexpected payload: %s", resp.text)[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m511 | [0m[35m        return {[0m
[30;1m512 | [0m[35m            "error": "invalid_scope",  # Empirically, wrong resource ends up with a vague statusCode[0m
[30;1m513 | [0m[35m            "error_description": "{}, {}".format([0m
[30;1m514 | [0m[35m                payload.get("statusCode"), payload.get("message")),[0m
[30;1m515 | [0m[35m            }[0m
[30;1m516 | [0m[35m    except json.decoder.JSONDecodeError:[0m
[30;1m517 | [0m[35m        logger.debug("IMDS emits unexpected payload: %s", resp.text)[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m506 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m507 | [0m[35m                "expires_in": int(payload["expires_on"]) - int(time.time()),[0m
[30;1m508 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m509 | [0m[35m                "token_type": payload.get("token_type", "Bearer"),[0m
[30;1m510 | [0m[35m                }[0m
[30;1m511 | [0m[35m        return {[0m
[30;1m512 | [0m[35m            "error": "invalid_scope",  # Empirically, wrong resource ends up with a vague statusCode[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m506 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m507 | [0m[35m                "expires_in": int(payload["expires_on"]) - int(time.time()),[0m
[30;1m508 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m509 | [0m[35m                "token_type": payload.get("token_type", "Bearer"),[0m
[30;1m510 | [0m[35m                }[0m
[30;1m511 | [0m[35m        return {[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m        )[0m
[30;1m502 | [0m[35m    try:[0m
[30;1m503 | [0m[35m        payload = json.loads(resp.text)[0m
[30;1m504 | [0m[35m        if payload.get("access_token") and payload.get("expires_on"):[0m
[30;1m505 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m506 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m507 | [0m[35m                "expires_in": int(payload["expires_on"]) - int(time.time()),[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m        )[0m
[30;1m502 | [0m[35m    try:[0m
[30;1m503 | [0m[35m        payload = json.loads(resp.text)[0m
[30;1m504 | [0m[35m        if payload.get("access_token") and payload.get("expires_on"):[0m
[30;1m505 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m506 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m507 | [0m[35m                "expires_in": int(payload["expires_on"]) - int(time.time()),[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m489 | [0m[35m        ManagedIdentity.OBJECT_ID: "object_id",[0m
[30;1m490 | [0m[35m    })[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m    resp = http_client.get([0m
[30;1m493 | [0m[35m        endpoint,[0m
[30;1m494 | [0m[35m        params=params,[0m
[30;1m495 | [0m[35m        headers={[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m462 | [0m[35m                "expires_in": int(payload["expires_in"]),[0m
[30;1m463 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m464 | [0m[35m                "token_type": payload.get("token_type", "Bearer"),[0m
[30;1m465 | [0m[35m                }[0m
[30;1m466 | [0m[35m        return payload  # It would be {"error": ..., "error_description": ...} according to https://[0m
[30;1m467 | [0m[35m    except json.decoder.JSONDecodeError:[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m461 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m462 | [0m[35m                "expires_in": int(payload["expires_in"]),[0m
[30;1m463 | [0m[35m                "resource": payload.get("resource"),[0m
[30;1m464 | [0m[35m                "token_type": payload.get("token_type", "Bearer"),[0m
[30;1m465 | [0m[35m                }[0m
[30;1m466 | [0m[35m        return payload  # It would be {"error": ..., "error_description": ...} according to https://[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m456 | [0m[35m        )[0m
[30;1m457 | [0m[35m    try:[0m
[30;1m458 | [0m[35m        payload = json.loads(resp.text)[0m
[30;1m459 | [0m[35m        if payload.get("access_token") and payload.get("expires_in"):[0m
[30;1m460 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m461 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m462 | [0m[35m                "expires_in": int(payload["expires_in"]),[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m456 | [0m[35m        )[0m
[30;1m457 | [0m[35m    try:[0m
[30;1m458 | [0m[35m        payload = json.loads(resp.text)[0m
[30;1m459 | [0m[35m        if payload.get("access_token") and payload.get("expires_in"):[0m
[30;1m460 | [0m[35m            return {  # Normalizing the payload into OAuth2 format[0m
[30;1m461 | [0m[35m                "access_token": payload["access_token"],[0m
[30;1m462 | [0m[35m                "expires_in": int(payload["expires_in"]),[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m447 | [0m[35m        "resource": resource,[0m
[30;1m448 | [0m[35m        }[0m
[30;1m449 | [0m[35m    _adjust_param(params, managed_identity)[0m
[30;1m450 | [0m[35m    resp = http_client.get([0m
[30;1m451 | [0m[35m        os.getenv([0m
[30;1m452 | [0m[35m            "AZURE_POD_IDENTITY_AUTHORITY_HOST", "http://169.254.169.254"[0m
[30;1m453 | [0m[35m            ).strip("/") + "/metadata/identity/oauth2/token",[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m435 | [0m[35mdef _adjust_param(params, managed_identity, types_mapping=None):[0m
[30;1m436 | [0m[35m    # Modify the params dict in place[0m
[30;1m437 | [0m[35m    id_name = (types_mapping or ManagedIdentity._types_mapping).get([0m
[30;1m438 | [0m[35m        managed_identity.get(ManagedIdentity.ID_TYPE))[0m
[30;1m439 | [0m[35m    if id_name:[0m
[30;1m440 | [0m[35m        params[id_name] = managed_identity[ManagedIdentity.ID][0m
[30;1m441 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35mdef _adjust_param(params, managed_identity, types_mapping=None):[0m
[30;1m436 | [0m[35m    # Modify the params dict in place[0m
[30;1m437 | [0m[35m    id_name = (types_mapping or ManagedIdentity._types_mapping).get([0m
[30;1m438 | [0m[35m        managed_identity.get(ManagedIdentity.ID_TYPE))[0m
[30;1m439 | [0m[35m    if id_name:[0m
[30;1m440 | [0m[35m        params[id_name] = managed_identity[ManagedIdentity.ID][0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m        try:[0m
[30;1m313 | [0m[35m            result = _obtain_token(self._http_client, self._managed_identity, resource)[0m
[30;1m314 | [0m[35m            if "access_token" in result:[0m
[30;1m315 | [0m[35m                expires_in = result.get("expires_in", 3600)[0m
[30;1m316 | [0m[35m                if "refresh_in" not in result and expires_in >= 7200:[0m
[30;1m317 | [0m[35m                    result["refresh_in"] = int(expires_in / 2)[0m
[30;1m318 | [0m[35m                self._token_cache.add(dict([0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m300 | [0m[35m                logger.debug("Cache hit an AT")[0m
[30;1m301 | [0m[35m                access_token_from_cache = {  # Mimic a real response[0m
[30;1m302 | [0m[35m                    "access_token": entry["secret"],[0m
[30;1m303 | [0m[35m                    "token_type": entry.get("token_type", "Bearer"),[0m
[30;1m304 | [0m[35m                    "expires_in": int(expires_in),  # OAuth2 specs defines it as int[0m
[30;1m305 | [0m[35m                    self._TOKEN_SOURCE: self._TOKEN_SOURCE_CACHE,[0m
[30;1m306 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m            `Azure VM docs <https://learn.microsoft.com/en-us/azure/active-directory/managed-identit[0m
[30;1m280 | [0m[35m        """[0m
[30;1m281 | [0m[35m        access_token_from_cache = None[0m
[30;1m282 | [0m[35m        client_id_in_cache = self._managed_identity.get([0m
[30;1m283 | [0m[35m            ManagedIdentity.ID, "SYSTEM_ASSIGNED_MANAGED_IDENTITY")[0m
[30;1m284 | [0m[35m        now = time.time()[0m
[30;1m285 | [0m[35m        if not claims_challenge:  # Then attempt token cache search[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m                self._hash([0m
[30;1m122 | [0m[35m                    # Managed Identity flavors have inconsistent parameters.[0m
[30;1m123 | [0m[35m                    # We simply choose to hash them all.[0m
[30;1m124 | [0m[35m                    str(kwargs.get("params")) + str(kwargs.get("data"))),[0m
[30;1m125 | [0m[35m                ),[0m
[30;1m126 | [0m[35m            expires_in=RetryAfterParser(5).parse,  # 5 seconds default for non-PCA[0m
[30;1m127 | [0m[35m            )(http_client.get)[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m                self._hash([0m
[30;1m122 | [0m[35m                    # Managed Identity flavors have inconsistent parameters.[0m
[30;1m123 | [0m[35m                    # We simply choose to hash them all.[0m
[30;1m124 | [0m[35m                    str(kwargs.get("params")) + str(kwargs.get("data"))),[0m
[30;1m125 | [0m[35m                ),[0m
[30;1m126 | [0m[35m            expires_in=RetryAfterParser(5).parse,  # 5 seconds default for non-PCA[0m
[30;1m127 | [0m[35m            )(http_client.get)[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        return isinstance(unknown, UserAssignedManagedIdentity) or ([0m
[30;1m62 | [0m[35m            isinstance(unknown, dict)[0m
[30;1m63 | [0m[35m            and unknown.get(cls.ID_TYPE) in cls._types_mapping[0m
[30;1m64 | [0m[35m            and unknown.get(cls.ID))[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def __init__(self, identifier=None, id_type=None):[0m
[30;1m67 | [0m[35m        # Undocumented. Use subclasses instead.[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m    def is_user_assigned(cls, unknown):[0m
[30;1m61 | [0m[35m        return isinstance(unknown, UserAssignedManagedIdentity) or ([0m
[30;1m62 | [0m[35m            isinstance(unknown, dict)[0m
[30;1m63 | [0m[35m            and unknown.get(cls.ID_TYPE) in cls._types_mapping[0m
[30;1m64 | [0m[35m            and unknown.get(cls.ID))[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def __init__(self, identifier=None, id_type=None):[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    def is_system_assigned(cls, unknown):[0m
[30;1m55 | [0m[35m        return isinstance(unknown, SystemAssignedManagedIdentity) or ([0m
[30;1m56 | [0m[35m            isinstance(unknown, dict)[0m
[30;1m57 | [0m[35m            and unknown.get(cls.ID_TYPE) == cls.SYSTEM_ASSIGNED)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    @classmethod[0m
[30;1m60 | [0m[35m    def is_user_assigned(cls, unknown):[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m578 | [0m[35m                "token_type": payload["token_type"],[0m
[30;1m579 | [0m[35m                }[0m
[30;1m580 | [0m[35m        error = payload.get("error", {})  # https://learn.microsoft.com/en-us/azure/service-fabric/h[0m
[30;1m581 | [0m[35m        error_mapping = {  # Map Service Fabric errors into OAuth2 errors  https://www.rfc-editor.or[0m
[30;1m582 | [0m[35m            "SecretHeaderNotFound": "unauthorized_client",[0m
[30;1m583 | [0m[35m            "ManagedIdentityNotFound": "invalid_client",[0m
[30;1m584 | [0m[35m            "ArgumentNullOrEmpty": "invalid_scope",[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m561 | [0m[35my/azure-identity/tests/managed-identity-live/service-fabric/service_fabric.md[0m
[30;1m562 | [0m[35m    # Protocol https://learn.microsoft.com/en-us/azure/service-fabric/how-to-managed-identity-servic[0m
[30;1m563 | [0m[35m    logger.debug("Obtaining token via managed identity on Azure Service Fabric")[0m
[30;1m564 | [0m[35m    resp = http_client.get([0m
[30;1m565 | [0m[35m        endpoint,[0m
[30;1m566 | [0m[35m        params={"api-version": "2019-07-01-preview", "resource": resource},[0m
[30;1m567 | [0m[35m        headers={"Secret": identity_header},[0m
[30;1m568 | [0m[35m        )[0m
[30;1m569 | [0m[35m    try:[0m
[30;1m570 | [0m[35m        payload = json.loads(resp.text)[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m520 | [0m[35mdef _obtain_token_on_machine_learning([0m
[30;1m521 | [0m[35m    http_client, endpoint, secret, managed_identity, resource,[0m
[30;1m522 | [0m[35m):[0m
[30;1m523 | [0m[35m    # Could not find protocol docs from https://docs.microsoft.com/en-us/azure/machine-learning[0m
[30;1m524 | [0m[35m    # The following implementation is back ported from Azure Identity 1.15.0[0m
[30;1m525 | [0m[35m    logger.debug("Obtaining token via managed identity on Azure Machine Learning")[0m
[30;1m526 | [0m[35m    params = {"api-version": "2017-09-01", "resource": resource}[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m477 | [0m[35m    """[0m
[30;1m478 | [0m[35m    # Prerequisite: Create your app service https://docs.microsoft.com/en-us/azure/app-service/quick[0m
[30;1m479 | [0m[35m    # Assign it a managed identity https://docs.microsoft.com/en-us/azure/app-service/overview-manag[0m
[30;1m480 | [0m[35m    # SSH into your container for testing https://docs.microsoft.com/en-us/azure/app-service/configu[0m
[30;1m481 | [0m[35m    logger.debug("Obtaining token via managed identity on Azure App Service")[0m
[30;1m482 | [0m[35m    params = {[0m
[30;1m483 | [0m[35m        "api-version": "2019-08-01",[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m472 | [0m[35mentity_header, managed_identity, resource,[0m
[30;1m473 | [0m[35m):[0m
[30;1m474 | [0m[35m    """Obtains token for[0m
[30;1m475 | [0m[35m    `App Service <https://learn.microsoft.com/en-us/azure/app-service/overview-managed-identity?tabs[0m
[30;1m476 | [0m[35m    Azure Functions, and Azure Automation.[0m
[30;1m477 | [0m[35m    """[0m
[30;1m478 | [0m[35m    # Prerequisite: Create your app service https://docs.microsoft.com/en-us/azure/app-service/quick[0m
[30;1m479 | [0m[35m    # Assign it a managed identity https://docs.microsoft.com/en-us/azure/app-service/overview-manag[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m472 | [0m[35m    http_client, endpoint, identity_header, managed_identity, resource,[0m
[30;1m473 | [0m[35m):[0m
[30;1m474 | [0m[35m    """Obtains token for[0m
[30;1m475 | [0m[35m    `App Service <https://learn.microsoft.com/en-us/azure/app-service/overview-managed-identity?tabs[0m
[30;1m476 | [0m[35m    Azure Functions, and Azure Automation.[0m
[30;1m477 | [0m[35m    """[0m
[30;1m478 | [0m[35m    # Prerequisite: Create your app service https://docs.microsoft.com/en-us/azure/app-service/quick[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m393 | [0m[35m        if managed_identity:[0m
[30;1m394 | [0m[35m            logger.debug([0m
[30;1m395 | [0m[35m                "Ignoring managed_identity parameter. "[0m
[30;1m396 | [0m[35m                "Managed Identity in Service Fabric is configured in the cluster, "[0m
[30;1m397 | [0m[35m                "not during runtime. See also "[0m
[30;1m398 | [0m[35m                "https://learn.microsoft.com/en-us/azure/service-fabric/configure-existing-cluster-e[0m
[30;1m399 | [0m[35m        return _obtain_token_on_service_fabric([0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35mn VM defines exotic 404 and 410 retry recommendations[0m
[30;1m232 | [0m[35m            #    ( https://learn.microsoft.com/en-us/entra/identity/managed-identities-azure-resourc[0m
[30;1m233 | [0m[35m            #    (especially for 410 which was supposed to be a permanent failure).[0m
[30;1m234 | [0m[35m            # 2. MI on Service Fabric specifically suggests to not retry on 404.[0m
[30;1m235 | [0m[35m            #    ( https://learn.microsoft.com/en-us/azure/service-fabric/how-to-managed-cluster-man[0m
[30;1m236 | [0m[35m            http_client.http_client  # Patch the raw (unpatched) http client[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m            import json, os, msal, requests[0m
[30;1m213 | [0m[35m            config = os.getenv("MY_MANAGED_IDENTITY_CONFIG")[0m
[30;1m214 | [0m[35m            assert config, "An ENV VAR with value should exist"[0m
[30;1m215 | [0m[35m            client = msal.ManagedIdentityClient([0m
[30;1m216 | [0m[35m                json.loads(config),[0m
[30;1m217 | [0m[35m                http_client=requests.Session(),[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m            It accepts an instance of :class:`SystemAssignedManagedIdentity`[0m
[30;1m170 | [0m[35m            or :class:`UserAssignedManagedIdentity`.[0m
[30;1m171 | [0m[35m            They are equivalent to a dict with a certain shape,[0m
[30;1m172 | [0m[35m            which may be loaded from a JSON configuration file or an env var.[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        :param http_client:[0m
[30;1m175 | [0m[35m            An http client object. For example, you can use ``requests.Session()``,[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35mclass ManagedIdentityClient(object):[0m
[30;1m131 | [0m[35m    """This API encapsulates multiple managed identity back-ends:[0m
[30;1m132 | [0m[35m    VM, App Service, Azure Automation (Runbooks), Azure Function, Service Fabric,[0m
[30;1m133 | [0m[35m    and Azure Arc.[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    It also provides token cache support.[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/managed_identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport socket[0m
[30;1m9 | [0m[35mimport sys[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mfrom urllib.parse import urlparse  # Python 3+[0m
[30;1m12 | [0m[35mfrom collections import UserDict  # Python 3+[0m
[30;1m13 | [0m[35mfrom typing import Optional, Union  # Needed in Python 3.7 & 3.8[0m
[30;1m14 | [0m[35mfrom .token_cache import TokenCache[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m    POP_SCOPE = ['6256c85f-0aad-4d50-b960-e6e9b21efe35/.default']  # KAP 1P Server App Scope, obtain[0m
[30;1m205 | [0m[35m    result = _acquire_token_interactive(app, scopes=POP_SCOPE, data=_POP_DATA)[0m
[30;1m206 | [0m[35m    print_json(result)[0m
[30;1m207 | [0m[35m    if result.get("token_type") != "pop":[0m
[30;1m208 | [0m[35m        logging.error("Unable to acquire a pop token")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35mdef _remove_account(app):[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m    """Acquire an SSH Cert interactively - This typically only works with Azure CLI"""[0m
[30;1m187 | [0m[35m    assert isinstance(app, msal.PublicClientApplication)[0m
[30;1m188 | [0m[35m    result = _acquire_token_interactive(app, scopes=_SSH_CERT_SCOPE, data=_SSH_CERT_DATA)[0m
[30;1m189 | [0m[35m    if result.get("token_type") != "ssh-cert":[0m
[30;1m190 | [0m[35m        logging.error("Unable to acquire an ssh-cert")[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m_POP_KEY_ID = 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA-AAAAAAAA'  # Fake key with a certain format and le[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m            force_refresh=_input_boolean("Bypass MSAL Python's token cache?"),[0m
[30;1m180 | [0m[35m            )[0m
[30;1m181 | [0m[35m        print_json(result)[0m
[30;1m182 | [0m[35m        if result and result.get("token_type") != "ssh-cert":[0m
[30;1m183 | [0m[35m            logging.error("Unable to acquire an ssh-cert.")[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35mdef _acquire_ssh_cert_interactive(app):[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m            else None,[0m
[30;1m143 | [0m[35m        )[0m
[30;1m144 | [0m[35m    if login_hint and "id_token_claims" in result:[0m
[30;1m145 | [0m[35m        signed_in_user = result.get("id_token_claims", {}).get("preferred_username")[0m
[30;1m146 | [0m[35m        if signed_in_user != login_hint:[0m
[30;1m147 | [0m[35m            logging.warning('Signed-in user "%s" does not match login_hint', signed_in_user)[0m
[30;1m148 | [0m[35m    print_json(result)[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m            else None,[0m
[30;1m143 | [0m[35m        )[0m
[30;1m144 | [0m[35m    if login_hint and "id_token_claims" in result:[0m
[30;1m145 | [0m[35m        signed_in_user = result.get("id_token_claims", {}).get("preferred_username")[0m
[30;1m146 | [0m[35m        if signed_in_user != login_hint:[0m
[30;1m147 | [0m[35m            logging.warning('Signed-in user "%s" does not match login_hint', signed_in_user)[0m
[30;1m148 | [0m[35m    print_json(result)[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m138 | [0m[35m        port=1234,  # Hard coded for testing. Real app typically uses default value.[0m
[30;1m139 | [0m[35m        prompt=prompt, login_hint=login_hint, data=data or {},[0m
[30;1m140 | [0m[35m        auth_scheme=placeholder_auth_scheme[0m
[30;1m141 | [0m[35m            if app.is_pop_supported() and _input_boolean("Acquire AT POP via Broker?")[0m
[30;1m142 | [0m[35m            else None,[0m
[30;1m143 | [0m[35m        )[0m
[30;1m144 | [0m[35m    if login_hint and "id_token_claims" in result:[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m105 | [0m[35m            account=account,[0m
[30;1m106 | [0m[35m            force_refresh=_input_boolean("Bypass MSAL Python's token cache?"),[0m
[30;1m107 | [0m[35m            auth_scheme=placeholder_auth_scheme[0m
[30;1m108 | [0m[35m                if app.is_pop_supported() and _input_boolean("Acquire AT POP via Broker?")[0m
[30;1m109 | [0m[35m                else None,[0m
[30;1m110 | [0m[35m            ))[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m    'token_type': 'pop',[0m
[30;1m196 | [0m[35m    'key_id': _POP_KEY_ID,[0m
[30;1m197 | [0m[35m    "req_cnf": base64.urlsafe_b64encode(_RAW_REQ_CNF.encode('utf-8')).decode('utf-8').rstrip('='),[0m
[30;1m198 | [0m[35m        # Note: Sending _RAW_REQ_CNF without base64 encoding would result in an http 500 error[0m
[30;1m199 | [0m[35m}  # See also https://github.com/Azure/azure-cli-extensions/blob/main/src/connectedk8s/azext_connect[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35mdef _acquire_pop_token_interactive(app):[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m183 | [0m[35m            logging.error("Unable to acquire an ssh-cert.")[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35mdef _acquire_ssh_cert_interactive(app):[0m
[30;1m186 | [0m[35m    """Acquire an SSH Cert interactively - This typically only works with Azure CLI"""[0m
[30;1m187 | [0m[35m    assert isinstance(app, msal.PublicClientApplication)[0m
[30;1m188 | [0m[35m    result = _acquire_token_interactive(app, scopes=_SSH_CERT_SCOPE, data=_SSH_CERT_DATA)[0m
[30;1m189 | [0m[35m    if result.get("token_type") != "ssh-cert":[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m_SSH_CERT_SCOPE = ["https://pas.windows.net/CheckMyAccess/Linux/.default"][0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35mdef _acquire_ssh_cert_silently(app):[0m
[30;1m171 | [0m[35m    """Acquire an SSH Cert silently- This typically only works with Azure CLI"""[0m
[30;1m172 | [0m[35m    assert isinstance(app, msal.PublicClientApplication)[0m
[30;1m173 | [0m[35m    account = _select_account(app)[0m
[30;1m174 | [0m[35m    if account:[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mUsage 1: Run it on the fly.[0m
[30;1m7 | [0m[35m    python -m msal[0m
[30;1m8 | [0m[35m    Note: We choose to not define a console script to avoid name conflict.[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mUsage 2: Build an all-in-one executable file for bug bash.[0m
[30;1m11 | [0m[35m    shiv -e msal.__main__._main -o msaltest-on-os-name.pyz .[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/wstrust_request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m            "Contact your administrator to check your ADFS's MEX settings." % soap_action)[0m
[30;1m50 | [0m[35m    data = _build_rst([0m
[30;1m51 | [0m[35m        username, password, cloud_audience_urn, endpoint_address, soap_action)[0m
[30;1m52 | [0m[35m    resp = http_client.post(endpoint_address, data=data, headers={[0m
[30;1m53 | [0m[35m            'Content-type':'application/soap+xml; charset=utf-8',[0m
[30;1m54 | [0m[35m            'SOAPAction': soap_action,[0m
[30;1m55 | [0m[35m            }, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2385 | [0m[35m                "Using /common or /organizations authority "[0m
[30;1m2386 | [0m[35m                "in acquire_token_for_client() is unreliable. "[0m
[30;1m2387 | [0m[35m                "Please use a specific tenant instead.", DeprecationWarning)[0m
[30;1m2388 | [0m[35m        self._validate_ssh_cert_input_data(kwargs.get("data", {}))[0m
[30;1m2389 | [0m[35m        telemetry_context = self._build_telemetry_context([0m
[30;1m2390 | [0m[35m            self.ACQUIRE_TOKEN_FOR_CLIENT_ID, refresh_reason=refresh_reason)[0m
[30;1m2391 | [0m[35m        client = self._regional_client or self.client[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2366 | [0m[35m            - A successful response would contain "access_token" key,[0m
[30;1m2367 | [0m[35m            - an error response would contain "error" and usually "error_description".[0m
[30;1m2368 | [0m[35m        """[0m
[30;1m2369 | [0m[35m        if kwargs.get("force_refresh"):[0m
[30;1m2370 | [0m[35m            raise ValueError(  # We choose to disallow force_refresh[0m
[30;1m2371 | [0m[35m                "Historically, this method does not support force_refresh behavior. "[0m
[30;1m2372 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2323 | [0m[35m        """[0m
[30;1m2324 | [0m[35m        telemetry_context = self._build_telemetry_context([0m
[30;1m2325 | [0m[35m            self.ACQUIRE_TOKEN_BY_DEVICE_FLOW_ID,[0m
[30;1m2326 | [0m[35m            correlation_id=flow.get(self.DEVICE_FLOW_CORRELATION_ID))[0m
[30;1m2327 | [0m[35m        response = _clean_up(self.client.obtain_token_by_device_flow([0m
[30;1m2328 | [0m[35m            flow,[0m
[30;1m2329 | [0m[35m            data=dict([0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2262 | [0m[35m                    Response_Status.Status_AccountUnusable,[0m
[30;1m2263 | [0m[35m                    Response_Status.Status_InteractionRequired,[0m
[30;1m2264 | [0m[35m                    ])[0m
[30;1m2265 | [0m[35m                if is_wrong_account or "error" in response and response.get([0m
[30;1m2266 | [0m[35m                        "_broker_status") in recoverable_errors:[0m
[30;1m2267 | [0m[35m                    pass  # It will fall back to the _signin_interactively()[0m
[30;1m2268 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2245 | [0m[35m                # but this seems to have been fixed in PyMsalRuntime 0.11.2[0m
[30;1m2246 | [0m[35m                "access_token" in response and login_hint[0m
[30;1m2247 | [0m[35m                and login_hint != response.get([0m
[30;1m2248 | [0m[35m                    "id_token_claims", {}).get("preferred_username"))[0m
[30;1m2249 | [0m[35m            wrong_account_error_message = ([0m
[30;1m2250 | [0m[35m                'prompt="none" will not work for login_hint="non-default-user"')[0m
[30;1m2251 | [0m[35m            if is_wrong_account:[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2244 | [0m[35m                # _signin_silently() only gets tokens for default account,[0m
[30;1m2245 | [0m[35m                # but this seems to have been fixed in PyMsalRuntime 0.11.2[0m
[30;1m2246 | [0m[35m                "access_token" in response and login_hint[0m
[30;1m2247 | [0m[35m                and login_hint != response.get([0m
[30;1m2248 | [0m[35m                    "id_token_claims", {}).get("preferred_username"))[0m
[30;1m2249 | [0m[35m            wrong_account_error_message = ([0m
[30;1m2250 | [0m[35m                'prompt="none" will not work for login_hint="non-default-user"')[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2130 | [0m[35m                # More background of MSA-PT is available from this internal docs:[0m
[30;1m2131 | [0m[35m                # https://microsoft.sharepoint.com/:w:/t/Identity-DevEx/EatIUauX3c9Ctw1l7AQ6iM8B5CeB[0m
[30;1m2132 | [0m[35m            False[0m
[30;1m2133 | [0m[35m            ) and data.get("token_type") != "ssh-cert"  # Work around a known issue as of PyMsalRunt[0m
[30;1m2134 | [0m[35m        self._validate_ssh_cert_input_data(data)[0m
[30;1m2135 | [0m[35m        if not on_before_launching_ui:[0m
[30;1m2136 | [0m[35m            on_before_launching_ui = lambda **kwargs: None[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1901 | [0m[35m            }.get(wstrust_result.get("type"))[0m
[30;1m1902 | [0m[35m        if not grant_type:[0m
[30;1m1903 | [0m[35m            raise RuntimeError([0m
[30;1m1904 | [0m[35m                "RSTR returned unknown token type: %s", wstrust_result.get("type"))[0m
[30;1m1905 | [0m[35m        self.client.grant_assertion_encoders.setdefault(  # Register a non-standard type[0m
[30;1m1906 | [0m[35m            grant_type, self.client.encode_saml_assertion)[0m
[30;1m1907 | [0m[35m        return self.client.obtain_token_by_assertion([0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1898 | [0m[35m            SAML_TOKEN_TYPE_V2: self.client.GRANT_TYPE_SAML2,[0m
[30;1m1899 | [0m[35m            WSS_SAML_TOKEN_PROFILE_V1_1: GRANT_TYPE_SAML1_1,[0m
[30;1m1900 | [0m[35m            WSS_SAML_TOKEN_PROFILE_V2: self.client.GRANT_TYPE_SAML2[0m
[30;1m1901 | [0m[35m            }.get(wstrust_result.get("type"))[0m
[30;1m1902 | [0m[35m        if not grant_type:[0m
[30;1m1903 | [0m[35m            raise RuntimeError([0m
[30;1m1904 | [0m[35m                "RSTR returned unknown token type: %s", wstrust_result.get("type"))[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1898 | [0m[35m            SAML_TOKEN_TYPE_V2: self.client.GRANT_TYPE_SAML2,[0m
[30;1m1899 | [0m[35m            WSS_SAML_TOKEN_PROFILE_V1_1: GRANT_TYPE_SAML1_1,[0m
[30;1m1900 | [0m[35m            WSS_SAML_TOKEN_PROFILE_V2: self.client.GRANT_TYPE_SAML2[0m
[30;1m1901 | [0m[35m            }.get(wstrust_result.get("type"))[0m
[30;1m1902 | [0m[35m        if not grant_type:[0m
[30;1m1903 | [0m[35m            raise RuntimeError([0m
[30;1m1904 | [0m[35m                "RSTR returned unknown token type: %s", wstrust_result.get("type"))[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1889 | [0m[35m            wstrust_endpoint.get("address",[0m
[30;1m1890 | [0m[35m                # Fallback to an AAD supplied endpoint[0m
[30;1m1891 | [0m[35m                user_realm_result.get("federation_active_auth_url")),[0m
[30;1m1892 | [0m[35m            wstrust_endpoint.get("action"), self.http_client)[0m
[30;1m1893 | [0m[35m        if not ("token" in wstrust_result and "type" in wstrust_result):[0m
[30;1m1894 | [0m[35m            raise RuntimeError("Unsuccessful RSTR. %s" % wstrust_result)[0m
[30;1m1895 | [0m[35m        GRANT_TYPE_SAML1_1 = 'urn:ietf:params:oauth:grant-type:saml1_1-bearer'[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1888 | [0m[35m            user_realm_result.get("cloud_audience_urn", "urn:federation:MicrosoftOnline"),[0m
[30;1m1889 | [0m[35m            wstrust_endpoint.get("address",[0m
[30;1m1890 | [0m[35m                # Fallback to an AAD supplied endpoint[0m
[30;1m1891 | [0m[35m                user_realm_result.get("federation_active_auth_url")),[0m
[30;1m1892 | [0m[35m            wstrust_endpoint.get("action"), self.http_client)[0m
[30;1m1893 | [0m[35m        if not ("token" in wstrust_result and "type" in wstrust_result):[0m
[30;1m1894 | [0m[35m            raise RuntimeError("Unsuccessful RSTR. %s" % wstrust_result)[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1886 | [0m[35m        wstrust_result = wst_send_request([0m
[30;1m1887 | [0m[35m            username, password,[0m
[30;1m1888 | [0m[35m            user_realm_result.get("cloud_audience_urn", "urn:federation:MicrosoftOnline"),[0m
[30;1m1889 | [0m[35m            wstrust_endpoint.get("address",[0m
[30;1m1890 | [0m[35m                # Fallback to an AAD supplied endpoint[0m
[30;1m1891 | [0m[35m                user_realm_result.get("federation_active_auth_url")),[0m
[30;1m1892 | [0m[35m            wstrust_endpoint.get("action"), self.http_client)[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1885 | [0m[35m        logger.debug("wstrust_endpoint = %s", wstrust_endpoint)[0m
[30;1m1886 | [0m[35m        wstrust_result = wst_send_request([0m
[30;1m1887 | [0m[35m            username, password,[0m
[30;1m1888 | [0m[35m            user_realm_result.get("cloud_audience_urn", "urn:federation:MicrosoftOnline"),[0m
[30;1m1889 | [0m[35m            wstrust_endpoint.get("address",[0m
[30;1m1890 | [0m[35m                # Fallback to an AAD supplied endpoint[0m
[30;1m1891 | [0m[35m                user_realm_result.get("federation_active_auth_url")),[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1873 | [0m[35m    def _acquire_token_by_username_password_federated([0m
[30;1m1874 | [0m[35m            self, user_realm_result, username, password, scopes=None, **kwargs):[0m
[30;1m1875 | [0m[35m        wstrust_endpoint = {}[0m
[30;1m1876 | [0m[35m        if user_realm_result.get("federation_metadata_url"):[0m
[30;1m1877 | [0m[35m            wstrust_endpoint = mex_send_request([0m
[30;1m1878 | [0m[35m                user_realm_result["federation_metadata_url"],[0m
[30;1m1879 | [0m[35m                self.http_client)[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1854 | [0m[35m        if not self.authority.is_adfs:[0m
[30;1m1855 | [0m[35m            user_realm_result = self.authority.user_realm_discovery([0m
[30;1m1856 | [0m[35m                username, correlation_id=headers[msal.telemetry.CLIENT_REQUEST_ID])[0m
[30;1m1857 | [0m[35m            if user_realm_result.get("account_type") == "Federated":[0m
[30;1m1858 | [0m[35m                response = _clean_up(self._acquire_token_by_username_password_federated([0m
[30;1m1859 | [0m[35m                    user_realm_result, username, password, scopes=scopes,[0m
[30;1m1860 | [0m[35m                    data=data,[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1841 | [0m[35m                claims=claims,[0m
[30;1m1842 | [0m[35m                auth_scheme=auth_scheme,[0m
[30;1m1843 | [0m[35m                )[0m
[30;1m1844 | [0m[35m            return self._process_broker_response(response, scopes, kwargs.get("data", {}))[0m
[30;1m1845 | [0m[35m[0m
[30;1m1846 | [0m[35m        if auth_scheme:[0m
[30;1m1847 | [0m[35m            raise ValueError(self._AUTH_SCHEME_UNSUPPORTED)[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1776 | [0m[35m            * A dict contains "error" and some other keys, when error happened.[0m
[30;1m1777 | [0m[35m            * A dict contains no "error" key means migration was successful.[0m
[30;1m1778 | [0m[35m        """[0m
[30;1m1779 | [0m[35m        self._validate_ssh_cert_input_data(kwargs.get("data", {}))[0m
[30;1m1780 | [0m[35m        telemetry_context = self._build_telemetry_context([0m
[30;1m1781 | [0m[35m            self.ACQUIRE_TOKEN_BY_REFRESH_TOKEN,[0m
[30;1m1782 | [0m[35m            refresh_reason=msal.telemetry.FORCE_REFRESH)[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1747 | [0m[35m                    "you must include a string parameter named 'req_cnf' "[0m
[30;1m1748 | [0m[35m                    "containing the public key in JWK format "[0m
[30;1m1749 | [0m[35m                    "(https://tools.ietf.org/html/rfc7517).")[0m
[30;1m1750 | [0m[35m            if not data.get("key_id"):[0m
[30;1m1751 | [0m[35m                raise ValueError([0m
[30;1m1752 | [0m[35m                    "When requesting an SSH certificate, "[0m
[30;1m1753 | [0m[35m                    "you must include a string parameter named 'key_id' "[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1741 | [0m[35m[0m
[30;1m1742 | [0m[35m    def _validate_ssh_cert_input_data(self, data):[0m
[30;1m1743 | [0m[35m        if data.get("token_type") == "ssh-cert":[0m
[30;1m1744 | [0m[35m            if not data.get("req_cnf"):[0m
[30;1m1745 | [0m[35m                raise ValueError([0m
[30;1m1746 | [0m[35m                    "When requesting an SSH certificate, "[0m
[30;1m1747 | [0m[35m                    "you must include a string parameter named 'req_cnf' "[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1740 | [0m[35m        return response  # Returns the latest error (if any), or just None[0m
[30;1m1741 | [0m[35m[0m
[30;1m1742 | [0m[35m    def _validate_ssh_cert_input_data(self, data):[0m
[30;1m1743 | [0m[35m        if data.get("token_type") == "ssh-cert":[0m
[30;1m1744 | [0m[35m            if not data.get("req_cnf"):[0m
[30;1m1745 | [0m[35m                raise ValueError([0m
[30;1m1746 | [0m[35m                    "When requesting an SSH certificate, "[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1733 | [0m[35m                return response[0m
[30;1m1734 | [0m[35m            logger.debug("Refresh failed. {error}: {error_description}".format([0m
[30;1m1735 | [0m[35m                error=response.get("error"),[0m
[30;1m1736 | [0m[35m                error_description=response.get("error_description"),[0m
[30;1m1737 | [0m[35m                ))[0m
[30;1m1738 | [0m[35m            if break_condition(response):[0m
[30;1m1739 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1732 | [0m[35m            if "error" not in response:[0m
[30;1m1733 | [0m[35m                return response[0m
[30;1m1734 | [0m[35m            logger.debug("Refresh failed. {error}: {error_description}".format([0m
[30;1m1735 | [0m[35m                error=response.get("error"),[0m
[30;1m1736 | [0m[35m                error_description=response.get("error_description"),[0m
[30;1m1737 | [0m[35m                ))[0m
[30;1m1738 | [0m[35m            if break_condition(response):[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1708 | [0m[35m                reverse=True):[0m
[30;1m1709 | [0m[35m            logger.debug("Cache attempts an RT")[0m
[30;1m1710 | [0m[35m            headers = telemetry_context.generate_headers()[0m
[30;1m1711 | [0m[35m            if query.get("home_account_id"):  # Then use it as CCS Routing info[0m
[30;1m1712 | [0m[35m                headers["X-AnchorMailbox"] = "Oid:{}".format(  # case-insensitive value[0m
[30;1m1713 | [0m[35m                    query["home_account_id"].replace(".", "@"))[0m
[30;1m1714 | [0m[35m            response = client.obtain_token_by_refresh_token([0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1704 | [0m[35m        for entry in sorted(  # Since unfit RTs would not be aggressively removed,[0m
[30;1m1705 | [0m[35m                              # we start from newer RTs which are more likely fit.[0m
[30;1m1706 | [0m[35m                matches,[0m
[30;1m1707 | [0m[35m                key=lambda e: int(e.get("last_modification_time", "0")),[0m
[30;1m1708 | [0m[35m                reverse=True):[0m
[30;1m1709 | [0m[35m            logger.debug("Cache attempts an RT")[0m
[30;1m1710 | [0m[35m            headers = telemetry_context.generate_headers()[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1662 | [0m[35m            if at and "error" not in at:[0m
[30;1m1663 | [0m[35m                return at[0m
[30;1m1664 | [0m[35m        last_resp = None[0m
[30;1m1665 | [0m[35m        if app_metadata.get("family_id"):  # Meaning this app belongs to this family[0m
[30;1m1666 | [0m[35m            last_resp = at = self._acquire_token_silent_by_finding_specific_refresh_token([0m
[30;1m1667 | [0m[35m                authority, scopes, dict(query, family_id=app_metadata["family_id"]),[0m
[30;1m1668 | [0m[35m                **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1657 | [0m[35m                break_condition=lambda response:  # Break loop when app not in family[0m
[30;1m1658 | [0m[35m                    # Based on an AAD-only behavior mentioned in internal doc here[0m
[30;1m1659 | [0m[35m                    # https://msazure.visualstudio.com/One/_git/ESTS-Docs/pullrequest/1138595[0m
[30;1m1660 | [0m[35m                    "client_mismatch" in response.get("error_additional_info", []),[0m
[30;1m1661 | [0m[35m                **kwargs)[0m
[30;1m1662 | [0m[35m            if at and "error" not in at:[0m
[30;1m1663 | [0m[35m                return at[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1640 | [0m[35m            self, authority, scopes, account, **kwargs):[0m
[30;1m1641 | [0m[35m        query = {[0m
[30;1m1642 | [0m[35m            "environment": authority.instance,[0m
[30;1m1643 | [0m[35m            "home_account_id": (account or {}).get("home_account_id"),[0m
[30;1m1644 | [0m[35m            # "realm": authority.tenant,  # AAD RTs are tenant-independent[0m
[30;1m1645 | [0m[35m            }[0m
[30;1m1646 | [0m[35m        app_metadata = self._get_app_metadata(authority.instance)[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1593 | [0m[35m                    auth_scheme=auth_scheme,[0m
[30;1m1594 | [0m[35m                    **data)[0m
[30;1m1595 | [0m[35m                if response:  # Broker provides a decisive outcome[0m
[30;1m1596 | [0m[35m                    account_was_established_by_broker = account.get([0m
[30;1m1597 | [0m[35m                        "account_source") == _GRANT_TYPE_BROKER[0m
[30;1m1598 | [0m[35m                    broker_attempt_succeeded_just_now = "error" not in response[0m
[30;1m1599 | [0m[35m                    if account_was_established_by_broker or broker_attempt_succeeded_just_now:[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1577 | [0m[35m                    raise ValueError("auth_scheme is not supported in Cloud Shell")[0m
[30;1m1578 | [0m[35m                return self._acquire_token_by_cloud_shell(scopes, data=data)[0m
[30;1m1579 | [0m[35m[0m
[30;1m1580 | [0m[35m            if self._enable_broker and account and account.get("account_source") in ([0m
[30;1m1581 | [0m[35m                _GRANT_TYPE_BROKER,  # Broker successfully established this account previously.[0m
[30;1m1582 | [0m[35m                None,  # Unknown data from older MSAL. Broker might still work.[0m
[30;1m1583 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1572 | [0m[35m            http_exceptions = (RequestException,)[0m
[30;1m1573 | [0m[35m        try:[0m
[30;1m1574 | [0m[35m            data = kwargs.get("data", {})[0m
[30;1m1575 | [0m[35m            if account and account.get("authority_type") == _AUTHORITY_TYPE_CLOUDSHELL:[0m
[30;1m1576 | [0m[35m                if auth_scheme:[0m
[30;1m1577 | [0m[35m                    raise ValueError("auth_scheme is not supported in Cloud Shell")[0m
[30;1m1578 | [0m[35m                return self._acquire_token_by_cloud_shell(scopes, data=data)[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1571 | [0m[35m            from requests.exceptions import RequestException  # Lazy load[0m
[30;1m1572 | [0m[35m            http_exceptions = (RequestException,)[0m
[30;1m1573 | [0m[35m        try:[0m
[30;1m1574 | [0m[35m            data = kwargs.get("data", {})[0m
[30;1m1575 | [0m[35m            if account and account.get("authority_type") == _AUTHORITY_TYPE_CLOUDSHELL:[0m
[30;1m1576 | [0m[35m                if auth_scheme:[0m
[30;1m1577 | [0m[35m                    raise ValueError("auth_scheme is not supported in Cloud Shell")[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1552 | [0m[35m                logger.debug("Cache hit an AT")[0m
[30;1m1553 | [0m[35m                access_token_from_cache = {  # Mimic a real response[0m
[30;1m1554 | [0m[35m                    "access_token": entry["secret"],[0m
[30;1m1555 | [0m[35m                    "token_type": entry.get("token_type", "Bearer"),[0m
[30;1m1556 | [0m[35m                    "expires_in": int(expires_in),  # OAuth2 specs defines it as int[0m
[30;1m1557 | [0m[35m                    self._TOKEN_SOURCE: self._TOKEN_SOURCE_CACHE,[0m
[30;1m1558 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1532 | [0m[35m                    "realm": authority.tenant,[0m
[30;1m1533 | [0m[35m                    "home_account_id": (account or {}).get("home_account_id"),[0m
[30;1m1534 | [0m[35m                    }[0m
[30;1m1535 | [0m[35m            key_id = kwargs.get("data", {}).get("key_id")[0m
[30;1m1536 | [0m[35m            if key_id:  # Some token types (SSH-certs, POP) are bound to a key[0m
[30;1m1537 | [0m[35m                query["key_id"] = key_id[0m
[30;1m1538 | [0m[35m            now = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1532 | [0m[35m                    "realm": authority.tenant,[0m
[30;1m1533 | [0m[35m                    "home_account_id": (account or {}).get("home_account_id"),[0m
[30;1m1534 | [0m[35m                    }[0m
[30;1m1535 | [0m[35m            key_id = kwargs.get("data", {}).get("key_id")[0m
[30;1m1536 | [0m[35m            if key_id:  # Some token types (SSH-certs, POP) are bound to a key[0m
[30;1m1537 | [0m[35m                query["key_id"] = key_id[0m
[30;1m1538 | [0m[35m            now = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1530 | [0m[35m                    "client_id": self.client_id,[0m
[30;1m1531 | [0m[35m                    "environment": authority.instance,[0m
[30;1m1532 | [0m[35m                    "realm": authority.tenant,[0m
[30;1m1533 | [0m[35m                    "home_account_id": (account or {}).get("home_account_id"),[0m
[30;1m1534 | [0m[35m                    }[0m
[30;1m1535 | [0m[35m            key_id = kwargs.get("data", {}).get("key_id")[0m
[30;1m1536 | [0m[35m            if key_id:  # Some token types (SSH-certs, POP) are bound to a key[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1507 | [0m[35m                "protection_policy_required": "",[0m
[30;1m1508 | [0m[35m                "client_mismatch": "",[0m
[30;1m1509 | [0m[35m                "device_authentication_failed": "",[0m
[30;1m1510 | [0m[35m                }.get(final_result["suberror"], final_result["suberror"])[0m
[30;1m1511 | [0m[35m        return final_result[0m
[30;1m1512 | [0m[35m[0m
[30;1m1513 | [0m[35m    def _acquire_token_silent_from_cache_and_possibly_refresh_it([0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1500 | [0m[35m                if "error" not in result:[0m
[30;1m1501 | [0m[35m                    return result[0m
[30;1m1502 | [0m[35m                final_result = result[0m
[30;1m1503 | [0m[35m        if final_result and final_result.get("suberror"):[0m
[30;1m1504 | [0m[35m            final_result["classification"] = {  # Suppress these suberrors, per #57[0m
[30;1m1505 | [0m[35m                "bad_token": "",[0m
[30;1m1506 | [0m[35m                "token_expired": "",[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1458 | [0m[35m            auth_scheme=None,[0m
[30;1m1459 | [0m[35m            **kwargs):[0m
[30;1m1460 | [0m[35m        assert isinstance(scopes, list), "Invalid parameter type"[0m
[30;1m1461 | [0m[35m        self._validate_ssh_cert_input_data(kwargs.get("data", {}))[0m
[30;1m1462 | [0m[35m        correlation_id = msal.telemetry._get_new_correlation_id()[0m
[30;1m1463 | [0m[35m        if authority:[0m
[30;1m1464 | [0m[35m            warnings.warn("We haven't decided how/if this method will accept authority parameter")[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1315 | [0m[35m                # and 3rd-party apps share same token cache, although they should not.[0m
[30;1m1316 | [0m[35m                if rt["client_id"] == self.client_id or ([0m
[30;1m1317 | [0m[35m                    app_metadata.get("family_id")  # Now let's settle family business[0m
[30;1m1318 | [0m[35m                    and rt.get("family_id") == app_metadata["family_id"])[0m
[30;1m1319 | [0m[35m        ]:[0m
[30;1m1320 | [0m[35m            self.token_cache.remove_rt(rt)[0m
[30;1m1321 | [0m[35m        for at in list(self.token_cache.search(  # Remove ATs from a static list,[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1314 | [0m[35m                # Do RT's app ownership check as a precaution, in case family apps[0m
[30;1m1315 | [0m[35m                # and 3rd-party apps share same token cache, although they should not.[0m
[30;1m1316 | [0m[35m                if rt["client_id"] == self.client_id or ([0m
[30;1m1317 | [0m[35m                    app_metadata.get("family_id")  # Now let's settle family business[0m
[30;1m1318 | [0m[35m                    and rt.get("family_id") == app_metadata["family_id"])[0m
[30;1m1319 | [0m[35m        ]:[0m
[30;1m1320 | [0m[35m            self.token_cache.remove_rt(rt)[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1269 | [0m[35m        return list(grouped_accounts.values())[0m
[30;1m1270 | [0m[35m[0m
[30;1m1271 | [0m[35m    def _get_instance_metadata(self):  # This exists so it can be mocked in unit test[0m
[30;1m1272 | [0m[35m        resp = self.http_client.get([0m
[30;1m1273 | [0m[35m            "https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorizati[0m
[30;1m1274 | [0m[35m            headers={'Accept': 'application/json'})[0m
[30;1m1275 | [0m[35m        resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1259 | [0m[35m                    # The following fields for backward compatibility, for now[0m
[30;1m1260 | [0m[35m                    "authority_type": a.get("authority_type"),[0m
[30;1m1261 | [0m[35m                    "local_account_id": a.get("local_account_id"),  # Tenant-specific[0m
[30;1m1262 | [0m[35m                    "realm": a.get("realm"),  # Tenant-specific[0m
[30;1m1263 | [0m[35m                }[0m
[30;1m1264 | [0m[35m            for a in self.token_cache.search([0m
[30;1m1265 | [0m[35m                TokenCache.CredentialType.ACCOUNT,[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1258 | [0m[35m[0m
[30;1m1259 | [0m[35m                    # The following fields for backward compatibility, for now[0m
[30;1m1260 | [0m[35m                    "authority_type": a.get("authority_type"),[0m
[30;1m1261 | [0m[35m                    "local_account_id": a.get("local_account_id"),  # Tenant-specific[0m
[30;1m1262 | [0m[35m                    "realm": a.get("realm"),  # Tenant-specific[0m
[30;1m1263 | [0m[35m                }[0m
[30;1m1264 | [0m[35m            for a in self.token_cache.search([0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1257 | [0m[35m                    "account_source": a.get("account_source"),[0m
[30;1m1258 | [0m[35m[0m
[30;1m1259 | [0m[35m                    # The following fields for backward compatibility, for now[0m
[30;1m1260 | [0m[35m                    "authority_type": a.get("authority_type"),[0m
[30;1m1261 | [0m[35m                    "local_account_id": a.get("local_account_id"),  # Tenant-specific[0m
[30;1m1262 | [0m[35m                    "realm": a.get("realm"),  # Tenant-specific[0m
[30;1m1263 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1254 | [0m[35m                    "home_account_id": a.get("home_account_id"),[0m
[30;1m1255 | [0m[35m                    "environment": a.get("environment"),[0m
[30;1m1256 | [0m[35m                    "username": a.get("username"),[0m
[30;1m1257 | [0m[35m                    "account_source": a.get("account_source"),[0m
[30;1m1258 | [0m[35m[0m
[30;1m1259 | [0m[35m                    # The following fields for backward compatibility, for now[0m
[30;1m1260 | [0m[35m                    "authority_type": a.get("authority_type"),[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1253 | [0m[35m                {  # These are minimal amount of non-tenant-specific account info[0m
[30;1m1254 | [0m[35m                    "home_account_id": a.get("home_account_id"),[0m
[30;1m1255 | [0m[35m                    "environment": a.get("environment"),[0m
[30;1m1256 | [0m[35m                    "username": a.get("username"),[0m
[30;1m1257 | [0m[35m                    "account_source": a.get("account_source"),[0m
[30;1m1258 | [0m[35m[0m
[30;1m1259 | [0m[35m                    # The following fields for backward compatibility, for now[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1252 | [0m[35m            a.get("home_account_id"):  # Grouped by home tenant's id[0m
[30;1m1253 | [0m[35m                {  # These are minimal amount of non-tenant-specific account info[0m
[30;1m1254 | [0m[35m                    "home_account_id": a.get("home_account_id"),[0m
[30;1m1255 | [0m[35m                    "environment": a.get("environment"),[0m
[30;1m1256 | [0m[35m                    "username": a.get("username"),[0m
[30;1m1257 | [0m[35m                    "account_source": a.get("account_source"),[0m
[30;1m1258 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1251 | [0m[35m        grouped_accounts = {[0m
[30;1m1252 | [0m[35m            a.get("home_account_id"):  # Grouped by home tenant's id[0m
[30;1m1253 | [0m[35m                {  # These are minimal amount of non-tenant-specific account info[0m
[30;1m1254 | [0m[35m                    "home_account_id": a.get("home_account_id"),[0m
[30;1m1255 | [0m[35m                    "environment": a.get("environment"),[0m
[30;1m1256 | [0m[35m                    "username": a.get("username"),[0m
[30;1m1257 | [0m[35m                    "account_source": a.get("account_source"),[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1249 | [0m[35m        if _is_running_in_cloud_shell():[0m
[30;1m1250 | [0m[35m            interested_authority_types.append(_AUTHORITY_TYPE_CLOUDSHELL)[0m
[30;1m1251 | [0m[35m        grouped_accounts = {[0m
[30;1m1252 | [0m[35m            a.get("home_account_id"):  # Grouped by home tenant's id[0m
[30;1m1253 | [0m[35m                {  # These are minimal amount of non-tenant-specific account info[0m
[30;1m1254 | [0m[35m                    "home_account_id": a.get("home_account_id"),[0m
[30;1m1255 | [0m[35m                    "environment": a.get("environment"),[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1183 | [0m[35m        # one scope. But, MSAL decorates your scope anyway, so they are never[0m
[30;1m1184 | [0m[35m        # really empty.[0m
[30;1m1185 | [0m[35m        assert isinstance(scopes, list), "Invalid parameter type"[0m
[30;1m1186 | [0m[35m        self._validate_ssh_cert_input_data(kwargs.get("data", {}))[0m
[30;1m1187 | [0m[35m        warnings.warn([0m
[30;1m1188 | [0m[35m            "Change your acquire_token_by_authorization_code() "[0m
[30;1m1189 | [0m[35m            "to acquire_token_by_auth_code_flow()", DeprecationWarning)[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1112 | [0m[35m                        pass  # Simply ignore them[0m
[30;1m1113 | [0m[35m                    return redirect(url_for("index"))[0m
[30;1m1114 | [0m[35m        """[0m
[30;1m1115 | [0m[35m        self._validate_ssh_cert_input_data(kwargs.get("data", {}))[0m
[30;1m1116 | [0m[35m        telemetry_context = self._build_telemetry_context([0m
[30;1m1117 | [0m[35m            self.ACQUIRE_TOKEN_BY_AUTHORIZATION_CODE_ID)[0m
[30;1m1118 | [0m[35m        response = _clean_up(self.client.obtain_token_by_auth_code_flow([0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1104 | [0m[35m                def authorize():  # A controller in a web app[0m
[30;1m1105 | [0m[35m                    try:[0m
[30;1m1106 | [0m[35m                        result = msal_app.acquire_token_by_auth_code_flow([0m
[30;1m1107 | [0m[35m                            session.get("flow", {}), request.args)[0m
[30;1m1108 | [0m[35m                        if "error" in result:[0m
[30;1m1109 | [0m[35m                            return render_template("error.html", result)[0m
[30;1m1110 | [0m[35m                        use(result)  # Token(s) are available in result and cache[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m815 | [0m[35m                        "client_credential needs to follow this format "[0m
[30;1m816 | [0m[35m                        "https://msal-python.readthedocs.io/en/latest/#msal.ClientApplication.params[0m
[30;1m817 | [0m[35m                if ("x5c" not in headers  # So the .pfx file contains no certificate[0m
[30;1m818 | [0m[35m                    and isinstance(client_credential.get('public_certificate'), str)[0m
[30;1m819 | [0m[35m                ):  # Then we treat the public_certificate value as PEM content[0m
[30;1m820 | [0m[35m                    headers["x5c"] = extract_certs(client_credential['public_certificate'])[0m
[30;1m821 | [0m[35m                if sha256_thumbprint and not authority.is_adfs:[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m803 | [0m[35m                        headers["x5c"] = x5c[0m
[30;1m804 | [0m[35m                elif ([0m
[30;1m805 | [0m[35m                        client_credential.get("private_key")  # PEM blob[0m
[30;1m806 | [0m[35m                        and client_credential.get("thumbprint")):[0m
[30;1m807 | [0m[35m                    sha1_thumbprint = client_credential["thumbprint"][0m
[30;1m808 | [0m[35m                    if passphrase_bytes:[0m
[30;1m809 | [0m[35m                        private_key = _load_private_key_from_pem_str([0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m802 | [0m[35m                    if client_credential.get("public_certificate") is True and x5c:[0m
[30;1m803 | [0m[35m                        headers["x5c"] = x5c[0m
[30;1m804 | [0m[35m                elif ([0m
[30;1m805 | [0m[35m                        client_credential.get("private_key")  # PEM blob[0m
[30;1m806 | [0m[35m                        and client_credential.get("thumbprint")):[0m
[30;1m807 | [0m[35m                    sha1_thumbprint = client_credential["thumbprint"][0m
[30;1m808 | [0m[35m                    if passphrase_bytes:[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m799 | [0m[35m                    private_key, sha256_thumbprint, sha1_thumbprint, x5c = _parse_pfx([0m
[30;1m800 | [0m[35m                        client_credential["private_key_pfx_path"],[0m
[30;1m801 | [0m[35m                        passphrase_bytes)[0m
[30;1m802 | [0m[35m                    if client_credential.get("public_certificate") is True and x5c:[0m
[30;1m803 | [0m[35m                        headers["x5c"] = x5c[0m
[30;1m804 | [0m[35m                elif ([0m
[30;1m805 | [0m[35m                        client_credential.get("private_key")  # PEM blob[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m795 | [0m[35m                passphrase_bytes = _str2bytes([0m
[30;1m796 | [0m[35m                    client_credential["passphrase"][0m
[30;1m797 | [0m[35m                    ) if client_credential.get("passphrase") else None[0m
[30;1m798 | [0m[35m                if client_credential.get("private_key_pfx_path"):[0m
[30;1m799 | [0m[35m                    private_key, sha256_thumbprint, sha1_thumbprint, x5c = _parse_pfx([0m
[30;1m800 | [0m[35m                        client_credential["private_key_pfx_path"],[0m
[30;1m801 | [0m[35m                        passphrase_bytes)[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m794 | [0m[35m                sha1_thumbprint = sha256_thumbprint = None[0m
[30;1m795 | [0m[35m                passphrase_bytes = _str2bytes([0m
[30;1m796 | [0m[35m                    client_credential["passphrase"][0m
[30;1m797 | [0m[35m                    ) if client_credential.get("passphrase") else None[0m
[30;1m798 | [0m[35m                if client_credential.get("private_key_pfx_path"):[0m
[30;1m799 | [0m[35m                    private_key, sha256_thumbprint, sha1_thumbprint, x5c = _parse_pfx([0m
[30;1m800 | [0m[35m                        client_credential["private_key_pfx_path"],[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m787 | [0m[35m            client_assertion_type = Client.CLIENT_ASSERTION_TYPE_JWT[0m
[30;1m788 | [0m[35m            # Use client_credential.get("...") rather than "..." in client_credential[0m
[30;1m789 | [0m[35m            # so that we can ignore an empty string came from an empty ENV VAR.[0m
[30;1m790 | [0m[35m            if client_credential.get("client_assertion"):[0m
[30;1m791 | [0m[35m                client_assertion = client_credential['client_assertion'][0m
[30;1m792 | [0m[35m            else:[0m
[30;1m793 | [0m[35m                headers = {}[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m785 | [0m[35m        default_body = {"client_info": 1}[0m
[30;1m786 | [0m[35m        if isinstance(client_credential, dict):[0m
[30;1m787 | [0m[35m            client_assertion_type = Client.CLIENT_ASSERTION_TYPE_JWT[0m
[30;1m788 | [0m[35m            # Use client_credential.get("...") rather than "..." in client_credential[0m
[30;1m789 | [0m[35m            # so that we can ignore an empty string came from an empty ENV VAR.[0m
[30;1m790 | [0m[35m            if client_credential.get("client_assertion"):[0m
[30;1m791 | [0m[35m                client_assertion = client_credential['client_assertion'][0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m        headers = kwargs.pop("headers", {})[0m
[30;1m182 | [0m[35m        client_info = json.loads([0m
[30;1m183 | [0m[35m            decode_part(auth_response["client_info"])[0m
[30;1m184 | [0m[35m            ) if auth_response.get("client_info") else {}[0m
[30;1m185 | [0m[35m        if "uid" in client_info and "utid" in client_info:[0m
[30;1m186 | [0m[35m            # Note: The value of X-AnchorMailbox is also case-insensitive[0m
[30;1m187 | [0m[35m            headers["X-AnchorMailbox"] = "Oid:{uid}@{utid}".format(**client_info)[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35mclass _ClientWithCcsRoutingInfo(Client):[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    def initiate_auth_code_flow(self, **kwargs):[0m
[30;1m171 | [0m[35m        if kwargs.get("login_hint"):  # eSTS could have utilized this as-is, but nope[0m
[30;1m172 | [0m[35m            kwargs["X-AnchorMailbox"] = "UPN:%s" % kwargs["login_hint"][0m
[30;1m173 | [0m[35m        return super(_ClientWithCcsRoutingInfo, self).initiate_auth_code_flow([0m
[30;1m174 | [0m[35m            client_info=1,  # To be used as CSS Routing info[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m                # would return a GenericBrowser instance which won't work.[0m
[30;1m150 | [0m[35m            try:[0m
[30;1m151 | [0m[35m                registration_available = isinstance([0m
[30;1m152 | [0m[35m                    webbrowser.get(browser_name), webbrowser.BackgroundBrowser)[0m
[30;1m153 | [0m[35m            except webbrowser.Error:[0m
[30;1m154 | [0m[35m                registration_available = False[0m
[30;1m155 | [0m[35m            if not registration_available:[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m        try:[0m
[30;1m146 | [0m[35m            import webbrowser  # Lazy import. Some distro may not have this.[0m
[30;1m147 | [0m[35m            browser_name = "msal-edge"  # Avoid popular name "microsoft-edge"[0m
[30;1m148 | [0m[35m                # otherwise `BROWSER="microsoft-edge"; webbrowser.get("microsoft-edge")`[0m
[30;1m149 | [0m[35m                # would return a GenericBrowser instance which won't work.[0m
[30;1m150 | [0m[35m            try:[0m
[30;1m151 | [0m[35m                registration_available = isinstance([0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m        # /opt/microsoft/msedge/msedge or /opt/microsoft/msedge-beta/msedge.[0m
[30;1m135 | [0m[35m        # Either method can be used to detect an Edge installation.[0m
[30;1m136 | [0m[35m    user_has_no_preference = "BROWSER" not in os.environ[0m
[30;1m137 | [0m[35m    user_wont_mind_edge = "microsoft-edge" in os.environ.get("BROWSER", "")  # Note:[0m
[30;1m138 | [0m[35m        # BROWSER could contain "microsoft-edge" or "/path/to/microsoft-edge".[0m
[30;1m139 | [0m[35m        # Python documentation (https://docs.python.org/3/library/webbrowser.html)[0m
[30;1m140 | [0m[35m        # does not document the name being implicitly register,[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35mdef _preferred_browser():[0m
[30;1m125 | [0m[35m    """Register Edge and return a name suitable for subsequent webbrowser.get(...)[0m
[30;1m126 | [0m[35m    when appropriate. Otherwise return None.[0m
[30;1m127 | [0m[35m    """[0m
[30;1m128 | [0m[35m    # On Linux, only Edge will provide device-based Conditional Access support[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m        if "_msalruntime_telemetry" in result or "_msal_python_telemetry" in result:[0m
[30;1m109 | [0m[35m            result["msal_telemetry"] = json.dumps({  # Telemetry as an opaque string[0m
[30;1m110 | [0m[35m                "msalruntime_telemetry": result.get("_msalruntime_telemetry"),[0m
[30;1m111 | [0m[35m                "msal_python_telemetry": result.get("_msal_python_telemetry"),[0m
[30;1m112 | [0m[35m                }, separators=(",", ":"))[0m
[30;1m113 | [0m[35m        return_value = {[0m
[30;1m114 | [0m[35m            k: result[k] for k in result[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    if isinstance(result, dict):[0m
[30;1m108 | [0m[35m        if "_msalruntime_telemetry" in result or "_msal_python_telemetry" in result:[0m
[30;1m109 | [0m[35m            result["msal_telemetry"] = json.dumps({  # Telemetry as an opaque string[0m
[30;1m110 | [0m[35m                "msalruntime_telemetry": result.get("_msalruntime_telemetry"),[0m
[30;1m111 | [0m[35m                "msal_python_telemetry": result.get("_msal_python_telemetry"),[0m
[30;1m112 | [0m[35m                }, separators=(",", ":"))[0m
[30;1m113 | [0m[35m        return_value = {[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2405 | [0m[35m        :func:`~acquire_token_for_client()` for the current client."""[0m
[30;1m2406 | [0m[35m        for env in [self.authority.instance] + self._get_authority_aliases([0m
[30;1m2407 | [0m[35m                self.authority.instance):[0m
[30;1m2408 | [0m[35m            for at in list(self.token_cache.search(  # Remove ATs from a snapshot[0m
[30;1m2409 | [0m[35m                TokenCache.CredentialType.ACCESS_TOKEN, query={[0m
[30;1m2410 | [0m[35m                "client_id": self.client_id,[0m
[30;1m2411 | [0m[35m                "environment": env,[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2308 | [0m[35m        :param dict flow:[0m
[30;1m2309 | [0m[35m            A dict previously generated by :func:`~initiate_device_flow`.[0m
[30;1m2310 | [0m[35m            By default, this method's polling effect  will block current thread.[0m
[30;1m2311 | [0m[35m            You can abort the polling loop at any time,[0m
[30;1m2312 | [0m[35m            by changing the value of the flow's "expires_at" key to 0.[0m
[30;1m2313 | [0m[35m        :param claims_challenge:[0m
[30;1m2314 | [0m[35m            The claims_challenge parameter requests specific claims requested by the resource provid[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1667 | [0m[35m                authority, scopes, dict(query, family_id=app_metadata["family_id"]),[0m
[30;1m1668 | [0m[35m                **kwargs)[0m
[30;1m1669 | [0m[35m            if at and "error" not in at:[0m
[30;1m1670 | [0m[35m                return at[0m
[30;1m1671 | [0m[35m        # Either this app is an orphan, so we will naturally use its own RT;[0m
[30;1m1672 | [0m[35m        # or all attempts above have failed, so we fall back to non-foci behavior.[0m
[30;1m1673 | [0m[35m        return self._acquire_token_silent_by_finding_specific_refresh_token([0m
[30;1m1674 | [0m[35m            authority, scopes, dict(query, client_id=self.client_id),[0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1666 | [0m[35m            last_resp = at = self._acquire_token_silent_by_finding_specific_refresh_token([0m
[30;1m1667 | [0m[35m                authority, scopes, dict(query, family_id=app_metadata["family_id"]),[0m
[30;1m1668 | [0m[35m                **kwargs)[0m
[30;1m1669 | [0m[35m            if at and "error" not in at:[0m
[30;1m1670 | [0m[35m                return at[0m
[30;1m1671 | [0m[35m        # Either this app is an orphan, so we will naturally use its own RT;[0m
[30;1m1672 | [0m[35m        # or all attempts above have failed, so we fall back to non-foci behavior.[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1663 | [0m[35m                return at[0m
[30;1m1664 | [0m[35m        last_resp = None[0m
[30;1m1665 | [0m[35m        if app_metadata.get("family_id"):  # Meaning this app belongs to this family[0m
[30;1m1666 | [0m[35m            last_resp = at = self._acquire_token_silent_by_finding_specific_refresh_token([0m
[30;1m1667 | [0m[35m                authority, scopes, dict(query, family_id=app_metadata["family_id"]),[0m
[30;1m1668 | [0m[35m                **kwargs)[0m
[30;1m1669 | [0m[35m            if at and "error" not in at:[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1660 | [0m[35m                    "client_mismatch" in response.get("error_additional_info", []),[0m
[30;1m1661 | [0m[35m                **kwargs)[0m
[30;1m1662 | [0m[35m            if at and "error" not in at:[0m
[30;1m1663 | [0m[35m                return at[0m
[30;1m1664 | [0m[35m        last_resp = None[0m
[30;1m1665 | [0m[35m        if app_metadata.get("family_id"):  # Meaning this app belongs to this family[0m
[30;1m1666 | [0m[35m            last_resp = at = self._acquire_token_silent_by_finding_specific_refresh_token([0m
[30;1m1667 | [0m[35m                authority, scopes, dict(query, family_id=app_metadata["family_id"]),[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1659 | [0m[35m                    # https://msazure.visualstudio.com/One/_git/ESTS-Docs/pullrequest/1138595[0m
[30;1m1660 | [0m[35m                    "client_mismatch" in response.get("error_additional_info", []),[0m
[30;1m1661 | [0m[35m                **kwargs)[0m
[30;1m1662 | [0m[35m            if at and "error" not in at:[0m
[30;1m1663 | [0m[35m                return at[0m
[30;1m1664 | [0m[35m        last_resp = None[0m
[30;1m1665 | [0m[35m        if app_metadata.get("family_id"):  # Meaning this app belongs to this family[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1650 | [0m[35m            # For now, we try existing RTs (*). If it works, we are in that family.[0m
[30;1m1651 | [0m[35m            # (*) RTs of a different app/family are not supposed to be[0m
[30;1m1652 | [0m[35m            # shared with or accessible by us in the first place.[0m
[30;1m1653 | [0m[35m            at = self._acquire_token_silent_by_finding_specific_refresh_token([0m
[30;1m1654 | [0m[35m                authority, scopes,[0m
[30;1m1655 | [0m[35m                dict(query, family_id="1"),  # A hack, we have only 1 family for now[0m
[30;1m1656 | [0m[35m                rt_remover=lambda rt_item: None,  # NO-OP b/c RTs are likely not mine[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1565 | [0m[35m                return access_token_from_cache  # It is still good as new[0m
[30;1m1566 | [0m[35m        else:[0m
[30;1m1567 | [0m[35m            refresh_reason = msal.telemetry.FORCE_REFRESH  # TODO: It could also mean claims_challen[0m
[30;1m1568 | [0m[35m        assert refresh_reason, "It should have been established at this point"[0m
[30;1m1569 | [0m[35m        if not http_exceptions:  # It can be a tuple of exceptions[0m
[30;1m1570 | [0m[35m            # The exact HTTP exceptions are transportation-layer dependent[0m
[30;1m1571 | [0m[35m            from requests.exceptions import RequestException  # Lazy load[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1525 | [0m[35m        # it accepts a non-empty account to find token for a user,[0m
[30;1m1526 | [0m[35m        # and accepts account=None to find a token for the current app.[0m
[30;1m1527 | [0m[35m        access_token_from_cache = None[0m
[30;1m1528 | [0m[35m        if not (force_refresh or claims_challenge or auth_scheme):  # Then attempt AT cache[0m
[30;1m1529 | [0m[35m            query={[0m
[30;1m1530 | [0m[35m                    "client_id": self.client_id,[0m
[30;1m1531 | [0m[35m                    "environment": authority.instance,[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1318 | [0m[35m                    and rt.get("family_id") == app_metadata["family_id"])[0m
[30;1m1319 | [0m[35m        ]:[0m
[30;1m1320 | [0m[35m            self.token_cache.remove_rt(rt)[0m
[30;1m1321 | [0m[35m        for at in list(self.token_cache.search(  # Remove ATs from a static list,[0m
[30;1m1322 | [0m[35m                # to avoid changing self.token_cache while it is being iterated[0m
[30;1m1323 | [0m[35m            TokenCache.CredentialType.ACCESS_TOKEN, query=owned_by_home_account,[0m
[30;1m1324 | [0m[35m            # Regardless of realm, b/c we've removed realm-independent RTs anyway[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m643 | [0m[35m                or (azure_region is None and os.getenv("MSAL_FORCE_REGION"))  # Will use region[0m
[30;1m644 | [0m[35m            ):[0m
[30;1m645 | [0m[35m                # Since caller opts in to use region, here we tolerate connection[0m
[30;1m646 | [0m[35m                # errors happened during authority validation at non-region endpoint[0m
[30;1m647 | [0m[35m                self.authority = Authority([0m
[30;1m648 | [0m[35m                    authority_to_use,[0m
[30;1m649 | [0m[35m                    self.http_client,[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m612 | [0m[35m            self.http_client,[0m
[30;1m613 | [0m[35m            http_cache=http_cache,[0m
[30;1m614 | [0m[35m            default_throttle_time=60[0m
[30;1m615 | [0m[35m                # The default value 60 was recommended mainly for PCA at the end of[0m
[30;1m616 | [0m[35m                # https://identitydivision.visualstudio.com/devex/_git/AuthLibrariesApiReview?versio[0m
[30;1m617 | [0m[35m                if isinstance(self, PublicClientApplication) else 5,[0m
[30;1m618 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m528 | [0m[35m            New in version 1.16.0.[0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m        :param boolean instance_discovery:[0m
[30;1m531 | [0m[35m            Historically, MSAL would connect to a central endpoint located at[0m
[30;1m532 | [0m[35m            ``https://login.microsoftonline.com`` to acquire some metadata,[0m
[30;1m533 | [0m[35m            especially when using an unfamiliar authority.[0m
[30;1m534 | [0m[35m            This behavior is known as Instance Discovery.[0m
[30;1m535 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m514 | [0m[35m                    http_cache=persisted_http_cache,  # Utilize persisted_http_cache[0m
[30;1m515 | [0m[35m                    ...,[0m
[30;1m516 | [0m[35m                    #token_cache=...,  # You may combine the old token_cache trick[0m
[30;1m517 | [0m[35m                        # Please refer to token_cache recipe at[0m
[30;1m518 | [0m[35m                        # https://msal-python.readthedocs.io/en/latest/#msal.SerializableTokenCache[0m
[30;1m519 | [0m[35m                    )[0m
[30;1m520 | [0m[35m                app.acquire_token_interactive(["your", "scope"], ...)[0m
[30;1m521 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m490 | [0m[35m            you would want to persist your http_cache across different CLI runs.[0m
[30;1m491 | [0m[35m            The following recipe shows a way to do so::[0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m                # Just add the following lines at the beginning of your CLI script[0m
[30;1m494 | [0m[35m                import sys, atexit, pickle[0m
[30;1m495 | [0m[35m                http_cache_filename = sys.argv[0] + ".http_cache"[0m
[30;1m496 | [0m[35m                try:[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2417 | [0m[35m    def acquire_token_on_behalf_of(self, user_assertion, scopes, claims_challenge=None, **kwargs):[0m
[30;1m2418 | [0m[35m        """Acquires token using on-behalf-of (OBO) flow.[0m
[30;1m2419 | [0m[35m[0m
[30;1m2420 | [0m[35m        The current app is a middle-tier service which was called with a token[0m
[30;1m2421 | [0m[35m        representing an end user.[0m
[30;1m2422 | [0m[35m        The current app can use such token (a.k.a. a user assertion) to request[0m
[30;1m2423 | [0m[35m        another token to access downstream web API, on behalf of that user.[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2403 | [0m[35m    def remove_tokens_for_client(self):[0m
[30;1m2404 | [0m[35m        """Remove all tokens that were previously acquired via[0m
[30;1m2405 | [0m[35m        :func:`~acquire_token_for_client()` for the current client."""[0m
[30;1m2406 | [0m[35m        for env in [self.authority.instance] + self._get_authority_aliases([0m
[30;1m2407 | [0m[35m                self.authority.instance):[0m
[30;1m2408 | [0m[35m            for at in list(self.token_cache.search(  # Remove ATs from a snapshot[0m
[30;1m2409 | [0m[35m                TokenCache.CredentialType.ACCESS_TOKEN, query={[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2330 | [0m[35m                kwargs.pop("data", {}),[0m
[30;1m2331 | [0m[35m                code=flow["device_code"],  # 2018-10-4 Hack:[0m
[30;1m2332 | [0m[35m                    # during transition period,[0m
[30;1m2333 | [0m[35m                    # service seemingly need both device_code and code parameter.[0m
[30;1m2334 | [0m[35m                claims=_merge_claims_challenge_and_capabilities([0m
[30;1m2335 | [0m[35m                    self._client_capabilities, claims_challenge),[0m
[30;1m2336 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2104 | [0m[35m            A callback with the form of[0m
[30;1m2105 | [0m[35m            ``lambda ui="xyz", **kwargs: print("A {} will be launched".format(ui))``,[0m
[30;1m2106 | [0m[35m            where ``ui`` will be either "browser" or "broker".[0m
[30;1m2107 | [0m[35m            You can use it to inform your end user to expect a pop-up window.[0m
[30;1m2108 | [0m[35m[0m
[30;1m2109 | [0m[35m            New in version 1.20.0.[0m
[30;1m2110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2091 | [0m[35m[0m
[30;1m2092 | [0m[35m              - If your app is a GUI app running on Windows or Mac system,[0m
[30;1m2093 | [0m[35m                you are required to also provide its window handle,[0m
[30;1m2094 | [0m[35m                so that the sign-in window will pop up on top of your window.[0m
[30;1m2095 | [0m[35m              - If your app is a console app running on Windows or Mac system,[0m
[30;1m2096 | [0m[35m                you can use a placeholder[0m
[30;1m2097 | [0m[35m                ``PublicClientApplication.CONSOLE_WINDOW_HANDLE``.[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2073 | [0m[35m            OPTIONAL. Maximum Authentication Age.[0m
[30;1m2074 | [0m[35m            Specifies the allowable elapsed time in seconds[0m
[30;1m2075 | [0m[35m            since the last time the End-User was actively authenticated.[0m
[30;1m2076 | [0m[35m            If the elapsed time is greater than this value,[0m
[30;1m2077 | [0m[35m            Microsoft identity platform will actively re-authenticate the End-User.[0m
[30;1m2078 | [0m[35m[0m
[30;1m2079 | [0m[35m            MSAL Python will also automatically validate the auth_time in ID token.[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2072 | [0m[35m        :param int max_age:[0m
[30;1m2073 | [0m[35m            OPTIONAL. Maximum Authentication Age.[0m
[30;1m2074 | [0m[35m            Specifies the allowable elapsed time in seconds[0m
[30;1m2075 | [0m[35m            since the last time the End-User was actively authenticated.[0m
[30;1m2076 | [0m[35m            If the elapsed time is greater than this value,[0m
[30;1m2077 | [0m[35m            Microsoft identity platform will actively re-authenticate the End-User.[0m
[30;1m2078 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2071 | [0m[35m[0m
[30;1m2072 | [0m[35m        :param int max_age:[0m
[30;1m2073 | [0m[35m            OPTIONAL. Maximum Authentication Age.[0m
[30;1m2074 | [0m[35m            Specifies the allowable elapsed time in seconds[0m
[30;1m2075 | [0m[35m            since the last time the End-User was actively authenticated.[0m
[30;1m2076 | [0m[35m            If the elapsed time is greater than this value,[0m
[30;1m2077 | [0m[35m            Microsoft identity platform will actively re-authenticate the End-User.[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2055 | [0m[35m[0m
[30;1m2056 | [0m[35m        :param int timeout:[0m
[30;1m2057 | [0m[35m            This method will block the current thread.[0m
[30;1m2058 | [0m[35m            This parameter specifies the timeout value in seconds.[0m
[30;1m2059 | [0m[35m            Default value ``None`` means wait indefinitely.[0m
[30;1m2060 | [0m[35m[0m
[30;1m2061 | [0m[35m        :param int port:[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1878 | [0m[35m                user_realm_result["federation_metadata_url"],[0m
[30;1m1879 | [0m[35m                self.http_client)[0m
[30;1m1880 | [0m[35m            if wstrust_endpoint is None:[0m
[30;1m1881 | [0m[35m                raise ValueError("Unable to find wstrust endpoint from MEX. "[0m
[30;1m1882 | [0m[35m                    "This typically happens when attempting MSA accounts. "[0m
[30;1m1883 | [0m[35m                    "More details available here. "[0m
[30;1m1884 | [0m[35m                    "https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Use[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1749 | [0m[35m                    "(https://tools.ietf.org/html/rfc7517).")[0m
[30;1m1750 | [0m[35m            if not data.get("key_id"):[0m
[30;1m1751 | [0m[35m                raise ValueError([0m
[30;1m1752 | [0m[35m                    "When requesting an SSH certificate, "[0m
[30;1m1753 | [0m[35m                    "you must include a string parameter named 'key_id' "[0m
[30;1m1754 | [0m[35m                    "which identifies the key in the 'req_cnf' argument.")[0m
[30;1m1755 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1743 | [0m[35m        if data.get("token_type") == "ssh-cert":[0m
[30;1m1744 | [0m[35m            if not data.get("req_cnf"):[0m
[30;1m1745 | [0m[35m                raise ValueError([0m
[30;1m1746 | [0m[35m                    "When requesting an SSH certificate, "[0m
[30;1m1747 | [0m[35m                    "you must include a string parameter named 'req_cnf' "[0m
[30;1m1748 | [0m[35m                    "containing the public key in JWK format "[0m
[30;1m1749 | [0m[35m                    "(https://tools.ietf.org/html/rfc7517).")[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1523 | [0m[35m            **kwargs):[0m
[30;1m1524 | [0m[35m        # This internal method has two calling patterns:[0m
[30;1m1525 | [0m[35m        # it accepts a non-empty account to find token for a user,[0m
[30;1m1526 | [0m[35m        # and accepts account=None to find a token for the current app.[0m
[30;1m1527 | [0m[35m        access_token_from_cache = None[0m
[30;1m1528 | [0m[35m        if not (force_refresh or claims_challenge or auth_scheme):  # Then attempt AT cache[0m
[30;1m1529 | [0m[35m            query={[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1522 | [0m[35m            auth_scheme=None,[0m
[30;1m1523 | [0m[35m            **kwargs):[0m
[30;1m1524 | [0m[35m        # This internal method has two calling patterns:[0m
[30;1m1525 | [0m[35m        # it accepts a non-empty account to find token for a user,[0m
[30;1m1526 | [0m[35m        # and accepts account=None to find a token for the current app.[0m
[30;1m1527 | [0m[35m        access_token_from_cache = None[0m
[30;1m1528 | [0m[35m        if not (force_refresh or claims_challenge or auth_scheme):  # Then attempt AT cache[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1423 | [0m[35m            a ``None`` input will become a NO-OP and always return ``None``.[0m
[30;1m1424 | [0m[35m        :param force_refresh:[0m
[30;1m1425 | [0m[35m            If True, it will skip Access Token look-up,[0m
[30;1m1426 | [0m[35m            and try to find a Refresh Token to obtain a new Access Token.[0m
[30;1m1427 | [0m[35m        :param claims_challenge:[0m
[30;1m1428 | [0m[35m            The claims_challenge parameter requests specific claims requested by the resource provid[0m
[30;1m1429 | [0m[35m            in the form of a claims_challenge directive in the www-authenticate header to be[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1209 | [0m[35m        """Get a list of accounts which previously signed in, i.e. exists in cache.[0m
[30;1m1210 | [0m[35m[0m
[30;1m1211 | [0m[35m        An account can later be used in :func:`~acquire_token_silent`[0m
[30;1m1212 | [0m[35m        to find its tokens.[0m
[30;1m1213 | [0m[35m[0m
[30;1m1214 | [0m[35m        :param username:[0m
[30;1m1215 | [0m[35m            Filter accounts with this username only. Case insensitive.[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m924 | [0m[35m            OPTIONAL. Maximum Authentication Age.[0m
[30;1m925 | [0m[35m            Specifies the allowable elapsed time in seconds[0m
[30;1m926 | [0m[35m            since the last time the End-User was actively authenticated.[0m
[30;1m927 | [0m[35m            If the elapsed time is greater than this value,[0m
[30;1m928 | [0m[35m            Microsoft identity platform will actively re-authenticate the End-User.[0m
[30;1m929 | [0m[35m[0m
[30;1m930 | [0m[35m            MSAL Python will also automatically validate the auth_time in ID token.[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m923 | [0m[35m        :param int max_age:[0m
[30;1m924 | [0m[35m            OPTIONAL. Maximum Authentication Age.[0m
[30;1m925 | [0m[35m            Specifies the allowable elapsed time in seconds[0m
[30;1m926 | [0m[35m            since the last time the End-User was actively authenticated.[0m
[30;1m927 | [0m[35m            If the elapsed time is greater than this value,[0m
[30;1m928 | [0m[35m            Microsoft identity platform will actively re-authenticate the End-User.[0m
[30;1m929 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m        :param int max_age:[0m
[30;1m924 | [0m[35m            OPTIONAL. Maximum Authentication Age.[0m
[30;1m925 | [0m[35m            Specifies the allowable elapsed time in seconds[0m
[30;1m926 | [0m[35m            since the last time the End-User was actively authenticated.[0m
[30;1m927 | [0m[35m            If the elapsed time is greater than this value,[0m
[30;1m928 | [0m[35m            Microsoft identity platform will actively re-authenticate the End-User.[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m786 | [0m[35m        if isinstance(client_credential, dict):[0m
[30;1m787 | [0m[35m            client_assertion_type = Client.CLIENT_ASSERTION_TYPE_JWT[0m
[30;1m788 | [0m[35m            # Use client_credential.get("...") rather than "..." in client_credential[0m
[30;1m789 | [0m[35m            # so that we can ignore an empty string came from an empty ENV VAR.[0m
[30;1m790 | [0m[35m            if client_credential.get("client_assertion"):[0m
[30;1m791 | [0m[35m                client_assertion = client_credential['client_assertion'][0m
[30;1m792 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m598 | [0m[35m            self.http_client = requests.Session()[0m
[30;1m599 | [0m[35m            self.http_client.verify = verify[0m
[30;1m600 | [0m[35m            self.http_client.proxies = proxies[0m
[30;1m601 | [0m[35m            # Requests, does not support session - wide timeout[0m
[30;1m602 | [0m[35m            # But you can patch that (https://github.com/psf/requests/issues/3341):[0m
[30;1m603 | [0m[35m            self.http_client.request = functools.partial([0m
[30;1m604 | [0m[35m                self.http_client.request, timeout=timeout)[0m
[30;1m605 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m490 | [0m[35m            you would want to persist your http_cache across different CLI runs.[0m
[30;1m491 | [0m[35m            The following recipe shows a way to do so::[0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m                # Just add the following lines at the beginning of your CLI script[0m
[30;1m494 | [0m[35m                import sys, atexit, pickle[0m
[30;1m495 | [0m[35m                http_cache_filename = sys.argv[0] + ".http_cache"[0m
[30;1m496 | [0m[35m                try:[0m
[30;1m497 | [0m[35m                    with open(http_cache_filename, "rb") as f:[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m453 | [0m[35m            Supports 4 values:[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m            1. ``azure_region=None`` - This default value means no region is configured.[0m
[30;1m456 | [0m[35m               MSAL will use the region defined in env var ``MSAL_FORCE_REGION``.[0m
[30;1m457 | [0m[35m            2. ``azure_region="some_region"`` - meaning the specified region is used.[0m
[30;1m458 | [0m[35m            3. ``azure_region=True`` - meaning[0m
[30;1m459 | [0m[35m               MSAL will try to auto-detect the region. This is not recommended.[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m                The following command will generate a .pfx file from your .key and .pem file::[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m                    openssl pkcs12 -export -out certificate.pfx -inkey privateKey.key -in certificat[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m            .. admonition:: Support Subject Name/Issuer Auth with a cert in .pfx[0m
[30;1m347 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m        # Python documentation (https://docs.python.org/3/library/webbrowser.html)[0m
[30;1m140 | [0m[35m        # does not document the name being implicitly register,[0m
[30;1m141 | [0m[35m        # so there is no public API to know whether the ENV VAR browser would work.[0m
[30;1m142 | [0m[35m        # Therefore, we would not bother examine the env var browser's type.[0m
[30;1m143 | [0m[35m        # We would just register our own Edge instance.[0m
[30;1m144 | [0m[35m    if (user_has_no_preference or user_wont_mind_edge) and os.path.exists(browser_path):[0m
[30;1m145 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m        # BROWSER could contain "microsoft-edge" or "/path/to/microsoft-edge".[0m
[30;1m139 | [0m[35m        # Python documentation (https://docs.python.org/3/library/webbrowser.html)[0m
[30;1m140 | [0m[35m        # does not document the name being implicitly register,[0m
[30;1m141 | [0m[35m        # so there is no public API to know whether the ENV VAR browser would work.[0m
[30;1m142 | [0m[35m        # Therefore, we would not bother examine the env var browser's type.[0m
[30;1m143 | [0m[35m        # We would just register our own Edge instance.[0m
[30;1m144 | [0m[35m    if (user_has_no_preference or user_wont_mind_edge) and os.path.exists(browser_path):[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    # let's make best effort to exclude a private key pem file.[0m
[30;1m45 | [0m[35m    if "PRIVATE KEY" in public_cert_content:[0m
[30;1m46 | [0m[35m        raise ValueError([0m
[30;1m47 | [0m[35m            "We expect your public key but detect a private key instead")[0m
[30;1m48 | [0m[35m    return [public_cert_content.strip()][0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport functools[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport sys[0m
[30;1m6 | [0m[35mimport warnings[0m
[30;1m7 | [0m[35mfrom threading import Lock[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_mi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        self.assertEqual(1, len(cache.get("AccessToken", [])), "Should have 1 AT")[0m
[30;1m75 | [0m[35m        at = list(cache["AccessToken"].values())[0][0m
[30;1m76 | [0m[35m        self.assertEqual([0m
[30;1m77 | [0m[35m            app._managed_identity.get("Id", "SYSTEM_ASSIGNED_MANAGED_IDENTITY"),[0m
[30;1m78 | [0m[35m            at["client_id"],[0m
[30;1m79 | [0m[35m            "Should have expected client_id")[0m
[30;1m80 | [0m[35m        self.assertEqual("managed_identity", at["realm"], "Should have expected realm")[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_mi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    def assertCacheStatus(self, app):[0m
[30;1m73 | [0m[35m        cache = app._token_cache._cache[0m
[30;1m74 | [0m[35m        self.assertEqual(1, len(cache.get("AccessToken", [])), "Should have 1 AT")[0m
[30;1m75 | [0m[35m        at = list(cache["AccessToken"].values())[0][0m
[30;1m76 | [0m[35m        self.assertEqual([0m
[30;1m77 | [0m[35m            app._managed_identity.get("Id", "SYSTEM_ASSIGNED_MANAGED_IDENTITY"),[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_mi.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m        if expires_in >= 7200:[0m
[30;1m114 | [0m[35m            self.assertTrue([0m
[30;1m115 | [0m[35m                expected_refresh_on - 5 < result["refresh_on"] <= expected_refresh_on,[0m
[30;1m116 | [0m[35m                "Should have a refresh_on time around the middle of the token's life")[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        result = app.acquire_token_for_client(resource=resource, claims_challenge="foo")[0m
[30;1m119 | [0m[35m        self.assertEqual("identity_provider", result["token_source"], "Should miss cache")[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_mi.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m            expected_refresh_on = int(time.time() + expires_in / 2)[0m
[30;1m97 | [0m[35m            self.assertTrue([0m
[30;1m98 | [0m[35m                expected_refresh_on - 1 <= result["refresh_on"] <= expected_refresh_on + 1,[0m
[30;1m99 | [0m[35m                "Should have a refresh_on time around the middle of the token's life")[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        result = app.acquire_token_for_client(resource=resource)[0m
[30;1m102 | [0m[35m        self.assertCacheStatus(app)[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_mi.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport sys[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport unittest[0m
[30;1m6 | [0m[35mtry:[0m
[30;1m7 | [0m[35m    from unittest.mock import patch, ANY, mock_open, Mock[0m
[30;1m8 | [0m[35mexcept:[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_mi.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m72 | [0m[35m    def assertCacheStatus(self, app):[0m
[30;1m73 | [0m[35m        cache = app._token_cache._cache[0m
[30;1m74 | [0m[35m        self.assertEqual(1, len(cache.get("AccessToken", [])), "Should have 1 AT")[0m
[30;1m75 | [0m[35m        at = list(cache["AccessToken"].values())[0][0m
[30;1m76 | [0m[35m        self.assertEqual([0m
[30;1m77 | [0m[35m            app._managed_identity.get("Id", "SYSTEM_ASSIGNED_MANAGED_IDENTITY"),[0m
[30;1m78 | [0m[35m            at["client_id"],[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m        if qs.get('code') or qs.get("error"):  # So, it is an auth response[0m
[30;1m116 | [0m[35m            auth_response = _qs2kv(qs)[0m
[30;1m117 | [0m[35m            logger.debug("Got auth response: %s", auth_response)[0m
[30;1m118 | [0m[35m            if self.server.auth_state and self.server.auth_state != auth_response.get("state"):[0m
[30;1m119 | [0m[35m                # OAuth2 successful and error responses contain state when it was used[0m
[30;1m120 | [0m[35m                # https://www.rfc-editor.org/rfc/rfc6749#section-4.2.2.1[0m
[30;1m121 | [0m[35m                self._send_full_response("State mismatch")  # Possibly an attack[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        # For flexibility, we choose to not check self.path matching redirect_uri[0m
[30;1m113 | [0m[35m        #assert self.path.startswith('/THE_PATH_REGISTERED_BY_THE_APP')[0m
[30;1m114 | [0m[35m        qs = parse_qs(urlparse(self.path).query)[0m
[30;1m115 | [0m[35m        if qs.get('code') or qs.get("error"):  # So, it is an auth response[0m
[30;1m116 | [0m[35m            auth_response = _qs2kv(qs)[0m
[30;1m117 | [0m[35m            logger.debug("Got auth response: %s", auth_response)[0m
[30;1m118 | [0m[35m            if self.server.auth_state and self.server.auth_state != auth_response.get("state"):[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        # For flexibility, we choose to not check self.path matching redirect_uri[0m
[30;1m113 | [0m[35m        #assert self.path.startswith('/THE_PATH_REGISTERED_BY_THE_APP')[0m
[30;1m114 | [0m[35m        qs = parse_qs(urlparse(self.path).query)[0m
[30;1m115 | [0m[35m        if qs.get('code') or qs.get("error"):  # So, it is an auth response[0m
[30;1m116 | [0m[35m            auth_response = _qs2kv(qs)[0m
[30;1m117 | [0m[35m            logger.debug("Got auth response: %s", auth_response)[0m
[30;1m118 | [0m[35m            if self.server.auth_state and self.server.auth_state != auth_response.get("state"):[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    """Browse uri with named browser. Default browser is customizable by $BROWSER"""[0m
[30;1m70 | [0m[35m    import webbrowser  # Lazy import. Some distro may not have this.[0m
[30;1m71 | [0m[35m    if browser_name:[0m
[30;1m72 | [0m[35m        browser_opened = webbrowser.get(browser_name).open(auth_uri)[0m
[30;1m73 | [0m[35m    else:[0m
[30;1m74 | [0m[35m        # This one can survive BROWSER=nonexist, while get(None).open(...) can not[0m
[30;1m75 | [0m[35m        browser_opened = webbrowser.open(auth_uri)[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m                (You may want to use incognito window)[0m
[30;1m37 | [0m[35m                <hr><a href='$abort_uri'>Abort</a>[0m
[30;1m38 | [0m[35m                </body></html>""",[0m
[30;1m39 | [0m[35m            ).get("code")[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef _is_inside_docker():[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m352 | [0m[35m    logging.basicConfig(level=logging.INFO)[0m
[30;1m353 | [0m[35m    p = parser = argparse.ArgumentParser([0m
[30;1m354 | [0m[35m        formatter_class=argparse.ArgumentDefaultsHelpFormatter,[0m
[30;1m355 | [0m[35m        description=__doc__ + "The auth code received will be shown at stdout.")[0m
[30;1m356 | [0m[35m    p.add_argument([0m
[30;1m357 | [0m[35m        '--endpoint', help="The auth endpoint for your app.",[0m
[30;1m358 | [0m[35m        default="https://login.microsoftonline.com/common/oauth2/v2.0/authorize")[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m174 | [0m[35m        """Create a Receiver waiting for incoming auth response.[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m        :param port:[0m
[30;1m177 | [0m[35m            The local web server will listen at http://...:<port>[0m
[30;1m178 | [0m[35m            You need to use the same port when you register with your app.[0m
[30;1m179 | [0m[35m            If your Identity Provider supports dynamic port, you can use port=0 here.[0m
[30;1m180 | [0m[35m            Port 0 means to use an arbitrary unused port, per this official example:[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m            exit_code = subprocess.call([0m
[30;1m84 | [0m[35m                ['powershell.exe', '-NoProfile', '-Command', 'Start-Process "{}"'.format(auth_uri)])[0m
[30;1m85 | [0m[35m            browser_opened = exit_code == 0[0m
[30;1m86 | [0m[35m        except FileNotFoundError:  # WSL might be too old[0m
[30;1m87 | [0m[35m            pass[0m
[30;1m88 | [0m[35m    return browser_opened[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m        # This one can survive BROWSER=nonexist, while get(None).open(...) can not[0m
[30;1m75 | [0m[35m        browser_opened = webbrowser.open(auth_uri)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    # In WSL which doesn't have www-browser, try launching browser with PowerShell[0m
[30;1m78 | [0m[35m    if not browser_opened and is_wsl():[0m
[30;1m79 | [0m[35m        try:[0m
[30;1m80 | [0m[35m            import subprocess[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m    # "Official" way of detecting WSL: https://github.com/Microsoft/WSL/issues/423#issuecomment-2216[0m
[30;1m58 | [0m[35m    # Run `uname -a` to get 'release' without python[0m
[30;1m59 | [0m[35m    #   - WSL 1: '4.4.0-19041-Microsoft'[0m
[30;1m60 | [0m[35m    #   - WSL 2: '4.19.128-microsoft-standard'[0m
[30;1m61 | [0m[35m    import platform[0m
[30;1m62 | [0m[35m    uname = platform.uname()[0m
[30;1m63 | [0m[35m    platform_name = getattr(uname, 'system', uname[0]).lower()[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35mdef is_wsl():[0m
[30;1m57 | [0m[35m    # "Official" way of detecting WSL: https://github.com/Microsoft/WSL/issues/423#issuecomment-2216[0m
[30;1m58 | [0m[35m    # Run `uname -a` to get 'release' without python[0m
[30;1m59 | [0m[35m    #   - WSL 1: '4.4.0-19041-Microsoft'[0m
[30;1m60 | [0m[35m    #   - WSL 2: '4.19.128-microsoft-standard'[0m
[30;1m61 | [0m[35m    import platform[0m
[30;1m62 | [0m[35m    uname = platform.uname()[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m321 | [0m[35m        self._server.error_template = Template(error_template or[0m
[30;1m322 | [0m[35m            "Authentication failed. $error: $error_description. ($error_uri)")[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m        self._server.timeout = timeout  # Otherwise its handle_timeout() won't work[0m
[30;1m325 | [0m[35m        self._server.auth_response = {}  # Shared with _AuthCodeHandler[0m
[30;1m326 | [0m[35m        self._server.auth_state = state  # So handler will check it before sending response[0m
[30;1m327 | [0m[35m        while not self._closing:  # Otherwise, the handle_request() attempt[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m310 | [0m[35m                        "(i.e. started by `docker run -p 127.0.0.1:{port}:{port} -it ...`), "[0m
[30;1m311 | [0m[35m                        "you can use browser on host to visit the following link. "[0m
[30;1m312 | [0m[35m                        "Otherwise, this auth attempt would either timeout "[0m
[30;1m313 | [0m[35m                        "(current timeout setting is {timeout}) "[0m
[30;1m314 | [0m[35m                        "or be aborted by CTRL+C. Auth URI: {auth_uri}".format([0m
[30;1m315 | [0m[35m                            auth_uri=_uri, timeout=timeout, port=self.get_port()))[0m
[30;1m316 | [0m[35m                else:  # Then it is the auth_uri_callback()'s job to inform the user[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m309 | [0m[35m                        "or (2) published port {port} to host network "[0m
[30;1m310 | [0m[35m                        "(i.e. started by `docker run -p 127.0.0.1:{port}:{port} -it ...`), "[0m
[30;1m311 | [0m[35m                        "you can use browser on host to visit the following link. "[0m
[30;1m312 | [0m[35m                        "Otherwise, this auth attempt would either timeout "[0m
[30;1m313 | [0m[35m                        "(current timeout setting is {timeout}) "[0m
[30;1m314 | [0m[35m                        "or be aborted by CTRL+C. Auth URI: {auth_uri}".format([0m
[30;1m315 | [0m[35m                            auth_uri=_uri, timeout=timeout, port=self.get_port()))[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m        t.daemon = True  # So that it won't prevent the main thread from exiting[0m
[30;1m270 | [0m[35m        t.start()[0m
[30;1m271 | [0m[35m        begin = time.time()[0m
[30;1m272 | [0m[35m        while (time.time() - begin < timeout) if timeout else True:[0m
[30;1m273 | [0m[35m            time.sleep(1)  # Short detection interval to make happy path responsive[0m
[30;1m274 | [0m[35m            if not t.is_alive():  # Then the thread has finished its job and exited[0m
[30;1m275 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m        #[0m
[30;1m257 | [0m[35m        # However, the behaviors on Windows turns out to be different.[0m
[30;1m258 | [0m[35m        # A socket server waiting for request would freeze the current thread.[0m
[30;1m259 | [0m[35m        # Neither timeout nor CTRL+C would work. End user would have to do CTRL+BREAK.[0m
[30;1m260 | [0m[35m        # https://stackoverflow.com/questions/1364173/stopping-python-using-ctrlc[0m
[30;1m261 | [0m[35m        #[0m
[30;1m262 | [0m[35m        # The solution would need to somehow put the http server into its own thread.[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m            typically {"code": "...", "state": "..."} or {"error": "...", ...}[0m
[30;1m248 | [0m[35m            See https://tools.ietf.org/html/rfc6749#section-4.1.2[0m
[30;1m249 | [0m[35m            and https://openid.net/specs/openid-connect-core-1_0.html#AuthResponse[0m
[30;1m250 | [0m[35m            Returns None when the state was mismatched, or when timeout occurred.[0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        # Historically, the _get_auth_response() uses HTTPServer.handle_request(),[0m
[30;1m253 | [0m[35m        # because its handle-and-retry logic is conceptually as easy as a while loop.[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m            ``webbrowser.register("xyz", None, BackgroundBrowser("/path/to/browser"))``[0m
[30;1m242 | [0m[35m            beforehand, you can pass in the name "xyz" to use that browser.[0m
[30;1m243 | [0m[35m            The default value ``None`` means using default browser,[0m
[30;1m244 | [0m[35m            which is customizable by env var $BROWSER.[0m
[30;1m245 | [0m[35m        :return:[0m
[30;1m246 | [0m[35m            The auth response of the first leg of Auth Code flow,[0m
[30;1m247 | [0m[35m            typically {"code": "...", "state": "..."} or {"error": "...", ...}[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m            # Note:[0m
[30;1m198 | [0m[35m            #   When this server physically listens to a specific IP (as it should),[0m
[30;1m199 | [0m[35m            #   you will still be able to specify your redirect_uri using either[0m
[30;1m200 | [0m[35m            #   IP (e.g. 127.0.0.1) or localhost, whichever matches your registration.[0m
[30;1m201 | [0m[35m        self._scheduled_actions = sorted(scheduled_actions or [])  # Make a copy[0m
[30;1m202 | [0m[35m        Server = _AuthCodeHttpServer6 if ":" in address else _AuthCodeHttpServer[0m
[30;1m203 | [0m[35m            # TODO: But, it would treat "localhost" or "" as IPv4.[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m            #     rather than localhost avoids inadvertently listening on network[0m
[30;1m196 | [0m[35m            #     interfaces other than the loopback interface.[0m
[30;1m197 | [0m[35m            # Note:[0m
[30;1m198 | [0m[35m            #   When this server physically listens to a specific IP (as it should),[0m
[30;1m199 | [0m[35m            #   you will still be able to specify your redirect_uri using either[0m
[30;1m200 | [0m[35m            #   IP (e.g. 127.0.0.1) or localhost, whichever matches your registration.[0m
[30;1m201 | [0m[35m        self._scheduled_actions = sorted(scheduled_actions or [])  # Make a copy[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m            #   * Clients should listen on the loopback network interface only.[0m
[30;1m192 | [0m[35m            #     (It is not recommended to use "" shortcut to bind all addr.)[0m
[30;1m193 | [0m[35m            #   * the use of localhost is NOT RECOMMENDED.[0m
[30;1m194 | [0m[35m            #     (Use) the loopback IP literal[0m
[30;1m195 | [0m[35m            #     rather than localhost avoids inadvertently listening on network[0m
[30;1m196 | [0m[35m            #     interfaces other than the loopback interface.[0m
[30;1m197 | [0m[35m            # Note:[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m                    return True[0m
[30;1m51 | [0m[35m    except IOError:[0m
[30;1m52 | [0m[35m        pass  # We are probably not running on Linux[0m
[30;1m53 | [0m[35m    return os.path.exists("/.dockerenv")  # Docker on Mac will run this line[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mdef is_wsl():[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/oauth2cli/authcode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport sys[0m
[30;1m12 | [0m[35mfrom string import Template[0m
[30;1m13 | [0m[35mimport threading[0m
[30;1m14 | [0m[35mimport time[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mtry:  # Python 3[0m
[30;1m17 | [0m[35m    from http.server import HTTPServer, BaseHTTPRequestHandler[0m
[30;1m18 | [0m[35m    from urllib.parse import urlparse, parse_qs, urlencode[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m    ##       cache the token with a different scope and won't hit them later.[0m
[30;1m121 | [0m[35m    #if imds_payload.get("resource"):[0m
[30;1m122 | [0m[35m    #    oauth2_response["scope"] = imds_payload["resource"][0m
[30;1m123 | [0m[35m    if imds_payload.get("refresh_token"):[0m
[30;1m124 | [0m[35m        oauth2_response["refresh_token"] = imds_payload["refresh_token"][0m
[30;1m125 | [0m[35m    return oauth2_response[0m
[30;1m126 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m    ## Note: Decided to not surface resource back as scope,[0m
[30;1m119 | [0m[35m    ##       because they would cause the downstream OAuth2 code path to[0m
[30;1m120 | [0m[35m    ##       cache the token with a different scope and won't hit them later.[0m
[30;1m121 | [0m[35m    #if imds_payload.get("resource"):[0m
[30;1m122 | [0m[35m    #    oauth2_response["scope"] = imds_payload["resource"][0m
[30;1m123 | [0m[35m    if imds_payload.get("refresh_token"):[0m
[30;1m124 | [0m[35m        oauth2_response["refresh_token"] = imds_payload["refresh_token"][0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m                "exp": jwt_payload["exp"],[0m
[30;1m106 | [0m[35m                "iat": jwt_payload["iat"],[0m
[30;1m107 | [0m[35m                "preferred_username": jwt_payload.get("preferred_username")  # V2[0m
[30;1m108 | [0m[35m                    or jwt_payload.get("unique_name")  # V1[0m
[30;1m109 | [0m[35m                    or preferred_username,[0m
[30;1m110 | [0m[35m                }[0m
[30;1m111 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m                "aud": client_id,[0m
[30;1m105 | [0m[35m                "exp": jwt_payload["exp"],[0m
[30;1m106 | [0m[35m                "iat": jwt_payload["iat"],[0m
[30;1m107 | [0m[35m                "preferred_username": jwt_payload.get("preferred_username")  # V2[0m
[30;1m108 | [0m[35m                    or jwt_payload.get("unique_name")  # V1[0m
[30;1m109 | [0m[35m                    or preferred_username,[0m
[30;1m110 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m                # Mimic a real home_account_id,[0m
[30;1m97 | [0m[35m                # so that this pseudo account and a real account would interop.[0m
[30;1m98 | [0m[35m                "uid": jwt_payload.get("oid", "user"),[0m
[30;1m99 | [0m[35m                "utid": jwt_payload.get("tid", "cloudshell"),[0m
[30;1m100 | [0m[35m                }[0m
[30;1m101 | [0m[35m            oauth2_response["id_token_claims"] = {[0m
[30;1m102 | [0m[35m                "iss": jwt_payload["iss"],[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m            client_info = {[0m
[30;1m96 | [0m[35m                # Mimic a real home_account_id,[0m
[30;1m97 | [0m[35m                # so that this pseudo account and a real account would interop.[0m
[30;1m98 | [0m[35m                "uid": jwt_payload.get("oid", "user"),[0m
[30;1m99 | [0m[35m                "utid": jwt_payload.get("tid", "cloudshell"),[0m
[30;1m100 | [0m[35m                }[0m
[30;1m101 | [0m[35m            oauth2_response["id_token_claims"] = {[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        "expires_in": int(imds_payload["expires_in"]),[0m
[30;1m64 | [0m[35m        "token_type": imds_payload.get("token_type", BEARER),[0m
[30;1m65 | [0m[35m        }[0m
[30;1m66 | [0m[35m    expected_token_type = (data or {}).get("token_type", BEARER)[0m
[30;1m67 | [0m[35m    if oauth2_response["token_type"] != expected_token_type:[0m
[30;1m68 | [0m[35m        return {  # Generate a normal error (rather than an intrusive exception)[0m
[30;1m69 | [0m[35m            "error": "broker_error",[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    oauth2_response = {[0m
[30;1m62 | [0m[35m        "access_token": imds_payload["access_token"],[0m
[30;1m63 | [0m[35m        "expires_in": int(imds_payload["expires_in"]),[0m
[30;1m64 | [0m[35m        "token_type": imds_payload.get("token_type", BEARER),[0m
[30;1m65 | [0m[35m        }[0m
[30;1m66 | [0m[35m    expected_token_type = (data or {}).get("token_type", BEARER)[0m
[30;1m67 | [0m[35m    if oauth2_response["token_type"] != expected_token_type:[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        cs_error = json.loads(resp.text).get("error", {})[0m
[30;1m55 | [0m[35m        return {k: v for k, v in {[0m
[30;1m56 | [0m[35m            "error": cs_error.get("code"),[0m
[30;1m57 | [0m[35m            "error_description": cs_error.get("message"),[0m
[30;1m58 | [0m[35m            }.items() if v}[0m
[30;1m59 | [0m[35m    imds_payload = json.loads(resp.text)[0m
[30;1m60 | [0m[35m    BEARER = "Bearer"[0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        logger.debug("Cloud Shell IMDS error: %s", resp.text)[0m
[30;1m54 | [0m[35m        cs_error = json.loads(resp.text).get("error", {})[0m
[30;1m55 | [0m[35m        return {k: v for k, v in {[0m
[30;1m56 | [0m[35m            "error": cs_error.get("code"),[0m
[30;1m57 | [0m[35m            "error_description": cs_error.get("message"),[0m
[30;1m58 | [0m[35m            }.items() if v}[0m
[30;1m59 | [0m[35m    imds_payload = json.loads(resp.text)[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m        )[0m
[30;1m52 | [0m[35m    if resp.status_code >= 300:[0m
[30;1m53 | [0m[35m        logger.debug("Cloud Shell IMDS error: %s", resp.text)[0m
[30;1m54 | [0m[35m        cs_error = json.loads(resp.text).get("error", {})[0m
[30;1m55 | [0m[35m        return {k: v for k, v in {[0m
[30;1m56 | [0m[35m            "error": cs_error.get("code"),[0m
[30;1m57 | [0m[35m            "error_description": cs_error.get("message"),[0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mdef _obtain_token(http_client, scopes, client_id=None, data=None):[0m
[30;1m45 | [0m[35m    resp = http_client.post([0m
[30;1m46 | [0m[35m        "http://localhost:50342/oauth2/token",[0m
[30;1m47 | [0m[35m        data=dict([0m
[30;1m48 | [0m[35m            data or {},[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mdef _is_running_in_cloud_shell():[0m
[30;1m23 | [0m[35m    return os.environ.get("AZUREPS_HOST_ENVIRONMENT", "").startswith("cloud-shell")[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef _scope_to_resource(scope):  # This is an experimental reasonable-effort approach[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m            }[0m
[30;1m73 | [0m[35m    parts = imds_payload["access_token"].split(".")[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    # The following default values are useful in SSH Cert scenario[0m
[30;1m76 | [0m[35m    client_info = {  # Default value, in case the real value will be unavailable[0m
[30;1m77 | [0m[35m        "uid": "user",[0m
[30;1m78 | [0m[35m        "utid": "cloudshell",[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport logging[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mtry:  # Python 2[0m
[30;1m13 | [0m[35m    from urlparse import urlparse[0m
[30;1m14 | [0m[35mexcept:  # Python 3[0m
[30;1m15 | [0m[35m    from urllib.parse import urlparse[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/cloudshell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# This code is licensed under the MIT License.[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m"""This module wraps Cloud Shell's IMDS-like interface inside an OAuth2-like helper"""[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport logging[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport time[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/telemetry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m        simulation = len(",{api_id},{correlation_id},{error}".format([0m
[30;1m72 | [0m[35m            api_id=self._api_id, correlation_id=self._correlation_id, error=error))[0m
[30;1m73 | [0m[35m        if self._buffer.get(self._FAILURE_SIZE, 0) + simulation < self._LAST_HEADER_SIZE_LIMIT:[0m
[30;1m74 | [0m[35m            self._buffer[self._FAILURE_SIZE] = self._buffer.get([0m
[30;1m75 | [0m[35m                self._FAILURE_SIZE, 0) + simulation[0m
[30;1m76 | [0m[35m            self._buffer.setdefault(self._FAILED, []).append({[0m
[30;1m77 | [0m[35m                "a": self._api_id, "c": self._correlation_id, "e": error})[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/telemetry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m    def _record_failure(self, error):[0m
[30;1m71 | [0m[35m        simulation = len(",{api_id},{correlation_id},{error}".format([0m
[30;1m72 | [0m[35m            api_id=self._api_id, correlation_id=self._correlation_id, error=error))[0m
[30;1m73 | [0m[35m        if self._buffer.get(self._FAILURE_SIZE, 0) + simulation < self._LAST_HEADER_SIZE_LIMIT:[0m
[30;1m74 | [0m[35m            self._buffer[self._FAILURE_SIZE] = self._buffer.get([0m
[30;1m75 | [0m[35m                self._FAILURE_SIZE, 0) + simulation[0m
[30;1m76 | [0m[35m            self._buffer.setdefault(self._FAILED, []).append({[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/telemetry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    def hit_an_access_token(self):[0m
[30;1m59 | [0m[35m        with self._lock:[0m
[30;1m60 | [0m[35m            self._buffer[self._SUCCEEDED] = self._buffer.get(self._SUCCEEDED, 0) + 1[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    def update_telemetry(self, auth_result):[0m
[30;1m63 | [0m[35m        if auth_result:[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/telemetry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m                CLIENT_REQUEST_ID: self._correlation_id,[0m
[30;1m50 | [0m[35m                CLIENT_CURRENT_TELEMETRY: current,[0m
[30;1m51 | [0m[35m                CLIENT_LAST_TELEMETRY: "4|{succeeded}|{failed_requests}|{errors}|".format([0m
[30;1m52 | [0m[35m                    succeeded=self._buffer.get(self._SUCCEEDED, 0),[0m
[30;1m53 | [0m[35m                    failed_requests=",".join("{a},{c}".format(**f) for f in failures),[0m
[30;1m54 | [0m[35m                    errors=",".join(f["e"] for f in failures),[0m
[30;1m55 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/telemetry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m                logger.warning([0m
[30;1m45 | [0m[35m                    "Telemetry header greater than {} will be truncated by AAD".format([0m
[30;1m46 | [0m[35m                    self._CURRENT_HEADER_SIZE_LIMIT))[0m
[30;1m47 | [0m[35m            failures = self._buffer.get(self._FAILED, [])[0m
[30;1m48 | [0m[35m            return {[0m
[30;1m49 | [0m[35m                CLIENT_REQUEST_ID: self._correlation_id,[0m
[30;1m50 | [0m[35m                CLIENT_CURRENT_TELEMETRY: current,[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m        lambda result, callback_data=callback_data: callback_data.complete(result))[0m
[30;1m256 | [0m[35m    callback_data.signal.wait()[0m
[30;1m257 | [0m[35m    return _convert_result([0m
[30;1m258 | [0m[35m        callback_data.result, client_id, expected_token_type=kwargs.get("token_type"))[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35mdef _signout_silently(client_id, account_id, correlation_id=None):[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m        lambda result, callback_data=callback_data: callback_data.complete(result))[0m
[30;1m224 | [0m[35m    callback_data.signal.wait()[0m
[30;1m225 | [0m[35m    return _convert_result([0m
[30;1m226 | [0m[35m        callback_data.result, client_id, expected_token_type=kwargs.get("token_type"))[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35mdef _acquire_token_silently([0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m        lambda result, callback_data=callback_data: callback_data.complete(result))[0m
[30;1m168 | [0m[35m    callback_data.signal.wait()[0m
[30;1m169 | [0m[35m    return _convert_result([0m
[30;1m170 | [0m[35m        callback_data.result, client_id, expected_token_type=kwargs.get("token_type"))[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35mdef _signin_interactively([0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    min_ver = {[0m
[30;1m28 | [0m[35m        "win32": "1.20",[0m
[30;1m29 | [0m[35m        "darwin": "1.31",[0m
[30;1m30 | [0m[35m    }.get(sys.platform)[0m
[30;1m31 | [0m[35m    if min_ver:[0m
[30;1m32 | [0m[35m        raise ImportError([0m
[30;1m33 | [0m[35m            f'You must install dependency by: pip install "msal[broker]>={min_ver},<2"')[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        #pymsalruntime.LogLevel.WARNING: logger.warning,[0m
[30;1m21 | [0m[35m        #pymsalruntime.LogLevel.ERROR: logger.error,[0m
[30;1m22 | [0m[35m        pymsalruntime.LogLevel.FATAL: logger.critical,[0m
[30;1m23 | [0m[35m        }.get(level, logger.debug)(message))[0m
[30;1m24 | [0m[35mexcept (ImportError, AttributeError):  # AttributeError happens when a prior pymsalruntime uninstall[0m
[30;1m25 | [0m[35m    # PyMsalRuntime currently supports these Windows versions, listed in this MSFT internal link[0m
[30;1m26 | [0m[35m    # https://github.com/AzureAD/microsoft-authentication-library-for-cpp/pull/2406/files[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m        }.items() if v}[0m
[30;1m122 | [0m[35m    likely_a_cert = return_value["access_token"].startswith("AAAA")  # Empirical observation[0m
[30;1m123 | [0m[35m    if return_value["token_type"].lower() == "ssh-cert" and not likely_a_cert:[0m
[30;1m124 | [0m[35m        raise TokenTypeError("Broker could not get an SSH Cert: {}...".format([0m
[30;1m125 | [0m[35m            return_value["access_token"][:8]))[0m
[30;1m126 | [0m[35m    granted_scopes = result.get_granted_scopes()  # New in pymsalruntime 0.3.x[0m
[30;1m127 | [0m[35m    if granted_scopes:[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m    }.get(sys.platform)[0m
[30;1m31 | [0m[35m    if min_ver:[0m
[30;1m32 | [0m[35m        raise ImportError([0m
[30;1m33 | [0m[35m            f'You must install dependency by: pip install "msal[broker]>={min_ver},<2"')[0m
[30;1m34 | [0m[35m    else:  # Unsupported platform[0m
[30;1m35 | [0m[35m        raise ImportError("Dependency pymsalruntime unavailable on current platform")[0m
[30;1m36 | [0m[35m# It could throw RuntimeError when running on ancient versions of Windows[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/broker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport sys[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mimport uuid[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom .sku import __version__, SKU[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m    def __iter__(self):[0m
[30;1m171 | [0m[35m        """Drop all expired items and return an iterator of the remaining items"""[0m
[30;1m172 | [0m[35m        with self._lock:[0m
[30;1m173 | [0m[35m            sequence, timestamps = self._mapping.get(self._INDEX, ([], {}))[0m
[30;1m174 | [0m[35m            self._maintenance(sequence, timestamps)  # O(logN)[0m
[30;1m175 | [0m[35m            self._mapping[self._INDEX] = sequence, timestamps[0m
[30;1m176 | [0m[35m        return iter(timestamps)  # Faster than iter(self._mapping) when it is on disk[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m    def __len__(self):  # O(logN)[0m
[30;1m163 | [0m[35m        """Drop all expired items and return the remaining length"""[0m
[30;1m164 | [0m[35m        with self._lock:[0m
[30;1m165 | [0m[35m            sequence, timestamps = self._mapping.get(self._INDEX, ([], {}))[0m
[30;1m166 | [0m[35m            self._maintenance(sequence, timestamps)  # O(logN)[0m
[30;1m167 | [0m[35m            self._mapping[self._INDEX] = sequence, timestamps[0m
[30;1m168 | [0m[35m            return len(timestamps)  # Faster than iter(self._mapping) when it is on disk[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m        with self._lock:[0m
[30;1m156 | [0m[35m            # Skip self._maintenance(), because it would need O(logN) time[0m
[30;1m157 | [0m[35m            self._mapping.pop(key, None)  # O(1)[0m
[30;1m158 | [0m[35m            sequence, timestamps = self._mapping.get(self._INDEX, ([], {}))[0m
[30;1m159 | [0m[35m            del timestamps[key]  # O(1)[0m
[30;1m160 | [0m[35m            self._mapping[self._INDEX] = sequence, timestamps[0m
[30;1m161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m        self._validate_key(key)[0m
[30;1m137 | [0m[35m        with self._lock:[0m
[30;1m138 | [0m[35m            # Skip self._maintenance(), because it would need O(logN) time[0m
[30;1m139 | [0m[35m            sequence, timestamps = self._mapping.get(self._INDEX, ([], {}))[0m
[30;1m140 | [0m[35m            expires_at, created_at = timestamps[key]  # Would raise KeyError accordingly[0m
[30;1m141 | [0m[35m            now = int(time.time())[0m
[30;1m142 | [0m[35m            if not created_at <= now < expires_at:[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    def _drop_indexed_entry(self, timestamps, entry):[0m
[30;1m117 | [0m[35m        """For an entry came from index, drop it from timestamps and self._mapping"""[0m
[30;1m118 | [0m[35m        expires_at, created_at, key = entry[0m
[30;1m119 | [0m[35m        if [expires_at, created_at] == timestamps.get(key):  # So it is not an orphan[0m
[30;1m120 | [0m[35m            self._mapping.pop(key, None)  # It could raise exception[0m
[30;1m121 | [0m[35m            timestamps.pop(key, None)  # This would probably always succeed[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        # This internal implementation powers both set() and __setitem__(),[0m
[30;1m86 | [0m[35m        # so that they don't depend on each other.[0m
[30;1m87 | [0m[35m        self._validate_key(key)[0m
[30;1m88 | [0m[35m        sequence, timestamps = self._mapping.get(self._INDEX, ([], {}))[0m
[30;1m89 | [0m[35m        self._maintenance(sequence, timestamps)  # O(logN)[0m
[30;1m90 | [0m[35m        now = int(time.time())[0m
[30;1m91 | [0m[35m        expires_at = now + expires_in[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m206 | [0m[35m                        ...[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m                If you want to use a mapping available only at run-time,[0m
[30;1m209 | [0m[35m                you have to manually decorate your function at run-time, too::[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m                    def foo():[0m
[30;1m212 | [0m[35m                        ...[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m                    def foo():[0m
[30;1m206 | [0m[35m                        ...[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m                If you want to use a mapping available only at run-time,[0m
[30;1m209 | [0m[35m                you have to manually decorate your function at run-time, too::[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m                    def foo():[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m196 | [0m[35m            .. note::[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m                When using this class as a decorator,[0m
[30;1m199 | [0m[35m                your mapping needs to be available at "compile" time,[0m
[30;1m200 | [0m[35m                so it would typically be a global-, module- or class-level mapping::[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m                    module_mapping = {}[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m182 | [0m[35m    # We may potentially switch to build upon[0m
[30;1m183 | [0m[35m    # https://github.com/micheles/decorator/blob/master/docs/documentation.md#statement-of-the-probl[0m
[30;1m184 | [0m[35m    def __init__(self, mapping=None, key_maker=None, expires_in=None):[0m
[30;1m185 | [0m[35m        """Constructs a cache decorator that allows item-by-item control on[0m
[30;1m186 | [0m[35m        how to cache the return value of the decorated function.[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        :param MutableMapping mapping:[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m18 | [0m[35m        determined by each food, not by the refrigerator.[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m        Expired items will be automatically evicted.[0m
[30;1m21 | [0m[35m        The clean-up will be done at each time when adding a new item,[0m
[30;1m22 | [0m[35m        or when looping or counting the entire mapping.[0m
[30;1m23 | [0m[35m        (This is better than being done indecisively by a background thread,[0m
[30;1m24 | [0m[35m        which might not always happen before your accessing the mapping.)[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m        """If the item you requested already expires, KeyError will be raised."""[0m
[30;1m154 | [0m[35m        self._validate_key(key)[0m
[30;1m155 | [0m[35m        with self._lock:[0m
[30;1m156 | [0m[35m            # Skip self._maintenance(), because it would need O(logN) time[0m
[30;1m157 | [0m[35m            self._mapping.pop(key, None)  # O(1)[0m
[30;1m158 | [0m[35m            sequence, timestamps = self._mapping.get(self._INDEX, ([], {}))[0m
[30;1m159 | [0m[35m            del timestamps[key]  # O(1)[0m
[30;1m160 | [0m[35m            self._mapping[self._INDEX] = sequence, timestamps[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m        """If the item you requested already expires, KeyError will be raised."""[0m
[30;1m136 | [0m[35m        self._validate_key(key)[0m
[30;1m137 | [0m[35m        with self._lock:[0m
[30;1m138 | [0m[35m            # Skip self._maintenance(), because it would need O(logN) time[0m
[30;1m139 | [0m[35m            sequence, timestamps = self._mapping.get(self._INDEX, ([], {}))[0m
[30;1m140 | [0m[35m            expires_at, created_at = timestamps[key]  # Would raise KeyError accordingly[0m
[30;1m141 | [0m[35m            now = int(time.time())[0m
[30;1m142 | [0m[35m            if not created_at <= now < expires_at:[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        """It sets the key-value pair into this mapping, with its per-item expires_in.[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        It will take O(logN) time, because it will run some maintenance.[0m
[30;1m75 | [0m[35m        This worse-than-constant time is acceptable, because in a cache scenario,[0m
[30;1m76 | [0m[35m        __setitem__() would only be called during a cache miss,[0m
[30;1m77 | [0m[35m        which would already incur an expensive target function call anyway.[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m        determined by each food, not by the refrigerator.[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m        Expired items will be automatically evicted.[0m
[30;1m21 | [0m[35m        The clean-up will be done at each time when adding a new item,[0m
[30;1m22 | [0m[35m        or when looping or counting the entire mapping.[0m
[30;1m23 | [0m[35m        (This is better than being done indecisively by a background thread,[0m
[30;1m24 | [0m[35m        which might not always happen before your accessing the mapping.)[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/individual_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom functools import wraps[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mtry:[0m
[30;1m4 | [0m[35m    from collections.abc import MutableMapping  # Python 3.3+[0m
[30;1m5 | [0m[35mexcept ImportError:[0m
[30;1m6 | [0m[35m    from collections import MutableMapping  # Python 2.7+[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        endpoints = [][0m
[30;1m119 | [0m[35m        for port in self.dom.findall('wsdl:service/wsdl:port', self.NS):[0m
[30;1m120 | [0m[35m            binding_name = port.get("binding").split(':')[-1]  # Should have 2 parts[0m
[30;1m121 | [0m[35m            binding = bindings.get(binding_name)[0m
[30;1m122 | [0m[35m            if binding and binding["policy_uri"] in policy_ids:[0m
[30;1m123 | [0m[35m                address = port.find('wsa10:EndpointReference/wsa10:Address', self.NS)[0m
[30;1m124 | [0m[35m                if address is not None and address.text.lower().startswith("https://"):[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m    def _get_endpoints(self, bindings, policy_ids):[0m
[30;1m118 | [0m[35m        endpoints = [][0m
[30;1m119 | [0m[35m        for port in self.dom.findall('wsdl:service/wsdl:port', self.NS):[0m
[30;1m120 | [0m[35m            binding_name = port.get("binding").split(':')[-1]  # Should have 2 parts[0m
[30;1m121 | [0m[35m            binding = bindings.get(binding_name)[0m
[30;1m122 | [0m[35m            if binding and binding["policy_uri"] in policy_ids:[0m
[30;1m123 | [0m[35m                address = port.find('wsa10:EndpointReference/wsa10:Address', self.NS)[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m                'wsdl:operation/soap12:operation', self.NS).get("soapAction")[0m
[30;1m112 | [0m[35m            for pr in binding.findall("wsp:PolicyReference", self.NS):[0m
[30;1m113 | [0m[35m                bindings[binding.get("name")] = {[0m
[30;1m114 | [0m[35m                    "policy_uri": pr.get("URI"), "action": action}[0m
[30;1m115 | [0m[35m        return bindings[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    def _get_endpoints(self, bindings, policy_ids):[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            action = binding.find([0m
[30;1m111 | [0m[35m                'wsdl:operation/soap12:operation', self.NS).get("soapAction")[0m
[30;1m112 | [0m[35m            for pr in binding.findall("wsp:PolicyReference", self.NS):[0m
[30;1m113 | [0m[35m                bindings[binding.get("name")] = {[0m
[30;1m114 | [0m[35m                    "policy_uri": pr.get("URI"), "action": action}[0m
[30;1m115 | [0m[35m        return bindings[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m                    'http://schemas.xmlsoap.org/soap/http'):[0m
[30;1m109 | [0m[35m                continue[0m
[30;1m110 | [0m[35m            action = binding.find([0m
[30;1m111 | [0m[35m                'wsdl:operation/soap12:operation', self.NS).get("soapAction")[0m
[30;1m112 | [0m[35m            for pr in binding.findall("wsp:PolicyReference", self.NS):[0m
[30;1m113 | [0m[35m                bindings[binding.get("name")] = {[0m
[30;1m114 | [0m[35m                    "policy_uri": pr.get("URI"), "action": action}[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m    def _get_bindings(self):[0m
[30;1m105 | [0m[35m        bindings = {}  # {binding_name: {"policy_uri": "...", "version": "..."}}[0m
[30;1m106 | [0m[35m        for binding in self.dom.findall("wsdl:binding", self.NS):[0m
[30;1m107 | [0m[35m            if (binding.find('soap12:binding', self.NS).get("transport") !=[0m
[30;1m108 | [0m[35m                    'http://schemas.xmlsoap.org/soap/http'):[0m
[30;1m109 | [0m[35m                continue[0m
[30;1m110 | [0m[35m            action = binding.find([0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def _get_policy_ids(self, components_to_leaf, binding_xpath):[0m
[30;1m82 | [0m[35m        id_attr = '{%s}Id' % self.NS['wsu'][0m
[30;1m83 | [0m[35m        return set(["#{}".format(policy.get(id_attr))[0m
[30;1m84 | [0m[35m            for policy in self.dom.findall(_xpath_of_root(components_to_leaf), self.NS)[0m
[30;1m85 | [0m[35m            # If we did not find any binding, this is potentially bad.[0m
[30;1m86 | [0m[35m            if policy.find(binding_xpath, self.NS) is not None])[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mdef send_request(mex_endpoint, http_client, **kwargs):[0m
[30;1m47 | [0m[35m    mex_resp = http_client.get(mex_endpoint, **kwargs)[0m
[30;1m48 | [0m[35m    mex_resp.raise_for_status()[0m
[30;1m49 | [0m[35m    try:[0m
[30;1m50 | [0m[35m        return Mex(mex_resp.text).get_wstrust_username_password_endpoint()[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m        id_attr = '{%s}Id' % self.NS['wsu'][0m
[30;1m83 | [0m[35m        return set(["#{}".format(policy.get(id_attr))[0m
[30;1m84 | [0m[35m            for policy in self.dom.findall(_xpath_of_root(components_to_leaf), self.NS)[0m
[30;1m85 | [0m[35m            # If we did not find any binding, this is potentially bad.[0m
[30;1m86 | [0m[35m            if policy.find(binding_xpath, self.NS) is not None])[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    def _get_username_password_policy_ids(self):[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mdef _xpath_of_root(route_to_leaf):[0m
[30;1m42 | [0m[35m    # Construct an xpath suitable to find a root node which has a specified leaf[0m
[30;1m43 | [0m[35m    return '/'.join(route_to_leaf + ['..'] * (len(route_to_leaf)-1))[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/mex.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mdef _xpath_of_root(route_to_leaf):[0m
[30;1m42 | [0m[35m    # Construct an xpath suitable to find a root node which has a specified leaf[0m
[30;1m43 | [0m[35m    return '/'.join(route_to_leaf + ['..'] * (len(route_to_leaf)-1))[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m        return self.modify(self.CredentialType.ACCESS_TOKEN, at_item)[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    def remove_idt(self, idt_item):[0m
[30;1m374 | [0m[35m        assert idt_item.get("credential_type") == self.CredentialType.ID_TOKEN[0m
[30;1m375 | [0m[35m        return self.modify(self.CredentialType.ID_TOKEN, idt_item)[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    def remove_account(self, account_item):[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m            })[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m    def remove_at(self, at_item):[0m
[30;1m370 | [0m[35m        assert at_item.get("credential_type") == self.CredentialType.ACCESS_TOKEN[0m
[30;1m371 | [0m[35m        return self.modify(self.CredentialType.ACCESS_TOKEN, at_item)[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    def remove_idt(self, idt_item):[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m        return self.modify(self.CredentialType.REFRESH_TOKEN, rt_item)[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m    def update_rt(self, rt_item, new_rt):[0m
[30;1m363 | [0m[35m        assert rt_item.get("credential_type") == self.CredentialType.REFRESH_TOKEN[0m
[30;1m364 | [0m[35m        return self.modify(self.CredentialType.REFRESH_TOKEN, rt_item, {[0m
[30;1m365 | [0m[35m            "secret": new_rt,[0m
[30;1m366 | [0m[35m            "last_modification_time": str(int(time.time())),  # Optional. Schema defines it as a str[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m                self._cache.setdefault(credential_type, {}).pop(key, None)[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m    def remove_rt(self, rt_item):[0m
[30;1m359 | [0m[35m        assert rt_item.get("credential_type") == self.CredentialType.REFRESH_TOKEN[0m
[30;1m360 | [0m[35m        return self.modify(self.CredentialType.REFRESH_TOKEN, rt_item)[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m    def update_rt(self, rt_item, new_rt):[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m                "environment": environment,[0m
[30;1m335 | [0m[35m                }[0m
[30;1m336 | [0m[35m            if "foci" in response:[0m
[30;1m337 | [0m[35m                app_metadata["family_id"] = response.get("foci")[0m
[30;1m338 | [0m[35m            self.modify(self.CredentialType.APP_METADATA, app_metadata, app_metadata)[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m    def modify(self, credential_type, old_entry, new_key_value_pairs=None):[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m                self.modify(self.CredentialType.REFRESH_TOKEN, rt, rt)[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m            app_metadata = {[0m
[30;1m333 | [0m[35m                "client_id": event.get("client_id"),[0m
[30;1m334 | [0m[35m                "environment": environment,[0m
[30;1m335 | [0m[35m                }[0m
[30;1m336 | [0m[35m            if "foci" in response:[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m                    "secret": refresh_token,[0m
[30;1m322 | [0m[35m                    "home_account_id": home_account_id,[0m
[30;1m323 | [0m[35m                    "environment": environment,[0m
[30;1m324 | [0m[35m                    "client_id": event.get("client_id"),[0m
[30;1m325 | [0m[35m                    "target": target,  # Optional per schema though[0m
[30;1m326 | [0m[35m                    "last_modification_time": str(now),  # Optional. Schema defines it as a string.[0m
[30;1m327 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m310 | [0m[35m                    "home_account_id": home_account_id,[0m
[30;1m311 | [0m[35m                    "environment": environment,[0m
[30;1m312 | [0m[35m                    "realm": realm,[0m
[30;1m313 | [0m[35m                    "client_id": event.get("client_id"),[0m
[30;1m314 | [0m[35m                    # "authority": "it is optional",[0m
[30;1m315 | [0m[35m                    }[0m
[30;1m316 | [0m[35m                self.modify(self.CredentialType.ID_TOKEN, idt, idt)[0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m                grant_types_that_establish_an_account = ([0m
[30;1m300 | [0m[35m                    _GRANT_TYPE_BROKER, "authorization_code", "password",[0m
[30;1m301 | [0m[35m                    Client.DEVICE_FLOW["GRANT_TYPE"])[0m
[30;1m302 | [0m[35m                if event.get("grant_type") in grant_types_that_establish_an_account:[0m
[30;1m303 | [0m[35m                    account["account_source"] = event["grant_type"][0m
[30;1m304 | [0m[35m                self.modify(self.CredentialType.ACCOUNT, account, account)[0m
[30;1m305 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m                        "authority_type",  # Honor caller's choice of authority_type[0m
[30;1m295 | [0m[35m                        self.AuthorityType.ADFS if realm == "adfs"[0m
[30;1m296 | [0m[35m                            else self.AuthorityType.MSSTS),[0m
[30;1m297 | [0m[35m                    # "client_info": response.get("client_info"),  # Optional[0m
[30;1m298 | [0m[35m                    }[0m
[30;1m299 | [0m[35m                grant_types_that_establish_an_account = ([0m
[30;1m300 | [0m[35m                    _GRANT_TYPE_BROKER, "authorization_code", "password",[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m                        or data.get("username")  # Falls back to ROPC username[0m
[30;1m291 | [0m[35m                        or event.get("username")  # Falls back to Federated ROPC username[0m
[30;1m292 | [0m[35m                        or "",  # The schema does not like null[0m
[30;1m293 | [0m[35m                    "authority_type": event.get([0m
[30;1m294 | [0m[35m                        "authority_type",  # Honor caller's choice of authority_type[0m
[30;1m295 | [0m[35m                        self.AuthorityType.ADFS if realm == "adfs"[0m
[30;1m296 | [0m[35m                            else self.AuthorityType.MSSTS),[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m                        id_token_claims.get("oid", id_token_claims.get("sub"))),[0m
[30;1m289 | [0m[35m                    "username": _get_username(id_token_claims)[0m
[30;1m290 | [0m[35m                        or data.get("username")  # Falls back to ROPC username[0m
[30;1m291 | [0m[35m                        or event.get("username")  # Falls back to Federated ROPC username[0m
[30;1m292 | [0m[35m                        or "",  # The schema does not like null[0m
[30;1m293 | [0m[35m                    "authority_type": event.get([0m
[30;1m294 | [0m[35m                        "authority_type",  # Honor caller's choice of authority_type[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m                            # Emperically, it is the oid in AAD or cid in MSA.[0m
[30;1m288 | [0m[35m                        id_token_claims.get("oid", id_token_claims.get("sub"))),[0m
[30;1m289 | [0m[35m                    "username": _get_username(id_token_claims)[0m
[30;1m290 | [0m[35m                        or data.get("username")  # Falls back to ROPC username[0m
[30;1m291 | [0m[35m                        or event.get("username")  # Falls back to Federated ROPC username[0m
[30;1m292 | [0m[35m                        or "",  # The schema does not like null[0m
[30;1m293 | [0m[35m                    "authority_type": event.get([0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m                    "local_account_id": event.get([0m
[30;1m286 | [0m[35m                        "_account_id",  # Came from mid-tier code path.[0m
[30;1m287 | [0m[35m                            # Emperically, it is the oid in AAD or cid in MSA.[0m
[30;1m288 | [0m[35m                        id_token_claims.get("oid", id_token_claims.get("sub"))),[0m
[30;1m289 | [0m[35m                    "username": _get_username(id_token_claims)[0m
[30;1m290 | [0m[35m                        or data.get("username")  # Falls back to ROPC username[0m
[30;1m291 | [0m[35m                        or event.get("username")  # Falls back to Federated ROPC username[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m                    "local_account_id": event.get([0m
[30;1m286 | [0m[35m                        "_account_id",  # Came from mid-tier code path.[0m
[30;1m287 | [0m[35m                            # Emperically, it is the oid in AAD or cid in MSA.[0m
[30;1m288 | [0m[35m                        id_token_claims.get("oid", id_token_claims.get("sub"))),[0m
[30;1m289 | [0m[35m                    "username": _get_username(id_token_claims)[0m
[30;1m290 | [0m[35m                        or data.get("username")  # Falls back to ROPC username[0m
[30;1m291 | [0m[35m                        or event.get("username")  # Falls back to Federated ROPC username[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m                    "home_account_id": home_account_id,[0m
[30;1m283 | [0m[35m                    "environment": environment,[0m
[30;1m284 | [0m[35m                    "realm": realm,[0m
[30;1m285 | [0m[35m                    "local_account_id": event.get([0m
[30;1m286 | [0m[35m                        "_account_id",  # Came from mid-tier code path.[0m
[30;1m287 | [0m[35m                            # Emperically, it is the oid in AAD or cid in MSA.[0m
[30;1m288 | [0m[35m                        id_token_claims.get("oid", id_token_claims.get("sub"))),[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m                    at["refresh_on"] = str(now + refresh_in)  # Schema wants a string[0m
[30;1m278 | [0m[35m                self.modify(self.CredentialType.ACCESS_TOKEN, at, at)[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m            if client_info and not event.get("skip_account_creation"):[0m
[30;1m281 | [0m[35m                account = {[0m
[30;1m282 | [0m[35m                    "home_account_id": home_account_id,[0m
[30;1m283 | [0m[35m                    "environment": environment,[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m                    "client_id": event.get("client_id"),[0m
[30;1m263 | [0m[35m                    "target": target,[0m
[30;1m264 | [0m[35m                    "realm": realm,[0m
[30;1m265 | [0m[35m                    "token_type": response.get("token_type", "Bearer"),[0m
[30;1m266 | [0m[35m                    "cached_at": str(now),  # Schema defines it as a string[0m
[30;1m267 | [0m[35m                    "expires_on": str(now + expires_in),  # Same here[0m
[30;1m268 | [0m[35m                    "extended_expires_on": str(now + ext_expires_in)  # Same here[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m                    "secret": access_token,[0m
[30;1m260 | [0m[35m                    "home_account_id": home_account_id,[0m
[30;1m261 | [0m[35m                    "environment": environment,[0m
[30;1m262 | [0m[35m                    "client_id": event.get("client_id"),[0m
[30;1m263 | [0m[35m                    "target": target,[0m
[30;1m264 | [0m[35m                    "realm": realm,[0m
[30;1m265 | [0m[35m                    "token_type": response.get("token_type", "Bearer"),[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m                expires_in = int(  # AADv1-like endpoint returns a string[0m
[30;1m254 | [0m[35m                    response.get("expires_in", default_expires_in))[0m
[30;1m255 | [0m[35m                ext_expires_in = int(  # AADv1-like endpoint returns a string[0m
[30;1m256 | [0m[35m			response.get("ext_expires_in", expires_in))[0m
[30;1m257 | [0m[35m                at = {[0m
[30;1m258 | [0m[35m                    "credential_type": self.CredentialType.ACCESS_TOKEN,[0m
[30;1m259 | [0m[35m                    "secret": access_token,[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m                    int(response.get("expires_on")) - now  # Some Managed Identity emits this[0m
[30;1m252 | [0m[35m                    ) if response.get("expires_on") else 600[0m
[30;1m253 | [0m[35m                expires_in = int(  # AADv1-like endpoint returns a string[0m
[30;1m254 | [0m[35m                    response.get("expires_in", default_expires_in))[0m
[30;1m255 | [0m[35m                ext_expires_in = int(  # AADv1-like endpoint returns a string[0m
[30;1m256 | [0m[35m			response.get("ext_expires_in", expires_in))[0m
[30;1m257 | [0m[35m                at = {[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m            if access_token:[0m
[30;1m250 | [0m[35m                default_expires_in = (  # https://www.rfc-editor.org/rfc/rfc6749#section-5.1[0m
[30;1m251 | [0m[35m                    int(response.get("expires_on")) - now  # Some Managed Identity emits this[0m
[30;1m252 | [0m[35m                    ) if response.get("expires_on") else 600[0m
[30;1m253 | [0m[35m                expires_in = int(  # AADv1-like endpoint returns a string[0m
[30;1m254 | [0m[35m                    response.get("expires_in", default_expires_in))[0m
[30;1m255 | [0m[35m                ext_expires_in = int(  # AADv1-like endpoint returns a string[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m            if access_token:[0m
[30;1m250 | [0m[35m                default_expires_in = (  # https://www.rfc-editor.org/rfc/rfc6749#section-5.1[0m
[30;1m251 | [0m[35m                    int(response.get("expires_on")) - now  # Some Managed Identity emits this[0m
[30;1m252 | [0m[35m                    ) if response.get("expires_on") else 600[0m
[30;1m253 | [0m[35m                expires_in = int(  # AADv1-like endpoint returns a string[0m
[30;1m254 | [0m[35m                    response.get("expires_in", default_expires_in))[0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m            decode_id_token(id_token, client_id=event["client_id"]) if id_token else {})[0m
[30;1m242 | [0m[35m        client_info, home_account_id = self.__parse_account(response, id_token_claims)[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m        target = ' '.join(sorted(event.get("scope") or []))  # Schema should have required sorting[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        with self._lock:[0m
[30;1m247 | [0m[35m            now = int(time.time() if now is None else now)[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        access_token = response.get("access_token")[0m
[30;1m237 | [0m[35m        refresh_token = response.get("refresh_token")[0m
[30;1m238 | [0m[35m        id_token = response.get("id_token")[0m
[30;1m239 | [0m[35m        id_token_claims = response.get("id_token_claims") or (  # Prefer the claims from broker[0m
[30;1m240 | [0m[35m            # Only use decode_id_token() when necessary, it contains time-sensitive validation[0m
[30;1m241 | [0m[35m            decode_id_token(id_token, client_id=event["client_id"]) if id_token else {})[0m
[30;1m242 | [0m[35m        client_info, home_account_id = self.__parse_account(response, id_token_claims)[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m        data = event.get("data", {})[0m
[30;1m236 | [0m[35m        access_token = response.get("access_token")[0m
[30;1m237 | [0m[35m        refresh_token = response.get("refresh_token")[0m
[30;1m238 | [0m[35m        id_token = response.get("id_token")[0m
[30;1m239 | [0m[35m        id_token_claims = response.get("id_token_claims") or (  # Prefer the claims from broker[0m
[30;1m240 | [0m[35m            # Only use decode_id_token() when necessary, it contains time-sensitive validation[0m
[30;1m241 | [0m[35m            decode_id_token(id_token, client_id=event["client_id"]) if id_token else {})[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m        response = event.get("response", {})[0m
[30;1m235 | [0m[35m        data = event.get("data", {})[0m
[30;1m236 | [0m[35m        access_token = response.get("access_token")[0m
[30;1m237 | [0m[35m        refresh_token = response.get("refresh_token")[0m
[30;1m238 | [0m[35m        id_token = response.get("id_token")[0m
[30;1m239 | [0m[35m        id_token_claims = response.get("id_token_claims") or (  # Prefer the claims from broker[0m
[30;1m240 | [0m[35m            # Only use decode_id_token() when necessary, it contains time-sensitive validation[0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m            environment = event["environment"]  # Set by application.py[0m
[30;1m234 | [0m[35m        response = event.get("response", {})[0m
[30;1m235 | [0m[35m        data = event.get("data", {})[0m
[30;1m236 | [0m[35m        access_token = response.get("access_token")[0m
[30;1m237 | [0m[35m        refresh_token = response.get("refresh_token")[0m
[30;1m238 | [0m[35m        id_token = response.get("id_token")[0m
[30;1m239 | [0m[35m        id_token_claims = response.get("id_token_claims") or (  # Prefer the claims from broker[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m        if "environment" in event:  # Always available unless in legacy test cases[0m
[30;1m233 | [0m[35m            environment = event["environment"]  # Set by application.py[0m
[30;1m234 | [0m[35m        response = event.get("response", {})[0m
[30;1m235 | [0m[35m        data = event.get("data", {})[0m
[30;1m236 | [0m[35m        access_token = response.get("access_token")[0m
[30;1m237 | [0m[35m        refresh_token = response.get("refresh_token")[0m
[30;1m238 | [0m[35m        id_token = response.get("id_token")[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m            _, environment, realm = canonicalize(event["token_endpoint"])[0m
[30;1m232 | [0m[35m        if "environment" in event:  # Always available unless in legacy test cases[0m
[30;1m233 | [0m[35m            environment = event["environment"]  # Set by application.py[0m
[30;1m234 | [0m[35m        response = event.get("response", {})[0m
[30;1m235 | [0m[35m        data = event.get("data", {})[0m
[30;1m236 | [0m[35m        access_token = response.get("access_token")[0m
[30;1m237 | [0m[35m        refresh_token = response.get("refresh_token")[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m            data=make_clean_copy(event.get("data", {}), ([0m
[30;1m197 | [0m[35m                "password", "client_secret", "refresh_token", "assertion",[0m
[30;1m198 | [0m[35m            )),[0m
[30;1m199 | [0m[35m            response=make_clean_copy(event.get("response", {}), ([0m
[30;1m200 | [0m[35m                "id_token_claims",  # Provided by broker[0m
[30;1m201 | [0m[35m                "access_token", "refresh_token", "id_token", "username",[0m
[30;1m202 | [0m[35m            )),[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m            }[0m
[30;1m194 | [0m[35m        clean_event = dict([0m
[30;1m195 | [0m[35m            event,[0m
[30;1m196 | [0m[35m            data=make_clean_copy(event.get("data", {}), ([0m
[30;1m197 | [0m[35m                "password", "client_secret", "refresh_token", "assertion",[0m
[30;1m198 | [0m[35m            )),[0m
[30;1m199 | [0m[35m            response=make_clean_copy(event.get("response", {}), ([0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m                # stale ATs keyed by an old key_id would stay forever.[0m
[30;1m164 | [0m[35m                # Here we collect them for their removal.[0m
[30;1m165 | [0m[35m            ][0m
[30;1m166 | [0m[35m            for entry in self._cache.get(credential_type, {}).values():[0m
[30;1m167 | [0m[35m                if (  # Automatically delete expired access tokens[0m
[30;1m168 | [0m[35m                    credential_type == self.CredentialType.ACCESS_TOKEN[0m
[30;1m169 | [0m[35m                    and int(entry["expires_on"]) < now[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m    @staticmethod[0m
[30;1m128 | [0m[35m    def _is_matching(entry: dict, query: dict, target_set: set = None) -> bool:[0m
[30;1m129 | [0m[35m        return is_subdict_of(query or {}, entry) and ([0m
[30;1m130 | [0m[35m            target_set <= set(entry.get("target", "").split())[0m
[30;1m131 | [0m[35m            if target_set else True)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    def search(self, credential_type, target=None, query=None, *, now=None):  # O(n) generator[0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def _get(self, credential_type, key, default=None):  # O(1)[0m
[30;1m124 | [0m[35m        with self._lock:[0m
[30;1m125 | [0m[35m            return self._cache.get(credential_type, {}).get(key, default)[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    @staticmethod[0m
[30;1m128 | [0m[35m    def _is_matching(entry: dict, query: dict, target_set: set = None) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def _get(self, credential_type, key, default=None):  # O(1)[0m
[30;1m124 | [0m[35m        with self._lock:[0m
[30;1m125 | [0m[35m            return self._cache.get(credential_type, {}).get(key, default)[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    @staticmethod[0m
[30;1m128 | [0m[35m    def _is_matching(entry: dict, query: dict, target_set: set = None) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35mdef _get_username(id_token_claims):[0m
[30;1m19 | [0m[35m    return id_token_claims.get([0m
[30;1m20 | [0m[35m        "preferred_username",  # AAD[0m
[30;1m21 | [0m[35m        id_token_claims.get("upn"))  # ADFS 2019[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mclass TokenCache(object):[0m
[30;1m24 | [0m[35m    """This is considered as a base class containing minimal cache behavior.[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m    return dict(big, **small) == big[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mdef _get_username(id_token_claims):[0m
[30;1m19 | [0m[35m    return id_token_claims.get([0m
[30;1m20 | [0m[35m        "preferred_username",  # AAD[0m
[30;1m21 | [0m[35m        id_token_claims.get("upn"))  # ADFS 2019[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m347 | [0m[35m        # You can monkeypatch self.key_makers to support more types on-the-fly.[0m
[30;1m348 | [0m[35m        key = self.key_makers[credential_type](**old_entry)[0m
[30;1m349 | [0m[35m        with self._lock:[0m
[30;1m350 | [0m[35m            if new_key_value_pairs:  # Update with them[0m
[30;1m351 | [0m[35m                entries = self._cache.setdefault(credential_type, {})[0m
[30;1m352 | [0m[35m                entries[key] = dict([0m
[30;1m353 | [0m[35m                    old_entry,  # Do not use entries[key] b/c it might not exist[0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m254 | [0m[35m                    response.get("expires_in", default_expires_in))[0m
[30;1m255 | [0m[35m                ext_expires_in = int(  # AADv1-like endpoint returns a string[0m
[30;1m256 | [0m[35m			response.get("ext_expires_in", expires_in))[0m
[30;1m257 | [0m[35m                at = {[0m
[30;1m258 | [0m[35m                    "credential_type": self.CredentialType.ACCESS_TOKEN,[0m
[30;1m259 | [0m[35m                    "secret": access_token,[0m
[30;1m260 | [0m[35m                    "home_account_id": home_account_id,[0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m174 | [0m[35m                    and self._is_matching(entry, query, target_set=target_set)[0m
[30;1m175 | [0m[35m                ):[0m
[30;1m176 | [0m[35m                    yield entry[0m
[30;1m177 | [0m[35m            for at in expired_access_tokens:[0m
[30;1m178 | [0m[35m                self.remove_at(at)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m    def find(self, credential_type, target=None, query=None, *, now=None):[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m            and isinstance(query, dict)[0m
[30;1m145 | [0m[35m            and "home_account_id" in query and "environment" in query[0m
[30;1m146 | [0m[35m            and "client_id" in query and "realm" in query and target[0m
[30;1m147 | [0m[35m        ):  # Special case for O(1) AT lookup[0m
[30;1m148 | [0m[35m            preferred_result = self._get_access_token([0m
[30;1m149 | [0m[35m                query["home_account_id"], query["environment"],[0m
[30;1m150 | [0m[35m                query["client_id"], query["realm"], target)[0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m133 | [0m[35m    def search(self, credential_type, target=None, query=None, *, now=None):  # O(n) generator[0m
[30;1m134 | [0m[35m        """Returns a generator of matching entries.[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        It is O(1) for AT hits, and O(n) for other types.[0m
[30;1m137 | [0m[35m        Note that it holds a lock during the entire search.[0m
[30;1m138 | [0m[35m        """[0m
[30;1m139 | [0m[35m        target = sorted(target or [])  # Match the order sorted by add()[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m389 | [0m[35m        import os, atexit, msal[0m
[30;1m390 | [0m[35m        cache_filename = os.path.join(  # Persist cache into this file[0m
[30;1m391 | [0m[35m            os.getenv([0m
[30;1m392 | [0m[35m                # Automatically wipe out the cache from Linux when user's ssh session ends.[0m
[30;1m393 | [0m[35m                # See also https://github.com/AzureAD/microsoft-authentication-library-for-python/is[0m
[30;1m394 | [0m[35m                "XDG_RUNTIME_DIR", ""),[0m
[30;1m395 | [0m[35m            "my_cache.bin")[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/token_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport threading[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport warnings[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom .authority import canonicalize[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_assertion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m        assertion = JwtAssertionCreator(key=None, algorithm="none").sign_assertion([0m
[30;1m12 | [0m[35m            "audience", "issuer", additional_claims={"client_ip": "1.2.3.4"})[0m
[30;1m13 | [0m[35m        payload = json.loads(decode_part(assertion.split(b'.')[1].decode('utf-8')))[0m
[30;1m14 | [0m[35m        self.assertEqual("1.2.3.4", payload.get("client_ip"))[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m882[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m            "client_id",[0m
[30;1m284 | [0m[35m            http_client=MinimalHttpClient(),[0m
[30;1m285 | [0m[35m            on_obtaining_tokens=lambda event:[0m
[30;1m286 | [0m[35m                self.assertEqual("new", event["response"].get("refresh_token")),[0m
[30;1m287 | [0m[35m            on_updating_rt=lambda rt_item, new_rt:[0m
[30;1m288 | [0m[35m                self.fail("This should not be called here"),[0m
[30;1m289 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m883[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m            "client_id",[0m
[30;1m257 | [0m[35m            http_client=MinimalHttpClient(),[0m
[30;1m258 | [0m[35m            on_obtaining_tokens=lambda event:[0m
[30;1m259 | [0m[35m                self.assertEqual("new", event["response"].get("refresh_token")),[0m
[30;1m260 | [0m[35m            on_updating_rt=lambda rt_item, new_rt:[0m
[30;1m261 | [0m[35m                self.fail("This should not be called here"),[0m
[30;1m262 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m884[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m        CONFIG.get("openid_configuration", {}).get("device_authorization_endpoint"),[0m
[30;1m228 | [0m[35m        "device_authorization_endpoint is missing")[0m
[30;1m229 | [0m[35m    def test_device_flow(self):[0m
[30;1m230 | [0m[35m        flow = self.client.initiate_device_flow(scope=CONFIG.get("scope"))[0m
[30;1m231 | [0m[35m        try:[0m
[30;1m232 | [0m[35m            msg = ("Use a web browser to open the page {verification_uri} and "[0m
[30;1m233 | [0m[35m                "enter the code {user_code} to authenticate.".format(**flow))[0m

[31m--[ [0m[34mMatch #[0m[33m885[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m        self.assertLoosely(result, lambda: self.assertIn('access_token', result))[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    @unittest.skipUnless([0m
[30;1m227 | [0m[35m        CONFIG.get("openid_configuration", {}).get("device_authorization_endpoint"),[0m
[30;1m228 | [0m[35m        "device_authorization_endpoint is missing")[0m
[30;1m229 | [0m[35m    def test_device_flow(self):[0m
[30;1m230 | [0m[35m        flow = self.client.initiate_device_flow(scope=CONFIG.get("scope"))[0m

[31m--[ [0m[34mMatch #[0m[33m886[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m        self.assertLoosely(result, lambda: self.assertIn('access_token', result))[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    @unittest.skipUnless([0m
[30;1m227 | [0m[35m        CONFIG.get("openid_configuration", {}).get("device_authorization_endpoint"),[0m
[30;1m228 | [0m[35m        "device_authorization_endpoint is missing")[0m
[30;1m229 | [0m[35m    def test_device_flow(self):[0m
[30;1m230 | [0m[35m        flow = self.client.initiate_device_flow(scope=CONFIG.get("scope"))[0m

[31m--[ [0m[34mMatch #[0m[33m887[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m                    a=CONFIG["openid_configuration"]["authorization_endpoint"],[0m
[30;1m219 | [0m[35m                    i=CONFIG.get("client_id")),[0m
[30;1m220 | [0m[35m            success_template="<strong>Done. You can close this window now.</strong>",[0m
[30;1m221 | [0m[35m            login_hint=CONFIG.get("username"),  # To skip the account selector[0m
[30;1m222 | [0m[35m            timeout=60,[0m
[30;1m223 | [0m[35m            )[0m
[30;1m224 | [0m[35m        self.assertLoosely(result, lambda: self.assertIn('access_token', result))[0m

[31m--[ [0m[34mMatch #[0m[33m888[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m                <a href="$auth_uri">Sign In</a> or <a href="$abort_uri">Abort</a>[0m
[30;1m217 | [0m[35m                </body></html>""".format([0m
[30;1m218 | [0m[35m                    a=CONFIG["openid_configuration"]["authorization_endpoint"],[0m
[30;1m219 | [0m[35m                    i=CONFIG.get("client_id")),[0m
[30;1m220 | [0m[35m            success_template="<strong>Done. You can close this window now.</strong>",[0m
[30;1m221 | [0m[35m            login_hint=CONFIG.get("username"),  # To skip the account selector[0m
[30;1m222 | [0m[35m            timeout=60,[0m

[31m--[ [0m[34mMatch #[0m[33m889[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m    def test_obtain_token_by_browser(self):[0m
[30;1m211 | [0m[35m        result = self.client.obtain_token_by_browser([0m
[30;1m212 | [0m[35m            scope=CONFIG.get("scope"),[0m
[30;1m213 | [0m[35m            redirect_uri=CONFIG.get("redirect_uri"),[0m
[30;1m214 | [0m[35m            welcome_template="""<html><body>[0m
[30;1m215 | [0m[35m                authorization_endpoint = {a}, client_id = {i}[0m
[30;1m216 | [0m[35m                <a href="$auth_uri">Sign In</a> or <a href="$abort_uri">Abort</a>[0m

[31m--[ [0m[34mMatch #[0m[33m890[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        "authorization_endpoint missing")[0m
[30;1m210 | [0m[35m    def test_obtain_token_by_browser(self):[0m
[30;1m211 | [0m[35m        result = self.client.obtain_token_by_browser([0m
[30;1m212 | [0m[35m            scope=CONFIG.get("scope"),[0m
[30;1m213 | [0m[35m            redirect_uri=CONFIG.get("redirect_uri"),[0m
[30;1m214 | [0m[35m            welcome_template="""<html><body>[0m
[30;1m215 | [0m[35m                authorization_endpoint = {a}, client_id = {i}[0m

[31m--[ [0m[34mMatch #[0m[33m891[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m            "We should not leak malicious input into our output")[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    @unittest.skipUnless([0m
[30;1m208 | [0m[35m        "authorization_endpoint" in CONFIG.get("openid_configuration", {}),[0m
[30;1m209 | [0m[35m        "authorization_endpoint missing")[0m
[30;1m210 | [0m[35m    def test_obtain_token_by_browser(self):[0m
[30;1m211 | [0m[35m        result = self.client.obtain_token_by_browser([0m

[31m--[ [0m[34mMatch #[0m[33m892[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m                auth_response.get("code"), "Error: {}, Detail: {}".format([0m
[30;1m187 | [0m[35m                    auth_response.get("error"), auth_response))[0m
[30;1m188 | [0m[35m            result = self.client.obtain_token_by_auth_code_flow(flow, auth_response)[0m
[30;1m189 | [0m[35m                #TBD: data={"resource": CONFIG.get("resource")},  # MSFT AAD v1 only[0m
[30;1m190 | [0m[35m            self.assertLoosely(result, lambda: self.assertIn('access_token', result))[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    def test_auth_code_flow_error_response(self):[0m

[31m--[ [0m[34mMatch #[0m[33m893[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m                )[0m
[30;1m185 | [0m[35m            self.assertIsNotNone([0m
[30;1m186 | [0m[35m                auth_response.get("code"), "Error: {}, Detail: {}".format([0m
[30;1m187 | [0m[35m                    auth_response.get("error"), auth_response))[0m
[30;1m188 | [0m[35m            result = self.client.obtain_token_by_auth_code_flow(flow, auth_response)[0m
[30;1m189 | [0m[35m                #TBD: data={"resource": CONFIG.get("resource")},  # MSFT AAD v1 only[0m
[30;1m190 | [0m[35m            self.assertLoosely(result, lambda: self.assertIn('access_token', result))[0m

[31m--[ [0m[34mMatch #[0m[33m894[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m                        i=CONFIG.get("client_id")),[0m
[30;1m184 | [0m[35m                )[0m
[30;1m185 | [0m[35m            self.assertIsNotNone([0m
[30;1m186 | [0m[35m                auth_response.get("code"), "Error: {}, Detail: {}".format([0m
[30;1m187 | [0m[35m                    auth_response.get("error"), auth_response))[0m
[30;1m188 | [0m[35m            result = self.client.obtain_token_by_auth_code_flow(flow, auth_response)[0m
[30;1m189 | [0m[35m                #TBD: data={"resource": CONFIG.get("resource")},  # MSFT AAD v1 only[0m

[31m--[ [0m[34mMatch #[0m[33m895[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m                    <a href="$auth_uri">Sign In</a> or <a href="$abort_uri">Abort</a>[0m
[30;1m181 | [0m[35m                    </body></html>""".format([0m
[30;1m182 | [0m[35m                        a=CONFIG["openid_configuration"]["authorization_endpoint"],[0m
[30;1m183 | [0m[35m                        i=CONFIG.get("client_id")),[0m
[30;1m184 | [0m[35m                )[0m
[30;1m185 | [0m[35m            self.assertIsNotNone([0m
[30;1m186 | [0m[35m                auth_response.get("code"), "Error: {}, Detail: {}".format([0m

[31m--[ [0m[34mMatch #[0m[33m896[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m            flow = self.client.initiate_auth_code_flow([0m
[30;1m170 | [0m[35m                redirect_uri="http://localhost:%d" % receiver.get_port(),[0m
[30;1m171 | [0m[35m                scope=CONFIG.get("scope"),[0m
[30;1m172 | [0m[35m                login_hint=CONFIG.get("username"),  # To skip the account selector[0m
[30;1m173 | [0m[35m                )[0m
[30;1m174 | [0m[35m            auth_response = receiver.get_auth_response([0m
[30;1m175 | [0m[35m                auth_uri=flow["auth_uri"],[0m

[31m--[ [0m[34mMatch #[0m[33m897[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m        with AuthCodeReceiver(port=CONFIG.get("listen_port")) as receiver:[0m
[30;1m169 | [0m[35m            flow = self.client.initiate_auth_code_flow([0m
[30;1m170 | [0m[35m                redirect_uri="http://localhost:%d" % receiver.get_port(),[0m
[30;1m171 | [0m[35m                scope=CONFIG.get("scope"),[0m
[30;1m172 | [0m[35m                login_hint=CONFIG.get("username"),  # To skip the account selector[0m
[30;1m173 | [0m[35m                )[0m
[30;1m174 | [0m[35m            auth_response = receiver.get_auth_response([0m

[31m--[ [0m[34mMatch #[0m[33m898[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m        "authorization_endpoint" in CONFIG.get("openid_configuration", {}),[0m
[30;1m166 | [0m[35m        "authorization_endpoint missing")[0m
[30;1m167 | [0m[35m    def test_auth_code_flow(self):[0m
[30;1m168 | [0m[35m        with AuthCodeReceiver(port=CONFIG.get("listen_port")) as receiver:[0m
[30;1m169 | [0m[35m            flow = self.client.initiate_auth_code_flow([0m
[30;1m170 | [0m[35m                redirect_uri="http://localhost:%d" % receiver.get_port(),[0m
[30;1m171 | [0m[35m                scope=CONFIG.get("scope"),[0m

[31m--[ [0m[34mMatch #[0m[33m899[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m        self.assertLoosely(result, lambda: self.assertIn('access_token', result))[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    @unittest.skipUnless([0m
[30;1m165 | [0m[35m        "authorization_endpoint" in CONFIG.get("openid_configuration", {}),[0m
[30;1m166 | [0m[35m        "authorization_endpoint missing")[0m
[30;1m167 | [0m[35m    def test_auth_code_flow(self):[0m
[30;1m168 | [0m[35m        with AuthCodeReceiver(port=CONFIG.get("listen_port")) as receiver:[0m

[31m--[ [0m[34mMatch #[0m[33m900[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m            ac,[0m
[30;1m156 | [0m[35m            data={[0m
[30;1m157 | [0m[35m                "scope": CONFIG.get("scope"),[0m
[30;1m158 | [0m[35m                "resource": CONFIG.get("resource"),[0m
[30;1m159 | [0m[35m                },  # MSFT AAD only[0m
[30;1m160 | [0m[35m            nonce=nonce,[0m
[30;1m161 | [0m[35m            redirect_uri=redirect_uri)[0m

[31m--[ [0m[34mMatch #[0m[33m901[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m        result = self.client.obtain_token_by_authorization_code([0m
[30;1m155 | [0m[35m            ac,[0m
[30;1m156 | [0m[35m            data={[0m
[30;1m157 | [0m[35m                "scope": CONFIG.get("scope"),[0m
[30;1m158 | [0m[35m                "resource": CONFIG.get("resource"),[0m
[30;1m159 | [0m[35m                },  # MSFT AAD only[0m
[30;1m160 | [0m[35m            nonce=nonce,[0m

[31m--[ [0m[34mMatch #[0m[33m902[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        auth_request_uri = self.client.build_auth_request_uri([0m
[30;1m149 | [0m[35m            "code",[0m
[30;1m150 | [0m[35m            nonce=nonce,[0m
[30;1m151 | [0m[35m            redirect_uri=redirect_uri, scope=CONFIG.get("scope"))[0m
[30;1m152 | [0m[35m        ac = obtain_auth_code(port, auth_uri=auth_request_uri)[0m
[30;1m153 | [0m[35m        self.assertNotEqual(ac, None)[0m
[30;1m154 | [0m[35m        result = self.client.obtain_token_by_authorization_code([0m

[31m--[ [0m[34mMatch #[0m[33m903[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m        "authorization_endpoint" in CONFIG.get("openid_configuration", {}),[0m
[30;1m143 | [0m[35m        "authorization_endpoint missing")[0m
[30;1m144 | [0m[35m    def test_auth_code(self):[0m
[30;1m145 | [0m[35m        port = CONFIG.get("listen_port", 44331)[0m
[30;1m146 | [0m[35m        redirect_uri = "http://localhost:%s" % port[0m
[30;1m147 | [0m[35m        nonce = "nonce should contain sufficient entropy"[0m
[30;1m148 | [0m[35m        auth_request_uri = self.client.build_auth_request_uri([0m

[31m--[ [0m[34mMatch #[0m[33m904[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m        self.assertLoosely(result)[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m    @unittest.skipUnless([0m
[30;1m142 | [0m[35m        "authorization_endpoint" in CONFIG.get("openid_configuration", {}),[0m
[30;1m143 | [0m[35m        "authorization_endpoint missing")[0m
[30;1m144 | [0m[35m    def test_auth_code(self):[0m
[30;1m145 | [0m[35m        port = CONFIG.get("listen_port", 44331)[0m

[31m--[ [0m[34mMatch #[0m[33m905[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m        result = self.client.obtain_token_by_username_password([0m
[30;1m136 | [0m[35m            CONFIG["username"], CONFIG["password"],[0m
[30;1m137 | [0m[35m            data={"resource": CONFIG.get("resource")},  # MSFT AAD V1 only[0m
[30;1m138 | [0m[35m            scope=CONFIG.get("scope"))[0m
[30;1m139 | [0m[35m        self.assertLoosely(result)[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m    @unittest.skipUnless([0m

[31m--[ [0m[34mMatch #[0m[33m906[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m    def test_username_password(self):[0m
[30;1m135 | [0m[35m        result = self.client.obtain_token_by_username_password([0m
[30;1m136 | [0m[35m            CONFIG["username"], CONFIG["password"],[0m
[30;1m137 | [0m[35m            data={"resource": CONFIG.get("resource")},  # MSFT AAD V1 only[0m
[30;1m138 | [0m[35m            scope=CONFIG.get("scope"))[0m
[30;1m139 | [0m[35m        self.assertLoosely(result)[0m
[30;1m140 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m907[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m        self.assertIn('access_token', result)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    @unittest.skipIf([0m
[30;1m129 | [0m[35m        "token_endpoint" not in CONFIG.get("openid_configuration", {}),[0m
[30;1m130 | [0m[35m        "token_endpoint missing")[0m
[30;1m131 | [0m[35m    @unittest.skipIf([0m
[30;1m132 | [0m[35m        not ("username" in CONFIG and "password" in CONFIG),[0m

[31m--[ [0m[34mMatch #[0m[33m908[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m        "token_endpoint missing")[0m
[30;1m123 | [0m[35m    @unittest.skipIf("client_secret" not in CONFIG, "client_secret missing")[0m
[30;1m124 | [0m[35m    def test_client_credentials(self):[0m
[30;1m125 | [0m[35m        result = self.client.obtain_token_for_client(CONFIG.get('scope'))[0m
[30;1m126 | [0m[35m        self.assertIn('access_token', result)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    @unittest.skipIf([0m

[31m--[ [0m[34mMatch #[0m[33m909[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m                client_secret=CONFIG.get('client_secret'))[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    @unittest.skipIf([0m
[30;1m121 | [0m[35m        "token_endpoint" not in CONFIG.get("openid_configuration", {}),[0m
[30;1m122 | [0m[35m        "token_endpoint missing")[0m
[30;1m123 | [0m[35m    @unittest.skipIf("client_secret" not in CONFIG, "client_secret missing")[0m
[30;1m124 | [0m[35m    def test_client_credentials(self):[0m

[31m--[ [0m[34mMatch #[0m[33m910[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m            cls.client = Client([0m
[30;1m116 | [0m[35m                CONFIG["openid_configuration"], CONFIG['client_id'],[0m
[30;1m117 | [0m[35m                http_client=http_client,[0m
[30;1m118 | [0m[35m                client_secret=CONFIG.get('client_secret'))[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    @unittest.skipIf([0m
[30;1m121 | [0m[35m        "token_endpoint" not in CONFIG.get("openid_configuration", {}),[0m

[31m--[ [0m[34mMatch #[0m[33m911[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m# Since the OAuth2 specs uses snake_case, this test config also uses snake_case[0m
[30;1m81 | [0m[35m@unittest.skipUnless("client_id" in CONFIG, "client_id missing")[0m
[30;1m82 | [0m[35m@unittest.skipUnless(CONFIG.get("openid_configuration"), "openid_configuration missing")[0m
[30;1m83 | [0m[35mclass TestClient(Oauth2TestCase):[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m912[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m        # The following urljoin(..., ...) trick allows a "path_name" shorthand[0m
[30;1m70 | [0m[35m        openid_configuration["device_authorization_endpoint"] = urljoin([0m
[30;1m71 | [0m[35m            openid_configuration.get("token_endpoint", ""),[0m
[30;1m72 | [0m[35m            openid_configuration.get("device_authorization_endpoint", ""))[0m
[30;1m73 | [0m[35m    conf["openid_configuration"] = openid_configuration[0m
[30;1m74 | [0m[35m    return conf[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m913[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m    if openid_configuration.get("device_authorization_endpoint"):[0m
[30;1m69 | [0m[35m        # The following urljoin(..., ...) trick allows a "path_name" shorthand[0m
[30;1m70 | [0m[35m        openid_configuration["device_authorization_endpoint"] = urljoin([0m
[30;1m71 | [0m[35m            openid_configuration.get("token_endpoint", ""),[0m
[30;1m72 | [0m[35m            openid_configuration.get("device_authorization_endpoint", ""))[0m
[30;1m73 | [0m[35m    conf["openid_configuration"] = openid_configuration[0m
[30;1m74 | [0m[35m    return conf[0m

[31m--[ [0m[34mMatch #[0m[33m914[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m            logger.warning([0m
[30;1m66 | [0m[35m                "openid configuration uri not accesible: %s", discovery_uri)[0m
[30;1m67 | [0m[35m    openid_configuration.update(conf.get("additional_openid_configuration", {}))[0m
[30;1m68 | [0m[35m    if openid_configuration.get("device_authorization_endpoint"):[0m
[30;1m69 | [0m[35m        # The following urljoin(..., ...) trick allows a "path_name" shorthand[0m
[30;1m70 | [0m[35m        openid_configuration["device_authorization_endpoint"] = urljoin([0m
[30;1m71 | [0m[35m            openid_configuration.get("token_endpoint", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m915[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        except:[0m
[30;1m65 | [0m[35m            logger.warning([0m
[30;1m66 | [0m[35m                "openid configuration uri not accesible: %s", discovery_uri)[0m
[30;1m67 | [0m[35m    openid_configuration.update(conf.get("additional_openid_configuration", {}))[0m
[30;1m68 | [0m[35m    if openid_configuration.get("device_authorization_endpoint"):[0m
[30;1m69 | [0m[35m        # The following urljoin(..., ...) trick allows a "path_name" shorthand[0m
[30;1m70 | [0m[35m        openid_configuration["device_authorization_endpoint"] = urljoin([0m

[31m--[ [0m[34mMatch #[0m[33m916[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m            # but requests.get(...) would still work.[0m
[30;1m61 | [0m[35m            # Besides, standard urljoin(...) is picky on insisting oidp ends with '/'[0m
[30;1m62 | [0m[35m            discovery_uri = conf["oidp"] + '/.well-known/openid-configuration'[0m
[30;1m63 | [0m[35m            openid_configuration.update(requests.get(discovery_uri).json())[0m
[30;1m64 | [0m[35m        except:[0m
[30;1m65 | [0m[35m            logger.warning([0m
[30;1m66 | [0m[35m                "openid configuration uri not accesible: %s", discovery_uri)[0m

[31m--[ [0m[34mMatch #[0m[33m917[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m    if "oidp" in conf:[0m
[30;1m58 | [0m[35m        try:[0m
[30;1m59 | [0m[35m            # The following line may duplicate a '/' at the joining point,[0m
[30;1m60 | [0m[35m            # but requests.get(...) would still work.[0m
[30;1m61 | [0m[35m            # Besides, standard urljoin(...) is picky on insisting oidp ends with '/'[0m
[30;1m62 | [0m[35m            discovery_uri = conf["oidp"] + '/.well-known/openid-configuration'[0m
[30;1m63 | [0m[35m            openid_configuration.update(requests.get(discovery_uri).json())[0m

[31m--[ [0m[34mMatch #[0m[33m918[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35m    openid_configuration = {}[0m
[30;1m57 | [0m[35m    if "oidp" in conf:[0m
[30;1m58 | [0m[35m        try:[0m
[30;1m59 | [0m[35m            # The following line may duplicate a '/' at the joining point,[0m
[30;1m60 | [0m[35m            # but requests.get(...) would still work.[0m
[30;1m61 | [0m[35m            # Besides, standard urljoin(...) is picky on insisting oidp ends with '/'[0m
[30;1m62 | [0m[35m            discovery_uri = conf["oidp"] + '/.well-known/openid-configuration'[0m

[31m--[ [0m[34mMatch #[0m[33m919[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        duration = 30[0m
[30;1m239 | [0m[35m        logger.warning("We will wait up to %d seconds for you to sign in" % duration)[0m
[30;1m240 | [0m[35m        flow["expires_at"] = time.time() + duration  # Shorten the time for quick test[0m
[30;1m241 | [0m[35m        result = self.client.obtain_token_by_device_flow(flow)[0m
[30;1m242 | [0m[35m        self.assertLoosely([0m
[30;1m243 | [0m[35m                result,[0m

[31m--[ [0m[34mMatch #[0m[33m920[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m    from urlparse import urljoin[0m
[30;1m6 | [0m[35mexcept:  # Python 3[0m
[30;1m7 | [0m[35m    from urllib.parse import urljoin[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport requests[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom msal.oauth2cli import Client, JwtSigner, AuthCodeReceiver[0m

[31m--[ [0m[34mMatch #[0m[33m921[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/tests/test_account_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mdef _mock_post(url, headers=None, *args, **kwargs):[0m
[30;1m21 | [0m[35m    return MinimalResponse(status_code=200, text=json.dumps(TOKEN_RESPONSE))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m@unittest.skipUnless(is_pymsalruntime_installed(), "These test cases need pip install msal[broker]")[0m
[30;1m24 | [0m[35m@patch("msal.broker._acquire_token_silently", return_value=dict([0m
[30;1m25 | [0m[35m   TOKEN_RESPONSE, _account_id="placeholder"))[0m
[30;1m26 | [0m[35m@patch.object(msal.authority, "tenant_discovery", return_value={[0m

[31m--[ [0m[34mMatch #[0m[33m922[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m            mapping=self._expiring_mapping,[0m
[30;1m137 | [0m[35m            key_maker=lambda func, args, kwargs: "GET {} hash={} 2xx".format([0m
[30;1m138 | [0m[35m                args[0],  # It is the url, sometimes containing inline params[0m
[30;1m139 | [0m[35m                self._hash(kwargs.get("params", "")),[0m
[30;1m140 | [0m[35m                ),[0m
[30;1m141 | [0m[35m            expires_in=lambda result=None, **ignored:[0m
[30;1m142 | [0m[35m                3600*24 if 200 <= result.status_code < 300 else 0,[0m

[31m--[ [0m[34mMatch #[0m[33m923[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m                    # "407 Proxy auth required" would need a key including http headers.[0m
[30;1m124 | [0m[35m                and not(  # Exclude Device Flow whose retry is expected and regulated[0m
[30;1m125 | [0m[35m                    isinstance(kwargs.get("data"), dict)[0m
[30;1m126 | [0m[35m                    and kwargs["data"].get("grant_type") == DEVICE_AUTH_GRANT[0m
[30;1m127 | [0m[35m                    )[0m
[30;1m128 | [0m[35m                and "retry-after" not in set(  # Leave it to the Retry-After decorator[0m
[30;1m129 | [0m[35m                    h.lower() for h in getattr(result, "headers", {}).keys())[0m

[31m--[ [0m[34mMatch #[0m[33m924[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m                    # Other 4xx errors might have different requirements e.g.[0m
[30;1m123 | [0m[35m                    # "407 Proxy auth required" would need a key including http headers.[0m
[30;1m124 | [0m[35m                and not(  # Exclude Device Flow whose retry is expected and regulated[0m
[30;1m125 | [0m[35m                    isinstance(kwargs.get("data"), dict)[0m
[30;1m126 | [0m[35m                    and kwargs["data"].get("grant_type") == DEVICE_AUTH_GRANT[0m
[30;1m127 | [0m[35m                    )[0m
[30;1m128 | [0m[35m                and "retry-after" not in set(  # Leave it to the Retry-After decorator[0m

[31m--[ [0m[34mMatch #[0m[33m925[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m                    # bypass http cache, because there is no real gain from that.[0m
[30;1m112 | [0m[35m                    # We won't bother implement it, nor do we want to encourage[0m
[30;1m113 | [0m[35m                    # acquire_token_silent(..., force_refresh=True) pattern.[0m
[30;1m114 | [0m[35m                    str(kwargs.get("params")) + str(kwargs.get("data"))),[0m
[30;1m115 | [0m[35m                ),[0m
[30;1m116 | [0m[35m            expires_in=lambda result=None, kwargs=None, **ignored:[0m
[30;1m117 | [0m[35m                60[0m

[31m--[ [0m[34mMatch #[0m[33m926[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m                    # bypass http cache, because there is no real gain from that.[0m
[30;1m112 | [0m[35m                    # We won't bother implement it, nor do we want to encourage[0m
[30;1m113 | [0m[35m                    # acquire_token_silent(..., force_refresh=True) pattern.[0m
[30;1m114 | [0m[35m                    str(kwargs.get("params")) + str(kwargs.get("data"))),[0m
[30;1m115 | [0m[35m                ),[0m
[30;1m116 | [0m[35m            expires_in=lambda result=None, kwargs=None, **ignored:[0m
[30;1m117 | [0m[35m                60[0m

[31m--[ [0m[34mMatch #[0m[33m927[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        return self.http_client.post(*args, **kwargs)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    def get(self, *args, **kwargs):[0m
[30;1m60 | [0m[35m        return self.http_client.get(*args, **kwargs)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    def close(self):[0m
[30;1m63 | [0m[35m        return self.http_client.close()[0m

[31m--[ [0m[34mMatch #[0m[33m928[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m            )[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    def post(self, *args, **kwargs):[0m
[30;1m57 | [0m[35m        return self.http_client.post(*args, **kwargs)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    def get(self, *args, **kwargs):[0m
[30;1m60 | [0m[35m        return self.http_client.get(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m929[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef _extract_data(kwargs, key, default=None):[0m
[30;1m36 | [0m[35m    data = kwargs.get("data", {})  # data is usually a dict, but occasionally a string[0m
[30;1m37 | [0m[35m    return data.get(key) if isinstance(data, dict) else default[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mclass ThrottledHttpClientBase(object):[0m

[31m--[ [0m[34mMatch #[0m[33m930[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef _extract_data(kwargs, key, default=None):[0m
[30;1m36 | [0m[35m    data = kwargs.get("data", {})  # data is usually a dict, but occasionally a string[0m
[30;1m37 | [0m[35m    return data.get(key) if isinstance(data, dict) else default[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m931[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m        if not (response.status_code == 429 or response.status_code >= 500[0m
[30;1m23 | [0m[35m                or "retry-after" in lowercase_headers):[0m
[30;1m24 | [0m[35m            return 0  # Quick exit[0m
[30;1m25 | [0m[35m        retry_after = lowercase_headers.get("retry-after", self._default_value)[0m
[30;1m26 | [0m[35m        try:[0m
[30;1m27 | [0m[35m            # AAD's retry_after uses integer format only[0m
[30;1m28 | [0m[35m            # https://stackoverflow.microsoft.com/questions/264931/264932[0m

[31m--[ [0m[34mMatch #[0m[33m932[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m        _post = http_client.post  # We'll patch _post, and keep original post() intact[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m        _post = IndividualCache([0m
[30;1m77 | [0m[35m            # Internal specs requires throttling on at least token endpoint,[0m
[30;1m78 | [0m[35m            # here we have a generic patch for POST on all endpoints.[0m
[30;1m79 | [0m[35m            mapping=self._expiring_mapping,[0m
[30;1m80 | [0m[35m            key_maker=lambda func, args, kwargs:[0m

[31m--[ [0m[34mMatch #[0m[33m933[0m[34m of [0m[33m933[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/msal-1.32.0/msal/throttled_http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m                    # Furthermore, there is no need to implement[0m
[30;1m106 | [0m[35m                    # "interactive requests would reset the cache",[0m
[30;1m107 | [0m[35m                    # because acquire_token_silent()'s would be automatically unblocked[0m
[30;1m108 | [0m[35m                    # due to token cache layer operates on top of http cache layer.[0m
[30;1m109 | [0m[35m                    #[0m
[30;1m110 | [0m[35m                    # And, acquire_token_silent(..., force_refresh=True) will NOT[0m
[30;1m111 | [0m[35m                    # bypass http cache, because there is no real gain from that.[0m

933 matches found.
