[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m369 | [0m[35m            pass[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m        # delete "base" password[0m
[30;1m372 | [0m[35m        keyring.delete_password(service_name, username)[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m    def _provider_from_dict(self) -> Optional[TCredentialProvider]:[0m
[30;1m375 | [0m[35m        if self.token:[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m368 | [0m[35m        except ValueError:[0m
[30;1m369 | [0m[35m            pass[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m        # delete "base" password[0m
[30;1m372 | [0m[35m        keyring.delete_password(service_name, username)[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m    def _provider_from_dict(self) -> Optional[TCredentialProvider]:[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m364 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m365 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m366 | [0m[35m                for i in range(shard_count):[0m
[30;1m367 | [0m[35m                    keyring.delete_password(service_name, f"{username}__{i}")[0m
[30;1m368 | [0m[35m        except ValueError:[0m
[30;1m369 | [0m[35m            pass[0m
[30;1m370 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m362 | [0m[35m        try:[0m
[30;1m363 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m364 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m365 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m366 | [0m[35m                for i in range(shard_count):[0m
[30;1m367 | [0m[35m                    keyring.delete_password(service_name, f"{username}__{i}")[0m
[30;1m368 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m361 | [0m[35m        # check for "shard info" stored as json. If so delete all shards[0m
[30;1m362 | [0m[35m        try:[0m
[30;1m363 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m364 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m365 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m366 | [0m[35m                for i in range(shard_count):[0m
[30;1m367 | [0m[35m                    keyring.delete_password(service_name, f"{username}__{i}")[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m361 | [0m[35m        # check for "shard info" stored as json. If so delete all shards[0m
[30;1m362 | [0m[35m        try:[0m
[30;1m363 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m364 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m365 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m366 | [0m[35m                for i in range(shard_count):[0m
[30;1m367 | [0m[35m                    keyring.delete_password(service_name, f"{username}__{i}")[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        # check for "shard info" stored as json. If so delete all shards[0m
[30;1m362 | [0m[35m        try:[0m
[30;1m363 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m364 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m365 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m366 | [0m[35m                for i in range(shard_count):[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        # check for "shard info" stored as json. If so delete all shards[0m
[30;1m362 | [0m[35m        try:[0m
[30;1m363 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m364 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m365 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m366 | [0m[35m                for i in range(shard_count):[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m356 | [0m[35m        return password[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m    def delete_sharded_password(self, service_name: str, username: str) -> None:[0m
[30;1m359 | [0m[35m        password = keyring.get_password(service_name, username)[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        # check for "shard info" stored as json. If so delete all shards[0m
[30;1m362 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m356 | [0m[35m        return password[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m    def delete_sharded_password(self, service_name: str, username: str) -> None:[0m
[30;1m359 | [0m[35m        password = keyring.get_password(service_name, username)[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        # check for "shard info" stored as json. If so delete all shards[0m
[30;1m362 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m        return password[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m    def delete_sharded_password(self, service_name: str, username: str) -> None:[0m
[30;1m359 | [0m[35m        password = keyring.get_password(service_name, username)[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        # check for "shard info" stored as json. If so delete all shards[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m353 | [0m[35m        except ValueError:[0m
[30;1m354 | [0m[35m            pass[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m        return password[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m    def delete_sharded_password(self, service_name: str, username: str) -> None:[0m
[30;1m359 | [0m[35m        password = keyring.get_password(service_name, username)[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                password = ""[0m
[30;1m351 | [0m[35m                for i in range(shard_count):[0m
[30;1m352 | [0m[35m                    password += str(keyring.get_password(service_name, f"{username}__{i}"))[0m
[30;1m353 | [0m[35m        except ValueError:[0m
[30;1m354 | [0m[35m            pass[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                password = ""[0m
[30;1m351 | [0m[35m                for i in range(shard_count):[0m
[30;1m352 | [0m[35m                    password += str(keyring.get_password(service_name, f"{username}__{i}"))[0m
[30;1m353 | [0m[35m        except ValueError:[0m
[30;1m354 | [0m[35m            pass[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                password = ""[0m
[30;1m351 | [0m[35m                for i in range(shard_count):[0m
[30;1m352 | [0m[35m                    password += str(keyring.get_password(service_name, f"{username}__{i}"))[0m
[30;1m353 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m345 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m346 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                password = ""[0m
[30;1m351 | [0m[35m                for i in range(shard_count):[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m344 | [0m[35m        try:[0m
[30;1m345 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m346 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                password = ""[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m343 | [0m[35m        # check for "shard info" stored as json[0m
[30;1m344 | [0m[35m        try:[0m
[30;1m345 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m346 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m349 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m343 | [0m[35m        # check for "shard info" stored as json[0m
[30;1m344 | [0m[35m        try:[0m
[30;1m345 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m346 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m349 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m        # check for "shard info" stored as json[0m
[30;1m344 | [0m[35m        try:[0m
[30;1m345 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m346 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m        # check for "shard info" stored as json[0m
[30;1m344 | [0m[35m        try:[0m
[30;1m345 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m346 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m338 | [0m[35m                keyring.set_password(service_name, f"{username}__{i}", s)[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m    def get_sharded_password(self, service_name: str, username: str) -> Optional[str]:[0m
[30;1m341 | [0m[35m        password = keyring.get_password(service_name, username)[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m        # check for "shard info" stored as json[0m
[30;1m344 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m338 | [0m[35m                keyring.set_password(service_name, f"{username}__{i}", s)[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m    def get_sharded_password(self, service_name: str, username: str) -> Optional[str]:[0m
[30;1m341 | [0m[35m        password = keyring.get_password(service_name, username)[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m        # check for "shard info" stored as json[0m
[30;1m344 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m337 | [0m[35m            for i, s in enumerate(password_shards):[0m
[30;1m338 | [0m[35m                keyring.set_password(service_name, f"{username}__{i}", s)[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m    def get_sharded_password(self, service_name: str, username: str) -> Optional[str]:[0m
[30;1m341 | [0m[35m        password = keyring.get_password(service_name, username)[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m        # check for "shard info" stored as json[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m335 | [0m[35m            keyring.set_password(service_name, username, json.dumps(shard_info))[0m
[30;1m336 | [0m[35m            # then store all shards with the shard number as postfix[0m
[30;1m337 | [0m[35m            for i, s in enumerate(password_shards):[0m
[30;1m338 | [0m[35m                keyring.set_password(service_name, f"{username}__{i}", s)[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m    def get_sharded_password(self, service_name: str, username: str) -> Optional[str]:[0m
[30;1m341 | [0m[35m        password = keyring.get_password(service_name, username)[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m334 | [0m[35m            # store the "shard info" as the "base" password[0m
[30;1m335 | [0m[35m            keyring.set_password(service_name, username, json.dumps(shard_info))[0m
[30;1m336 | [0m[35m            # then store all shards with the shard number as postfix[0m
[30;1m337 | [0m[35m            for i, s in enumerate(password_shards):[0m
[30;1m338 | [0m[35m                keyring.set_password(service_name, f"{username}__{i}", s)[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m    def get_sharded_password(self, service_name: str, username: str) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m332 | [0m[35m            }[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m            # store the "shard info" as the "base" password[0m
[30;1m335 | [0m[35m            keyring.set_password(service_name, username, json.dumps(shard_info))[0m
[30;1m336 | [0m[35m            # then store all shards with the shard number as postfix[0m
[30;1m337 | [0m[35m            for i, s in enumerate(password_shards):[0m
[30;1m338 | [0m[35m                keyring.set_password(service_name, f"{username}__{i}", s)[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m331 | [0m[35m                "shard_count": len(password_shards),[0m
[30;1m332 | [0m[35m            }[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m            # store the "shard info" as the "base" password[0m
[30;1m335 | [0m[35m            keyring.set_password(service_name, username, json.dumps(shard_info))[0m
[30;1m336 | [0m[35m            # then store all shards with the shard number as postfix[0m
[30;1m337 | [0m[35m            for i, s in enumerate(password_shards):[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m328 | [0m[35m            ][0m
[30;1m329 | [0m[35m            shard_info = {[0m
[30;1m330 | [0m[35m                "sharded_password": True,[0m
[30;1m331 | [0m[35m                "shard_count": len(password_shards),[0m
[30;1m332 | [0m[35m            }[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m            # store the "shard info" as the "base" password[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m327 | [0m[35m                password[i : i + max_size] for i in range(0, len(password), max_size)[0m
[30;1m328 | [0m[35m            ][0m
[30;1m329 | [0m[35m            shard_info = {[0m
[30;1m330 | [0m[35m                "sharded_password": True,[0m
[30;1m331 | [0m[35m                "shard_count": len(password_shards),[0m
[30;1m332 | [0m[35m            }[0m
[30;1m333 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m324 | [0m[35m            logger.debug(CredentialShardEvent(len(password)))[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m            password_shards = [[0m
[30;1m327 | [0m[35m                password[i : i + max_size] for i in range(0, len(password), max_size)[0m
[30;1m328 | [0m[35m            ][0m
[30;1m329 | [0m[35m            shard_info = {[0m
[30;1m330 | [0m[35m                "sharded_password": True,[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m324 | [0m[35m            logger.debug(CredentialShardEvent(len(password)))[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m            password_shards = [[0m
[30;1m327 | [0m[35m                password[i : i + max_size] for i in range(0, len(password), max_size)[0m
[30;1m328 | [0m[35m            ][0m
[30;1m329 | [0m[35m            shard_info = {[0m
[30;1m330 | [0m[35m                "sharded_password": True,[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m323 | [0m[35m        else:[0m
[30;1m324 | [0m[35m            logger.debug(CredentialShardEvent(len(password)))[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m            password_shards = [[0m
[30;1m327 | [0m[35m                password[i : i + max_size] for i in range(0, len(password), max_size)[0m
[30;1m328 | [0m[35m            ][0m
[30;1m329 | [0m[35m            shard_info = {[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m321 | [0m[35m        if os.name != "nt" or len(password) < max_size:[0m
[30;1m322 | [0m[35m            keyring.set_password(service_name, username, password)[0m
[30;1m323 | [0m[35m        else:[0m
[30;1m324 | [0m[35m            logger.debug(CredentialShardEvent(len(password)))[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m            password_shards = [[0m
[30;1m327 | [0m[35m                password[i : i + max_size] for i in range(0, len(password), max_size)[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        # if not Windows or "small" password, stick to the default[0m
[30;1m321 | [0m[35m        if os.name != "nt" or len(password) < max_size:[0m
[30;1m322 | [0m[35m            keyring.set_password(service_name, username, password)[0m
[30;1m323 | [0m[35m        else:[0m
[30;1m324 | [0m[35m            logger.debug(CredentialShardEvent(len(password)))[0m
[30;1m325 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        # if not Windows or "small" password, stick to the default[0m
[30;1m321 | [0m[35m        if os.name != "nt" or len(password) < max_size:[0m
[30;1m322 | [0m[35m            keyring.set_password(service_name, username, password)[0m
[30;1m323 | [0m[35m        else:[0m
[30;1m324 | [0m[35m            logger.debug(CredentialShardEvent(len(password)))[0m
[30;1m325 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m318 | [0m[35m        max_size = MAX_NT_PASSWORD_SIZE[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        # if not Windows or "small" password, stick to the default[0m
[30;1m321 | [0m[35m        if os.name != "nt" or len(password) < max_size:[0m
[30;1m322 | [0m[35m            keyring.set_password(service_name, username, password)[0m
[30;1m323 | [0m[35m        else:[0m
[30;1m324 | [0m[35m            logger.debug(CredentialShardEvent(len(password)))[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m317 | [0m[35m    def set_sharded_password(self, service_name: str, username: str, password: str) -> None:[0m
[30;1m318 | [0m[35m        max_size = MAX_NT_PASSWORD_SIZE[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        # if not Windows or "small" password, stick to the default[0m
[30;1m321 | [0m[35m        if os.name != "nt" or len(password) < max_size:[0m
[30;1m322 | [0m[35m            keyring.set_password(service_name, username, password)[0m
[30;1m323 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m315 | [0m[35m            self._lock.release()[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    def set_sharded_password(self, service_name: str, username: str, password: str) -> None:[0m
[30;1m318 | [0m[35m        max_size = MAX_NT_PASSWORD_SIZE[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        # if not Windows or "small" password, stick to the default[0m
[30;1m321 | [0m[35m        if os.name != "nt" or len(password) < max_size:[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m314 | [0m[35m        finally:[0m
[30;1m315 | [0m[35m            self._lock.release()[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    def set_sharded_password(self, service_name: str, username: str, password: str) -> None:[0m
[30;1m318 | [0m[35m        max_size = MAX_NT_PASSWORD_SIZE[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        # if not Windows or "small" password, stick to the default[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m314 | [0m[35m        finally:[0m
[30;1m315 | [0m[35m            self._lock.release()[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    def set_sharded_password(self, service_name: str, username: str, password: str) -> None:[0m
[30;1m318 | [0m[35m        max_size = MAX_NT_PASSWORD_SIZE[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        # if not Windows or "small" password, stick to the default[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m305 | [0m[35m                self.set_sharded_password([0m
[30;1m306 | [0m[35m                    "dbt-databricks", host, json.dumps(self._credentials_provider)[0m
[30;1m307 | [0m[35m                )[0m
[30;1m308 | [0m[35m            # error with keyring. Maybe machine has no password persistency[0m
[30;1m309 | [0m[35m            except Exception as e:[0m
[30;1m310 | [0m[35m                logger.warning(CredentialSaveError(e))[0m
[30;1m311 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m302 | [0m[35m            # save for later[0m
[30;1m303 | [0m[35m            self._credentials_provider = provider.as_dict()[0m
[30;1m304 | [0m[35m            try:[0m
[30;1m305 | [0m[35m                self.set_sharded_password([0m
[30;1m306 | [0m[35m                    "dbt-databricks", host, json.dumps(self._credentials_provider)[0m
[30;1m307 | [0m[35m                )[0m
[30;1m308 | [0m[35m            # error with keyring. Maybe machine has no password persistency[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m291 | [0m[35m                        # whatever it is, get rid of the cache[0m
[30;1m292 | [0m[35m                        self.delete_sharded_password("dbt-databricks", host)[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m            # error with keyring. Maybe machine has no password persistency[0m
[30;1m295 | [0m[35m            except Exception as e:[0m
[30;1m296 | [0m[35m                logger.warning(CredentialLoadError(e))[0m
[30;1m297 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m289 | [0m[35m                    except Exception as e:[0m
[30;1m290 | [0m[35m                        logger.warning(CredentialLoadError(e))[0m
[30;1m291 | [0m[35m                        # whatever it is, get rid of the cache[0m
[30;1m292 | [0m[35m                        self.delete_sharded_password("dbt-databricks", host)[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m            # error with keyring. Maybe machine has no password persistency[0m
[30;1m295 | [0m[35m            except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m278 | [0m[35m            # optional branch. Try and keep going if it does not work[0m
[30;1m279 | [0m[35m            try:[0m
[30;1m280 | [0m[35m                # try to get cached credentials[0m
[30;1m281 | [0m[35m                credsdict = self.get_sharded_password("dbt-databricks", host)[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m                if credsdict:[0m
[30;1m284 | [0m[35m                    provider = SessionCredentials.from_dict(oauth_client, json.loads(credsdict))[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35mREDIRECT_URL = "http://localhost:8020"[0m
[30;1m37 | [0m[35mCLIENT_ID = "dbt-databricks"[0m
[30;1m38 | [0m[35mSCOPES = ["all-apis", "offline_access"][0m
[30;1m39 | [0m[35mMAX_NT_PASSWORD_SIZE = 1280[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mTCredentialProvider = Union[CredentialsProvider, SessionCredentials][0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    @classmethod[0m
[30;1m168 | [0m[35m    def get_all_http_headers(cls, user_http_session_headers: Dict[str, str]) -> Dict[str, str]:[0m
[30;1m169 | [0m[35m        http_session_headers_str: Optional[str] = os.environ.get([0m
[30;1m170 | [0m[35m            DBT_DATABRICKS_HTTP_SESSION_HEADERS[0m
[30;1m171 | [0m[35m        )[0m
[30;1m172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    @classmethod[0m
[30;1m158 | [0m[35m    def get_invocation_env(cls) -> Optional[str]:[0m
[30;1m159 | [0m[35m        invocation_env = os.environ.get(DBT_DATABRICKS_INVOCATION_ENV)[0m
[30;1m160 | [0m[35m        if invocation_env:[0m
[30;1m161 | [0m[35m            # Thrift doesn't allow nested () so we need to ensure[0m
[30;1m162 | [0m[35m            # that the passed user agent is valid.[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/impl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m116 | [0m[35m    """[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    _identifier = "|".join(table_names)[0m
[30;1m119 | [0m[35m    bypass_2048_char_limit = os.environ.get("DBT_DESCRIBE_TABLE_2048_CHAR_BYPASS", "false")[0m
[30;1m120 | [0m[35m    if bypass_2048_char_limit == "true":[0m
[30;1m121 | [0m[35m        _identifier = _identifier if len(_identifier) < 2048 else "*"[0m
[30;1m122 | [0m[35m    return _identifier[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1020 | [0m[35m[0m
[30;1m1021 | [0m[35m        user_agent_entry = f"dbt-databricks/{__version__}"[0m
[30;1m1022 | [0m[35m[0m
[30;1m1023 | [0m[35m        invocation_env = creds.get_invocation_env()[0m
[30;1m1024 | [0m[35m        if invocation_env:[0m
[30;1m1025 | [0m[35m            user_agent_entry = f"{user_agent_entry}; {invocation_env}"[0m
[30;1m1026 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m726 | [0m[35m[0m
[30;1m727 | [0m[35m        user_agent_entry = f"dbt-databricks/{__version__}"[0m
[30;1m728 | [0m[35m[0m
[30;1m729 | [0m[35m        invocation_env = creds.get_invocation_env()[0m
[30;1m730 | [0m[35m        if invocation_env:[0m
[30;1m731 | [0m[35m            user_agent_entry = f"{user_agent_entry}; {invocation_env}"[0m
[30;1m732 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/logging.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m22 | [0m[35mdbt_adapter_logger = AdapterLogger("databricks-sql-connector")[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mpysql_logger = logging.getLogger("databricks.sql")[0m
[30;1m25 | [0m[35mpysql_logger_level = os.environ.get("DBT_DATABRICKS_CONNECTOR_LOG_LEVEL", "WARN").upper()[0m
[30;1m26 | [0m[35mpysql_logger.setLevel(pysql_logger_level)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mpysql_handler = DbtCoreHandler(dbt_logger=dbt_adapter_logger, level=pysql_logger_level)[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m81 | [0m[35m        return cluster_dict[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def _upload_notebook(self, path: str, compiled_code: str) -> None:[0m
[30;1m84 | [0m[35m        b64_encoded_content = base64.b64encode(compiled_code.encode()).decode()[0m
[30;1m85 | [0m[35m        response = self.session.post([0m
[30;1m86 | [0m[35m            f"https://{self.credentials.host}/api/2.0/workspace/import",[0m
[30;1m87 | [0m[35m            headers=self.extra_headers,[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport uuid[0m
[30;1m4 | [0m[35mfrom typing import Any[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m435 | [0m[35m[0m
[30;1m436 | [0m[35m        user_agent = f"dbt-databricks/{version}"[0m
[30;1m437 | [0m[35m[0m
[30;1m438 | [0m[35m        invocation_env = credentials.get_invocation_env()[0m
[30;1m439 | [0m[35m        if invocation_env:[0m
[30;1m440 | [0m[35m            user_agent = f"{user_agent} ({invocation_env})"[0m
[30;1m441 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/events/credential_events.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35m        self.password_len = password_len[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    def __str__(self) -> str:[0m
[30;1m19 | [0m[35m        return f"Password is {self.password_len} characters, sharding it"[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/events/credential_events.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35m        self.password_len = password_len[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    def __str__(self) -> str:[0m
[30;1m19 | [0m[35m        return f"Password is {self.password_len} characters, sharding it"[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/events/credential_events.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass CredentialShardEvent:[0m
[30;1m15 | [0m[35m    def __init__(self, password_len: int):[0m
[30;1m16 | [0m[35m        self.password_len = password_len[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    def __str__(self) -> str:[0m
[30;1m19 | [0m[35m        return f"Password is {self.password_len} characters, sharding it"[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/events/credential_events.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass CredentialShardEvent:[0m
[30;1m15 | [0m[35m    def __init__(self, password_len: int):[0m
[30;1m16 | [0m[35m        self.password_len = password_len[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    def __str__(self) -> str:[0m
[30;1m19 | [0m[35m        return f"Password is {self.password_len} characters, sharding it"[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbt/adapters/databricks/events/credential_events.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass CredentialShardEvent:[0m
[30;1m15 | [0m[35m    def __init__(self, password_len: int):[0m
[30;1m16 | [0m[35m        self.password_len = password_len[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    def __str__(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/adapters/python.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m{%- set file_format = config.get('file_format', validator=validation.any[basestring])|default('delta[0m
[30;1m57 | [0m[35m{%- set partition_by = config.get('partition_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m58 | [0m[35m{%- set clustered_by = config.get('clustered_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m59 | [0m[35m{%- set buckets = config.get('buckets', validator=validation.any[int]) -%}[0m
[30;1m60 | [0m[35m.format("{{ file_format }}")[0m
[30;1m61 | [0m[35m{%- if location_root is not none %}[0m
[30;1m62 | [0m[35m{%- set identifier = model['alias'] %}[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/adapters/python.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m{%- set location_root = config.get('location_root', validator=validation.any[basestring]) -%}[0m
[30;1m56 | [0m[35m{%- set file_format = config.get('file_format', validator=validation.any[basestring])|default('delta[0m
[30;1m57 | [0m[35m{%- set partition_by = config.get('partition_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m58 | [0m[35m{%- set clustered_by = config.get('clustered_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m59 | [0m[35m{%- set buckets = config.get('buckets', validator=validation.any[int]) -%}[0m
[30;1m60 | [0m[35m.format("{{ file_format }}")[0m
[30;1m61 | [0m[35m{%- if location_root is not none %}[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/adapters/python.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m{%- macro py_get_writer_options() -%}[0m
[30;1m55 | [0m[35m{%- set location_root = config.get('location_root', validator=validation.any[basestring]) -%}[0m
[30;1m56 | [0m[35m{%- set file_format = config.get('file_format', validator=validation.any[basestring])|default('delta[0m
[30;1m57 | [0m[35m{%- set partition_by = config.get('partition_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m58 | [0m[35m{%- set clustered_by = config.get('clustered_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m59 | [0m[35m{%- set buckets = config.get('buckets', validator=validation.any[int]) -%}[0m
[30;1m60 | [0m[35m.format("{{ file_format }}")[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/adapters/python.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m{%- macro py_get_writer_options() -%}[0m
[30;1m55 | [0m[35m{%- set location_root = config.get('location_root', validator=validation.any[basestring]) -%}[0m
[30;1m56 | [0m[35m{%- set file_format = config.get('file_format', validator=validation.any[basestring])|default('delta[0m
[30;1m57 | [0m[35m{%- set partition_by = config.get('partition_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m58 | [0m[35m{%- set clustered_by = config.get('clustered_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m59 | [0m[35m{%- set buckets = config.get('buckets', validator=validation.any[int]) -%}[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/adapters/python.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m# look in the dbt.log[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m{%- macro py_get_writer_options() -%}[0m
[30;1m55 | [0m[35m{%- set location_root = config.get('location_root', validator=validation.any[basestring]) -%}[0m
[30;1m56 | [0m[35m{%- set file_format = config.get('file_format', validator=validation.any[basestring])|default('delta[0m
[30;1m57 | [0m[35m{%- set partition_by = config.get('partition_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m58 | [0m[35m{%- set clustered_by = config.get('clustered_by', validator=validation.any[list, basestring]) -%}[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/adapters/persist_docs.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1 | [0m[35m{% macro databricks__alter_column_comment(relation, column_dict) %}[0m
[30;1m2 | [0m[35m  {% if config.get('file_format', default='delta') in ['delta', 'hudi'] %}[0m
[30;1m3 | [0m[35m    {% for column_name in column_dict %}[0m
[30;1m4 | [0m[35m      {% set comment = column_dict[column_name]['description'] %}[0m
[30;1m5 | [0m[35m      {% set escaped_comment = comment | replace('\'', '\\\'') %}[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m362 | [0m[35m        try:[0m
[30;1m363 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m364 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m365 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m366 | [0m[35m                for i in range(shard_count):[0m
[30;1m367 | [0m[35m                    keyring.delete_password(service_name, f"{username}__{i}")[0m
[30;1m368 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m        # check for "shard info" stored as json. If so delete all shards[0m
[30;1m362 | [0m[35m        try:[0m
[30;1m363 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m364 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m365 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m366 | [0m[35m                for i in range(shard_count):[0m
[30;1m367 | [0m[35m                    keyring.delete_password(service_name, f"{username}__{i}")[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m346 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                password = ""[0m
[30;1m351 | [0m[35m                for i in range(shard_count):[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m343 | [0m[35m        # check for "shard info" stored as json[0m
[30;1m344 | [0m[35m        try:[0m
[30;1m345 | [0m[35m            password_as_dict = json.loads(str(password))[0m
[30;1m346 | [0m[35m            if password_as_dict.get("sharded_password"):[0m
[30;1m347 | [0m[35m                # if password was stored shared, reconstruct it[0m
[30;1m348 | [0m[35m                shard_count = int(password_as_dict.get("shard_count"))[0m
[30;1m349 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    @classmethod[0m
[30;1m168 | [0m[35m    def get_all_http_headers(cls, user_http_session_headers: Dict[str, str]) -> Dict[str, str]:[0m
[30;1m169 | [0m[35m        http_session_headers_str: Optional[str] = os.environ.get([0m
[30;1m170 | [0m[35m            DBT_DATABRICKS_HTTP_SESSION_HEADERS[0m
[30;1m171 | [0m[35m        )[0m
[30;1m172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    @classmethod[0m
[30;1m158 | [0m[35m    def get_invocation_env(cls) -> Optional[str]:[0m
[30;1m159 | [0m[35m        invocation_env = os.environ.get(DBT_DATABRICKS_INVOCATION_ENV)[0m
[30;1m160 | [0m[35m        if invocation_env:[0m
[30;1m161 | [0m[35m            # Thrift doesn't allow nested () so we need to ensure[0m
[30;1m162 | [0m[35m            # that the passed user agent is valid.[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/credentials.py[0m
   Pattern: [32m.hostname[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        connection_parameters = self.connection_parameters or {}[0m
[30;1m111 | [0m[35m        for key in ([0m
[30;1m112 | [0m[35m            "server_hostname",[0m
[30;1m113 | [0m[35m            "http_path",[0m
[30;1m114 | [0m[35m            "access_token",[0m
[30;1m115 | [0m[35m            "client_id",[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/components/refresh_schedule.sql[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m9 | [0m[35m    {%- if is_altered -%}[0m
[30;1m10 | [0m[35m      ALTER SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'[0m
[30;1m11 | [0m[35m    {%- else -%}[0m
[30;1m12 | [0m[35m      ADD SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'{%[0m
[30;1m13 | [0m[35m    {%- endif -%}[0m
[30;1m14 | [0m[35m  {%- else -%}[0m
[30;1m15 | [0m[35m    DROP SCHEDULE[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/components/refresh_schedule.sql[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m{% macro get_alter_sql_refresh_schedule(cron, time_zone_value, is_altered) %}[0m
[30;1m8 | [0m[35m  {%- if cron -%}[0m
[30;1m9 | [0m[35m    {%- if is_altered -%}[0m
[30;1m10 | [0m[35m      ALTER SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'[0m
[30;1m11 | [0m[35m    {%- else -%}[0m
[30;1m12 | [0m[35m      ADD SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'{%[0m
[30;1m13 | [0m[35m    {%- endif -%}[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/components/refresh_schedule.sql[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m{% macro get_create_sql_refresh_schedule(cron, time_zone_value) %}[0m
[30;1m2 | [0m[35m  {%- if cron -%}[0m
[30;1m3 | [0m[35m    SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'{%- endi[0m
[30;1m4 | [0m[35m  {%- endif -%}[0m
[30;1m5 | [0m[35m{% endmacro %}[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/components/refresh_schedule.sql[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    {%- if is_altered -%}[0m
[30;1m10 | [0m[35m      ALTER SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'[0m
[30;1m11 | [0m[35m    {%- else -%}[0m
[30;1m12 | [0m[35m      ADD SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'{%[0m
[30;1m13 | [0m[35m    {%- endif -%}[0m
[30;1m14 | [0m[35m  {%- else -%}[0m
[30;1m15 | [0m[35m    DROP SCHEDULE[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/components/refresh_schedule.sql[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m{% macro get_alter_sql_refresh_schedule(cron, time_zone_value, is_altered) %}[0m
[30;1m8 | [0m[35m  {%- if cron -%}[0m
[30;1m9 | [0m[35m    {%- if is_altered -%}[0m
[30;1m10 | [0m[35m      ALTER SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'[0m
[30;1m11 | [0m[35m    {%- else -%}[0m
[30;1m12 | [0m[35m      ADD SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'{%[0m
[30;1m13 | [0m[35m    {%- endif -%}[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/components/refresh_schedule.sql[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m{% macro get_create_sql_refresh_schedule(cron, time_zone_value) %}[0m
[30;1m2 | [0m[35m  {%- if cron -%}[0m
[30;1m3 | [0m[35m    SCHEDULE CRON '{{ cron }}'{%- if time_zone_value %} AT TIME ZONE '{{ time_zone_value }}'{%- endi[0m
[30;1m4 | [0m[35m  {%- endif -%}[0m
[30;1m5 | [0m[35m{% endmacro %}[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m{%- endmacro -%}[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m{% macro databricks__liquid_clustered_cols(label, required=false) -%}[0m
[30;1m67 | [0m[35m  {%- set cols = config.get('liquid_clustered_by', validator=validation.any[list, basestring]) -%}[0m
[30;1m68 | [0m[35m  {%- if cols is not none %}[0m
[30;1m69 | [0m[35m    {%- if cols is string -%}[0m
[30;1m70 | [0m[35m      {%- set cols = [cols] -%}[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m    {%- if unique_key is not none and options is none -%}[0m
[30;1m45 | [0m[35m      {%- set options = {'primaryKey': config.get('unique_key')} -%}[0m
[30;1m46 | [0m[35m    {%- elif unique_key is not none and options is not none and 'primaryKey' not in options -%}[0m
[30;1m47 | [0m[35m      {%- set _ = options.update({'primaryKey': config.get('unique_key')}) -%}[0m
[30;1m48 | [0m[35m    {%- elif options is not none and 'primaryKey' in options and options['primaryKey'] != unique_key[0m
[30;1m49 | [0m[35m      {{ exceptions.raise_compiler_error("unique_key and options('primaryKey') should be the same co[0m
[30;1m50 | [0m[35m    {%- endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m  {%- if config.get('file_format', default='delta') == 'hudi' -%}[0m
[30;1m43 | [0m[35m    {%- set unique_key = config.get('unique_key') -%}[0m
[30;1m44 | [0m[35m    {%- if unique_key is not none and options is none -%}[0m
[30;1m45 | [0m[35m      {%- set options = {'primaryKey': config.get('unique_key')} -%}[0m
[30;1m46 | [0m[35m    {%- elif unique_key is not none and options is not none and 'primaryKey' not in options -%}[0m
[30;1m47 | [0m[35m      {%- set _ = options.update({'primaryKey': config.get('unique_key')}) -%}[0m
[30;1m48 | [0m[35m    {%- elif options is not none and 'primaryKey' in options and options['primaryKey'] != unique_key[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m{% macro databricks__options_clause() -%}[0m
[30;1m41 | [0m[35m  {%- set options = config.get('options') -%}[0m
[30;1m42 | [0m[35m  {%- if config.get('file_format', default='delta') == 'hudi' -%}[0m
[30;1m43 | [0m[35m    {%- set unique_key = config.get('unique_key') -%}[0m
[30;1m44 | [0m[35m    {%- if unique_key is not none and options is none -%}[0m
[30;1m45 | [0m[35m      {%- set options = {'primaryKey': config.get('unique_key')} -%}[0m
[30;1m46 | [0m[35m    {%- elif unique_key is not none and options is not none and 'primaryKey' not in options -%}[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m{% macro databricks__options_clause() -%}[0m
[30;1m41 | [0m[35m  {%- set options = config.get('options') -%}[0m
[30;1m42 | [0m[35m  {%- if config.get('file_format', default='delta') == 'hudi' -%}[0m
[30;1m43 | [0m[35m    {%- set unique_key = config.get('unique_key') -%}[0m
[30;1m44 | [0m[35m    {%- if unique_key is not none and options is none -%}[0m
[30;1m45 | [0m[35m      {%- set options = {'primaryKey': config.get('unique_key')} -%}[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m{%- endmacro -%}[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m{% macro databricks__options_clause() -%}[0m
[30;1m41 | [0m[35m  {%- set options = config.get('options') -%}[0m
[30;1m42 | [0m[35m  {%- if config.get('file_format', default='delta') == 'hudi' -%}[0m
[30;1m43 | [0m[35m    {%- set unique_key = config.get('unique_key') -%}[0m
[30;1m44 | [0m[35m    {%- if unique_key is not none and options is none -%}[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m      {% else %}[0m
[30;1m10 | [0m[35m        create table {{ relation }}[0m
[30;1m11 | [0m[35m      {% endif %}[0m
[30;1m12 | [0m[35m      {%- set contract_config = config.get('contract') -%}[0m
[30;1m13 | [0m[35m      {% if contract_config and contract_config.enforced %}[0m
[30;1m14 | [0m[35m        {{ get_assert_columns_equivalent(compiled_code) }}[0m
[30;1m15 | [0m[35m        {%- set compiled_code = get_select_subquery(compiled_code) %}[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35m    {%- if temporary -%}[0m
[30;1m4 | [0m[35m      {{ create_temporary_view(relation, compiled_code) }}[0m
[30;1m5 | [0m[35m    {%- else -%}[0m
[30;1m6 | [0m[35m      {%- set file_format = config.get('file_format', default='delta') -%}[0m
[30;1m7 | [0m[35m      {% if file_format == 'delta' %}[0m
[30;1m8 | [0m[35m        create or replace table {{ relation }}[0m
[30;1m9 | [0m[35m      {% else %}[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/table/create.sql[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m  {%- elif language == 'python' -%}[0m
[30;1m29 | [0m[35m    {#--[0m
[30;1m30 | [0m[35m    N.B. Python models _can_ write to temp views HOWEVER they use a different session[0m
[30;1m31 | [0m[35m    and have already expired by the time they need to be used (I.E. in merges for incremental models[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    TODO: Deep dive into spark sessions to see if we can reuse a single session for an entire[0m
[30;1m34 | [0m[35m    dbt invocation.[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/impl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m                table_type=relation.type,[0m
[30;1m369 | [0m[35m                table_owner=str(metadata.get(KEY_TABLE_OWNER)),[0m
[30;1m370 | [0m[35m                table_stats=table_stats,[0m
[30;1m371 | [0m[35m                table_comment=metadata.get("Comment"),[0m
[30;1m372 | [0m[35m                column=column["col_name"],[0m
[30;1m373 | [0m[35m                column_index=idx,[0m
[30;1m374 | [0m[35m                dtype=column["data_type"],[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/impl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35m                table_schema=relation.schema,[0m
[30;1m367 | [0m[35m                table_name=relation.name,[0m
[30;1m368 | [0m[35m                table_type=relation.type,[0m
[30;1m369 | [0m[35m                table_owner=str(metadata.get(KEY_TABLE_OWNER)),[0m
[30;1m370 | [0m[35m                table_stats=table_stats,[0m
[30;1m371 | [0m[35m                table_comment=metadata.get("Comment"),[0m
[30;1m372 | [0m[35m                column=column["col_name"],[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/impl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m        rows = [row for row in raw_rows[0:pos] if not row["col_name"].startswith("#")][0m
[30;1m359 | [0m[35m        metadata = {col["col_name"]: col["data_type"] for col in raw_rows[pos + 1 :]}[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        raw_table_stats = metadata.get(KEY_TABLE_STATISTICS)[0m
[30;1m362 | [0m[35m        table_stats = DatabricksColumn.convert_table_stats(raw_table_stats)[0m
[30;1m363 | [0m[35m        return metadata, [[0m
[30;1m364 | [0m[35m            DatabricksColumn([0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/impl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    """[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    _identifier = "|".join(table_names)[0m
[30;1m119 | [0m[35m    bypass_2048_char_limit = os.environ.get("DBT_DESCRIBE_TABLE_2048_CHAR_BYPASS", "false")[0m
[30;1m120 | [0m[35m    if bypass_2048_char_limit == "true":[0m
[30;1m121 | [0m[35m        _identifier = _identifier if len(_identifier) < 2048 else "*"[0m
[30;1m122 | [0m[35m    return _identifier[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/impl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m350 | [0m[35m    ) -> Tuple[Dict[str, Any], List[DatabricksColumn]]:[0m
[30;1m351 | [0m[35m        # Convert the Row to a dict[0m
[30;1m352 | [0m[35m        dict_rows = [dict(zip(row._keys, row._values)) for row in raw_rows][0m
[30;1m353 | [0m[35m        # Find the separator between the rows and the metadata provided[0m
[30;1m354 | [0m[35m        # by the DESCRIBE TABLE EXTENDED statement[0m
[30;1m355 | [0m[35m        pos = self.find_table_information_separator(dict_rows)[0m
[30;1m356 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1236 | [0m[35m    if query_header_context:[0m
[30;1m1237 | [0m[35m        compute_name = _get_compute_name(query_header_context)[0m
[30;1m1238 | [0m[35m        if compute_name and creds.compute:[0m
[30;1m1239 | [0m[35m            max_idle_time = creds.compute.get(compute_name, {}).get([0m
[30;1m1240 | [0m[35m                "connect_max_idle", max_idle_time[0m
[30;1m1241 | [0m[35m            )[0m
[30;1m1242 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1236 | [0m[35m    if query_header_context:[0m
[30;1m1237 | [0m[35m        compute_name = _get_compute_name(query_header_context)[0m
[30;1m1238 | [0m[35m        if compute_name and creds.compute:[0m
[30;1m1239 | [0m[35m            max_idle_time = creds.compute.get(compute_name, {}).get([0m
[30;1m1240 | [0m[35m                "connect_max_idle", max_idle_time[0m
[30;1m1241 | [0m[35m            )[0m
[30;1m1242 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1208 | [0m[35m    # Get the http_path for the named compute.[0m
[30;1m1209 | [0m[35m    http_path = None[0m
[30;1m1210 | [0m[35m    if creds.compute:[0m
[30;1m1211 | [0m[35m        http_path = creds.compute.get(compute_name, {}).get("http_path", None)[0m
[30;1m1212 | [0m[35m[0m
[30;1m1213 | [0m[35m    # no http_path for the named compute resource is an error condition[0m
[30;1m1214 | [0m[35m    if not http_path:[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1208 | [0m[35m    # Get the http_path for the named compute.[0m
[30;1m1209 | [0m[35m    http_path = None[0m
[30;1m1210 | [0m[35m    if creds.compute:[0m
[30;1m1211 | [0m[35m        http_path = creds.compute.get(compute_name, {}).get("http_path", None)[0m
[30;1m1212 | [0m[35m[0m
[30;1m1213 | [0m[35m    # no http_path for the named compute resource is an error condition[0m
[30;1m1214 | [0m[35m    if not http_path:[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1177 | [0m[35m        and hasattr(query_header_context, "config")[0m
[30;1m1178 | [0m[35m        and query_header_context.config[0m
[30;1m1179 | [0m[35m    ):[0m
[30;1m1180 | [0m[35m        compute_name = query_header_context.config.get("databricks_compute", None)[0m
[30;1m1181 | [0m[35m    return compute_name[0m
[30;1m1182 | [0m[35m[0m
[30;1m1183 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1163 | [0m[35m[0m
[30;1m1164 | [0m[35m    msg = ""[0m
[30;1m1165 | [0m[35m    if error_events:[0m
[30;1m1166 | [0m[35m        msg = error_events[0].get("message", "")[0m
[30;1m1167 | [0m[35m[0m
[30;1m1168 | [0m[35m    return msg[0m
[30;1m1169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1158 | [0m[35m    error_events = [[0m
[30;1m1159 | [0m[35m        e[0m
[30;1m1160 | [0m[35m        for e in update_events[0m
[30;1m1161 | [0m[35m        if e.get("details", {}).get("update_progress", {}).get("state", "") == "FAILED"[0m
[30;1m1162 | [0m[35m    ][0m
[30;1m1163 | [0m[35m[0m
[30;1m1164 | [0m[35m    msg = ""[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1158 | [0m[35m    error_events = [[0m
[30;1m1159 | [0m[35m        e[0m
[30;1m1160 | [0m[35m        for e in update_events[0m
[30;1m1161 | [0m[35m        if e.get("details", {}).get("update_progress", {}).get("state", "") == "FAILED"[0m
[30;1m1162 | [0m[35m    ][0m
[30;1m1163 | [0m[35m[0m
[30;1m1164 | [0m[35m    msg = ""[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1158 | [0m[35m    error_events = [[0m
[30;1m1159 | [0m[35m        e[0m
[30;1m1160 | [0m[35m        for e in update_events[0m
[30;1m1161 | [0m[35m        if e.get("details", {}).get("update_progress", {}).get("state", "") == "FAILED"[0m
[30;1m1162 | [0m[35m    ][0m
[30;1m1163 | [0m[35m[0m
[30;1m1164 | [0m[35m    msg = ""[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1152 | [0m[35m        e[0m
[30;1m1153 | [0m[35m        for e in events[0m
[30;1m1154 | [0m[35m        if e.get("event_type", "") == "update_progress"[0m
[30;1m1155 | [0m[35m        and e.get("origin", {}).get("update_id") == update_id[0m
[30;1m1156 | [0m[35m    ][0m
[30;1m1157 | [0m[35m[0m
[30;1m1158 | [0m[35m    error_events = [[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1152 | [0m[35m        e[0m
[30;1m1153 | [0m[35m        for e in events[0m
[30;1m1154 | [0m[35m        if e.get("event_type", "") == "update_progress"[0m
[30;1m1155 | [0m[35m        and e.get("origin", {}).get("update_id") == update_id[0m
[30;1m1156 | [0m[35m    ][0m
[30;1m1157 | [0m[35m[0m
[30;1m1158 | [0m[35m    error_events = [[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1151 | [0m[35m    update_events = [[0m
[30;1m1152 | [0m[35m        e[0m
[30;1m1153 | [0m[35m        for e in events[0m
[30;1m1154 | [0m[35m        if e.get("event_type", "") == "update_progress"[0m
[30;1m1155 | [0m[35m        and e.get("origin", {}).get("update_id") == update_id[0m
[30;1m1156 | [0m[35m    ][0m
[30;1m1157 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1147 | [0m[35m            f"Error getting pipeline event info for {pipeline_id}: {response.text}"[0m
[30;1m1148 | [0m[35m        )[0m
[30;1m1149 | [0m[35m[0m
[30;1m1150 | [0m[35m    events = response.json().get("events", [])[0m
[30;1m1151 | [0m[35m    update_events = [[0m
[30;1m1152 | [0m[35m        e[0m
[30;1m1153 | [0m[35m        for e in events[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1141 | [0m[35m[0m
[30;1m1142 | [0m[35mdef _get_update_error_msg(session: Session, host: str, pipeline_id: str, update_id: str) -> str:[0m
[30;1m1143 | [0m[35m    events_url = f"https://{host}/api/2.0/pipelines/{pipeline_id}/events"[0m
[30;1m1144 | [0m[35m    response = session.get(events_url)[0m
[30;1m1145 | [0m[35m    if response.status_code != 200:[0m
[30;1m1146 | [0m[35m        raise DbtRuntimeError([0m
[30;1m1147 | [0m[35m            f"Error getting pipeline event info for {pipeline_id}: {response.text}"[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1132 | [0m[35m    if not id:[0m
[30;1m1133 | [0m[35m        return updates[0][0m
[30;1m1134 | [0m[35m[0m
[30;1m1135 | [0m[35m    matches = [x for x in updates if x.get("update_id") == id][0m
[30;1m1136 | [0m[35m    if matches:[0m
[30;1m1137 | [0m[35m        return matches[0][0m
[30;1m1138 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1127 | [0m[35mdef _find_update(pipeline: dict, id: str = "") -> Optional[Dict]:[0m
[30;1m1128 | [0m[35m    updates = pipeline.get("latest_updates", [])[0m
[30;1m1129 | [0m[35m    if not updates:[0m
[30;1m1130 | [0m[35m        raise DbtRuntimeError(f"No updates for pipeline: {pipeline.get('pipeline_id', '')}")[0m
[30;1m1131 | [0m[35m[0m
[30;1m1132 | [0m[35m    if not id:[0m
[30;1m1133 | [0m[35m        return updates[0][0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1125 | [0m[35m[0m
[30;1m1126 | [0m[35m[0m
[30;1m1127 | [0m[35mdef _find_update(pipeline: dict, id: str = "") -> Optional[Dict]:[0m
[30;1m1128 | [0m[35m    updates = pipeline.get("latest_updates", [])[0m
[30;1m1129 | [0m[35m    if not updates:[0m
[30;1m1130 | [0m[35m        raise DbtRuntimeError(f"No updates for pipeline: {pipeline.get('pipeline_id', '')}")[0m
[30;1m1131 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1117 | [0m[35mdef _get_pipeline_state(session: Session, host: str, pipeline_id: str) -> dict:[0m
[30;1m1118 | [0m[35m    pipeline_url = f"https://{host}/api/2.0/pipelines/{pipeline_id}"[0m
[30;1m1119 | [0m[35m[0m
[30;1m1120 | [0m[35m    response = session.get(pipeline_url)[0m
[30;1m1121 | [0m[35m    if response.status_code != 200:[0m
[30;1m1122 | [0m[35m        raise DbtRuntimeError(f"Error getting pipeline info for {pipeline_id}: {response.text}")[0m
[30;1m1123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1105 | [0m[35m            f"Error getting info for materialized view/streaming table {name}: {resp1.text}"[0m
[30;1m1106 | [0m[35m        )[0m
[30;1m1107 | [0m[35m[0m
[30;1m1108 | [0m[35m    pipeline_id = resp1.json().get("pipeline_id", "")[0m
[30;1m1109 | [0m[35m    if not pipeline_id:[0m
[30;1m1110 | [0m[35m        raise DbtRuntimeError([0m
[30;1m1111 | [0m[35m            f"Materialized view/streaming table {name} does not have a pipeline id"[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1099 | [0m[35m[0m
[30;1m1100 | [0m[35mdef _get_table_view_pipeline_id(session: Session, host: str, name: str) -> str:[0m
[30;1m1101 | [0m[35m    table_url = f"https://{host}/api/2.1/unity-catalog/tables/{name}"[0m
[30;1m1102 | [0m[35m    resp1 = session.get(table_url)[0m
[30;1m1103 | [0m[35m    if resp1.status_code != 200:[0m
[30;1m1104 | [0m[35m        raise DbtRuntimeError([0m
[30;1m1105 | [0m[35m            f"Error getting info for materialized view/streaming table {name}: {resp1.text}"[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m924 | [0m[35m[0m
[30;1m925 | [0m[35m        with self.lock:[0m
[30;1m926 | [0m[35m            threads_map = self._get_compute_connections()[0m
[30;1m927 | [0m[35m            return threads_map.get(compute_name)[0m
[30;1m928 | [0m[35m[0m
[30;1m929 | [0m[35m    def _cleanup_idle_connections(self) -> None:[0m
[30;1m930 | [0m[35m        with self.lock:[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m911 | [0m[35m[0m
[30;1m912 | [0m[35m        thread_id = self.get_thread_identifier()[0m
[30;1m913 | [0m[35m        with self.lock:[0m
[30;1m914 | [0m[35m            thread_map = self.threads_compute_connections.get(thread_id)[0m
[30;1m915 | [0m[35m            if not thread_map:[0m
[30;1m916 | [0m[35m                thread_map = {}[0m
[30;1m917 | [0m[35m                self.threads_compute_connections[thread_id] = thread_map[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m381 | [0m[35m    dbt_databricks_version='{__version__}',[0m
[30;1m382 | [0m[35m    databricks_sql_connector_version='{dbsql.__version__}',[0m
[30;1m383 | [0m[35m    profile_name=target.get('profile_name'),[0m
[30;1m384 | [0m[35m    target_name=target.get('target_name'),[0m
[30;1m385 | [0m[35m) -%}}[0m
[30;1m386 | [0m[35m{{%- if node is not none -%}}[0m
[30;1m387 | [0m[35m  {{%- do comment_dict.update([0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m380 | [0m[35m    dbt_version=dbt_version,[0m
[30;1m381 | [0m[35m    dbt_databricks_version='{__version__}',[0m
[30;1m382 | [0m[35m    databricks_sql_connector_version='{dbsql.__version__}',[0m
[30;1m383 | [0m[35m    profile_name=target.get('profile_name'),[0m
[30;1m384 | [0m[35m    target_name=target.get('target_name'),[0m
[30;1m385 | [0m[35m) -%}}[0m
[30;1m386 | [0m[35m{{%- if node is not none -%}}[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    @classmethod[0m
[30;1m326 | [0m[35m    def findUpdate(cls, updates: List, id: str) -> Optional[Dict]:[0m
[30;1m327 | [0m[35m        matches = [x for x in updates if x.get("update_id") == id][0m
[30;1m328 | [0m[35m        if matches:[0m
[30;1m329 | [0m[35m            return matches[0][0m
[30;1m330 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m305 | [0m[35m                if not latest_update:[0m
[30;1m306 | [0m[35m                    raise DbtRuntimeError(f"No update created for pipeline: {pipeline_id}")[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m                latest_update_id = latest_update.get("update_id", "")[0m
[30;1m309 | [0m[35m                if latest_update_id != update_id:[0m
[30;1m310 | [0m[35m                    update_id = latest_update_id[0m
[30;1m311 | [0m[35m                    state = None[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m                    f"Error getting pipeline update info: {pipeline_id}, update: {update_id}"[0m
[30;1m286 | [0m[35m                )[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m            state = update.get("state")[0m
[30;1m289 | [0m[35m            if state != prev_state:[0m
[30;1m290 | [0m[35m                logger.info(PipelineRefresh(pipeline_id, update_id, model_name, str(state)))[0m
[30;1m291 | [0m[35m                prev_state = state[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        state = latest_update.get("state")[0m
[30;1m264 | [0m[35m        # we use update_id to retrieve the update in the polling loop[0m
[30;1m265 | [0m[35m        update_id = latest_update.get("update_id", "")[0m
[30;1m266 | [0m[35m        prev_state = state[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m        logger.info(PipelineRefresh(pipeline_id, update_id, model_name, str(state)))[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m        if not latest_update:[0m
[30;1m261 | [0m[35m            raise DbtRuntimeError(f"No update created for pipeline: {pipeline_id}")[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        state = latest_update.get("state")[0m
[30;1m264 | [0m[35m        # we use update_id to retrieve the update in the polling loop[0m
[30;1m265 | [0m[35m        update_id = latest_update.get("update_id", "")[0m
[30;1m266 | [0m[35m        prev_state = state[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m.hostname[0m
[30;1m1038 | [0m[35m            try:[0m
[30;1m1039 | [0m[35m                # TODO: what is the error when a user specifies a catalog they don't have access to[0m
[30;1m1040 | [0m[35m                conn = dbsql.connect([0m
[30;1m1041 | [0m[35m                    server_hostname=creds.host,[0m
[30;1m1042 | [0m[35m                    http_path=http_path,[0m
[30;1m1043 | [0m[35m                    credentials_provider=cls.credentials_provider,[0m
[30;1m1044 | [0m[35m                    http_headers=http_headers if http_headers else None,[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m.hostname[0m
[30;1m744 | [0m[35m            try:[0m
[30;1m745 | [0m[35m                # TODO: what is the error when a user specifies a catalog they don't have access to[0m
[30;1m746 | [0m[35m                conn: DatabricksSQLConnection = dbsql.connect([0m
[30;1m747 | [0m[35m                    server_hostname=creds.host,[0m
[30;1m748 | [0m[35m                    http_path=http_path,[0m
[30;1m749 | [0m[35m                    credentials_provider=cls.credentials_provider,[0m
[30;1m750 | [0m[35m                    http_headers=http_headers if http_headers else None,[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m452 | [0m[35m        if self.acquire_release_count > 0:[0m
[30;1m453 | [0m[35m            self.acquire_release_count -= 1[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m        # We don't update the last_used_time for python models because the python model[0m
[30;1m456 | [0m[35m        # is submitted through a different mechanism and doesn't actually use the connection.[0m
[30;1m457 | [0m[35m        if self.acquire_release_count == 0 and self.language != "python":[0m
[30;1m458 | [0m[35m            self.last_used_time = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m303 | [0m[35m                # get the latest update and see if it is a new one[0m
[30;1m304 | [0m[35m                latest_update = _find_update(pipeline)[0m
[30;1m305 | [0m[35m                if not latest_update:[0m
[30;1m306 | [0m[35m                    raise DbtRuntimeError(f"No update created for pipeline: {pipeline_id}")[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m                latest_update_id = latest_update.get("update_id", "")[0m
[30;1m309 | [0m[35m                if latest_update_id != update_id:[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m300 | [0m[35m                )[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m                # another update may have been created due to retry_on_fail settings[0m
[30;1m303 | [0m[35m                # get the latest update and see if it is a new one[0m
[30;1m304 | [0m[35m                latest_update = _find_update(pipeline)[0m
[30;1m305 | [0m[35m                if not latest_update:[0m
[30;1m306 | [0m[35m                    raise DbtRuntimeError(f"No update created for pipeline: {pipeline_id}")[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m299 | [0m[35m                    )[0m
[30;1m300 | [0m[35m                )[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m                # another update may have been created due to retry_on_fail settings[0m
[30;1m303 | [0m[35m                # get the latest update and see if it is a new one[0m
[30;1m304 | [0m[35m                latest_update = _find_update(pipeline)[0m
[30;1m305 | [0m[35m                if not latest_update:[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m282 | [0m[35m            update = _find_update(pipeline, update_id)[0m
[30;1m283 | [0m[35m            if not update:[0m
[30;1m284 | [0m[35m                raise DbtRuntimeError([0m
[30;1m285 | [0m[35m                    f"Error getting pipeline update info: {pipeline_id}, update: {update_id}"[0m
[30;1m286 | [0m[35m                )[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m            state = update.get("state")[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m            pipeline = _get_pipeline_state(session, host, pipeline_id)[0m
[30;1m281 | [0m[35m            # get the update we are currently polling[0m
[30;1m282 | [0m[35m            update = _find_update(pipeline, update_id)[0m
[30;1m283 | [0m[35m            if not update:[0m
[30;1m284 | [0m[35m                raise DbtRuntimeError([0m
[30;1m285 | [0m[35m                    f"Error getting pipeline update info: {pipeline_id}, update: {update_id}"[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m278 | [0m[35m            time.sleep(polling_interval)[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m            pipeline = _get_pipeline_state(session, host, pipeline_id)[0m
[30;1m281 | [0m[35m            # get the update we are currently polling[0m
[30;1m282 | [0m[35m            update = _find_update(pipeline, update_id)[0m
[30;1m283 | [0m[35m            if not update:[0m
[30;1m284 | [0m[35m                raise DbtRuntimeError([0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m261 | [0m[35m            raise DbtRuntimeError(f"No update created for pipeline: {pipeline_id}")[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        state = latest_update.get("state")[0m
[30;1m264 | [0m[35m        # we use update_id to retrieve the update in the polling loop[0m
[30;1m265 | [0m[35m        update_id = latest_update.get("update_id", "")[0m
[30;1m266 | [0m[35m        prev_state = state[0m
[30;1m267 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m        # get the most recently created update for the pipeline[0m
[30;1m259 | [0m[35m        latest_update = _find_update(pipeline)[0m
[30;1m260 | [0m[35m        if not latest_update:[0m
[30;1m261 | [0m[35m            raise DbtRuntimeError(f"No update created for pipeline: {pipeline_id}")[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        state = latest_update.get("state")[0m
[30;1m264 | [0m[35m        # we use update_id to retrieve the update in the polling loop[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        pipeline_id = _get_table_view_pipeline_id(session, host, model_name)[0m
[30;1m257 | [0m[35m        pipeline = _get_pipeline_state(session, host, pipeline_id)[0m
[30;1m258 | [0m[35m        # get the most recently created update for the pipeline[0m
[30;1m259 | [0m[35m        latest_update = _find_update(pipeline)[0m
[30;1m260 | [0m[35m        if not latest_update:[0m
[30;1m261 | [0m[35m            raise DbtRuntimeError(f"No update created for pipeline: {pipeline_id}")[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1191 | [0m[35m    # issue by checking.[0m
[30;1m1192 | [0m[35m    relation_name = getattr(query_header_context, "relation_name", "[unknown]")[0m
[30;1m1193 | [0m[35m[0m
[30;1m1194 | [0m[35m    # If there is no node we return the http_path for the default compute.[0m
[30;1m1195 | [0m[35m    if not query_header_context:[0m
[30;1m1196 | [0m[35m        if not USE_LONG_SESSIONS:[0m
[30;1m1197 | [0m[35m            logger.debug(f"Thread {thread_id}: using default compute resource.")[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1079 | [0m[35m            logger=logger,[0m
[30;1m1080 | [0m[35m            retryable_exceptions=retryable_exceptions,[0m
[30;1m1081 | [0m[35m            retry_limit=creds.connect_retries,[0m
[30;1m1082 | [0m[35m            retry_timeout=(timeout if timeout is not None else exponential_backoff),[0m
[30;1m1083 | [0m[35m        )[0m
[30;1m1084 | [0m[35m[0m
[30;1m1085 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1013 | [0m[35m            return connection[0m
[30;1m1014 | [0m[35m[0m
[30;1m1015 | [0m[35m        creds: DatabricksCredentials = connection.credentials[0m
[30;1m1016 | [0m[35m        timeout = creds.connect_timeout[0m
[30;1m1017 | [0m[35m[0m
[30;1m1018 | [0m[35m        # gotta keep this so we don't prompt users many times[0m
[30;1m1019 | [0m[35m        cls.credentials_provider = creds.authenticate(cls.credentials_provider)[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m938 | [0m[35m  i.e. the connection is not currently in use.[0m
[30;1m939 | [0m[35m                # However python models acquire a connection then run the pyton model, which[0m
[30;1m940 | [0m[35m                # doesn't actually use the connection. If the python model takes lone enought to[0m
[30;1m941 | [0m[35m                # run the connection can be idle long enough to timeout on the back end.[0m
[30;1m942 | [0m[35m                # If additional sql needs to be run after the python model, but before the[0m
[30;1m943 | [0m[35m                # connection is released, the connection needs to be refreshed or there will[0m
[30;1m944 | [0m[35m                # be a failure.  Making an exception when language is 'python' allows the[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m781 | [0m[35m            logger=logger,[0m
[30;1m782 | [0m[35m            retryable_exceptions=retryable_exceptions,[0m
[30;1m783 | [0m[35m            retry_limit=creds.connect_retries,[0m
[30;1m784 | [0m[35m            retry_timeout=(timeout if timeout is not None else exponential_backoff),[0m
[30;1m785 | [0m[35m        )[0m
[30;1m786 | [0m[35m[0m
[30;1m787 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m719 | [0m[35m            return connection[0m
[30;1m720 | [0m[35m[0m
[30;1m721 | [0m[35m        creds: DatabricksCredentials = connection.credentials[0m
[30;1m722 | [0m[35m        timeout = creds.connect_timeout[0m
[30;1m723 | [0m[35m[0m
[30;1m724 | [0m[35m        # gotta keep this so we don't prompt users many times[0m
[30;1m725 | [0m[35m        cls.credentials_provider = creds.authenticate(cls.credentials_provider)[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m697 | [0m[35m        cls, query_header_context: Any = None[0m
[30;1m698 | [0m[35m    ) -> Callable[[Connection], Connection]:[0m
[30;1m699 | [0m[35m        # If there is no node we can simply return the exsting class method open.[0m
[30;1m700 | [0m[35m        # If there is a node create a closure that will call cls._open with the node.[0m
[30;1m701 | [0m[35m        if not query_header_context:[0m
[30;1m702 | [0m[35m            return cls.open[0m
[30;1m703 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m696 | [0m[35m    def get_open_for_context([0m
[30;1m697 | [0m[35m        cls, query_header_context: Any = None[0m
[30;1m698 | [0m[35m    ) -> Callable[[Connection], Connection]:[0m
[30;1m699 | [0m[35m        # If there is no node we can simply return the exsting class method open.[0m
[30;1m700 | [0m[35m        # If there is a node create a closure that will call cls._open with the node.[0m
[30;1m701 | [0m[35m        if not query_header_context:[0m
[30;1m702 | [0m[35m            return cls.open[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m423 | [0m[35m    # session timing out on the back end.  However, when the connection is released we set the[0m
[30;1m424 | [0m[35m    # last_used_time, essentially indicating that the connection was in use while the python[0m
[30;1m425 | [0m[35m    # model was running. So the session is not refreshed by idle connection cleanup and errors[0m
[30;1m426 | [0m[35m    # the next time it is used.[0m
[30;1m427 | [0m[35m    language: Optional[str] = None[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m    session_id: Optional[str] = None[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m388 | [0m[35m    node_id=node.unique_id,[0m
[30;1m389 | [0m[35m  ) -%}}[0m
[30;1m390 | [0m[35m{{% else %}}[0m
[30;1m391 | [0m[35m  {{# in the node context, the connection name is the node_id #}}[0m
[30;1m392 | [0m[35m  {{%- do comment_dict.update(connection_name=connection_name) -%}}[0m
[30;1m393 | [0m[35m{{%- endif -%}}[0m
[30;1m394 | [0m[35m{{{{ return(tojson(comment_dict)) }}}}[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m383 | [0m[35m    profile_name=target.get('profile_name'),[0m
[30;1m384 | [0m[35m    target_name=target.get('target_name'),[0m
[30;1m385 | [0m[35m) -%}}[0m
[30;1m386 | [0m[35m{{%- if node is not none -%}}[0m
[30;1m387 | [0m[35m  {{%- do comment_dict.update([0m
[30;1m388 | [0m[35m    node_id=node.unique_id,[0m
[30;1m389 | [0m[35m  ) -%}}[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m        polling_interval = 10[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m        # timeout in seconds[0m
[30;1m245 | [0m[35m        timeout = 60 * 60[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m        stopped_states = ("COMPLETED", "FAILED", "CANCELED")[0m
[30;1m248 | [0m[35m        host: str = self._creds.host or ""[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m        # interval in seconds[0m
[30;1m242 | [0m[35m        polling_interval = 10[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m        # timeout in seconds[0m
[30;1m245 | [0m[35m        timeout = 60 * 60[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m        stopped_states = ("COMPLETED", "FAILED", "CANCELED")[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/connections.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport re[0m
[30;1m4 | [0m[35mimport sys[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport uuid[0m
[30;1m7 | [0m[35mimport warnings[0m
[30;1m8 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m9 | [0m[35mfrom dataclasses import dataclass[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/refresh.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m            if "cron" not in schedule:[0m
[30;1m70 | [0m[35m                raise DbtRuntimeError(f"Schedule config must contain a 'cron' key, got {schedule}")[0m
[30;1m71 | [0m[35m            return RefreshConfig([0m
[30;1m72 | [0m[35m                cron=schedule["cron"], time_zone_value=schedule.get("time_zone_value")[0m
[30;1m73 | [0m[35m            )[0m
[30;1m74 | [0m[35m        else:[0m
[30;1m75 | [0m[35m            return RefreshConfig()[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/refresh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom dbt.adapters.databricks.relation_configs.base import DatabricksComponentProcessor[0m
[30;1m11 | [0m[35mfrom dbt.adapters.relation_configs.config_base import RelationResults[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mSCHEDULE_REGEX = re.compile(r"CRON '(.*)' AT TIME ZONE '(.*)'")[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mclass RefreshConfig(DatabricksComponentConfig):[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/refresh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10 | [0m[35mfrom dbt.adapters.databricks.relation_configs.base import DatabricksComponentProcessor[0m
[30;1m11 | [0m[35mfrom dbt.adapters.relation_configs.config_base import RelationResults[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mSCHEDULE_REGEX = re.compile(r"CRON '(.*)' AT TIME ZONE '(.*)'")[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mclass RefreshConfig(DatabricksComponentConfig):[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/tblproperties.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35m{%- endmacro -%}[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m{% macro databricks__tblproperties_clause() -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m
[30;1m7 | [0m[35m  {%- if tblproperties is not none %}[0m
[30;1m8 | [0m[35m    tblproperties ([0m
[30;1m9 | [0m[35m      {%- for prop in tblproperties -%}[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/etc/statement.sql[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m    {%- set sql = caller() -%}[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m    {%- if name == 'main' -%}[0m
[30;1m7 | [0m[35m      {{ log('Writing runtime SQL for node "{}"'.format(model['unique_id'])) }}[0m
[30;1m8 | [0m[35m      {{ write(sql) }}[0m
[30;1m9 | [0m[35m    {%- endif -%}[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    @property[0m
[30;1m108 | [0m[35m    def stats(self) -> Optional[str]:[0m
[30;1m109 | [0m[35m        return self.metadata.get(KEY_TABLE_STATISTICS) if self.metadata is not None else None[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    def matches([0m
[30;1m112 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    @property[0m
[30;1m104 | [0m[35m    def owner(self) -> Optional[str]:[0m
[30;1m105 | [0m[35m        return self.metadata.get(KEY_TABLE_OWNER) if self.metadata is not None else None[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    @property[0m
[30;1m108 | [0m[35m    def stats(self) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def is_hudi(self) -> bool:[0m
[30;1m100 | [0m[35m        assert self.metadata is not None[0m
[30;1m101 | [0m[35m        return self.metadata.get(KEY_TABLE_PROVIDER) == "hudi"[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    @property[0m
[30;1m104 | [0m[35m    def owner(self) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m    @property[0m
[30;1m94 | [0m[35m    def is_delta(self) -> bool:[0m
[30;1m95 | [0m[35m        assert self.metadata is not None[0m
[30;1m96 | [0m[35m        return self.metadata.get(KEY_TABLE_PROVIDER) == "delta"[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def is_hudi(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt_databricks-2.0.0rc1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m```[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mUpgrade to the latest version[0m
[30;1m69 | [0m[35m```nofmt[0m
[30;1m70 | [0m[35mpip install --upgrade dbt-databricks[0m
[30;1m71 | [0m[35m```[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m### Profile Setup[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt_databricks-2.0.0rc1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m### Installation[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35mInstall using pip:[0m
[30;1m64 | [0m[35m```nofmt[0m
[30;1m65 | [0m[35mpip install dbt-databricks[0m
[30;1m66 | [0m[35m```[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mUpgrade to the latest version[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/logging.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35mdbt_adapter_logger = AdapterLogger("databricks-sql-connector")[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mpysql_logger = logging.getLogger("databricks.sql")[0m
[30;1m25 | [0m[35mpysql_logger_level = os.environ.get("DBT_DATABRICKS_CONNECTOR_LOG_LEVEL", "WARN").upper()[0m
[30;1m26 | [0m[35mpysql_logger.setLevel(pysql_logger_level)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mpysql_handler = DbtCoreHandler(dbt_logger=dbt_adapter_logger, level=pysql_logger_level)[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/location.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1 | [0m[35m{% macro location_clause(relation) %}[0m
[30;1m2 | [0m[35m  {%- set location_root = config.get('location_root', validator=validation.any[basestring]) -%}[0m
[30;1m3 | [0m[35m  {%- set file_format = config.get('file_format', default='delta') -%}[0m
[30;1m4 | [0m[35m  {%- set identifier = model['alias'] -%}[0m
[30;1m5 | [0m[35m  {%- if location_root is not none %}[0m
[30;1m6 | [0m[35m    location '{{ location_root }}/{{ identifier }}'[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/location.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1 | [0m[35m{% macro location_clause(relation) %}[0m
[30;1m2 | [0m[35m  {%- set location_root = config.get('location_root', validator=validation.any[basestring]) -%}[0m
[30;1m3 | [0m[35m  {%- set file_format = config.get('file_format', default='delta') -%}[0m
[30;1m4 | [0m[35m  {%- set identifier = model['alias'] -%}[0m
[30;1m5 | [0m[35m  {%- if location_root is not none %}[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/file_format.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1 | [0m[35m{% macro file_format_clause() %}[0m
[30;1m2 | [0m[35m  {%- set file_format = config.get('file_format', default='delta') -%}[0m
[30;1m3 | [0m[35m  using {{ file_format }}[0m
[30;1m4 | [0m[35m{%- endmacro -%}[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/streaming_table.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    -- `BEGIN` happens here:[0m
[30;1m73 | [0m[35m    {{ run_hooks(pre_hooks, inside_transaction=True) }}[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    {% set grant_config = config.get('grants') %}[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    {%- if build_sql is string %}[0m
[30;1m78 | [0m[35m        {% call statement(name="main") %}[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/streaming_table.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    {% else %}[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        -- get config options[0m
[30;1m34 | [0m[35m        {% set on_configuration_change = config.get('on_configuration_change') %}[0m
[30;1m35 | [0m[35m        {% set configuration_changes = get_streaming_table_configuration_changes(existing_relation, [0m
[30;1m36 | [0m[35m        {% if configuration_changes is none %}[0m
[30;1m37 | [0m[35m            {% set build_sql = refresh_streaming_table(target_relation, sql) %}[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m        {% if constraint == "not_null" %}[0m
[30;1m221 | [0m[35m          {% do dbt_constraints.append({"type": "not_null", "columns": [column.get("name")]}) %}[0m
[30;1m222 | [0m[35m        {% else %}[0m
[30;1m223 | [0m[35m          {{ exceptions.raise_compiler_error('Invalid constraint for column ' ~ column.get("name", "[0m
[30;1m224 | [0m[35m        {% endif %}[0m
[30;1m225 | [0m[35m      {% else %}[0m
[30;1m226 | [0m[35m        {% set name = constraint['name'] %}[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m    {% else %}[0m
[30;1m219 | [0m[35m      {% if column %}[0m
[30;1m220 | [0m[35m        {% if constraint == "not_null" %}[0m
[30;1m221 | [0m[35m          {% do dbt_constraints.append({"type": "not_null", "columns": [column.get("name")]}) %}[0m
[30;1m222 | [0m[35m        {% else %}[0m
[30;1m223 | [0m[35m          {{ exceptions.raise_compiler_error('Invalid constraint for column ' ~ column.get("name", "[0m
[30;1m224 | [0m[35m        {% endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m  {# convert constraints defined using the original databricks format #}[0m
[30;1m213 | [0m[35m  {% set dbt_constraints = [] %}[0m
[30;1m214 | [0m[35m  {% for constraint in constraints %}[0m
[30;1m215 | [0m[35m    {% if constraint.get and constraint.get("type") %}[0m
[30;1m216 | [0m[35m      {# already in model contract format #}[0m
[30;1m217 | [0m[35m      {% do dbt_constraints.append(constraint) %}[0m
[30;1m218 | [0m[35m    {% else %}[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m    {% endif %}[0m
[30;1m202 | [0m[35m    {% set stmt = stmt ~ ";" %}[0m
[30;1m203 | [0m[35m    {% do statements.append(stmt) %}[0m
[30;1m204 | [0m[35m  {% elif constraint.get('warn_unsupported') %}[0m
[30;1m205 | [0m[35m    {{ exceptions.warn("unsupported constraint type: " ~ constraint.type)}}[0m
[30;1m206 | [0m[35m  {% endif %}[0m
[30;1m207 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m        {% set parent = relation.schema ~ "." ~ parent%}[0m
[30;1m195 | [0m[35m      {% endif %}[0m
[30;1m196 | [0m[35m      {% set stmt = "alter table " ~ relation ~ " add constraint " ~ name ~ " foreign key(" ~ joined[0m
[30;1m197 | [0m[35m      {% set parent_columns = constraint.get("parent_columns") %}[0m
[30;1m198 | [0m[35m      {% if parent_columns %}[0m
[30;1m199 | [0m[35m        {% set stmt = stmt ~ "(" ~ parent_columns|join(", ") ~ ")"%}[0m
[30;1m200 | [0m[35m      {% endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m      {% set joined_names = quoted_names|join(", ") %}[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m      {% set parent = constraint.get("parent") %}[0m
[30;1m190 | [0m[35m      {% if not parent %}[0m
[30;1m191 | [0m[35m        {{ exceptions.raise_compiler_error('No parent table defined for foreign key: ' ~ expression)[0m
[30;1m192 | [0m[35m      {% endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m      {% endif %}[0m
[30;1m176 | [0m[35m      {% set quoted_names = [] %}[0m
[30;1m177 | [0m[35m      {% for column_name in column_names %}[0m
[30;1m178 | [0m[35m        {% set column = model.get('columns', {}).get(column_name) %}[0m
[30;1m179 | [0m[35m        {% if not column %}[0m
[30;1m180 | [0m[35m          {{ exceptions.warn('Invalid foreign key column: ' ~ column_name) }}[0m
[30;1m181 | [0m[35m        {% else %}[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m      {% endif %}[0m
[30;1m176 | [0m[35m      {% set quoted_names = [] %}[0m
[30;1m177 | [0m[35m      {% for column_name in column_names %}[0m
[30;1m178 | [0m[35m        {% set column = model.get('columns', {}).get(column_name) %}[0m
[30;1m179 | [0m[35m        {% if not column %}[0m
[30;1m180 | [0m[35m          {{ exceptions.warn('Invalid foreign key column: ' ~ column_name) }}[0m
[30;1m181 | [0m[35m        {% else %}[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m    {% if constraint.get('expression') %}[0m
[30;1m170 | [0m[35m      {% set stmt = "alter table " ~ relation ~ " add constraint " ~ name ~ " foreign key" ~ constra[0m
[30;1m171 | [0m[35m    {% else %}[0m
[30;1m172 | [0m[35m      {% set column_names = constraint.get("columns", []) %}[0m
[30;1m173 | [0m[35m      {% if column and not column_names %}[0m
[30;1m174 | [0m[35m        {% set column_names = [column['name']] %}[0m
[30;1m175 | [0m[35m      {% endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m    {% endif %}[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    {% if constraint.get('expression') %}[0m
[30;1m170 | [0m[35m      {% set stmt = "alter table " ~ relation ~ " add constraint " ~ name ~ " foreign key" ~ constra[0m
[30;1m171 | [0m[35m    {% else %}[0m
[30;1m172 | [0m[35m      {% set column_names = constraint.get("columns", []) %}[0m
[30;1m173 | [0m[35m      {% if column and not column_names %}[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m      {%- set name = local_md5("primary_key;" ~ column_names ~ ";") -%}[0m
[30;1m167 | [0m[35m    {% endif %}[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    {% if constraint.get('expression') %}[0m
[30;1m170 | [0m[35m      {% set stmt = "alter table " ~ relation ~ " add constraint " ~ name ~ " foreign key" ~ constra[0m
[30;1m171 | [0m[35m    {% else %}[0m
[30;1m172 | [0m[35m      {% set column_names = constraint.get("columns", []) %}[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m      {{ exceptions.warn("unenforced constraint type: " ~ constraint.type)}}[0m
[30;1m161 | [0m[35m    {% endif %}[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    {% set name = constraint.get("name") %}[0m
[30;1m164 | [0m[35m    {% if not name and local_md5 %}[0m
[30;1m165 | [0m[35m      {{ exceptions.warn("Constraint of type " ~ type ~ " with no `name` provided. Generating hash i[0m
[30;1m166 | [0m[35m      {%- set name = local_md5("primary_key;" ~ column_names ~ ";") -%}[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m    {% do statements.append(stmt) %}[0m
[30;1m157 | [0m[35m  {% elif type == 'foreign_key' %}[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    {% if constraint.get('warn_unenforced') %}[0m
[30;1m160 | [0m[35m      {{ exceptions.warn("unenforced constraint type: " ~ constraint.type)}}[0m
[30;1m161 | [0m[35m    {% endif %}[0m
[30;1m162 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    {% set joined_names = quoted_names|join(", ") %}[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    {% set name = constraint.get("name") %}[0m
[30;1m151 | [0m[35m    {% if not name and local_md5 %}[0m
[30;1m152 | [0m[35m      {{ exceptions.warn("Constraint of type " ~ type ~ " with no `name` provided. Generating hash i[0m
[30;1m153 | [0m[35m      {%- set name = local_md5("primary_key;" ~ column_names ~ ";") -%}[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    {% endif %}[0m
[30;1m137 | [0m[35m    {% set quoted_names = [] %}[0m
[30;1m138 | [0m[35m    {% for column_name in column_names %}[0m
[30;1m139 | [0m[35m      {% set column = model.get('columns', {}).get(column_name) %}[0m
[30;1m140 | [0m[35m      {% if not column %}[0m
[30;1m141 | [0m[35m        {{ exceptions.warn('Invalid primary key column: ' ~ column_name) }}[0m
[30;1m142 | [0m[35m      {% else %}[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    {% endif %}[0m
[30;1m137 | [0m[35m    {% set quoted_names = [] %}[0m
[30;1m138 | [0m[35m    {% for column_name in column_names %}[0m
[30;1m139 | [0m[35m      {% set column = model.get('columns', {}).get(column_name) %}[0m
[30;1m140 | [0m[35m      {% if not column %}[0m
[30;1m141 | [0m[35m        {{ exceptions.warn('Invalid primary key column: ' ~ column_name) }}[0m
[30;1m142 | [0m[35m      {% else %}[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m    {% if constraint.get('warn_unenforced') %}[0m
[30;1m131 | [0m[35m      {{ exceptions.warn("unenforced constraint type: " ~ type)}}[0m
[30;1m132 | [0m[35m    {% endif %}[0m
[30;1m133 | [0m[35m    {% set column_names = constraint.get("columns", []) %}[0m
[30;1m134 | [0m[35m    {% if column and not column_names %}[0m
[30;1m135 | [0m[35m      {% set column_names = [column['name']] %}[0m
[30;1m136 | [0m[35m    {% endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m      {% endif %}[0m
[30;1m128 | [0m[35m    {% endfor %}[0m
[30;1m129 | [0m[35m  {% elif type == 'primary_key' %}[0m
[30;1m130 | [0m[35m    {% if constraint.get('warn_unenforced') %}[0m
[30;1m131 | [0m[35m      {{ exceptions.warn("unenforced constraint type: " ~ type)}}[0m
[30;1m132 | [0m[35m    {% endif %}[0m
[30;1m133 | [0m[35m    {% set column_names = constraint.get("columns", []) %}[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m      {% set column_names = [column['name']] %}[0m
[30;1m118 | [0m[35m    {% endif %}[0m
[30;1m119 | [0m[35m    {% for column_name in column_names %}[0m
[30;1m120 | [0m[35m      {% set column = model.get('columns', {}).get(column_name) %}[0m
[30;1m121 | [0m[35m      {% if column %}[0m
[30;1m122 | [0m[35m        {% set quoted_name = adapter.quote(column['name']) if column['quote'] else column['name'] %}[0m
[30;1m123 | [0m[35m        {% set stmt = "alter table " ~ relation ~ " change column " ~ quoted_name ~ " set not null "[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m      {% set column_names = [column['name']] %}[0m
[30;1m118 | [0m[35m    {% endif %}[0m
[30;1m119 | [0m[35m    {% for column_name in column_names %}[0m
[30;1m120 | [0m[35m      {% set column = model.get('columns', {}).get(column_name) %}[0m
[30;1m121 | [0m[35m      {% if column %}[0m
[30;1m122 | [0m[35m        {% set quoted_name = adapter.quote(column['name']) if column['quote'] else column['name'] %}[0m
[30;1m123 | [0m[35m        {% set stmt = "alter table " ~ relation ~ " change column " ~ quoted_name ~ " set not null "[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m    {% set stmt = "alter table " ~ relation ~ " add constraint " ~ name ~ " check (" ~ expression ~ [0m
[30;1m113 | [0m[35m    {% do statements.append(stmt) %}[0m
[30;1m114 | [0m[35m  {% elif type == 'not_null' %}[0m
[30;1m115 | [0m[35m    {% set column_names = constraint.get("columns", []) %}[0m
[30;1m116 | [0m[35m    {% if column and not column_names %}[0m
[30;1m117 | [0m[35m      {% set column_names = [column['name']] %}[0m
[30;1m118 | [0m[35m    {% endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    {% set name = constraint.get("name") %}[0m
[30;1m108 | [0m[35m    {% if not name and local_md5 %}[0m
[30;1m109 | [0m[35m      {{ exceptions.warn("Constraint of type " ~ type ~ " with no `name` provided. Generating hash i[0m
[30;1m110 | [0m[35m      {%- set name = local_md5 (column.get("name", "") ~ ";" ~ expression ~ ";") -%}[0m
[30;1m111 | [0m[35m    {% endif %}[0m
[30;1m112 | [0m[35m    {% set stmt = "alter table " ~ relation ~ " add constraint " ~ name ~ " check (" ~ expression ~ [0m
[30;1m113 | [0m[35m    {% do statements.append(stmt) %}[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m      {{ exceptions.raise_compiler_error('Invalid check constraint expression') }}[0m
[30;1m105 | [0m[35m    {% endif %}[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    {% set name = constraint.get("name") %}[0m
[30;1m108 | [0m[35m    {% if not name and local_md5 %}[0m
[30;1m109 | [0m[35m      {{ exceptions.warn("Constraint of type " ~ type ~ " with no `name` provided. Generating hash i[0m
[30;1m110 | [0m[35m      {%- set name = local_md5 (column.get("name", "") ~ ";" ~ expression ~ ";") -%}[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m  {% set type = constraint.get("type", "") %}[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m  {% if type == 'check' %}[0m
[30;1m102 | [0m[35m    {% set expression = constraint.get("expression", "") %}[0m
[30;1m103 | [0m[35m    {% if not expression %}[0m
[30;1m104 | [0m[35m      {{ exceptions.raise_compiler_error('Invalid check constraint expression') }}[0m
[30;1m105 | [0m[35m    {% endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m{% macro get_constraint_sql(relation, constraint, model, column={}) %}[0m
[30;1m98 | [0m[35m  {% set statements = [] %}[0m
[30;1m99 | [0m[35m  {% set type = constraint.get("type", "") %}[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m  {% if type == 'check' %}[0m
[30;1m102 | [0m[35m    {% set expression = constraint.get("expression", "") %}[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m  {% set constraints = column.get('constraints', []) %}[0m
[30;1m54 | [0m[35m  {% if config.get('persist_constraints', False) and column.get('meta', {}).get('constraint') %}[0m
[30;1m55 | [0m[35m    {# Databricks constraints implementation.  Constraint is in the meta property. #}[0m
[30;1m56 | [0m[35m    {% set db_constraints = [column.get('meta', {}).get('constraint')] %}[0m
[30;1m57 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints, column) %}[0m
[30;1m58 | [0m[35m  {% endif %}[0m
[30;1m59 | [0m[35m  {{ return(constraints) }}[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m  {% set constraints = column.get('constraints', []) %}[0m
[30;1m54 | [0m[35m  {% if config.get('persist_constraints', False) and column.get('meta', {}).get('constraint') %}[0m
[30;1m55 | [0m[35m    {# Databricks constraints implementation.  Constraint is in the meta property. #}[0m
[30;1m56 | [0m[35m    {% set db_constraints = [column.get('meta', {}).get('constraint')] %}[0m
[30;1m57 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints, column) %}[0m
[30;1m58 | [0m[35m  {% endif %}[0m
[30;1m59 | [0m[35m  {{ return(constraints) }}[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m{% macro get_column_constraints(column) %}[0m
[30;1m53 | [0m[35m  {% set constraints = column.get('constraints', []) %}[0m
[30;1m54 | [0m[35m  {% if config.get('persist_constraints', False) and column.get('meta', {}).get('constraint') %}[0m
[30;1m55 | [0m[35m    {# Databricks constraints implementation.  Constraint is in the meta property. #}[0m
[30;1m56 | [0m[35m    {% set db_constraints = [column.get('meta', {}).get('constraint')] %}[0m
[30;1m57 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints, column) %}[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m{% macro get_column_constraints(column) %}[0m
[30;1m53 | [0m[35m  {% set constraints = column.get('constraints', []) %}[0m
[30;1m54 | [0m[35m  {% if config.get('persist_constraints', False) and column.get('meta', {}).get('constraint') %}[0m
[30;1m55 | [0m[35m    {# Databricks constraints implementation.  Constraint is in the meta property. #}[0m
[30;1m56 | [0m[35m    {% set db_constraints = [column.get('meta', {}).get('constraint')] %}[0m
[30;1m57 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints, column) %}[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m{% macro get_column_constraints(column) %}[0m
[30;1m53 | [0m[35m  {% set constraints = column.get('constraints', []) %}[0m
[30;1m54 | [0m[35m  {% if config.get('persist_constraints', False) and column.get('meta', {}).get('constraint') %}[0m
[30;1m55 | [0m[35m    {# Databricks constraints implementation.  Constraint is in the meta property. #}[0m
[30;1m56 | [0m[35m    {% set db_constraints = [column.get('meta', {}).get('constraint')] %}[0m
[30;1m57 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints, column) %}[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m{% endmacro %}[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m{% macro get_column_constraints(column) %}[0m
[30;1m53 | [0m[35m  {% set constraints = column.get('constraints', []) %}[0m
[30;1m54 | [0m[35m  {% if config.get('persist_constraints', False) and column.get('meta', {}).get('constraint') %}[0m
[30;1m55 | [0m[35m    {# Databricks constraints implementation.  Constraint is in the meta property. #}[0m
[30;1m56 | [0m[35m    {% set db_constraints = [column.get('meta', {}).get('constraint')] %}[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m  {% set constraints = model.get('constraints', []) %}[0m
[30;1m44 | [0m[35m  {% if config.get('persist_constraints', False) and model.get('meta', {}).get('constraints') is seq[0m
[30;1m45 | [0m[35m    {# Databricks constraints implementation.  Constraints are in the meta property. #}[0m
[30;1m46 | [0m[35m    {% set db_constraints = model.get('meta', {}).get('constraints', []) %}[0m
[30;1m47 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints) %}[0m
[30;1m48 | [0m[35m  {% endif %}[0m
[30;1m49 | [0m[35m  {{ return(constraints) }}[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m  {% set constraints = model.get('constraints', []) %}[0m
[30;1m44 | [0m[35m  {% if config.get('persist_constraints', False) and model.get('meta', {}).get('constraints') is seq[0m
[30;1m45 | [0m[35m    {# Databricks constraints implementation.  Constraints are in the meta property. #}[0m
[30;1m46 | [0m[35m    {% set db_constraints = model.get('meta', {}).get('constraints', []) %}[0m
[30;1m47 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints) %}[0m
[30;1m48 | [0m[35m  {% endif %}[0m
[30;1m49 | [0m[35m  {{ return(constraints) }}[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m{% macro get_model_constraints(model) %}[0m
[30;1m43 | [0m[35m  {% set constraints = model.get('constraints', []) %}[0m
[30;1m44 | [0m[35m  {% if config.get('persist_constraints', False) and model.get('meta', {}).get('constraints') is seq[0m
[30;1m45 | [0m[35m    {# Databricks constraints implementation.  Constraints are in the meta property. #}[0m
[30;1m46 | [0m[35m    {% set db_constraints = model.get('meta', {}).get('constraints', []) %}[0m
[30;1m47 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints) %}[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m{% macro get_model_constraints(model) %}[0m
[30;1m43 | [0m[35m  {% set constraints = model.get('constraints', []) %}[0m
[30;1m44 | [0m[35m  {% if config.get('persist_constraints', False) and model.get('meta', {}).get('constraints') is seq[0m
[30;1m45 | [0m[35m    {# Databricks constraints implementation.  Constraints are in the meta property. #}[0m
[30;1m46 | [0m[35m    {% set db_constraints = model.get('meta', {}).get('constraints', []) %}[0m
[30;1m47 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints) %}[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m{% macro get_model_constraints(model) %}[0m
[30;1m43 | [0m[35m  {% set constraints = model.get('constraints', []) %}[0m
[30;1m44 | [0m[35m  {% if config.get('persist_constraints', False) and model.get('meta', {}).get('constraints') is seq[0m
[30;1m45 | [0m[35m    {# Databricks constraints implementation.  Constraints are in the meta property. #}[0m
[30;1m46 | [0m[35m    {% set db_constraints = model.get('meta', {}).get('constraints', []) %}[0m
[30;1m47 | [0m[35m    {% set constraints = databricks_constraints_to_dbt(db_constraints) %}[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m{% endmacro %}[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m{% macro get_model_constraints(model) %}[0m
[30;1m43 | [0m[35m  {% set constraints = model.get('constraints', []) %}[0m
[30;1m44 | [0m[35m  {% if config.get('persist_constraints', False) and model.get('meta', {}).get('constraints') is seq[0m
[30;1m45 | [0m[35m    {# Databricks constraints implementation.  Constraints are in the meta property. #}[0m
[30;1m46 | [0m[35m    {% set db_constraints = model.get('meta', {}).get('constraints', []) %}[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m  {% if (has_model_contract or has_databricks_constraints) %}[0m
[30;1m12 | [0m[35m    {% if config.get('file_format', 'delta') != 'delta' %}[0m
[30;1m13 | [0m[35m      {# Constraints are only supported for delta tables #}[0m
[30;1m14 | [0m[35m      {{ exceptions.warn("Constraints not supported for file format: " ~ config.get('file_format')) [0m
[30;1m15 | [0m[35m    {% elif relation.is_view %}[0m
[30;1m16 | [0m[35m      {# Constraints are not supported for views. This point in the code should not have been reache[0m
[30;1m17 | [0m[35m      {{ exceptions.raise_compiler_error("Constraints not supported for views.") }}[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m  {% set has_databricks_constraints = config.get('persist_constraints', False) %}[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m  {% if (has_model_contract or has_databricks_constraints) %}[0m
[30;1m12 | [0m[35m    {% if config.get('file_format', 'delta') != 'delta' %}[0m
[30;1m13 | [0m[35m      {# Constraints are only supported for delta tables #}[0m
[30;1m14 | [0m[35m      {{ exceptions.warn("Constraints not supported for file format: " ~ config.get('file_format')) [0m
[30;1m15 | [0m[35m    {% elif relation.is_view %}[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35m{% macro databricks__persist_constraints(relation, model) %}[0m
[30;1m7 | [0m[35m  {%- set contract_config = config.get('contract') -%}[0m
[30;1m8 | [0m[35m  {% set has_model_contract = contract_config and contract_config.enforced %}[0m
[30;1m9 | [0m[35m  {% set has_databricks_constraints = config.get('persist_constraints', False) %}[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m  {% if (has_model_contract or has_databricks_constraints) %}[0m
[30;1m12 | [0m[35m    {% if config.get('file_format', 'delta') != 'delta' %}[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m4 | [0m[35m{% endmacro %}[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m{% macro databricks__persist_constraints(relation, model) %}[0m
[30;1m7 | [0m[35m  {%- set contract_config = config.get('contract') -%}[0m
[30;1m8 | [0m[35m  {% set has_model_contract = contract_config and contract_config.enforced %}[0m
[30;1m9 | [0m[35m  {% set has_databricks_constraints = config.get('persist_constraints', False) %}[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/constraints.sql[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35m      {{ exceptions.raise_compiler_error("Constraints not supported for views.") }}[0m
[30;1m18 | [0m[35m    {% elif is_incremental() %}[0m
[30;1m19 | [0m[35m      {# Constraints are not applied for incremental updates. This point in the code should not have[0m
[30;1m20 | [0m[35m      {{ exceptions.raise_compiler_error("Constraints are not applied for incremental updates. Full [0m
[30;1m21 | [0m[35m    {% else %}[0m
[30;1m22 | [0m[35m      {% do alter_table_add_constraints(relation, model) %}[0m
[30;1m23 | [0m[35m      {% do alter_column_set_constraints(relation, model) %}[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/streaming_table.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m            diff = diff or value[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m            if diff != RefreshConfig():[0m
[30;1m46 | [0m[35m                changes[key] = diff[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        return DatabricksRelationChangeSet(changes=changes, requires_full_refresh=requires_refresh)[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/streaming_table.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m                requires_refresh = True[0m
[30;1m43 | [0m[35m            diff = diff or value[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m            if diff != RefreshConfig():[0m
[30;1m46 | [0m[35m                changes[key] = diff[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        return DatabricksRelationChangeSet(changes=changes, requires_full_refresh=requires_refresh)[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/streaming_table.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m            diff = value.get_diff(existing.config[key])[0m
[30;1m41 | [0m[35m            if key == "partition_by" and diff is not None:[0m
[30;1m42 | [0m[35m                requires_refresh = True[0m
[30;1m43 | [0m[35m            diff = diff or value[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m            if diff != RefreshConfig():[0m
[30;1m46 | [0m[35m                changes[key] = diff[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/streaming_table.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m            diff = value.get_diff(existing.config[key])[0m
[30;1m41 | [0m[35m            if key == "partition_by" and diff is not None:[0m
[30;1m42 | [0m[35m                requires_refresh = True[0m
[30;1m43 | [0m[35m            diff = diff or value[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m            if diff != RefreshConfig():[0m
[30;1m46 | [0m[35m                changes[key] = diff[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/streaming_table.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m            key = component.name[0m
[30;1m39 | [0m[35m            value = self.config[key][0m
[30;1m40 | [0m[35m            diff = value.get_diff(existing.config[key])[0m
[30;1m41 | [0m[35m            if key == "partition_by" and diff is not None:[0m
[30;1m42 | [0m[35m                requires_refresh = True[0m
[30;1m43 | [0m[35m            diff = diff or value[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/streaming_table.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m        for component in self.config_components:[0m
[30;1m38 | [0m[35m            key = component.name[0m
[30;1m39 | [0m[35m            value = self.config[key][0m
[30;1m40 | [0m[35m            diff = value.get_diff(existing.config[key])[0m
[30;1m41 | [0m[35m            if key == "partition_by" and diff is not None:[0m
[30;1m42 | [0m[35m                requires_refresh = True[0m
[30;1m43 | [0m[35m            diff = diff or value[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/materialized_view.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    -- `BEGIN` happens here:[0m
[30;1m74 | [0m[35m    {{ run_hooks(pre_hooks, inside_transaction=True) }}[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    {% set grant_config = config.get('grants') %}[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    {%- if build_sql is string %}[0m
[30;1m79 | [0m[35m        {% call statement(name="main") %}[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/materialized_view.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    {% else %}[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        -- get config options[0m
[30;1m34 | [0m[35m        {% set on_configuration_change = config.get('on_configuration_change') %}[0m
[30;1m35 | [0m[35m        {% set configuration_changes = get_materialized_view_configuration_changes(existing_relation[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        {% if configuration_changes is none %}[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m480 | [0m[35m):[0m
[30;1m481 | [0m[35m    def check_credentials(self) -> None:[0m
[30;1m482 | [0m[35m        self.credentials.validate_creds()[0m
[30;1m483 | [0m[35m        if not self.parsed_model["config"].get("job_cluster_config", None):[0m
[30;1m484 | [0m[35m            raise ValueError([0m
[30;1m485 | [0m[35m                "`job_cluster_config` is required for the `job_cluster` submission method."[0m
[30;1m486 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m455 | [0m[35m        return self.parsed_model["config"].get([0m
[30;1m456 | [0m[35m            "cluster_id",[0m
[30;1m457 | [0m[35m            self.credentials.extract_cluster_id([0m
[30;1m458 | [0m[35m                self.parsed_model["config"].get("http_path", self.credentials.http_path)[0m
[30;1m459 | [0m[35m            ),[0m
[30;1m460 | [0m[35m        )[0m
[30;1m461 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    @property[0m
[30;1m454 | [0m[35m    def cluster_id(self) -> Optional[str]:  # type: ignore[override][0m
[30;1m455 | [0m[35m        return self.parsed_model["config"].get([0m
[30;1m456 | [0m[35m            "cluster_id",[0m
[30;1m457 | [0m[35m            self.credentials.extract_cluster_id([0m
[30;1m458 | [0m[35m                self.parsed_model["config"].get("http_path", self.credentials.http_path)[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m431 | [0m[35m            parsed_model=parsed_model, credentials=credentials  # type: ignore[arg-type][0m
[30;1m432 | [0m[35m        )[0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m        self.database = parsed_model.get("database")[0m
[30;1m435 | [0m[35m[0m
[30;1m436 | [0m[35m        user_agent = f"dbt-databricks/{version}"[0m
[30;1m437 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m382 | [0m[35m            )[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35m    def submit(self, compiled_code: str) -> None:[0m
[30;1m385 | [0m[35m        if self.parsed_model["config"].get("create_notebook", False):[0m
[30;1m386 | [0m[35m            config = {"existing_cluster_id": self.cluster_id}[0m
[30;1m387 | [0m[35m            self._submit_through_notebook(compiled_code, self._update_with_acls(config))[0m
[30;1m388 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35m[0m
[30;1m360 | [0m[35m    def status(self, context_id: str, command_id: str) -> Dict[str, Any]:[0m
[30;1m361 | [0m[35m        # https://docs.databricks.com/dev-tools/api/1.2/index.html#get-information-about-a-command[0m
[30;1m362 | [0m[35m        response = self.session.get([0m
[30;1m363 | [0m[35m            f"https://{self.host}/api/1.2/commands/status",[0m
[30;1m364 | [0m[35m            headers=self.extra_headers,[0m
[30;1m365 | [0m[35m            params={[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m    def execute(self, context_id: str, command: str) -> str:[0m
[30;1m344 | [0m[35m        # https://docs.databricks.com/dev-tools/api/1.2/index.html#run-a-command[0m
[30;1m345 | [0m[35m        response = self.session.post([0m
[30;1m346 | [0m[35m            f"https://{self.host}/api/1.2/commands/execute",[0m
[30;1m347 | [0m[35m            headers=self.extra_headers,[0m
[30;1m348 | [0m[35m            json={[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        while get_elapsed() < MAX_CLUSTER_START_TIME:[0m
[30;1m319 | [0m[35m            status_response = self.get_cluster_status()[0m
[30;1m320 | [0m[35m            if str(status_response.get("state")).lower() == "running":[0m
[30;1m321 | [0m[35m                return[0m
[30;1m322 | [0m[35m            else:[0m
[30;1m323 | [0m[35m                time.sleep(5)[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        logger.debug(f"Sending restart command for cluster id {self.cluster_id}")[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m        response = self.session.post([0m
[30;1m299 | [0m[35m            f"https://{self.host}/api/2.0/clusters/start",[0m
[30;1m300 | [0m[35m            headers=self.extra_headers,[0m
[30;1m301 | [0m[35m            json={"cluster_id": self.cluster_id},[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m    def get_cluster_status(self) -> Dict:[0m
[30;1m275 | [0m[35m        # https://docs.databricks.com/dev-tools/api/latest/clusters.html#get[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m        response = self.session.get([0m
[30;1m278 | [0m[35m            f"https://{self.host}/api/2.0/clusters/get",[0m
[30;1m279 | [0m[35m            headers=self.extra_headers,[0m
[30;1m280 | [0m[35m            json={"cluster_id": self.cluster_id},[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    def destroy(self, context_id: str) -> str:[0m
[30;1m261 | [0m[35m        # https://docs.databricks.com/dev-tools/api/1.2/index.html#delete-an-execution-context[0m
[30;1m262 | [0m[35m        response = self.session.post([0m
[30;1m263 | [0m[35m            f"https://{self.host}/api/1.2/contexts/destroy",[0m
[30;1m264 | [0m[35m            headers=self.extra_headers,[0m
[30;1m265 | [0m[35m            json={[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m        if current_status != "RUNNING":[0m
[30;1m246 | [0m[35m            self._wait_for_cluster_to_start()[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m        response = self.session.post([0m
[30;1m249 | [0m[35m            f"https://{self.host}/api/1.2/contexts/create",[0m
[30;1m250 | [0m[35m            headers=self.extra_headers,[0m
[30;1m251 | [0m[35m            json={[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m    def create(self) -> str:[0m
[30;1m237 | [0m[35m        # https://docs.databricks.com/dev-tools/api/1.2/index.html#create-an-execution-context[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m        current_status = self.get_cluster_status().get("state", "").upper()[0m
[30;1m240 | [0m[35m        if current_status in ["TERMINATED", "TERMINATING"]:[0m
[30;1m241 | [0m[35m            logger.debug(f"Cluster {self.cluster_id} is not running. Attempting to restart.")[0m
[30;1m242 | [0m[35m            self.start_cluster()[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35mclass JobClusterPythonJobHelper(BaseDatabricksHelper):[0m
[30;1m214 | [0m[35m    def check_credentials(self) -> None:[0m
[30;1m215 | [0m[35m        if not self.parsed_model["config"].get("job_cluster_config", None):[0m
[30;1m216 | [0m[35m            raise ValueError("job_cluster_config is required for commands submission method.")[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    def submit(self, compiled_code: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m        )[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m        # get end state to return to user[0m
[30;1m163 | [0m[35m        run_output = self.session.get([0m
[30;1m164 | [0m[35m            f"https://{self.credentials.host}" f"/api/2.1/jobs/runs/get-output?run_id={run_id}",[0m
[30;1m165 | [0m[35m            headers=self.extra_headers,[0m
[30;1m166 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m            libraries.append(lib)[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        job_spec.update({"libraries": libraries})  # type: ignore[0m
[30;1m128 | [0m[35m        submit_response = self.session.post([0m
[30;1m129 | [0m[35m            f"https://{self.credentials.host}/api/2.1/jobs/runs/submit",[0m
[30;1m130 | [0m[35m            headers=self.extra_headers,[0m
[30;1m131 | [0m[35m            json=job_spec,[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        index_url = self.parsed_model["config"].get("index_url", None)[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m        # additional format of packages[0m
[30;1m115 | [0m[35m        additional_libs = self.parsed_model["config"].get("additional_libs", [])[0m
[30;1m116 | [0m[35m        libraries = [][0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        for package in packages:[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        packages = self.parsed_model["config"].get("packages", [])[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        # custom index URL or default[0m
[30;1m112 | [0m[35m        index_url = self.parsed_model["config"].get("index_url", None)[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m        # additional format of packages[0m
[30;1m115 | [0m[35m        additional_libs = self.parsed_model["config"].get("additional_libs", [])[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m        job_spec.update(cluster_spec)  # updates 'new_cluster' config[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        # PYPI packages[0m
[30;1m109 | [0m[35m        packages = self.parsed_model["config"].get("packages", [])[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        # custom index URL or default[0m
[30;1m112 | [0m[35m        index_url = self.parsed_model["config"].get("index_url", None)[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def _upload_notebook(self, path: str, compiled_code: str) -> None:[0m
[30;1m84 | [0m[35m        b64_encoded_content = base64.b64encode(compiled_code.encode()).decode()[0m
[30;1m85 | [0m[35m        response = self.session.post([0m
[30;1m86 | [0m[35m            f"https://{self.credentials.host}/api/2.0/workspace/import",[0m
[30;1m87 | [0m[35m            headers=self.extra_headers,[0m
[30;1m88 | [0m[35m            json={[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m            )[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    def _update_with_acls(self, cluster_dict: dict) -> dict:[0m
[30;1m78 | [0m[35m        acl = self.parsed_model["config"].get("access_control_list", None)[0m
[30;1m79 | [0m[35m        if acl:[0m
[30;1m80 | [0m[35m            cluster_dict.update({"access_control_list": acl})[0m
[30;1m81 | [0m[35m        return cluster_dict[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        )[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    def _create_work_dir(self, path: str) -> None:[0m
[30;1m65 | [0m[35m        response = self.session.post([0m
[30;1m66 | [0m[35m            f"https://{self.credentials.host}/api/2.0/workspace/mkdirs",[0m
[30;1m67 | [0m[35m            headers=self.extra_headers,[0m
[30;1m68 | [0m[35m            json={[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m        return self.parsed_model["config"].get("cluster_id", self.credentials.cluster_id)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def get_timeout(self) -> int:[0m
[30;1m54 | [0m[35m        timeout = self.parsed_model["config"].get("timeout", DEFAULT_TIMEOUT)[0m
[30;1m55 | [0m[35m        if timeout <= 0:[0m
[30;1m56 | [0m[35m            raise ValueError("Timeout must be a positive integer")[0m
[30;1m57 | [0m[35m        return timeout[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    @property[0m
[30;1m50 | [0m[35m    def cluster_id(self) -> str:[0m
[30;1m51 | [0m[35m        return self.parsed_model["config"].get("cluster_id", self.credentials.cluster_id)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def get_timeout(self) -> int:[0m
[30;1m54 | [0m[35m        timeout = self.parsed_model["config"].get("timeout", DEFAULT_TIMEOUT)[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        timeout = self.parsed_model["config"].get("timeout", DEFAULT_TIMEOUT)[0m
[30;1m55 | [0m[35m        if timeout <= 0:[0m
[30;1m56 | [0m[35m            raise ValueError("Timeout must be a positive integer")[0m
[30;1m57 | [0m[35m        return timeout[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    def check_credentials(self) -> None:[0m
[30;1m60 | [0m[35m        raise NotImplementedError([0m
[30;1m61 | [0m[35m            "Overwrite this method to check specific requirement for current submission method"[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def get_timeout(self) -> int:[0m
[30;1m54 | [0m[35m        timeout = self.parsed_model["config"].get("timeout", DEFAULT_TIMEOUT)[0m
[30;1m55 | [0m[35m        if timeout <= 0:[0m
[30;1m56 | [0m[35m            raise ValueError("Timeout must be a positive integer")[0m
[30;1m57 | [0m[35m        return timeout[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m        return self.parsed_model["config"].get("cluster_id", self.credentials.cluster_id)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def get_timeout(self) -> int:[0m
[30;1m54 | [0m[35m        timeout = self.parsed_model["config"].get("timeout", DEFAULT_TIMEOUT)[0m
[30;1m55 | [0m[35m        if timeout <= 0:[0m
[30;1m56 | [0m[35m            raise ValueError("Timeout must be a positive integer")[0m
[30;1m57 | [0m[35m        return timeout[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport uuid[0m
[30;1m4 | [0m[35mfrom typing import Any[0m
[30;1m5 | [0m[35mfrom typing import Callable[0m
[30;1m6 | [0m[35mfrom typing import Dict[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/python_submissions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport uuid[0m
[30;1m4 | [0m[35mfrom typing import Any[0m
[30;1m5 | [0m[35mfrom typing import Callable[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/clone.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m  {%- endif -%}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m  {%- set other_existing_relation = load_cached_relation(defer_relation) -%}[0m
[30;1m30 | [0m[35m  {%- set file_format = config.get('file_format', validator=validation.any[basestring]) -%}[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m  -- If this is a database that can do zero-copy cloning of tables, and the other relation is a tabl[0m
[30;1m33 | [0m[35m  -- Otherwise, this will be a view[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/optimize.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    {%- if config.get('liquid_clustered_by', False) %}[0m
[30;1m21 | [0m[35m      {{ exceptions.warn("Both zorder and liquid_clustered_by are set but they are incompatible. zor[0m
[30;1m22 | [0m[35m    {%- else %}[0m
[30;1m23 | [0m[35m      {%- set zorder = config.get('zorder', none) %}[0m
[30;1m24 | [0m[35m      {# TODO: predicates here? WHERE ...  #}[0m
[30;1m25 | [0m[35m      {%- if zorder is sequence and zorder is not string %}[0m
[30;1m26 | [0m[35m        zorder by ([0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/optimize.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m{%- macro get_optimize_sql(relation) %}[0m
[30;1m18 | [0m[35m  optimize {{ relation }}[0m
[30;1m19 | [0m[35m  {%- if config.get('zorder', False) and config.get('file_format', 'delta') == 'delta' %}[0m
[30;1m20 | [0m[35m    {%- if config.get('liquid_clustered_by', False) %}[0m
[30;1m21 | [0m[35m      {{ exceptions.warn("Both zorder and liquid_clustered_by are set but they are incompatible. zor[0m
[30;1m22 | [0m[35m    {%- else %}[0m
[30;1m23 | [0m[35m      {%- set zorder = config.get('zorder', none) %}[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/optimize.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m{%- macro get_optimize_sql(relation) %}[0m
[30;1m18 | [0m[35m  optimize {{ relation }}[0m
[30;1m19 | [0m[35m  {%- if config.get('zorder', False) and config.get('file_format', 'delta') == 'delta' %}[0m
[30;1m20 | [0m[35m    {%- if config.get('liquid_clustered_by', False) %}[0m
[30;1m21 | [0m[35m      {{ exceptions.warn("Both zorder and liquid_clustered_by are set but they are incompatible. zor[0m
[30;1m22 | [0m[35m    {%- else %}[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/optimize.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m{%- macro get_optimize_sql(relation) %}[0m
[30;1m18 | [0m[35m  optimize {{ relation }}[0m
[30;1m19 | [0m[35m  {%- if config.get('zorder', False) and config.get('file_format', 'delta') == 'delta' %}[0m
[30;1m20 | [0m[35m    {%- if config.get('liquid_clustered_by', False) %}[0m
[30;1m21 | [0m[35m      {{ exceptions.warn("Both zorder and liquid_clustered_by are set but they are incompatible. zor[0m
[30;1m22 | [0m[35m    {%- else %}[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/optimize.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35m  {%- if var('DATABRICKS_SKIP_OPTIMIZE', 'false')|lower != 'true' and[0m
[30;1m7 | [0m[35m        var('databricks_skip_optimize', 'false')|lower != 'true' and[0m
[30;1m8 | [0m[35m        config.get('file_format', 'delta') == 'delta' -%}[0m
[30;1m9 | [0m[35m    {%- if (config.get('zorder', False) or config.get('liquid_clustered_by', False)) -%}[0m
[30;1m10 | [0m[35m      {%- call statement('run_optimize_stmt') -%}[0m
[30;1m11 | [0m[35m        {{ get_optimize_sql(relation) }}[0m
[30;1m12 | [0m[35m      {%- endcall -%}[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/optimize.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35m  {%- if var('DATABRICKS_SKIP_OPTIMIZE', 'false')|lower != 'true' and[0m
[30;1m7 | [0m[35m        var('databricks_skip_optimize', 'false')|lower != 'true' and[0m
[30;1m8 | [0m[35m        config.get('file_format', 'delta') == 'delta' -%}[0m
[30;1m9 | [0m[35m    {%- if (config.get('zorder', False) or config.get('liquid_clustered_by', False)) -%}[0m
[30;1m10 | [0m[35m      {%- call statement('run_optimize_stmt') -%}[0m
[30;1m11 | [0m[35m        {{ get_optimize_sql(relation) }}[0m
[30;1m12 | [0m[35m      {%- endcall -%}[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/optimize.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35m{%- macro databricks__optimize(relation) -%}[0m
[30;1m6 | [0m[35m  {%- if var('DATABRICKS_SKIP_OPTIMIZE', 'false')|lower != 'true' and[0m
[30;1m7 | [0m[35m        var('databricks_skip_optimize', 'false')|lower != 'true' and[0m
[30;1m8 | [0m[35m        config.get('file_format', 'delta') == 'delta' -%}[0m
[30;1m9 | [0m[35m    {%- if (config.get('zorder', False) or config.get('liquid_clustered_by', False)) -%}[0m
[30;1m10 | [0m[35m      {%- call statement('run_optimize_stmt') -%}[0m
[30;1m11 | [0m[35m        {{ get_optimize_sql(relation) }}[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/table.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m  -- setup: if the target relation already exists, drop it[0m
[30;1m18 | [0m[35m  -- in case if the existing and future table is delta, we want to do a[0m
[30;1m19 | [0m[35m  -- create or replace table instead of dropping, so we don't have the table unavailable[0m
[30;1m20 | [0m[35m  {% if old_relation and (not (old_relation.is_delta and config.get('file_format', default='delta') [0m
[30;1m21 | [0m[35m    {{ adapter.drop_relation(old_relation) }}[0m
[30;1m22 | [0m[35m  {%- endif %}[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/table.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m4 | [0m[35m  {%- set identifier = model['alias'] -%}[0m
[30;1m5 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m
[30;1m7 | [0m[35m  {%- set tags = config.get('databricks_tags') -%}[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifie[0m
[30;1m10 | [0m[35m  {%- set target_relation = api.Relation.create(identifier=identifier,[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/table.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35m  {%- set language = model['language'] -%}[0m
[30;1m4 | [0m[35m  {%- set identifier = model['alias'] -%}[0m
[30;1m5 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m
[30;1m7 | [0m[35m  {%- set tags = config.get('databricks_tags') -%}[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifie[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/table.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2 | [0m[35m  {{ log("MATERIALIZING TABLE") }}[0m
[30;1m3 | [0m[35m  {%- set language = model['language'] -%}[0m
[30;1m4 | [0m[35m  {%- set identifier = model['alias'] -%}[0m
[30;1m5 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m
[30;1m7 | [0m[35m  {%- set tags = config.get('databricks_tags') -%}[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/snapshot.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m  {%- set strategy_name = config.get('strategy') -%}[0m
[30;1m26 | [0m[35m  {%- set unique_key = config.get('unique_key') %}[0m
[30;1m27 | [0m[35m  {%- set file_format = config.get('file_format', 'delta') -%}[0m
[30;1m28 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m  {% set target_relation_exists, target_relation = databricks__get_or_create_relation([0m
[30;1m31 | [0m[35m          database=model.database,[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/snapshot.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m  {%- set strategy_name = config.get('strategy') -%}[0m
[30;1m26 | [0m[35m  {%- set unique_key = config.get('unique_key') %}[0m
[30;1m27 | [0m[35m  {%- set file_format = config.get('file_format', 'delta') -%}[0m
[30;1m28 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m  {% set target_relation_exists, target_relation = databricks__get_or_create_relation([0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/snapshot.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m  {%- set target_table = model.get('alias', model.get('name')) -%}[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m  {%- set strategy_name = config.get('strategy') -%}[0m
[30;1m26 | [0m[35m  {%- set unique_key = config.get('unique_key') %}[0m
[30;1m27 | [0m[35m  {%- set file_format = config.get('file_format', 'delta') -%}[0m
[30;1m28 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/snapshot.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m  {%- set target_table = model.get('alias', model.get('name')) -%}[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m  {%- set strategy_name = config.get('strategy') -%}[0m
[30;1m26 | [0m[35m  {%- set unique_key = config.get('unique_key') %}[0m
[30;1m27 | [0m[35m  {%- set file_format = config.get('file_format', 'delta') -%}[0m
[30;1m28 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/snapshot.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m{% materialization snapshot, adapter='databricks' %}[0m
[30;1m21 | [0m[35m  {%- set config = model['config'] -%}[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m  {%- set target_table = model.get('alias', model.get('name')) -%}[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m  {%- set strategy_name = config.get('strategy') -%}[0m
[30;1m26 | [0m[35m  {%- set unique_key = config.get('unique_key') %}[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/snapshot.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m{% materialization snapshot, adapter='databricks' %}[0m
[30;1m21 | [0m[35m  {%- set config = model['config'] -%}[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m  {%- set target_table = model.get('alias', model.get('name')) -%}[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m  {%- set strategy_name = config.get('strategy') -%}[0m
[30;1m26 | [0m[35m  {%- set unique_key = config.get('unique_key') %}[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/tblproperties.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    @classmethod[0m
[30;1m50 | [0m[35m    def from_relation_results(cls, results: RelationResults) -> TblPropertiesConfig:[0m
[30;1m51 | [0m[35m        table = results.get("show_tblproperties")[0m
[30;1m52 | [0m[35m        tblproperties = dict()[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        if table:[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/materialized_view.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m            diff = value.get_diff(existing.config[key])[0m
[30;1m43 | [0m[35m            if diff:[0m
[30;1m44 | [0m[35m                requires_refresh = requires_refresh or key != "refresh"[0m
[30;1m45 | [0m[35m                changes[key] = diff[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        if len(changes) > 0:[0m
[30;1m48 | [0m[35m            return DatabricksRelationChangeSet([0m
[30;1m49 | [0m[35m                changes=changes, requires_full_refresh=requires_refresh[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/materialized_view.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m        for component in self.config_components:[0m
[30;1m40 | [0m[35m            key = component.name[0m
[30;1m41 | [0m[35m            value = self.config[key][0m
[30;1m42 | [0m[35m            diff = value.get_diff(existing.config[key])[0m
[30;1m43 | [0m[35m            if diff:[0m
[30;1m44 | [0m[35m                requires_refresh = requires_refresh or key != "refresh"[0m
[30;1m45 | [0m[35m                changes[key] = diff[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    materialization_config = config.config[0m
[30;1m153 | [0m[35m    if materialization_config:[0m
[30;1m154 | [0m[35m        return materialization_config.extra.get(key)[0m
[30;1m155 | [0m[35m    return None[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/view.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35m      identifier=identifier, schema=schema, database=database,[0m
[30;1m9 | [0m[35m      type='view') -%}[0m
[30;1m10 | [0m[35m  {% set grant_config = config.get('grants') %}[0m
[30;1m11 | [0m[35m  {% set tags = config.get('databricks_tags') %}[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m  {{ run_hooks(pre_hooks) }}[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/view.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m7 | [0m[35m  {%- set target_relation = api.Relation.create([0m
[30;1m8 | [0m[35m      identifier=identifier, schema=schema, database=database,[0m
[30;1m9 | [0m[35m      type='view') -%}[0m
[30;1m10 | [0m[35m  {% set grant_config = config.get('grants') %}[0m
[30;1m11 | [0m[35m  {% set tags = config.get('databricks_tags') %}[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m  {{ run_hooks(pre_hooks) }}[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/strategies.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m  {%- set source_columns = (adapter.get_columns_in_relation(source) | map(attribute='quoted') | list[0m
[30;1m77 | [0m[35m  {%- set merge_update_columns = config.get('merge_update_columns') -%}[0m
[30;1m78 | [0m[35m  {%- set merge_exclude_columns = config.get('merge_exclude_columns') -%}[0m
[30;1m79 | [0m[35m  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), d[0m
[30;1m80 | [0m[35m  {%- set update_columns = get_merge_update_columns(merge_update_columns, merge_exclude_columns, des[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m  {% if unique_key %}[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/strategies.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m  {%- set dest_columns = adapter.get_columns_in_relation(target) -%}[0m
[30;1m76 | [0m[35m  {%- set source_columns = (adapter.get_columns_in_relation(source) | map(attribute='quoted') | list[0m
[30;1m77 | [0m[35m  {%- set merge_update_columns = config.get('merge_update_columns') -%}[0m
[30;1m78 | [0m[35m  {%- set merge_exclude_columns = config.get('merge_exclude_columns') -%}[0m
[30;1m79 | [0m[35m  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), d[0m
[30;1m80 | [0m[35m  {%- set update_columns = get_merge_update_columns(merge_update_columns, merge_exclude_columns, des[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/strategies.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35mpredicates = [] if incremental_predicates is none else [] + incremental_predicates -%}[0m
[30;1m75 | [0m[35m  {%- set dest_columns = adapter.get_columns_in_relation(target) -%}[0m
[30;1m76 | [0m[35m  {%- set source_columns = (adapter.get_columns_in_relation(source) | map(attribute='quoted') | list[0m
[30;1m77 | [0m[35m  {%- set merge_update_columns = config.get('merge_update_columns') -%}[0m
[30;1m78 | [0m[35m  {%- set merge_exclude_columns = config.get('merge_exclude_columns') -%}[0m
[30;1m79 | [0m[35m  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), d[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/strategies.sql[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m100 | [0m[35m  merge into {{ target }} as DBT_INTERNAL_DEST[0m
[30;1m101 | [0m[35m      using {{ source }} as DBT_INTERNAL_SOURCE[0m
[30;1m102 | [0m[35m      on {{ predicates | join(' and ') }}[0m
[30;1m103 | [0m[35m      when matched then update set {{ get_merge_update_set(update_columns, on_schema_change, source_[0m
[30;1m104 | [0m[35m      when not matched then insert {{ get_merge_insert(on_schema_change, source_columns) }}[0m
[30;1m105 | [0m[35m{% endmacro %}[0m
[30;1m106 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/seeds/helpers.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m    create table {{ this.render() }} ([0m
[30;1m56 | [0m[35m        {%- for col_name in agate_table.column_names -%}[0m
[30;1m57 | [0m[35m            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}[0m
[30;1m58 | [0m[35m            {%- set type = column_override.get(col_name, inferred_type) -%}[0m
[30;1m59 | [0m[35m            {%- set column_name = (col_name | string) -%}[0m
[30;1m60 | [0m[35m            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not lo[0m
[30;1m61 | [0m[35m        {%- endfor -%}[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/seeds/helpers.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m{% macro databricks__create_csv_table(model, agate_table) %}[0m
[30;1m49 | [0m[35m  {%- set column_override = model['config'].get('column_types', {}) -%}[0m
[30;1m50 | [0m[35m  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}[0m
[30;1m51 | [0m[35m  {%- set identifier = model['alias'] -%}[0m
[30;1m52 | [0m[35m  {%- set relation = api.Relation.create(database=database, schema=schema, identifier=identifier, ty[0m
[30;1m53 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/seeds/helpers.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m{% endmacro %}[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m{% macro databricks__create_csv_table(model, agate_table) %}[0m
[30;1m49 | [0m[35m  {%- set column_override = model['config'].get('column_types', {}) -%}[0m
[30;1m50 | [0m[35m  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}[0m
[30;1m51 | [0m[35m  {%- set identifier = model['alias'] -%}[0m
[30;1m52 | [0m[35m  {%- set relation = api.Relation.create(database=database, schema=schema, identifier=identifier, ty[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/seeds/helpers.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m              ({%- for col_name in agate_table.column_names -%}[0m
[30;1m24 | [0m[35m                  {%- if must_cast -%}[0m
[30;1m25 | [0m[35m                    {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}[0m
[30;1m26 | [0m[35m                    {%- set type = column_override.get(col_name, inferred_type) -%}[0m
[30;1m27 | [0m[35m                    cast({{ get_binding_char() }} as {{type}})[0m
[30;1m28 | [0m[35m                  {%- else -%}[0m
[30;1m29 | [0m[35m                    {{ get_binding_char() }}[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/seeds/helpers.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m  {% set batch_size = get_batch_size() %}[0m
[30;1m8 | [0m[35m  {% set column_override = model['config'].get('column_types', {}) %}[0m
[30;1m9 | [0m[35m  {% set must_cast = model['config'].get("file_format", "delta") == "parquet" %}[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m  {% set statements = [] %}[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/seeds/helpers.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35m{% macro databricks__load_csv_rows(model, agate_table) %}[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m  {% set batch_size = get_batch_size() %}[0m
[30;1m8 | [0m[35m  {% set column_override = model['config'].get('column_types', {}) %}[0m
[30;1m9 | [0m[35m  {% set must_cast = model['config'].get("file_format", "delta") == "parquet" %}[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m  {% set statements = [] %}[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/incremental.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m            value = self.config[key][0m
[30;1m21 | [0m[35m            diff = value.get_diff(existing.config[key])[0m
[30;1m22 | [0m[35m            if diff:[0m
[30;1m23 | [0m[35m                changes[key] = diff[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m        if len(changes) > 0:[0m
[30;1m26 | [0m[35m            return DatabricksRelationChangeSet(changes=changes, requires_full_refresh=False)[0m
[30;1m27 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/incremental.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m        for component in self.config_components:[0m
[30;1m19 | [0m[35m            key = component.name[0m
[30;1m20 | [0m[35m            value = self.config[key][0m
[30;1m21 | [0m[35m            diff = value.get_diff(existing.config[key])[0m
[30;1m22 | [0m[35m            if diff:[0m
[30;1m23 | [0m[35m                changes[key] = diff[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/relations/view/create.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m    {% endif %}[0m
[30;1m11 | [0m[35m  {% endif %}[0m
[30;1m12 | [0m[35m  {{ comment_clause() }}[0m
[30;1m13 | [0m[35m  {%- set contract_config = config.get('contract') -%}[0m
[30;1m14 | [0m[35m  {% if contract_config and contract_config.enforced %}[0m
[30;1m15 | [0m[35m    {{ get_assert_columns_equivalent(sql) }}[0m
[30;1m16 | [0m[35m  {%- endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/seeds/seeds.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m  {%- set exists_as_view = (old_relation is not none and (old_relation.is_view or old_relation.is_ma[0m
[30;1m10 | [0m[35m  {%- set exists_as_streaming_table = (old_relation is not none and old_relation.is_streaming_table)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m13 | [0m[35m  {%- set agate_table = load_agate_table() -%}[0m
[30;1m14 | [0m[35m  -- grab current tables grants config for comparision later on[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m  {%- set unique_key = config.get('unique_key', none) -%}[0m
[30;1m16 | [0m[35m  {%- set partition_by = config.get('partition_by', none) -%}[0m
[30;1m17 | [0m[35m  {%- set language = model['language'] -%}[0m
[30;1m18 | [0m[35m  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), d[0m
[30;1m19 | [0m[35m  {%- set target_relation = this.incorporate(type='table') -%}[0m
[30;1m20 | [0m[35m  {%- set existing_relation = adapter.get_relation(database=this.database, schema=this.schema, ident[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m  {%- set incremental_predicates = config.get('predicates', default=none) or config.get('incremental[0m
[30;1m15 | [0m[35m  {%- set unique_key = config.get('unique_key', none) -%}[0m
[30;1m16 | [0m[35m  {%- set partition_by = config.get('partition_by', none) -%}[0m
[30;1m17 | [0m[35m  {%- set language = model['language'] -%}[0m
[30;1m18 | [0m[35m  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), d[0m
[30;1m19 | [0m[35m  {%- set target_relation = this.incorporate(type='table') -%}[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m  {#-- Set vars --#}[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m  {%- set incremental_predicates = config.get('predicates', default=none) or config.get('incremental[0m
[30;1m15 | [0m[35m  {%- set unique_key = config.get('unique_key', none) -%}[0m
[30;1m16 | [0m[35m  {%- set partition_by = config.get('partition_by', none) -%}[0m
[30;1m17 | [0m[35m  {%- set language = model['language'] -%}[0m
[30;1m18 | [0m[35m  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), d[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m  {#-- Set vars --#}[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m  {%- set incremental_predicates = config.get('predicates', default=none) or config.get('incremental[0m
[30;1m15 | [0m[35m  {%- set unique_key = config.get('unique_key', none) -%}[0m
[30;1m16 | [0m[35m  {%- set partition_by = config.get('partition_by', none) -%}[0m
[30;1m17 | [0m[35m  {%- set language = model['language'] -%}[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m  {#-- Set vars --#}[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m  {%- set incremental_predicates = config.get('predicates', default=none) or config.get('incremental[0m
[30;1m15 | [0m[35m  {%- set unique_key = config.get('unique_key', none) -%}[0m
[30;1m16 | [0m[35m  {%- set partition_by = config.get('partition_by', none) -%}[0m
[30;1m17 | [0m[35m  {%- set language = model['language'] -%}[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m4 | [0m[35m  {%- set raw_strategy = config.get('incremental_strategy') or 'merge' -%}[0m
[30;1m5 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m
[30;1m7 | [0m[35m  {%- set tags = config.get('databricks_tags') -%}[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m  {%- set file_format = dbt_databricks_validate_get_file_format(raw_file_format) -%}[0m
[30;1m10 | [0m[35m  {%- set incremental_strategy = dbt_databricks_validate_get_incremental_strategy(raw_strategy, file[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35m  {%- set raw_file_format = config.get('file_format', default='delta') -%}[0m
[30;1m4 | [0m[35m  {%- set raw_strategy = config.get('incremental_strategy') or 'merge' -%}[0m
[30;1m5 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m
[30;1m7 | [0m[35m  {%- set tags = config.get('databricks_tags') -%}[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m  {%- set file_format = dbt_databricks_validate_get_file_format(raw_file_format) -%}[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2 | [0m[35m  {#-- Validate early so we don't run SQL if the file_format + strategy combo is invalid --#}[0m
[30;1m3 | [0m[35m  {%- set raw_file_format = config.get('file_format', default='delta') -%}[0m
[30;1m4 | [0m[35m  {%- set raw_strategy = config.get('incremental_strategy') or 'merge' -%}[0m
[30;1m5 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m
[30;1m7 | [0m[35m  {%- set tags = config.get('databricks_tags') -%}[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1 | [0m[35m{% materialization incremental, adapter='databricks', supported_languages=['sql', 'python'] -%}[0m
[30;1m2 | [0m[35m  {#-- Validate early so we don't run SQL if the file_format + strategy combo is invalid --#}[0m
[30;1m3 | [0m[35m  {%- set raw_file_format = config.get('file_format', default='delta') -%}[0m
[30;1m4 | [0m[35m  {%- set raw_strategy = config.get('incremental_strategy') or 'merge' -%}[0m
[30;1m5 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m
[30;1m7 | [0m[35m  {%- set tags = config.get('databricks_tags') -%}[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/include/databricks/macros/materializations/incremental/incremental.sql[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1 | [0m[35m{% materialization incremental, adapter='databricks', supported_languages=['sql', 'python'] -%}[0m
[30;1m2 | [0m[35m  {#-- Validate early so we don't run SQL if the file_format + strategy combo is invalid --#}[0m
[30;1m3 | [0m[35m  {%- set raw_file_format = config.get('file_format', default='delta') -%}[0m
[30;1m4 | [0m[35m  {%- set raw_strategy = config.get('incremental_strategy') or 'merge' -%}[0m
[30;1m5 | [0m[35m  {%- set grant_config = config.get('grants') -%}[0m
[30;1m6 | [0m[35m  {%- set tblproperties = config.get('tblproperties') -%}[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m294[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbt/adapters/databricks/relation_configs/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    @classmethod[0m
[30;1m32 | [0m[35m    def from_relation_results(cls, results: RelationResults) -> TagsConfig:[0m
[30;1m33 | [0m[35m        table = results.get("information_schema.tags")[0m
[30;1m34 | [0m[35m        tags = dict()[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        if table:[0m

294 matches found.
