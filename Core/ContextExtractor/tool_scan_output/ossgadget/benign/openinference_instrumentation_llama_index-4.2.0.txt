[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_config.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m399 | [0m[35mJhYtuVpzJwVcXsVNMkYzmHZfx+mN6WOnfBezKi63XidcaSQ9AbNPGbqEfWhCaQ+W6wWiBFflABx4fXiUorBJzwCSnoVOnqD0WbBa[0m
[30;1m400 | [0m[35m    return f"data:image/jpeg;base64,{base64_str}"[0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m@pytest.fixture(scope="module")[0m
[30;1m404 | [0m[35mdef in_memory_span_exporter() -> InMemorySpanExporter:[0m
[30;1m405 | [0m[35m    return InMemorySpanExporter()[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m[0m
[30;1m408 | [0m[35m@pytest.fixture(scope="module")[0m
[30;1m409 | [0m[35mdef tracer_provider([0m
[30;1m410 | [0m[35m    in_memory_span_exporter: InMemorySpanExporter,[0m
[30;1m411 | [0m[35m) -> trace_api.TracerProvider:[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1130 | [0m[35m[0m
[30;1m1131 | [0m[35m[0m
[30;1m1132 | [0m[35mdef is_base64_url(url: str) -> bool:[0m
[30;1m1133 | [0m[35m    return url.startswith("data:image/") and "base64" in url[0m
[30;1m1134 | [0m[35m[0m
[30;1m1135 | [0m[35m[0m
[30;1m1136 | [0m[35mDOCUMENT_CONTENT = DocumentAttributes.DOCUMENT_CONTENT[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m679 | [0m[35m    prefix: str = "",[0m
[30;1m680 | [0m[35m) -> Iterator[Tuple[str, AttributeValue]]:[0m
[30;1m681 | [0m[35m    if obj.image and obj.image_mimetype:[0m
[30;1m682 | [0m[35m        url = f"data:{obj.image_mimetype};base64,{obj.image.decode()}"[0m
[30;1m683 | [0m[35m        yield f"{prefix}{MESSAGE_CONTENT_IMAGE}.{IMAGE_URL}", url[0m
[30;1m684 | [0m[35m        yield f"{prefix}{MESSAGE_CONTENT_TYPE}", "image"[0m
[30;1m685 | [0m[35m    elif obj.url:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_message_content_blocks.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m36 | [0m[35m    assert len(attributes) == 2[0m
[30;1m37 | [0m[35m    assert ([0m
[30;1m38 | [0m[35m        attributes[f"{MESSAGE_CONTENT_IMAGE}.{IMAGE_URL}"][0m
[30;1m39 | [0m[35m        == f"data:image/jpeg;base64,{base64.b64encode(image_data).decode()}"[0m
[30;1m40 | [0m[35m    )[0m
[30;1m41 | [0m[35m    assert attributes[f"{MESSAGE_CONTENT_TYPE}"] == "image"[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_message_content_blocks.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m36 | [0m[35m    assert len(attributes) == 2[0m
[30;1m37 | [0m[35m    assert ([0m
[30;1m38 | [0m[35m        attributes[f"{MESSAGE_CONTENT_IMAGE}.{IMAGE_URL}"][0m
[30;1m39 | [0m[35m        == f"data:image/jpeg;base64,{base64.b64encode(image_data).decode()}"[0m
[30;1m40 | [0m[35m    )[0m
[30;1m41 | [0m[35m    assert attributes[f"{MESSAGE_CONTENT_TYPE}"] == "image"[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_message_content_blocks.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom llama_index.core.base.llms.types import ImageBlock, TextBlock[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m        }[0m
[30;1m112 | [0m[35m    )[0m
[30;1m113 | [0m[35m    url = "https://api.openai.com/v1/chat/completions"[0m
[30;1m114 | [0m[35m    respx_mock.post(url).mock(return_value=Response(status_code=status_code, **respx_kwargs))[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    async def task() -> None:[0m
[30;1m117 | [0m[35m        await asyncio.gather([0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m                if hide_images:[0m
[30;1m362 | [0m[35m                    assert content_item_image_url is None[0m
[30;1m363 | [0m[35m                else:[0m
[30;1m364 | [0m[35m                    expected_url = expected_content_item.get("image_url").get("url")[0m
[30;1m365 | [0m[35m                    if image_limit is not None and len(expected_url) > image_limit:[0m
[30;1m366 | [0m[35m                        assert content_item_image_url == REDACTED_VALUE[0m
[30;1m367 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m                if hide_images:[0m
[30;1m362 | [0m[35m                    assert content_item_image_url is None[0m
[30;1m363 | [0m[35m                else:[0m
[30;1m364 | [0m[35m                    expected_url = expected_content_item.get("image_url").get("url")[0m
[30;1m365 | [0m[35m                    if image_limit is not None and len(expected_url) > image_limit:[0m
[30;1m366 | [0m[35m                        assert content_item_image_url == REDACTED_VALUE[0m
[30;1m367 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m                if hide_text:[0m
[30;1m354 | [0m[35m                    assert content_item_text == REDACTED_VALUE[0m
[30;1m355 | [0m[35m                else:[0m
[30;1m356 | [0m[35m                    assert content_item_text == expected_content_item.get("text")[0m
[30;1m357 | [0m[35m            elif content_item_type == "image":[0m
[30;1m358 | [0m[35m                content_item_image_url = attributes.pop([0m
[30;1m359 | [0m[35m                    message_contents_image_url(prefix, i, j), None[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m    if isinstance(expected_content, list):[0m
[30;1m345 | [0m[35m        for j, expected_content_item in enumerate(expected_content):[0m
[30;1m346 | [0m[35m            content_item_type = attributes.pop(message_contents_type(prefix, i, j), None)[0m
[30;1m347 | [0m[35m            expected_content_item_type = expected_content_item.get("type")[0m
[30;1m348 | [0m[35m            if expected_content_item_type == "image_url":[0m
[30;1m349 | [0m[35m                expected_content_item_type = "image"[0m
[30;1m350 | [0m[35m            assert content_item_type == expected_content_item_type[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m        }[0m
[30;1m258 | [0m[35m    }[0m
[30;1m259 | [0m[35m    url = "https://api.openai.com/v1/chat/completions"[0m
[30;1m260 | [0m[35m    respx_mock.post(url).mock(return_value=Response(status_code=200, **respx_kwargs))[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m    def chat(message: ChatMessage) -> None:[0m
[30;1m263 | [0m[35m        _ = llm.chat([message])[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m        }[0m
[30;1m126 | [0m[35m    }[0m
[30;1m127 | [0m[35m    url = "https://api.openai.com/v1/chat/completions"[0m
[30;1m128 | [0m[35m    respx_mock.post(url).mock(return_value=Response(status_code=200, **respx_kwargs))[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    def chat(message: ChatMessage) -> None:[0m
[30;1m131 | [0m[35m        _ = llm.chat([message])[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m919 | [0m[35m    usage_mapping: Mapping[str, Any],[0m
[30;1m920 | [0m[35m) -> Iterator[Tuple[str, Any]]:[0m
[30;1m921 | [0m[35m    def get_value(obj: Mapping[str, Any], key: str) -> Any:[0m
[30;1m922 | [0m[35m        return obj.get(key)[0m
[30;1m923 | [0m[35m[0m
[30;1m924 | [0m[35m    yield from _get_token_counts_impl(usage_mapping, get_value)[0m
[30;1m925 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m887 | [0m[35m            yield TOOL_CALL_ID, tool_call_id[0m
[30;1m888 | [0m[35m        if name := tool_call.get("name"):[0m
[30;1m889 | [0m[35m            yield TOOL_CALL_FUNCTION_NAME, name[0m
[30;1m890 | [0m[35m        if arguments := tool_call.get("input"):[0m
[30;1m891 | [0m[35m            if isinstance(arguments, str):[0m
[30;1m892 | [0m[35m                yield TOOL_CALL_FUNCTION_ARGUMENTS_JSON, arguments[0m
[30;1m893 | [0m[35m            elif isinstance(arguments, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m885 | [0m[35m    if isinstance(tool_call, dict):[0m
[30;1m886 | [0m[35m        if tool_call_id := tool_call.get("id"):[0m
[30;1m887 | [0m[35m            yield TOOL_CALL_ID, tool_call_id[0m
[30;1m888 | [0m[35m        if name := tool_call.get("name"):[0m
[30;1m889 | [0m[35m            yield TOOL_CALL_FUNCTION_NAME, name[0m
[30;1m890 | [0m[35m        if arguments := tool_call.get("input"):[0m
[30;1m891 | [0m[35m            if isinstance(arguments, str):[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m883 | [0m[35m[0m
[30;1m884 | [0m[35mdef _get_tool_call(tool_call: object) -> Iterator[Tuple[str, Any]]:[0m
[30;1m885 | [0m[35m    if isinstance(tool_call, dict):[0m
[30;1m886 | [0m[35m        if tool_call_id := tool_call.get("id"):[0m
[30;1m887 | [0m[35m            yield TOOL_CALL_ID, tool_call_id[0m
[30;1m888 | [0m[35m        if name := tool_call.get("name"):[0m
[30;1m889 | [0m[35m            yield TOOL_CALL_FUNCTION_NAME, name[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m867 | [0m[35m            return None[0m
[30;1m868 | [0m[35m        if not event.span_id:[0m
[30;1m869 | [0m[35m            return event[0m
[30;1m870 | [0m[35m        span = self._span_handler.open_spans.get(event.span_id)[0m
[30;1m871 | [0m[35m        if span is None:[0m
[30;1m872 | [0m[35m            span = self._span_handler._export_queue.find(event.span_id)[0m
[30;1m873 | [0m[35m        if span is None:[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m844 | [0m[35m        if context_api.get_value(_SUPPRESS_INSTRUMENTATION_KEY):[0m
[30;1m845 | [0m[35m            return None[0m
[30;1m846 | [0m[35m        with self.lock:[0m
[30;1m847 | [0m[35m            span = self.open_spans.get(id_)[0m
[30;1m848 | [0m[35m        if span:[0m
[30;1m849 | [0m[35m            if err and isinstance(err, WorkflowDone):[0m
[30;1m850 | [0m[35m                span.end()[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m816 | [0m[35m        if context_api.get_value(_SUPPRESS_INSTRUMENTATION_KEY):[0m
[30;1m817 | [0m[35m            return None[0m
[30;1m818 | [0m[35m        with self.lock:[0m
[30;1m819 | [0m[35m            span = self.open_spans.get(id_)[0m
[30;1m820 | [0m[35m        if span:[0m
[30;1m821 | [0m[35m            if isinstance(instance, (BaseLLM, MultiModalLLM)) and ([0m
[30;1m822 | [0m[35m                isinstance(result, Generator)[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m783 | [0m[35m        if context_api.get_value(_SUPPRESS_INSTRUMENTATION_KEY):[0m
[30;1m784 | [0m[35m            return None[0m
[30;1m785 | [0m[35m        with self.lock:[0m
[30;1m786 | [0m[35m            parent = self.open_spans.get(parent_span_id) if parent_span_id else None[0m
[30;1m787 | [0m[35m        otel_span = self._otel_tracer.start_span([0m
[30;1m788 | [0m[35m            name=id_.partition("-")[0],[0m
[30;1m789 | [0m[35m            start_time=time_ns(),[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m730 | [0m[35m        while True:[0m
[30;1m731 | [0m[35m            t = time()[0m
[30;1m732 | [0m[35m            while not q.empty():[0m
[30;1m733 | [0m[35m                if (item := q.get()) is END_OF_QUEUE:[0m
[30;1m734 | [0m[35m                    return[0m
[30;1m735 | [0m[35m                if t == item.last_touched_at:[0m
[30;1m736 | [0m[35m                    # we have gone through the whole list[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m720 | [0m[35m[0m
[30;1m721 | [0m[35m    def find(self, id_: str) -> Optional[_Span]:[0m
[30;1m722 | [0m[35m        with self.lock:[0m
[30;1m723 | [0m[35m            return self.spans.get(id_)[0m
[30;1m724 | [0m[35m[0m
[30;1m725 | [0m[35m    def _del(self, item: _QueueItem) -> None:[0m
[30;1m726 | [0m[35m        with self.lock:[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m652 | [0m[35m        self,[0m
[30;1m653 | [0m[35m        image: Mapping[str, Any],[0m
[30;1m654 | [0m[35m    ) -> Iterator[Tuple[str, AttributeValue]]:[0m
[30;1m655 | [0m[35m        if url := image.get("url"):[0m
[30;1m656 | [0m[35m            yield f"{ImageAttributes.IMAGE_URL}", url[0m
[30;1m657 | [0m[35m[0m
[30;1m658 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m637 | [0m[35m        content: Mapping[str, Any],[0m
[30;1m638 | [0m[35m    ) -> Iterator[Tuple[str, AttributeValue]]:[0m
[30;1m639 | [0m[35m        content = dict(content)[0m
[30;1m640 | [0m[35m        type_ = content.get("type")[0m
[30;1m641 | [0m[35m        if type_ == "text":[0m
[30;1m642 | [0m[35m            yield f"{MessageContentAttributes.MESSAGE_CONTENT_TYPE}", "text"[0m
[30;1m643 | [0m[35m            if text := content.pop("text"):[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m                for j, tool_call in enumerate(tool_calls):[0m
[30;1m589 | [0m[35m                    for k, v in _get_tool_call(tool_call):[0m
[30;1m590 | [0m[35m                        self[f"{prefix}.{i}.{MESSAGE_TOOL_CALLS}.{j}.{k}"] = v[0m
[30;1m591 | [0m[35m            if tool_call_id := additional_kwargs.get("tool_call_id"):[0m
[30;1m592 | [0m[35m                self[f"{prefix}.{i}.{MESSAGE_TOOL_CALL_ID}"] = tool_call_id[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m    def _process_query_type(self, query: Optional[QueryType]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m            additional_kwargs = message.additional_kwargs[0m
[30;1m585 | [0m[35m            if name := additional_kwargs.get("name"):[0m
[30;1m586 | [0m[35m                self[f"{prefix}.{i}.{MESSAGE_NAME}"] = name[0m
[30;1m587 | [0m[35m            if tool_calls := additional_kwargs.get("tool_calls"):[0m
[30;1m588 | [0m[35m                for j, tool_call in enumerate(tool_calls):[0m
[30;1m589 | [0m[35m                    for k, v in _get_tool_call(tool_call):[0m
[30;1m590 | [0m[35m                        self[f"{prefix}.{i}.{MESSAGE_TOOL_CALLS}.{j}.{k}"] = v[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m582 | [0m[35m                    ):[0m
[30;1m583 | [0m[35m                        self[k] = v[0m
[30;1m584 | [0m[35m            additional_kwargs = message.additional_kwargs[0m
[30;1m585 | [0m[35m            if name := additional_kwargs.get("name"):[0m
[30;1m586 | [0m[35m                self[f"{prefix}.{i}.{MESSAGE_NAME}"] = name[0m
[30;1m587 | [0m[35m            if tool_calls := additional_kwargs.get("tool_calls"):[0m
[30;1m588 | [0m[35m                for j, tool_call in enumerate(tool_calls):[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m544 | [0m[35m                and hasattr(model_extra, "get")[0m
[30;1m545 | [0m[35m                and (x_groq := model_extra.get("x_groq"))[0m
[30;1m546 | [0m[35m                and hasattr(x_groq, "get")[0m
[30;1m547 | [0m[35m                and (usage := x_groq.get("usage"))[0m
[30;1m548 | [0m[35m            ):[0m
[30;1m549 | [0m[35m                for k, v in _get_token_counts(usage):[0m
[30;1m550 | [0m[35m                    self[k] = v[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m            if ([0m
[30;1m543 | [0m[35m                (model_extra := getattr(raw, "model_extra", None))[0m
[30;1m544 | [0m[35m                and hasattr(model_extra, "get")[0m
[30;1m545 | [0m[35m                and (x_groq := model_extra.get("x_groq"))[0m
[30;1m546 | [0m[35m                and hasattr(x_groq, "get")[0m
[30;1m547 | [0m[35m                and (usage := x_groq.get("usage"))[0m
[30;1m548 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m    def _extract_token_counts(self, response: Union[ChatResponse, CompletionResponse]) -> None:[0m
[30;1m537 | [0m[35m        if raw := getattr(response, "raw", None):[0m
[30;1m538 | [0m[35m            usage = raw.get("usage") if isinstance(raw, Mapping) else getattr(raw, "usage", None)[0m
[30;1m539 | [0m[35m            if usage:[0m
[30;1m540 | [0m[35m                for k, v in _get_token_counts(usage):[0m
[30;1m541 | [0m[35m                    self[k] = v[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m        template_arguments = {[0m
[30;1m408 | [0m[35m            variable_name: argument_value[0m
[30;1m409 | [0m[35m            for variable_name in variable_names[0m
[30;1m410 | [0m[35m            if (argument_value := argument_values.get(variable_name)) is not None[0m
[30;1m411 | [0m[35m        }[0m
[30;1m412 | [0m[35m        if template_arguments:[0m
[30;1m413 | [0m[35m            self[LLM_PROMPT_TEMPLATE_VARIABLES] = safe_json_dumps(template_arguments)[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m555 | [0m[35m                self[k] = v[0m
[30;1m556 | [0m[35m[0m
[30;1m557 | [0m[35m    def _process_nodes(self, prefix: str, *nodes: NodeWithScore) -> None:[0m
[30;1m558 | [0m[35m        for i, node in enumerate(nodes):[0m
[30;1m559 | [0m[35m            self[f"{prefix}.{i}.{DOCUMENT_ID}"] = node.node_id[0m
[30;1m560 | [0m[35m            if content := node.get_content():[0m
[30;1m561 | [0m[35m                self[f"{prefix}.{i}.{DOCUMENT_CONTENT}"] = content[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mfrom importlib.metadata import version[0m
[30;1m12 | [0m[35mfrom queue import SimpleQueue[0m
[30;1m13 | [0m[35mfrom threading import RLock, Thread[0m
[30;1m14 | [0m[35mfrom time import sleep, time, time_ns[0m
[30;1m15 | [0m[35mfrom typing import ([0m
[30;1m16 | [0m[35m    TYPE_CHECKING,[0m
[30;1m17 | [0m[35m    Any,[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m690 | [0m[35m    """[0m
[30;1m691 | [0m[35m    if template := payload.get(EventPayload.TEMPLATE):[0m
[30;1m692 | [0m[35m        yield LLM_PROMPT_TEMPLATE, template[0m
[30;1m693 | [0m[35m    if template_vars := payload.get(EventPayload.TEMPLATE_VARS):[0m
[30;1m694 | [0m[35m        yield LLM_PROMPT_TEMPLATE_VARIABLES, safe_json_dumps(template_vars)[0m
[30;1m695 | [0m[35m[0m
[30;1m696 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m688 | [0m[35m    """[0m
[30;1m689 | [0m[35m    Yields template attributes if present[0m
[30;1m690 | [0m[35m    """[0m
[30;1m691 | [0m[35m    if template := payload.get(EventPayload.TEMPLATE):[0m
[30;1m692 | [0m[35m        yield LLM_PROMPT_TEMPLATE, template[0m
[30;1m693 | [0m[35m    if template_vars := payload.get(EventPayload.TEMPLATE_VARS):[0m
[30;1m694 | [0m[35m        yield LLM_PROMPT_TEMPLATE_VARIABLES, safe_json_dumps(template_vars)[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m632 | [0m[35m    """[0m
[30;1m633 | [0m[35m[0m
[30;1m634 | [0m[35m    def get_value(obj: Mapping[str, Any], key: str) -> Any:[0m
[30;1m635 | [0m[35m        return obj.get(key)[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m    yield from _get_token_counts_impl(usage_mapping, get_value)[0m
[30;1m638 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m[0m
[30;1m592 | [0m[35mdef _get_output_messages(raw: Any) -> Iterator[Tuple[str, Any]]:[0m
[30;1m593 | [0m[35m    choices = raw.get("choices") if isinstance(raw, Mapping) else getattr(raw, "choices", None)[0m
[30;1m594 | [0m[35m    if not choices:[0m
[30;1m595 | [0m[35m        return[0m
[30;1m596 | [0m[35m    assert isinstance(choices, Iterable), f"choices must be Iterable, found {type(choices)}"[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m        # NB: these additional kwargs exist both for 'agent' and 'function' roles[0m
[30;1m511 | [0m[35m        if "name" in message.additional_kwargs:[0m
[30;1m512 | [0m[35m            message_attributes[MESSAGE_NAME] = message.additional_kwargs["name"][0m
[30;1m513 | [0m[35m        if tool_calls := message.additional_kwargs.get("tool_calls"):[0m
[30;1m514 | [0m[35m            assert isinstance([0m
[30;1m515 | [0m[35m                tool_calls, Iterable[0m
[30;1m516 | [0m[35m            ), f"tool_calls must be Iterable, found {type(tool_calls)}"[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m497 | [0m[35m    """[0m
[30;1m498 | [0m[35m    if event_type is None:[0m
[30;1m499 | [0m[35m        return OpenInferenceSpanKindValues.UNKNOWN[0m
[30;1m500 | [0m[35m    return _SPAN_KINDS.get(event_type, OpenInferenceSpanKindValues.CHAIN)[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35mdef _message_payload_to_attributes(message: Any) -> Dict[str, Optional[str]]:[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m                    f"event_type={event_type}, payload={payload}",[0m
[30;1m335 | [0m[35m                )[0m
[30;1m336 | [0m[35m            if ([0m
[30;1m337 | [0m[35m                _is_streaming_response(response := payload.get(EventPayload.RESPONSE))[0m
[30;1m338 | [0m[35m                and response.response_gen is not None[0m
[30;1m339 | [0m[35m            ):[0m
[30;1m340 | [0m[35m                response.response_gen = _ResponseGen(response.response_gen, event_data)[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m        if payload is not None:[0m
[30;1m324 | [0m[35m            event_data.payloads.append(payload.copy())[0m
[30;1m325 | [0m[35m            if isinstance((exception := payload.get(EventPayload.EXCEPTION)), Exception):[0m
[30;1m326 | [0m[35m                event_data.exceptions.append(exception)[0m
[30;1m327 | [0m[35m            try:[0m
[30;1m328 | [0m[35m                event_data.attributes.update([0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        context = None[0m
[30;1m264 | [0m[35m        if parent_id != BASE_TRACE_EVENT:[0m
[30;1m265 | [0m[35m            with self._lock:[0m
[30;1m266 | [0m[35m                if parent_event_data := self._event_data.get(parent_id):[0m
[30;1m267 | [0m[35m                    context = parent_event_data.context[0m
[30;1m268 | [0m[35m        # Instead of relying on automatic context lookup, we set the context[0m
[30;1m269 | [0m[35m        # manually based on `parent_id``, because using the automatic context[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m            payloads = [payload.copy()][0m
[30;1m235 | [0m[35m            exceptions = ([0m
[30;1m236 | [0m[35m                [exception][0m
[30;1m237 | [0m[35m                if isinstance((exception := payload.get(EventPayload.EXCEPTION)), Exception)[0m
[30;1m238 | [0m[35m                else [][0m
[30;1m239 | [0m[35m            )[0m
[30;1m240 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m    if additional_kwargs and isinstance(additional_kwargs, Mapping):[0m
[30;1m190 | [0m[35m        invocation_parameters.update(additional_kwargs)[0m
[30;1m191 | [0m[35m    for key in ("temperature", "max_tokens"):[0m
[30;1m192 | [0m[35m        if (value := serialized.get(key)) is not None:[0m
[30;1m193 | [0m[35m            invocation_parameters[key] = value[0m
[30;1m194 | [0m[35m    return invocation_parameters[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m    if not hasattr(serialized, "get"):[0m
[30;1m186 | [0m[35m        return {}[0m
[30;1m187 | [0m[35m    invocation_parameters: Dict[str, Any] = {}[0m
[30;1m188 | [0m[35m    additional_kwargs = serialized.get("additional_kwargs")[0m
[30;1m189 | [0m[35m    if additional_kwargs and isinstance(additional_kwargs, Mapping):[0m
[30;1m190 | [0m[35m        invocation_parameters.update(additional_kwargs)[0m
[30;1m191 | [0m[35m    for key in ("temperature", "max_tokens"):[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m            if model_name := serialized.get("model_name"):[0m
[30;1m173 | [0m[35m                attributes[EMBEDDING_MODEL_NAME] = model_name[0m
[30;1m174 | [0m[35m        if event_type is CBEventType.LLM:[0m
[30;1m175 | [0m[35m            if model_name := serialized.get("model"):[0m
[30;1m176 | [0m[35m                attributes[LLM_MODEL_NAME] = model_name[0m
[30;1m177 | [0m[35m                invocation_parameters = _extract_invocation_parameters(serialized)[0m
[30;1m178 | [0m[35m                invocation_parameters["model"] = model_name[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m    if EventPayload.SERIALIZED in payload:[0m
[30;1m170 | [0m[35m        serialized = payload[EventPayload.SERIALIZED][0m
[30;1m171 | [0m[35m        if event_type is CBEventType.EMBEDDING:[0m
[30;1m172 | [0m[35m            if model_name := serialized.get("model_name"):[0m
[30;1m173 | [0m[35m                attributes[EMBEDDING_MODEL_NAME] = model_name[0m
[30;1m174 | [0m[35m        if event_type is CBEventType.LLM:[0m
[30;1m175 | [0m[35m            if model_name := serialized.get("model"):[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m                for node_with_score in nodes[0m
[30;1m160 | [0m[35m            ][0m
[30;1m161 | [0m[35m    if EventPayload.TOOL in payload:[0m
[30;1m162 | [0m[35m        tool_metadata = cast(ToolMetadata, payload.get(EventPayload.TOOL))[0m
[30;1m163 | [0m[35m        attributes[TOOL_NAME] = tool_metadata.name[0m
[30;1m164 | [0m[35m        attributes[TOOL_DESCRIPTION] = tool_metadata.description[0m
[30;1m165 | [0m[35m        if tool_parameters := tool_metadata.to_openai_tool(skip_length_check=True)["function"][[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m            attributes[RERANKER_MODEL_NAME] = payload[EventPayload.MODEL_NAME][0m
[30;1m145 | [0m[35m        if EventPayload.QUERY_STR in payload:[0m
[30;1m146 | [0m[35m            attributes[RERANKER_QUERY] = payload[EventPayload.QUERY_STR][0m
[30;1m147 | [0m[35m        if nodes := payload.get(EventPayload.NODES):[0m
[30;1m148 | [0m[35m            attributes[RERANKER_OUTPUT_DOCUMENTS if is_event_end else RERANKER_INPUT_DOCUMENTS] = [[0m
[30;1m149 | [0m[35m                {[0m
[30;1m150 | [0m[35m                    DOCUMENT_ID: node_with_score.node.node_id,[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m        attributes.update(_get_response_output(response))[0m
[30;1m129 | [0m[35m        if raw := getattr(response, "raw", None):[0m
[30;1m130 | [0m[35m            attributes.update(_get_output_messages(raw))[0m
[30;1m131 | [0m[35m            usage = raw.get("usage") if isinstance(raw, Mapping) else getattr(raw, "usage", None)[0m
[30;1m132 | [0m[35m            if usage:[0m
[30;1m133 | [0m[35m                # OpenAI token counts are available on raw.usage but can also be[0m
[30;1m134 | [0m[35m                # found in additional_kwargs. Thus the duplicate handling.[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m            # the agent step contains a message that is actually the input[0m
[30;1m125 | [0m[35m            # akin to the query_str[0m
[30;1m126 | [0m[35m            attributes[INPUT_VALUE] = _message_payload_to_str(messages[0])[0m
[30;1m127 | [0m[35m    if response := (payload.get(EventPayload.RESPONSE) or payload.get(EventPayload.COMPLETION)):[0m
[30;1m128 | [0m[35m        attributes.update(_get_response_output(response))[0m
[30;1m129 | [0m[35m        if raw := getattr(response, "raw", None):[0m
[30;1m130 | [0m[35m            attributes.update(_get_output_messages(raw))[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m            # the agent step contains a message that is actually the input[0m
[30;1m125 | [0m[35m            # akin to the query_str[0m
[30;1m126 | [0m[35m            attributes[INPUT_VALUE] = _message_payload_to_str(messages[0])[0m
[30;1m127 | [0m[35m    if response := (payload.get(EventPayload.RESPONSE) or payload.get(EventPayload.COMPLETION)):[0m
[30;1m128 | [0m[35m        attributes.update(_get_response_output(response))[0m
[30;1m129 | [0m[35m        if raw := getattr(response, "raw", None):[0m
[30;1m130 | [0m[35m            attributes.update(_get_output_messages(raw))[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m4 | [0m[35mfrom enum import Enum[0m
[30;1m5 | [0m[35mfrom threading import RLock[0m
[30;1m6 | [0m[35mfrom time import time_ns[0m
[30;1m7 | [0m[35mfrom types import MappingProxyType[0m
[30;1m8 | [0m[35mfrom typing import ([0m
[30;1m9 | [0m[35m    Any,[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m351 | [0m[35m    ) -> None:[0m
[30;1m352 | [0m[35m        """[0m
[30;1m353 | [0m[35m        This is intentionally empty because each OTEL span only needs `on_event_start`, and[0m
[30;1m354 | [0m[35m        will be exported at `on_event_end`.[0m
[30;1m355 | [0m[35m        """[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m    def end_trace([0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/_callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m211 | [0m[35m        self._templating_parent_id: Dict[_EventId, _ParentId] = _BoundedDict()[0m
[30;1m212 | [0m[35m        self._templating_payloads: Dict[_ParentId, List[Dict[str, Any]]] = _BoundedDict()[0m
[30;1m213 | [0m[35m        """Templating events are sibling events preceding the LLM event. We won't be turning[0m
[30;1m214 | [0m[35m        the templating events into spans but will extract values from their payloads to update[0m
[30;1m215 | [0m[35m        the corresponding LLM span attributes.[0m
[30;1m216 | [0m[35m        """[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    def on_event_start([0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler_multimodal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m        }[0m
[30;1m138 | [0m[35m    )[0m
[30;1m139 | [0m[35m    url = "https://api.openai.com/v1/chat/completions"[0m
[30;1m140 | [0m[35m    respx_mock.post(url).mock(return_value=Response(status_code=status_code, **respx_kwargs))[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    def chat(message: ChatMessage) -> None:[0m
[30;1m143 | [0m[35m        if is_stream:[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_tool_calls_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m            == "get_weather"[0m
[30;1m83 | [0m[35m        )[0m
[30;1m84 | [0m[35m        assert isinstance([0m
[30;1m85 | [0m[35m            arguments := span.attributes.get([0m
[30;1m86 | [0m[35m                f"{LLM_OUTPUT_MESSAGES}.0.{MESSAGE_TOOL_CALLS}.0.{TOOL_CALL_FUNCTION_ARGUMENTS_JSON}[0m
[30;1m87 | [0m[35m            ),[0m
[30;1m88 | [0m[35m            str,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_tool_calls_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m        assert span.attributes[0m
[30;1m77 | [0m[35m        assert span.attributes.get(f"{LLM_OUTPUT_MESSAGES}.0.{MESSAGE_TOOL_CALLS}.0.{TOOL_CALL_ID}")[0m
[30;1m78 | [0m[35m        assert ([0m
[30;1m79 | [0m[35m            span.attributes.get([0m
[30;1m80 | [0m[35m                f"{LLM_OUTPUT_MESSAGES}.0.{MESSAGE_TOOL_CALLS}.0.{TOOL_CALL_FUNCTION_NAME}"[0m
[30;1m81 | [0m[35m            )[0m
[30;1m82 | [0m[35m            == "get_weather"[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_tool_calls_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        spans = in_memory_span_exporter.get_finished_spans()[0m
[30;1m75 | [0m[35m        span = spans[-1][0m
[30;1m76 | [0m[35m        assert span.attributes[0m
[30;1m77 | [0m[35m        assert span.attributes.get(f"{LLM_OUTPUT_MESSAGES}.0.{MESSAGE_TOOL_CALLS}.0.{TOOL_CALL_ID}")[0m
[30;1m78 | [0m[35m        assert ([0m
[30;1m79 | [0m[35m            span.attributes.get([0m
[30;1m80 | [0m[35m                f"{LLM_OUTPUT_MESSAGES}.0.{MESSAGE_TOOL_CALLS}.0.{TOOL_CALL_FUNCTION_NAME}"[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_get_current_span.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        assert span.attributes and span.context[0m
[30;1m38 | [0m[35m        assert (expected := str(span.context.span_id)) not in seen[0m
[30;1m39 | [0m[35m        seen.add(expected)[0m
[30;1m40 | [0m[35m        assert span.attributes.get(OUTPUT_VALUE) == expected[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mOUTPUT_VALUE = SpanAttributes.OUTPUT_VALUE[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_token_counts.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        span = in_memory_span_exporter.get_finished_spans()[0][0m
[30;1m85 | [0m[35m        attr = dict(span.attributes or {})[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        usage = resp.raw.get("usage")[0m
[30;1m88 | [0m[35m        assert ([0m
[30;1m89 | [0m[35m            attr.pop(LLM_TOKEN_COUNT_PROMPT)[0m
[30;1m90 | [0m[35m            == usage.input_tokens[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_token_counts.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m        assert span.attributes[0m
[30;1m35 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_TOTAL)[0m
[30;1m36 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_COMPLETION)[0m
[30;1m37 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_TOTAL)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    @pytest.mark.vcr([0m
[30;1m40 | [0m[35m        decode_compressed_response=True,[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_token_counts.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        span = in_memory_span_exporter.get_finished_spans()[0][0m
[30;1m32 | [0m[35m        assert span.attributes[0m
[30;1m33 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_TOTAL)[0m
[30;1m34 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_COMPLETION)[0m
[30;1m35 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_TOTAL)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    @pytest.mark.vcr([0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_token_counts.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m            pass[0m
[30;1m31 | [0m[35m        span = in_memory_span_exporter.get_finished_spans()[0][0m
[30;1m32 | [0m[35m        assert span.attributes[0m
[30;1m33 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_TOTAL)[0m
[30;1m34 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_COMPLETION)[0m
[30;1m35 | [0m[35m        assert span.attributes.get(LLM_TOKEN_COUNT_TOTAL)[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35m    while span and span.parent:[0m
[30;1m367 | [0m[35m        if span.parent.span_id == ancestor.context.span_id:[0m
[30;1m368 | [0m[35m            return True[0m
[30;1m369 | [0m[35m        span = spans_by_id.get(span.parent.span_id)[0m
[30;1m370 | [0m[35m    return False[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        }[0m
[30;1m117 | [0m[35m    )[0m
[30;1m118 | [0m[35m    url = "https://api.openai.com/v1/chat/completions"[0m
[30;1m119 | [0m[35m    respx_mock.post(url).mock(return_value=Response(status_code=status_code, **respx_kwargs))[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    async def aquery(question: str) -> None:[0m
[30;1m122 | [0m[35m        response = await query_engine.aquery(question)[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/tests/openinference/instrumentation/llama_index/test_message_content_blocks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom llama_index.core.base.llms.types import ImageBlock, TextBlock[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom openinference.instrumentation.llama_index._handler import ([0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m132 | [0m[35mprint(query_engine.query("What did the author do growing up?"))[0m
[30;1m133 | [0m[35m```[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35mVisit the Phoenix app at `http://localhost:6006` to see the traces.[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m## More Info[0m
[30;1m138 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m85 | [0m[35mpython -m phoenix.server.main serve[0m
[30;1m86 | [0m[35m```[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35mThe following Python code sets up the `LlamaIndexInstrumentor` to trace `llama-index` and send the t[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m```python[0m
[30;1m91 | [0m[35mfrom openinference.instrumentation.llama_index import LlamaIndexInstrumentor[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m    arize-phoenix[0m
[30;1m78 | [0m[35m```[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mStart the Phoenix app in the background as a collector. By default, it listens on `http://localhost:[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mThe Phoenix app does not send data over the internet. It only operates locally on your machine.[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35mInstall packages needed for this demonstration.[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m```shell[0m
[30;1m72 | [0m[35mpython -m pip install --upgrade \[0m
[30;1m73 | [0m[35m    openinference-instrumentation-llama-index \[0m
[30;1m74 | [0m[35m    opentelemetry-sdk \[0m
[30;1m75 | [0m[35m    opentelemetry-exporter-otlp \[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m## Installation[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m```shell[0m
[30;1m54 | [0m[35mpip install openinference-instrumentation-llama-index[0m
[30;1m55 | [0m[35m```[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m## Compatibility[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m        return None[0m
[30;1m126 | [0m[35m    if not isinstance(span_handler, _SpanHandler):[0m
[30;1m127 | [0m[35m        return None[0m
[30;1m128 | [0m[35m    if (span := span_handler.open_spans.get(id_)) is None:[0m
[30;1m129 | [0m[35m        return None[0m
[30;1m130 | [0m[35m    return span._otel_span[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    from llama_index.core.instrumentation.span import active_span_id[0m
[30;1m117 | [0m[35m    from openinference.instrumentation.llama_index._handler import _SpanHandler[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    if not isinstance(id_ := active_span_id.get(), str):[0m
[30;1m120 | [0m[35m        return None[0m
[30;1m121 | [0m[35m    instrumentor = LlamaIndexInstrumentor()[0m
[30;1m122 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m            self._span_handler = _SpanHandler([0m
[30;1m74 | [0m[35m                tracer=tracer,[0m
[30;1m75 | [0m[35m                separate_trace_from_runtime_context=bool([0m
[30;1m76 | [0m[35m                    kwargs.get("separate_trace_from_runtime_context")[0m
[30;1m77 | [0m[35m                ),[0m
[30;1m78 | [0m[35m            )[0m
[30;1m79 | [0m[35m            self._event_handler = EventHandler(span_handler=self._span_handler)[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m            config = TraceConfig()[0m
[30;1m37 | [0m[35m        else:[0m
[30;1m38 | [0m[35m            assert isinstance(config, TraceConfig)[0m
[30;1m39 | [0m[35m        self._use_legacy_callback_handler = bool(kwargs.get("use_legacy_callback_handler"))[0m
[30;1m40 | [0m[35m        if self._use_legacy_callback_handler:[0m
[30;1m41 | [0m[35m            import llama_index.core[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m    def _instrument(self, **kwargs: Any) -> None:[0m
[30;1m33 | [0m[35m        if not (tracer_provider := kwargs.get("tracer_provider")):[0m
[30;1m34 | [0m[35m            tracer_provider = trace_api.get_tracer_provider()[0m
[30;1m35 | [0m[35m        if not (config := kwargs.get("config")):[0m
[30;1m36 | [0m[35m            config = TraceConfig()[0m
[30;1m37 | [0m[35m        else:[0m
[30;1m38 | [0m[35m            assert isinstance(config, TraceConfig)[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/src/openinference/instrumentation/llama_index/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        return _instruments[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    def _instrument(self, **kwargs: Any) -> None:[0m
[30;1m33 | [0m[35m        if not (tracer_provider := kwargs.get("tracer_provider")):[0m
[30;1m34 | [0m[35m            tracer_provider = trace_api.get_tracer_provider()[0m
[30;1m35 | [0m[35m        if not (config := kwargs.get("config")):[0m
[30;1m36 | [0m[35m            config = TraceConfig()[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m89 | [0m[35mprint(query_engine.query("What did the author do growing up?"))[0m
[30;1m90 | [0m[35m```[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mVisit the Phoenix app at `http://localhost:6006` to see the traces.[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m## More Info[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m42 | [0m[35mpython -m phoenix.server.main serve[0m
[30;1m43 | [0m[35m```[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mThe following Python code sets up the `LlamaIndexInstrumentor` to trace `llama-index` and send the t[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m```python[0m
[30;1m48 | [0m[35mfrom openinference.instrumentation.llama_index import LlamaIndexInstrumentor[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35m    arize-phoenix[0m
[30;1m35 | [0m[35m```[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mStart the Phoenix app in the background as a collector. By default, it listens on `http://localhost:[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mThe Phoenix app does not send data over the internet. It only operates locally on your machine.[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35mInstall packages needed for this demonstration.[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m```shell[0m
[30;1m29 | [0m[35mpython -m pip install --upgrade \[0m
[30;1m30 | [0m[35m    openinference-instrumentation-llama-index \[0m
[30;1m31 | [0m[35m    opentelemetry-sdk \[0m
[30;1m32 | [0m[35m    opentelemetry-exporter-otlp \[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m85[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/openinference_instrumentation_llama_index-4.2.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m## Installation[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m```shell[0m
[30;1m11 | [0m[35mpip install openinference-instrumentation-llama-index[0m
[30;1m12 | [0m[35m```[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m## Compatibility[0m

85 matches found.
