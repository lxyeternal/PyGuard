[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/tests/test_address_normalization.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m261 | [0m[35m        """Test normalize_addr_dict function with handling for occupancy[0m
[30;1m262 | [0m[35m        type oddities.  This is based on a real life incident; the original[0m
[30;1m263 | [0m[35m        behavior to allow non-standard unit types to pass through resulted[0m
[30;1m264 | [0m[35m        in an address validation service also allowing the address to pass[0m
[30;1m265 | [0m[35m        through even though no unit should have existed on the home.[0m
[30;1m266 | [0m[35m        """[0m
[30;1m267 | [0m[35m        dict_map = {[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/tests/test_address_normalization.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m    validate_us_postal_code_format,[0m
[30;1m53 | [0m[35m)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m# Constants[0m
[30;1m56 | [0m[35mSERVICE = 'GBR Test Normalization'[0m
[30;1m57 | [0m[35m# Helper Functions & Classes[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/address_constants.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m936 | [0m[35m            'ADDRESS_KEYS', default=globals()['ADDRESS_KEYS'][0m
[30;1m937 | [0m[35m        )[0m
[30;1m938 | [0m[35m        for key in addr_constants:[0m
[30;1m939 | [0m[35m            new_vals = config.get(key, default={})[0m
[30;1m940 | [0m[35m            if key == 'OCCUPANCY_TYPE_ABBREVIATIONS' and new_vals:[0m
[30;1m941 | [0m[35m                org_keys = OCCUPANCY_TYPE_ABBREVIATIONS.keys()[0m
[30;1m942 | [0m[35m                new_keys = new_vals.keys()[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/address_constants.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m932 | [0m[35m                insertion_method[0m
[30;1m933 | [0m[35m            )[0m
[30;1m934 | [0m[35m            raise ConfigError(msg)[0m
[30;1m935 | [0m[35m        globals()['ADDRESS_KEYS'] = config.get([0m
[30;1m936 | [0m[35m            'ADDRESS_KEYS', default=globals()['ADDRESS_KEYS'][0m
[30;1m937 | [0m[35m        )[0m
[30;1m938 | [0m[35m        for key in addr_constants:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/address_constants.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m924 | [0m[35m            'LONGHAND_DIRECTIONALS',[0m
[30;1m925 | [0m[35m            'LONGHAND_STREET_TYPES',[0m
[30;1m926 | [0m[35m        )[0m
[30;1m927 | [0m[35m        insertion_method = config.get('insertion_method', default='update')[0m
[30;1m928 | [0m[35m        update = ('update', 'insert')[0m
[30;1m929 | [0m[35m        replace = ('replace', 'overwrite')[0m
[30;1m930 | [0m[35m        if insertion_method not in update + replace:[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/address_constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m927 | [0m[35m        insertion_method = config.get('insertion_method', default='update')[0m
[30;1m928 | [0m[35m        update = ('update', 'insert')[0m
[30;1m929 | [0m[35m        replace = ('replace', 'overwrite')[0m
[30;1m930 | [0m[35m        if insertion_method not in update + replace:[0m
[30;1m931 | [0m[35m            msg = "'{}' is not a valid option for 'insertion_method'".format([0m
[30;1m932 | [0m[35m                insertion_method[0m
[30;1m933 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/address_constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m925 | [0m[35m            'LONGHAND_STREET_TYPES',[0m
[30;1m926 | [0m[35m        )[0m
[30;1m927 | [0m[35m        insertion_method = config.get('insertion_method', default='update')[0m
[30;1m928 | [0m[35m        update = ('update', 'insert')[0m
[30;1m929 | [0m[35m        replace = ('replace', 'overwrite')[0m
[30;1m930 | [0m[35m        if insertion_method not in update + replace:[0m
[30;1m931 | [0m[35m            msg = "'{}' is not a valid option for 'insertion_method'".format([0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m848 | [0m[35m            postal_code, addr_dict[0m
[30;1m849 | [0m[35m        ) if postal_code else None[0m
[30;1m850 | [0m[35m        city = addr_dict.get('city')[0m
[30;1m851 | [0m[35m        state = addr_dict.get('state')[0m
[30;1m852 | [0m[35m        try:[0m
[30;1m853 | [0m[35m            address = self.normalize_addr_str([0m
[30;1m854 | [0m[35m                addr_str, city=city, state=state,[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m847 | [0m[35m        zipcode = validate_us_postal_code_format([0m
[30;1m848 | [0m[35m            postal_code, addr_dict[0m
[30;1m849 | [0m[35m        ) if postal_code else None[0m
[30;1m850 | [0m[35m        city = addr_dict.get('city')[0m
[30;1m851 | [0m[35m        state = addr_dict.get('state')[0m
[30;1m852 | [0m[35m        try:[0m
[30;1m853 | [0m[35m            address = self.normalize_addr_str([0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m843 | [0m[35m        # processing whether the line 2 elements are pre-parsed or[0m
[30;1m844 | [0m[35m        # included in line 1[0m
[30;1m845 | [0m[35m        addr_str = get_addr_line_str(addr_dict, comma_separate=True)[0m
[30;1m846 | [0m[35m        postal_code = addr_dict.get('postal_code')[0m
[30;1m847 | [0m[35m        zipcode = validate_us_postal_code_format([0m
[30;1m848 | [0m[35m            postal_code, addr_dict[0m
[30;1m849 | [0m[35m        ) if postal_code else None[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m787 | [0m[35m                        # try a different additional processing function[0m
[30;1m788 | [0m[35m                        pass[0m
[30;1m789 | [0m[35m[0m
[30;1m790 | [0m[35m        if parsed_addr and not parsed_addr.get('StreetName'):[0m
[30;1m791 | [0m[35m            addr_dict = dict([0m
[30;1m792 | [0m[35m                address_line_1=addr_str, address_line_2=line2, city=city,[0m
[30;1m793 | [0m[35m                state=state, postal_code=zipcode[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m737 | [0m[35m        self.long_hand = long_hand[0m
[30;1m738 | [0m[35m        if addr_map and not isinstance(self.address, str):[0m
[30;1m739 | [0m[35m            self.address = {[0m
[30;1m740 | [0m[35m                key: self.address.get(val) for key, val in addr_map.items()[0m
[30;1m741 | [0m[35m            }[0m
[30;1m742 | [0m[35m[0m
[30;1m743 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m677 | [0m[35m    address_line_2 = None[0m
[30;1m678 | [0m[35m    geo_addr_dict = {}[0m
[30;1m679 | [0m[35m    if not isinstance(address, str):[0m
[30;1m680 | [0m[35m        address_line_2 = address.get('address_line_2')[0m
[30;1m681 | [0m[35m        address = get_addr_line_str(address, addr_parts=addr_keys)[0m
[30;1m682 | [0m[35m    geo_resp = geocoder.google(address)[0m
[30;1m683 | [0m[35m    if geo_resp.ok and geo_resp.housenumber:[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m660 | [0m[35m    address_template = Template('$address')[0m
[30;1m661 | [0m[35m    address = dict(address)[0m
[30;1m662 | [0m[35m    addr_parts = [[0m
[30;1m663 | [0m[35m        str(address[field]) for field in ADDRESS_KEYS if address.get(field)[0m
[30;1m664 | [0m[35m    ][0m
[30;1m665 | [0m[35m    return address_template.safe_substitute(address=', '.join(addr_parts))[0m
[30;1m666 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m649 | [0m[35m        raise TypeError('addr_parts must be a list or tuple')[0m
[30;1m650 | [0m[35m    separator = ', ' if comma_separate else ' '[0m
[30;1m651 | [0m[35m    addr_str = separator.join([0m
[30;1m652 | [0m[35m        str(addr_dict[elem]) for elem in addr_parts if addr_dict.get(elem)[0m
[30;1m653 | [0m[35m    )[0m
[30;1m654 | [0m[35m    return addr_str[0m
[30;1m655 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35mdef normalize_city(city):[0m
[30;1m604 | [0m[35m    city = city.split()[0m
[30;1m605 | [0m[35m    for i, part in enumerate(city):[0m
[30;1m606 | [0m[35m        replacement = CITY_ABBREVIATIONS.get(part.replace('.', ''))[0m
[30;1m607 | [0m[35m        if replacement:[0m
[30;1m608 | [0m[35m            city[i] = replacement[0m
[30;1m609 | [0m[35m    return ' '.join(city)[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m594 | [0m[35m    :rtype: str | None[0m
[30;1m595 | [0m[35m    """[0m
[30;1m596 | [0m[35m    if state:[0m
[30;1m597 | [0m[35m        state_abbrv = STATE_ABBREVIATIONS.get(state.upper())[0m
[30;1m598 | [0m[35m        if state_abbrv:[0m
[30;1m599 | [0m[35m            state = state_abbrv[0m
[30;1m600 | [0m[35m    return state[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m564 | [0m[35m        if occupancy_type in OCCUPANCY_TYPE_ABBREVIATIONS.values()[0m
[30;1m565 | [0m[35m        else OCCUPANCY_TYPE_ABBREVIATIONS.get(occupancy_type)[0m
[30;1m566 | [0m[35m    )[0m
[30;1m567 | [0m[35m    occupancy_id = parsed_addr.get('OccupancyIdentifier')[0m
[30;1m568 | [0m[35m    if ((occupancy_id and not occupancy_id.startswith('#'))[0m
[30;1m569 | [0m[35m            and not occupancy_type_abbr):[0m
[30;1m570 | [0m[35m        occupancy_type_abbr = default[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m562 | [0m[35m    occupancy_type_abbr = ([0m
[30;1m563 | [0m[35m        occupancy_type[0m
[30;1m564 | [0m[35m        if occupancy_type in OCCUPANCY_TYPE_ABBREVIATIONS.values()[0m
[30;1m565 | [0m[35m        else OCCUPANCY_TYPE_ABBREVIATIONS.get(occupancy_type)[0m
[30;1m566 | [0m[35m    )[0m
[30;1m567 | [0m[35m    occupancy_id = parsed_addr.get('OccupancyIdentifier')[0m
[30;1m568 | [0m[35m    if ((occupancy_id and not occupancy_id.startswith('#'))[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m    for found in found_type_tags:[0m
[30;1m530 | [0m[35m        street_type = parsed_addr[found][0m
[30;1m531 | [0m[35m        # lookup the appropriate abbrev for the street type found per key.[0m
[30;1m532 | [0m[35m        type_abbr = STREET_TYPE_ABBREVIATIONS.get(parsed_addr[found])[0m
[30;1m533 | [0m[35m        # update the street type only if a new abbreviation is found.[0m
[30;1m534 | [0m[35m        if type_abbr:[0m
[30;1m535 | [0m[35m            street_type = type_abbr[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m    :type orig_addr_str: str[0m
[30;1m424 | [0m[35m    :return: str | None[0m
[30;1m425 | [0m[35m    """[0m
[30;1m426 | [0m[35m    val_from_parse = parsed_addr.get(val_label)[0m
[30;1m427 | [0m[35m    orig_val = post_clean_addr_str(orig_val)[0m
[30;1m428 | [0m[35m    val_from_parse = post_clean_addr_str(val_from_parse)[0m
[30;1m429 | [0m[35m    non_null_val_set = {orig_val, val_from_parse} - {None}[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m    street_type_key = 'StreetNamePostType'[0m
[30;1m368 | [0m[35m    occupany_type_keys = (occupany_type_key, 'SubaddressType')[0m
[30;1m369 | [0m[35m    occupancy_identifier_keys = ('OccupancyIdentifier', 'SubaddressIdentifier')[0m
[30;1m370 | [0m[35m    street_type = parsed_addr.get(street_type_key)[0m
[30;1m371 | [0m[35m    if street_type in ABNORMAL_OCCUPANCY_ABBRVS:[0m
[30;1m372 | [0m[35m        occupancy_type = None[0m
[30;1m373 | [0m[35m        occupancy = None[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m        postal_code, addr_dict[0m
[30;1m298 | [0m[35m    ) if postal_code else None[0m
[30;1m299 | [0m[35m    city = addr_dict.get('city')[0m
[30;1m300 | [0m[35m    state = addr_dict.get('state')[0m
[30;1m301 | [0m[35m    try:[0m
[30;1m302 | [0m[35m        address = normalize_addr_str([0m
[30;1m303 | [0m[35m            addr_str, city=city, state=state, zipcode=zipcode,[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m    zipcode = validate_us_postal_code_format([0m
[30;1m297 | [0m[35m        postal_code, addr_dict[0m
[30;1m298 | [0m[35m    ) if postal_code else None[0m
[30;1m299 | [0m[35m    city = addr_dict.get('city')[0m
[30;1m300 | [0m[35m    state = addr_dict.get('state')[0m
[30;1m301 | [0m[35m    try:[0m
[30;1m302 | [0m[35m        address = normalize_addr_str([0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m    # line 1 and line 2 elements are combined to ensure consistent processing[0m
[30;1m293 | [0m[35m    # whether the line 2 elements are pre-parsed or included in line 1[0m
[30;1m294 | [0m[35m    addr_str = get_addr_line_str(addr_dict, comma_separate=True)[0m
[30;1m295 | [0m[35m    postal_code = addr_dict.get('postal_code')[0m
[30;1m296 | [0m[35m    zipcode = validate_us_postal_code_format([0m
[30;1m297 | [0m[35m        postal_code, addr_dict[0m
[30;1m298 | [0m[35m    ) if postal_code else None[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m    :rtype: Mapping[str, str][0m
[30;1m287 | [0m[35m    """[0m
[30;1m288 | [0m[35m    if addr_map:[0m
[30;1m289 | [0m[35m        addr_dict = {key: addr_dict.get(val) for key, val in addr_map.items()}[0m
[30;1m290 | [0m[35m    addr_dict = validate_address_components(addr_dict, strict=strict)[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m    # line 1 and line 2 elements are combined to ensure consistent processing[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m                    # try a different additional processing function[0m
[30;1m216 | [0m[35m                    pass[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    if parsed_addr and not parsed_addr.get('StreetName'):[0m
[30;1m219 | [0m[35m        addr_dict = dict([0m
[30;1m220 | [0m[35m            address_line_1=addr_str, address_line_2=line2, city=city,[0m
[30;1m221 | [0m[35m            state=state, postal_code=zipcode[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m530 | [0m[35m        street_type = parsed_addr[found][0m
[30;1m531 | [0m[35m        # lookup the appropriate abbrev for the street type found per key.[0m
[30;1m532 | [0m[35m        type_abbr = STREET_TYPE_ABBREVIATIONS.get(parsed_addr[found])[0m
[30;1m533 | [0m[35m        # update the street type only if a new abbreviation is found.[0m
[30;1m534 | [0m[35m        if type_abbr:[0m
[30;1m535 | [0m[35m            street_type = type_abbr[0m
[30;1m536 | [0m[35m        if long_hand:[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/normalize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mProvides functions to normalize address per USPS pub 28 and/or RESO standards.[0m
[30;1m9 | [0m[35m"""[0m
[30;1m10 | [0m[35m# TODO: Find why # with no street gets through[0m
[30;1m11 | [0m[35m# form_normalization = {[0m
[30;1m12 | [0m[35m#     'jurisdiction_property_id': 'TST123',[0m
[30;1m13 | [0m[35m#     'address_line_1': '123',[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/validations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        address_dict.get('postal_code') or[0m
[30;1m69 | [0m[35m        (address_dict.get('city') and address_dict.get('state'))[0m
[30;1m70 | [0m[35m    )[0m
[30;1m71 | [0m[35m    if not address_dict.get('address_line_1'):[0m
[30;1m72 | [0m[35m        msg = 'Address records must include Line 1 data.'[0m
[30;1m73 | [0m[35m        raise IncompleteAddressError(msg)[0m
[30;1m74 | [0m[35m    elif not locality:[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/validations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        address_dict.get('city') and address_dict.get('state')[0m
[30;1m67 | [0m[35m        if strict else[0m
[30;1m68 | [0m[35m        address_dict.get('postal_code') or[0m
[30;1m69 | [0m[35m        (address_dict.get('city') and address_dict.get('state'))[0m
[30;1m70 | [0m[35m    )[0m
[30;1m71 | [0m[35m    if not address_dict.get('address_line_1'):[0m
[30;1m72 | [0m[35m        msg = 'Address records must include Line 1 data.'[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/validations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        address_dict.get('city') and address_dict.get('state')[0m
[30;1m67 | [0m[35m        if strict else[0m
[30;1m68 | [0m[35m        address_dict.get('postal_code') or[0m
[30;1m69 | [0m[35m        (address_dict.get('city') and address_dict.get('state'))[0m
[30;1m70 | [0m[35m    )[0m
[30;1m71 | [0m[35m    if not address_dict.get('address_line_1'):[0m
[30;1m72 | [0m[35m        msg = 'Address records must include Line 1 data.'[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/validations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m        address_dict.get('postal_code') and[0m
[30;1m66 | [0m[35m        address_dict.get('city') and address_dict.get('state')[0m
[30;1m67 | [0m[35m        if strict else[0m
[30;1m68 | [0m[35m        address_dict.get('postal_code') or[0m
[30;1m69 | [0m[35m        (address_dict.get('city') and address_dict.get('state'))[0m
[30;1m70 | [0m[35m    )[0m
[30;1m71 | [0m[35m    if not address_dict.get('address_line_1'):[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/validations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m    """[0m
[30;1m64 | [0m[35m    locality = ([0m
[30;1m65 | [0m[35m        address_dict.get('postal_code') and[0m
[30;1m66 | [0m[35m        address_dict.get('city') and address_dict.get('state')[0m
[30;1m67 | [0m[35m        if strict else[0m
[30;1m68 | [0m[35m        address_dict.get('postal_code') or[0m
[30;1m69 | [0m[35m        (address_dict.get('city') and address_dict.get('state'))[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/validations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m    """[0m
[30;1m64 | [0m[35m    locality = ([0m
[30;1m65 | [0m[35m        address_dict.get('postal_code') and[0m
[30;1m66 | [0m[35m        address_dict.get('city') and address_dict.get('state')[0m
[30;1m67 | [0m[35m        if strict else[0m
[30;1m68 | [0m[35m        address_dict.get('postal_code') or[0m
[30;1m69 | [0m[35m        (address_dict.get('city') and address_dict.get('state'))[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/validations.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m    :rtype: Mapping[0m
[30;1m63 | [0m[35m    """[0m
[30;1m64 | [0m[35m    locality = ([0m
[30;1m65 | [0m[35m        address_dict.get('postal_code') and[0m
[30;1m66 | [0m[35m        address_dict.get('city') and address_dict.get('state')[0m
[30;1m67 | [0m[35m        if strict else[0m
[30;1m68 | [0m[35m        address_dict.get('postal_code') or[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/validations.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35m    # type: (Mapping[str, str]) -> Mapping[str, str][0m
[30;1m51 | [0m[35m    """Validate non-null values for minimally viable address elements.[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    All addresses should have at least an address_line_1 and a postal_code[0m
[30;1m54 | [0m[35m    or a city and state.[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    :param address_dict: dict containing address components having keys[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/cleaning.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        except usaddress.RepeatedLabelError:[0m
[30;1m149 | [0m[35m            pass[0m
[30;1m150 | [0m[35m        if parsed:[0m
[30;1m151 | [0m[35m            occupancy = parsed[0].get('OccupancyIdentifier')[0m
[30;1m152 | [0m[35m    return occupancy[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m39[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/scourgify/cleaning.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m    # further processing is necessary[0m
[30;1m226 | [0m[35m    alnum_text = text.translate({44: None, 38: None})[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m    # remove unwanted non-alphanumeric characters and convert all dash type[0m
[30;1m229 | [0m[35m    # characters to hyphen[0m
[30;1m230 | [0m[35m    if not alnum_text.replace(' ', '').isalnum():[0m
[30;1m231 | [0m[35m        for char in text:[0m

39 matches found.
