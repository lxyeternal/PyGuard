[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/bitbucket.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    @default("login_service")[0m
[30;1m20 | [0m[35m    def _login_service_default(self):[0m
[30;1m21 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Bitbucket")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    @default("authorize_url")[0m
[30;1m24 | [0m[35m    def _authorize_url_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m980 | [0m[35m        }[0m
[30;1m981 | [0m[35m[0m
[30;1m982 | [0m[35m        if self.basic_auth:[0m
[30;1m983 | [0m[35m            b64key = base64.b64encode([0m
[30;1m984 | [0m[35m                bytes(f"{self.client_id}:{self.client_secret}", "utf8")[0m
[30;1m985 | [0m[35m            )[0m
[30;1m986 | [0m[35m            headers.update({"Authorization": f'Basic {b64key.decode("utf8")}'})[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m100 | [0m[35m        code_verifier = secrets.token_urlsafe(32)[0m
[30;1m101 | [0m[35m        code_challenge = hashlib.sha256(code_verifier.encode("utf-8")).digest()[0m
[30;1m102 | [0m[35m        code_challenge_base64 = ([0m
[30;1m103 | [0m[35m            base64.urlsafe_b64encode(code_challenge).decode("utf-8").rstrip("=")[0m
[30;1m104 | [0m[35m        )[0m
[30;1m105 | [0m[35m        return code_verifier, code_challenge_base64[0m
[30;1m106 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m56 | [0m[35m    if isinstance(b64_state, str):[0m
[30;1m57 | [0m[35m        b64_state = b64_state.encode("ascii")[0m
[30;1m58 | [0m[35m    try:[0m
[30;1m59 | [0m[35m        json_state = base64.urlsafe_b64decode(b64_state).decode("utf8")[0m
[30;1m60 | [0m[35m    except ValueError:[0m
[30;1m61 | [0m[35m        app_log.error(f"Failed to b64-decode state: {b64_state}")[0m
[30;1m62 | [0m[35m        return {}[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m48 | [0m[35mdef _serialize_state(state):[0m
[30;1m49 | [0m[35m    """Serialize OAuth state to a base64 string after passing through JSON"""[0m
[30;1m50 | [0m[35m    json_state = json.dumps(state)[0m
[30;1m51 | [0m[35m    return base64.urlsafe_b64encode(json_state.encode("utf8")).decode("ascii")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mdef _deserialize_state(b64_state):[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef _serialize_state(state):[0m
[30;1m49 | [0m[35m    """Serialize OAuth state to a base64 string after passing through JSON"""[0m
[30;1m50 | [0m[35m    json_state = json.dumps(state)[0m
[30;1m51 | [0m[35m    return base64.urlsafe_b64encode(json_state.encode("utf8")).decode("ascii")[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m4 | [0m[35mFounded based on work by Kyle Kelley (@rgbkrk)[0m
[30;1m5 | [0m[35m"""[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport hashlib[0m
[30;1m9 | [0m[35mimport json[0m
[30;1m10 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m958 | [0m[35m        return {[0m
[30;1m959 | [0m[35m            "Accept": "application/json",[0m
[30;1m960 | [0m[35m            "User-Agent": "JupyterHub",[0m
[30;1m961 | [0m[35m            "Authorization": f"{auth_token_type} {access_token}",[0m
[30;1m962 | [0m[35m        }[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m    def build_token_info_request_headers(self):[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m953 | [0m[35m        if token_type.lower() == "bearer":[0m
[30;1m954 | [0m[35m            auth_token_type = "Bearer"[0m
[30;1m955 | [0m[35m        else:[0m
[30;1m956 | [0m[35m            auth_token_type = token_type[0m
[30;1m957 | [0m[35m[0m
[30;1m958 | [0m[35m        return {[0m
[30;1m959 | [0m[35m            "Accept": "application/json",[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m951 | [0m[35m[0m
[30;1m952 | [0m[35m        # token_type is case-insensitive, but the headers are case-sensitive[0m
[30;1m953 | [0m[35m        if token_type.lower() == "bearer":[0m
[30;1m954 | [0m[35m            auth_token_type = "Bearer"[0m
[30;1m955 | [0m[35m        else:[0m
[30;1m956 | [0m[35m            auth_token_type = token_type[0m
[30;1m957 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m782 | [0m[35m    )[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m    def _validate_server_cert_default(self):[0m
[30;1m785 | [0m[35m        env_value = os.getenv(self.validate_server_cert_env, "")[0m
[30;1m786 | [0m[35m        if env_value == "0":[0m
[30;1m787 | [0m[35m            return False[0m
[30;1m788 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m682 | [0m[35m[0m
[30;1m683 | [0m[35m    # Originally a GenericOAuthenticator only trait[0m
[30;1m684 | [0m[35m    basic_auth = Bool([0m
[30;1m685 | [0m[35m        os.environ.get("OAUTH2_BASIC_AUTH", "False").lower() in {"true", "1"},[0m
[30;1m686 | [0m[35m        config=True,[0m
[30;1m687 | [0m[35m        help="""[0m
[30;1m688 | [0m[35m        Whether or to use HTTP Basic authentication instead of form based[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m    # Originally a GenericOAuthenticator only trait[0m
[30;1m595 | [0m[35m    userdata_token_method = Unicode([0m
[30;1m596 | [0m[35m        os.environ.get("OAUTH2_USERDATA_REQUEST_TYPE", "header"),[0m
[30;1m597 | [0m[35m        config=True,[0m
[30;1m598 | [0m[35m        help="""[0m
[30;1m599 | [0m[35m        Method for sending access token in userdata request.[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m521 | [0m[35m        return proposal.value[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    username_claim = Union([0m
[30;1m524 | [0m[35m        [Unicode(os.environ.get('OAUTH2_USERNAME_KEY', 'username')), Callable()],[0m
[30;1m525 | [0m[35m        config=True,[0m
[30;1m526 | [0m[35m        help="""[0m
[30;1m527 | [0m[35m        When `userdata_url` returns a json response, the username will be taken[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m    @default("userdata_url")[0m
[30;1m512 | [0m[35m    def _userdata_url_default(self):[0m
[30;1m513 | [0m[35m        return os.environ.get("OAUTH2_USERDATA_URL", "")[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m    @validate("userdata_url")[0m
[30;1m516 | [0m[35m    def _validate_userdata_url(self, proposal):[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m473 | [0m[35m[0m
[30;1m474 | [0m[35m    @default("token_url")[0m
[30;1m475 | [0m[35m    def _token_url_default(self):[0m
[30;1m476 | [0m[35m        return os.environ.get("OAUTH2_TOKEN_URL", "")[0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m    userdata_from_id_token = Bool([0m
[30;1m479 | [0m[35m        False,[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m    @default("authorize_url")[0m
[30;1m456 | [0m[35m    def _authorize_url_default(self):[0m
[30;1m457 | [0m[35m        return os.environ.get("OAUTH2_AUTHORIZE_URL", "")[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m    token_url = Unicode([0m
[30;1m460 | [0m[35m        config=True,[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m40 | [0m[35m            # treated the same as GITHUB_URL[0m
[30;1m41 | [0m[35m            host = os.environ.get("GITHUB_HOST")[0m
[30;1m42 | [0m[35m            if host:[0m
[30;1m43 | [0m[35m                if os.environ.get("GITHUB_HTTP"):[0m
[30;1m44 | [0m[35m                    protocol = "http"[0m
[30;1m45 | [0m[35m                    warnings.warn([0m
[30;1m46 | [0m[35m                        "Use of GITHUB_HOST with GITHUB_HTTP might be deprecated in the future. "[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m38 | [0m[35m        if not github_url:[0m
[30;1m39 | [0m[35m            # fallback on older GITHUB_HOST config,[0m
[30;1m40 | [0m[35m            # treated the same as GITHUB_URL[0m
[30;1m41 | [0m[35m            host = os.environ.get("GITHUB_HOST")[0m
[30;1m42 | [0m[35m            if host:[0m
[30;1m43 | [0m[35m                if os.environ.get("GITHUB_HTTP"):[0m
[30;1m44 | [0m[35m                    protocol = "http"[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    @default("github_url")[0m
[30;1m36 | [0m[35m    def _github_url_default(self):[0m
[30;1m37 | [0m[35m        github_url = os.environ.get("GITHUB_URL")[0m
[30;1m38 | [0m[35m        if not github_url:[0m
[30;1m39 | [0m[35m            # fallback on older GITHUB_HOST config,[0m
[30;1m40 | [0m[35m            # treated the same as GITHUB_URL[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    @default("login_service")[0m
[30;1m20 | [0m[35m    def _login_service_default(self):[0m
[30;1m21 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "GitHub")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    @default("username_claim")[0m
[30;1m24 | [0m[35m    def _username_claim_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m70 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "CILogon")[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    cilogon_host = Unicode([0m
[30;1m73 | [0m[35m        os.environ.get("CILOGON_HOST") or "cilogon.org",[0m
[30;1m74 | [0m[35m        config=True,[0m
[30;1m75 | [0m[35m        help="""[0m
[30;1m76 | [0m[35m        Used to determine the default values for `authorize_url`, `token_url`,[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    @default("login_service")[0m
[30;1m69 | [0m[35m    def _login_service_default(self):[0m
[30;1m70 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "CILogon")[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    cilogon_host = Unicode([0m
[30;1m73 | [0m[35m        os.environ.get("CILOGON_HOST") or "cilogon.org",[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m180 | [0m[35m    @default('hosted_domain')[0m
[30;1m181 | [0m[35m    def _hosted_domain_from_env(self):[0m
[30;1m182 | [0m[35m        domains = [][0m
[30;1m183 | [0m[35m        for domain in os.environ.get('HOSTED_DOMAIN', '').lower().split(';'):[0m
[30;1m184 | [0m[35m            if domain:[0m
[30;1m185 | [0m[35m                # check falsy to avoid trailing separators[0m
[30;1m186 | [0m[35m                # adding empty domains[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    @default("login_service")[0m
[30;1m20 | [0m[35m    def _login_service_default(self):[0m
[30;1m21 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Google")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    @default("scope")[0m
[30;1m24 | [0m[35m    def _scope_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m        {attr_name: token_dict.get(attr_name) for attr_name in token_attrs}[0m
[30;1m107 | [0m[35m        for token_dict in mock_globus_token_response['other_tokens'][0m
[30;1m108 | [0m[35m    ][0m
[30;1m109 | [0m[35m    tokens = other_tokens + [auth_token_dict][0m
[30;1m110 | [0m[35m    return {token_dict['resource_server']: token_dict for token_dict in tokens}[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m        'refresh_token',[0m
[30;1m99 | [0m[35m        'access_token',[0m
[30;1m100 | [0m[35m    ][0m
[30;1m101 | [0m[35m    auth_token_dict = {[0m
[30;1m102 | [0m[35m        attr_name: mock_globus_token_response.get(attr_name)[0m
[30;1m103 | [0m[35m        for attr_name in token_attrs[0m
[30;1m104 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/azuread.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    @default('tenant_id')[0m
[30;1m58 | [0m[35m    def _tenant_id_default(self):[0m
[30;1m59 | [0m[35m        return os.environ.get('AAD_TENANT_ID', '')[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    @default("authorize_url")[0m
[30;1m62 | [0m[35m    def _authorize_url_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/azuread.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    @default("login_service")[0m
[30;1m18 | [0m[35m    def _login_service_default(self):[0m
[30;1m19 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Azure AD")[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    @default("username_claim")[0m
[30;1m22 | [0m[35m    def _username_claim_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/generic.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "OAuth 2.0")[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    claim_groups_key = Union([0m
[30;1m21 | [0m[35m        [Unicode(os.environ.get('OAUTH2_GROUPS_KEY', 'groups')), Callable()],[0m
[30;1m22 | [0m[35m        config=True,[0m
[30;1m23 | [0m[35m        help="""[0m
[30;1m24 | [0m[35m        .. deprecated:: 17.0[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/generic.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m15 | [0m[35mclass GenericOAuthenticator(OAuthenticator):[0m
[30;1m16 | [0m[35m    @default("login_service")[0m
[30;1m17 | [0m[35m    def _login_service_default(self):[0m
[30;1m18 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "OAuth 2.0")[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    claim_groups_key = Union([0m
[30;1m21 | [0m[35m        [Unicode(os.environ.get('OAUTH2_GROUPS_KEY', 'groups')), Callable()],[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/openshift.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m40 | [0m[35m        return {}[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    openshift_url = Unicode([0m
[30;1m43 | [0m[35m        os.environ.get('OPENSHIFT_URL')[0m
[30;1m44 | [0m[35m        or 'https://openshift.default.svc.cluster.local',[0m
[30;1m45 | [0m[35m        config=True,[0m
[30;1m46 | [0m[35m        help="""[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/openshift.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    @default("login_service")[0m
[30;1m28 | [0m[35m    def _login_service_default(self):[0m
[30;1m29 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "OpenShift")[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    @default("username_claim")[0m
[30;1m32 | [0m[35m    def _username_claim_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/auth0.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    @default("login_service")[0m
[30;1m17 | [0m[35m    def _login_service_default(self):[0m
[30;1m18 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Auth0")[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    @default("username_claim")[0m
[30;1m21 | [0m[35m    def _username_claim_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35mblue?logo=discourse)](https://discourse.jupyter.org/c/jupyterhub)[0m
[30;1m48 | [0m[35m[![Gitter](https://img.shields.io/badge/social_chat-gitter-blue?logo=gitter)](https://gitter.im/jupy[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m[OAuth](https://en.wikipedia.org/wiki/OAuth) is a token based login mechanism that doesn't rely on a[0m
[30;1m51 | [0m[35mIn order to use this login mechanism with JupyerHub the login handlers need to be overridden.[0m
[30;1m52 | [0m[35mOAuthenticator overrides these handlers for the common OAuth2 identity providers allowing them to be[0m
[30;1m53 | [0m[35mplugged in and used with JupyterHub.[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35mblue?logo=discourse)](https://discourse.jupyter.org/c/jupyterhub)[0m
[30;1m9 | [0m[35m[![Gitter](https://img.shields.io/badge/social_chat-gitter-blue?logo=gitter)](https://gitter.im/jupy[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m[OAuth](https://en.wikipedia.org/wiki/OAuth) is a token based login mechanism that doesn't rely on a[0m
[30;1m12 | [0m[35mIn order to use this login mechanism with JupyerHub the login handlers need to be overridden.[0m
[30;1m13 | [0m[35mOAuthenticator overrides these handlers for the common OAuth2 identity providers allowing them to be[0m
[30;1m14 | [0m[35mplugged in and used with JupyterHub.[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/gitlab.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    @default("gitlab_api_version")[0m
[30;1m88 | [0m[35m    def _gitlab_api_version_default(self):[0m
[30;1m89 | [0m[35m        return os.environ.get("GITLAB_API_VERSION") or "4"[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    gitlab_api = Unicode([0m
[30;1m92 | [0m[35m        config=True,[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/gitlab.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    @default("login_service")[0m
[30;1m30 | [0m[35m    def _login_service_default(self):[0m
[30;1m31 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "GitLab")[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    gitlab_url = Unicode([0m
[30;1m34 | [0m[35m        config=True,[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/mediawiki.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m86 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "MediaWiki")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    mw_index_url = Unicode([0m
[30;1m89 | [0m[35m        os.environ.get('MW_INDEX_URL', 'https://meta.wikimedia.org/w/index.php'),[0m
[30;1m90 | [0m[35m        config=True,[0m
[30;1m91 | [0m[35m        help="""[0m
[30;1m92 | [0m[35m        Full path to index.php of the MW instance to use to log in[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/mediawiki.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    @default("login_service")[0m
[30;1m85 | [0m[35m    def _login_service_default(self):[0m
[30;1m86 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "MediaWiki")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    mw_index_url = Unicode([0m
[30;1m89 | [0m[35m        os.environ.get('MW_INDEX_URL', 'https://meta.wikimedia.org/w/index.php'),[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m244 | [0m[35m            {attr_name: token_dict.get(attr_name) for attr_name in token_attrs}[0m
[30;1m245 | [0m[35m            for token_dict in token_info['other_tokens'][0m
[30;1m246 | [0m[35m        ][0m
[30;1m247 | [0m[35m        return other_tokens + [auth_token_dict][0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    def build_auth_state_dict(self, token_info, user_info):[0m
[30;1m250 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m235 | [0m[35m        # id token. The id token has some useful information in it, but nothing that[0m
[30;1m236 | [0m[35m        # can't be retrieved with an Auth token.[0m
[30;1m237 | [0m[35m        # Repackage the Auth token into a dict that looks like the other tokens[0m
[30;1m238 | [0m[35m        auth_token_dict = {[0m
[30;1m239 | [0m[35m            attr_name: token_info.get(attr_name) for attr_name in token_attrs[0m
[30;1m240 | [0m[35m        }[0m
[30;1m241 | [0m[35m        # Make sure only the essentials make it into tokens. Other items, such as 'state' are[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    @default("login_service")[0m
[30;1m74 | [0m[35m    def _login_service_default(self):[0m
[30;1m75 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Globus")[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    @default("userdata_url")[0m
[30;1m78 | [0m[35m    def _userdata_url_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m    def get_client_credential_headers(self):[0m
[30;1m373 | [0m[35m        headers = self.get_default_headers()[0m
[30;1m374 | [0m[35m        b64key = base64.b64encode([0m
[30;1m375 | [0m[35m            bytes(f"{self.client_id}:{self.client_secret}", "utf8")[0m
[30;1m376 | [0m[35m        )[0m
[30;1m377 | [0m[35m        headers["Authorization"] = "Basic {}".format(b64key.decode("utf8"))[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m217 | [0m[35m        spawner.environment['GLOBUS_LOCAL_ENDPOINT'] = self.globus_local_endpoint[0m
[30;1m218 | [0m[35m        state = await user.get_auth_state()[0m
[30;1m219 | [0m[35m        if state:[0m
[30;1m220 | [0m[35m            globus_data = base64.b64encode(pickle.dumps(state))[0m
[30;1m221 | [0m[35m            spawner.environment['GLOBUS_DATA'] = globus_data.decode('utf-8')[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m    def get_globus_tokens(self, token_info):[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m2 | [0m[35mA JupyterHub authenticator class for use with Globus as an identity provider.[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport pickle[0m
[30;1m8 | [0m[35mimport urllib[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator.egg-info/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35mblue?logo=discourse)](https://discourse.jupyter.org/c/jupyterhub)[0m
[30;1m48 | [0m[35m[![Gitter](https://img.shields.io/badge/social_chat-gitter-blue?logo=gitter)](https://gitter.im/jupy[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m[OAuth](https://en.wikipedia.org/wiki/OAuth) is a token based login mechanism that doesn't rely on a[0m
[30;1m51 | [0m[35mIn order to use this login mechanism with JupyerHub the login handlers need to be overridden.[0m
[30;1m52 | [0m[35mOAuthenticator overrides these handlers for the common OAuth2 identity providers allowing them to be[0m
[30;1m53 | [0m[35mplugged in and used with JupyterHub.[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m136 | [0m[35m    handler = Mock([0m
[30;1m137 | [0m[35m        spec=web.RequestHandler,[0m
[30;1m138 | [0m[35m        get_secure_cookie=Mock(return_value=json.dumps(['key', 'secret'])),[0m
[30;1m139 | [0m[35m        request=Mock(query='oauth_token=key&oauth_verifier=me'),[0m
[30;1m140 | [0m[35m        find_user=Mock(return_value=None),[0m
[30;1m141 | [0m[35m    )[0m
[30;1m142 | [0m[35m    auth_model = await authenticator.get_authenticated_user(handler, None)[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m        mock.post([0m
[30;1m41 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Ftoken',[0m
[30;1m42 | [0m[35m            text='oauth_token=key&oauth_token_secret=secret',[0m
[30;1m43 | [0m[35m        )[0m
[30;1m44 | [0m[35m        mock.post('/w/index.php?title=Special%3AOAuth%2Fidentify', content=post_token)[0m
[30;1m45 | [0m[35m        yield mock[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m        mock.post([0m
[30;1m41 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Ftoken',[0m
[30;1m42 | [0m[35m            text='oauth_token=key&oauth_token_secret=secret',[0m
[30;1m43 | [0m[35m        )[0m
[30;1m44 | [0m[35m        mock.post('/w/index.php?title=Special%3AOAuth%2Fidentify', content=post_token)[0m
[30;1m45 | [0m[35m        yield mock[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35m    with requests_mock.Mocker() as mock:[0m
[30;1m36 | [0m[35m        mock.post([0m
[30;1m37 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Finitiate',[0m
[30;1m38 | [0m[35m            text='oauth_token=key&oauth_token_secret=secret',[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m        mock.post([0m
[30;1m41 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Ftoken',[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35m    with requests_mock.Mocker() as mock:[0m
[30;1m36 | [0m[35m        mock.post([0m
[30;1m37 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Finitiate',[0m
[30;1m38 | [0m[35m            text='oauth_token=key&oauth_token_secret=secret',[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m        mock.post([0m
[30;1m41 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Ftoken',[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m58 | [0m[35m                'scope': 'urn:globus:auth:scope:transfer.api.globus.org:all',[0m
[30;1m59 | [0m[35m            },[0m
[30;1m60 | [0m[35m            {[0m
[30;1m61 | [0m[35m                'access_token': '309f9e6367d1ffffae0da625cb87b9ac543ee72a',[0m
[30;1m62 | [0m[35m                'expires_in': 172800,[0m
[30;1m63 | [0m[35m                'resource_server': 'groups.api.globus.org',[0m
[30;1m64 | [0m[35m                'token_type': 'Bearer',[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m42 | [0m[35m        '91dCwgdG8gdGhlIGJsYWNrClRlbGwgJ2VtIEkgYWluJ3QgY29taW5nIGJh'[0m
[30;1m43 | [0m[35m        'Y2sKQnVybiB0aGUgbGFuZCBhbmQgYm9pbCB0aGUgc2VhCllvdSBjYW4ndC'[0m
[30;1m44 | [0m[35m        'B0YWtlIHRoZSBza3kgZnJvbSBtZQpUaGVyZSdzIG5vIHBsYWNlIEkgY2Fu'[0m
[30;1m45 | [0m[35m        'IGJlClNpbmNlIEkgZm91bmQgc2VyZW5pdHkKWW91IGNhbid0IHRha2UgdG'[0m
[30;1m46 | [0m[35m        'hlIHNreSBmcm9tIG1lCg==',[0m
[30;1m47 | [0m[35m        'expires_in': 172800,[0m
[30;1m48 | [0m[35m        'resource_server': 'auth.globus.org',[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m41 | [0m[35m        'cmVlCllvdSBjYW4ndCB0YWtlIHRoZSBza3kgZnJvbSBtZQpUYWtlIG1lIG'[0m
[30;1m42 | [0m[35m        '91dCwgdG8gdGhlIGJsYWNrClRlbGwgJ2VtIEkgYWluJ3QgY29taW5nIGJh'[0m
[30;1m43 | [0m[35m        'Y2sKQnVybiB0aGUgbGFuZCBhbmQgYm9pbCB0aGUgc2VhCllvdSBjYW4ndC'[0m
[30;1m44 | [0m[35m        'B0YWtlIHRoZSBza3kgZnJvbSBtZQpUaGVyZSdzIG5vIHBsYWNlIEkgY2Fu'[0m
[30;1m45 | [0m[35m        'IGJlClNpbmNlIEkgZm91bmQgc2VyZW5pdHkKWW91IGNhbid0IHRha2UgdG'[0m
[30;1m46 | [0m[35m        'hlIHNreSBmcm9tIG1lCg==',[0m
[30;1m47 | [0m[35m        'expires_in': 172800,[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m40 | [0m[35m        'BjYW5ub3Qgc3RhbmQKSSBkb24ndCBjYXJlIGNhdXNlIEknbSBzdGlsbCBm'[0m
[30;1m41 | [0m[35m        'cmVlCllvdSBjYW4ndCB0YWtlIHRoZSBza3kgZnJvbSBtZQpUYWtlIG1lIG'[0m
[30;1m42 | [0m[35m        '91dCwgdG8gdGhlIGJsYWNrClRlbGwgJ2VtIEkgYWluJ3QgY29taW5nIGJh'[0m
[30;1m43 | [0m[35m        'Y2sKQnVybiB0aGUgbGFuZCBhbmQgYm9pbCB0aGUgc2VhCllvdSBjYW4ndC'[0m
[30;1m44 | [0m[35m        'B0YWtlIHRoZSBza3kgZnJvbSBtZQpUaGVyZSdzIG5vIHBsYWNlIEkgY2Fu'[0m
[30;1m45 | [0m[35m        'IGJlClNpbmNlIEkgZm91bmQgc2VyZW5pdHkKWW91IGNhbid0IHRha2UgdG'[0m
[30;1m46 | [0m[35m        'hlIHNreSBmcm9tIG1lCg==',[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m39 | [0m[35m        'id_token': 'ClRha2UgbXkgbG92ZSwgdGFrZSBteSBsYW5kClRha2UgbWUgd2hlcmUgSS'[0m
[30;1m40 | [0m[35m        'BjYW5ub3Qgc3RhbmQKSSBkb24ndCBjYXJlIGNhdXNlIEknbSBzdGlsbCBm'[0m
[30;1m41 | [0m[35m        'cmVlCllvdSBjYW4ndCB0YWtlIHRoZSBza3kgZnJvbSBtZQpUYWtlIG1lIG'[0m
[30;1m42 | [0m[35m        '91dCwgdG8gdGhlIGJsYWNrClRlbGwgJ2VtIEkgYWluJ3QgY29taW5nIGJh'[0m
[30;1m43 | [0m[35m        'Y2sKQnVybiB0aGUgbGFuZCBhbmQgYm9pbCB0aGUgc2VhCllvdSBjYW4ndC'[0m
[30;1m44 | [0m[35m        'B0YWtlIHRoZSBza3kgZnJvbSBtZQpUaGVyZSdzIG5vIHBsYWNlIEkgY2Fu'[0m
[30;1m45 | [0m[35m        'IGJlClNpbmNlIEkgZm91bmQgc2VyZW5pdHkKWW91IGNhbid0IHRha2UgdG'[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m38 | [0m[35m        'access_token': 'de48bedc44b79937f7aa67',[0m
[30;1m39 | [0m[35m        'id_token': 'ClRha2UgbXkgbG92ZSwgdGFrZSBteSBsYW5kClRha2UgbWUgd2hlcmUgSS'[0m
[30;1m40 | [0m[35m        'BjYW5ub3Qgc3RhbmQKSSBkb24ndCBjYXJlIGNhdXNlIEknbSBzdGlsbCBm'[0m
[30;1m41 | [0m[35m        'cmVlCllvdSBjYW4ndCB0YWtlIHRoZSBza3kgZnJvbSBtZQpUYWtlIG1lIG'[0m
[30;1m42 | [0m[35m        '91dCwgdG8gdGhlIGJsYWNrClRlbGwgJ2VtIEkgYWluJ3QgY29taW5nIGJh'[0m
[30;1m43 | [0m[35m        'Y2sKQnVybiB0aGUgbGFuZCBhbmQgYm9pbCB0aGUgc2VhCllvdSBjYW4ndC'[0m
[30;1m44 | [0m[35m        'B0YWtlIHRoZSBza3kgZnJvbSBtZQpUaGVyZSdzIG5vIHBsYWNlIEkgY2Fu'[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m37 | [0m[35m    return {[0m
[30;1m38 | [0m[35m        'access_token': 'de48bedc44b79937f7aa67',[0m
[30;1m39 | [0m[35m        'id_token': 'ClRha2UgbXkgbG92ZSwgdGFrZSBteSBsYW5kClRha2UgbWUgd2hlcmUgSS'[0m
[30;1m40 | [0m[35m        'BjYW5ub3Qgc3RhbmQKSSBkb24ndCBjYXJlIGNhdXNlIEknbSBzdGlsbCBm'[0m
[30;1m41 | [0m[35m        'cmVlCllvdSBjYW4ndCB0YWtlIHRoZSBza3kgZnJvbSBtZQpUYWtlIG1lIG'[0m
[30;1m42 | [0m[35m        '91dCwgdG8gdGhlIGJsYWNrClRlbGwgJ2VtIEkgYWluJ3QgY29taW5nIGJh'[0m
[30;1m43 | [0m[35m        'Y2sKQnVybiB0aGUgbGFuZCBhbmQgYm9pbCB0aGUgc2VhCllvdSBjYW4ndC'[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m36 | [0m[35mdef mock_globus_token_response():[0m
[30;1m37 | [0m[35m    return {[0m
[30;1m38 | [0m[35m        'access_token': 'de48bedc44b79937f7aa67',[0m
[30;1m39 | [0m[35m        'id_token': 'ClRha2UgbXkgbG92ZSwgdGFrZSBteSBsYW5kClRha2UgbWUgd2hlcmUgSS'[0m
[30;1m40 | [0m[35m        'BjYW5ub3Qgc3RhbmQKSSBkb24ndCBjYXJlIGNhdXNlIEknbSBzdGlsbCBm'[0m
[30;1m41 | [0m[35m        'cmVlCllvdSBjYW4ndCB0YWtlIHRoZSBza3kgZnJvbSBtZQpUYWtlIG1lIG'[0m
[30;1m42 | [0m[35m        '91dCwgdG8gdGhlIGJsYWNrClRlbGwgJ2VtIEkgYWluJ3QgY29taW5nIGJh'[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_azuread.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m35 | [0m[35m        {[0m
[30;1m36 | [0m[35m            "ver": "2.0",[0m
[30;1m37 | [0m[35m            "iss": f"https://login.microsoftonline.com/{tenant_id}/v2.0",[0m
[30;1m38 | [0m[35m            "sub": "AAAAAAAAAAAAAAAAAAAAAIkzqFVrSaSaFHy782bbtaQ",[0m
[30;1m39 | [0m[35m            "aud": client_id,[0m
[30;1m40 | [0m[35m            "exp": now + 3600,[0m
[30;1m41 | [0m[35m            "iat": now,[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/bitbucket.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m            return True[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m        if self.allowed_teams:[0m
[30;1m96 | [0m[35m            user_teams = set(auth_model["auth_state"].get("user_teams", []))[0m
[30;1m97 | [0m[35m            if user_teams & self.allowed_teams:[0m
[30;1m98 | [0m[35m                return True[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/bitbucket.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m        user_teams = set()[0m
[30;1m66 | [0m[35m        while next_page:[0m
[30;1m67 | [0m[35m            resp_json = await self.httpfetch(next_page, method="GET", headers=headers)[0m
[30;1m68 | [0m[35m            next_page = resp_json.get('next', None)[0m
[30;1m69 | [0m[35m            user_teams |= {entry["name"] for entry in resp_json["values"]}[0m
[30;1m70 | [0m[35m        return user_teams[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/bitbucket.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    @default("login_service")[0m
[30;1m20 | [0m[35m    def _login_service_default(self):[0m
[30;1m21 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Bitbucket")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    @default("authorize_url")[0m
[30;1m24 | [0m[35m    def _authorize_url_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1526 | [0m[35m            new_attr, version, same = self._deprecated_oauth_aliases.get(old_attr)[0m
[30;1m1527 | [0m[35m        except ValueError:[0m
[30;1m1528 | [0m[35m            # if `same` flag wasn't passed, we assume the new and old trait have the same type[0m
[30;1m1529 | [0m[35m            new_attr, version = self._deprecated_oauth_aliases.get(old_attr)[0m
[30;1m1530 | [0m[35m            same = True[0m
[30;1m1531 | [0m[35m[0m
[30;1m1532 | [0m[35m        new_value = getattr(self, new_attr)[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1523 | [0m[35m        """observer for deprecated traits"""[0m
[30;1m1524 | [0m[35m        old_attr = change.name[0m
[30;1m1525 | [0m[35m        try:[0m
[30;1m1526 | [0m[35m            new_attr, version, same = self._deprecated_oauth_aliases.get(old_attr)[0m
[30;1m1527 | [0m[35m        except ValueError:[0m
[30;1m1528 | [0m[35m            # if `same` flag wasn't passed, we assume the new and old trait have the same type[0m
[30;1m1529 | [0m[35m            new_attr, version = self._deprecated_oauth_aliases.get(old_attr)[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1500 | [0m[35m            return True[0m
[30;1m1501 | [0m[35m[0m
[30;1m1502 | [0m[35m        # allow users who are members of allowed_groups[0m
[30;1m1503 | [0m[35m        if self.manage_groups and self.allowed_groups and auth_model.get("groups"):[0m
[30;1m1504 | [0m[35m            if set(auth_model["groups"]) & self.allowed_groups:[0m
[30;1m1505 | [0m[35m                return True[0m
[30;1m1506 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1479 | [0m[35m[0m
[30;1m1480 | [0m[35m        # Allow users who have been granted specific scopes that grant them entry[0m
[30;1m1481 | [0m[35m        if self.allowed_scopes:[0m
[30;1m1482 | [0m[35m            granted_scopes = auth_model.get('auth_state', {}).get('scope', [])[0m
[30;1m1483 | [0m[35m            missing_scopes = set(self.allowed_scopes) - set(granted_scopes)[0m
[30;1m1484 | [0m[35m            if not missing_scopes:[0m
[30;1m1485 | [0m[35m                message = f"Granting access to user {username}, as they had {self.allowed_scopes}"[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1479 | [0m[35m[0m
[30;1m1480 | [0m[35m        # Allow users who have been granted specific scopes that grant them entry[0m
[30;1m1481 | [0m[35m        if self.allowed_scopes:[0m
[30;1m1482 | [0m[35m            granted_scopes = auth_model.get('auth_state', {}).get('scope', [])[0m
[30;1m1483 | [0m[35m            missing_scopes = set(self.allowed_scopes) - set(granted_scopes)[0m
[30;1m1484 | [0m[35m            if not missing_scopes:[0m
[30;1m1485 | [0m[35m                message = f"Granting access to user {username}, as they had {self.allowed_scopes}"[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1410 | [0m[35m                )[0m
[30;1m1411 | [0m[35m            # refresh_token may not be returned when refreshing a token[0m
[30;1m1412 | [0m[35m            # in which case, keep the current one[0m
[30;1m1413 | [0m[35m            if not token_info.get("refresh_token"):[0m
[30;1m1414 | [0m[35m                token_info["refresh_token"] = refresh_token[0m
[30;1m1415 | [0m[35m            try:[0m
[30;1m1416 | [0m[35m                auth_model = await self._token_to_auth_model(token_info)[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1390 | [0m[35m                )[0m
[30;1m1391 | [0m[35m            else:[0m
[30;1m1392 | [0m[35m                raise[0m
[30;1m1393 | [0m[35m        refresh_token = auth_state.get("refresh_token", None)[0m
[30;1m1394 | [0m[35m        if refresh_token and not auth_model:[0m
[30;1m1395 | [0m[35m            self.log.info(f"Refreshing oauth access token for {user.name}")[0m
[30;1m1396 | [0m[35m            # access_token expired, try refreshing with refresh_token[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1377 | [0m[35m            )[0m
[30;1m1378 | [0m[35m            return False[0m
[30;1m1379 | [0m[35m[0m
[30;1m1380 | [0m[35m        token_info = auth_state.get("token_response")[0m
[30;1m1381 | [0m[35m        auth_model = None[0m
[30;1m1382 | [0m[35m        try:[0m
[30;1m1383 | [0m[35m            auth_model = await self._token_to_auth_model(token_info)[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1198 | [0m[35m[0m
[30;1m1199 | [0m[35m        refresh_token = token_info.get("refresh_token", None)[0m
[30;1m1200 | [0m[35m        id_token = token_info.get("id_token", None)[0m
[30;1m1201 | [0m[35m        scope = token_info.get("scope", "")[0m
[30;1m1202 | [0m[35m[0m
[30;1m1203 | [0m[35m        if isinstance(scope, str):[0m
[30;1m1204 | [0m[35m            scope = scope.split(" ")[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1197 | [0m[35m        access_token = token_info["access_token"][0m
[30;1m1198 | [0m[35m[0m
[30;1m1199 | [0m[35m        refresh_token = token_info.get("refresh_token", None)[0m
[30;1m1200 | [0m[35m        id_token = token_info.get("id_token", None)[0m
[30;1m1201 | [0m[35m        scope = token_info.get("scope", "")[0m
[30;1m1202 | [0m[35m[0m
[30;1m1203 | [0m[35m        if isinstance(scope, str):[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1196 | [0m[35m        # We know for sure the `access_token` key exists, otherwise we would have errored out alread[0m
[30;1m1197 | [0m[35m        access_token = token_info["access_token"][0m
[30;1m1198 | [0m[35m[0m
[30;1m1199 | [0m[35m        refresh_token = token_info.get("refresh_token", None)[0m
[30;1m1200 | [0m[35m        id_token = token_info.get("id_token", None)[0m
[30;1m1201 | [0m[35m        scope = token_info.get("scope", "")[0m
[30;1m1202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1125 | [0m[35m        """[0m
[30;1m1126 | [0m[35m        if self.userdata_from_id_token:[0m
[30;1m1127 | [0m[35m            # Use id token instead of exchanging access token with userinfo endpoint.[0m
[30;1m1128 | [0m[35m            id_token = token_info.get("id_token", None)[0m
[30;1m1129 | [0m[35m            if not id_token:[0m
[30;1m1130 | [0m[35m                raise web.HTTPError([0m
[30;1m1131 | [0m[35m                    500,[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1039 | [0m[35m            if not cookie_state:[0m
[30;1m1040 | [0m[35m                raise web.HTTPError(400, "OAuth state missing from cookies")[0m
[30;1m1041 | [0m[35m[0m
[30;1m1042 | [0m[35m            code_verifier = _deserialize_state(cookie_state).get("code_verifier")[0m
[30;1m1043 | [0m[35m            if not code_verifier:[0m
[30;1m1044 | [0m[35m                raise web.HTTPError(400, "Missing code_verifier")[0m
[30;1m1045 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1005 | [0m[35m        if callable(self.username_claim):[0m
[30;1m1006 | [0m[35m            username = self.username_claim(user_info)[0m
[30;1m1007 | [0m[35m        else:[0m
[30;1m1008 | [0m[35m            username = user_info.get(self.username_claim, None)[0m
[30;1m1009 | [0m[35m        if not username:[0m
[30;1m1010 | [0m[35m            message = ([0m
[30;1m1011 | [0m[35m                f"No {self.username_claim} found in {user_info}. Maybe the hub needs to be configure[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m682 | [0m[35m[0m
[30;1m683 | [0m[35m    # Originally a GenericOAuthenticator only trait[0m
[30;1m684 | [0m[35m    basic_auth = Bool([0m
[30;1m685 | [0m[35m        os.environ.get("OAUTH2_BASIC_AUTH", "False").lower() in {"true", "1"},[0m
[30;1m686 | [0m[35m        config=True,[0m
[30;1m687 | [0m[35m        help="""[0m
[30;1m688 | [0m[35m        Whether or to use HTTP Basic authentication instead of form based[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m    # Originally a GenericOAuthenticator only trait[0m
[30;1m595 | [0m[35m    userdata_token_method = Unicode([0m
[30;1m596 | [0m[35m        os.environ.get("OAUTH2_USERDATA_REQUEST_TYPE", "header"),[0m
[30;1m597 | [0m[35m        config=True,[0m
[30;1m598 | [0m[35m        help="""[0m
[30;1m599 | [0m[35m        Method for sending access token in userdata request.[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m521 | [0m[35m        return proposal.value[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    username_claim = Union([0m
[30;1m524 | [0m[35m        [Unicode(os.environ.get('OAUTH2_USERNAME_KEY', 'username')), Callable()],[0m
[30;1m525 | [0m[35m        config=True,[0m
[30;1m526 | [0m[35m        help="""[0m
[30;1m527 | [0m[35m        When `userdata_url` returns a json response, the username will be taken[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m    @default("userdata_url")[0m
[30;1m512 | [0m[35m    def _userdata_url_default(self):[0m
[30;1m513 | [0m[35m        return os.environ.get("OAUTH2_USERDATA_URL", "")[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m    @validate("userdata_url")[0m
[30;1m516 | [0m[35m    def _validate_userdata_url(self, proposal):[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m[0m
[30;1m474 | [0m[35m    @default("token_url")[0m
[30;1m475 | [0m[35m    def _token_url_default(self):[0m
[30;1m476 | [0m[35m        return os.environ.get("OAUTH2_TOKEN_URL", "")[0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m    userdata_from_id_token = Bool([0m
[30;1m479 | [0m[35m        False,[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m    @default("authorize_url")[0m
[30;1m456 | [0m[35m    def _authorize_url_default(self):[0m
[30;1m457 | [0m[35m        return os.environ.get("OAUTH2_AUTHORIZE_URL", "")[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m    token_url = Unicode([0m
[30;1m460 | [0m[35m        config=True,[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m        """Get the redirect target from the state field"""[0m
[30;1m233 | [0m[35m        state = self.get_state_cookie()[0m
[30;1m234 | [0m[35m        if state:[0m
[30;1m235 | [0m[35m            next_url = _deserialize_state(state).get("next_url")[0m
[30;1m236 | [0m[35m            if next_url:[0m
[30;1m237 | [0m[35m                return next_url[0m
[30;1m238 | [0m[35m        # JupyterHub 0.8 adds default .get_next_url for a fallback[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m        if not url_state:[0m
[30;1m188 | [0m[35m            raise web.HTTPError(400, "OAuth state missing from URL")[0m
[30;1m189 | [0m[35m        cookie_state_id = _deserialize_state(cookie_state).get('state_id')[0m
[30;1m190 | [0m[35m        url_state_id = _deserialize_state(url_state).get('state_id')[0m
[30;1m191 | [0m[35m        if cookie_state_id != url_state_id:[0m
[30;1m192 | [0m[35m            self.log.warning([0m
[30;1m193 | [0m[35m                f"OAuth state mismatch: {cookie_state_id} != {url_state_id}"[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m            raise web.HTTPError(400, "OAuth state missing from cookies")[0m
[30;1m187 | [0m[35m        if not url_state:[0m
[30;1m188 | [0m[35m            raise web.HTTPError(400, "OAuth state missing from URL")[0m
[30;1m189 | [0m[35m        cookie_state_id = _deserialize_state(cookie_state).get('state_id')[0m
[30;1m190 | [0m[35m        url_state_id = _deserialize_state(url_state).get('state_id')[0m
[30;1m191 | [0m[35m        if cookie_state_id != url_state_id:[0m
[30;1m192 | [0m[35m            self.log.warning([0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m.hostname[0m
[30;1m112 | [0m[35m        if next_url:[0m
[30;1m113 | [0m[35m            # avoid browsers treating \ as /[0m
[30;1m114 | [0m[35m            next_url = next_url.replace("\\", quote("\\"))[0m
[30;1m115 | [0m[35m            # disallow hostname-having urls,[0m
[30;1m116 | [0m[35m            # force absolute path redirect[0m
[30;1m117 | [0m[35m            urlinfo = urlparse(next_url)[0m
[30;1m118 | [0m[35m            next_url = urlinfo._replace([0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1568 | [0m[35m].help = """[0m
[30;1m1569 | [0m[35mSet of usernames that should be allowed to login.[0m
[30;1m1570 | [0m[35m[0m
[30;1m1571 | [0m[35mIf unspecified, grants no access. You must set at least one other `allow` configuration[0m
[30;1m1572 | [0m[35mif any users are to have permission to access the Hub.[0m
[30;1m1573 | [0m[35m[0m
[30;1m1574 | [0m[35mAny usernames in `admin_users` will also be allowed to login.[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1450 | [0m[35m            "auth_state": auth_state,[0m
[30;1m1451 | [0m[35m        }[0m
[30;1m1452 | [0m[35m[0m
[30;1m1453 | [0m[35m        # update the auth_model with info to later authorize the user in[0m
[30;1m1454 | [0m[35m        # check_allowed, such as admin status and group memberships[0m
[30;1m1455 | [0m[35m        auth_model = await self.update_auth_model(auth_model)[0m
[30;1m1456 | [0m[35m        if self.manage_groups:[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1263 | [0m[35m        Called by :meth:`.authenticate` and :meth:`.refresh_user`.[0m
[30;1m1264 | [0m[35m        """[0m
[30;1m1265 | [0m[35m        # NOTE: this base implementation should _not_ be updated to do anything[0m
[30;1m1266 | [0m[35m        # subclasses should have full control without calling super()[0m
[30;1m1267 | [0m[35m        return auth_model[0m
[30;1m1268 | [0m[35m[0m
[30;1m1269 | [0m[35m    async def _apply_managed_groups(self, auth_model):[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m327 | [0m[35m        .. warning::[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m           Before enabling this you should review the existing users in the[0m
[30;1m330 | [0m[35m           JupyterHub admin panel at `/hub/admin`. You may find users existing[0m
[30;1m331 | [0m[35m           there because they have previously been declared in config such as[0m
[30;1m332 | [0m[35m           `allowed_users` or allowed to sign in.[0m
[30;1m333 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m        .. warning::[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m           When this is enabled and you wish to remove access for one or more[0m
[30;1m337 | [0m[35m           users previously allowed, you must make sure that they[0m
[30;1m338 | [0m[35m           are removed from the jupyterhub database. This can be tricky to do[0m
[30;1m339 | [0m[35m           if you stop allowing a group of externally managed users for example.[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m        .. warning::[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m           Before enabling this you should review the existing users in the[0m
[30;1m330 | [0m[35m           JupyterHub admin panel at `/hub/admin`. You may find users existing[0m
[30;1m331 | [0m[35m           there because they have previously been declared in config such as[0m
[30;1m332 | [0m[35m           `allowed_users` or allowed to sign in.[0m
[30;1m333 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m        "OAuth 2.0",[0m
[30;1m289 | [0m[35m        config=True,[0m
[30;1m290 | [0m[35m        help="""[0m
[30;1m291 | [0m[35m        Name of the login service or identity provider that this authenticator[0m
[30;1m292 | [0m[35m        is using to authenticate users.[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        This config influences the text on a button shown to unauthenticated[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef _serialize_state(state):[0m
[30;1m49 | [0m[35m    """Serialize OAuth state to a base64 string after passing through JSON"""[0m
[30;1m50 | [0m[35m    json_state = json.dumps(state)[0m
[30;1m51 | [0m[35m    return base64.urlsafe_b64encode(json_state.encode("utf8")).decode("ascii")[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/oauth2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mFounded based on work by Kyle Kelley (@rgbkrk)[0m
[30;1m5 | [0m[35m"""[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport hashlib[0m
[30;1m9 | [0m[35mimport json[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport secrets[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m        else:[0m
[30;1m326 | [0m[35m            try:[0m
[30;1m327 | [0m[35m                resp_json = json.loads((resp.body or b'').decode('utf8', 'replace'))[0m
[30;1m328 | [0m[35m                message = resp_json.get('message', '')[0m
[30;1m329 | [0m[35m            except ValueError:[0m
[30;1m330 | [0m[35m                message = ''[0m
[30;1m331 | [0m[35m            self.log.debug([0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m            next_url = None[0m
[30;1m274 | [0m[35m            # Look through all links to see if there is a 'next' link present[0m
[30;1m275 | [0m[35m            for l in links:[0m
[30;1m276 | [0m[35m                if l.get('rel') == 'next':[0m
[30;1m277 | [0m[35m                    next_url = l['url'][0m
[30;1m278 | [0m[35m                    break[0m
[30;1m279 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m            content += resp_json[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m            # Check if a Link header is present, with a collection of pagination links[0m
[30;1m265 | [0m[35m            links_header = resp.headers.get('Link')[0m
[30;1m266 | [0m[35m            if not links_header:[0m
[30;1m267 | [0m[35m                # If Link header is not present, we just exit[0m
[30;1m268 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        # Note that the read:user scope does not imply the user:emails scope![0m
[30;1m209 | [0m[35m        access_token = auth_model["auth_state"]["token_response"]["access_token"][0m
[30;1m210 | [0m[35m        token_type = auth_model["auth_state"]["token_response"]["token_type"][0m
[30;1m211 | [0m[35m        granted_scopes = auth_model["auth_state"].get("scope", [])[0m
[30;1m212 | [0m[35m        if not user_info["email"] and ([0m
[30;1m213 | [0m[35m            "user" in granted_scopes or "user:email" in granted_scopes[0m
[30;1m214 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m            # treated the same as GITHUB_URL[0m
[30;1m41 | [0m[35m            host = os.environ.get("GITHUB_HOST")[0m
[30;1m42 | [0m[35m            if host:[0m
[30;1m43 | [0m[35m                if os.environ.get("GITHUB_HTTP"):[0m
[30;1m44 | [0m[35m                    protocol = "http"[0m
[30;1m45 | [0m[35m                    warnings.warn([0m
[30;1m46 | [0m[35m                        "Use of GITHUB_HOST with GITHUB_HTTP might be deprecated in the future. "[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        if not github_url:[0m
[30;1m39 | [0m[35m            # fallback on older GITHUB_HOST config,[0m
[30;1m40 | [0m[35m            # treated the same as GITHUB_URL[0m
[30;1m41 | [0m[35m            host = os.environ.get("GITHUB_HOST")[0m
[30;1m42 | [0m[35m            if host:[0m
[30;1m43 | [0m[35m                if os.environ.get("GITHUB_HTTP"):[0m
[30;1m44 | [0m[35m                    protocol = "http"[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    @default("github_url")[0m
[30;1m36 | [0m[35m    def _github_url_default(self):[0m
[30;1m37 | [0m[35m        github_url = os.environ.get("GITHUB_URL")[0m
[30;1m38 | [0m[35m        if not github_url:[0m
[30;1m39 | [0m[35m            # fallback on older GITHUB_HOST config,[0m
[30;1m40 | [0m[35m            # treated the same as GITHUB_URL[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    @default("login_service")[0m
[30;1m20 | [0m[35m    def _login_service_default(self):[0m
[30;1m21 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "GitHub")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    @default("username_claim")[0m
[30;1m24 | [0m[35m    def _username_claim_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m        help="""[0m
[30;1m122 | [0m[35m        Populates the authentication state dictionary `auth_state` with a key[0m
[30;1m123 | [0m[35m        `teams` assigned the list of teams the current user is a member of at[0m
[30;1m124 | [0m[35m        the time of authentication. The list of teams is structured like the[0m
[30;1m125 | [0m[35m        response of the GitHub API documented in[0m
[30;1m126 | [0m[35m        https://docs.github.com/en/rest/reference/teams#list-teams-for-the-authenticated-user.[0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m        config=True,[0m
[30;1m121 | [0m[35m        help="""[0m
[30;1m122 | [0m[35m        Populates the authentication state dictionary `auth_state` with a key[0m
[30;1m123 | [0m[35m        `teams` assigned the list of teams the current user is a member of at[0m
[30;1m124 | [0m[35m        the time of authentication. The list of teams is structured like the[0m
[30;1m125 | [0m[35m        response of the GitHub API documented in[0m
[30;1m126 | [0m[35m        https://docs.github.com/en/rest/reference/teams#list-teams-for-the-authenticated-user.[0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/github.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m79 | [0m[35m        if self.github_url == "https://github.com":[0m
[30;1m80 | [0m[35m            return "https://api.github.com"[0m
[30;1m81 | [0m[35m        else:[0m
[30;1m82 | [0m[35m            # Only github.com has its api at api.github.com, enterprise server[0m
[30;1m83 | [0m[35m            # deployments has it in the same domain path under /api/v3[0m
[30;1m84 | [0m[35m            return self.github_url + "/api/v3"[0m
[30;1m85 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m414 | [0m[35m                "allowed_domains_claim"[0m
[30;1m415 | [0m[35m            )[0m
[30;1m416 | [0m[35m            if idp_allowed_domains_claim:[0m
[30;1m417 | [0m[35m                raw_user_domain = user_info.get(idp_allowed_domains_claim)[0m
[30;1m418 | [0m[35m                if not raw_user_domain:[0m
[30;1m419 | [0m[35m                    message = f"Configured allowed_domains_claim {idp_allowed_domains_claim} for {us[0m
[30;1m420 | [0m[35m                    self.log.error(message)[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35m        idp_allowed_domains = self.allowed_idps[user_idp].get("allowed_domains")[0m
[30;1m412 | [0m[35m        if idp_allowed_domains:[0m
[30;1m413 | [0m[35m            idp_allowed_domains_claim = self.allowed_idps[user_idp].get([0m
[30;1m414 | [0m[35m                "allowed_domains_claim"[0m
[30;1m415 | [0m[35m            )[0m
[30;1m416 | [0m[35m            if idp_allowed_domains_claim:[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m        if idp_allow_all:[0m
[30;1m409 | [0m[35m            return True[0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35m        idp_allowed_domains = self.allowed_idps[user_idp].get("allowed_domains")[0m
[30;1m412 | [0m[35m        if idp_allowed_domains:[0m
[30;1m413 | [0m[35m            idp_allowed_domains_claim = self.allowed_idps[user_idp].get([0m
[30;1m414 | [0m[35m                "allowed_domains_claim"[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m404 | [0m[35m        user_info = auth_model["auth_state"][self.user_auth_state_key][0m
[30;1m405 | [0m[35m        user_idp = user_info["idp"][0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        idp_allow_all = self.allowed_idps[user_idp].get("allow_all")[0m
[30;1m408 | [0m[35m        if idp_allow_all:[0m
[30;1m409 | [0m[35m            return True[0m
[30;1m410 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m381 | [0m[35m        username_derivation = self.allowed_idps[user_idp]["username_derivation"][0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m        # Optionally execute action "strip_idp_domain" or "prefix"[0m
[30;1m384 | [0m[35m        action = username_derivation.get("action")[0m
[30;1m385 | [0m[35m        if action == "strip_idp_domain":[0m
[30;1m386 | [0m[35m            domain_suffix = "@" + username_derivation["domain"][0m
[30;1m387 | [0m[35m            if username.lower().endswith(domain_suffix.lower()):[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m        username_derivation = self.allowed_idps[user_idp]["username_derivation"][0m
[30;1m365 | [0m[35m        username_claim = username_derivation["username_claim"][0m
[30;1m366 | [0m[35m[0m
[30;1m367 | [0m[35m        username = user_info.get(username_claim)[0m
[30;1m368 | [0m[35m        if not username:[0m
[30;1m369 | [0m[35m            message = f"Configured username_claim {username_claim} for {user_idp} was not found in t[0m
[30;1m370 | [0m[35m            self.log.error(message)[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m            message = "'idp' claim was not part of the response to the userdata_url"[0m
[30;1m346 | [0m[35m            self.log.error(message)[0m
[30;1m347 | [0m[35m            raise web.HTTPError(500, message)[0m
[30;1m348 | [0m[35m        if not self.allowed_idps.get(user_idp):[0m
[30;1m349 | [0m[35m            message = f"Login with identity provider {user_idp} is not pre-configured"[0m
[30;1m350 | [0m[35m            self.log.error(message)[0m
[30;1m351 | [0m[35m            raise web.HTTPError(403, message)[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m340 | [0m[35m        #       so we make a check here that the "idp" claim is received and[0m
[30;1m341 | [0m[35m        #       that we allowed_idps is configured to handle that idp.[0m
[30;1m342 | [0m[35m        #[0m
[30;1m343 | [0m[35m        user_idp = user_info.get("idp")[0m
[30;1m344 | [0m[35m        if not user_idp:[0m
[30;1m345 | [0m[35m            message = "'idp' claim was not part of the response to the userdata_url"[0m
[30;1m346 | [0m[35m            self.log.error(message)[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m            # Make allowed_domains lowercase[0m
[30;1m254 | [0m[35m            idp_config["allowed_domains"] = [[0m
[30;1m255 | [0m[35m                ad.lower() for ad in idp_config.get("allowed_domains", [])[0m
[30;1m256 | [0m[35m            ][0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m        return idps[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "CILogon")[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    cilogon_host = Unicode([0m
[30;1m73 | [0m[35m        os.environ.get("CILOGON_HOST") or "cilogon.org",[0m
[30;1m74 | [0m[35m        config=True,[0m
[30;1m75 | [0m[35m        help="""[0m
[30;1m76 | [0m[35m        Used to determine the default values for `authorize_url`, `token_url`,[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    @default("login_service")[0m
[30;1m69 | [0m[35m    def _login_service_default(self):[0m
[30;1m70 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "CILogon")[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    cilogon_host = Unicode([0m
[30;1m73 | [0m[35m        os.environ.get("CILOGON_HOST") or "cilogon.org",[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    remaining idps has no meaning.[0m
[30;1m26 | [0m[35m    """[0m
[30;1m27 | [0m[35m    # pick the first idp marked as default, or fallback to the first idp[0m
[30;1m28 | [0m[35m    default_keys = [k for k, v in allowed_idps.items() if v.get("default")][0m
[30;1m29 | [0m[35m    default_key = next(iter(default_keys), next(iter(allowed_idps)))[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    # put the default idp first followed by the other idps[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m187 | [0m[35m                The domain after "@" which will be stripped from the username if[0m
[30;1m188 | [0m[35m                it exists and if the action is "strip_idp_domain".[0m
[30;1m189 | [0m[35m            * `prefix`: string (required if action is prefix)[0m
[30;1m190 | [0m[35m                The prefix which will be added at the beginning of the username[0m
[30;1m191 | [0m[35m                followed by a semi-column ":", if the action is "prefix".[0m
[30;1m192 | [0m[35m        * `allow_all`: bool (defaults to False)[0m
[30;1m193 | [0m[35m            Configuring this allows all users authenticating with this identity[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m43 | [0m[35m        Optionally add "skin" to redirect params, and always add "selected_idp"[0m
[30;1m44 | [0m[35m        (aka. "idphint") based on allowed_idps config.[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        Related documentation at https://www.cilogon.org/oidc#h.p_IWGvXH0okDI_.[0m
[30;1m47 | [0m[35m        """[0m
[30;1m48 | [0m[35m        # kwargs is updated to include extra_params if it doesn't already[0m
[30;1m49 | [0m[35m        # include it, we then modify kwargs' extra_params dictionary[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/cilogon.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m335 | [0m[35m        Returns a username based on user_info and configuration in allowed_idps[0m
[30;1m336 | [0m[35m        under the associated idp's username_derivation config.[0m
[30;1m337 | [0m[35m        """[0m
[30;1m338 | [0m[35m        # NOTE: The first time we have received user_info is when[0m
[30;1m339 | [0m[35m        #       user_info_to_username is called by OAuthenticator.authenticate,[0m
[30;1m340 | [0m[35m        #       so we make a check here that the "idp" claim is received and[0m
[30;1m341 | [0m[35m        #       that we allowed_idps is configured to handle that idp.[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m424 | [0m[35m            member_groups.update(group_names)[0m
[30;1m425 | [0m[35m            self.log.debug(f"Fetched groups for {member_email}: {member_groups}")[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m            next_page_token = response_data.get('nextPageToken')[0m
[30;1m428 | [0m[35m            if next_page_token:[0m
[30;1m429 | [0m[35m                url = f'https://www.googleapis.com/admin/directory/v1/groups?userKey={member_email}&[0m
[30;1m430 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m            )[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m            groups = response_data.get('groups', [])[0m
[30;1m423 | [0m[35m            group_names = {g['email'].split('@')[0] for g in groups if g.get('email')}[0m
[30;1m424 | [0m[35m            member_groups.update(group_names)[0m
[30;1m425 | [0m[35m            self.log.debug(f"Fetched groups for {member_email}: {member_groups}")[0m
[30;1m426 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m419 | [0m[35m                url, headers=headers, label="fetching google groups"[0m
[30;1m420 | [0m[35m            )[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m            groups = response_data.get('groups', [])[0m
[30;1m423 | [0m[35m            group_names = {g['email'].split('@')[0] for g in groups if g.get('email')}[0m
[30;1m424 | [0m[35m            member_groups.update(group_names)[0m
[30;1m425 | [0m[35m            self.log.debug(f"Fetched groups for {member_email}: {member_groups}")[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m                "you may need to run 'pip install oauthenticator[googlegroups]' or not declare googl[0m
[30;1m388 | [0m[35m            )[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m        request = requests.Request()[0m
[30;1m391 | [0m[35m        credentials.refresh(request)[0m
[30;1m392 | [0m[35m        self.log.debug(f"Credentials refreshed for {user_email_domain}")[0m
[30;1m393 | [0m[35m        return credentials[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m        if self.allowed_google_groups:[0m
[30;1m318 | [0m[35m            user_groups = set(user_info["google_groups"])[0m
[30;1m319 | [0m[35m            allowed_groups = self.allowed_google_groups.get(user_domain, set())[0m
[30;1m320 | [0m[35m            if user_groups & allowed_groups:[0m
[30;1m321 | [0m[35m                return True[0m
[30;1m322 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m281 | [0m[35m        user_info = auth_model["auth_state"][self.user_auth_state_key][0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m        # hd ref: https://developers.google.com/identity/openid-connect/openid-connect#id_token-hd[0m
[30;1m284 | [0m[35m        hd = user_info.get("hd", "")[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m        if self.hosted_domain and hd not in self.hosted_domain:[0m
[30;1m287 | [0m[35m            self.log.warning(f"Blocked {username} with 'hd={hd}' not in hosted_domain")[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        if self.admin_google_groups:[0m
[30;1m264 | [0m[35m            # admin status should in this case be True or False, not None[0m
[30;1m265 | [0m[35m            admin_groups = self.admin_google_groups.get(user_domain, set())[0m
[30;1m266 | [0m[35m            auth_model["admin"] = bool(user_groups & admin_groups)[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m        return auth_model[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m    @default('hosted_domain')[0m
[30;1m181 | [0m[35m    def _hosted_domain_from_env(self):[0m
[30;1m182 | [0m[35m        domains = [][0m
[30;1m183 | [0m[35m        for domain in os.environ.get('HOSTED_DOMAIN', '').lower().split(';'):[0m
[30;1m184 | [0m[35m            if domain:[0m
[30;1m185 | [0m[35m                # check falsy to avoid trailing separators[0m
[30;1m186 | [0m[35m                # adding empty domains[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    @default("login_service")[0m
[30;1m20 | [0m[35m    def _login_service_default(self):[0m
[30;1m21 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Google")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    @default("scope")[0m
[30;1m24 | [0m[35m    def _scope_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m403 | [0m[35m        """[0m
[30;1m404 | [0m[35m        Return a set with the google groups a given user/group is a member of, including nested grou[0m
[30;1m405 | [0m[35m        """[0m
[30;1m406 | [0m[35m        # WARNING: There's a race condition here if multiple users login at the same time.[0m
[30;1m407 | [0m[35m        # This is currently ignored.[0m
[30;1m408 | [0m[35m        credentials = credentials or self._get_service_credentials(user_email_domain)[0m
[30;1m409 | [0m[35m        token = credentials[user_email_domain].token[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m        Sets admin status to True or False if `admin_google_groups` is[0m
[30;1m242 | [0m[35m        configured and the user isn't part of `admin_users`. Note that leaving[0m
[30;1m243 | [0m[35m        it at None makes users able to retain an admin status while setting it[0m
[30;1m244 | [0m[35m        to False makes it be revoked.[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        Strips the domain from the username if `hosted_domain` is configured[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    def _service_client_credentials(self, scopes, user_email_domain):[0m
[30;1m350 | [0m[35m        """[0m
[30;1m351 | [0m[35m        Return a configured service client credentials for the API.[0m
[30;1m352 | [0m[35m        """[0m
[30;1m353 | [0m[35m        try:[0m
[30;1m354 | [0m[35m            from google.oauth2 import service_account[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m        Unicode(),[0m
[30;1m76 | [0m[35m        config=True,[0m
[30;1m77 | [0m[35m        help="""[0m
[30;1m78 | [0m[35m        Username of a G Suite Administrator for the service account to act as.[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        This is a mapping of { domain : GSuite-administrator }.[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        Unicode(),[0m
[30;1m63 | [0m[35m        config=True,[0m
[30;1m64 | [0m[35m        help="""[0m
[30;1m65 | [0m[35m        Service account keys to use with each domain, see https://developers.google.com/admin-sdk/di[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        This is a mapping of { domain : service-key }.[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m568 | [0m[35m    logout_handler.clear_login_cookie = Mock()[0m
[30;1m569 | [0m[35m    authenticator.revoke_tokens_on_logout = True[0m
[30;1m570 | [0m[35m[0m
[30;1m571 | [0m[35m    await logout_handler.get()[0m
[30;1m572 | [0m[35m    auth_state = await mock_globus_user.get_auth_state()[0m
[30;1m573 | [0m[35m    assert auth_state == {'tokens': {}}[0m
[30;1m574 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m545 | [0m[35m[0m
[30;1m546 | [0m[35m    # Test the logout handler uses the custom URL[0m
[30;1m547 | [0m[35m    authenticator.logout_redirect_url = custom_logout_url[0m
[30;1m548 | [0m[35m    await logout_handler.get()[0m
[30;1m549 | [0m[35m    logout_handler.redirect.assert_called_once_with(custom_logout_url)[0m
[30;1m550 | [0m[35m    assert logout_handler.clear_login_cookie.called[0m
[30;1m551 | [0m[35m    logout_handler.clear_cookie.assert_called_once_with(STATE_COOKIE_NAME)[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m    # it returns successfully with an access token![0m
[30;1m126 | [0m[35m    def custom_token_response(request):[0m
[30;1m127 | [0m[35m        response = func(request)[0m
[30;1m128 | [0m[35m        if response.get('access_token'):[0m
[30;1m129 | [0m[35m            # The original access_token is checked,[0m
[30;1m130 | [0m[35m            new_token_response['access_token'] = response['access_token'][0m
[30;1m131 | [0m[35m            return new_token_response[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m        for attr_name in token_attrs[0m
[30;1m104 | [0m[35m    }[0m
[30;1m105 | [0m[35m    other_tokens = [[0m
[30;1m106 | [0m[35m        {attr_name: token_dict.get(attr_name) for attr_name in token_attrs}[0m
[30;1m107 | [0m[35m        for token_dict in mock_globus_token_response['other_tokens'][0m
[30;1m108 | [0m[35m    ][0m
[30;1m109 | [0m[35m    tokens = other_tokens + [auth_token_dict][0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m        'access_token',[0m
[30;1m100 | [0m[35m    ][0m
[30;1m101 | [0m[35m    auth_token_dict = {[0m
[30;1m102 | [0m[35m        attr_name: mock_globus_token_response.get(attr_name)[0m
[30;1m103 | [0m[35m        for attr_name in token_attrs[0m
[30;1m104 | [0m[35m    }[0m
[30;1m105 | [0m[35m    other_tokens = [[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef revoke_token_request_handler(request):[0m
[30;1m26 | [0m[35m    assert request.method == 'POST', request.method[0m
[30;1m27 | [0m[35m    auth_header = request.headers.get('Authorization')[0m
[30;1m28 | [0m[35m    if auth_header:[0m
[30;1m29 | [0m[35m        resp = BytesIO(json.dumps({'active': False}).encode('utf8'))[0m
[30;1m30 | [0m[35m        return HTTPResponse(request=request, code=200, buffer=resp)[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m    a bunch of other tokens, including an id_token. We want to make sure we[0m
[30;1m117 | [0m[35m    capture the full Globus token response. This will attach the dict[0m
[30;1m118 | [0m[35m    new_token_response to the built-in test response if it returns successfully"""[0m
[30;1m119 | [0m[35m    # Find the existing endpoint, function pair in client.hosts[0m
[30;1m120 | [0m[35m    url, func = next([0m
[30;1m121 | [0m[35m        filter(lambda host: host[0] == access_token_path, client.hosts[host])[0m
[30;1m122 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_globus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mdef set_extended_token_response(client, host, access_token_path, new_token_response):[0m
[30;1m114 | [0m[35m    """The default client fixture does a nice job of checking the access code[0m
[30;1m115 | [0m[35m    response while returning tokens in the oauth2 spec, but Globus returns[0m
[30;1m116 | [0m[35m    a bunch of other tokens, including an id_token. We want to make sure we[0m
[30;1m117 | [0m[35m    capture the full Globus token response. This will attach the dict[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/azuread.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    @default('tenant_id')[0m
[30;1m58 | [0m[35m    def _tenant_id_default(self):[0m
[30;1m59 | [0m[35m        return os.environ.get('AAD_TENANT_ID', '')[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    @default("authorize_url")[0m
[30;1m62 | [0m[35m    def _authorize_url_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/azuread.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    @default("login_service")[0m
[30;1m18 | [0m[35m    def _login_service_default(self):[0m
[30;1m19 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Azure AD")[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    @default("username_claim")[0m
[30;1m22 | [0m[35m    def _username_claim_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_github.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m        if not paginate:[0m
[30;1m177 | [0m[35m            return [user_model(m) for m in allowed_org_members[org]][0m
[30;1m178 | [0m[35m        else:[0m
[30;1m179 | [0m[35m            page = parse_qs(urlinfo.query).get('page', ['1'])[0m
[30;1m180 | [0m[35m            page = int(page[0])[0m
[30;1m181 | [0m[35m            return org_members_paginated([0m
[30;1m182 | [0m[35m                org, page, urlinfo, functools.partial(HTTPResponse, request)[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/generic.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "OAuth 2.0")[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    claim_groups_key = Union([0m
[30;1m21 | [0m[35m        [Unicode(os.environ.get('OAUTH2_GROUPS_KEY', 'groups')), Callable()],[0m
[30;1m22 | [0m[35m        config=True,[0m
[30;1m23 | [0m[35m        help="""[0m
[30;1m24 | [0m[35m        .. deprecated:: 17.0[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/generic.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35mclass GenericOAuthenticator(OAuthenticator):[0m
[30;1m16 | [0m[35m    @default("login_service")[0m
[30;1m17 | [0m[35m    def _login_service_default(self):[0m
[30;1m18 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "OAuth 2.0")[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    claim_groups_key = Union([0m
[30;1m21 | [0m[35m        [Unicode(os.environ.get('OAUTH2_GROUPS_KEY', 'groups')), Callable()],[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/openshift.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        with concurrent.futures.ThreadPoolExecutor(1) as executor:[0m
[30;1m88 | [0m[35m            future = executor.submit(fetch_auth_info)[0m
[30;1m89 | [0m[35m            return_value = future.result()[0m
[30;1m90 | [0m[35m            return return_value.get("issuer")[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    @default("authorize_url")[0m
[30;1m93 | [0m[35m    def _authorize_url_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/openshift.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m        return {}[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    openshift_url = Unicode([0m
[30;1m43 | [0m[35m        os.environ.get('OPENSHIFT_URL')[0m
[30;1m44 | [0m[35m        or 'https://openshift.default.svc.cluster.local',[0m
[30;1m45 | [0m[35m        config=True,[0m
[30;1m46 | [0m[35m        help="""[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/openshift.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    @default("login_service")[0m
[30;1m28 | [0m[35m    def _login_service_default(self):[0m
[30;1m29 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "OpenShift")[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    @default("username_claim")[0m
[30;1m32 | [0m[35m    def _username_claim_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/pyproject.toml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m# tbump is used to simplify and standardize the release process when updating[0m
[30;1m59 | [0m[35m# the version, making a git commit and tag, and pushing changes.[0m
[30;1m60 | [0m[35m#[0m
[30;1m61 | [0m[35m# ref: https://github.com/your-tools/tbump#readme[0m
[30;1m62 | [0m[35m#[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/auth0.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    @default("login_service")[0m
[30;1m17 | [0m[35m    def _login_service_default(self):[0m
[30;1m18 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Auth0")[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    @default("username_claim")[0m
[30;1m21 | [0m[35m    def _username_claim_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m        ("04", "user3@ok-hd1.org", "", None, False),[0m
[30;1m304 | [0m[35m        ("05", "user1@not-ok.org", "", None, False),[0m
[30;1m305 | [0m[35m        # Test variation 06 below isn't believed to be possible, but since we[0m
[30;1m306 | [0m[35m        # aren't sure this test clarifies what we expect to happen.[0m
[30;1m307 | [0m[35m        ("06", "user1@other.org", "ok-hd1.org", "user1@other.org", True),[0m
[30;1m308 | [0m[35m    ],[0m
[30;1m309 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m        ("04", "user2@ok-hd.org", "", None, False, None),[0m
[30;1m244 | [0m[35m        ("05", "user1@not-ok.org", "", None, False, None),[0m
[30;1m245 | [0m[35m        # Test variation 06 below isn't believed to be possible, but since we[0m
[30;1m246 | [0m[35m        # aren't sure this test clarifies what we expect to happen.[0m
[30;1m247 | [0m[35m        ("06", "user1@other.org", "ok-hd.org", "user1@other.org", True, None),[0m
[30;1m248 | [0m[35m    ],[0m
[30;1m249 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_gitlab.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m        urlinfo = urlparse(request.url)[0m
[30;1m316 | [0m[35m        project_id, user_id = projects_members_api_regex.match(urlinfo.path).group(1, 2)[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        if user_projects.get(project_id) and user_projects[project_id].get(user_id):[0m
[30;1m319 | [0m[35m            res = user_projects[project_id][user_id][0m
[30;1m320 | [0m[35m            return HTTPResponse([0m
[30;1m321 | [0m[35m                request=request,[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_gitlab.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m        urlinfo = urlparse(request.url)[0m
[30;1m316 | [0m[35m        project_id, user_id = projects_members_api_regex.match(urlinfo.path).group(1, 2)[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        if user_projects.get(project_id) and user_projects[project_id].get(user_id):[0m
[30;1m319 | [0m[35m            res = user_projects[project_id][user_id][0m
[30;1m320 | [0m[35m            return HTTPResponse([0m
[30;1m321 | [0m[35m                request=request,[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_gitlab.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        if not paginate:[0m
[30;1m222 | [0m[35m            return [{'path': group} for group in user_groups[username]][0m
[30;1m223 | [0m[35m        else:[0m
[30;1m224 | [0m[35m            page = parse_qs(urlinfo.query).get('page', ['1'])[0m
[30;1m225 | [0m[35m            page = int(page[0])[0m
[30;1m226 | [0m[35m            return _mocked_groups_api_paginated([0m
[30;1m227 | [0m[35m                username, page, urlinfo, functools.partial(HTTPResponse, request)[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_gitlab.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m        one group per page.[0m
[30;1m217 | [0m[35m        """[0m
[30;1m218 | [0m[35m        urlinfo = urlparse(request.url)[0m
[30;1m219 | [0m[35m        _, token = request._headers.get('Authorization').split()[0m
[30;1m220 | [0m[35m        username = gitlab_client.access_tokens[token]['username'][0m
[30;1m221 | [0m[35m        if not paginate:[0m
[30;1m222 | [0m[35m            return [{'path': group} for group in user_groups[username]][0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_gitlab.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m        urlinfo = urlparse(request.url)[0m
[30;1m202 | [0m[35m        group, user_id = groups_members_api_regex.match(urlinfo.path).group(1, 2)[0m
[30;1m203 | [0m[35m        username = id_to_username_map[int(user_id)][0m
[30;1m204 | [0m[35m        if group in user_groups.get(username, []):[0m
[30;1m205 | [0m[35m            return HTTPResponse(request, 200)[0m
[30;1m206 | [0m[35m        else:[0m
[30;1m207 | [0m[35m            return HTTPResponse(request, 404)[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_azuread.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mimport re[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mimport uuid[0m
[30;1m9 | [0m[35mfrom unittest import mock[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport jwt[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_auth0.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    # Check redirection to the custom logout url[0m
[30;1m160 | [0m[35m    authenticator.auth0_domain = AUTH0_DOMAIN[0m
[30;1m161 | [0m[35m    await logout_handler.get()[0m
[30;1m162 | [0m[35m    custom_logout_url = f'https://{AUTH0_DOMAIN}/v2/logout'[0m
[30;1m163 | [0m[35m    logout_handler.redirect.assert_called_with(custom_logout_url)[0m
[30;1m164 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/gitlab.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m                validate_cert=self.validate_server_cert,[0m
[30;1m243 | [0m[35m            )[0m
[30;1m244 | [0m[35m            if resp_json:[0m
[30;1m245 | [0m[35m                access_level = resp_json.get('access_level', 0)[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m                # We only allow access level Developer and above[0m
[30;1m248 | [0m[35m                # Reference: https://docs.gitlab.com/ee/api/members.html[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/gitlab.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    @default("gitlab_api_version")[0m
[30;1m88 | [0m[35m    def _gitlab_api_version_default(self):[0m
[30;1m89 | [0m[35m        return os.environ.get("GITLAB_API_VERSION") or "4"[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    gitlab_api = Unicode([0m
[30;1m92 | [0m[35m        config=True,[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/gitlab.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    @default("login_service")[0m
[30;1m30 | [0m[35m    def _login_service_default(self):[0m
[30;1m31 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "GitLab")[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    gitlab_url = Unicode([0m
[30;1m34 | [0m[35m        config=True,[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_generic.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m579 | [0m[35m    refreshed_state = refreshed["auth_state"][0m
[30;1m580 | [0m[35m    assert "access_token" in refreshed_state[0m
[30;1m581 | [0m[35m    # refresh with access token succeeds, keeps tokens unchanged[0m
[30;1m582 | [0m[35m    assert refreshed_state.get("refresh_token") == auth_state.get("refresh_token")[0m
[30;1m583 | [0m[35m    assert refreshed_state["access_token"] == auth_state["access_token"][0m
[30;1m584 | [0m[35m[0m
[30;1m585 | [0m[35m    # case: access token is no longer valid, triggers refresh[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_generic.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m579 | [0m[35m    refreshed_state = refreshed["auth_state"][0m
[30;1m580 | [0m[35m    assert "access_token" in refreshed_state[0m
[30;1m581 | [0m[35m    # refresh with access token succeeds, keeps tokens unchanged[0m
[30;1m582 | [0m[35m    assert refreshed_state.get("refresh_token") == auth_state.get("refresh_token")[0m
[30;1m583 | [0m[35m    assert refreshed_state["access_token"] == auth_state["access_token"][0m
[30;1m584 | [0m[35m[0m
[30;1m585 | [0m[35m    # case: access token is no longer valid, triggers refresh[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_generic.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m538 | [0m[35m        )[0m
[30;1m539 | [0m[35m    else:[0m
[30;1m540 | [0m[35m        assert "refresh_token" not in auth_state["token_response"][0m
[30;1m541 | [0m[35m        assert auth_state.get("refresh_token") is None[0m
[30;1m542 | [0m[35m    user = MockUser(auth_model)[0m
[30;1m543 | [0m[35m    # case: auth_state not enabled, nothing to refresh[0m
[30;1m544 | [0m[35m    refreshed = await authenticator.refresh_user(user, handler)[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/mediawiki.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "MediaWiki")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    mw_index_url = Unicode([0m
[30;1m89 | [0m[35m        os.environ.get('MW_INDEX_URL', 'https://meta.wikimedia.org/w/index.php'),[0m
[30;1m90 | [0m[35m        config=True,[0m
[30;1m91 | [0m[35m        help="""[0m
[30;1m92 | [0m[35m        Full path to index.php of the MW instance to use to log in[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/mediawiki.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    @default("login_service")[0m
[30;1m85 | [0m[35m    def _login_service_default(self):[0m
[30;1m86 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "MediaWiki")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    mw_index_url = Unicode([0m
[30;1m89 | [0m[35m        os.environ.get('MW_INDEX_URL', 'https://meta.wikimedia.org/w/index.php'),[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m395 | [0m[35m            token_dict.get('access_token') for token_dict in services.values()[0m
[30;1m396 | [0m[35m        ][0m
[30;1m397 | [0m[35m        refresh_tokens = [[0m
[30;1m398 | [0m[35m            token_dict.get('refresh_token') for token_dict in services.values()[0m
[30;1m399 | [0m[35m        ][0m
[30;1m400 | [0m[35m        all_tokens = [tok for tok in access_tokens + refresh_tokens if tok is not None][0m
[30;1m401 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m            }[0m
[30;1m393 | [0m[35m        """[0m
[30;1m394 | [0m[35m        access_tokens = [[0m
[30;1m395 | [0m[35m            token_dict.get('access_token') for token_dict in services.values()[0m
[30;1m396 | [0m[35m        ][0m
[30;1m397 | [0m[35m        refresh_tokens = [[0m
[30;1m398 | [0m[35m            token_dict.get('refresh_token') for token_dict in services.values()[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m        accounts) will correspond to a Globus User ID, so foouser@globusid.org[0m
[30;1m365 | [0m[35m        will have the 'foouser' account in Jupyterhub.[0m
[30;1m366 | [0m[35m        """[0m
[30;1m367 | [0m[35m        return user_info.get(self.username_claim).split('@')[0][0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m    def get_default_headers(self):[0m
[30;1m370 | [0m[35m        return {"Accept": "application/json", "User-Agent": "JupyterHub"}[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m323 | [0m[35m            # It's possible for identity provider domains to be namespaced[0m
[30;1m324 | [0m[35m            # https://docs.globus.org/api/auth/specification/#identity_provider_namespaces[0m
[30;1m325 | [0m[35m            user_info = authentication["auth_state"][self.user_auth_state_key][0m
[30;1m326 | [0m[35m            user_domain = user_info.get(self.username_claim).split('@', 1)[-1][0m
[30;1m327 | [0m[35m            if user_domain != self.identity_provider:[0m
[30;1m328 | [0m[35m                message = f"This site is restricted to {self.identity_provider} accounts. Link your [0m
[30;1m329 | [0m[35m                self.log.warning(message)[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m        # Make sure only the essentials make it into tokens. Other items, such as 'state' are[0m
[30;1m242 | [0m[35m        # not needed after authentication and can be discarded.[0m
[30;1m243 | [0m[35m        other_tokens = [[0m
[30;1m244 | [0m[35m            {attr_name: token_dict.get(attr_name) for attr_name in token_attrs}[0m
[30;1m245 | [0m[35m            for token_dict in token_info['other_tokens'][0m
[30;1m246 | [0m[35m        ][0m
[30;1m247 | [0m[35m        return other_tokens + [auth_token_dict][0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        # can't be retrieved with an Auth token.[0m
[30;1m237 | [0m[35m        # Repackage the Auth token into a dict that looks like the other tokens[0m
[30;1m238 | [0m[35m        auth_token_dict = {[0m
[30;1m239 | [0m[35m            attr_name: token_info.get(attr_name) for attr_name in token_attrs[0m
[30;1m240 | [0m[35m        }[0m
[30;1m241 | [0m[35m        # Make sure only the essentials make it into tokens. Other items, such as 'state' are[0m
[30;1m242 | [0m[35m        # not needed after authentication and can be discarded.[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    @default("login_service")[0m
[30;1m74 | [0m[35m    def _login_service_default(self):[0m
[30;1m75 | [0m[35m        return os.environ.get("LOGIN_SERVICE", "Globus")[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    @default("userdata_url")[0m
[30;1m78 | [0m[35m    def _userdata_url_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        """Revoke and clear user tokens from the database"""[0m
[30;1m50 | [0m[35m        state = await user.get_auth_state()[0m
[30;1m51 | [0m[35m        if state:[0m
[30;1m52 | [0m[35m            await self.authenticator.revoke_service_tokens(state.get('tokens'))[0m
[30;1m53 | [0m[35m            self.log.info([0m
[30;1m54 | [0m[35m                'Logout: Revoked tokens for user "{}" services: {}'.format([0m
[30;1m55 | [0m[35m                    user.name, ','.join(state['tokens'].keys())[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m            # return after the redirect to avoid exceptions.[0m
[30;1m35 | [0m[35m            self.redirect(self.authenticator.logout_redirect_url)[0m
[30;1m36 | [0m[35m            return[0m
[30;1m37 | [0m[35m        await super().get()[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    async def handle_logout(self):[0m
[30;1m40 | [0m[35m        """Overridden method for custom logout functionality. Should be called by[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        await self.handle_logout()[0m
[30;1m31 | [0m[35m        await self.default_handle_logout()[0m
[30;1m32 | [0m[35m        if self.authenticator.logout_redirect_url:[0m
[30;1m33 | [0m[35m            # super().get() will attempt to render a logout page. Make sure we[0m
[30;1m34 | [0m[35m            # return after the redirect to avoid exceptions.[0m
[30;1m35 | [0m[35m            self.redirect(self.authenticator.logout_redirect_url)[0m
[30;1m36 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m        Sets admin status to True or False if `admin_globus_groups` is[0m
[30;1m340 | [0m[35m        configured and the user isn't part of `admin_users`. Note that leaving[0m
[30;1m341 | [0m[35m        it at None makes users able to retain an admin status while setting it[0m
[30;1m342 | [0m[35m        to False makes it be revoked.[0m
[30;1m343 | [0m[35m        """[0m
[30;1m344 | [0m[35m        user_groups = set()[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m325 | [0m[35m            user_info = authentication["auth_state"][self.user_auth_state_key][0m
[30;1m326 | [0m[35m            user_domain = user_info.get(self.username_claim).split('@', 1)[-1][0m
[30;1m327 | [0m[35m            if user_domain != self.identity_provider:[0m
[30;1m328 | [0m[35m                message = f"This site is restricted to {self.identity_provider} accounts. Link your [0m
[30;1m329 | [0m[35m                self.log.warning(message)[0m
[30;1m330 | [0m[35m                raise web.HTTPError(403, message)[0m
[30;1m331 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m231 | [0m[35m            'refresh_token',[0m
[30;1m232 | [0m[35m            'access_token',[0m
[30;1m233 | [0m[35m        ][0m
[30;1m234 | [0m[35m        # The Auth Token is a bit special, it comes back at the top level with the[0m
[30;1m235 | [0m[35m        # id token. The id token has some useful information in it, but nothing that[0m
[30;1m236 | [0m[35m        # can't be retrieved with an Auth token.[0m
[30;1m237 | [0m[35m        # Repackage the Auth token into a dict that looks like the other tokens[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m        config=True,[0m
[30;1m107 | [0m[35m        help="""[0m
[30;1m108 | [0m[35m        Restrict which institution (domain) a user can use to login (GlobusID,[0m
[30;1m109 | [0m[35m        University of Hogwarts, etc.). This should be set in the app at[0m
[30;1m110 | [0m[35m        developers.globus.org, but this acts as an additional check to prevent[0m
[30;1m111 | [0m[35m        unnecessary account creation.[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        Note that users with an associated email domains must still be allowed[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m            'refresh_token',[0m
[30;1m232 | [0m[35m            'access_token',[0m
[30;1m233 | [0m[35m        ][0m
[30;1m234 | [0m[35m        # The Auth Token is a bit special, it comes back at the top level with the[0m
[30;1m235 | [0m[35m        # id token. The id token has some useful information in it, but nothing that[0m
[30;1m236 | [0m[35m        # can't be retrieved with an Auth token.[0m
[30;1m237 | [0m[35m        # Repackage the Auth token into a dict that looks like the other tokens[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/globus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mA JupyterHub authenticator class for use with Globus as an identity provider.[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport pickle[0m
[30;1m8 | [0m[35mimport urllib[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/CONTRIBUTING.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m3. Install pre-commit hooks that checks formatting before commits are made.[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m   ```[0m
[30;1m24 | [0m[35m   pip install pre-commit[0m
[30;1m25 | [0m[35m   pre-commit install --install-hooks[0m
[30;1m26 | [0m[35m   ```[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/CONTRIBUTING.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m   ```[0m
[30;1m17 | [0m[35m   cd oauthenticator[0m
[30;1m18 | [0m[35m   pip install -e ".[test]"[0m
[30;1m19 | [0m[35m   ```[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m3. Install pre-commit hooks that checks formatting before commits are made.[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/CONTRIBUTING.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m1. Clone this repository:[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m   ```[0m
[30;1m11 | [0m[35m   git clone https://github.com/jupyterhub/oauthenticator[0m
[30;1m12 | [0m[35m   ```[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m2. Do a development install with pip:[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m        authenticator=authenticator,[0m
[30;1m171 | [0m[35m    )[0m
[30;1m172 | [0m[35m    handler.write = lambda buf: record.append(buf)[0m
[30;1m173 | [0m[35m    await handler.get()[0m
[30;1m174 | [0m[35m    assert handler.get_status() == 302[0m
[30;1m175 | [0m[35m    assert 'Location' in handler._headers[0m
[30;1m176 | [0m[35m    assert handler._headers['Location'].startswith(authenticator.mw_index_url)[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Ftoken',[0m
[30;1m42 | [0m[35m            text='oauth_token=key&oauth_token_secret=secret',[0m
[30;1m43 | [0m[35m        )[0m
[30;1m44 | [0m[35m        mock.post('/w/index.php?title=Special%3AOAuth%2Fidentify', content=post_token)[0m
[30;1m45 | [0m[35m        yield mock[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Finitiate',[0m
[30;1m38 | [0m[35m            text='oauth_token=key&oauth_token_secret=secret',[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m        mock.post([0m
[30;1m41 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Ftoken',[0m
[30;1m42 | [0m[35m            text='oauth_token=key&oauth_token_secret=secret',[0m
[30;1m43 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        return content[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    with requests_mock.Mocker() as mock:[0m
[30;1m36 | [0m[35m        mock.post([0m
[30;1m37 | [0m[35m            '/w/index.php?title=Special%3AOAuth%2Finitiate',[0m
[30;1m38 | [0m[35m            text='oauth_token=key&oauth_token_secret=secret',[0m
[30;1m39 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_mediawiki.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport re[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom unittest.mock import Mock[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport jwt[0m
[30;1m7 | [0m[35mimport requests_mock[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m                code=403,[0m
[30;1m225 | [0m[35m                reason='No such access token: %r' % token,[0m
[30;1m226 | [0m[35m            )[0m
[30;1m227 | [0m[35m        return access_tokens.get(token)[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m    if isinstance(host, str):[0m
[30;1m230 | [0m[35m        hosts = [host][0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    def get_user(request):[0m
[30;1m206 | [0m[35m        assert request.method == 'GET', request.method[0m
[30;1m207 | [0m[35m        auth_header = request.headers.get('Authorization')[0m
[30;1m208 | [0m[35m        if auth_header:[0m
[30;1m209 | [0m[35m            token = auth_header.split(None, 1)[1][0m
[30;1m210 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m        if not query:[0m
[30;1m150 | [0m[35m            query = request.body.decode('utf8')[0m
[30;1m151 | [0m[35m        query = parse_qs(query)[0m
[30;1m152 | [0m[35m        grant_type = query.get("grant_type", [""])[0][0m
[30;1m153 | [0m[35m        if grant_type == 'authorization_code':[0m
[30;1m154 | [0m[35m            if 'code' not in query:[0m
[30;1m155 | [0m[35m                return HTTPResponse([0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/mocks.py[0m
   Pattern: [32m.hostname[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    def fetch_impl(self, request, response_callback):[0m
[30;1m59 | [0m[35m        urlinfo = urlparse(request.url)[0m
[30;1m60 | [0m[35m        host = urlinfo.hostname[0m
[30;1m61 | [0m[35m        if host not in self.hosts:[0m
[30;1m62 | [0m[35m            app_log.warning(f"Not mocking request to {request.url}")[0m
[30;1m63 | [0m[35m            return super().fetch_impl(request, response_callback)[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    assert any([h == OAuthLogoutHandler for h in handlers])[0m
[30;1m145 | [0m[35m    assert authenticator.logout_url('http://myhost') == 'http://myhost/logout'[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    await logout_handler.get()[0m
[30;1m148 | [0m[35m    assert logout_handler.clear_login_cookie.called[0m
[30;1m149 | [0m[35m    logout_handler.clear_cookie.assert_called_once_with(STATE_COOKIE_NAME)[0m
[30;1m150 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m    callback_handler.get_secure_cookie = Mock(return_value=cookie_state.encode('utf8'))[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    with raises(HTTPError, match="OAuth state mismatch"):[0m
[30;1m128 | [0m[35m        await callback_handler.get()[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35masync def test_custom_logout(monkeypatch):[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m    callback_handler.login_user = Mock(return_value=mock_login_user_coro())[0m
[30;1m100 | [0m[35m    callback_handler.redirect = Mock()[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    await callback_handler.get()[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    callback_handler.redirect.assert_called_once_with('/ABC')[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_oauth2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m    login_handler.set_state_cookie = Mock()[0m
[30;1m52 | [0m[35m    login_handler.authorize_redirect = Mock()[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    login_handler.get()  # no await, we've mocked the authorizer_redirect to NOT be async[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    expected_state = {[0m
[30;1m57 | [0m[35m        'state_id': TEST_STATE_ID,[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m205[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/oauthenticator-17.3.0/oauthenticator/tests/test_oauth2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    This is not fully testing the allow_existing_users config though, as we for[0m
[30;1m192 | [0m[35m    example are not validating the assumptions that the add_user hook is called[0m
[30;1m193 | [0m[35m    for each existing user at least once or that adjusting the allowed_users[0m
[30;1m194 | [0m[35m    list works well.[0m
[30;1m195 | [0m[35m    """[0m
[30;1m196 | [0m[35m    print(f"Running test variation id {test_variation_id}")[0m

205 matches found.
