[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m752 | [0m[35m            elif self.step == FSCAN_v31_PASSIVE_LISTEN:[0m
[30;1m753 | [0m[35m                if msg.cmd == tinytuya.STATUS and msg.retcode == 0:[0m
[30;1m754 | [0m[35m                    try:[0m
[30;1m755 | [0m[35m                        self.brute_force_data.append( base64.b64decode( payload ) )[0m
[30;1m756 | [0m[35m                        self.brute_force_v3x_data()[0m
[30;1m757 | [0m[35m                    except:[0m
[30;1m758 | [0m[35m                        pass[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m23 | [0m[35mimport sys[0m
[30;1m24 | [0m[35mimport time[0m
[30;1m25 | [0m[35mimport errno[0m
[30;1m26 | [0m[35mimport base64[0m
[30;1m27 | [0m[35mimport traceback[0m
[30;1m28 | [0m[35mfrom colorama import init[0m
[30;1m29 | [0m[35mimport tinytuya[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m356 | [0m[35m    @staticmethod[0m
[30;1m357 | [0m[35m    def pulses_to_base64( pulses ):[0m
[30;1m358 | [0m[35m        fmt = '<' + str(len(pulses)) + 'H'[0m
[30;1m359 | [0m[35m        return base64.b64encode( struct.pack(fmt, *pulses) ).decode("ascii")[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m    @staticmethod[0m
[30;1m362 | [0m[35m    def head_key_to_pulses( head, key ):[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m349 | [0m[35m        if len(code_base_64) % 4 == 1 and code_base_64.startswith("1"):[0m
[30;1m350 | [0m[35m            # code can be padded with "1"[0m
[30;1m351 | [0m[35m            code_base_64 = code_base_64[1:][0m
[30;1m352 | [0m[35m        raw_bytes = base64.b64decode(code_base_64)[0m
[30;1m353 | [0m[35m        fmt = '<%dH' % (len(raw_bytes) >> 1)[0m
[30;1m354 | [0m[35m        return list(struct.unpack(fmt, raw_bytes))[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m269 | [0m[35m                    response_code = response # Some error message? Pass it.[0m
[30;1m270 | [0m[35m                    break[0m
[30;1m271 | [0m[35m                elif self.DP_LEARNED_ID in response["dps"]:[0m
[30;1m272 | [0m[35m                    # Button code received, extracting it as Base64 string[0m
[30;1m273 | [0m[35m                    response_code = response["dps"][self.DP_LEARNED_ID][0m
[30;1m274 | [0m[35m                    found = True[0m
[30;1m275 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m"""[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mimport base64[0m
[30;1m114 | [0m[35mimport json[0m
[30;1m115 | [0m[35mimport logging[0m
[30;1m116 | [0m[35mimport struct[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m62 | [0m[35m        IRRemoteControlDevice.head_key_to_pulses ( head='...', key='...' )[0m
[30;1m63 | [0m[35m            -> convert head/key pair to sequence of pulses and gaps[0m
[30;1m64 | [0m[35m               'head' can be None when the key is raw bytes in base64[0m
[30;1m65 | [0m[35m               'key' must begin with '00' through 'FF' when it is not raw bytes in base64[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        IRRemoteControlDevice.pulses_to_head_key ( pulses, fudge=0.1, freq=38 )[0m
[30;1m68 | [0m[35m            -> attempts to pack a sequence of pulses and gaps into a head/key pair[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        IRRemoteControlDevice.head_key_to_pulses ( head='...', key='...' )[0m
[30;1m63 | [0m[35m            -> convert head/key pair to sequence of pulses and gaps[0m
[30;1m64 | [0m[35m               'head' can be None when the key is raw bytes in base64[0m
[30;1m65 | [0m[35m               'key' must begin with '00' through 'FF' when it is not raw bytes in base64[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        IRRemoteControlDevice.pulses_to_head_key ( pulses, fudge=0.1, freq=38 )[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m57 | [0m[35m            -> convert Base64-encoded button code to sequence of pulses and gaps length[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        IRRemoteControlDevice.pulses_to_base64 ( pulses )[0m
[30;1m60 | [0m[35m            -> convert sequence of pulses and gaps length to Base64-encoded button code[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        IRRemoteControlDevice.head_key_to_pulses ( head='...', key='...' )[0m
[30;1m63 | [0m[35m            -> convert head/key pair to sequence of pulses and gaps[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m54 | [0m[35m            -> pretty-print a sequence of pulses and gaps length[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        IRRemoteControlDevice.base64_to_pulses ( code_base_64 )[0m
[30;1m57 | [0m[35m            -> convert Base64-encoded button code to sequence of pulses and gaps length[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        IRRemoteControlDevice.pulses_to_base64 ( pulses )[0m
[30;1m60 | [0m[35m            -> convert sequence of pulses and gaps length to Base64-encoded button code[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m38 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        ir.send_button( base64_code )[0m
[30;1m41 | [0m[35m            -> simulate a learned (raw base64-encoded) button press[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        ir.send_key( head, key )[0m
[30;1m44 | [0m[35m            -> send a head/key pair[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m34 | [0m[35m            -> start or end a study session[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        ir.receive_button( timeout )[0m
[30;1m37 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m38 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        ir.send_button( base64_code )[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m175 | [0m[35m            raise NotImplementedError( 'pyaes does not support GCM, please install PyCryptodome' )[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m        if use_base64:[0m
[30;1m178 | [0m[35m            enc = base64.b64decode(enc)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        if len(enc) % 16 != 0:[0m
[30;1m181 | [0m[35m            raise ValueError("invalid length")[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m167 | [0m[35m        )  # no IV, auto pads to 16[0m
[30;1m168 | [0m[35m        crypted_text = cipher.feed(raw)[0m
[30;1m169 | [0m[35m        crypted_text += cipher.feed()  # flush final block[0m
[30;1m170 | [0m[35m        return base64.b64encode(crypted_text) if use_base64 else crypted_text[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    def decrypt(self, enc, use_base64=True, decode_text=True, verify_padding=False, iv=False, header[0m
[30;1m173 | [0m[35m        if iv:[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m136 | [0m[35m    def decrypt(self, enc, use_base64=True, decode_text=True, verify_padding=False, iv=False, header[0m
[30;1m137 | [0m[35m        if not iv:[0m
[30;1m138 | [0m[35m            if use_base64:[0m
[30;1m139 | [0m[35m                enc = base64.b64decode(enc)[0m
[30;1m140 | [0m[35m            if len(enc) % 16 != 0:[0m
[30;1m141 | [0m[35m                raise ValueError("invalid length")[0m
[30;1m142 | [0m[35m        if iv:[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m131 | [0m[35m            cipher = AES.new(self.key, mode=AES.MODE_ECB)[0m
[30;1m132 | [0m[35m            crypted_text = cipher.encrypt(raw)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        return base64.b64encode(crypted_text) if use_base64 else crypted_text[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    def decrypt(self, enc, use_base64=True, decode_text=True, verify_padding=False, iv=False, header[0m
[30;1m137 | [0m[35m        if not iv:[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m99 | [0m[35m    def decrypt(self, enc, use_base64=True, decode_text=True, verify_padding=False, iv=False, header[0m
[30;1m100 | [0m[35m        if not iv:[0m
[30;1m101 | [0m[35m            if use_base64:[0m
[30;1m102 | [0m[35m                enc = base64.b64decode(enc)[0m
[30;1m103 | [0m[35m            if len(enc) % 16 != 0:[0m
[30;1m104 | [0m[35m                raise ValueError("invalid length")[0m
[30;1m105 | [0m[35m        if iv:[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m94 | [0m[35m            encryptor = Crypto( AES(self.key), Crypto_modes.ECB() ).encryptor()[0m
[30;1m95 | [0m[35m            crypted_text = encryptor.update(raw) + encryptor.finalize()[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        return base64.b64encode(crypted_text) if use_base64 else crypted_text[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    def decrypt(self, enc, use_base64=True, decode_text=True, verify_padding=False, iv=False, header[0m
[30;1m100 | [0m[35m        if not iv:[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m2 | [0m[35m# -*- coding: utf-8 -*-[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom __future__ import print_function  # python 2.7 support[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m836 | [0m[35m| 103  | Machine warning | enum | <ul><li>MOWER_LEAN</li><li>MOWER_EMERGENCY</li><li>MOWER_UI_LOCKED[0m
[30;1m837 | [0m[35m| 104  | Rain mode | boolean | True/False ||[0m
[30;1m838 | [0m[35m| 105  | Work time | interger | 1-99 | hours |[0m
[30;1m839 | [0m[35m| 106  | Machine password | byte str | ? ||[0m
[30;1m840 | [0m[35m| 107  | Clear machine appointment | boolean | True/False ||[0m
[30;1m841 | [0m[35m| 108  | Query machine reservation | boolean | True/False ||[0m
[30;1m842 | [0m[35m| 109  | Query partition parameters | boolean | True/False ||[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m568 | [0m[35m* Devices running protocol version 3.1 (e.g. below Firmware 1.0.5) do not require a device *Local_Ke[0m
[30;1m569 | [0m[35m* Some devices with 22 character IDs will require additional setting to poll correctly. TinyTuya wil[0m
[30;1m570 | [0m[35m  ```python[0m
[30;1m571 | [0m[35m  a = tinytuya.OutletDevice('here_is_my_key', '192.168.x.x', 'secret_key_here', 'device22')[0m
[30;1m572 | [0m[35m  a.set_version(3.3)[0m
[30;1m573 | [0m[35m  a.set_dpsUsed({"1": None})  # This needs to be a datapoint available on the device[0m
[30;1m574 | [0m[35m  data =  a.status()[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m880 | [0m[35m|125|[Sensor Data, list 2](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m881 | [0m[35m|126|[Sensor Data, list 3](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m882 | [0m[35m|127|[Sensor Data, list 4](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m883 | [0m[35m|128|[Sensor Data, list 5](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m884 | [0m[35m|129|System State|enum|[ 'fanon' 'coolfanon' 'alloff' others? ]||[0m
[30;1m885 | [0m[35m|130|Weather Forcast|?|?|?|[0m
[30;1m886 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m879 | [0m[35m|123|Minimum Fan Run Time|integer|0-55|minutes per hour|[0m
[30;1m880 | [0m[35m|125|[Sensor Data, list 2](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m881 | [0m[35m|126|[Sensor Data, list 3](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m882 | [0m[35m|127|[Sensor Data, list 4](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m883 | [0m[35m|128|[Sensor Data, list 5](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m884 | [0m[35m|129|System State|enum|[ 'fanon' 'coolfanon' 'alloff' others? ]||[0m
[30;1m885 | [0m[35m|130|Weather Forcast|?|?|?|[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m878 | [0m[35m/jasonacox/tinytuya/discussions/139)|base64|binary blob||[0m
[30;1m879 | [0m[35m|123|Minimum Fan Run Time|integer|0-55|minutes per hour|[0m
[30;1m880 | [0m[35m|125|[Sensor Data, list 2](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m881 | [0m[35m|126|[Sensor Data, list 3](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m882 | [0m[35m|127|[Sensor Data, list 4](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m883 | [0m[35m|128|[Sensor Data, list 5](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m884 | [0m[35m|129|System State|enum|[ 'fanon' 'coolfanon' 'alloff' others? ]||[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m876 | [0m[35mllowschedule' ]||[0m
[30;1m877 | [0m[35m|121|Vacation Data|base64|binary blob||[0m
[30;1m878 | [0m[35m|122|[Sensor Data, list 1](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m879 | [0m[35m|123|Minimum Fan Run Time|integer|0-55|minutes per hour|[0m
[30;1m880 | [0m[35m|125|[Sensor Data, list 2](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m881 | [0m[35m|126|[Sensor Data, list 3](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m882 | [0m[35m|127|[Sensor Data, list 4](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m875 | [0m[35m|119|Schedule Enabled|bool|True/False||[0m
[30;1m876 | [0m[35m|120|Hold/Schedule|enum|[ 'permhold' 'temphold' 'followschedule' ]||[0m
[30;1m877 | [0m[35m|121|Vacation Data|base64|binary blob||[0m
[30;1m878 | [0m[35m|122|[Sensor Data, list 1](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m879 | [0m[35m|123|Minimum Fan Run Time|integer|0-55|minutes per hour|[0m
[30;1m880 | [0m[35m|125|[Sensor Data, list 2](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m881 | [0m[35m|126|[Sensor Data, list 3](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m874 | [0m[35m|118|Schedule Data|base64|binary blob||[0m
[30;1m875 | [0m[35m|119|Schedule Enabled|bool|True/False||[0m
[30;1m876 | [0m[35m|120|Hold/Schedule|enum|[ 'permhold' 'temphold' 'followschedule' ]||[0m
[30;1m877 | [0m[35m|121|Vacation Data|base64|binary blob||[0m
[30;1m878 | [0m[35m|122|[Sensor Data, list 1](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m
[30;1m879 | [0m[35m|123|Minimum Fan Run Time|integer|0-55|minutes per hour|[0m
[30;1m880 | [0m[35m|125|[Sensor Data, list 2](https://github.com/jasonacox/tinytuya/discussions/139)|base64|binary blob[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m871 | [0m[35m|111*|Heating Setpoint, Â°F|integer|20-102|Â°F|[0m
[30;1m872 | [0m[35m|115|Fan Mode|enum|[ 'auto' 'cycle' 'on' ]||[0m
[30;1m873 | [0m[35m|116|"at home/away from home"|integer-as-string|?|?|[0m
[30;1m874 | [0m[35m|118|Schedule Data|base64|binary blob||[0m
[30;1m875 | [0m[35m|119|Schedule Enabled|bool|True/False||[0m
[30;1m876 | [0m[35m|120|Hold/Schedule|enum|[ 'permhold' 'temphold' 'followschedule' ]||[0m
[30;1m877 | [0m[35m|121|Vacation Data|base64|binary blob||[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m753 | [0m[35m  d.send(payload)[0m
[30;1m754 | [0m[35m  ```[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35mThe `key1` attribute is a base64 string that contains the IR signal. You can extract it using this p[0m
[30;1m757 | [0m[35m[0m
[30;1m758 | [0m[35m1. Register a new IR device on Tuya Smart / Smart Life app (if not registered already) and map, setu[0m
[30;1m759 | [0m[35m2. Tap multiple times on the button you wish to control.[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m255 | [0m[35m    @staticmethod[0m
[30;1m256 | [0m[35m    def rf_decode_button( base64_code ):[0m
[30;1m257 | [0m[35m        try:[0m
[30;1m258 | [0m[35m            jstr = base64.b64decode[0m
[30;1m259 | [0m[35m            jdata = json.loads( jstr )[0m
[30;1m260 | [0m[35m            return jdata[0m
[30;1m261 | [0m[35m        except:[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m244 | [0m[35m    def rf_print_button( base64_code, use_log=None ):[0m
[30;1m245 | [0m[35m        if not use_log: use_log = log[0m
[30;1m246 | [0m[35m        try:[0m
[30;1m247 | [0m[35m            jstr = base64.b64decode( base64_code )[0m
[30;1m248 | [0m[35m            #jdata = json.loads( jstr )[0m
[30;1m249 | [0m[35m            use_log.debug( 'Learned button: %s', jstr )[0m
[30;1m250 | [0m[35m            return jstr[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m133 | [0m[35m                    response_code = response # Some error message? Pass it.[0m
[30;1m134 | [0m[35m                    break[0m
[30;1m135 | [0m[35m                elif self.DP_LEARNED_ID in response["dps"]:[0m
[30;1m136 | [0m[35m                    # Button code received, extracting it as Base64 string[0m
[30;1m137 | [0m[35m                    log.info( 'Response (type 1): %r', response )[0m
[30;1m138 | [0m[35m                    response_code = response["dps"][self.DP_LEARNED_ID][0m
[30;1m139 | [0m[35m                    found = True[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m"""[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mimport base64[0m
[30;1m60 | [0m[35mimport json[0m
[30;1m61 | [0m[35mimport logging[0m
[30;1m62 | [0m[35mimport struct[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m
[30;1m55 | [0m[35m                the base64 string is base64 decoded and then JSON parsed[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m"""[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m
[30;1m55 | [0m[35m                the base64 string is base64 decoded and then JSON parsed[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m"""[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m51 | [0m[35m                the base64 string is base64 decoded but not JSON parsed[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m
[30;1m55 | [0m[35m                the base64 string is base64 decoded and then JSON parsed[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        RFRemoteControlDevice.rf_print_button( base64_code )[0m
[30;1m50 | [0m[35m            -> prints and returns the JSON dict as a string from a base64-encoded learned button[0m
[30;1m51 | [0m[35m                the base64 string is base64 decoded but not JSON parsed[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        RFRemoteControlDevice.rf_print_button( base64_code )[0m
[30;1m50 | [0m[35m            -> prints and returns the JSON dict as a string from a base64-encoded learned button[0m
[30;1m51 | [0m[35m                the base64 string is base64 decoded but not JSON parsed[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m47 | [0m[35m                  a list or tuple containing dicts or hex strings[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        RFRemoteControlDevice.rf_print_button( base64_code )[0m
[30;1m50 | [0m[35m            -> prints and returns the JSON dict as a string from a base64-encoded learned button[0m
[30;1m51 | [0m[35m                the base64 string is base64 decoded but not JSON parsed[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m36 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        rf.rf_send_button( base64_code, times=6, delay=0, intervals=0 )[0m
[30;1m39 | [0m[35m            -> send a learned (raw base64-encoded) button press[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        rf.rf_send_key( keys, cmt_bank, system_bank, frequency_bank, datarate_bank, baseband_bank, t[0m
[30;1m42 | [0m[35m            -> send pre-defined key(s)[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m31 | [0m[35m               when sort=True, 'rf_shortstudy' is used instead of 'rf_study'[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        rf.rf_receive_button( freq=0, timeout )[0m
[30;1m34 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m35 | [0m[35m               freq - 0 to auto-detect[0m
[30;1m36 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m978 | [0m[35m[0m
[30;1m979 | [0m[35m        for s in self.sensors:[0m
[30;1m980 | [0m[35m            b += bytearray( bytes( s ) )[0m
[30;1m981 | [0m[35m        return base64.b64encode( b ).decode('ascii')[0m
[30;1m982 | [0m[35m[0m
[30;1m983 | [0m[35m    def __iter__(self):[0m
[30;1m984 | [0m[35m        for s in self.sensors:[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m923 | [0m[35m    def update(self, sensordata_list):[0m
[30;1m924 | [0m[35m        changed = [ ][0m
[30;1m925 | [0m[35m        if isinstance(sensordata_list, str):[0m
[30;1m926 | [0m[35m            sensordata_list = base64.b64decode( sensordata_list )[0m
[30;1m927 | [0m[35m        elif not isinstance(sensordata_list, bytes):[0m
[30;1m928 | [0m[35m            raise TypeError( 'Unhandled Thermostat Sensor List data type' )[0m
[30;1m929 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m901 | [0m[35m        sensor_list_object = ThermostatSensorList( '122', self ) # for DPS 122[0m
[30;1m902 | [0m[35m[0m
[30;1m903 | [0m[35m        ## populate the sensor data[0m
[30;1m904 | [0m[35m        sensor_list_object.update( 'base64 string here' )[0m
[30;1m905 | [0m[35m[0m
[30;1m906 | [0m[35m        ## send an update after changing a sensor value[0m
[30;1m907 | [0m[35m        send_dps = { '122': sensor_list_object.b64() }[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m891 | [0m[35m      Args:[0m
[30;1m892 | [0m[35m        sensordata_list: either a base64-encoded string such as what DPS 122 contains, or an already[0m
[30;1m893 | [0m[35m[0m
[30;1m894 | [0m[35m    The .b64() method returns a base64-encoded string ready for sending[0m
[30;1m895 | [0m[35m    The str() method returns a hexidecimal string to make it easier to visualize the data[0m
[30;1m896 | [0m[35m[0m
[30;1m897 | [0m[35m    This class is iterable so you can easily loop through the individual sensors[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m889 | [0m[35m[0m
[30;1m890 | [0m[35m    The .update(sensordata_list) method parses an update[0m
[30;1m891 | [0m[35m      Args:[0m
[30;1m892 | [0m[35m        sensordata_list: either a base64-encoded string such as what DPS 122 contains, or an already[0m
[30;1m893 | [0m[35m[0m
[30;1m894 | [0m[35m    The .b64() method returns a base64-encoded string ready for sending[0m
[30;1m895 | [0m[35m    The str() method returns a hexidecimal string to make it easier to visualize the data[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m846 | [0m[35m            return bytes(self).hex().upper()[0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m        def b64(self):[0m
[30;1m849 | [0m[35m            return base64.b64encode( bytes(self) ).decode('ascii')[0m
[30;1m850 | [0m[35m[0m
[30;1m851 | [0m[35m        def __iter__(self):[0m
[30;1m852 | [0m[35m            for d in self.day_data:[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m472 | [0m[35m                setattr( self, checkname, val )[0m
[30;1m473 | [0m[35m[0m
[30;1m474 | [0m[35m                if ('base64' in self.dps_data[k]) and self.dps_data[k]:[0m
[30;1m475 | [0m[35m                    val = base64.b64decode( val )[0m
[30;1m476 | [0m[35m[0m
[30;1m477 | [0m[35m                if 'selfclass' in self.dps_data[k]:[0m
[30;1m478 | [0m[35m                    getattr( self, name ).update( val )[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m471 | [0m[35m                if name != checkname: data['changed'].append( checkname )[0m
[30;1m472 | [0m[35m                setattr( self, checkname, val )[0m
[30;1m473 | [0m[35m[0m
[30;1m474 | [0m[35m                if ('base64' in self.dps_data[k]) and self.dps_data[k]:[0m
[30;1m475 | [0m[35m                    val = base64.b64decode( val )[0m
[30;1m476 | [0m[35m[0m
[30;1m477 | [0m[35m                if 'selfclass' in self.dps_data[k]:[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m395 | [0m[35m                log.warn( 'Requested value %r for key %r/%r not in enum list %r !  Setting anyway...[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        if 'base64' in ddata:[0m
[30;1m398 | [0m[35m            val = base64.b64encode( val ).decode('ascii')[0m
[30;1m399 | [0m[35m[0m
[30;1m400 | [0m[35m        return ( dps, val )[0m
[30;1m401 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m394 | [0m[35m            if val not in ddata['enum']:[0m
[30;1m395 | [0m[35m                log.warn( 'Requested value %r for key %r/%r not in enum list %r !  Setting anyway...[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        if 'base64' in ddata:[0m
[30;1m398 | [0m[35m            val = base64.b64encode( val ).decode('ascii')[0m
[30;1m399 | [0m[35m[0m
[30;1m400 | [0m[35m        return ( dps, val )[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m287 | [0m[35m            if 'alt' in self.dps_data[k]:[0m
[30;1m288 | [0m[35m                setattr( self, self.dps_data[k]['alt'], val )[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m            if( ('scale' in self.dps_data[k]) or (('base64' in self.dps_data[k]) and self.dps_data[k[0m
[30;1m291 | [0m[35m                self.dps_data[k]['check_raw'] = True[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m            if 'check_raw' in self.dps_data[k] and self.dps_data[k]['check_raw']:[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m287 | [0m[35m            if 'alt' in self.dps_data[k]:[0m
[30;1m288 | [0m[35m                setattr( self, self.dps_data[k]['alt'], val )[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m            if( ('scale' in self.dps_data[k]) or (('base64' in self.dps_data[k]) and self.dps_data[k[0m
[30;1m291 | [0m[35m                self.dps_data[k]['check_raw'] = True[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m            if 'check_raw' in self.dps_data[k] and self.dps_data[k]['check_raw']:[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m253 | [0m[35m        #'125': { 'name': 'sensor_list_2', 'base64': True },[0m
[30;1m254 | [0m[35m        #'126': { 'name': 'sensor_list_3', 'base64': True },[0m
[30;1m255 | [0m[35m        #'127': { 'name': 'sensor_list_4', 'base64': True },[0m
[30;1m256 | [0m[35m        #'128': { 'name': 'sensor_list_5', 'base64': True },[0m
[30;1m257 | [0m[35m        '129': { 'name': 'system', 'enum': ['fanon', 'coolfanon', 'alloff', 'heatfanon', 'heaton'] }[0m
[30;1m258 | [0m[35m        '130': { 'name': 'weather_forcast' }[0m
[30;1m259 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m252 | [0m[35m        '123': { 'name': 'fan_run_time' }, # presumably for when fan='circ'[0m
[30;1m253 | [0m[35m        #'125': { 'name': 'sensor_list_2', 'base64': True },[0m
[30;1m254 | [0m[35m        #'126': { 'name': 'sensor_list_3', 'base64': True },[0m
[30;1m255 | [0m[35m        #'127': { 'name': 'sensor_list_4', 'base64': True },[0m
[30;1m256 | [0m[35m        #'128': { 'name': 'sensor_list_5', 'base64': True },[0m
[30;1m257 | [0m[35m        '129': { 'name': 'system', 'enum': ['fanon', 'coolfanon', 'alloff', 'heatfanon', 'heaton'] }[0m
[30;1m258 | [0m[35m        '130': { 'name': 'weather_forcast' }[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m251 | [0m[35m        #'122': { 'name': 'sensor_list_1', 'base64': True },[0m
[30;1m252 | [0m[35m        '123': { 'name': 'fan_run_time' }, # presumably for when fan='circ'[0m
[30;1m253 | [0m[35m        #'125': { 'name': 'sensor_list_2', 'base64': True },[0m
[30;1m254 | [0m[35m        #'126': { 'name': 'sensor_list_3', 'base64': True },[0m
[30;1m255 | [0m[35m        #'127': { 'name': 'sensor_list_4', 'base64': True },[0m
[30;1m256 | [0m[35m        #'128': { 'name': 'sensor_list_5', 'base64': True },[0m
[30;1m257 | [0m[35m        '129': { 'name': 'system', 'enum': ['fanon', 'coolfanon', 'alloff', 'heatfanon', 'heaton'] }[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m250 | [0m[35m        '121': { 'name': 'vacation', 'base64': True },[0m
[30;1m251 | [0m[35m        #'122': { 'name': 'sensor_list_1', 'base64': True },[0m
[30;1m252 | [0m[35m        '123': { 'name': 'fan_run_time' }, # presumably for when fan='circ'[0m
[30;1m253 | [0m[35m        #'125': { 'name': 'sensor_list_2', 'base64': True },[0m
[30;1m254 | [0m[35m        #'126': { 'name': 'sensor_list_3', 'base64': True },[0m
[30;1m255 | [0m[35m        #'127': { 'name': 'sensor_list_4', 'base64': True },[0m
[30;1m256 | [0m[35m        #'128': { 'name': 'sensor_list_5', 'base64': True },[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m248 | [0m[35m        '119': { 'name': 'schedule_enabled' },[0m
[30;1m249 | [0m[35m        '120': { 'name': 'hold', 'enum': ['permhold', 'temphold', 'followschedule'] },[0m
[30;1m250 | [0m[35m        '121': { 'name': 'vacation', 'base64': True },[0m
[30;1m251 | [0m[35m        #'122': { 'name': 'sensor_list_1', 'base64': True },[0m
[30;1m252 | [0m[35m        '123': { 'name': 'fan_run_time' }, # presumably for when fan='circ'[0m
[30;1m253 | [0m[35m        #'125': { 'name': 'sensor_list_2', 'base64': True },[0m
[30;1m254 | [0m[35m        #'126': { 'name': 'sensor_list_3', 'base64': True },[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m247 | [0m[35m        '118': { 'name': 'schedule', 'base64': True, 'selfclass': 'ThermostatSchedule' },[0m
[30;1m248 | [0m[35m        '119': { 'name': 'schedule_enabled' },[0m
[30;1m249 | [0m[35m        '120': { 'name': 'hold', 'enum': ['permhold', 'temphold', 'followschedule'] },[0m
[30;1m250 | [0m[35m        '121': { 'name': 'vacation', 'base64': True },[0m
[30;1m251 | [0m[35m        #'122': { 'name': 'sensor_list_1', 'base64': True },[0m
[30;1m252 | [0m[35m        '123': { 'name': 'fan_run_time' }, # presumably for when fan='circ'[0m
[30;1m253 | [0m[35m        #'125': { 'name': 'sensor_list_2', 'base64': True },[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m244 | [0m[35m        '111': { 'name': 'lower_temp_f', 'alt': 'heating_setpoint_f', 'high_resolution': True },[0m
[30;1m245 | [0m[35m        '115': { 'name': 'fan', 'enum': ['auto', 'cycle', 'on'] },[0m
[30;1m246 | [0m[35m        '116': { 'name': 'home' },[0m
[30;1m247 | [0m[35m        '118': { 'name': 'schedule', 'base64': True, 'selfclass': 'ThermostatSchedule' },[0m
[30;1m248 | [0m[35m        '119': { 'name': 'schedule_enabled' },[0m
[30;1m249 | [0m[35m        '120': { 'name': 'hold', 'enum': ['permhold', 'temphold', 'followschedule'] },[0m
[30;1m250 | [0m[35m        '121': { 'name': 'vacation', 'base64': True },[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m213 | [0m[35m"""[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35mimport struct[0m
[30;1m216 | [0m[35mimport base64[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35mfrom ..core import Device, log, HEART_BEAT, DP_QUERY, CONTROL[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m606 | [0m[35m            else:[0m
[30;1m607 | [0m[35m                msg = tinytuya.MessagePayload(tinytuya.DP_QUERY, dummy_payload)[0m
[30;1m608 | [0m[35m        elif self.step == FSCAN_v31_BRUTE_FORCE_ACTIVE:[0m
[30;1m609 | [0m[35m            dummy_payload = bytes(bytearray.fromhex('deadbeef112233445566778899aabbccddeeffb00bface1[0m
[30;1m610 | [0m[35m            msg = tinytuya.MessagePayload(tinytuya.CONTROL, dummy_payload)[0m
[30;1m611 | [0m[35m        #elif self.step == FSCAN_v33_BRUTE_FORCE_ACTIVE:[0m
[30;1m612 | [0m[35m        #    pass[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m600 | [0m[35m                msg = tinytuya.MessagePayload(tinytuya.DP_QUERY, b'')[0m
[30;1m601 | [0m[35m        elif self.step == FSCAN_INITIAL_CONNECT:[0m
[30;1m602 | [0m[35m            # this is a connect retry[0m
[30;1m603 | [0m[35m            dummy_payload = bytes(bytearray.fromhex('deadbeef112233445566778899aabbccddeeffb00bface1[0m
[30;1m604 | [0m[35m            if self.deviceinfo['dev_type'] == 'device22':[0m
[30;1m605 | [0m[35m                msg = tinytuya.MessagePayload(tinytuya.CONTROL_NEW, dummy_payload)[0m
[30;1m606 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m355 | [0m[35md.set_mode('scene')[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m# Scene Example: Set Color Rotation Scene[0m
[30;1m358 | [0m[35md.set_value(25, '07464602000003e803e800000000464602007803e803e80000000046460200f003e803e800000000464[0m
[30;1m359 | [0m[35m[0m
[30;1m360 | [0m[35m```[0m
[30;1m361 | [0m[35m### Example Device Monitor[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m        interfaces = netifaces.interfaces()[0m
[30;1m180 | [0m[35m        for interface in interfaces:[0m
[30;1m181 | [0m[35m            addresses = netifaces.ifaddresses(interface)[0m
[30;1m182 | [0m[35m            ipv4 = addresses.get(netifaces.AF_INET)[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m            if ipv4:[0m
[30;1m185 | [0m[35m                for addr in ipv4:[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m    for interface in interfaces:[0m
[30;1m128 | [0m[35m        addresses = netifaces.ifaddresses(interface)[0m
[30;1m129 | [0m[35m        #for address_family in (netifaces.AF_INET, netifaces.AF_INET6):[0m
[30;1m130 | [0m[35m        family_addresses = addresses.get(netifaces.AF_INET)[0m
[30;1m131 | [0m[35m        if not family_addresses:[0m
[30;1m132 | [0m[35m            continue[0m
[30;1m133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1590 | [0m[35m                        do_poll = True[0m
[30;1m1591 | [0m[35m[0m
[30;1m1592 | [0m[35m                if do_poll:[0m
[30;1m1593 | [0m[35m                    # delay at least 100ms[0m
[30;1m1594 | [0m[35m                    connect_next_round.append(ip)[0m
[30;1m1595 | [0m[35m                else:[0m
[30;1m1596 | [0m[35m                    broadcasted_devices[ip].close()[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1532 | [0m[35m                if ip not in broadcasted_apps:[0m
[30;1m1533 | [0m[35m                    broadcasted_apps[ip] = result[0m
[30;1m1534 | [0m[35m                    if verbose:[0m
[30;1m1535 | [0m[35m                        print( term.alertdim + 'New Broadcast from App at ' + str(ip) + term.dim + '[0m
[30;1m1536 | [0m[35m                continue[0m
[30;1m1537 | [0m[35m[0m
[30;1m1538 | [0m[35m            if 'gwId' not in result:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1427 | [0m[35m                if (not ip_scan_delay) and len(write_socks) < max_parallel:[0m
[30;1m1428 | [0m[35m                    ip_scan_delay = False[0m
[30;1m1429 | [0m[35m                    want = max_parallel - len(write_socks)[0m
[30;1m1430 | [0m[35m                    # only open 10 at most during each pass through select()[0m
[30;1m1431 | [0m[35m                    if want > 10: want = 10[0m
[30;1m1432 | [0m[35m                    for i in range(want):[0m
[30;1m1433 | [0m[35m                        current_ip = next( scan_ips, None )[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1014 | [0m[35m            # Did we detect a device22 device? Return ERR_DEVTYPE error.[0m
[30;1m1015 | [0m[35m            if dev_type != self.device.dev_type:[0m
[30;1m1016 | [0m[35m                log.debug([0m
[30;1m1017 | [0m[35m                    "PollDevice: Device22 detected and updated (%s -> %s) - Update payload and try a[0m
[30;1m1018 | [0m[35m                    dev_type,[0m
[30;1m1019 | [0m[35m                    self.device.dev_type,[0m
[30;1m1020 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1004 | [0m[35m[0m
[30;1m1005 | [0m[35m            dev_type = self.device.dev_type[0m
[30;1m1006 | [0m[35m            try:[0m
[30;1m1007 | [0m[35m                # Data available: seqno cmd retcode payload crc[0m
[30;1m1008 | [0m[35m                log.debug("PollDevice: raw unpacked message = %r", msg)[0m
[30;1m1009 | [0m[35m                result = self.device._decode_payload(msg.payload)[0m
[30;1m1010 | [0m[35m            except:[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2015 | [0m[35m    output = json.dumps(sorted(tuyadevices,key=lambda x: x['name']), indent=4)[0m
[30;1m2016 | [0m[35m    print(output)[0m
[30;1m2017 | [0m[35m[0m
[30;1m2018 | [0m[35m    # Find out if we should poll all devices[0m
[30;1m2019 | [0m[35m    if skip_poll:[0m
[30;1m2020 | [0m[35m        answer = 'n'[0m
[30;1m2021 | [0m[35m    elif assume_yes:[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1952 | [0m[35m        if device['ip']:[0m
[30;1m1953 | [0m[35m            by_ip[device['ip']] = device[0m
[30;1m1954 | [0m[35m[0m
[30;1m1955 | [0m[35m    # Find out if we should poll all devices[0m
[30;1m1956 | [0m[35m    if skip_poll:[0m
[30;1m1957 | [0m[35m        answer = 'n'[0m
[30;1m1958 | [0m[35m    elif assume_yes:[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1943 | [0m[35m    devicesx = sorted(data["devices"], key=lambda x: x['name'])[0m
[30;1m1944 | [0m[35m    for idx in devicesx:[0m
[30;1m1945 | [0m[35m        device = _build_item( idx, None )[0m
[30;1m1946 | [0m[35m        ips = device['ip'].ljust(15) if device['ip'] else (term.alert + "E: No IP found " + term.nor[0m
[30;1m1947 | [0m[35m        dname = device['name'][0m
[30;1m1948 | [0m[35m        if dname == "":[0m
[30;1m1949 | [0m[35m            dname = device['gwId'][0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1820 | [0m[35m        name = item['gwId'][0m
[30;1m1821 | [0m[35m    ip = item['ip'][0m
[30;1m1822 | [0m[35m    if not ip:[0m
[30;1m1823 | [0m[35m        print("    %s[%-25.25s] %sError: No IP found%s" %[0m
[30;1m1824 | [0m[35m              (term.subbold, name, term.alert, term.normal))[0m
[30;1m1825 | [0m[35m    elif not dps:[0m
[30;1m1826 | [0m[35m        print("    %s[%-25.25s] %s%-18s - %sNo Response" %[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1818 | [0m[35m    name = item['name'][0m
[30;1m1819 | [0m[35m    if name == "":[0m
[30;1m1820 | [0m[35m        name = item['gwId'][0m
[30;1m1821 | [0m[35m    ip = item['ip'][0m
[30;1m1822 | [0m[35m    if not ip:[0m
[30;1m1823 | [0m[35m        print("    %s[%-25.25s] %sError: No IP found%s" %[0m
[30;1m1824 | [0m[35m              (term.subbold, name, term.alert, term.normal))[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1803 | [0m[35mdef _build_item( old, new ):[0m
[30;1m1804 | [0m[35m    item = {}[0m
[30;1m1805 | [0m[35m    item['id'] = item['gwId'] = _get_gwid( old )[0m
[30;1m1806 | [0m[35m    ip = ver = 0[0m
[30;1m1807 | [0m[35m    items = { 'ip':0, 'version':0, 'name':'', 'key':'', 'mac':None }[0m
[30;1m1808 | [0m[35m    for itm in items:[0m
[30;1m1809 | [0m[35m        if new and itm in new and new[itm]:[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1770 | [0m[35m[0m
[30;1m1771 | [0m[35m    for ip in scanned_devices:[0m
[30;1m1772 | [0m[35m        dev = scanned_devices[ip].deviceinfo[0m
[30;1m1773 | [0m[35m        dev['ip'] = ip[0m
[30;1m1774 | [0m[35m        dev['origin'] = 'forcescan'[0m
[30;1m1775 | [0m[35m        dkey = dev[k][0m
[30;1m1776 | [0m[35m        if scanned_devices[ip].found and dkey not in devices:[0m
[30;1m1777 | [0m[35m            devices[dkey] = dev[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1768 | [0m[35m        dkey = dev[k][0m
[30;1m1769 | [0m[35m        devices[dkey] = dev[0m
[30;1m1770 | [0m[35m[0m
[30;1m1771 | [0m[35m    for ip in scanned_devices:[0m
[30;1m1772 | [0m[35m        dev = scanned_devices[ip].deviceinfo[0m
[30;1m1773 | [0m[35m        dev['ip'] = ip[0m
[30;1m1774 | [0m[35m        dev['origin'] = 'forcescan'[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1763 | [0m[35m    devices = {} # pylint: disable=W0621[0m
[30;1m1764 | [0m[35m    for ip in broadcasted_devices:[0m
[30;1m1765 | [0m[35m        dev = broadcasted_devices[ip].deviceinfo[0m
[30;1m1766 | [0m[35m        dev['ip'] = ip[0m
[30;1m1767 | [0m[35m        dev['origin'] = 'broadcast'[0m
[30;1m1768 | [0m[35m        dkey = dev[k][0m
[30;1m1769 | [0m[35m        devices[dkey] = dev[0m
[30;1m1770 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1761 | [0m[35m    else:[0m
[30;1m1762 | [0m[35m        k = 'ip'[0m
[30;1m1763 | [0m[35m    devices = {} # pylint: disable=W0621[0m
[30;1m1764 | [0m[35m    for ip in broadcasted_devices:[0m
[30;1m1765 | [0m[35m        dev = broadcasted_devices[ip].deviceinfo[0m
[30;1m1766 | [0m[35m        dev['ip'] = ip[0m
[30;1m1767 | [0m[35m        dev['origin'] = 'broadcast'[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1753 | [0m[35m[0m
[30;1m1754 | [0m[35m        if broadcast_messages:[0m
[30;1m1755 | [0m[35m            print('%sUndisplayed Broadcasts:%s' % (term.alert, term.normal))[0m
[30;1m1756 | [0m[35m            for ip in broadcast_messages:[0m
[30;1m1757 | [0m[35m                print( broadcast_messages[ip] )[0m
[30;1m1758 | [0m[35m[0m
[30;1m1759 | [0m[35m    if byID:[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1749 | [0m[35m        if wantips:[0m
[30;1m1750 | [0m[35m            print('%s%sDid not find %s devices by IP Address: %r%s' % (term.alert, term.yellow, len([0m
[30;1m1751 | [0m[35m        if wantids:[0m
[30;1m1752 | [0m[35m            print('%s%sDid not find %s devices by DevID: %r%s' % (term.alert, term.yellow, len(wanti[0m
[30;1m1753 | [0m[35m[0m
[30;1m1754 | [0m[35m        if broadcast_messages:[0m
[30;1m1755 | [0m[35m            print('%sUndisplayed Broadcasts:%s' % (term.alert, term.normal))[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1747 | [0m[35m            print( '%sMissing Local Key: %s%s' % (term.alert, no_key_count, term.normal) )[0m
[30;1m1748 | [0m[35m[0m
[30;1m1749 | [0m[35m        if wantips:[0m
[30;1m1750 | [0m[35m            print('%s%sDid not find %s devices by IP Address: %r%s' % (term.alert, term.yellow, len([0m
[30;1m1751 | [0m[35m        if wantids:[0m
[30;1m1752 | [0m[35m            print('%s%sDid not find %s devices by DevID: %r%s' % (term.alert, term.yellow, len(wanti[0m
[30;1m1753 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1747 | [0m[35m            print( '%sMissing Local Key: %s%s' % (term.alert, no_key_count, term.normal) )[0m
[30;1m1748 | [0m[35m[0m
[30;1m1749 | [0m[35m        if wantips:[0m
[30;1m1750 | [0m[35m            print('%s%sDid not find %s devices by IP Address: %r%s' % (term.alert, term.yellow, len([0m
[30;1m1751 | [0m[35m        if wantids:[0m
[30;1m1752 | [0m[35m            print('%s%sDid not find %s devices by DevID: %r%s' % (term.alert, term.yellow, len(wanti[0m
[30;1m1753 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1723 | [0m[35m        print( 'Broadcasted:', len(broadcasted_devices) )[0m
[30;1m1724 | [0m[35m        if ip_scan:[0m
[30;1m1725 | [0m[35m            key_found = gwid_found = err_found = invalid = unmatched = 0[0m
[30;1m1726 | [0m[35m            for ip in scanned_devices:[0m
[30;1m1727 | [0m[35m                dev = scanned_devices[ip][0m
[30;1m1728 | [0m[35m                if dev.key_found: key_found += 1[0m
[30;1m1729 | [0m[35m                if dev.gwid_found: gwid_found += 1[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1706 | [0m[35m        elif not scanned_devices[ip].deviceinfo['key']:[0m
[30;1m1707 | [0m[35m            no_key_count += 1[0m
[30;1m1708 | [0m[35m[0m
[30;1m1709 | [0m[35m        if scanned_devices[ip].displayed and ip in broadcast_messages:[0m
[30;1m1710 | [0m[35m            # remove the "Received Broadcast from ..." line[0m
[30;1m1711 | [0m[35m            del broadcast_messages[ip][0m
[30;1m1712 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1694 | [0m[35m        if broadcasted_devices[ip].displayed and ip in broadcast_messages:[0m
[30;1m1695 | [0m[35m            del broadcast_messages[ip][0m
[30;1m1696 | [0m[35m[0m
[30;1m1697 | [0m[35m    for ip in scanned_devices:[0m
[30;1m1698 | [0m[35m        ver_str = str(scanned_devices[ip].deviceinfo['version'])[0m
[30;1m1699 | [0m[35m        if ver_str not in ver_count:[0m
[30;1m1700 | [0m[35m            ver_count[ver_str] = 1[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1691 | [0m[35m        elif not broadcasted_devices[ip].deviceinfo['key']:[0m
[30;1m1692 | [0m[35m            no_key_count += 1[0m
[30;1m1693 | [0m[35m[0m
[30;1m1694 | [0m[35m        if broadcasted_devices[ip].displayed and ip in broadcast_messages:[0m
[30;1m1695 | [0m[35m            del broadcast_messages[ip][0m
[30;1m1696 | [0m[35m[0m
[30;1m1697 | [0m[35m    for ip in scanned_devices:[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1678 | [0m[35m    no_key_count = 0[0m
[30;1m1679 | [0m[35m[0m
[30;1m1680 | [0m[35m    for ip in broadcasted_devices:[0m
[30;1m1681 | [0m[35m        if ip in scanned_devices:[0m
[30;1m1682 | [0m[35m            del scanned_devices[ip][0m
[30;1m1683 | [0m[35m        ver_str = str(broadcasted_devices[ip].deviceinfo['version'])[0m
[30;1m1684 | [0m[35m        if ver_str not in ver_count:[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1677 | [0m[35m    unknown_dev_count = 0[0m
[30;1m1678 | [0m[35m    no_key_count = 0[0m
[30;1m1679 | [0m[35m[0m
[30;1m1680 | [0m[35m    for ip in broadcasted_devices:[0m
[30;1m1681 | [0m[35m        if ip in scanned_devices:[0m
[30;1m1682 | [0m[35m            del scanned_devices[ip][0m
[30;1m1683 | [0m[35m        ver_str = str(broadcasted_devices[ip].deviceinfo['version'])[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1619 | [0m[35m                        dev.abort()[0m
[30;1m1620 | [0m[35m                        break[0m
[30;1m1621 | [0m[35m[0m
[30;1m1622 | [0m[35m        for ip in connect_this_round:[0m
[30;1m1623 | [0m[35m            broadcasted_devices[ip].connect()[0m
[30;1m1624 | [0m[35m            devicelist.append( broadcasted_devices[ip] )[0m
[30;1m1625 | [0m[35m            check_end_time = time.time() + connect_timeout[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1595 | [0m[35m                else:[0m
[30;1m1596 | [0m[35m                    broadcasted_devices[ip].close()[0m
[30;1m1597 | [0m[35m[0m
[30;1m1598 | [0m[35m                if ip in wantips:[0m
[30;1m1599 | [0m[35m                    wantips.remove(ip)[0m
[30;1m1600 | [0m[35m                if broadcasted_devices[ip].deviceinfo['gwId'] in wantids:[0m
[30;1m1601 | [0m[35m                    wantids.remove( broadcasted_devices[ip].deviceinfo['gwId'] )[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1576 | [0m[35m                    except:[0m
[30;1m1577 | [0m[35m                        pass[0m
[30;1m1578 | [0m[35m[0m
[30;1m1579 | [0m[35m                broadcasted_devices[ip] = PollDevice( ip, result, options, ip in debug_ips )[0m
[30;1m1580 | [0m[35m                do_poll = False[0m
[30;1m1581 | [0m[35m[0m
[30;1m1582 | [0m[35m                if poll:[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1543 | [0m[35m[0m
[30;1m1544 | [0m[35m            # check to see if we have seen this device before and add to devices array[0m
[30;1m1545 | [0m[35m            #if tinytuya.appenddevice(result, deviceslist) is False:[0m
[30;1m1546 | [0m[35m            if ip not in broadcasted_devices:[0m
[30;1m1547 | [0m[35m                (dname, dkey, mac) = tuyaLookup(result['gwId'])[0m
[30;1m1548 | [0m[35m                result["name"] = dname[0m
[30;1m1549 | [0m[35m                result["key"] = dkey[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1529 | [0m[35m                continue[0m
[30;1m1530 | [0m[35m[0m
[30;1m1531 | [0m[35m            if 'from' in result and result['from'] == 'app': #sock is clientapp:[0m
[30;1m1532 | [0m[35m                if ip not in broadcasted_apps:[0m
[30;1m1533 | [0m[35m                    broadcasted_apps[ip] = result[0m
[30;1m1534 | [0m[35m                    if verbose:[0m
[30;1m1535 | [0m[35m                        print( term.alertdim + 'New Broadcast from App at ' + str(ip) + term.dim + '[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1512 | [0m[35m                tgt_port = '???'[0m
[30;1m1513 | [0m[35m[0m
[30;1m1514 | [0m[35m            data, addr = sock.recvfrom(4048)[0m
[30;1m1515 | [0m[35m            ip = addr[0][0m
[30;1m1516 | [0m[35m            result = b''[0m
[30;1m1517 | [0m[35m            try:[0m
[30;1m1518 | [0m[35m                result = tinytuya.decrypt_udp( data )[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1456 | [0m[35m                                write_socks.append(dev.sock)[0m
[30;1m1457 | [0m[35m                                all_socks[dev.sock] = dev[0m
[30;1m1458 | [0m[35m[0m
[30;1m1459 | [0m[35m                            # we slept here so adjust the loop sleep time accordingly[0m
[30;1m1460 | [0m[35m                            time.sleep(0.02)[0m
[30;1m1461 | [0m[35m                            need_sleep -= 0.02[0m
[30;1m1462 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1442 | [0m[35m                                continue[0m
[30;1m1443 | [0m[35m                            elif current_ip in snapshot and snapshot[current_ip]['version'] and snap[0m
[30;1m1444 | [0m[35m                                ip = current_ip[0m
[30;1m1445 | [0m[35m                                broadcasted_devices[ip] = PollDevice( ip, snapshot[current_ip], opti[0m
[30;1m1446 | [0m[35m                                broadcasted_devices[ip].connect()[0m
[30;1m1447 | [0m[35m                                devicelist.append( broadcasted_devices[ip] )[0m
[30;1m1448 | [0m[35m                                check_end_time = time.time() + connect_timeout[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1441 | [0m[35m                            if current_ip in broadcasted_devices:[0m
[30;1m1442 | [0m[35m                                continue[0m
[30;1m1443 | [0m[35m                            elif current_ip in snapshot and snapshot[current_ip]['version'] and snap[0m
[30;1m1444 | [0m[35m                                ip = current_ip[0m
[30;1m1445 | [0m[35m                                broadcasted_devices[ip] = PollDevice( ip, snapshot[current_ip], opti[0m
[30;1m1446 | [0m[35m                                broadcasted_devices[ip].connect()[0m
[30;1m1447 | [0m[35m                                devicelist.append( broadcasted_devices[ip] )[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1420 | [0m[35m                # half-speed the spinner while force-scanning[0m
[30;1m1421 | [0m[35m                need_sleep = 0.2[0m
[30;1m1422 | [0m[35m                # time out any sockets which have not yet connected[0m
[30;1m1423 | [0m[35m                # no need to run this every single time through the loop[0m
[30;1m1424 | [0m[35m                if ip_scan_delay:[0m
[30;1m1425 | [0m[35m                    if ip_scan_delay < time.time():[0m
[30;1m1426 | [0m[35m                        ip_scan_delay = False[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1419 | [0m[35m            if ip_scan_running:[0m
[30;1m1420 | [0m[35m                # half-speed the spinner while force-scanning[0m
[30;1m1421 | [0m[35m                need_sleep = 0.2[0m
[30;1m1422 | [0m[35m                # time out any sockets which have not yet connected[0m
[30;1m1423 | [0m[35m                # no need to run this every single time through the loop[0m
[30;1m1424 | [0m[35m                if ip_scan_delay:[0m
[30;1m1425 | [0m[35m                    if ip_scan_delay < time.time():[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1385 | [0m[35m[0m
[30;1m1386 | [0m[35m                if (not dev.passive) and ((dev.timeo + 1.0) > device_end_time):[0m
[30;1m1387 | [0m[35m                    # if dev.debug:[0m
[30;1m1388 | [0m[35m                    #     print('Resetting device scan end time due to debug ip', dev.ip, device_end[0m
[30;1m1389 | [0m[35m                    #     if len(devices_with_timers) < 64:[0m
[30;1m1390 | [0m[35m                    #         devices_with_timers += ' ' + str(dev.ip) + ' ' + str(int(dev.timeo))[0m
[30;1m1391 | [0m[35m                    device_end_time = dev.timeo + 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1324 | [0m[35m[0m
[30;1m1325 | [0m[35m    if snapshot:[0m
[30;1m1326 | [0m[35m        for ip in snapshot:[0m
[30;1m1327 | [0m[35m            networks.append( ip )[0m
[30;1m1328 | [0m[35m    else:[0m
[30;1m1329 | [0m[35m        snapshot = [][0m
[30;1m1330 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1323 | [0m[35m                    return None[0m
[30;1m1324 | [0m[35m[0m
[30;1m1325 | [0m[35m    if snapshot:[0m
[30;1m1326 | [0m[35m        for ip in snapshot:[0m
[30;1m1327 | [0m[35m            networks.append( ip )[0m
[30;1m1328 | [0m[35m    else:[0m
[30;1m1329 | [0m[35m        snapshot = [][0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1314 | [0m[35m                    log.debug("Unable to get local network, using default %r", DEFAULT_NETWORK)[0m
[30;1m1315 | [0m[35m                    if verbose:[0m
[30;1m1316 | [0m[35m                        print(term.alert +[0m
[30;1m1317 | [0m[35m                              'ERROR: Unable to get your IP address and network automatically, using[0m
[30;1m1318 | [0m[35m                              term.normal)[0m
[30;1m1319 | [0m[35m            else:[0m
[30;1m1320 | [0m[35m                networks = getmyIPs( term, verbose, not assume_yes )[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1307 | [0m[35m                      '           (Requires: `pip install netifaces` or `pip install psutil`)\n' + t[0m
[30;1m1308 | [0m[35m                try:[0m
[30;1m1309 | [0m[35m                    ip = getmyIP()[0m
[30;1m1310 | [0m[35m                    networks.append( ip )[0m
[30;1m1311 | [0m[35m                except:[0m
[30;1m1312 | [0m[35m                    #traceback.print_exc()[0m
[30;1m1313 | [0m[35m                    networks.append( u''+DEFAULT_NETWORK )[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1306 | [0m[35m                      '    NOTE: neither module netifaces nor module psutil are available, multi-int[0m
[30;1m1307 | [0m[35m                      '           (Requires: `pip install netifaces` or `pip install psutil`)\n' + t[0m
[30;1m1308 | [0m[35m                try:[0m
[30;1m1309 | [0m[35m                    ip = getmyIP()[0m
[30;1m1310 | [0m[35m                    networks.append( ip )[0m
[30;1m1311 | [0m[35m                except:[0m
[30;1m1312 | [0m[35m                    #traceback.print_exc()[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1293 | [0m[35m                        networks.append( ip2 )[0m
[30;1m1294 | [0m[35m                        add_connected = False[0m
[30;1m1295 | [0m[35m                else:[0m
[30;1m1296 | [0m[35m                    networks.append( ip )[0m
[30;1m1297 | [0m[35m                    add_connected = False[0m
[30;1m1298 | [0m[35m[0m
[30;1m1299 | [0m[35m        if isinstance( forcescan, str ) or isinstance( forcescan, bytes ):[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1287 | [0m[35m        # the inner list is empty [[]] when no address specified[0m
[30;1m1288 | [0m[35m        add_connected = True[0m
[30;1m1289 | [0m[35m        if isinstance( forcescan, list ) or isinstance( forcescan, tuple ):[0m
[30;1m1290 | [0m[35m            for ip in forcescan:[0m
[30;1m1291 | [0m[35m                if isinstance( ip, list ) or isinstance( ip, tuple ):[0m
[30;1m1292 | [0m[35m                    for ip2 in ip:[0m
[30;1m1293 | [0m[35m                        networks.append( ip2 )[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1136 | [0m[35m    To unpack data, you can do something like this:[0m
[30;1m1137 | [0m[35m[0m
[30;1m1138 | [0m[35m        devices = tinytuya.deviceScan()[0m
[30;1m1139 | [0m[35m        for ip in devices:[0m
[30;1m1140 | [0m[35m            id = devices[ip]['gwId'][0m
[30;1m1141 | [0m[35m            key = devices[ip]['productKey'][0m
[30;1m1142 | [0m[35m            vers = devices[ip]['version'][0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1125 | [0m[35m       discover = True or False, when False, UDP broadcast packets will be ignored[0m
[30;1m1126 | [0m[35m        wantips = A list of IP addresses we want.  Scan will stop early if all are found[0m
[30;1m1127 | [0m[35m        wantids = A list of Device IDs we want.  Scan will stop early if all are found[0m
[30;1m1128 | [0m[35m        snapshot = A dict of devices with IP addresses as keys.  These devices will be force-scanned[0m
[30;1m1129 | [0m[35m        assume_yes = True or False, do not prompt to confirm auto-detected network ranges[0m
[30;1m1130 | [0m[35m        tuyadevices = contents of devices.json, to prevent re-loading it if we already have it[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1122 | [0m[35m addresses[0m
[30;1m1123 | [0m[35m        byID = True or False, return dictionary by ID, otherwise by IP (default)[0m
[30;1m1124 | [0m[35m        show_timer = True or False, if True then timer will be displayed even when verbose=False[0m
[30;1m1125 | [0m[35m        discover = True or False, when False, UDP broadcast packets will be ignored[0m
[30;1m1126 | [0m[35m        wantips = A list of IP addresses we want.  Scan will stop early if all are found[0m
[30;1m1127 | [0m[35m        wantids = A list of Device IDs we want.  Scan will stop early if all are found[0m
[30;1m1128 | [0m[35m        snapshot = A dict of devices with IP addresses as keys.  These devices will be force-scanned[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1120 | [0m[35m        color = True or False, print output in color [Default: True][0m
[30;1m1121 | [0m[35m        poll = True or False, poll dps status for devices if possible[0m
[30;1m1122 | [0m[35m        forcescan = True, False, or a list of networks to force scan for device IP addresses[0m
[30;1m1123 | [0m[35m        byID = True or False, return dictionary by ID, otherwise by IP (default)[0m
[30;1m1124 | [0m[35m        show_timer = True or False, if True then timer will be displayed even when verbose=False[0m
[30;1m1125 | [0m[35m        discover = True or False, when False, UDP broadcast packets will be ignored[0m
[30;1m1126 | [0m[35m        wantips = A list of IP addresses we want.  Scan will stop early if all are found[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1119 | [0m[35m        scantime = The time to wait to pick up UDP from all devices (ignored when discover=False))[0m
[30;1m1120 | [0m[35m        color = True or False, print output in color [Default: True][0m
[30;1m1121 | [0m[35m        poll = True or False, poll dps status for devices if possible[0m
[30;1m1122 | [0m[35m        forcescan = True, False, or a list of networks to force scan for device IP addresses[0m
[30;1m1123 | [0m[35m        byID = True or False, return dictionary by ID, otherwise by IP (default)[0m
[30;1m1124 | [0m[35m        show_timer = True or False, if True then timer will be displayed even when verbose=False[0m
[30;1m1125 | [0m[35m        discover = True or False, when False, UDP broadcast packets will be ignored[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1116 | [0m[35m[0m
[30;1m1117 | [0m[35m    Parameters:[0m
[30;1m1118 | [0m[35m        verbose = True or False, print formatted output to stdout [Default: False][0m
[30;1m1119 | [0m[35m        scantime = The time to wait to pick up UDP from all devices (ignored when discover=False))[0m
[30;1m1120 | [0m[35m        color = True or False, print output in color [Default: True][0m
[30;1m1121 | [0m[35m        poll = True or False, poll dps status for devices if possible[0m
[30;1m1122 | [0m[35m        forcescan = True, False, or a list of networks to force scan for device IP addresses[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1068 | [0m[35mdef _print_device_info( result, note, term, extra_message=None, verbose=True ):[0m
[30;1m1069 | [0m[35m    if not verbose:[0m
[30;1m1070 | [0m[35m        return[0m
[30;1m1071 | [0m[35m    ip = result["ip"][0m
[30;1m1072 | [0m[35m    gwId = result["gwId"][0m
[30;1m1073 | [0m[35m    productKey = result["productKey"] if result["productKey"] else '?'[0m
[30;1m1074 | [0m[35m    version = result["version"] if result["version"] and result["version"] != '0.0' else '??'[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m984 | [0m[35m            except:[0m
[30;1m985 | [0m[35m                break[0m
[30;1m986 | [0m[35m[0m
[30;1m987 | [0m[35m            # this will not strip everything, but it will be enough for data.find() to find it[0m
[30;1m988 | [0m[35m            odata = data[0m
[30;1m989 | [0m[35m            data = data[len(msg.payload)+8:][0m
[30;1m990 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m910 | [0m[35m                print('PollDevice: New timeo:', self.timeo)[0m
[30;1m911 | [0m[35m        else:[0m
[30;1m912 | [0m[35m            if self.debug:[0m
[30;1m913 | [0m[35m                print('PollDevice: Final timeout for debug ip', self.ip, '- aborting')[0m
[30;1m914 | [0m[35m            err = ""[0m
[30;1m915 | [0m[35m            if "err" in self.deviceinfo:[0m
[30;1m916 | [0m[35m                err = self.deviceinfo["err"][0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m899 | [0m[35m    def	timeout( self ):[0m
[30;1m900 | [0m[35m        if self.retries > 0:[0m
[30;1m901 | [0m[35m            if self.debug:[0m
[30;1m902 | [0m[35m                print('PollDevice: Timeout for debug ip', self.ip, '- reconnecting, retries', self.r[0m
[30;1m903 | [0m[35m            self.retries -= 1[0m
[30;1m904 | [0m[35m            # get_peer() may have closed it already[0m
[30;1m905 | [0m[35m            if self.sock:[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m            odata = data[0m
[30;1m670 | [0m[35m            #data = data[tinytuya.message_length(msg.payload):][0m
[30;1m671 | [0m[35m            # this will not strip everything, but it will be enough for data.find() to find it[0m
[30;1m672 | [0m[35m            data = data[len(msg.payload)+8:][0m
[30;1m673 | [0m[35m[0m
[30;1m674 | [0m[35m            # ignore NULL packets[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m547 | [0m[35m        # get_peer() returns:[0m
[30;1m548 | [0m[35m        #  'None' on connection refused[0m
[30;1m549 | [0m[35m        #  'False' when connection was made but then closed[0m
[30;1m550 | [0m[35m        #  The IP address when the connection is still open[0m
[30;1m551 | [0m[35m        addr = self.get_peer()[0m
[30;1m552 | [0m[35m        if self.debug:[0m
[30;1m553 | [0m[35m            print('ForceScannedDevice: device', self.ip, 'addr is:', addr)[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m309 | [0m[35m        #    self.deviceinfo['gwId'] = ''[0m
[30;1m310 | [0m[35m        #if not self.deviceinfo['key']:[0m
[30;1m311 | [0m[35m        #    self.deviceinfo['key'] = ''[0m
[30;1m312 | [0m[35m        self.deviceinfo['ip'] = ip[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m    def connect( self ):[0m
[30;1m315 | [0m[35m        if self.debug:[0m
[30;1m316 | [0m[35m            print('Connecting to debug ip', self.ip)[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35mclass DeviceDetect(object):[0m
[30;1m263 | [0m[35m    def __init__( self, ip, deviceinfo, options, debug ):[0m
[30;1m264 | [0m[35m        self.ip = ip[0m
[30;1m265 | [0m[35m        self.deviceinfo = None[0m
[30;1m266 | [0m[35m        self.options = options[0m
[30;1m267 | [0m[35m        self.debug = debug[0m
[30;1m268 | [0m[35m        self.device = None[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m# Helper Functions[0m
[30;1m99 | [0m[35mdef getmyIPaddr():[0m
[30;1m100 | [0m[35m    # Fetch my IP address and assume /24 network[0m
[30;1m101 | [0m[35m    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)[0m
[30;1m102 | [0m[35m    s.connect(("8.8.8.8", 80))[0m
[30;1m103 | [0m[35m    r = str(s.getsockname()[0])[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35mUDPPORT = tinytuya.UDPPORT          # Tuya 3.1 UDP Port[0m
[30;1m69 | [0m[35mUDPPORTS = tinytuya.UDPPORTS        # Tuya 3.3 encrypted UDP Port[0m
[30;1m70 | [0m[35mUDPPORTAPP = tinytuya.UDPPORTAPP    # Tuya app encrypted UDP Port[0m
[30;1m71 | [0m[35mTIMEOUT = tinytuya.TIMEOUT          # Socket Timeout[0m
[30;1m72 | [0m[35mSCANTIME = tinytuya.SCANTIME        # How many seconds to wait before stopping[0m
[30;1m73 | [0m[35mBROADCASTTIME = 6                   # How often to broadcast to port 7000 to get v3.5 devices to sen[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35mmax_parallel = 300[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35mMAXCOUNT = tinytuya.MAXCOUNT        # How many tries before stopping[0m
[30;1m68 | [0m[35mUDPPORT = tinytuya.UDPPORT          # Tuya 3.1 UDP Port[0m
[30;1m69 | [0m[35mUDPPORTS = tinytuya.UDPPORTS        # Tuya 3.3 encrypted UDP Port[0m
[30;1m70 | [0m[35mUDPPORTAPP = tinytuya.UDPPORTAPP    # Tuya app encrypted UDP Port[0m
[30;1m71 | [0m[35mTIMEOUT = tinytuya.TIMEOUT          # Socket Timeout[0m
[30;1m72 | [0m[35mSCANTIME = tinytuya.SCANTIME        # How many seconds to wait before stopping[0m
[30;1m73 | [0m[35mBROADCASTTIME = 6                   # How often to broadcast to port 7000 to get v3.5 devices to sen[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mimport sys[0m
[30;1m24 | [0m[35mimport time[0m
[30;1m25 | [0m[35mimport errno[0m
[30;1m26 | [0m[35mimport base64[0m
[30;1m27 | [0m[35mimport traceback[0m
[30;1m28 | [0m[35mfrom colorama import init[0m
[30;1m29 | [0m[35mimport tinytuya[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/scanner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mimport socket[0m
[30;1m22 | [0m[35mimport select[0m
[30;1m23 | [0m[35mimport sys[0m
[30;1m24 | [0m[35mimport time[0m
[30;1m25 | [0m[35mimport errno[0m
[30;1m26 | [0m[35mimport base64[0m
[30;1m27 | [0m[35mimport traceback[0m
[30;1m28 | [0m[35mfrom colorama import init[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m480 | [0m[35m            print( '' )[0m
[30;1m481 | [0m[35m            print( 'Pulse train:' )[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m            # expand the symbols into their pulses[0m
[30;1m484 | [0m[35m            for c in expanded:[0m
[30;1m485 | [0m[35m                print( symbol_timings[c], end=' ' )[0m
[30;1m486 | [0m[35m            print( '' )[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m433 | [0m[35m                # all finished[0m
[30;1m434 | [0m[35m                break[0m
[30;1m435 | [0m[35m[0m
[30;1m436 | [0m[35m            # next, expand packed bits[0m
[30;1m437 | [0m[35m            #print( 'Unpacking:', key[:4] )[0m
[30;1m438 | [0m[35m            byts, bits = struct.unpack( '>BB', bytearray.fromhex( key[:4] ) )[0m
[30;1m439 | [0m[35m            key = key[4:][0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m        # although it's not as effiecient, it's easier to see what's going on if[0m
[30;1m417 | [0m[35m        #  you first unpack the packed bits into their symbol pairs, and then[0m
[30;1m418 | [0m[35m        #  expand those symbols to their timing times[0m
[30;1m419 | [0m[35m[0m
[30;1m420 | [0m[35m        expanded = ''[0m
[30;1m421 | [0m[35m        while key:[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m367 | [0m[35m            return IRRemoteControlDevice.base64_to_pulses( key )[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m        if len(head) < 18:[0m
[30;1m370 | [0m[35m            raise ValueError( '"head" must be at least 18 characters' )[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m        head = bytearray.fromhex( head )[0m
[30;1m373 | [0m[35m        headtype, timescale, unused1, unused2, num_timings = struct.unpack( '>BHHHH', head[:9] )[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m361 | [0m[35m    @staticmethod[0m
[30;1m362 | [0m[35m    def head_key_to_pulses( head, key ):[0m
[30;1m363 | [0m[35m        if len(key) < 4:[0m
[30;1m364 | [0m[35m            raise ValueError( '"key" must be at least 4 characters' )[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m        if not head:[0m
[30;1m367 | [0m[35m            return IRRemoteControlDevice.base64_to_pulses( key )[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m195 | [0m[35m                self.control_type = 2[0m
[30;1m196 | [0m[35m            status = self._send_receive(None)[0m
[30;1m197 | [0m[35m        if not self.control_type:[0m
[30;1m198 | [0m[35m            log.warning( 'Detect control type failed! control_type= must be set manually' )[0m
[30;1m199 | [0m[35m        self.set_socketTimeout( old_timeout )[0m
[30;1m200 | [0m[35m        self.set_socketPersistent( old_persist )[0m
[30;1m201 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m191 | [0m[35m                self.control_type = 1[0m
[30;1m192 | [0m[35m            # newer devices using DPS 1-13[0m
[30;1m193 | [0m[35m            elif self.DP_MODE in status['dps']:[0m
[30;1m194 | [0m[35m                log.debug( 'Detected control type 2' )[0m
[30;1m195 | [0m[35m                self.control_type = 2[0m
[30;1m196 | [0m[35m            status = self._send_receive(None)[0m
[30;1m197 | [0m[35m        if not self.control_type:[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m187 | [0m[35m        while status and 'dps' in status:[0m
[30;1m188 | [0m[35m            # original devices using DPS 201/202[0m
[30;1m189 | [0m[35m            if self.DP_SEND_IR in status['dps']:[0m
[30;1m190 | [0m[35m                log.debug( 'Detected control type 1' )[0m
[30;1m191 | [0m[35m                self.control_type = 1[0m
[30;1m192 | [0m[35m            # newer devices using DPS 1-13[0m
[30;1m193 | [0m[35m            elif self.DP_MODE in status['dps']:[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m135 | [0m[35m    DP_KEY_STUDY4     =  "12"[0m
[30;1m136 | [0m[35m    DP_SEND_DELAY     =  "10"[0m
[30;1m137 | [0m[35m    DP_CODE_TYPE      =  "13"[0m
[30;1m138 | [0m[35m    NSDP_CONTROL = "control"       # The control commands[0m
[30;1m139 | [0m[35m    NSDP_STUDY_CODE = "study_code" # Report learned IR codes[0m
[30;1m140 | [0m[35m    NSDP_IR_CODE = "ir_code"       # IR signal decoding2[0m
[30;1m141 | [0m[35m    NSDP_KEY_CODE = "key_code"     # Remote key code[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35mimport struct[0m
[30;1m117 | [0m[35mimport time[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35mfrom ..core import Device, log, CONTROL[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35mclass IRRemoteControlDevice(Device):[0m
[30;1m122 | [0m[35m    CMD_SEND_KEY_CODE = "send_ir"   # Command to start sending a key[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35m            -> start or end a study session[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        ir.receive_button( timeout )[0m
[30;1m37 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m38 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        ir.send_button( base64_code )[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m20 | [0m[35m               control_type=2 for newer devices using DPS 1-13[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m        ir.detect_control_type()[0m
[30;1m23 | [0m[35m            -> polls device status to try and detect the control type[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m        ir.send_command( mode, data={} )[0m
[30;1m26 | [0m[35m            -> sends a command to the device[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    Functions:[0m
[30;1m17 | [0m[35m        ir = IRRemoteControlDevice(..., control_type=None)[0m
[30;1m18 | [0m[35m            -> will immediately connect to the device to try and detect the control type if control_[0m
[30;1m19 | [0m[35m               control_type=1 for older devices using DPS 201/202[0m
[30;1m20 | [0m[35m               control_type=2 for newer devices using DPS 1-13[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m Module Author: Alexey 'Cluster' Avdyukhin (https://github.com/clusterm)[0m
[30;1m9 | [0m[35m Rewritten by uzlonewolf (https://github.com/uzlonewolf) for new devices and IR format conversion[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m Local Control Classes[0m
[30;1m12 | [0m[35m    IRRemoteControlDevice(..., version=3.3)[0m
[30;1m13 | [0m[35m        This class uses a default version of 3.3[0m
[30;1m14 | [0m[35m        See OutletDevice() for the other constructor arguments[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# TinyTuya Contrib IRRemoteControlDevice Module[0m
[30;1m2 | [0m[35m# -*- coding: utf-8 -*-[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35m A community-contributed Python module to add support for Tuya WiFi smart universal remote control s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m This module attempts to provide everything needed so there is no need to import the base tinytuya m[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m752 | [0m[35m                    symbol_list[k][1] = s[0m
[30;1m753 | [0m[35m                    time_symbols[t] = s[0m
[30;1m754 | [0m[35m            mylog.debug('symbol list after assignment:  %r', symbol_list )[0m
[30;1m755 | [0m[35m            mylog.debug('unique time symbols: %r', time_symbols)[0m
[30;1m756 | [0m[35m            if need_abort:[0m
[30;1m757 | [0m[35m                mylog.debug('!! need_abort !!')[0m
[30;1m758 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m704 | [0m[35m            mylog.debug('initial symbol list: %r', symbol_list)[0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m            # if the common length and the zero length are the same, combine them as 'head type 1'[0m
[30;1m707 | [0m[35m            # first find the symbols for '@' and '#'[0m
[30;1m708 | [0m[35m            bit_start_symbol = bit_zero_symbol = None[0m
[30;1m709 | [0m[35m            for k in symbol_list:[0m
[30;1m710 | [0m[35m                if symbol_list[k][1] == '@':[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m629 | [0m[35m[0m
[30;1m630 | [0m[35m            mylog.debug( 'pat_counts: %r', pat_counts )[0m
[30;1m631 | [0m[35m[0m
[30;1m632 | [0m[35m            # find the most-common and next-most-common pattern pair[0m
[30;1m633 | [0m[35m            pat_max = [0, ''][0m
[30;1m634 | [0m[35m            pat_next_max = [0, ''][0m
[30;1m635 | [0m[35m            for k in pat_counts:[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m610 | [0m[35m        encoding_type_shortest = [None, None][0m
[30;1m611 | [0m[35m        encoding_type_symbol_list = [{}, {}][0m
[30;1m612 | [0m[35m        bit_time_types = [0, 0][0m
[30;1m613 | [0m[35m        # calculate the head and key for both space-width and pulse-width encoding[0m
[30;1m614 | [0m[35m        # we will use the shorter of the 2 as the final head/key[0m
[30;1m615 | [0m[35m        for encoding_type in range( 2 ):[0m
[30;1m616 | [0m[35m            mylog.debug( '' )[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m586 | [0m[35m        mylog.debug( 'symbol pattern: %r', symbol_pattern )[0m
[30;1m587 | [0m[35m        mylog.debug( 'symbol list: %r', symbol_list )[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35m        # find the most-commonly-ocurring pulse and space lengths[0m
[30;1m590 | [0m[35m        pmax = { 'count': 0, 'time': 0 }[0m
[30;1m591 | [0m[35m        smax = { 'count': 0, 'time': 0 }[0m
[30;1m592 | [0m[35m        for k in p_key_map:[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m480 | [0m[35m            print( '' )[0m
[30;1m481 | [0m[35m            print( 'Pulse train:' )[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m            # expand the symbols into their pulses[0m
[30;1m484 | [0m[35m            for c in expanded:[0m
[30;1m485 | [0m[35m                print( symbol_timings[c], end=' ' )[0m
[30;1m486 | [0m[35m            print( '' )[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m433 | [0m[35m                # all finished[0m
[30;1m434 | [0m[35m                break[0m
[30;1m435 | [0m[35m[0m
[30;1m436 | [0m[35m            # next, expand packed bits[0m
[30;1m437 | [0m[35m            #print( 'Unpacking:', key[:4] )[0m
[30;1m438 | [0m[35m            byts, bits = struct.unpack( '>BB', bytearray.fromhex( key[:4] ) )[0m
[30;1m439 | [0m[35m            key = key[4:][0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m        # although it's not as effiecient, it's easier to see what's going on if[0m
[30;1m417 | [0m[35m        #  you first unpack the packed bits into their symbol pairs, and then[0m
[30;1m418 | [0m[35m        #  expand those symbols to their timing times[0m
[30;1m419 | [0m[35m[0m
[30;1m420 | [0m[35m        expanded = ''[0m
[30;1m421 | [0m[35m        while key:[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m        if False:[0m
[30;1m405 | [0m[35m            print( 'Head:' )[0m
[30;1m406 | [0m[35m            print( 'Frequency: %r kHz, Time Base: %r' % (timescale / 100.0, timebase) )[0m
[30;1m407 | [0m[35m            print( 'Bit Symbols: 0 = %s, 1 = %s' % bit_timimgs)[0m
[30;1m408 | [0m[35m            print( 'Symbol Timings:' )[0m
[30;1m409 | [0m[35m            for i in range(num_timings):[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m394 | [0m[35m            raise ValueError( '"head" must be %d characters' % ((headlen+9)*2) )[0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35m        # unpack the timing values, however many there are[0m
[30;1m397 | [0m[35m        fmt = '>%dH' % num_timings[0m
[30;1m398 | [0m[35m        timings = struct.unpack( fmt, head[9:] )[0m
[30;1m399 | [0m[35m        symbol_timings = {}[0m
[30;1m400 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m369 | [0m[35m        if len(head) < 18:[0m
[30;1m370 | [0m[35m            raise ValueError( '"head" must be at least 18 characters' )[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m        head = bytearray.fromhex( head )[0m
[30;1m373 | [0m[35m        headtype, timescale, unused1, unused2, num_timings = struct.unpack( '>BHHHH', head[:9] )[0m
[30;1m374 | [0m[35m        headlen = num_timings * 2 # times are 16-bit[0m
[30;1m375 | [0m[35m        timebase = 100000.0 / timescale[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m369 | [0m[35m        if len(head) < 18:[0m
[30;1m370 | [0m[35m            raise ValueError( '"head" must be at least 18 characters' )[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m        head = bytearray.fromhex( head )[0m
[30;1m373 | [0m[35m        headtype, timescale, unused1, unused2, num_timings = struct.unpack( '>BHHHH', head[:9] )[0m
[30;1m374 | [0m[35m        headlen = num_timings * 2 # times are 16-bit[0m
[30;1m375 | [0m[35m        timebase = 100000.0 / timescale[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m    @staticmethod[0m
[30;1m357 | [0m[35m    def pulses_to_base64( pulses ):[0m
[30;1m358 | [0m[35m        fmt = '<' + str(len(pulses)) + 'H'[0m
[30;1m359 | [0m[35m        return base64.b64encode( struct.pack(fmt, *pulses) ).decode("ascii")[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m350 | [0m[35m            # code can be padded with "1"[0m
[30;1m351 | [0m[35m            code_base_64 = code_base_64[1:][0m
[30;1m352 | [0m[35m        raw_bytes = base64.b64decode(code_base_64)[0m
[30;1m353 | [0m[35m        fmt = '<%dH' % (len(raw_bytes) >> 1)[0m
[30;1m354 | [0m[35m        return list(struct.unpack(fmt, raw_bytes))[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m330 | [0m[35m        for i in timings:[0m
[30;1m331 | [0m[35m            head += '%04X' % i[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m        return head[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m    @staticmethod[0m
[30;1m336 | [0m[35m    def print_pulses( base64_code, use_log=None ):[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m328 | [0m[35m        head = '%02X%04X0000000000' % (bit_time_type, freq)[0m
[30;1m329 | [0m[35m        head += '%02X%04X%04X%04X' % (len(timings) + 3, bit_time, zero_time, one_time)[0m
[30;1m330 | [0m[35m        for i in timings:[0m
[30;1m331 | [0m[35m            head += '%04X' % i[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m        return head[0m
[30;1m334 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m                timings[i] = round( timings[i] / time_base )[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        head = '%02X%04X0000000000' % (bit_time_type, freq)[0m
[30;1m329 | [0m[35m        head += '%02X%04X%04X%04X' % (len(timings) + 3, bit_time, zero_time, one_time)[0m
[30;1m330 | [0m[35m        for i in timings:[0m
[30;1m331 | [0m[35m            head += '%04X' % i[0m
[30;1m332 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m            for i in range(len(timings)):[0m
[30;1m326 | [0m[35m                timings[i] = round( timings[i] / time_base )[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        head = '%02X%04X0000000000' % (bit_time_type, freq)[0m
[30;1m329 | [0m[35m        head += '%02X%04X%04X%04X' % (len(timings) + 3, bit_time, zero_time, one_time)[0m
[30;1m330 | [0m[35m        for i in timings:[0m
[30;1m331 | [0m[35m            head += '%04X' % i[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m283 | [0m[35m                    response_code = response # Pass it if we do not get a response we like[0m
[30;1m284 | [0m[35m                    # try again[0m
[30;1m285 | [0m[35m        finally:[0m
[30;1m286 | [0m[35m            # Revert timeout[0m
[30;1m287 | [0m[35m            self.set_socketTimeout(old_timeout)[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m        if found:[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m                    response_code = response # Some error message? Pass it.[0m
[30;1m270 | [0m[35m                    break[0m
[30;1m271 | [0m[35m                elif self.DP_LEARNED_ID in response["dps"]:[0m
[30;1m272 | [0m[35m                    # Button code received, extracting it as Base64 string[0m
[30;1m273 | [0m[35m                    response_code = response["dps"][self.DP_LEARNED_ID][0m
[30;1m274 | [0m[35m                    found = True[0m
[30;1m275 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m251 | [0m[35m        found = False[0m
[30;1m252 | [0m[35m        # Remember old timeout and set new timeout[0m
[30;1m253 | [0m[35m        old_timeout = self.connection_timeout[0m
[30;1m254 | [0m[35m        end_at_time = time.time() + timeout[0m
[30;1m255 | [0m[35m        try:[0m
[30;1m256 | [0m[35m            while end_at_time > time.time():[0m
[30;1m257 | [0m[35m                timeo = round(time.time() - end_at_time)[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m        response = None[0m
[30;1m250 | [0m[35m        response_code = None[0m
[30;1m251 | [0m[35m        found = False[0m
[30;1m252 | [0m[35m        # Remember old timeout and set new timeout[0m
[30;1m253 | [0m[35m        old_timeout = self.connection_timeout[0m
[30;1m254 | [0m[35m        end_at_time = time.time() + timeout[0m
[30;1m255 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m        response = None[0m
[30;1m250 | [0m[35m        response_code = None[0m
[30;1m251 | [0m[35m        found = False[0m
[30;1m252 | [0m[35m        # Remember old timeout and set new timeout[0m
[30;1m253 | [0m[35m        old_timeout = self.connection_timeout[0m
[30;1m254 | [0m[35m        end_at_time = time.time() + timeout[0m
[30;1m255 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35mimport json[0m
[30;1m115 | [0m[35mimport logging[0m
[30;1m116 | [0m[35mimport struct[0m
[30;1m117 | [0m[35mimport time[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35mfrom ..core import Device, log, CONTROL[0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m"""[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mimport base64[0m
[30;1m114 | [0m[35mimport json[0m
[30;1m115 | [0m[35mimport logging[0m
[30;1m116 | [0m[35mimport struct[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        IRRemoteControlDevice.head_key_to_pulses ( head='...', key='...' )[0m
[30;1m63 | [0m[35m            -> convert head/key pair to sequence of pulses and gaps[0m
[30;1m64 | [0m[35m               'head' can be None when the key is raw bytes in base64[0m
[30;1m65 | [0m[35m               'key' must begin with '00' through 'FF' when it is not raw bytes in base64[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        IRRemoteControlDevice.pulses_to_head_key ( pulses, fudge=0.1, freq=38 )[0m
[30;1m68 | [0m[35m            -> attempts to pack a sequence of pulses and gaps into a head/key pair[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        IRRemoteControlDevice.head_key_to_pulses ( head='...', key='...' )[0m
[30;1m63 | [0m[35m            -> convert head/key pair to sequence of pulses and gaps[0m
[30;1m64 | [0m[35m               'head' can be None when the key is raw bytes in base64[0m
[30;1m65 | [0m[35m               'key' must begin with '00' through 'FF' when it is not raw bytes in base64[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        IRRemoteControlDevice.pulses_to_head_key ( pulses, fudge=0.1, freq=38 )[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        ir.receive_button( timeout )[0m
[30;1m37 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m38 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        ir.send_button( base64_code )[0m
[30;1m41 | [0m[35m            -> simulate a learned (raw base64-encoded) button press[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        ir.receive_button( timeout )[0m
[30;1m37 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m38 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        ir.send_button( base64_code )[0m
[30;1m41 | [0m[35m            -> simulate a learned (raw base64-encoded) button press[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m            -> start or end a study session[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        ir.receive_button( timeout )[0m
[30;1m37 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m38 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        ir.send_button( base64_code )[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/IRRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m        ir.study_end()[0m
[30;1m34 | [0m[35m            -> start or end a study session[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        ir.receive_button( timeout )[0m
[30;1m37 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m38 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1038 | [0m[35m        Calling tinytuya.find_device() directly is recommended.[0m
[30;1m1039 | [0m[35m[0m
[30;1m1040 | [0m[35m        Parameters:[0m
[30;1m1041 | [0m[35m            did = The specific Device ID you are looking for (returns only IP and Version)[0m
[30;1m1042 | [0m[35m[0m
[30;1m1043 | [0m[35m        Response:[0m
[30;1m1044 | [0m[35m            (ip, version)[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m947 | [0m[35m[0m
[30;1m948 | [0m[35m    def detect_available_dps(self):[0m
[30;1m949 | [0m[35m        """Return which datapoints are supported by the device."""[0m
[30;1m950 | [0m[35m        # device22 devices need a sort of bruteforce querying in order to detect the[0m
[30;1m951 | [0m[35m        # list of available dps experience shows that the dps available are usually[0m
[30;1m952 | [0m[35m        # in the ranges [1-25] and [100-110] need to split the bruteforcing in[0m
[30;1m953 | [0m[35m        # different steps due to request payload limitation (max. length = 255)[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m906 | [0m[35m[0m
[30;1m907 | [0m[35m    def receive(self):[0m
[30;1m908 | [0m[35m        """[0m
[30;1m909 | [0m[35m        Poll device to read any payload in the buffer.  Timeout results in None returned.[0m
[30;1m910 | [0m[35m        """[0m
[30;1m911 | [0m[35m        return self._send_receive(None)[0m
[30;1m912 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m863 | [0m[35m[0m
[30;1m864 | [0m[35m            payload = self.cipher.encrypt(payload, False)[0m
[30;1m865 | [0m[35m        elif self.version >= 3.2:[0m
[30;1m866 | [0m[35m            # expect to connect and then disconnect to set new[0m
[30;1m867 | [0m[35m            payload = self.cipher.encrypt(payload, False)[0m
[30;1m868 | [0m[35m            if msg.cmd not in H.NO_PROTOCOL_HEADER_CMDS:[0m
[30;1m869 | [0m[35m                # add the 3.x header[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m667 | [0m[35m                    else:[0m
[30;1m668 | [0m[35m                        result = self._process_response(result)[0m
[30;1m669 | [0m[35m                    self.received_wrong_cid_queue.append( (found_child, result) )[0m
[30;1m670 | [0m[35m                # events should not be coming in so fast that we will never timeout a read, so don't[0m
[30;1m671 | [0m[35m                return self._send_receive( None, minresponse, True, decode_response, from_child=from[0m
[30;1m672 | [0m[35m[0m
[30;1m673 | [0m[35m        # legacy/default mode avoids persisting socket across commands[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m594 | [0m[35m                        self.socketRetryLimit[0m
[30;1m595 | [0m[35m                    )[0m
[30;1m596 | [0m[35m                    log.debug("Unable to connect to device ")[0m
[30;1m597 | [0m[35m                    # timeout reached - return error[0m
[30;1m598 | [0m[35m                    return error_json(ERR_CONNECT)[0m
[30;1m599 | [0m[35m                # wait a bit before retrying[0m
[30;1m600 | [0m[35m                time.sleep(0.1)[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m562 | [0m[35m                        "Exceeded tinytuya retry limit (%s)",[0m
[30;1m563 | [0m[35m                        self.socketRetryLimit[0m
[30;1m564 | [0m[35m                    )[0m
[30;1m565 | [0m[35m                    # timeout reached - return error[0m
[30;1m566 | [0m[35m                    return error_json(ERR_KEY_OR_VER)[0m
[30;1m567 | [0m[35m                # wait a bit before retrying[0m
[30;1m568 | [0m[35m                time.sleep(0.1)[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m543 | [0m[35m                log.debug("Keyboard Interrupt - Exiting")[0m
[30;1m544 | [0m[35m                raise[0m
[30;1m545 | [0m[35m            except socket.timeout as err:[0m
[30;1m546 | [0m[35m                # a socket timeout occurred[0m
[30;1m547 | [0m[35m                if payload is None:[0m
[30;1m548 | [0m[35m                    # Receive only mode - return None[0m
[30;1m549 | [0m[35m                    self._check_socket_close()[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m517 | [0m[35m                    enc_payload = self._encode_message(payload) if type(payload) == MessagePayload e[0m
[30;1m518 | [0m[35m                    self.socket.sendall(enc_payload)[0m
[30;1m519 | [0m[35m                    if self.sendWait is not None:[0m
[30;1m520 | [0m[35m                        time.sleep(self.sendWait)  # give device time to respond[0m
[30;1m521 | [0m[35m                if getresponse:[0m
[30;1m522 | [0m[35m                    do_send = False[0m
[30;1m523 | [0m[35m                    rmsg = self._receive()[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m311 | [0m[35m                if self.auto_ip and not self.address:[0m
[30;1m312 | [0m[35m                    bcast_data = find_device(self.id)[0m
[30;1m313 | [0m[35m                    if bcast_data['ip'] is None:[0m
[30;1m314 | [0m[35m                        log.debug("Unable to find device on network (specify IP address)")[0m
[30;1m315 | [0m[35m                        return ERR_OFFLINE[0m
[30;1m316 | [0m[35m                    self.address = bcast_data['ip'][0m
[30;1m317 | [0m[35m                    new_version = float(bcast_data['version'])[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m311 | [0m[35m                if self.auto_ip and not self.address:[0m
[30;1m312 | [0m[35m                    bcast_data = find_device(self.id)[0m
[30;1m313 | [0m[35m                    if bcast_data['ip'] is None:[0m
[30;1m314 | [0m[35m                        log.debug("Unable to find device on network (specify IP address)")[0m
[30;1m315 | [0m[35m                        return ERR_OFFLINE[0m
[30;1m316 | [0m[35m                    self.address = bcast_data['ip'][0m
[30;1m317 | [0m[35m                    new_version = float(bcast_data['version'])[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m268 | [0m[35m            bcast_data = find_device(dev_id)[0m
[30;1m269 | [0m[35m            if bcast_data['ip'] is None:[0m
[30;1m270 | [0m[35m                log.debug("Unable to find device on network (specify IP address)")[0m
[30;1m271 | [0m[35m                raise Exception("Unable to find device on network (specify IP address)")[0m
[30;1m272 | [0m[35m            self.address = bcast_data['ip'][0m
[30;1m273 | [0m[35m            self.set_version(float(bcast_data['version']))[0m
[30;1m274 | [0m[35m            time.sleep(0.1)[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m268 | [0m[35m            bcast_data = find_device(dev_id)[0m
[30;1m269 | [0m[35m            if bcast_data['ip'] is None:[0m
[30;1m270 | [0m[35m                log.debug("Unable to find device on network (specify IP address)")[0m
[30;1m271 | [0m[35m                raise Exception("Unable to find device on network (specify IP address)")[0m
[30;1m272 | [0m[35m            self.address = bcast_data['ip'][0m
[30;1m273 | [0m[35m            self.set_version(float(bcast_data['version']))[0m
[30;1m274 | [0m[35m            time.sleep(0.1)[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m            self.auto_ip = True[0m
[30;1m268 | [0m[35m            bcast_data = find_device(dev_id)[0m
[30;1m269 | [0m[35m            if bcast_data['ip'] is None:[0m
[30;1m270 | [0m[35m                log.debug("Unable to find device on network (specify IP address)")[0m
[30;1m271 | [0m[35m                raise Exception("Unable to find device on network (specify IP address)")[0m
[30;1m272 | [0m[35m            self.address = bcast_data['ip'][0m
[30;1m273 | [0m[35m            self.set_version(float(bcast_data['version']))[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m            self.auto_ip = True[0m
[30;1m268 | [0m[35m            bcast_data = find_device(dev_id)[0m
[30;1m269 | [0m[35m            if bcast_data['ip'] is None:[0m
[30;1m270 | [0m[35m                log.debug("Unable to find device on network (specify IP address)")[0m
[30;1m271 | [0m[35m                raise Exception("Unable to find device on network (specify IP address)")[0m
[30;1m272 | [0m[35m            self.address = bcast_data['ip'][0m
[30;1m273 | [0m[35m            self.set_version(float(bcast_data['version']))[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m263 | [0m[35m            XenonDevice.set_version(self, self.parent.version)[0m
[30;1m264 | [0m[35m            self.parent._register_child(self)[0m
[30;1m265 | [0m[35m        elif (not address) or address == "Auto" or address == "0.0.0.0":[0m
[30;1m266 | [0m[35m            # try to determine IP address automatically[0m
[30;1m267 | [0m[35m            self.auto_ip = True[0m
[30;1m268 | [0m[35m            bcast_data = find_device(dev_id)[0m
[30;1m269 | [0m[35m            if bcast_data['ip'] is None:[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m251 | [0m[35m        self.cipher = None[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m        if self.parent:[0m
[30;1m254 | [0m[35m            # if we are a child then we should have a cid/node_id but none were given - try and find[0m
[30;1m255 | [0m[35m            if not self.cid:[0m
[30;1m256 | [0m[35m                devinfo = device_info( dev_id )[0m
[30;1m257 | [0m[35m                if devinfo and 'node_id' in devinfo and devinfo['node_id']:[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m        self.connection_timeout = connection_timeout[0m
[30;1m219 | [0m[35m        self.retry = True[0m
[30;1m220 | [0m[35m        self.disabledetect = False  # if True do not detect device22[0m
[30;1m221 | [0m[35m        self.port = port  # default - do not expect caller to pass in[0m
[30;1m222 | [0m[35m        self.socket = None[0m
[30;1m223 | [0m[35m        self.socketPersistent = False if not persist else True # pylint: disable=R1719[0m
[30;1m224 | [0m[35m        self.socketNODELAY = True[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    Parameters:[0m
[30;1m30 | [0m[35m        dev_id = The specific Device ID you are looking for[0m
[30;1m31 | [0m[35m        address = The IP address you are tring to find the Device ID for[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    Response:[0m
[30;1m34 | [0m[35m        {'ip':<ip>, 'version':<version>, 'id':<id>, 'product_id':<product_id>, 'data':<broadcast dat[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    Parameters:[0m
[30;1m30 | [0m[35m        dev_id = The specific Device ID you are looking for[0m
[30;1m31 | [0m[35m        address = The IP address you are tring to find the Device ID for[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    Response:[0m
[30;1m34 | [0m[35m        {'ip':<ip>, 'version':<version>, 'id':<id>, 'product_id':<product_id>, 'data':<broadcast dat[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35mIS_PY2 = sys.version_info[0] == 2[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef find_device(dev_id=None, address=None):[0m
[30;1m27 | [0m[35m    """Scans network for Tuya devices with either ID = dev_id or IP = address[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    Parameters:[0m
[30;1m30 | [0m[35m        dev_id = The specific Device ID you are looking for[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport logging[0m
[30;1m9 | [0m[35mimport socket[0m
[30;1m10 | [0m[35mimport struct[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mimport sys[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom .const import DEVICEFILE, TCPPORT[0m
[30;1m15 | [0m[35mfrom .crypto_helper import AESCipher[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1074 | [0m[35m        #  the command id and "command"/"command_override" keys: i.e. dict2[CMD_ID]["command"][0m
[30;1m1075 | [0m[35m        def _merge_payload_dicts(dict1, dict2):[0m
[30;1m1076 | [0m[35m            for cmd in dict2:[0m
[30;1m1077 | [0m[35m                if cmd not in dict1:[0m
[30;1m1078 | [0m[35m                    # make a deep copy so we don't get a reference[0m
[30;1m1079 | [0m[35m                    dict1[cmd] = _deepcopy( dict2[cmd] )[0m
[30;1m1080 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1073 | [0m[35m        # as dict2 is payload_dict['...'] we only need to worry about copying 2 levels deep,[0m
[30;1m1074 | [0m[35m        #  the command id and "command"/"command_override" keys: i.e. dict2[CMD_ID]["command"][0m
[30;1m1075 | [0m[35m        def _merge_payload_dicts(dict1, dict2):[0m
[30;1m1076 | [0m[35m            for cmd in dict2:[0m
[30;1m1077 | [0m[35m                if cmd not in dict1:[0m
[30;1m1078 | [0m[35m                    # make a deep copy so we don't get a reference[0m
[30;1m1079 | [0m[35m                    dict1[cmd] = _deepcopy( dict2[cmd] )[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m            if self.version >= 3.5:[0m
[30;1m856 | [0m[35m                iv = True[0m
[30;1m857 | [0m[35m                # seqno cmd retcode payload crc crc_good, prefix, iv[0m
[30;1m858 | [0m[35m                msg = TuyaMessage(self.seqno, msg.cmd, None, payload, 0, True, H.PREFIX_6699_VALUE, [0m
[30;1m859 | [0m[35m                self.seqno += 1  # increase message sequence number[0m
[30;1m860 | [0m[35m                data = pack_message(msg,hmac_key=self.local_key)[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m730 | [0m[35m                    return error_json(ERR_JSON, payload)[0m
[30;1m731 | [0m[35m            if not self.disabledetect and "data unvalid" in payload:[0m
[30;1m732 | [0m[35m                self.dev_type = "device22"[0m
[30;1m733 | [0m[35m                # set at least one DPS[0m
[30;1m734 | [0m[35m                self.dps_to_request = {"1": None}[0m
[30;1m735 | [0m[35m                log.debug([0m
[30;1m736 | [0m[35m                    "'data unvalid' error detected: switching to dev_type %r",[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m658 | [0m[35m[0m
[30;1m659 | [0m[35m            if from_child and from_child is not True and from_child != found_child:[0m
[30;1m660 | [0m[35m                # async update from different CID, try again[0m
[30;1m661 | [0m[35m                log.debug( 'Recieved async update for wrong CID %s while looking for CID %s, trying [0m
[30;1m662 | [0m[35m                if self.socketPersistent:[0m
[30;1m663 | [0m[35m                    # if persistent, save response until the next receive() call[0m
[30;1m664 | [0m[35m                    # otherwise, trash it[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m657 | [0m[35m                        break[0m
[30;1m658 | [0m[35m[0m
[30;1m659 | [0m[35m            if from_child and from_child is not True and from_child != found_child:[0m
[30;1m660 | [0m[35m                # async update from different CID, try again[0m
[30;1m661 | [0m[35m                log.debug( 'Recieved async update for wrong CID %s while looking for CID %s, trying [0m
[30;1m662 | [0m[35m                if self.socketPersistent:[0m
[30;1m663 | [0m[35m                    # if persistent, save response until the next receive() call[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m636 | [0m[35m        # Did we detect a device22 device? Return ERR_DEVTYPE error.[0m
[30;1m637 | [0m[35m        if dev_type and dev_type != self.dev_type:[0m
[30;1m638 | [0m[35m            log.debug([0m
[30;1m639 | [0m[35m                "Device22 detected and updated (%s -> %s) - Update payload and try again",[0m
[30;1m640 | [0m[35m                dev_type,[0m
[30;1m641 | [0m[35m                self.dev_type,[0m
[30;1m642 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m623 | [0m[35m        # Unpack Message into TuyaMessage format[0m
[30;1m624 | [0m[35m        # and return payload decrypted[0m
[30;1m625 | [0m[35m        try:[0m
[30;1m626 | [0m[35m            # Data available: seqno cmd retcode payload crc[0m
[30;1m627 | [0m[35m            log.debug("raw unpacked message = %r", msg)[0m
[30;1m628 | [0m[35m            result = self._decode_payload(msg.payload)[0m
[30;1m629 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m570 | [0m[35m                log.debug("Error decoding received data - read retry %s/%s", recv_retries, max_recv_[0m
[30;1m571 | [0m[35m                recv_retries += 1[0m
[30;1m572 | [0m[35m                if recv_retries > max_recv_retries:[0m
[30;1m573 | [0m[35m                    # we recieved at least 1 valid message with a null payload, so the send was succ[0m
[30;1m574 | [0m[35m                    if partial_success:[0m
[30;1m575 | [0m[35m                        self._check_socket_close()[0m
[30;1m576 | [0m[35m                        return None[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m416 | [0m[35m        prefix_offset_6699 = data.find( H.PREFIX_6699_BIN )[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m        while prefix_offset_55AA != 0 and prefix_offset_6699 != 0:[0m
[30;1m419 | [0m[35m            log.debug('Message prefix not at the beginning of the received data!')[0m
[30;1m420 | [0m[35m            log.debug('Offset 55AA: %d, 6699: %d, Received data: %r', prefix_offset_55AA, prefix_off[0m
[30;1m421 | [0m[35m            if prefix_offset_55AA < 0 and prefix_offset_6699 < 0:[0m
[30;1m422 | [0m[35m                data = data[1-prefix_len:][0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m        CT.AP_CONFIG: {  # [BETA] Set Control Values on Device[0m
[30;1m104 | [0m[35m            "command": {"gwId": "", "devId": "", "uid": "", "t": ""},[0m
[30;1m105 | [0m[35m        },[0m
[30;1m106 | [0m[35m        CT.CONTROL: {  # Set Control Values on Device[0m
[30;1m107 | [0m[35m            "command": {"devId": "", "uid": "", "t": ""},[0m
[30;1m108 | [0m[35m        },[0m
[30;1m109 | [0m[35m        CT.STATUS: {  # Get Status from Device[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/XenonDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m100 | [0m[35mpayload_dict = {[0m
[30;1m101 | [0m[35m    # Default Device[0m
[30;1m102 | [0m[35m    "default": {[0m
[30;1m103 | [0m[35m        CT.AP_CONFIG: {  # [BETA] Set Control Values on Device[0m
[30;1m104 | [0m[35m            "command": {"gwId": "", "devId": "", "uid": "", "t": ""},[0m
[30;1m105 | [0m[35m        },[0m
[30;1m106 | [0m[35m        CT.CONTROL: {  # Set Control Values on Device[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mfrom __future__ import print_function  # python 2.7 support[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfor clib in ('pyca/cryptography', 'PyCryptodomex', 'PyCrypto', 'pyaes'):[0m
[30;1m10 | [0m[35m    Crypto = Crypto_modes = AES = CRYPTOLIB = None[0m
[30;1m11 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/crypto_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m# -*- coding: utf-8 -*-[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom __future__ import print_function  # python 2.7 support[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfor clib in ('pyca/cryptography', 'PyCryptodomex', 'PyCrypto', 'pyaes'):[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m972 | [0m[35m* https://github.com/mafrosis/tinytuya2mqtt - A bridge between TinyTuya and Home Assistant via MQTT[0m
[30;1m973 | [0m[35m* https://github.com/Whytey/pymoebot - A Python library intended to monitor and control the MoeBot r[0m
[30;1m974 | [0m[35m* https://github.com/make-all/tuya-local - Local support for Tuya devices in Home Assistant[0m
[30;1m975 | [0m[35m* https://github.com/teejo75/mtghs - Provides an HTTP service for Moonraker to control Tuya outlets.[0m
[30;1m976 | [0m[35m* https://github.com/Xenomes/Domoticz-TinyTUYA-Plugin - Plugin for Domoticz Home Automation[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35m, ziirish - for resolving a dependency problem related to version numbers at install time[0m
[30;1m  | [0m[35m  * https://github.com/rospogrigio/localtuya-homeassistant by rospogrigio. [0m
[30;1m  | [0m[35m    Updated pytuya to support devices with Device IDs of 22 characters[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mython version support, samuscherer for RGB Bulb support, magneticflux for improved Python version su[0m
[30;1m  | [0m[35m  * https://github.com/rospogrigio/localtuya-homeassistant by rospogrigio. [0m
[30;1m  | [0m[35m    Updated pytuya to support devices with Device IDs of 22 characters[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m936 | [0m[35m[0m
[30;1m937 | [0m[35mwdm = WiFiDualMeterDevice.WiFiDualMeterDevice([0m
[30;1m938 | [0m[35m    dev_id='abcdefghijklmnop123456',[0m
[30;1m939 | [0m[35m    address='192.168.0.29',      # Or set to 'Auto' to auto-discover IP address[0m
[30;1m940 | [0m[35m    local_key='1234567890123abc',[0m
[30;1m941 | [0m[35m    version=3.4)[0m
[30;1m942 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m835 | [0m[35m| 102  | Machine error | integer | 0, ? ||[0m
[30;1m836 | [0m[35m| 103  | Machine warning | enum | <ul><li>MOWER_LEAN</li><li>MOWER_EMERGENCY</li><li>MOWER_UI_LOCKED[0m
[30;1m837 | [0m[35m| 104  | Rain mode | boolean | True/False ||[0m
[30;1m838 | [0m[35m| 105  | Work time | interger | 1-99 | hours |[0m
[30;1m839 | [0m[35m| 106  | Machine password | byte str | ? ||[0m
[30;1m840 | [0m[35m| 107  | Clear machine appointment | boolean | True/False ||[0m
[30;1m841 | [0m[35m| 108  | Query machine reservation | boolean | True/False ||[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m753 | [0m[35m d.send(payload)[0m
[30;1m754 | [0m[35m  ```[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35mThe `key1` attribute is a base64 string that contains the IR signal. You can extract it using this p[0m
[30;1m757 | [0m[35m[0m
[30;1m758 | [0m[35m1. Register a new IR device on Tuya Smart / Smart Life app (if not registered already) and map, setu[0m
[30;1m759 | [0m[35m2. Tap multiple times on the button you wish to control.[0m
[30;1m760 | [0m[35m3. Go to [Tuya IoT Platform](https://iot.tuya.com/) and select your app under Cloud > Development se[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m753 | [0m[35m  d.send(payload)[0m
[30;1m754 | [0m[35m  ```[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35mThe `key1` attribute is a base64 string that contains the IR signal. You can extract it using this p[0m
[30;1m757 | [0m[35m[0m
[30;1m758 | [0m[35m1. Register a new IR device on Tuya Smart / Smart Life app (if not registered already) and map, setu[0m
[30;1m759 | [0m[35m2. Tap multiple times on the button you wish to control.[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m597 | [0m[35mhe standard Tuya DPS values and their properties. It represents data compiled from Tuya documentatio[0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35mTo find Tuya DPS for devices not listed below, you can discover the DPS values using the Tuya IoT pl[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35mDPS Read and Set Example:[0m
[30;1m602 | [0m[35m```python[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m565 | [0m[35mure you close the TuyaSmart or SmartLife app before using *TinyTuya* to connect.[0m
[30;1m566 | [0m[35m* Some devices ship with older firmware that may not work with *TinyTuya*. If you're experiencing is[0m
[30;1m567 | [0m[35m* The LOCAL KEY for Tuya devices will change every time a device is removed and re-added to the Tuya[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m545 | [0m[35m[0m
[30;1m546 | [0m[35m  ```[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35mBy default, the scan functions will retry 15 times to find new devices. If you are not seeing all yo[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m  ```bash[0m
[30;1m551 | [0m[35m  # command line[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m533 | [0m[35m  # Listen for Tuya Devices and match to devices.json if available[0m
[30;1m534 | [0m[35m  python -m tinytuya scan[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m  # The above creates a snapshot.json file with IP addresses for devices[0m
[30;1m537 | [0m[35m  # You can use this command to get a rapid poll of status of all devices[0m
[30;1m538 | [0m[35m  python -m tinytuya snapshot[0m
[30;1m539 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m497 | [0m[35m        -device-file FILE    JSON file to load devices from [Default: devices.json][0m
[30;1m498 | [0m[35m        -snapshot-file FILE  JSON file to load/save snapshot from/to [Default: snapshot.json][0m
[30;1m499 | [0m[35m        -force [0.0.0.0/24 ...], -f [0.0.0.0/24 ...][0m
[30;1m500 | [0m[35m                             Force network scan of device IP addresses [Default: Auto-detects net/ma[0m
[30;1m501 | [0m[35m        -no-broadcasts       Ignore broadcast packets when force scanning[0m
[30;1m502 | [0m[35m        -raw-response-file   JSON file to save the raw server response to [Default: tuya-raw.json][0m
[30;1m503 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m487 | [0m[35m                [-dry-run] [max_time][0m
[30;1m488 | [0m[35m[0m
[30;1m489 | [0m[35m        Common Options[0m
[30;1m490 | [0m[35m        max_time             Maximum time to find Tuya devices [Default: 18][0m
[30;1m491 | [0m[35m        -no-broadcasts       Ignore broadcast packets when force scanning[0m
[30;1m492 | [0m[35m        -nocolor             Disable color text output.[0m
[30;1m493 | [0m[35m        -debug               Activate debug mode.[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m487 | [0m[35m                [-dry-run] [max_time][0m
[30;1m488 | [0m[35m[0m
[30;1m489 | [0m[35m        Common Options[0m
[30;1m490 | [0m[35m        max_time             Maximum time to find Tuya devices [Default: 18][0m
[30;1m491 | [0m[35m        -no-broadcasts       Ignore broadcast packets when force scanning[0m
[30;1m492 | [0m[35m        -nocolor             Disable color text output.[0m
[30;1m493 | [0m[35m        -debug               Activate debug mode.[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35mInstallation[0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35m```bash[0m
[30;1m465 | [0m[35m# Option-1: pip install tinytuya[0m
[30;1m466 | [0m[35mpython -m tinytuya[0m
[30;1m467 | [0m[35m[0m
[30;1m468 | [0m[35m# Option-2: pipx install tinytuya[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m332 | [0m[35m# Show status of first controlled switch on device[0m
[30;1m333 | [0m[35mprint('Dictionary %r' % data)[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m# Set to RED Color - set_colour(r, g, b):[0m
[30;1m336 | [0m[35md.set_colour(255,0,0)  [0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m# Cycle through the Rainbow[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m322 | [0m[35m"""[0m
[30;1m323 | [0m[35mRGB Bulb Device[0m
[30;1m324 | [0m[35m"""[0m
[30;1m325 | [0m[35mimport time[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35md = tinytuya.BulbDevice('DEVICE_ID_HERE', 'IP_ADDRESS_HERE', 'LOCAL_KEY_HERE')[0m
[30;1m328 | [0m[35md.set_version(3.3)  # IMPORTANT to set this regardless of version[0m
[30;1m329 | [0m[35md.set_socketPersistent(True)  # Optional: Keep socket open for multiple commands[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m### Example Usage[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35mSee the sample python script [test.py](test.py) for an OutletDevice example or look in the [examples[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m```python[0m
[30;1m298 | [0m[35mimport tinytuya[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m* 900 (ERR_JSON) - Invalid JSON Response from Device[0m
[30;1m278 | [0m[35m* 901 (ERR_CONNECT) - Network Error: Unable to Connect[0m
[30;1m279 | [0m[35m* 902 (ERR_TIMEOUT) - Timeout Waiting for Device[0m
[30;1m280 | [0m[35m* 903 (ERR_RANGE) - Specified Value Out of Range[0m
[30;1m281 | [0m[35m* 904 (ERR_PAYLOAD) - Unexpected Payload from Device[0m
[30;1m282 | [0m[35m* 905 (ERR_OFFLINE) - Network Error: Device Unreachable[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m# Send updatedps command to device[0m
[30;1m217 | [0m[35m    turn_on(switch=1, nowait)                     # Turn on device / switch #[0m
[30;1m218 | [0m[35m    turn_off(switch=1, nowait)                    # Turn off[0m
[30;1m219 | [0m[35m    set_timer(num_secs, nowait)                   # Set timer for num_secs[0m
[30;1m220 | [0m[35m    set_sendWait(num_secs)                        # Time to wait after sending commands before pulli[0m
[30;1m221 | [0m[35m    detect_available_dps()                        # Return list of DPS available from device[0m
[30;1m222 | [0m[35m    generate_payload(command, data,...            # Generate TuyaMessage payload for command with da[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m    set_socketNODELAY(False/True)                 # False or True [default][0m
[30;1m206 | [0m[35m    set_socketRetryLimit(integer)                 # retry count limit [default 5][0m
[30;1m207 | [0m[35m    set_socketRetryDelay(integer)                 # retry delay [default 5][0m
[30;1m208 | [0m[35m    set_socketTimeout(timeout)                    # set connection timeout in seconds [default 5][0m
[30;1m209 | [0m[35m    set_dpsUsed(dps_to_request)                   # add data points (DPS) to request[0m
[30;1m210 | [0m[35m    add_dps_to_request(index)                     # add data point (DPS) index set to None[0m
[30;1m211 | [0m[35m    set_retry(retry=True)                         # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m                    no_retcode)                   # Unpacks a TuyaMessage() [0m
[30;1m194 | [0m[35m    parse_header(data)                            # Unpacks just the header part of a message into a[0m
[30;1m195 | [0m[35m    find_device(dev_id, address)                  # Scans network for Tuya devices with either ID = [0m
[30;1m196 | [0m[35m    device_info(dev_id)                           # Searches DEVICEFILE (usually devices.json) for d[0m
[30;1m197 | [0m[35m    assign_dp_mappings(tuyadevices, mappings)     # Adds mappings to all the devices in the tuyadevi[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m          connection_retry_limit = 5 (int)[0m
[30;1m178 | [0m[35m          connection_retry_delay = 5 (int)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m          Total timeout = (connection_timeout * connection_retry_limit) + [0m
[30;1m181 | [0m[35m                          (connection_retry_delay * (connection_retry_limit - 1))[0m
[30;1m182 | [0m[35m                          Defaults: (5 * 5) + (5 * (5 - 1)) = 45 seconds[0m
[30;1m183 | [0m[35m                        [0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m          node_id = None (str): Alias for cid[0m
[30;1m174 | [0m[35m          parent = None (object): Gateway device object this is a child of[0m
[30;1m175 | [0m[35m          port = TCPPORT (int): The port to connect to device[0m
[30;1m176 | [0m[35m          connection_timeout = 5 (int): Timeout in seconds[0m
[30;1m177 | [0m[35m          connection_retry_limit = 5 (int)[0m
[30;1m178 | [0m[35m          connection_retry_delay = 5 (int)[0m
[30;1m179 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m      BulbDevice(args...)[0m
[30;1m165 | [0m[35m        Where args:[0m
[30;1m166 | [0m[35m          dev_id (str): Device ID e.g. 01234567891234567890[0m
[30;1m167 | [0m[35m          address (str): Device Network IP Address e.g. 10.0.1.99 or "Auto" to auto-find[0m
[30;1m168 | [0m[35m          local_key (str): The encryption key[0m
[30;1m169 | [0m[35m          dev_type (str): Device type for payload options (see below)[0m
[30;1m170 | [0m[35m          version = 3.1 (float): Tuya Protocol (e.g. 3.1, 3.2, 3.3, 3.4, 3.5)[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m# Connect to Device[0m
[30;1m138 | [0m[35md = tinytuya.OutletDevice([0m
[30;1m139 | [0m[35m    dev_id='DEVICE_ID_HERE',[0m
[30;1m140 | [0m[35m    address='IP_ADDRESS_HERE',      # Or set to 'Auto' to auto-discover IP address[0m
[30;1m141 | [0m[35m    local_key='LOCAL_KEY_HERE', [0m
[30;1m142 | [0m[35m    version=3.3)[0m
[30;1m143 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35mistered devices:[0m
[30;1m114 | [0m[35m      ```bash[0m
[30;1m115 | [0m[35m      python -m tinytuya wizard   # use -nocolor for non-ANSI-color terminals[0m
[30;1m116 | [0m[35m      ```[0m
[30;1m117 | [0m[35m    * The **Wizard** will prompt you for the *API ID* key, API *Secret*, API *Region* (cn, us, us-e,[0m
[30;1m118 | [0m[35m        * To find those again, go to [iot.tuya.com](https://iot.tuya.com/), choose your project and [0m
[30;1m119 | [0m[35m            * API Key: Access ID/Client ID[0m
[30;1m120 | [0m[35m            * API Secret: Access Secret/Client Secret[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mce API" tab[0m
[30;1m  | [0m[35m        - Click "**Go to Authorize**" button[0m
[30;1m  | [0m[35m        - Select the API Groups from the dropdown and click `Subscribe` ([screenshot](https://user-i[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m1-4c9f-b4d5-251873f18c77.png)).  [0m
[30;1m100 | [0m[35m    * Click on "Cloud" icon -> "Create Cloud Project"[0m
[30;1m101 | [0m[35m      1. Pick the correct Data Center "Region" for your location (check [HERE](https://developer.tuy[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m### Network Scanner[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35mTinyTuya has a built in network scanner that can be used to find Tuya Devices on your local network.[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m```bash[0m
[30;1m82 | [0m[35mpython -m tinytuya scan[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m# Optional: Install Command Line Tool[0m
[30;1m64 | [0m[35mpipx install tinytuya[0m
[30;1m65 | [0m[35m```[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mPip will attempt to install `cryptography`, `requests` and `colorama` if not already installed.[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m## Tuya Device Preparation[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m```bash[0m
[30;1m60 | [0m[35m# Install TinyTuya Library[0m
[30;1m61 | [0m[35mpython -m pip install tinytuya[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m# Optional: Install Command Line Tool[0m
[30;1m64 | [0m[35mpipx install tinytuya[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m972 | [0m[35m* https://github.com/mafrosis/tinytuya2mqtt - A bridge between TinyTuya and Home Assistant via MQTT[0m
[30;1m973 | [0m[35m* https://github.com/Whytey/pymoebot - A Python library intended to monitor and control the MoeBot r[0m
[30;1m974 | [0m[35m* https://github.com/make-all/tuya-local - Local support for Tuya devices in Home Assistant[0m
[30;1m975 | [0m[35m* https://github.com/teejo75/mtghs - Provides an HTTP service for Moonraker to control Tuya outlets.[0m
[30;1m976 | [0m[35m* https://github.com/Xenomes/Domoticz-TinyTUYA-Plugin - Plugin for Domoticz Home Automation[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m970 | [0m[35mPlease feel free to submit a PR or open an issue to add your project.[0m
[30;1m971 | [0m[35m[0m
[30;1m972 | [0m[35m* https://github.com/mafrosis/tinytuya2mqtt - A bridge between TinyTuya and Home Assistant via MQTT[0m
[30;1m973 | [0m[35m* https://github.com/Whytey/pymoebot - A Python library intended to monitor and control the MoeBot r[0m
[30;1m974 | [0m[35m* https://github.com/make-all/tuya-local - Local support for Tuya devices in Home Assistant[0m
[30;1m975 | [0m[35m* https://github.com/teejo75/mtghs - Provides an HTTP service for Moonraker to control Tuya outlets.[0m
[30;1m976 | [0m[35m* https://github.com/Xenomes/Domoticz-TinyTUYA-Plugin - Plugin for Domoticz Home Automation[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m962 | [0m[35m  * https://github.com/sean6541/tuyaapi Python API to the web api[0m
[30;1m963 | [0m[35m  * https://github.com/codetheweb/tuyapi node.js[0m
[30;1m964 | [0m[35m  * https://github.com/Marcus-L/m4rcus.TuyaCore - .NET[0m
[30;1m965 | [0m[35m  * https://github.com/SDNick484/rectec_status/ - RecTec pellet smokers control (with Alexa skill)[0m
[30;1m966 | [0m[35m  * https://github.com/TradeFace/tuyaface - Python Async Tuya API[0m
[30;1m967 | [0m[35m[0m
[30;1m968 | [0m[35m## TinyTuya Powered Projects[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35m improved Python version support, samuscherer for RGB Bulb support, magneticflux for improved Python[0m
[30;1m  | [0m[35m  * https://github.com/rospogrigio/localtuya-homeassistant by rospogrigio. [0m
[30;1m  | [0m[35m    Updated pytuya to support devices with Device IDs of 22 characters[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m844 | [0m[35m| 111  | Error log | byte str |||[0m
[30;1m845 | [0m[35m| 112  | Work log | byte str |||[0m
[30;1m846 | [0m[35m| 113  | Partition parameters | byte str |||[0m
[30;1m847 | [0m[35m| 114  | Work mode | enum | AutoMode/?? ||                                                          [0m
[30;1m848 | [0m[35m[0m
[30;1m849 | [0m[35mReference [pymoebot](https://github.com/Whytey/pymoebot) for further definition.[0m
[30;1m850 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m765 | [0m[35m## Version 3.3 - Sensor Type[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m_Important Note:_[0m
[30;1m768 | [0m[35mBattery-powered Tuya sensors are usually designed to stay in sleep mode until a state change (eg.ope[0m
[30;1m769 | [0m[35m[0m
[30;1m770 | [0m[35m| DP ID        | Function Point | Type        | Range       | Units |[0m
[30;1m771 | [0m[35m| ------------- | ------------- | ------------- | ------------- |------------- |[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m705 | [0m[35m|2|Percent control 1|integer|0-100|%|[0m
[30;1m706 | [0m[35m|3|Accurate Calibration 1|enum|start, end||[0m
[30;1m707 | [0m[35m|4|Curtain Switch 2|enum|open, stop, close, continue||[0m
[30;1m708 | [0m[35m|5|Percent control 2|integer|0-100||[0m
[30;1m709 | [0m[35m|6|Accurate Calibration 2|enum|start, end||[0m
[30;1m710 | [0m[35m|8|Motor Steer 1|enum|forward, back||[0m
[30;1m711 | [0m[35m|9|Motor steer 2|enum|forward, back||[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m702 | [0m[35m| DP ID        | Function Point | Type        | Range       | Units |[0m
[30;1m703 | [0m[35m| ------------- | ------------- | ------------- | ------------- |------------- |[0m
[30;1m704 | [0m[35m|1|Curtain Switch 1|enum|open, stop, close, continue||[0m
[30;1m705 | [0m[35m|2|Percent control 1|integer|0-100|%|[0m
[30;1m706 | [0m[35m|3|Accurate Calibration 1|enum|start, end||[0m
[30;1m707 | [0m[35m|4|Curtain Switch 2|enum|open, stop, close, continue||[0m
[30;1m708 | [0m[35m|5|Percent control 2|integer|0-100||[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m694 | [0m[35m| 32|Wake Up|n/a|n/a||[0m
[30;1m695 | [0m[35m| 33|Power Off Memory|n/a|n/a||[0m
[30;1m696 | [0m[35m| 34|Do not Disturb|n/a|n/a||[0m
[30;1m697 | [0m[35m| 41|Remote Control Switch|n/a|n/a||[0m
[30;1m698 | [0m[35m| 209|Cycle Timing|n/a|n/a||[0m
[30;1m699 | [0m[35m| 210|Vaction Timing|n/a|n/a||[0m
[30;1m700 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m576 | [0m[35m  ```[0m
[30;1m577 | [0m[35m* Windows 10 Users - TinyTuya `wizard` and `scan` interactive tools use ANSI color. This will work c[0m
[30;1m578 | [0m[35m  ```[0m
[30;1m579 | [0m[35m  reg add HKEY_CURRENT_USER\Console /v VirtualTerminalLevel /t REG_DWORD /d 0x00000001 /f[0m
[30;1m580 | [0m[35m  ```[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m## User Contributed Device Modules[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m567 | [0m[35memoved and re-added to the TuyaSmart app. If you're getting decrypt errors, try getting the key agai[0m
[30;1m568 | [0m[35m* Devices running protocol version 3.1 (e.g. below Firmware 1.0.5) do not require a device *Local_Ke[0m
[30;1m569 | [0m[35m* Some devices with 22 character IDs will require additional setting to poll correctly. TinyTuya wil[0m
[30;1m570 | [0m[35m  ```python[0m
[30;1m571 | [0m[35m  a = tinytuya.OutletDevice('here_is_my_key', '192.168.x.x', 'secret_key_here', 'device22')[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m548 | [0m[35ments (eg. 50 retries):[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m  ```bash[0m
[30;1m551 | [0m[35m  # command line[0m
[30;1m552 | [0m[35m  python -m tinytuya scan 50[0m
[30;1m553 | [0m[35m  ```[0m
[30;1m554 | [0m[35m[0m
[30;1m555 | [0m[35m  ```python[0m
[30;1m556 | [0m[35m  # invoke verbose interactive scan[0m
[30;1m557 | [0m[35m  tinytuya.scan(50)[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35m  # return payload of devices[0m
[30;1m560 | [0m[35m  devices = tinytuya.deviceScan(false, 50)[0m
[30;1m561 | [0m[35m  ```[0m
[30;1m562 | [0m[35m[0m
[30;1m563 | [0m[35m## Troubleshooting[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m* Tuya devices only allow one TCP connection at a time.  Make sure you close the TuyaSmart or SmartL[0m
[30;1m566 | [0m[35m* Some devices ship with older firmware that may not work with *TinyTuya*. If you're experiencing is[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m386 | [0m[35m    # d.status(nowait=True)[0m
[30;1m387 | [0m[35m[0m
[30;1m388 | [0m[35m    # NOTE Some smart plugs require an UPDATEDPS command to update power data[0m
[30;1m389 | [0m[35m    # print(" > Send DPS Update Request < ")[0m
[30;1m390 | [0m[35m    # payload = d.generate_payload(tinytuya.UPDATEDPS)[0m
[30;1m391 | [0m[35m    # d.send(payload)    [0m
[30;1m392 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m385 | [0m[35m    # print(" > Send Request for Status < ")[0m
[30;1m386 | [0m[35m    # d.status(nowait=True)[0m
[30;1m387 | [0m[35m[0m
[30;1m388 | [0m[35m    # NOTE Some smart plugs require an UPDATEDPS command to update power data[0m
[30;1m389 | [0m[35m    # print(" > Send DPS Update Request < ")[0m
[30;1m390 | [0m[35m    # payload = d.generate_payload(tinytuya.UPDATEDPS)[0m
[30;1m391 | [0m[35m    # d.send(payload)    [0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35mUYA ACCOUNT - Set up a Tuya Account (see [PDF Instructions](https://github.com/jasonacox/tinytuya/fi[0m
[30;1m98 | [0m[35m    * *NOTE: Tuya often changes their portal and services. Please open an [issue](https://github.com[0m
[30;1m99 | [0m[35m    * Create a Tuya Developer account on [iot.tuya.com](https://iot.tuya.com/). When it asks for the[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mroid](https://play.google.com/store/apps/details?id=com.tuya.smartlife&hl=en). Set up your SmartLife[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m2. SCAN (Optional) - Run the TinyTuya scan to get a list of Tuya devices on your network. It will sh[0m
[30;1m  | [0m[35m    ```bash[0m
[30;1m  | [0m[35m    python -m tinytuya scan[0m
[30;1m  | [0m[35m    ```[0m
[30;1m  | [0m[35m    NOTE: You will need to use one of the displayed *Device IDs* for step 4.[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya-1.16.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m38 | [0m[35mCloud API).  This is a compatible replacement for the `pytuya` PyPI module and currently supports Tu[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[Tuya](https://en.tuya.com/) devices are designed to communicate with the TuyaCloud but most also ex[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mTinyTuya can also connect to the Tuya Cloud to poll status and issue commands to Tuya devices.[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/WiFiDualMeterDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m43 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m44 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m45 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m46 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m47 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m48 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/WiFiDualMeterDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m31 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m32 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m33 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m34 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m35 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m36 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/WiFiDualMeterDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m Author: Guillaume Gardet[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m Local Control Classes[0m
[30;1m9 | [0m[35m    WiFiDualMeterDevice(...)[0m
[30;1m10 | [0m[35m        See OutletDevice() for constructor arguments[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/InverterHeatPumpDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m Author: Valentin Dusollier (https://github.com/valentindusollier)[0m
[30;1m5 | [0m[35m Tested: Fairland Inverter+ 21kW (IPHR55)[0m
[30;1m6 | [0m[35m [0m
[30;1m7 | [0m[35m Local Control Classes[0m
[30;1m8 | [0m[35m    InverterHeatPumpDevice(...)[0m
[30;1m9 | [0m[35m        See Device() for constructor arguments[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/InverterHeatPumpDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m       # Turn on device / switch #[0m
[30;1m49 | [0m[35m            turn_off(switch=1, nowait)          # Turn off[0m
[30;1m50 | [0m[35m            set_timer(num_secs, nowait)         # Set timer for num_secs[0m
[30;1m51 | [0m[35m            set_debug(toggle, color)            # Activate verbose debugging output[0m
[30;1m52 | [0m[35m            set_sendWait(num_secs)              # Time to wait after sending commands before pulling[0m
[30;1m53 | [0m[35m            detect_available_dps()              # Return list of DPS available from device[0m
[30;1m54 | [0m[35m            generate_payload(command, data)     # Generate TuyaMessage payload for command with data[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/InverterHeatPumpDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m            set_socketPersistent(False/True)    # False [default] or True[0m
[30;1m38 | [0m[35m            set_socketNODELAY(False/True)       # False or True [default][0m
[30;1m39 | [0m[35m            set_socketRetryLimit(integer)       # retry count limit [default 5][0m
[30;1m40 | [0m[35m            set_socketTimeout(timeout)          # set connection timeout in seconds [default 5][0m
[30;1m41 | [0m[35m            set_dpsUsed(dps_to_request)         # add data points (DPS) to request[0m
[30;1m42 | [0m[35m            add_dps_to_request(index)           # add data point (DPS) index set to None[0m
[30;1m43 | [0m[35m            set_retry(retry=True)               # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35m    def rf_study_end( self, freq=0, short=False ):[0m
[30;1m98 | [0m[35m        # {"dps":{"201":"{\"rf_type\":\"sub_2g\",\"control\":\"rfstudy_exit\",\"study_feq\":\"433\",[0m
[30;1m99 | [0m[35m        data = { 'freq': str(freq) }[0m
[30;1m100 | [0m[35m        cmd = 'rfshortstudy_exit' if short else 'rfstudy_exit'[0m
[30;1m101 | [0m[35m        self.send_command( cmd, data )[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    def rf_receive_button( self, freq=0, timeout=30 ):[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m    def rf_study_start( self, freq=0, short=False ):[0m
[30;1m92 | [0m[35m        # {"dps":{"201":"{\"rf_type\":\"sub_2g\",\"control\":\"rf_study\",\"study_feq\":\"433\",\"ve[0m
[30;1m93 | [0m[35m        data = { 'freq': str(freq) }[0m
[30;1m94 | [0m[35m        cmd = 'rf_shortstudy' if short else 'rf_study'[0m
[30;1m95 | [0m[35m        self.send_command( cmd, data )[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    def rf_study_end( self, freq=0, short=False ):[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35mimport struct[0m
[30;1m63 | [0m[35mimport time[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mfrom ..core import log, CONTROL[0m
[30;1m66 | [0m[35mfrom .IRRemoteControlDevice import IRRemoteControlDevice[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m# extends IRRemoteControlDevice[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31 | [0m[35m               when sort=True, 'rf_shortstudy' is used instead of 'rf_study'[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        rf.rf_receive_button( freq=0, timeout )[0m
[30;1m34 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m35 | [0m[35m               freq - 0 to auto-detect[0m
[30;1m36 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    Functions:[0m
[30;1m17 | [0m[35m        rf = RFRemoteControlDevice(..., control_type=None)[0m
[30;1m18 | [0m[35m            -> will immediately connect to the device to try and detect the control type if control_[0m
[30;1m19 | [0m[35m               control_type=1 for older devices using DPS 201/202[0m
[30;1m20 | [0m[35m               control_type=2 for newer devices using DPS 1-13[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m Module Author: uzlonewolf (https://github.com/uzlonewolf)[0m
[30;1m9 | [0m[35m Based on IRRemoteControlDevice by Alexey 'Cluster' Avdyukhin (https://github.com/clusterm)[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m Local Control Classes[0m
[30;1m12 | [0m[35m    RFRemoteControlDevice(..., version=3.3)[0m
[30;1m13 | [0m[35m        This class uses a default version of 3.3[0m
[30;1m14 | [0m[35m        See OutletDevice() for the other constructor arguments[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m                    response_code = response # Pass it if we do not get a response we like[0m
[30;1m150 | [0m[35m                    # try again[0m
[30;1m151 | [0m[35m        finally:[0m
[30;1m152 | [0m[35m            # Revert timeout[0m
[30;1m153 | [0m[35m            self.set_socketTimeout(old_timeout)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        if found:[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m                    response_code = response # Some error message? Pass it.[0m
[30;1m134 | [0m[35m                    break[0m
[30;1m135 | [0m[35m                elif self.DP_LEARNED_ID in response["dps"]:[0m
[30;1m136 | [0m[35m                    # Button code received, extracting it as Base64 string[0m
[30;1m137 | [0m[35m                    log.info( 'Response (type 1): %r', response )[0m
[30;1m138 | [0m[35m                    response_code = response["dps"][self.DP_LEARNED_ID][0m
[30;1m139 | [0m[35m                    found = True[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m        found = False[0m
[30;1m114 | [0m[35m        # Remember old timeout and set new timeout[0m
[30;1m115 | [0m[35m        old_timeout = self.connection_timeout[0m
[30;1m116 | [0m[35m        end_at_time = time.time() + timeout[0m
[30;1m117 | [0m[35m        old_persist = self.socketPersistent[0m
[30;1m118 | [0m[35m        self.set_socketPersistent( True )[0m
[30;1m119 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m        response = None[0m
[30;1m112 | [0m[35m        response_code = None[0m
[30;1m113 | [0m[35m        found = False[0m
[30;1m114 | [0m[35m        # Remember old timeout and set new timeout[0m
[30;1m115 | [0m[35m        old_timeout = self.connection_timeout[0m
[30;1m116 | [0m[35m        end_at_time = time.time() + timeout[0m
[30;1m117 | [0m[35m        old_persist = self.socketPersistent[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m        response = None[0m
[30;1m112 | [0m[35m        response_code = None[0m
[30;1m113 | [0m[35m        found = False[0m
[30;1m114 | [0m[35m        # Remember old timeout and set new timeout[0m
[30;1m115 | [0m[35m        old_timeout = self.connection_timeout[0m
[30;1m116 | [0m[35m        end_at_time = time.time() + timeout[0m
[30;1m117 | [0m[35m        old_persist = self.socketPersistent[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35mimport json[0m
[30;1m61 | [0m[35mimport logging[0m
[30;1m62 | [0m[35mimport struct[0m
[30;1m63 | [0m[35mimport time[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mfrom ..core import log, CONTROL[0m
[30;1m66 | [0m[35mfrom .IRRemoteControlDevice import IRRemoteControlDevice[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m"""[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mimport base64[0m
[30;1m60 | [0m[35mimport json[0m
[30;1m61 | [0m[35mimport logging[0m
[30;1m62 | [0m[35mimport struct[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m
[30;1m55 | [0m[35m                the base64 string is base64 decoded and then JSON parsed[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m"""[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m
[30;1m55 | [0m[35m                the base64 string is base64 decoded and then JSON parsed[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m"""[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        RFRemoteControlDevice.rf_print_button( base64_code )[0m
[30;1m50 | [0m[35m            -> prints and returns the JSON dict as a string from a base64-encoded learned button[0m
[30;1m51 | [0m[35m                the base64 string is base64 decoded but not JSON parsed[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        RFRemoteControlDevice.rf_print_button( base64_code )[0m
[30;1m50 | [0m[35m            -> prints and returns the JSON dict as a string from a base64-encoded learned button[0m
[30;1m51 | [0m[35m                the base64 string is base64 decoded but not JSON parsed[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        RFRemoteControlDevice.rf_decode_button( base64_code )[0m
[30;1m54 | [0m[35m            -> returns the JSON dict as a dict from a base64-encoded learned button[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m        rf.rf_receive_button( freq=0, timeout )[0m
[30;1m34 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m35 | [0m[35m               freq - 0 to auto-detect[0m
[30;1m36 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        rf.rf_send_button( base64_code, times=6, delay=0, intervals=0 )[0m
[30;1m39 | [0m[35m            -> send a learned (raw base64-encoded) button press[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m        rf.rf_receive_button( freq=0, timeout )[0m
[30;1m34 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m35 | [0m[35m               freq - 0 to auto-detect[0m
[30;1m36 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        rf.rf_send_button( base64_code, times=6, delay=0, intervals=0 )[0m
[30;1m39 | [0m[35m            -> send a learned (raw base64-encoded) button press[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m               when sort=True, 'rf_shortstudy' is used instead of 'rf_study'[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        rf.rf_receive_button( freq=0, timeout )[0m
[30;1m34 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m35 | [0m[35m               freq - 0 to auto-detect[0m
[30;1m36 | [0m[35m               timeout - maximum time to wait for button press[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/RFRemoteControlDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m               freq=0 auto-detects the frequency, or it can be specified as i.e. freq="433.92" or fr[0m
[30;1m31 | [0m[35m               when sort=True, 'rf_shortstudy' is used instead of 'rf_study'[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        rf.rf_receive_button( freq=0, timeout )[0m
[30;1m34 | [0m[35m            -> call this method and press button on real remote control to read its code in Base64 f[0m
[30;1m35 | [0m[35m               freq - 0 to auto-detect[0m
[30;1m36 | [0m[35m               timeout - maximum time to wait for button press[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/BlanketDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m Author: Leo Denham (https://github.com/leodenham)[0m
[30;1m7 | [0m[35m Tested: Goldair Platinum Electric Blanket GPFAEB-Q[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m Local Control Classes[0m
[30;1m10 | [0m[35m    BlanketDevice(...)[0m
[30;1m11 | [0m[35m        See OutletDevice() for constructor arguments[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/BlanketDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m    def set_body_time(self, num):[0m
[30;1m124 | [0m[35m        if (num < 1 or num > 12):[0m
[30;1m125 | [0m[35m            return error_json([0m
[30;1m126 | [0m[35m                ERR_RANGE, "set_body_time: The value for the time needs to be between 1 and 12."[0m
[30;1m127 | [0m[35m            )[0m
[30;1m128 | [0m[35m        return self.set_value(self.DPS_BODY_TIME, f"{num}h")[0m
[30;1m129 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/BlanketDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m    def set_feet_time(self, num):[0m
[30;1m117 | [0m[35m        if (num < 1 or num > 12):[0m
[30;1m118 | [0m[35m            return error_json([0m
[30;1m119 | [0m[35m                ERR_RANGE, "set_feet_time: The value for the time needs to be between 1 and 12."[0m
[30;1m120 | [0m[35m            )[0m
[30;1m121 | [0m[35m        return self.set_value(self.DPS_FEET_TIME, f"{num}h")[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/BlanketDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m43 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m44 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m45 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m46 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m47 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m48 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/BlanketDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m31 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m32 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m33 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m34 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m35 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m36 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/BulbDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m    This class supports two types of bulbs with different DPS mappings and functions:[0m
[30;1m65 | [0m[35m        Type A - Uses DPS index 1-5[0m
[30;1m66 | [0m[35m        Type B - Uses DPS index 20-27 (no index 1)[0m
[30;1m67 | [0m[35m        Type C - Same as Type A except that it is using DPS 2 for brightness, which ranges from 0-10[0m
[30;1m68 | [0m[35m    """[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    # Two types of Bulbs - TypeA uses DPS 1-5, TypeB uses DPS 20-24[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/BulbDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m Author: Jason A. Cox[0m
[30;1m7 | [0m[35m For more information see https://github.com/jasonacox/tinytuya[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m Local Control Classes[0m
[30;1m10 | [0m[35m    BulbDevice(...)[0m
[30;1m11 | [0m[35m        See OutletDevice() for constructor arguments[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/BulbDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m323 | [0m[35m        if not 0 <= r <= 255:[0m
[30;1m324 | [0m[35m            return error_json([0m
[30;1m325 | [0m[35m                ERR_RANGE,[0m
[30;1m326 | [0m[35m                "set_colour: The value for red needs to be between 0 and 255.",[0m
[30;1m327 | [0m[35m            )[0m
[30;1m328 | [0m[35m        if not 0 <= g <= 255:[0m
[30;1m329 | [0m[35m            return error_json([0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/BulbDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m312 | [0m[35m        Set colour of an rgb bulb.[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m        Args:[0m
[30;1m315 | [0m[35m            r(int): Value for the colour Red as int from 0-255.[0m
[30;1m316 | [0m[35m            g(int): Value for the colour Green as int from 0-255.[0m
[30;1m317 | [0m[35m            b(int): Value for the colour Blue as int from 0-255.[0m
[30;1m318 | [0m[35m            nowait(bool): True to send without waiting for response.[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/BulbDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m            Type B: 360 (h) and 1000 (s and v)[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        Args:[0m
[30;1m130 | [0m[35m            r(int): Value for the colour red as int from 0-255.[0m
[30;1m131 | [0m[35m            g(int): Value for the colour green as int from 0-255.[0m
[30;1m132 | [0m[35m            b(int): Value for the colour blue as int from 0-255.[0m
[30;1m133 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/BulbDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m47 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m48 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m49 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m50 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m51 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m52 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/BulbDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m35 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m36 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m37 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m38 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m39 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m40 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m812 | [0m[35m                    for i in range( len(newdata) ):[0m
[30;1m813 | [0m[35m                        self.day_data[dow][period][i] = newdata[i][0m
[30;1m814 | [0m[35m[0m
[30;1m815 | [0m[35m                    # display the time as 24-hour HH:MM[0m
[30;1m816 | [0m[35m                    if self.day_data[dow][period].time < 1440:[0m
[30;1m817 | [0m[35m                        hrs = int(self.day_data[dow][period].time / 60)[0m
[30;1m818 | [0m[35m                        mins = self.day_data[dow][period].time % 60[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m"""[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35mimport struct[0m
[30;1m216 | [0m[35mimport base64[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35mfrom ..core import Device, log, HEART_BEAT, DP_QUERY, CONTROL[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m            tstatdev.schedule['MoNdAySsUcK']['WakeMeUp'].coolto = 25.0[0m
[30;1m201 | [0m[35m        all mean the same thing.  Parameters can also be set using the .setPeriod method:[0m
[30;1m202 | [0m[35m            tstatdev.schedule.setPeriod( day_of_week, period, coolto=25.0, heatto=10.0, time=0, part[0m
[30;1m203 | [0m[35m        To disable a schedule period (set the time to 0xFFFF) you can:[0m
[30;1m204 | [0m[35m            tstatdev.schedule.setPeriod( day, 4, delete=True)[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m        Once a day is set you can copy it to a different day with:[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m903 | [0m[35m        ## populate the sensor data[0m
[30;1m904 | [0m[35m        sensor_list_object.update( 'base64 string here' )[0m
[30;1m905 | [0m[35m[0m
[30;1m906 | [0m[35m        ## send an update after changing a sensor value[0m
[30;1m907 | [0m[35m        send_dps = { '122': sensor_list_object.b64() }[0m
[30;1m908 | [0m[35m        payload = d.generate_payload(tinytuya.CONTROL, data)[0m
[30;1m909 | [0m[35m        d.send(payload)[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m887 | [0m[35m        parent_device: the ThermostatDevice which this sensor list is attached to[0m
[30;1m888 | [0m[35m[0m
[30;1m889 | [0m[35m[0m
[30;1m890 | [0m[35m    The .update(sensordata_list) method parses an update[0m
[30;1m891 | [0m[35m      Args:[0m
[30;1m892 | [0m[35m        sensordata_list: either a base64-encoded string such as what DPS 122 contains, or an already[0m
[30;1m893 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m215 | [0m[35mimport struct[0m
[30;1m216 | [0m[35mimport base64[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35mfrom ..core import Device, log, HEART_BEAT, DP_QUERY, CONTROL[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35mclass ThermostatDevice(Device):[0m
[30;1m221 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m        delayUpdates()[0m
[30;1m92 | [0m[35m            -> when changing multiple settings, calling this first will cause them to be queued and [0m
[30;1m93 | [0m[35m        sendUpdates()[0m
[30;1m94 | [0m[35m            -> sends all queued updates at once and disables queueing (delayUpdates() will need to b[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        setSetpoint( setpoint, cf=None )[0m
[30;1m97 | [0m[35m            -> tried to auto-detect which setpoint you want to set (cooling or heating)) using the s[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    Thermostat related functions:[0m
[30;1m91 | [0m[35m        delayUpdates()[0m
[30;1m92 | [0m[35m            -> when changing multiple settings, calling this first will cause them to be queued and [0m
[30;1m93 | [0m[35m        sendUpdates()[0m
[30;1m94 | [0m[35m            -> sends all queued updates at once and disables queueing (delayUpdates() will need to b[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m          sensor.setUnknown3( val )[0m
[30;1m82 | [0m[35m              -> sets the third unknown field to val.  'val' should be a 8 byte long byte array[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        If multiple sensor options are going to be changed at the same time, it is much quicker to q[0m
[30;1m85 | [0m[35m            sensor.delayUpdates()[0m
[30;1m86 | [0m[35m            ... call sensor.setName() or whatever here ...[0m
[30;1m87 | [0m[35m            sensor.sendUpdates()[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m          sensor.setUnknown3( val )[0m
[30;1m82 | [0m[35m              -> sets the third unknown field to val.  'val' should be a 8 byte long byte array[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        If multiple sensor options are going to be changed at the same time, it is much quicker to q[0m
[30;1m85 | [0m[35m            sensor.delayUpdates()[0m
[30;1m86 | [0m[35m            ... call sensor.setName() or whatever here ...[0m
[30;1m87 | [0m[35m            sensor.sendUpdates()[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m67 | [0m[35m          sensor.setName( new_name )[0m
[30;1m68 | [0m[35m          sensor.setEnabled( enabled )[0m
[30;1m69 | [0m[35m          sensor.setOccupied( occupied )[0m
[30;1m70 | [0m[35m              -> not really useful for remote sensors as they get overwritten on the next update[0m
[30;1m71 | [0m[35m          sensor.setParticipation( flag, val=True )[0m
[30;1m72 | [0m[35m              -> flag can be either a string in ['wake', 'away', 'home', 'sleep'] or an integer bitm[0m
[30;1m73 | [0m[35m                 when it's a string, val sets (True) or clears (False) that particular flag[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m61 | [0m[35m          firmware_version -> firmware version * 10 (01 = v0.1)[0m
[30;1m62 | [0m[35m          averaging -> sensor currently participation in the temperature averaging (occupied is True[0m
[30;1m63 | [0m[35m          unknown3 -> value of unknown field, 8 byte long byte array[0m
[30;1m64 | [0m[35m          changed -> list of attributes which have changed since last update[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        sensors also have the following methods:[0m
[30;1m67 | [0m[35m          sensor.setName( new_name )[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ThermostatDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m Module Author: uzlonewolf (https://github.com/uzlonewolf)[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m Local Control Classes[0m
[30;1m11 | [0m[35m    ThermostatDevice(..., version=3.3, persist=True)[0m
[30;1m12 | [0m[35m        This class uses a default version of 3.3 and enables persistance so we can catch temperature[0m
[30;1m13 | [0m[35m        See OutletDevice() for the other constructor arguments[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/Device.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def set_multiple_values(self, data, nowait=False):[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        Set multiple indexes at the same time[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        Args:[0m
[30;1m103 | [0m[35m            data(dict): array of index/value pairs to set[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/Device.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m        Request device to update index.[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        Args:[0m
[30;1m66 | [0m[35m            index(array): list of dps to update (ex. [4, 5, 6, 18, 19, 20])[0m
[30;1m67 | [0m[35m            nowait(bool): True to send without waiting for response.[0m
[30;1m68 | [0m[35m        """[0m
[30;1m69 | [0m[35m        if index is None:[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/Device.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    def updatedps(self, index=None, nowait=False):[0m
[30;1m62 | [0m[35m        """[0m
[30;1m63 | [0m[35m        Request device to update index.[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        Args:[0m
[30;1m66 | [0m[35m            index(array): list of dps to update (ex. [4, 5, 6, 18, 19, 20])[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def set_multiple_values(self, data, nowait=False):[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        Set multiple indexes at the same time[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        Args:[0m
[30;1m103 | [0m[35m            data(dict): array of index/value pairs to set[0m
[30;1m104 | [0m[35m            nowait(bool): True to send without waiting for response.[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/PresenceDetectorDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom ..core import Device[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mclass PresenceDetectorDevice(Device):[0m
[30;1m6 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/const.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mUDPPORT = 6666      # Tuya 3.1 UDP Port[0m
[30;1m8 | [0m[35mUDPPORTS = 6667     # Tuya 3.3 encrypted UDP Port[0m
[30;1m9 | [0m[35mUDPPORTAPP = 7000   # Tuya app encrypted UDP Port[0m
[30;1m10 | [0m[35mTCPPORT = 6668      # Tuya TCP Local Port[0m
[30;1m11 | [0m[35mTIMEOUT = 3.0       # Seconds to wait for a broadcast[0m
[30;1m12 | [0m[35mTCPTIMEOUT = 0.4    # Seconds to wait for socket open for scanning[0m
[30;1m13 | [0m[35mDEFAULT_NETWORK = '192.168.0.0/24'[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/CoverDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m35 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m36 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m37 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m38 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m39 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m40 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/CoverDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m23 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m24 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m25 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m26 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m27 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m28 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/CoverDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m Author: Jason A. Cox[0m
[30;1m7 | [0m[35m For more information see https://github.com/jasonacox/tinytuya[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m Local Control Classes[0m
[30;1m10 | [0m[35m    CoverDevice(...)[0m
[30;1m11 | [0m[35m        See OutletDevice() for constructor arguments[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/DoorbellDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35m    This DoorbellDevice works only if the device is online. Most stay[0m
[30;1m16 | [0m[35m    offline to preserve the battery.[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m Local Control Classes[0m
[30;1m19 | [0m[35m    DoorbellDevice(...)[0m
[30;1m20 | [0m[35m        See OutletDevice() for constructor arguments[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m Author: Ahmed Chehaibi (https://github.com/CheAhMeD)[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m Local Control Classes[0m
[30;1m11 | [0m[35m    ColorfulX7Device(...)[0m
[30;1m12 | [0m[35m        See OutletDevice() for constructor arguments[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m        if not 0 <= r <= 255:[0m
[30;1m338 | [0m[35m            return error_json([0m
[30;1m339 | [0m[35m                ERR_RANGE,[0m
[30;1m340 | [0m[35m                "set_color: The value for red needs to be between 0 and 255.",[0m
[30;1m341 | [0m[35m            )[0m
[30;1m342 | [0m[35m        if not 0 <= g <= 255:[0m
[30;1m343 | [0m[35m            return error_json([0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m329 | [0m[35m        if not 1 <= mode <= 30:[0m
[30;1m330 | [0m[35m            return error_json([0m
[30;1m331 | [0m[35m                ERR_RANGE,[0m
[30;1m332 | [0m[35m                "set_screen_mode: The screen mode needs to be between 1 and 30."[0m
[30;1m333 | [0m[35m            )[0m
[30;1m334 | [0m[35m        self.set_value(self.DPS_INDEX_SCREEN_MODE, mode)[0m
[30;1m335 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m321 | [0m[35m        choose between 30 available matrix modes[0m
[30;1m322 | [0m[35m        modes don't have a name they are represented by numbers[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m        If Screen mode is enabled (workmode = SCREEN)[0m
[30;1m325 | [0m[35m        we can use set_screen_mode, set_sensitivity and set_fallingDot_color[0m
[30;1m326 | [0m[35m        using the other functions won't have any effect[0m
[30;1m327 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    def set_screen_mode(self, mode):[0m
[30;1m318 | [0m[35m        '''[0m
[30;1m319 | [0m[35m        Screen Mode: [0m
[30;1m320 | [0m[35m        Like Music mode but for matrix display[0m
[30;1m321 | [0m[35m        choose between 30 available matrix modes[0m
[30;1m322 | [0m[35m        modes don't have a name they are represented by numbers[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m290 | [0m[35m        if not 0 <= r <= 255:[0m
[30;1m291 | [0m[35m            return error_json([0m
[30;1m292 | [0m[35m                ERR_RANGE,[0m
[30;1m293 | [0m[35m                "set_color: The value for red needs to be between 0 and 255.",[0m
[30;1m294 | [0m[35m            )[0m
[30;1m295 | [0m[35m        if not 0 <= g <= 255:[0m
[30;1m296 | [0m[35m            return error_json([0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m        if not 0 <= r <= 255:[0m
[30;1m210 | [0m[35m            return error_json([0m
[30;1m211 | [0m[35m                ERR_RANGE,[0m
[30;1m212 | [0m[35m                "set_color: The value for red needs to be between 0 and 255.",[0m
[30;1m213 | [0m[35m            )[0m
[30;1m214 | [0m[35m        if not 0 <= g <= 255:[0m
[30;1m215 | [0m[35m            return error_json([0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m        if not 0 <= r <= 255:[0m
[30;1m149 | [0m[35m            return error_json([0m
[30;1m150 | [0m[35m                ERR_RANGE,[0m
[30;1m151 | [0m[35m                "set_color: The value for red needs to be between 0 and 255.",[0m
[30;1m152 | [0m[35m            )[0m
[30;1m153 | [0m[35m        if not 0 <= g <= 255:[0m
[30;1m154 | [0m[35m            return error_json([0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m53 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m54 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m55 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m56 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m57 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m58 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m41 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m42 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m43 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m44 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m45 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m46 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m        set_sensitivity(value)             # sets the MIC sensitivity in MUSIC | SCREEN work modes[0m
[30;1m32 | [0m[35m        set_music_RGBColor(r, g, b)        # sets the colour in some scenes in MUSIC | SCREEN work m[0m
[30;1m33 | [0m[35m        set_led_brand(brand)               # sets the Leds brand to WS2811 | DMX512 | FW1935[0m
[30;1m34 | [0m[35m        set_screen_mode(mode)              # sets the scene type in SCREEN work mode[0m
[30;1m35 | [0m[35m        set_fallingDot_color(r, g, b)      # sets the falling dot color in some scenes in MUSIC work[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    Inherited[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35mcene type in DYNAMIC work mode[0m
[30;1m30 | [0m[35m        set_music_mode(mode)               # sets the scene type in MUSIC work mode[0m
[30;1m31 | [0m[35m        set_sensitivity(value)             # sets the MIC sensitivity in MUSIC | SCREEN work modes[0m
[30;1m32 | [0m[35m        set_music_RGBColor(r, g, b)        # sets the colour in some scenes in MUSIC | SCREEN work m[0m
[30;1m33 | [0m[35m        set_led_brand(brand)               # sets the Leds brand to WS2811 | DMX512 | FW1935[0m
[30;1m34 | [0m[35m        set_screen_mode(mode)              # sets the scene type in SCREEN work mode[0m
[30;1m35 | [0m[35m        set_fallingDot_color(r, g, b)      # sets the falling dot color in some scenes in MUSIC work[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m            # sets the speed in DYNAMIC work mode[0m
[30;1m29 | [0m[35m        set_dynamic_mode(mode)             # sets the scene type in DYNAMIC work mode[0m
[30;1m30 | [0m[35m        set_music_mode(mode)               # sets the scene type in MUSIC work mode[0m
[30;1m31 | [0m[35m        set_sensitivity(value)             # sets the MIC sensitivity in MUSIC | SCREEN work modes[0m
[30;1m32 | [0m[35m        set_music_RGBColor(r, g, b)        # sets the colour in some scenes in MUSIC | SCREEN work m[0m
[30;1m33 | [0m[35m        set_led_brand(brand)               # sets the Leds brand to WS2811 | DMX512 | FW1935[0m
[30;1m34 | [0m[35m        set_screen_mode(mode)              # sets the scene type in SCREEN work mode[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mds per segment in led strip|matrix (1 to 150)[0m
[30;1m24 | [0m[35m        set_rgb_order(order)               # sets the RGB order of the leds to  ORDER_RGB | ORDER_RB[0m
[30;1m25 | [0m[35m        set_work_mode(mode)                # sets the work mode to CLOSE | FIX_COLOR | DYNAMIC | MUS[0m
[30;1m26 | [0m[35m        set_color_rgb(r, g, b)             # sets the colour in CLOSE | FIX_COLOR | DYNAMIC work mod[0m
[30;1m27 | [0m[35m        set_brightness(value)              # sets the brightness in CLOSE | FIX_COLOR | DYNAMIC work[0m
[30;1m28 | [0m[35m        set_speed(value)                   # sets the speed in DYNAMIC work mode[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ColorfulX7Device.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m                    # returns the state of the device (True=On, False=Off)[0m
[30;1m17 | [0m[35m        switch_off()                       # turns off the device[0m
[30;1m18 | [0m[35m        switch_on()                        # turns on the device[0m
[30;1m19 | [0m[35m        set_mode(mode)                     # sets the mode to white | colour | scene | music | scree[0m
[30;1m20 | [0m[35m        set_color(r, g, b)                 # sets the colour [0m
[30;1m21 | [0m[35m        set_countdown(value)               # sets the countdown timer value (max 86400)[0m
[30;1m22 | [0m[35m        set_segments_number(number)        # sets the number of segments in led strip|matrix (1 to 6[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35mf sp != 'json':[0m
[30;1m52 | [0m[35m        if sp != 'snapshot':[0m
[30;1m53 | [0m[35m            subparsers[sp].add_argument( 'max_time', help='Maximum time to find Tuya devices [Defaul[0m
[30;1m54 | [0m[35m            subparsers[sp].add_argument( '-force', '-f', metavar='0.0.0.0/24', help='Force network s[0m
[30;1m55 | [0m[35m            subparsers[sp].add_argument( '-no-broadcasts', help='Ignore broadcast packets when force[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    if sp != 'json':[0m
[30;1m52 | [0m[35m        if sp != 'snapshot':[0m
[30;1m53 | [0m[35m            subparsers[sp].add_argument( 'max_time', help='Maximum time to find Tuya devices [Defaul[0m
[30;1m54 | [0m[35m            subparsers[sp].add_argument( '-force', '-f', metavar='0.0.0.0/24', help='Force network s[0m
[30;1m55 | [0m[35m            subparsers[sp].add_argument( '-no-broadcasts', help='Ignore broadcast packets when force[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    if sp != 'json':[0m
[30;1m52 | [0m[35m        if sp != 'snapshot':[0m
[30;1m53 | [0m[35m            subparsers[sp].add_argument( 'max_time', help='Maximum time to find Tuya devices [Defaul[0m
[30;1m54 | [0m[35m            subparsers[sp].add_argument( '-force', '-f', metavar='0.0.0.0/24', help='Force network s[0m
[30;1m55 | [0m[35m            subparsers[sp].add_argument( '-no-broadcasts', help='Ignore broadcast packets when force[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ClimateDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35m Python module to interface with Tuya Portable Air Conditioner devices[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m Local Control Classes[0m
[30;1m7 | [0m[35m    ClimateDevice(..., version=3.3)[0m
[30;1m8 | [0m[35m        This class uses a default version of 3.3[0m
[30;1m9 | [0m[35m        See OutletDevice() for the other constructor arguments[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ClimateDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m42 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m43 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m44 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m45 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m46 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m47 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/ClimateDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m30 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m31 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m32 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m33 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m34 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m35 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m            log.debug([0m
[30;1m223 | [0m[35m                "POST: URL=%s HEADERS=%s DATA=%s", url, headers, body,[0m
[30;1m224 | [0m[35m            )[0m
[30;1m225 | [0m[35m            response = requests.post(url, headers=headers, data=body)[0m
[30;1m226 | [0m[35m            log.debug([0m
[30;1m227 | [0m[35m                "POST RESPONSE: code=%d text=%s token=%s", response.status_code, response.text, self[0m
[30;1m228 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        # Send Request to Cloud and Get Response[0m
[30;1m216 | [0m[35m        if action == 'GET':[0m
[30;1m217 | [0m[35m            response = requests.get(url, headers=headers)[0m
[30;1m218 | [0m[35m            log.debug([0m
[30;1m219 | [0m[35m                "GET: URL=%s HEADERS=%s response code=%d text=%s token=%s", url, headers, response.s[0m
[30;1m220 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m            payload += ('%s\n' % action +                                                # HTTPMetho[0m
[30;1m193 | [0m[35m                hashlib.sha256(bytes((body or "").encode('utf-8'))).hexdigest() + '\n' + # Content-S[0m
[30;1m194 | [0m[35m                ''.join(['%s:%s\n'%(key, headers[key])                                   # Headers[0m
[30;1m195 | [0m[35m                            for key in headers.get("Signature-Headers", "").split(":")[0m
[30;1m196 | [0m[35m                            if key in headers]) + '\n' +[0m
[30;1m197 | [0m[35m                '/' + sign_url.split('//', 1)[-1].split('/', 1)[-1])[0m
[30;1m198 | [0m[35m        # Sign Payload[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m                    req = requests.Request(action, url, params=query).prepare()[0m
[30;1m181 | [0m[35m                    url = req.url[0m
[30;1m182 | [0m[35m                else:[0m
[30;1m183 | [0m[35m                    req = requests.Request(action, url, params=query).prepare()[0m
[30;1m184 | [0m[35m                    sign_url = url = req.url[0m
[30;1m185 | [0m[35m        now = int(time.time()*1000)[0m
[30;1m186 | [0m[35m        headers = dict(list(headers.items()) + [('Signature-Headers', ":".join(headers.keys()))]) if[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m                    query = sorted_query[0m
[30;1m175 | [0m[35m                    # calculate signature without url-encoding[0m
[30;1m176 | [0m[35m                    sign_url += '?' + '&'.join( [str(x[0]) + '=' + str(x[1]) for x in query] )[0m
[30;1m177 | [0m[35m                    req = requests.Request(action, url, params=query).prepare()[0m
[30;1m178 | [0m[35m                    url = req.url[0m
[30;1m179 | [0m[35m                else:[0m
[30;1m180 | [0m[35m                    req = requests.Request(action, url, params=query).prepare()[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m.hostname[0m
[30;1m117 | [0m[35m            self._gettoken()[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    def setregion(self, apiRegion=None):[0m
[30;1m120 | [0m[35m        # Set hostname based on apiRegion[0m
[30;1m121 | [0m[35m        if apiRegion is None:[0m
[30;1m122 | [0m[35m            apiRegion = self.apiRegion[0m
[30;1m123 | [0m[35m        self.apiRegion = apiRegion.lower()[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m788 | [0m[35m[0m
[30;1m789 | [0m[35m    @staticmethod[0m
[30;1m790 | [0m[35m    def format_timestamp( ts ):[0m
[30;1m791 | [0m[35m        # converts a 10-digit unix timestamp to the 13-digit stamp the servers expect[0m
[30;1m792 | [0m[35m        if type(ts) != int:[0m
[30;1m793 | [0m[35m            if len(str(int(ts))) == 10:[0m
[30;1m794 | [0m[35m                ts = int( ts * 1000 )[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m674 | [0m[35m        Args:[0m
[30;1m675 | [0m[35m          devid:  Required.  Device ID[0m
[30;1m676 | [0m[35m          start:  Optional.  Get logs starting from this time.  Defaults to yesterday[0m
[30;1m677 | [0m[35m          end:    Optional.  Get logs until this time.  Defaults to the current time[0m
[30;1m678 | [0m[35m          evtype: Optional.  Limit to events of this type.  1 = Online, 7 = DP Reports.  Defaults to[0m
[30;1m679 | [0m[35m          size:   Optional.  Target number of log entries to return.  Defaults to 0 (all, up to max_[0m
[30;1m680 | [0m[35m                               Actual number of log entries returned will be between "0" and "size *[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        Signature Details:[0m
[30;1m67 | [0m[35m            * OAuth Token Request: signature = HMAC-SHA256(KEY + t, SECRET).toUpperCase()[0m
[30;1m68 | [0m[35m            * Service Management: signature = HMAC-SHA256(KEY + access_token + t, SECRET).toUpperCas[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        URIs:[0m
[30;1m71 | [0m[35m            * Get Token = https://openapi.tuyaus.com/v1.0/token?grant_type=1[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m            sign_method	  String	 Yes	Message-Digest Algorithm of the signature: HMAC-SHA256.[0m
[30;1m62 | [0m[35m            t	          Long	     Yes	13-bit standard timestamp (now in milliseconds).[0m
[30;1m63 | [0m[35m            lang	      String	 No	    Language. It is zh by default in China and en in other areas.[0m
[30;1m64 | [0m[35m            access_token  String     *      Required for service management calls[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        Signature Details:[0m
[30;1m67 | [0m[35m            * OAuth Token Request: signature = HMAC-SHA256(KEY + t, SECRET).toUpperCase()[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35mimport hashlib[0m
[30;1m33 | [0m[35mimport hmac[0m
[30;1m34 | [0m[35mimport json[0m
[30;1m35 | [0m[35mimport time[0m
[30;1m36 | [0m[35mtry:[0m
[30;1m37 | [0m[35m    import requests[0m
[30;1m38 | [0m[35mexcept ImportError as impErr:[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m453 | [0m[35m                if 'uid' in dev:[0m
[30;1m454 | [0m[35m                    users[dev['uid']] = True[0m
[30;1m455 | [0m[35m            if users:[0m
[30;1m456 | [0m[35m                # we have at least 1 user id, so fetch the device list again to make sure we have th[0m
[30;1m457 | [0m[35m                # this also gets us the gateway_id for child devices[0m
[30;1m458 | [0m[35m                for uid in users.keys():[0m
[30;1m459 | [0m[35m                    json_data2 = self._get_all_devices( uid=uid )[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m187 | [0m[35m        else:[0m
[30;1m188 | [0m[35m            payload = self.apiKey + self.token + str(now)[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m        # If running the post 6-30-2021 signing algorithm update the payload to include it's data[0m
[30;1m191 | [0m[35m        if self.new_sign_algorithm:[0m
[30;1m192 | [0m[35m            payload += ('%s\n' % action +                                                # HTTPMetho[0m
[30;1m193 | [0m[35m                hashlib.sha256(bytes((body or "").encode('utf-8'))).hexdigest() + '\n' + # Content-S[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Cloud.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m Author: Jason A. Cox[0m
[30;1m7 | [0m[35m For more information see https://github.com/jasonacox/tinytuya[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m Local Control Classes[0m
[30;1m10 | [0m[35m    Cloud(apiRegion, apiKey, apiSecret, apiDeviceID, new_sign_algorithm)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m Functions[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/message_helper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m21 | [0m[35mtry:[0m
[30;1m22 | [0m[35m    TuyaMessage = namedtuple("TuyaMessage", "seqno cmd retcode payload crc crc_good prefix iv", defa[0m
[30;1m23 | [0m[35mexcept:[0m
[30;1m24 | [0m[35m    TuyaMessage = namedtuple("TuyaMessage", "seqno cmd retcode payload crc crc_good prefix iv")[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mdef pack_message(msg, hmac_key=None):[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/message_helper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m19 | [0m[35mTuyaHeader = namedtuple('TuyaHeader', 'prefix seqno cmd length total_length')[0m
[30;1m20 | [0m[35mMessagePayload = namedtuple("MessagePayload", "cmd payload")[0m
[30;1m21 | [0m[35mtry:[0m
[30;1m22 | [0m[35m    TuyaMessage = namedtuple("TuyaMessage", "seqno cmd retcode payload crc crc_good prefix iv", defa[0m
[30;1m23 | [0m[35mexcept:[0m
[30;1m24 | [0m[35m    TuyaMessage = namedtuple("TuyaMessage", "seqno cmd retcode payload crc crc_good prefix iv")[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/message_helper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m# Tuya Packet Format[0m
[30;1m19 | [0m[35mTuyaHeader = namedtuple('TuyaHeader', 'prefix seqno cmd length total_length')[0m
[30;1m20 | [0m[35mMessagePayload = namedtuple("MessagePayload", "cmd payload")[0m
[30;1m21 | [0m[35mtry:[0m
[30;1m22 | [0m[35m    TuyaMessage = namedtuple("TuyaMessage", "seqno cmd retcode payload crc crc_good prefix iv", defa[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/message_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m    if( data[:4] == H.PREFIX_6699_BIN ):[0m
[30;1m71 | [0m[35m        fmt = H.MESSAGE_HEADER_FMT_6699[0m
[30;1m72 | [0m[35m    else:[0m
[30;1m73 | [0m[35m        fmt = H.MESSAGE_HEADER_FMT_55AA[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    header_len = struct.calcsize(fmt)[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/message_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mdef parse_header(data):[0m
[30;1m70 | [0m[35m    if( data[:4] == H.PREFIX_6699_BIN ):[0m
[30;1m71 | [0m[35m        fmt = H.MESSAGE_HEADER_FMT_6699[0m
[30;1m72 | [0m[35m    else:[0m
[30;1m73 | [0m[35m        fmt = H.MESSAGE_HEADER_FMT_55AA[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/command_types.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35mSESS_KEY_NEG_START  = 3  # FRM_SECURITY_TYPE3 # negotiate session key[0m
[30;1m9 | [0m[35mSESS_KEY_NEG_RESP   = 4  # FRM_SECURITY_TYPE4 # negotiate session key response[0m
[30;1m10 | [0m[35mSESS_KEY_NEG_FINISH = 5  # FRM_SECURITY_TYPE5 # finalize session key negotiation[0m
[30;1m11 | [0m[35mUNBIND          = 6  # FRM_TP_UNBIND_DEV  # DATA_QUERT_CMD - issue command[0m
[30;1m12 | [0m[35mCONTROL         = 7  # FRM_TP_CMD         # STATE_UPLOAD_CMD[0m
[30;1m13 | [0m[35mSTATUS          = 8  # FRM_TP_STAT_REPORT # STATE_QUERY_CMD[0m
[30;1m14 | [0m[35mHEART_BEAT      = 9  # FRM_TP_HB[0m
[30;1m15 | [0m[35mDP_QUERY        = 0x0a # 10 # FRM_QUERY_STAT      # UPDATE_START_CMD - get data points[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/command_types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mHEART_BEAT      = 9  # FRM_TP_HB[0m
[30;1m15 | [0m[35mDP_QUERY        = 0x0a # 10 # FRM_QUERY_STAT      # UPDATE_START_CMD - get data points[0m
[30;1m16 | [0m[35mQUERY_WIFI      = 0x0b # 11 # FRM_SSID_QUERY (discard) # UPDATE_TRANS_CMD[0m
[30;1m17 | [0m[35mTOKEN_BIND      = 0x0c # 12 # FRM_USER_BIND_REQ   # GET_ONLINE_TIME_CMD - system time (GMT)[0m
[30;1m18 | [0m[35mCONTROL_NEW     = 0x0d # 13 # FRM_TP_NEW_CMD      # FACTORY_MODE_CMD[0m
[30;1m19 | [0m[35mENABLE_WIFI     = 0x0e # 14 # FRM_ADD_SUB_DEV_CMD # WIFI_TEST_CMD[0m
[30;1m20 | [0m[35mWIFI_INFO       = 0x0f # 15 # FRM_CFG_WIFI_INFO[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m40 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m41 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m42 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m43 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m44 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m45 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m28 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m29 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m30 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m31 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m32 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m33 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mdevice[0m
[30;1m16 | [0m[35m        local_key (str, optional): The encryption key. Defaults to None. If None, key will be looked[0m
[30;1m17 | [0m[35m        dev_type (str, optional): Device type for payload options (see below)[0m
[30;1m18 | [0m[35m        connection_timeout (float, optional): The default socket connect and data timeout[0m
[30;1m19 | [0m[35m        version (float, optional): The API version to use. Defaults to 3.1[0m
[30;1m20 | [0m[35m        persist (bool, optional): Make a persistant connection to the device[0m
[30;1m21 | [0m[35m    Cloud(apiRegion, apiKey, apiSecret, apiDeviceID, new_sign_algorithm)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m  Functions[0m
[30;1m24 | [0m[35m    Device(XenonDevice)[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m    BulbDevice(...)[0m
[30;1m13 | [0m[35m    Device(...)[0m
[30;1m14 | [0m[35m        dev_id (str): Device ID e.g. 01234567891234567890[0m
[30;1m15 | [0m[35m        address (str, optional): Device Network IP Address e.g. 10.0.1.99, or None to try and find t[0m
[30;1m16 | [0m[35m        local_key (str, optional): The encryption key. Defaults to None. If None, key will be looked[0m
[30;1m17 | [0m[35m        dev_type (str, optional): Device type for payload options (see below)[0m
[30;1m18 | [0m[35m        connection_timeout (float, optional): The default socket connect and data timeout[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m    BulbDevice(...)[0m
[30;1m13 | [0m[35m    Device(...)[0m
[30;1m14 | [0m[35m        dev_id (str): Device ID e.g. 01234567891234567890[0m
[30;1m15 | [0m[35m        address (str, optional): Device Network IP Address e.g. 10.0.1.99, or None to try and find t[0m
[30;1m16 | [0m[35m        local_key (str, optional): The encryption key. Defaults to None. If None, key will be looked[0m
[30;1m17 | [0m[35m        dev_type (str, optional): Device type for payload options (see below)[0m
[30;1m18 | [0m[35m        connection_timeout (float, optional): The default socket connect and data timeout[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m Author: Jason A. Cox[0m
[30;1m7 | [0m[35m For more information see https://github.com/jasonacox/tinytuya[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m  Local Control Classes[0m
[30;1m10 | [0m[35m    OutletDevice(dev_id, address=None, local_key=None, dev_type='default', connection_timeout=5, ver[0m
[30;1m11 | [0m[35m    CoverDevice(...)[0m
[30;1m12 | [0m[35m    BulbDevice(...)[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/SocketDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m Author: Felix Pieschka[0m
[30;1m7 | [0m[35m For more information see https://github.com/Felix-Pi[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m Local Control Classes[0m
[30;1m10 | [0m[35m    SocketDevice(...)[0m
[30;1m11 | [0m[35m        See OutletDevice() for constructor arguments[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/SocketDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m36 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m37 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m38 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m39 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m40 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m41 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/SocketDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m24 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m25 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m26 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m27 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m28 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m29 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m    To unpack data, you can do something like this:[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        devices = tinytuya.deviceScan()[0m
[30;1m233 | [0m[35m        for ip in devices:[0m
[30;1m234 | [0m[35m            id = devices[ip]['gwId'][0m
[30;1m235 | [0m[35m            key = devices[ip]['productKey'][0m
[30;1m236 | [0m[35m            vers = devices[ip]['version'][0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m        maxretry = The number of loops to wait to pick up UDP from all devices[0m
[30;1m223 | [0m[35m        color = True or False, print output in color [Default: True][0m
[30;1m224 | [0m[35m        poll = True or False, poll dps status for devices if possible[0m
[30;1m225 | [0m[35m        forcescan = True or False, force network scan for device IP addresses[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    Response:[0m
[30;1m228 | [0m[35m        devices = Dictionary of all devices found[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m        alert = "\033[0m\033[91m\033[1m"[0m
[30;1m201 | [0m[35m        alertdim = "\033[0m\033[91m\033[2m"[0m
[30;1m202 | [0m[35m        cyan = "\033[0m\033[36m"[0m
[30;1m203 | [0m[35m        red = "\033[0m\033[31m"[0m
[30;1m204 | [0m[35m        yellow = "\033[0m\033[33m"[0m
[30;1m205 | [0m[35m    return bold,subbold,normal,dim,alert,alertdim,cyan,red,yellow[0m
[30;1m206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35mdef termcolor(color=True):[0m
[30;1m191 | [0m[35m    if color is False:[0m
[30;1m192 | [0m[35m        # Disable Terminal Color Formatting[0m
[30;1m193 | [0m[35m        bold = subbold = normal = dim = alert = alertdim = cyan = red = yellow = ""[0m
[30;1m194 | [0m[35m    else:[0m
[30;1m195 | [0m[35m        # Terminal Color Formatting[0m
[30;1m196 | [0m[35m        bold = "\033[0m\033[97m\033[1m"[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    turn_on(switch=1, nowait)          # Turn on device / switch #[0m
[30;1m49 | [0m[35m    turn_off(switch=1, nowait)         # Turn off[0m
[30;1m50 | [0m[35m    set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m51 | [0m[35m    set_sendWait(num_secs)             # Time to wait after sending commands before pulling response[0m
[30;1m52 | [0m[35m    detect_available_dps()             # Return list of DPS available from device[0m
[30;1m53 | [0m[35m    generate_payload(command, data,...)# Generate TuyaMessage payload for command with data[0m
[30;1m54 | [0m[35m    send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m36 | [0m[35m    set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m37 | [0m[35m    set_socketRetryDelay(integer)      # retry delay [default 5][0m
[30;1m38 | [0m[35m    set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m39 | [0m[35m    set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m40 | [0m[35m    add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m41 | [0m[35m    set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35me() from a network packet, decrypting or checking the CRC if protocol requires[0m
[30;1m24 | [0m[35m    parse_header(data)                          # Unpacks just the header part of a message into a T[0m
[30;1m25 | [0m[35m    find_device(dev_id=None, address=None)      # Scans network for Tuya devices with either ID = de[0m
[30;1m26 | [0m[35m    device_info(dev_id)                         # Searches DEVICEFILE (usually devices.json) for dev[0m
[30;1m27 | [0m[35m    assign_dp_mappings(tuyadevices, mappings)   # Adds mappings to all the devices in the tuyadevice[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/OutletDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m Author: Jason A. Cox[0m
[30;1m7 | [0m[35m For more information see https://github.com/jasonacox/tinytuya[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m Local Control Classes[0m
[30;1m10 | [0m[35m    OutletDevice(dev_id, address=None, local_key=None, dev_type='default', connection_timeout=5, ver[0m
[30;1m11 | [0m[35m        dev_id (str): Device ID e.g. 01234567891234567890[0m
[30;1m12 | [0m[35m        address (str, optional): Device Network IP Address e.g. 10.0.1.99, or None to try and find t[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/OutletDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m39 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m40 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m41 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m42 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m43 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m44 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/OutletDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m27 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m28 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m29 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m30 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m31 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m32 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/OutletDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m        address (str, optional): Device Network IP Address e.g. 10.0.1.99, or None to try and find t[0m
[30;1m13 | [0m[35m        local_key (str, optional): The encryption key. Defaults to None. If None, key will be looked[0m
[30;1m14 | [0m[35m        dev_type (str, optional): Device type for payload options (see below)[0m
[30;1m15 | [0m[35m        connection_timeout (float, optional): The default socket connect and data timeout[0m
[30;1m16 | [0m[35m        version (float, optional): The API version to use. Defaults to 3.1[0m
[30;1m17 | [0m[35m        persist (bool, optional): Make a persistant connection to the device[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/OutletDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mLocal Control Classes[0m
[30;1m10 | [0m[35m    OutletDevice(dev_id, address=None, local_key=None, dev_type='default', connection_timeout=5, ver[0m
[30;1m11 | [0m[35m        dev_id (str): Device ID e.g. 01234567891234567890[0m
[30;1m12 | [0m[35m        address (str, optional): Device Network IP Address e.g. 10.0.1.99, or None to try and find t[0m
[30;1m13 | [0m[35m        local_key (str, optional): The encryption key. Defaults to None. If None, key will be looked[0m
[30;1m14 | [0m[35m        dev_type (str, optional): Device type for payload options (see below)[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/OutletDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35msee https://github.com/jasonacox/tinytuya[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m Local Control Classes[0m
[30;1m10 | [0m[35m    OutletDevice(dev_id, address=None, local_key=None, dev_type='default', connection_timeout=5, ver[0m
[30;1m11 | [0m[35m        dev_id (str): Device ID e.g. 01234567891234567890[0m
[30;1m12 | [0m[35m        address (str, optional): Device Network IP Address e.g. 10.0.1.99, or None to try and find t[0m
[30;1m13 | [0m[35m        local_key (str, optional): The encryption key. Defaults to None. If None, key will be looked[0m
[30;1m14 | [0m[35m        dev_type (str, optional): Device type for payload options (see below)[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m296 | [0m[35m            print(bold + "\n>> " + normal + "Saving IP addresses to " + DEVICEFILE)[0m
[30;1m297 | [0m[35m            with open(DEVICEFILE, "w") as outfile:[0m
[30;1m298 | [0m[35m                outfile.write(output)[0m
[30;1m299 | [0m[35m            print(dim + "    %d device IP addresses found" % found)[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m    print("\nDone.\n")[0m
[30;1m302 | [0m[35m    return[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m293 | [0m[35m        if found:[0m
[30;1m294 | [0m[35m            # re-write devices.json now that we have IP addresses[0m
[30;1m295 | [0m[35m            output = json.dumps(tuyadevices, indent=4)[0m
[30;1m296 | [0m[35m            print(bold + "\n>> " + normal + "Saving IP addresses to " + DEVICEFILE)[0m
[30;1m297 | [0m[35m            with open(DEVICEFILE, "w") as outfile:[0m
[30;1m298 | [0m[35m                outfile.write(output)[0m
[30;1m299 | [0m[35m            print(dim + "    %d device IP addresses found" % found)[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m                tuyadevices[k]['version'] = iplist[gwid][1][0m
[30;1m292 | [0m[35m                if iplist[gwid][0]: found += 1[0m
[30;1m293 | [0m[35m        if found:[0m
[30;1m294 | [0m[35m            # re-write devices.json now that we have IP addresses[0m
[30;1m295 | [0m[35m            output = json.dumps(tuyadevices, indent=4)[0m
[30;1m296 | [0m[35m            print(bold + "\n>> " + normal + "Saving IP addresses to " + DEVICEFILE)[0m
[30;1m297 | [0m[35m            with open(DEVICEFILE, "w") as outfile:[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m281 | [0m[35m        for itm in result:[0m
[30;1m282 | [0m[35m            if 'gwId' in itm and itm['gwId']:[0m
[30;1m283 | [0m[35m                gwid = itm['gwId'][0m
[30;1m284 | [0m[35m                ip = itm['ip'] if 'ip' in itm and itm['ip'] else ''[0m
[30;1m285 | [0m[35m                ver = itm['version'] if 'version' in itm and itm['version'] else ''[0m
[30;1m286 | [0m[35m                iplist[gwid] = (ip, ver)[0m
[30;1m287 | [0m[35m        for k in range( len(tuyadevices) ):[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m266 | [0m[35m        except:[0m
[30;1m267 | [0m[35m            print('\n\n' + bold + 'Unable to save raw file' + dim )[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    # Find out if we should poll all devices[0m
[30;1m270 | [0m[35m    if skip_poll:[0m
[30;1m271 | [0m[35m        answer = 'n'[0m
[30;1m272 | [0m[35m    elif assume_yes:[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m                if 'id' not in dev:[0m
[30;1m229 | [0m[35m                    dev['id'] = ''[0m
[30;1m230 | [0m[35m                found = False[0m
[30;1m231 | [0m[35m                # Loop through all devices again to try and find a non-sub-device with the same loca[0m
[30;1m232 | [0m[35m                for parent in tuyadevices:[0m
[30;1m233 | [0m[35m                    if 'id' not in parent or parent['id'] == dev['id']:[0m
[30;1m234 | [0m[35m                        continue[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m            # Set 'parent' to an empty string in case we can't find it[0m
[30;1m224 | [0m[35m            dev['parent'] = ''[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m            # Only try to find the parent if the device has a local key[0m
[30;1m227 | [0m[35m            if 'key' in dev and dev['key']:[0m
[30;1m228 | [0m[35m                if 'id' not in dev:[0m
[30;1m229 | [0m[35m                    dev['id'] = ''[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m            if 'parent' in dev and dev['parent']:[0m
[30;1m221 | [0m[35m                continue[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m            # Set 'parent' to an empty string in case we can't find it[0m
[30;1m224 | [0m[35m            dev['parent'] = ''[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m            # Only try to find the parent if the device has a local key[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m            del dev['gateway_id'][0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        if 'sub' in dev and dev['sub']:[0m
[30;1m219 | [0m[35m            # no parent from cloud, try to find it via the local key[0m
[30;1m220 | [0m[35m            if 'parent' in dev and dev['parent']:[0m
[30;1m221 | [0m[35m                continue[0m
[30;1m222 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m    else:[0m
[30;1m166 | [0m[35m        if 'apiDeviceID' in config and config['apiDeviceID'] and config['apiDeviceID'].strip().lower[0m
[30;1m167 | [0m[35m            config['apiDeviceID'] = ''[0m
[30;1m168 | [0m[35m            print( '\nScanning to find a Device ID...' )[0m
[30;1m169 | [0m[35m            dev = tinytuya.scanner.devices( verbose=False, poll=False, byID=True, show_timer=False, [0m
[30;1m170 | [0m[35m            for devid in dev:[0m
[30;1m171 | [0m[35m                print( '\nScan found Device ID %r' % devid )[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m            if file_config and k in file_config and file_config[k]:[0m
[30;1m94 | [0m[35m                config[k] = file_config[k][0m
[30;1m95 | [0m[35m    except:[0m
[30;1m96 | [0m[35m        # First Time Setup[0m
[30;1m97 | [0m[35m        pass[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    if credentials:[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m    Parameter:[0m
[30;1m56 | [0m[35m        color = True or False, print output in color [Default: True][0m
[30;1m57 | [0m[35m        retries = Number of retries to find IP address of Tuya Devices[0m
[30;1m58 | [0m[35m        forcescan = True or False, force network scan for device IP addresses[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    Description[0m
[30;1m61 | [0m[35m        Setup Wizard will prompt user for Tuya IoT Developer credentials and will gather all of[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/wizard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    Parameter:[0m
[30;1m56 | [0m[35m        color = True or False, print output in color [Default: True][0m
[30;1m57 | [0m[35m        retries = Number of retries to find IP address of Tuya Devices[0m
[30;1m58 | [0m[35m        forcescan = True or False, force network scan for device IP addresses[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    Description[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/core/udp_helper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m38 | [0m[35m    if header.prefix == H.PREFIX_6699_VALUE:[0m
[30;1m39 | [0m[35m        unpacked = unpack_message(msg, hmac_key=udpkey, no_retcode=None)[0m
[30;1m40 | [0m[35m        payload = unpacked.payload.decode()[0m
[30;1m41 | [0m[35m        # app sometimes has extra bytes at the end[0m
[30;1m42 | [0m[35m        while payload[-1] == chr(0):[0m
[30;1m43 | [0m[35m            payload = payload[:-1][0m
[30;1m44 | [0m[35m        return payload[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/AtorchTemperatureControllerDevice.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m Author: Benjamin DUPUIS[0m
[30;1m7 | [0m[35m For more information see https://github.com/poil[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m Local Control Classes[0m
[30;1m10 | [0m[35m    AtorchTemperatureController(...)[0m
[30;1m11 | [0m[35m        See OutletDevice() for constructor arguments[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/AtorchTemperatureControllerDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m        turn_off(switch=1, nowait)         # Turn off[0m
[30;1m37 | [0m[35m        set_timer(num_secs, nowait)        # Set timer for num_secs[0m
[30;1m38 | [0m[35m        set_debug(toggle, color)           # Activate verbose debugging output[0m
[30;1m39 | [0m[35m        set_sendWait(num_secs)             # Time to wait after sending commands before pulling resp[0m
[30;1m40 | [0m[35m        detect_available_dps()             # Return list of DPS available from device[0m
[30;1m41 | [0m[35m        generate_payload(command, data)    # Generate TuyaMessage payload for command with data[0m
[30;1m42 | [0m[35m        send(payload)                      # Send payload to device (do not wait for response)[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m403[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/tinytuya/Contrib/AtorchTemperatureControllerDevice.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m        set_socketPersistent(False/True)   # False [default] or True[0m
[30;1m25 | [0m[35m        set_socketNODELAY(False/True)      # False or True [default][0m
[30;1m26 | [0m[35m        set_socketRetryLimit(integer)      # retry count limit [default 5][0m
[30;1m27 | [0m[35m        set_socketTimeout(timeout)         # set connection timeout in seconds [default 5][0m
[30;1m28 | [0m[35m        set_dpsUsed(dps_to_request)        # add data points (DPS) to request[0m
[30;1m29 | [0m[35m        add_dps_to_request(index)          # add data point (DPS) index set to None[0m
[30;1m30 | [0m[35m        set_retry(retry=True)              # retry if response payload is truncated[0m

403 matches found.
