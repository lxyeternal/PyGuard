[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/signing_mechanism.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m70 | [0m[35m            hmac_digest = hmac.HMAC([0m
[30;1m71 | [0m[35m                key=self._signing_key, msg=data_bytes, digestmod=hashlib.sha256[0m
[30;1m72 | [0m[35m            ).digest()[0m
[30;1m73 | [0m[35m            signed_data = base64.b64encode(hmac_digest)[0m
[30;1m74 | [0m[35m        except (TypeError):[0m
[30;1m75 | [0m[35m            raise ValueError("Unable to sign string using the provided symmetric key")[0m
[30;1m76 | [0m[35m        # Convert from bytes to string[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/signing_mechanism.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        # Derives the signing key[0m
[30;1m42 | [0m[35m        try:[0m
[30;1m43 | [0m[35m            self._signing_key = base64.b64decode(key_bytes)[0m
[30;1m44 | [0m[35m        except (binascii.Error):[0m
[30;1m45 | [0m[35m            raise ValueError("Invalid Symmetric Key")[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/signing_mechanism.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m27 | [0m[35m        """[0m
[30;1m28 | [0m[35m        A mechanism that signs data using a symmetric key[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        :param key: Symmetric Key (base64 encoded)[0m
[30;1m31 | [0m[35m        :type key: str or bytes[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        :raises: ValueError if provided key is invalid[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/signing_mechanism.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35mimport abc[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport binascii[0m
[30;1m9 | [0m[35mimport hmac[0m
[30;1m10 | [0m[35mimport hashlib[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/edge_hsm.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m99 | [0m[35m        else:[0m
[30;1m100 | [0m[35m            data_bytes = data_str[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        encoded_data_str = base64.b64encode(data_bytes).decode()[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m        path = "{workload_uri}modules/{module_id}/genid/{gen_id}/sign".format([0m
[30;1m105 | [0m[35m            workload_uri=self.workload_uri, module_id=self.module_id, gen_id=self.generation_id[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/edge_hsm.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m        :param str data_str: The data string to sign[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        :return: The signature, as a URI-encoded and base64-encoded value that is ready to[0m
[30;1m92 | [0m[35m        directly insert into the SharedAccessSignature string.[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        :raises: IoTEdgeError if unable to sign the data.[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/edge_hsm.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m3 | [0m[35m# Licensed under the MIT License. See License.txt in the project root for[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35mimport base64[0m
[30;1m7 | [0m[35mimport logging[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport requests  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m407 | [0m[35m        :param str username: The username for broker authentication[0m
[30;1m408 | [0m[35m        :param str password: The password for broker authentication (Optional)[0m
[30;1m409 | [0m[35m        """[0m
[30;1m410 | [0m[35m        self._mqtt_client.username_pw_set(username=username, password=password)[0m
[30;1m411 | [0m[35m[0m
[30;1m412 | [0m[35m    def add_incoming_message_filter(self, topic: str) -> None:[0m
[30;1m413 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m407 | [0m[35m        :param str username: The username for broker authentication[0m
[30;1m408 | [0m[35m        :param str password: The password for broker authentication (Optional)[0m
[30;1m409 | [0m[35m        """[0m
[30;1m410 | [0m[35m        self._mqtt_client.username_pw_set(username=username, password=password)[0m
[30;1m411 | [0m[35m[0m
[30;1m412 | [0m[35m    def add_incoming_message_filter(self, topic: str) -> None:[0m
[30;1m413 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m405 | [0m[35m        Must be called before .connect() to have any effect.[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        :param str username: The username for broker authentication[0m
[30;1m408 | [0m[35m        :param str password: The password for broker authentication (Optional)[0m
[30;1m409 | [0m[35m        """[0m
[30;1m410 | [0m[35m        self._mqtt_client.username_pw_set(username=username, password=password)[0m
[30;1m411 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m405 | [0m[35m        Must be called before .connect() to have any effect.[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        :param str username: The username for broker authentication[0m
[30;1m408 | [0m[35m        :param str password: The password for broker authentication (Optional)[0m
[30;1m409 | [0m[35m        """[0m
[30;1m410 | [0m[35m        self._mqtt_client.username_pw_set(username=username, password=password)[0m
[30;1m411 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m    def set_credentials(self, username: str, password: Optional[str] = None) -> None:[0m
[30;1m402 | [0m[35m        """[0m
[30;1m403 | [0m[35m        Set a username and optionally a password for broker authentication.[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m        Must be called before .connect() to have any effect.[0m
[30;1m406 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m398 | [0m[35m        """[0m
[30;1m399 | [0m[35m        return self._disconnection_cause[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m    def set_credentials(self, username: str, password: Optional[str] = None) -> None:[0m
[30;1m402 | [0m[35m        """[0m
[30;1m403 | [0m[35m        Set a username and optionally a password for broker authentication.[0m
[30;1m404 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m178 | [0m[35m                proxy_addr=proxy_options.proxy_address,[0m
[30;1m179 | [0m[35m                proxy_port=proxy_options.proxy_port,[0m
[30;1m180 | [0m[35m                proxy_username=proxy_options.proxy_username,[0m
[30;1m181 | [0m[35m                proxy_password=proxy_options.proxy_password,[0m
[30;1m182 | [0m[35m            )[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        mqtt_client.enable_logger(logging.getLogger("paho"))[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m178 | [0m[35m                proxy_addr=proxy_options.proxy_address,[0m
[30;1m179 | [0m[35m                proxy_port=proxy_options.proxy_port,[0m
[30;1m180 | [0m[35m                proxy_username=proxy_options.proxy_username,[0m
[30;1m181 | [0m[35m                proxy_password=proxy_options.proxy_password,[0m
[30;1m182 | [0m[35m            )[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        mqtt_client.enable_logger(logging.getLogger("paho"))[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35m    mqtt.CONNACK_REFUSED_PROTOCOL_VERSION,[0m
[30;1m38 | [0m[35m    mqtt.CONNACK_REFUSED_IDENTIFIER_REJECTED,[0m
[30;1m39 | [0m[35m    mqtt.CONNACK_REFUSED_SERVER_UNAVAILABLE,[0m
[30;1m40 | [0m[35m    mqtt.CONNACK_REFUSED_BAD_USERNAME_PASSWORD,[0m
[30;1m41 | [0m[35m    mqtt.CONNACK_REFUSED_NOT_AUTHORIZED,[0m
[30;1m42 | [0m[35m][0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m191 | [0m[35m        else:[0m
[30;1m192 | [0m[35m            logger.debug("No password used")[0m
[30;1m193 | [0m[35m            password = None[0m
[30;1m194 | [0m[35m        self._mqtt_client.set_credentials(self._username, password)[0m
[30;1m195 | [0m[35m        # Start background tasks[0m
[30;1m196 | [0m[35m        if not self._process_twin_responses_bg_task:[0m
[30;1m197 | [0m[35m            self._process_twin_responses_bg_task = asyncio.create_task([0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m190 | [0m[35m            password = str(self._sastoken_provider.get_current_sastoken())[0m
[30;1m191 | [0m[35m        else:[0m
[30;1m192 | [0m[35m            logger.debug("No password used")[0m
[30;1m193 | [0m[35m            password = None[0m
[30;1m194 | [0m[35m        self._mqtt_client.set_credentials(self._username, password)[0m
[30;1m195 | [0m[35m        # Start background tasks[0m
[30;1m196 | [0m[35m        if not self._process_twin_responses_bg_task:[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m189 | [0m[35m            logger.debug("Using SASToken as password")[0m
[30;1m190 | [0m[35m            password = str(self._sastoken_provider.get_current_sastoken())[0m
[30;1m191 | [0m[35m        else:[0m
[30;1m192 | [0m[35m            logger.debug("No password used")[0m
[30;1m193 | [0m[35m            password = None[0m
[30;1m194 | [0m[35m        self._mqtt_client.set_credentials(self._username, password)[0m
[30;1m195 | [0m[35m        # Start background tasks[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m187 | [0m[35m        # Set credentials[0m
[30;1m188 | [0m[35m        if self._sastoken_provider:[0m
[30;1m189 | [0m[35m            logger.debug("Using SASToken as password")[0m
[30;1m190 | [0m[35m            password = str(self._sastoken_provider.get_current_sastoken())[0m
[30;1m191 | [0m[35m        else:[0m
[30;1m192 | [0m[35m            logger.debug("No password used")[0m
[30;1m193 | [0m[35m            password = None[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m186 | [0m[35m        """[0m
[30;1m187 | [0m[35m        # Set credentials[0m
[30;1m188 | [0m[35m        if self._sastoken_provider:[0m
[30;1m189 | [0m[35m            logger.debug("Using SASToken as password")[0m
[30;1m190 | [0m[35m            password = str(self._sastoken_provider.get_current_sastoken())[0m
[30;1m191 | [0m[35m        else:[0m
[30;1m192 | [0m[35m            logger.debug("No password used")[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m        else:[0m
[30;1m58 | [0m[35m            self.proxy_port = int(proxy_port)[0m
[30;1m59 | [0m[35m        self.proxy_username = proxy_username[0m
[30;1m60 | [0m[35m        self.proxy_password = proxy_password[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35mclass ClientConfig:[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m        else:[0m
[30;1m58 | [0m[35m            self.proxy_port = int(proxy_port)[0m
[30;1m59 | [0m[35m        self.proxy_username = proxy_username[0m
[30;1m60 | [0m[35m        self.proxy_password = proxy_password[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35mclass ClientConfig:[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35mroxy.This parameter is ignored if an HTTP server is being used.[0m
[30;1m48 | [0m[35m         If it is not provided, authentication will not be used (servers may accept unauthenticated [0m
[30;1m49 | [0m[35m        :param str proxy_password: (optional) This parameter is valid only for SOCKS5 servers and sp[0m
[30;1m50 | [0m[35m        """[0m
[30;1m51 | [0m[35m        # TODO: port default[0m
[30;1m52 | [0m[35m        # TODO: is that documentation about auth only being used on SOCKS accurate? Seems inaccurate[0m
[30;1m53 | [0m[35m        (self.proxy_type, self.proxy_type_socks) = _format_proxy_type(proxy_type)[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m.[0m
[30;1m47 | [0m[35m        :param str proxy_username: (optional) username for SOCKS5 proxy, or userid for SOCKS4 proxy.[0m
[30;1m48 | [0m[35m         If it is not provided, authentication will not be used (servers may accept unauthenticated [0m
[30;1m49 | [0m[35m        :param str proxy_password: (optional) This parameter is valid only for SOCKS5 servers and sp[0m
[30;1m50 | [0m[35m        """[0m
[30;1m51 | [0m[35m        # TODO: port default[0m
[30;1m52 | [0m[35m        # TODO: is that documentation about auth only being used on SOCKS accurate? Seems inaccurate[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35m        proxy_address: str,[0m
[30;1m38 | [0m[35m        proxy_port: Optional[int] = None,[0m
[30;1m39 | [0m[35m        proxy_username: Optional[str] = None,[0m
[30;1m40 | [0m[35m        proxy_password: Optional[str] = None,[0m
[30;1m41 | [0m[35m    ):[0m
[30;1m42 | [0m[35m        """[0m
[30;1m43 | [0m[35m        Initializer for proxy options.[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/connection_string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m    shared_access_key_name = d.get(SHARED_ACCESS_KEY_NAME)[0m
[30;1m97 | [0m[35m    shared_access_key = d.get(SHARED_ACCESS_KEY)[0m
[30;1m98 | [0m[35m    device_id = d.get(DEVICE_ID)[0m
[30;1m99 | [0m[35m    x509 = d.get(X509)[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    if shared_access_key and x509 and x509.lower() == "true":[0m
[30;1m102 | [0m[35m        raise ValueError("Invalid Connection String - Mixed authentication scheme")[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/connection_string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m    host_name = d.get(HOST_NAME)[0m
[30;1m96 | [0m[35m    shared_access_key_name = d.get(SHARED_ACCESS_KEY_NAME)[0m
[30;1m97 | [0m[35m    shared_access_key = d.get(SHARED_ACCESS_KEY)[0m
[30;1m98 | [0m[35m    device_id = d.get(DEVICE_ID)[0m
[30;1m99 | [0m[35m    x509 = d.get(X509)[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    if shared_access_key and x509 and x509.lower() == "true":[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/connection_string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m    """Raise ValueError if incorrect combination of keys in dict d"""[0m
[30;1m95 | [0m[35m    host_name = d.get(HOST_NAME)[0m
[30;1m96 | [0m[35m    shared_access_key_name = d.get(SHARED_ACCESS_KEY_NAME)[0m
[30;1m97 | [0m[35m    shared_access_key = d.get(SHARED_ACCESS_KEY)[0m
[30;1m98 | [0m[35m    device_id = d.get(DEVICE_ID)[0m
[30;1m99 | [0m[35m    x509 = d.get(X509)[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/connection_string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35mdef _validate_keys(d):[0m
[30;1m94 | [0m[35m    """Raise ValueError if incorrect combination of keys in dict d"""[0m
[30;1m95 | [0m[35m    host_name = d.get(HOST_NAME)[0m
[30;1m96 | [0m[35m    shared_access_key_name = d.get(SHARED_ACCESS_KEY_NAME)[0m
[30;1m97 | [0m[35m    shared_access_key = d.get(SHARED_ACCESS_KEY)[0m
[30;1m98 | [0m[35m    device_id = d.get(DEVICE_ID)[0m
[30;1m99 | [0m[35m    x509 = d.get(X509)[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/connection_string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35mdef _validate_keys(d):[0m
[30;1m94 | [0m[35m    """Raise ValueError if incorrect combination of keys in dict d"""[0m
[30;1m95 | [0m[35m    host_name = d.get(HOST_NAME)[0m
[30;1m96 | [0m[35m    shared_access_key_name = d.get(SHARED_ACCESS_KEY_NAME)[0m
[30;1m97 | [0m[35m    shared_access_key = d.get(SHARED_ACCESS_KEY)[0m
[30;1m98 | [0m[35m    device_id = d.get(DEVICE_ID)[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/signing_mechanism.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35mimport abc[0m
[30;1m7 | [0m[35mimport base64[0m
[30;1m8 | [0m[35mimport binascii[0m
[30;1m9 | [0m[35mimport hmac[0m
[30;1m10 | [0m[35mimport hashlib[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure_iot_device-3.0.0b2.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m## Using the library[0m
[30;1m63 | [0m[35mYou can view the [**samples repository**](https://github.com/Azure/azure-iot-sdk-python/tree/main/sa[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mFull API documentation for this package is available via [**Microsoft Docs**](https://docs.microsoft[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m## Features[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure_iot_device-3.0.0b2.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mThe Azure IoT Device library is available on PyPI:[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m```Shell[0m
[30;1m56 | [0m[35mpip install azure-iot-device==3.0.0b2[0m
[30;1m57 | [0m[35m```[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mPython 3.7 or higher is required in order to use the library[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure_iot_device-3.0.0b2.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35m## Using the library[0m
[30;1m63 | [0m[35mYou can view the [**samples repository**](https://github.com/Azure/azure-iot-sdk-python/tree/main/sa[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mFull API documentation for this package is available via [**Microsoft Docs**](https://docs.microsoft[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m## Features[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/sastoken.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m162 | [0m[35m            try:[0m
[30;1m163 | [0m[35m                logger.debug("Updating SAS Token...")[0m
[30;1m164 | [0m[35m                self._current_token = await self._generator.generate_sastoken()[0m
[30;1m165 | [0m[35m                logger.debug("SAS Token update succeeded")[0m
[30;1m166 | [0m[35m                # TODO: validate that this is a valid token?[0m
[30;1m167 | [0m[35m                generate_time = self._current_token.expiry_time - self._token_update_margin[0m
[30;1m168 | [0m[35m                async with self._new_sastoken_available:[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/sastoken.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    async def _keep_token_fresh(self):[0m
[30;1m156 | [0m[35m        """Runs indefinitely and will generate a SasToken when the current one gets close to[0m
[30;1m157 | [0m[35m        expiration (based on the update margin)[0m
[30;1m158 | [0m[35m        """[0m
[30;1m159 | [0m[35m        generate_time = self._current_token.expiry_time - self._token_update_margin[0m
[30;1m160 | [0m[35m        while True:[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/sastoken.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35masync def _wait_until(when: float) -> None:[0m
[30;1m250 | [0m[35m    """Wait until a specific time has passed (accurate within 1 second).[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m    :param float when: The time to wait for, in seconds, since epoch[0m
[30;1m253 | [0m[35m    """[0m
[30;1m254 | [0m[35m    while time.time() < when:[0m
[30;1m255 | [0m[35m        await asyncio.sleep(1)[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/sastoken.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m# This would be a candidate for some kind of misc utility module if other similar functions[0m
[30;1m248 | [0m[35m# pop up over the course of development. Until then, it lives here.[0m
[30;1m249 | [0m[35masync def _wait_until(when: float) -> None:[0m
[30;1m250 | [0m[35m    """Wait until a specific time has passed (accurate within 1 second).[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m    :param float when: The time to wait for, in seconds, since epoch[0m
[30;1m253 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/sastoken.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        :param str uri: The URI of the resource you are generating a tokens to access[0m
[30;1m73 | [0m[35m        :param signing_mechanism: The signing mechanism that will be used to sign data[0m
[30;1m74 | [0m[35m        :type signing mechanism: :class:`SigningMechanism`[0m
[30;1m75 | [0m[35m        :param int ttl: Time to live for generated tokens, in seconds (default 3600)[0m
[30;1m76 | [0m[35m        """[0m
[30;1m77 | [0m[35m        self.signing_mechanism = signing_mechanism[0m
[30;1m78 | [0m[35m        self.uri = uri[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/sastoken.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    @property[0m
[30;1m45 | [0m[35m    def expiry_time(self) -> float:[0m
[30;1m46 | [0m[35m        # NOTE: Time is typically expressed in float in Python, even though a[0m
[30;1m47 | [0m[35m        # SAS Token expiry time should be a whole number.[0m
[30;1m48 | [0m[35m        return float(self._token_info["se"])[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/sastoken.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    @property[0m
[30;1m45 | [0m[35m    def expiry_time(self) -> float:[0m
[30;1m46 | [0m[35m        # NOTE: Time is typically expressed in float in Python, even though a[0m
[30;1m47 | [0m[35m        # SAS Token expiry time should be a whole number.[0m
[30;1m48 | [0m[35m        return float(self._token_info["se"])[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/sastoken.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport abc[0m
[30;1m9 | [0m[35mimport asyncio[0m
[30;1m10 | [0m[35mimport logging[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mimport urllib.parse[0m
[30;1m13 | [0m[35mfrom typing import Dict, List, Optional, Awaitable, Callable, cast[0m
[30;1m14 | [0m[35mfrom .custom_typing import FunctionOrCoroutine[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m            hostname=hostname,[0m
[30;1m204 | [0m[35m            device_id=cs_obj[cs.DEVICE_ID],[0m
[30;1m205 | [0m[35m            module_id=cs_obj.get(cs.MODULE_ID),[0m
[30;1m206 | [0m[35m            shared_access_key=cs_obj.get(cs.SHARED_ACCESS_KEY),[0m
[30;1m207 | [0m[35m            ssl_context=ssl_context,[0m
[30;1m208 | [0m[35m            sastoken_ttl=sastoken_ttl,[0m
[30;1m209 | [0m[35m            **kwargs,[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        return cls([0m
[30;1m203 | [0m[35m            hostname=hostname,[0m
[30;1m204 | [0m[35m            device_id=cs_obj[cs.DEVICE_ID],[0m
[30;1m205 | [0m[35m            module_id=cs_obj.get(cs.MODULE_ID),[0m
[30;1m206 | [0m[35m            shared_access_key=cs_obj.get(cs.SHARED_ACCESS_KEY),[0m
[30;1m207 | [0m[35m            ssl_context=ssl_context,[0m
[30;1m208 | [0m[35m            sastoken_ttl=sastoken_ttl,[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m        :raises: TypeError if an invalid keyword argument is provided[0m
[30;1m192 | [0m[35m        """[0m
[30;1m193 | [0m[35m        cs_obj = cs.ConnectionString(connection_string)[0m
[30;1m194 | [0m[35m        if cs_obj.get(cs.X509, "").lower() == "true" and ssl_context is None:[0m
[30;1m195 | [0m[35m            raise ValueError([0m
[30;1m196 | [0m[35m                "Connection string indicates X509 certificate authentication, but no ssl_context pro[0m
[30;1m197 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m425 | [0m[35m    ssl_context = ssl.SSLContext(protocol=ssl.PROTOCOL_TLS_CLIENT)[0m
[30;1m426 | [0m[35m    ssl_context.minimum_version = ssl.TLSVersion.TLSv1_2[0m
[30;1m427 | [0m[35m    ssl_context.verify_mode = ssl.CERT_REQUIRED[0m
[30;1m428 | [0m[35m    ssl_context.check_hostname = True[0m
[30;1m429 | [0m[35m    ssl_context.load_default_certs()[0m
[30;1m430 | [0m[35m    return ssl_context[0m
[30;1m431 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m417 | [0m[35m            hostname=hostname, device_id=device_id, module_id=module_id[0m
[30;1m418 | [0m[35m        )[0m
[30;1m419 | [0m[35m    else:[0m
[30;1m420 | [0m[35m        return "{hostname}/devices/{device_id}".format(hostname=hostname, device_id=device_id)[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35mdef _default_ssl_context() -> ssl.SSLContext:[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m417 | [0m[35m            hostname=hostname, device_id=device_id, module_id=module_id[0m
[30;1m418 | [0m[35m        )[0m
[30;1m419 | [0m[35m    else:[0m
[30;1m420 | [0m[35m        return "{hostname}/devices/{device_id}".format(hostname=hostname, device_id=device_id)[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35mdef _default_ssl_context() -> ssl.SSLContext:[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m417 | [0m[35m            hostname=hostname, device_id=device_id, module_id=module_id[0m
[30;1m418 | [0m[35m        )[0m
[30;1m419 | [0m[35m    else:[0m
[30;1m420 | [0m[35m        return "{hostname}/devices/{device_id}".format(hostname=hostname, device_id=device_id)[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35mdef _default_ssl_context() -> ssl.SSLContext:[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m414 | [0m[35m    """Format the SAS URI for using IoT Hub"""[0m
[30;1m415 | [0m[35m    if module_id:[0m
[30;1m416 | [0m[35m        return "{hostname}/devices/{device_id}/modules/{module_id}".format([0m
[30;1m417 | [0m[35m            hostname=hostname, device_id=device_id, module_id=module_id[0m
[30;1m418 | [0m[35m        )[0m
[30;1m419 | [0m[35m    else:[0m
[30;1m420 | [0m[35m        return "{hostname}/devices/{device_id}".format(hostname=hostname, device_id=device_id)[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m414 | [0m[35m    """Format the SAS URI for using IoT Hub"""[0m
[30;1m415 | [0m[35m    if module_id:[0m
[30;1m416 | [0m[35m        return "{hostname}/devices/{device_id}/modules/{module_id}".format([0m
[30;1m417 | [0m[35m            hostname=hostname, device_id=device_id, module_id=module_id[0m
[30;1m418 | [0m[35m        )[0m
[30;1m419 | [0m[35m    else:[0m
[30;1m420 | [0m[35m        return "{hostname}/devices/{device_id}".format(hostname=hostname, device_id=device_id)[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m413 | [0m[35mdef _format_sas_uri(hostname: str, device_id: str, module_id: Optional[str]) -> str:[0m
[30;1m414 | [0m[35m    """Format the SAS URI for using IoT Hub"""[0m
[30;1m415 | [0m[35m    if module_id:[0m
[30;1m416 | [0m[35m        return "{hostname}/devices/{device_id}/modules/{module_id}".format([0m
[30;1m417 | [0m[35m            hostname=hostname, device_id=device_id, module_id=module_id[0m
[30;1m418 | [0m[35m        )[0m
[30;1m419 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m410 | [0m[35m            raise TypeError("Unsupported keyword argument: '{}'".format(kwarg))[0m
[30;1m411 | [0m[35m[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35mdef _format_sas_uri(hostname: str, device_id: str, module_id: Optional[str]) -> str:[0m
[30;1m414 | [0m[35m    """Format the SAS URI for using IoT Hub"""[0m
[30;1m415 | [0m[35m    if module_id:[0m
[30;1m416 | [0m[35m        return "{hostname}/devices/{device_id}/modules/{module_id}".format([0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m200 | [0m[35m        else:[0m
[30;1m201 | [0m[35m            hostname = cs_obj[cs.HOST_NAME][0m
[30;1m202 | [0m[35m        return cls([0m
[30;1m203 | [0m[35m            hostname=hostname,[0m
[30;1m204 | [0m[35m            device_id=cs_obj[cs.DEVICE_ID],[0m
[30;1m205 | [0m[35m            module_id=cs_obj.get(cs.MODULE_ID),[0m
[30;1m206 | [0m[35m            shared_access_key=cs_obj.get(cs.SHARED_ACCESS_KEY),[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m200 | [0m[35m        else:[0m
[30;1m201 | [0m[35m            hostname = cs_obj[cs.HOST_NAME][0m
[30;1m202 | [0m[35m        return cls([0m
[30;1m203 | [0m[35m            hostname=hostname,[0m
[30;1m204 | [0m[35m            device_id=cs_obj[cs.DEVICE_ID],[0m
[30;1m205 | [0m[35m            module_id=cs_obj.get(cs.MODULE_ID),[0m
[30;1m206 | [0m[35m            shared_access_key=cs_obj.get(cs.SHARED_ACCESS_KEY),[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m198 | [0m[35m        if cs.GATEWAY_HOST_NAME in cs_obj:[0m
[30;1m199 | [0m[35m            hostname = cs_obj[cs.GATEWAY_HOST_NAME][0m
[30;1m200 | [0m[35m        else:[0m
[30;1m201 | [0m[35m            hostname = cs_obj[cs.HOST_NAME][0m
[30;1m202 | [0m[35m        return cls([0m
[30;1m203 | [0m[35m            hostname=hostname,[0m
[30;1m204 | [0m[35m            device_id=cs_obj[cs.DEVICE_ID],[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m196 | [0m[35m                "Connection string indicates X509 certificate authentication, but no ssl_context pro[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m        if cs.GATEWAY_HOST_NAME in cs_obj:[0m
[30;1m199 | [0m[35m            hostname = cs_obj[cs.GATEWAY_HOST_NAME][0m
[30;1m200 | [0m[35m        else:[0m
[30;1m201 | [0m[35m            hostname = cs_obj[cs.HOST_NAME][0m
[30;1m202 | [0m[35m        return cls([0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # Instantiate the MQTTClient[0m
[30;1m98 | [0m[35m        client_config = config.IoTHubClientConfig([0m
[30;1m99 | [0m[35m            hostname=hostname,[0m
[30;1m100 | [0m[35m            device_id=device_id,[0m
[30;1m101 | [0m[35m            module_id=module_id,[0m
[30;1m102 | [0m[35m            sastoken_provider=self._sastoken_provider,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # Instantiate the MQTTClient[0m
[30;1m98 | [0m[35m        client_config = config.IoTHubClientConfig([0m
[30;1m99 | [0m[35m            hostname=hostname,[0m
[30;1m100 | [0m[35m            device_id=device_id,[0m
[30;1m101 | [0m[35m            module_id=module_id,[0m
[30;1m102 | [0m[35m            sastoken_provider=self._sastoken_provider,[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m78 | [0m[35m        # NOTE: Need to keep a reference to the SasTokenProvider so we can stop it during cleanup[0m
[30;1m79 | [0m[35m        self._sastoken_provider: Optional[st.SasTokenProvider][0m
[30;1m80 | [0m[35m        if shared_access_key:[0m
[30;1m81 | [0m[35m            uri = _format_sas_uri(hostname=hostname, device_id=device_id, module_id=module_id)[0m
[30;1m82 | [0m[35m            signing_mechanism = sm.SymmetricKeySigningMechanism(shared_access_key)[0m
[30;1m83 | [0m[35m            generator = st.InternalSasTokenGenerator([0m
[30;1m84 | [0m[35m                signing_mechanism=signing_mechanism, uri=uri, ttl=sastoken_ttl[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m78 | [0m[35m        # NOTE: Need to keep a reference to the SasTokenProvider so we can stop it during cleanup[0m
[30;1m79 | [0m[35m        self._sastoken_provider: Optional[st.SasTokenProvider][0m
[30;1m80 | [0m[35m        if shared_access_key:[0m
[30;1m81 | [0m[35m            uri = _format_sas_uri(hostname=hostname, device_id=device_id, module_id=module_id)[0m
[30;1m82 | [0m[35m            signing_mechanism = sm.SymmetricKeySigningMechanism(shared_access_key)[0m
[30;1m83 | [0m[35m            generator = st.InternalSasTokenGenerator([0m
[30;1m84 | [0m[35m                signing_mechanism=signing_mechanism, uri=uri, ttl=sastoken_ttl[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m37 | [0m[35m        :param str device_id: The device identity for the IoT Hub device containing the[0m
[30;1m38 | [0m[35m            IoT Hub module[0m
[30;1m39 | [0m[35m        :param str module_id: The module identity for the IoT Hub module[0m
[30;1m40 | [0m[35m        :param str hostname: Hostname of the IoT Hub or IoT Edge the device should connect to[0m
[30;1m41 | [0m[35m        :param ssl_context: Custom SSL context to be used when establishing a connection.[0m
[30;1m42 | [0m[35m            If not provided, a default one will be used[0m
[30;1m43 | [0m[35m        :type ssl_context: :class:`ssl.SSLContext`[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m24 | [0m[35m    def __init__([0m
[30;1m25 | [0m[35m        self,[0m
[30;1m26 | [0m[35m        *,[0m
[30;1m27 | [0m[35m        hostname: str,  # iothub_hostname?[0m
[30;1m28 | [0m[35m        device_id: str,[0m
[30;1m29 | [0m[35m        module_id: Optional[str] = None,[0m
[30;1m30 | [0m[35m        ssl_context: Optional[ssl.SSLContext] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m24 | [0m[35m    def __init__([0m
[30;1m25 | [0m[35m        self,[0m
[30;1m26 | [0m[35m        *,[0m
[30;1m27 | [0m[35m        hostname: str,  # iothub_hostname?[0m
[30;1m28 | [0m[35m        device_id: str,[0m
[30;1m29 | [0m[35m        module_id: Optional[str] = None,[0m
[30;1m30 | [0m[35m        ssl_context: Optional[ssl.SSLContext] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m            If not provided, a default one will be used[0m
[30;1m176 | [0m[35m        :type ssl_context: :class:`ssl.SSLContext`[0m
[30;1m177 | [0m[35m        :param sastoken_ttl: Time-to-live (in seconds) for SAS tokens used for authentication.[0m
[30;1m178 | [0m[35m            A new Session will need to be created once this time expires.[0m
[30;1m179 | [0m[35m            Default is 3600 seconds (1 hour).[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        :keyword int keep_alive: Maximum period in seconds between MQTT communications. If no[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m            a SAS token string when invoked[0m
[30;1m47 | [0m[35m        :param sastoken_ttl: Time-to-live (in seconds) for SAS tokens generated when using[0m
[30;1m48 | [0m[35m            'shared_access_key' authentication.[0m
[30;1m49 | [0m[35m            If using this auth type, a new Session will need to be created once this time expires.[0m
[30;1m50 | [0m[35m            Default is 3600 seconds (1 hour).[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        :keyword int keep_alive: Maximum period in seconds between MQTT communications. If no[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m272 | [0m[35m        :raises: CancelledError if enabling responses from IoT Hub is cancelled by network failure[0m
[30;1m273 | [0m[35m        """[0m
[30;1m274 | [0m[35m        if not self._mqtt_client.connected:[0m
[30;1m275 | [0m[35m            # See NOTE 1 at the bottom of this file for why this occurs[0m
[30;1m276 | [0m[35m            raise mqtt.MQTTError(rc=4)[0m
[30;1m277 | [0m[35m        return await self._add_disconnect_interrupt_to_coroutine(self._mqtt_client.get_twin())[0m
[30;1m278 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m257 | [0m[35m        :raises: CancelledError if enabling responses from IoT Hub is cancelled by network failure[0m
[30;1m258 | [0m[35m        """[0m
[30;1m259 | [0m[35m        if not self._mqtt_client.connected:[0m
[30;1m260 | [0m[35m            # See NOTE 1 at the bottom of this file for why this occurs[0m
[30;1m261 | [0m[35m            raise mqtt.MQTTError(rc=4)[0m
[30;1m262 | [0m[35m        await self._add_disconnect_interrupt_to_coroutine(self._mqtt_client.send_twin_patch(patch))[0m
[30;1m263 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m240 | [0m[35m        :raises: ValueError if the size of the DirectMethodResponse payload is too large[0m
[30;1m241 | [0m[35m        """[0m
[30;1m242 | [0m[35m        if not self._mqtt_client.connected:[0m
[30;1m243 | [0m[35m            # See NOTE 1 at the bottom of this file for why this occurs[0m
[30;1m244 | [0m[35m            raise mqtt.MQTTError(rc=4)[0m
[30;1m245 | [0m[35m        await self._add_disconnect_interrupt_to_coroutine([0m
[30;1m246 | [0m[35m            self._mqtt_client.send_direct_method_response(method_response)[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_session.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m221 | [0m[35m        :raises: RuntimeError if not connected when invoked[0m
[30;1m222 | [0m[35m        """[0m
[30;1m223 | [0m[35m        if not self._mqtt_client.connected:[0m
[30;1m224 | [0m[35m            # See NOTE 1 at the bottom of this file for why this occurs[0m
[30;1m225 | [0m[35m            raise mqtt.MQTTError(rc=4)[0m
[30;1m226 | [0m[35m        if not isinstance(message, models.Message):[0m
[30;1m227 | [0m[35m            message = models.Message(message)[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/edge_hsm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m        )[0m
[30;1m107 | [0m[35m        sign_request = {"keyId": "primary", "algo": "HMACSHA256", "data": encoded_data_str}[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m        r = requests.post(  # can we use json field instead of data?[0m
[30;1m110 | [0m[35m            url=path,[0m
[30;1m111 | [0m[35m            params={"api-version": self.api_version},[0m
[30;1m112 | [0m[35m            headers={"User-Agent": urllib.parse.quote(user_agent.get_iothub_user_agent(), safe="")},[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/edge_hsm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        :raises: IoTEdgeError if unable to retrieve the certificate.[0m
[30;1m60 | [0m[35m        """[0m
[30;1m61 | [0m[35m        r = requests.get([0m
[30;1m62 | [0m[35m            self.workload_uri + "trust-bundle",[0m
[30;1m63 | [0m[35m            params={"api-version": self.api_version},[0m
[30;1m64 | [0m[35m            headers={"User-Agent": urllib.parse.quote_plus(user_agent.get_iothub_user_agent())},[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/edge_hsm.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m    at the end.[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    If the socket URI does not start with unix:// this function only adds[0m
[30;1m147 | [0m[35m    a slash at the end.[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    :param old_uri: The URI in IOTEDGE_WORKLOADURI form[0m
[30;1m150 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/edge_hsm.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m141 | [0m[35m    "http+unix://%2Fvar%2Frun%2Fiotedge%2Fworkload.sock/"[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    The function changes the prefix, uri-encodes the path, and adds a slash[0m
[30;1m144 | [0m[35m    at the end.[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    If the socket URI does not start with unix:// this function only adds[0m
[30;1m147 | [0m[35m    a slash at the end.[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/edge_hsm.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m# Licensed under the MIT License. See License.txt in the project root for[0m
[30;1m4 | [0m[35m# license information.[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35mimport base64[0m
[30;1m7 | [0m[35mimport logging[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport requests  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m[0m
[30;1m474 | [0m[35m        async def message_generator() -> AsyncGenerator[mqtt.MQTTMessage, None]:[0m
[30;1m475 | [0m[35m            while True:[0m
[30;1m476 | [0m[35m                yield await incoming_messages.get()[0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m        return message_generator()[0m
[30;1m479 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m558 | [0m[35m                None,[0m
[30;1m559 | [0m[35m                functools.partial([0m
[30;1m560 | [0m[35m                    self._mqtt_client.connect,[0m
[30;1m561 | [0m[35m                    host=self._hostname,[0m
[30;1m562 | [0m[35m                    port=self._port,[0m
[30;1m563 | [0m[35m                    keepalive=self._keep_alive,[0m
[30;1m564 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m        # Paho Connect[0m
[30;1m553 | [0m[35m        logger.debug([0m
[30;1m554 | [0m[35m            "Attempting connect to host {} using port {}...".format(self._hostname, self._port)[0m
[30;1m555 | [0m[35m        )[0m
[30;1m556 | [0m[35m        try:[0m
[30;1m557 | [0m[35m            rc = await self._event_loop.run_in_executor([0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m103 | [0m[35m        :type proxy_options: :class:`azure.iot.device.common.ProxyOptions`[0m
[30;1m104 | [0m[35m        """[0m
[30;1m105 | [0m[35m        # Configuration[0m
[30;1m106 | [0m[35m        self._hostname = hostname[0m
[30;1m107 | [0m[35m        self._port = port[0m
[30;1m108 | [0m[35m        self._keep_alive = keep_alive[0m
[30;1m109 | [0m[35m        self._auto_reconnect = auto_reconnect[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m103 | [0m[35m        :type proxy_options: :class:`azure.iot.device.common.ProxyOptions`[0m
[30;1m104 | [0m[35m        """[0m
[30;1m105 | [0m[35m        # Configuration[0m
[30;1m106 | [0m[35m        self._hostname = hostname[0m
[30;1m107 | [0m[35m        self._port = port[0m
[30;1m108 | [0m[35m        self._keep_alive = keep_alive[0m
[30;1m109 | [0m[35m        self._auto_reconnect = auto_reconnect[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m88 | [0m[35m        Constructor to instantiate client.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        :param str client_id: The id of the client connecting to the broker.[0m
[30;1m91 | [0m[35m        :param str hostname: Hostname or IP address of the remote broker.[0m
[30;1m92 | [0m[35m        :param int port: Network port to connect to[0m
[30;1m93 | [0m[35m        :param str transport: "tcp" for TCP or "websockets" for WebSockets.[0m
[30;1m94 | [0m[35m        :param int keep_alive: Number of seconds before connection timeout.[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m74 | [0m[35m    def __init__([0m
[30;1m75 | [0m[35m        self,[0m
[30;1m76 | [0m[35m        client_id: str,[0m
[30;1m77 | [0m[35m        hostname: str,[0m
[30;1m78 | [0m[35m        port: int,[0m
[30;1m79 | [0m[35m        transport: str = "tcp",[0m
[30;1m80 | [0m[35m        keep_alive: int = 60,[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m593 | [0m[35m        #[0m
[30;1m594 | [0m[35m        # However, in the case of a cancelled connect, it's likely that none of those conditions[0m
[30;1m595 | [0m[35m        # will be met, and thus the network loop will persist.[0m
[30;1m596 | [0m[35m        # This is fine, since it'll eventually get cleaned up, as at the very least, a[0m
[30;1m597 | [0m[35m        # .disconnect() invocation is required for graceful exit, if not sooner.[0m
[30;1m598 | [0m[35m        #[0m
[30;1m599 | [0m[35m        # But, this does introduce a case where the network loop may already be running[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m486 | [0m[35m        # Wait for permission to alter the connection[0m
[30;1m487 | [0m[35m        async with self._connection_lock:[0m
[30;1m488 | [0m[35m            # NOTE: It's not generally safe to use .is_connected() to determine what to do, since[0m
[30;1m489 | [0m[35m            # the value could change at any time. However, it IS safe to do so here. The only way[0m
[30;1m490 | [0m[35m            # to become connected is to invoke a Paho .connect() and wait for a success. Due to the[0m
[30;1m491 | [0m[35m            # fact that this is the only method that can invoke Paho's .connect(), it does not[0m
[30;1m492 | [0m[35m            # return until a response is received, and it is protected by the ConnectionLock,[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m    async def connect(self) -> None:[0m
[30;1m481 | [0m[35m        """[0m
[30;1m482 | [0m[35m        Connect to the MQTT broker using details set at instantiation.[0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m        :raises: MQTTConnectionFailedError if there is a failure connecting[0m
[30;1m485 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m385 | [0m[35m        """[0m
[30;1m386 | [0m[35m        Returns a boolean indicating whether the MQTT client is currently connected.[0m
[30;1m387 | [0m[35m[0m
[30;1m388 | [0m[35m        Note that this value is only accurate as of the time it returns. It could change at[0m
[30;1m389 | [0m[35m        any point.[0m
[30;1m390 | [0m[35m        """[0m
[30;1m391 | [0m[35m        return self._connected[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m217 | [0m[35m            rc_msg = mqtt.error_string(rc)[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m            # NOTE: It's not generally safe to use .is_connected() to determine what to do, since[0m
[30;1m220 | [0m[35m            # the value could change at any time. However, it IS safe to do so here.[0m
[30;1m221 | [0m[35m            # This handler, as well as .on_connect() above, are the only two functions that can[0m
[30;1m222 | [0m[35m            # change the value. They are both invoked on Paho's network loop, which is[0m
[30;1m223 | [0m[35m            # single-threaded. This means there cannot be overlapping invocations that would[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m68 | [0m[35m    """[0m
[30;1m69 | [0m[35m    Provides an async MQTT message broker interface[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    This client currently only supports operations at a QoS (Quality of Service) of 1[0m
[30;1m72 | [0m[35m    """[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    def __init__([0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m787 | [0m[35m        :param str topic: topic: The topic that the message should be published on.[0m
[30;1m788 | [0m[35m        :param payload: The actual message to send.[0m
[30;1m789 | [0m[35m        :type payload: str, bytes, int, float or None[0m
[30;1m790 | [0m[35m        :param int qos: the desired quality of service level for the subscription. Defaults to 1.[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m        :raises: ValueError if topic is None or has zero string length[0m
[30;1m793 | [0m[35m        :raises: ValueError if topic contains a wildcard ("+")[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m675 | [0m[35m                    # In this implementation, it should only happen if Paho's inner state[0m
[30;1m676 | [0m[35m                    # indicates we would like to be connected, but we actually aren't.[0m
[30;1m677 | [0m[35m                    # We still want to do this disconnect however, because doing so changes[0m
[30;1m678 | [0m[35m                    # Paho's state to indicate we no longer wish to be connected.[0m
[30;1m679 | [0m[35m                    logger.debug("Early disconnect return (Already disconnected)")[0m
[30;1m680 | [0m[35m                    logger.debug("Clearing network loop task")[0m
[30;1m681 | [0m[35m                    self._network_loop = None[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m635 | [0m[35m        # Wait for permission to alter the connection[0m
[30;1m636 | [0m[35m        async with self._connection_lock:[0m
[30;1m637 | [0m[35m[0m
[30;1m638 | [0m[35m            # We no longer wish to be connected[0m
[30;1m639 | [0m[35m            self._desire_connection = False[0m
[30;1m640 | [0m[35m[0m
[30;1m641 | [0m[35m            # Cancel reconnection attempts[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m457 | [0m[35m        """[0m
[30;1m458 | [0m[35m        Return a generator that yields incoming messages[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        :param str filter_topic: The topic you wish to receive a generator for.[0m
[30;1m461 | [0m[35m            If not provided, will return a generator for non-filtered messages[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m        :raises: ValueError if a filter is not already applied for the given topic[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m438 | [0m[35m        """[0m
[30;1m439 | [0m[35m        Stop filtering incoming messages on a specific topic[0m
[30;1m440 | [0m[35m[0m
[30;1m441 | [0m[35m        :param str topic: The topic you wish to stop filtering on[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m        :raises: ValueError if a filter is not already applied for the topic[0m
[30;1m444 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m413 | [0m[35m        """[0m
[30;1m414 | [0m[35m        Filter incoming messages on a specific topic.[0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m        :param str topic: The topic you wish to filter on[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m        :raises: ValueError if a filter is already applied for the topic[0m
[30;1m419 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m385 | [0m[35m        """[0m
[30;1m386 | [0m[35m        Returns a boolean indicating whether the MQTT client is currently connected.[0m
[30;1m387 | [0m[35m[0m
[30;1m388 | [0m[35m        Note that this value is only accurate as of the time it returns. It could change at[0m
[30;1m389 | [0m[35m        any point.[0m
[30;1m390 | [0m[35m        """[0m
[30;1m391 | [0m[35m        return self._connected[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m                else:[0m
[30;1m235 | [0m[35m                    # Double disconnect. Suppress.[0m
[30;1m236 | [0m[35m                    # Sometimes Paho disconnects twice. Why? Who knows.[0m
[30;1m237 | [0m[35m                    # But we don't wish to issue spurious notifications or other behaviors[0m
[30;1m238 | [0m[35m                    logger.debug("Double Disconnect Response: rc {} - {}".format(rc, rc_msg))[0m
[30;1m239 | [0m[35m            else:[0m
[30;1m240 | [0m[35m                if rc == mqtt.MQTT_ERR_SUCCESS:[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m                if rc == mqtt.MQTT_ERR_CONN_REFUSED:[0m
[30;1m228 | [0m[35m                    # When Paho receives a failure response to a connect, the disconnect[0m
[30;1m229 | [0m[35m                    # handler is also called.[0m
[30;1m230 | [0m[35m                    # But we don't wish to issue spurious notifications or other behaviors[0m
[30;1m231 | [0m[35m                    logger.debug([0m
[30;1m232 | [0m[35m                        "Connect Failure Disconnect Response: rc {} - {}".format(rc, rc_msg)[0m
[30;1m233 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        Constructor to instantiate client.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        :param str client_id: The id of the client connecting to the broker.[0m
[30;1m91 | [0m[35m        :param str hostname: Hostname or IP address of the remote broker.[0m
[30;1m92 | [0m[35m        :param int port: Network port to connect to[0m
[30;1m93 | [0m[35m        :param str transport: "tcp" for TCP or "websockets" for WebSockets.[0m
[30;1m94 | [0m[35m        :param int keep_alive: Number of seconds before connection timeout.[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# NOTE: Paho can return a lot of rc values. However, most of them shouldn't happen.[0m
[30;1m21 | [0m[35m# Here are the ones that we can expect for each method.[0m
[30;1m22 | [0m[35mexpected_connect_rc = [mqtt.MQTT_ERR_SUCCESS][0m
[30;1m23 | [0m[35mexpected_disconnect_rc = [mqtt.MQTT_ERR_SUCCESS, mqtt.MQTT_ERR_NO_CONN][0m
[30;1m24 | [0m[35mexpected_subscribe_rc = [mqtt.MQTT_ERR_SUCCESS, mqtt.MQTT_ERR_NO_CONN][0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_topic_iothub.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m    parts = topic.split("/")[0m
[30;1m250 | [0m[35m    if topic.startswith("$iothub/twin/res/") and len(parts) >= 4:[0m
[30;1m251 | [0m[35m        properties = _extract_properties(topic.split("?")[1])[0m
[30;1m252 | [0m[35m        rid = properties.get("$rid")[0m
[30;1m253 | [0m[35m        if not rid:[0m
[30;1m254 | [0m[35m            raise ValueError("No request id in topic")[0m
[30;1m255 | [0m[35m        return rid[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_topic_iothub.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m    parts = topic.split("/")[0m
[30;1m212 | [0m[35m    if topic.startswith("$iothub/methods/POST") and len(parts) >= 4:[0m
[30;1m213 | [0m[35m        properties = _extract_properties(topic.split("?")[1])[0m
[30;1m214 | [0m[35m        rid = properties.get("$rid")[0m
[30;1m215 | [0m[35m        if not rid:[0m
[30;1m216 | [0m[35m            raise ValueError("No request id in topic")[0m
[30;1m217 | [0m[35m        return rid[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_topic_iothub.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m# NOTE: This is duplicated from mqtt_topic_provisioning. If changing, change there too.[0m
[30;1m261 | [0m[35m# Consider putting this in a separate module at some point.[0m
[30;1m262 | [0m[35mdef _extract_properties(properties_str: str) -> Dict[str, str]:[0m
[30;1m263 | [0m[35m    """Return a dictionary of properties from a string in the format[0m
[30;1m264 | [0m[35m    {key1}={value1}&{key2}={value2}...&{keyn}={valuen}[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_topic_iothub.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mdef _get_topic_base(device_id: str, module_id: Optional[str] = None) -> str:[0m
[30;1m39 | [0m[35m    """[0m
[30;1m40 | [0m[35m    return the string that is at the beginning of all topics for this[0m
[30;1m41 | [0m[35m    device/module[0m
[30;1m42 | [0m[35m    """[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m            headers[HEADER_AUTHORIZATION] = str(self._sastoken_provider.get_current_sastoken())[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m        logger.debug("Sending blob upload notification to IoTHub...")[0m
[30;1m236 | [0m[35m        async with self._session.post([0m
[30;1m237 | [0m[35m            url=path,[0m
[30;1m238 | [0m[35m            json=data,[0m
[30;1m239 | [0m[35m            params=query_params,[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m            headers[HEADER_AUTHORIZATION] = str(self._sastoken_provider.get_current_sastoken())[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        logger.debug("Sending storage info request to IoTHub...")[0m
[30;1m184 | [0m[35m        async with self._session.post([0m
[30;1m185 | [0m[35m            url=path,[0m
[30;1m186 | [0m[35m            json=data,[0m
[30;1m187 | [0m[35m            params=query_params,[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m                device_id=device_id, module_id=module_id[0m
[30;1m133 | [0m[35m            )[0m
[30;1m134 | [0m[35m        )[0m
[30;1m135 | [0m[35m        async with self._session.post([0m
[30;1m136 | [0m[35m            url=path,[0m
[30;1m137 | [0m[35m            json=method_params,[0m
[30;1m138 | [0m[35m            params=query_params,[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m    timeout = aiohttp.ClientTimeout(total=HTTP_TIMEOUT)[0m
[30;1m271 | [0m[35m    session = aiohttp.ClientSession(base_url=base_url, timeout=timeout)[0m
[30;1m272 | [0m[35m    logger.debug([0m
[30;1m273 | [0m[35m        "Creating HTTP Session for {url} with timeout of {timeout}".format([0m
[30;1m274 | [0m[35m            url=base_url, timeout=timeout.total[0m
[30;1m275 | [0m[35m        )[0m
[30;1m276 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35mdef _create_client_session(hostname: str) -> aiohttp.ClientSession:[0m
[30;1m268 | [0m[35m    """Create and return a aiohttp ClientSession object"""[0m
[30;1m269 | [0m[35m    base_url = "https://{hostname}".format(hostname=hostname)[0m
[30;1m270 | [0m[35m    timeout = aiohttp.ClientTimeout(total=HTTP_TIMEOUT)[0m
[30;1m271 | [0m[35m    session = aiohttp.ClientSession(base_url=base_url, timeout=timeout)[0m
[30;1m272 | [0m[35m    logger.debug([0m
[30;1m273 | [0m[35m        "Creating HTTP Session for {url} with timeout of {timeout}".format([0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35mdef _create_client_session(hostname: str) -> aiohttp.ClientSession:[0m
[30;1m268 | [0m[35m    """Create and return a aiohttp ClientSession object"""[0m
[30;1m269 | [0m[35m    base_url = "https://{hostname}".format(hostname=hostname)[0m
[30;1m270 | [0m[35m    timeout = aiohttp.ClientTimeout(total=HTTP_TIMEOUT)[0m
[30;1m271 | [0m[35m    session = aiohttp.ClientSession(base_url=base_url, timeout=timeout)[0m
[30;1m272 | [0m[35m    logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35mdef _create_client_session(hostname: str) -> aiohttp.ClientSession:[0m
[30;1m268 | [0m[35m    """Create and return a aiohttp ClientSession object"""[0m
[30;1m269 | [0m[35m    base_url = "https://{hostname}".format(hostname=hostname)[0m
[30;1m270 | [0m[35m    timeout = aiohttp.ClientTimeout(total=HTTP_TIMEOUT)[0m
[30;1m271 | [0m[35m    session = aiohttp.ClientSession(base_url=base_url, timeout=timeout)[0m
[30;1m272 | [0m[35m    logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35mdef _create_client_session(hostname: str) -> aiohttp.ClientSession:[0m
[30;1m268 | [0m[35m    """Create and return a aiohttp ClientSession object"""[0m
[30;1m269 | [0m[35m    base_url = "https://{hostname}".format(hostname=hostname)[0m
[30;1m270 | [0m[35m    timeout = aiohttp.ClientTimeout(total=HTTP_TIMEOUT)[0m
[30;1m271 | [0m[35m    session = aiohttp.ClientSession(base_url=base_url, timeout=timeout)[0m
[30;1m272 | [0m[35m    logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m264 | [0m[35m        return None[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35mdef _create_client_session(hostname: str) -> aiohttp.ClientSession:[0m
[30;1m268 | [0m[35m    """Create and return a aiohttp ClientSession object"""[0m
[30;1m269 | [0m[35m    base_url = "https://{hostname}".format(hostname=hostname)[0m
[30;1m270 | [0m[35m    timeout = aiohttp.ClientTimeout(total=HTTP_TIMEOUT)[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m77 | [0m[35m            logger.warning("Proxy use with .get_storage_info_for_blob() not supported")[0m
[30;1m78 | [0m[35m            logger.warning("Proxy use with .notify_blob_upload_status() not supported")[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        self._session = _create_client_session(client_config.hostname)[0m
[30;1m81 | [0m[35m        self._ssl_context = client_config.ssl_context[0m
[30;1m82 | [0m[35m        self._sastoken_provider = client_config.sastoken_provider[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_http_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m72 | [0m[35m        # The built in per-request proxy of aiohttp is only partly functional, so I decided to[0m
[30;1m73 | [0m[35m        # not even bother implementing it, if it only does half the job.[0m
[30;1m74 | [0m[35m        if client_config.proxy_options:[0m
[30;1m75 | [0m[35m            # TODO: these warnings should probably be at API level[0m
[30;1m76 | [0m[35m            logger.warning("Proxy use with .invoke_direct_method() not supported")[0m
[30;1m77 | [0m[35m            logger.warning("Proxy use with .get_storage_info_for_blob() not supported")[0m
[30;1m78 | [0m[35m            logger.warning("Proxy use with .notify_blob_upload_status() not supported")[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m658 | [0m[35m    properties = mqtt_topic.extract_properties_from_message_topic(mqtt_message.topic)[0m
[30;1m659 | [0m[35m    # Decode the payload based on content encoding in the topic. If not present, use utf-8[0m
[30;1m660 | [0m[35m    content_encoding = properties.get("$.ce", "utf-8")[0m
[30;1m661 | [0m[35m    content_type = properties.get("$.ct", "text/plain")[0m
[30;1m662 | [0m[35m    payload = mqtt_message.payload.decode(content_encoding)[0m
[30;1m663 | [0m[35m    if content_type == "application/json":[0m
[30;1m664 | [0m[35m        payload = json.loads(payload)[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m657 | [0m[35m    """Given an MQTTMessage, create and return a Message"""[0m
[30;1m658 | [0m[35m    properties = mqtt_topic.extract_properties_from_message_topic(mqtt_message.topic)[0m
[30;1m659 | [0m[35m    # Decode the payload based on content encoding in the topic. If not present, use utf-8[0m
[30;1m660 | [0m[35m    content_encoding = properties.get("$.ce", "utf-8")[0m
[30;1m661 | [0m[35m    content_type = properties.get("$.ct", "text/plain")[0m
[30;1m662 | [0m[35m    payload = mqtt_message.payload.decode(content_encoding)[0m
[30;1m663 | [0m[35m    if content_type == "application/json":[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m646 | [0m[35m    # See the repo wiki article for details:[0m
[30;1m647 | [0m[35m    # https://github.com/Azure/azure-iot-sdk-python/wiki/URL-Encoding-(MQTT)[0m
[30;1m648 | [0m[35m    username = "{hostname}/{client_id}/?{query_params}".format([0m
[30;1m649 | [0m[35m        hostname=hostname,[0m
[30;1m650 | [0m[35m        client_id=client_id,[0m
[30;1m651 | [0m[35m        query_params=urllib.parse.urlencode(query_param_seq, quote_via=urllib.parse.quote),[0m
[30;1m652 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m646 | [0m[35m    # See the repo wiki article for details:[0m
[30;1m647 | [0m[35m    # https://github.com/Azure/azure-iot-sdk-python/wiki/URL-Encoding-(MQTT)[0m
[30;1m648 | [0m[35m    username = "{hostname}/{client_id}/?{query_params}".format([0m
[30;1m649 | [0m[35m        hostname=hostname,[0m
[30;1m650 | [0m[35m        client_id=client_id,[0m
[30;1m651 | [0m[35m        query_params=urllib.parse.urlencode(query_param_seq, quote_via=urllib.parse.quote),[0m
[30;1m652 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m645 | [0m[35m    # keys and values URL encoded.[0m
[30;1m646 | [0m[35m    # See the repo wiki article for details:[0m
[30;1m647 | [0m[35m    # https://github.com/Azure/azure-iot-sdk-python/wiki/URL-Encoding-(MQTT)[0m
[30;1m648 | [0m[35m    username = "{hostname}/{client_id}/?{query_params}".format([0m
[30;1m649 | [0m[35m        hostname=hostname,[0m
[30;1m650 | [0m[35m        client_id=client_id,[0m
[30;1m651 | [0m[35m        query_params=urllib.parse.urlencode(query_param_seq, quote_via=urllib.parse.quote),[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m640 | [0m[35m        )[0m
[30;1m641 | [0m[35m[0m
[30;1m642 | [0m[35m    # NOTE: Client ID (including the device and/or module ids that are in it)[0m
[30;1m643 | [0m[35m    # is NOT url encoded as part of the username. Neither is the hostname.[0m
[30;1m644 | [0m[35m    # The sequence of key/value property pairs (query_param_seq) however, MUST have all[0m
[30;1m645 | [0m[35m    # keys and values URL encoded.[0m
[30;1m646 | [0m[35m    # See the repo wiki article for details:[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m625 | [0m[35m    return client[0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m[0m
[30;1m628 | [0m[35mdef _format_username(hostname: str, client_id: str, product_info: str) -> str:[0m
[30;1m629 | [0m[35m    query_param_seq = [][0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m    # Apply query parameters (i.e. key1=value1&key2=value2...&keyN=valueN format)[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m    client = mqtt.MQTTClient([0m
[30;1m613 | [0m[35m        client_id=client_id,[0m
[30;1m614 | [0m[35m        hostname=client_config.hostname,[0m
[30;1m615 | [0m[35m        port=port,[0m
[30;1m616 | [0m[35m        transport=transport,[0m
[30;1m617 | [0m[35m        keep_alive=client_config.keep_alive,[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m    client = mqtt.MQTTClient([0m
[30;1m613 | [0m[35m        client_id=client_id,[0m
[30;1m614 | [0m[35m        hostname=client_config.hostname,[0m
[30;1m615 | [0m[35m        port=port,[0m
[30;1m616 | [0m[35m        transport=transport,[0m
[30;1m617 | [0m[35m        keep_alive=client_config.keep_alive,[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m591 | [0m[35m) -> mqtt.MQTTClient:[0m
[30;1m592 | [0m[35m    logger.debug("Creating MQTTClient")[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m    logger.debug("Using {} as hostname".format(client_config.hostname))[0m
[30;1m595 | [0m[35m[0m
[30;1m596 | [0m[35m    if client_config.module_id:[0m
[30;1m597 | [0m[35m        logger.debug("Using IoTHub Module. Client ID is {}".format(client_id))[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m591 | [0m[35m) -> mqtt.MQTTClient:[0m
[30;1m592 | [0m[35m    logger.debug("Creating MQTTClient")[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m    logger.debug("Using {} as hostname".format(client_config.hostname))[0m
[30;1m595 | [0m[35m[0m
[30;1m596 | [0m[35m    if client_config.module_id:[0m
[30;1m597 | [0m[35m        logger.debug("Using IoTHub Module. Client ID is {}".format(client_id))[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m46 | [0m[35m        self._module_id = client_config.module_id[0m
[30;1m47 | [0m[35m        self._client_id = _format_client_id(self._device_id, self._module_id)[0m
[30;1m48 | [0m[35m        self._username = _format_username([0m
[30;1m49 | [0m[35m            hostname=client_config.hostname,[0m
[30;1m50 | [0m[35m            client_id=self._client_id,[0m
[30;1m51 | [0m[35m            product_info=client_config.product_info,[0m
[30;1m52 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m46 | [0m[35m        self._module_id = client_config.module_id[0m
[30;1m47 | [0m[35m        self._client_id = _format_client_id(self._device_id, self._module_id)[0m
[30;1m48 | [0m[35m        self._username = _format_username([0m
[30;1m49 | [0m[35m            hostname=client_config.hostname,[0m
[30;1m50 | [0m[35m            client_id=self._client_id,[0m
[30;1m51 | [0m[35m            product_info=client_config.product_info,[0m
[30;1m52 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/iothub_mqtt_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m20 | [0m[35mfrom . import mqtt_client as mqtt[0m
[30;1m21 | [0m[35mfrom . import mqtt_topic_iothub as mqtt_topic[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# TODO: update docstrings with correct class paths once repo structured better[0m
[30;1m24 | [0m[35m# TODO: If we're truly done with keeping SAS credentials fresh, we don't need to use SasTokenProvide[0m
[30;1m25 | [0m[35m# and we could just simply use a single token or generator instead.[0m
[30;1m26 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/mqtt_topic_provisioning.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m# NOTE: This is duplicated from mqtt_topic_iothub. If changing, change there too.[0m
[30;1m89 | [0m[35m# Consider putting this in a separate module at some point.[0m
[30;1m90 | [0m[35mdef _extract_properties(properties_str: str) -> Dict[str, str]:[0m
[30;1m91 | [0m[35m    """Return a dictionary of properties from a string in the format[0m
[30;1m92 | [0m[35m    {key1}={value1}&{key2}={value2}...&{keyn}={valuen}[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m.hostname[0m
[30;1m94 | [0m[35m            if a firewall blocks port 8883 from use.[0m
[30;1m95 | [0m[35m        """[0m
[30;1m96 | [0m[35m        # Network[0m
[30;1m97 | [0m[35m        self.hostname = hostname[0m
[30;1m98 | [0m[35m        self.proxy_options = proxy_options[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # Auth[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m.hostname[0m
[30;1m94 | [0m[35m            if a firewall blocks port 8883 from use.[0m
[30;1m95 | [0m[35m        """[0m
[30;1m96 | [0m[35m        # Network[0m
[30;1m97 | [0m[35m        self.hostname = hostname[0m
[30;1m98 | [0m[35m        self.proxy_options = proxy_options[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # Auth[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m.hostname[0m
[30;1m79 | [0m[35m    ) -> None:[0m
[30;1m80 | [0m[35m        """Initializer for ClientConfig[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        :param str hostname: The hostname being connected to[0m
[30;1m83 | [0m[35m        :param sastoken_provider: Object that can provide SasTokens[0m
[30;1m84 | [0m[35m        :type sastoken_provider: :class:`SasTokenProvider`[0m
[30;1m85 | [0m[35m        :param proxy_options: Details of proxy configuration[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m.hostname[0m
[30;1m79 | [0m[35m    ) -> None:[0m
[30;1m80 | [0m[35m        """Initializer for ClientConfig[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        :param str hostname: The hostname being connected to[0m
[30;1m83 | [0m[35m        :param sastoken_provider: Object that can provide SasTokens[0m
[30;1m84 | [0m[35m        :type sastoken_provider: :class:`SasTokenProvider`[0m
[30;1m85 | [0m[35m        :param proxy_options: Details of proxy configuration[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m.hostname[0m
[30;1m70 | [0m[35m        self,[0m
[30;1m71 | [0m[35m        *,[0m
[30;1m72 | [0m[35m        ssl_context: ssl.SSLContext,[0m
[30;1m73 | [0m[35m        hostname: str,[0m
[30;1m74 | [0m[35m        sastoken_provider: Optional[SasTokenProvider] = None,[0m
[30;1m75 | [0m[35m        proxy_options: Optional[ProxyOptions] = None,[0m
[30;1m76 | [0m[35m        keep_alive: int = 60,[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35mfrom .sastoken import SasTokenProvider[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# TODO: add typings for imports[0m
[30;1m14 | [0m[35m# TODO: update docs to ensure types are correct[0m
[30;1m15 | [0m[35m# TODO: can these just be TypeDicts?[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m        Config object used for Provisioning clients, containing all relevant details and options.[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        :param str registration_id: The device registration identity being provisioned[0m
[30;1m140 | [0m[35m        :param str id_scope: The identity of the provisioning service being used[0m
[30;1m141 | [0m[35m        """[0m
[30;1m142 | [0m[35m        self.registration_id = registration_id[0m
[30;1m143 | [0m[35m        self.id_scope = id_scope[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35mme: Optional[str] = None,[0m
[30;1m40 | [0m[35m        proxy_password: Optional[str] = None,[0m
[30;1m41 | [0m[35m    ):[0m
[30;1m42 | [0m[35m        """[0m
[30;1m43 | [0m[35m        Initializer for proxy options.[0m
[30;1m44 | [0m[35m        :param str proxy_type: The type of the proxy server. This can be one of three possible choic[0m
[30;1m45 | [0m[35m        :param str proxy_addr: IP address or DNS name of proxy server[0m
[30;1m46 | [0m[35m        :param int proxy_port: The port of the proxy server. Defaults to 1080 for socks and 8080 for[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/constant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mPROVISIONING_API_VERSION = "2019-03-31"[0m
[30;1m14 | [0m[35mSECURITY_MESSAGE_INTERFACE_ID = "urn:azureiot:Security:SecurityAgent:1"[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# TODO: find somewhere else for this[0m
[30;1m17 | [0m[35mTELEMETRY_MESSAGE_SIZE_LIMIT = 262144[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Everything in digital twin is defined here[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/azure/iot/device/models.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    :ivar output_name: Name of the output that the message is being sent to.[0m
[30;1m22 | [0m[35m    :ivar input_name: Name of the input that the message was received on.[0m
[30;1m23 | [0m[35m    :ivar ack: Indicates the type of feedback generation used by IoTHub[0m
[30;1m24 | [0m[35m    :ivar expiry_time_utc: Date and time of message expiration in UTC format[0m
[30;1m25 | [0m[35m    :ivar user_id: An ID to specify the origin of messages[0m
[30;1m26 | [0m[35m    :ivar correlation_id: A property in a response message that typically contains the message_id of[0m
[30;1m27 | [0m[35m    """[0m

140 matches found.
