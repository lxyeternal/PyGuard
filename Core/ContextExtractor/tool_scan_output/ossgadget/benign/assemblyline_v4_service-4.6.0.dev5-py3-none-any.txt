[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m        passwords.update([p.strip(strip_char) for strip_char in PASSWORD_STRIP])[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    passwords.discard("")[0m
[30;1m113 | [0m[35m    return passwords[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35mdef _is_dev_mode() -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m109 | [0m[35m        # We can assume that at least one of the strip_char won't be there, to have the simple space[0m
[30;1m110 | [0m[35m        passwords.update([p.strip(strip_char) for strip_char in PASSWORD_STRIP])[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    passwords.discard("")[0m
[30;1m113 | [0m[35m    return passwords[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m
[30;1m109 | [0m[35m        # We can assume that at least one of the strip_char won't be there, to have the simple space[0m
[30;1m110 | [0m[35m        passwords.update([p.strip(strip_char) for strip_char in PASSWORD_STRIP])[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    passwords.discard("")[0m
[30;1m113 | [0m[35m    return passwords[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m
[30;1m109 | [0m[35m        # We can assume that at least one of the strip_char won't be there, to have the simple space[0m
[30;1m110 | [0m[35m        passwords.update([p.strip(strip_char) for strip_char in PASSWORD_STRIP])[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    passwords.discard("")[0m
[30;1m113 | [0m[35m    return passwords[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m
[30;1m109 | [0m[35m        # We can assume that at least one of the strip_char won't be there, to have the simple space[0m
[30;1m110 | [0m[35m        passwords.update([p.strip(strip_char) for strip_char in PASSWORD_STRIP])[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m
[30;1m109 | [0m[35m        # We can assume that at least one of the strip_char won't be there, to have the simple space[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m
[30;1m109 | [0m[35m        # We can assume that at least one of the strip_char won't be there, to have the simple space[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m
[30;1m109 | [0m[35m        # We can assume that at least one of the strip_char won't be there, to have the simple space[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m    passwords.update(text_split)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m    passwords.update(text_split)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m    passwords.update(text_split)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m101 | [0m[35m    text_split, text_split_n = set(text.split()), set(text.split("\n"))[0m
[30;1m102 | [0m[35m    passwords.update(text_split)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m    passwords: set[str] = set()[0m
[30;1m101 | [0m[35m    text_split, text_split_n = set(text.split()), set(text.split("\n"))[0m
[30;1m102 | [0m[35m    passwords.update(text_split)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35mdef extract_passwords(text: str) -> set[str]:[0m
[30;1m100 | [0m[35m    passwords: set[str] = set()[0m
[30;1m101 | [0m[35m    text_split, text_split_n = set(text.split()), set(text.split("\n"))[0m
[30;1m102 | [0m[35m    passwords.update(text_split)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m
[30;1m104 | [0m[35m    for i, r in enumerate(PASSWORD_REGEXES):[0m
[30;1m105 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split, PASSWORD_WORDS[i], r))[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35mdef extract_passwords(text: str) -> set[str]:[0m
[30;1m100 | [0m[35m    passwords: set[str] = set()[0m
[30;1m101 | [0m[35m    text_split, text_split_n = set(text.split()), set(text.split("\n"))[0m
[30;1m102 | [0m[35m    passwords.update(text_split)[0m
[30;1m103 | [0m[35m    passwords.update(re.split(r"\W+", text))[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m    return all_passwords[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35mdef extract_passwords(text: str) -> set[str]:[0m
[30;1m100 | [0m[35m    passwords: set[str] = set()[0m
[30;1m101 | [0m[35m    text_split, text_split_n = set(text.split()), set(text.split("\n"))[0m
[30;1m102 | [0m[35m    passwords.update(text_split)[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m            all_passwords.update(new_passwords)[0m
[30;1m96 | [0m[35m    return all_passwords[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35mdef extract_passwords(text: str) -> set[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m            all_passwords.update(new_passwords)[0m
[30;1m96 | [0m[35m    return all_passwords[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m            all_passwords.update(new_passwords)[0m
[30;1m96 | [0m[35m    return all_passwords[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m                    new_passwords.extend([password[:i] for i, ltr in enumerate(password) if ltr == s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m            all_passwords.update(new_passwords)[0m
[30;1m96 | [0m[35m    return all_passwords[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m89 | [0m[35m                for password in new_passwords:[0m
[30;1m90 | [0m[35m                    new_passwords.extend([password[:i] for i, ltr in enumerate(password) if ltr == s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m            all_passwords.update(new_passwords)[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m89 | [0m[35m                for password in new_passwords:[0m
[30;1m90 | [0m[35m                    new_passwords.extend([password[:i] for i, ltr in enumerate(password) if ltr == s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m            all_passwords.update(new_passwords)[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m                if special_char in BRACKET_PAIRS:[0m
[30;1m88 | [0m[35m                    special_char = BRACKET_PAIRS[special_char][0m
[30;1m89 | [0m[35m                for password in new_passwords:[0m
[30;1m90 | [0m[35m                    new_passwords.extend([password[:i] for i, ltr in enumerate(password) if ltr == s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m                if special_char in BRACKET_PAIRS:[0m
[30;1m88 | [0m[35m                    special_char = BRACKET_PAIRS[special_char][0m
[30;1m89 | [0m[35m                for password in new_passwords:[0m
[30;1m90 | [0m[35m                    new_passwords.extend([password[:i] for i, ltr in enumerate(password) if ltr == s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m                if special_char in BRACKET_PAIRS:[0m
[30;1m88 | [0m[35m                    special_char = BRACKET_PAIRS[special_char][0m
[30;1m89 | [0m[35m                for password in new_passwords:[0m
[30;1m90 | [0m[35m                    new_passwords.extend([password[:i] for i, ltr in enumerate(password) if ltr == s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m
[30;1m93 | [0m[35m                new_passwords.discard("")[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m86 | [0m[35m                special_char = line[index - 1][0m
[30;1m87 | [0m[35m                if special_char in BRACKET_PAIRS:[0m
[30;1m88 | [0m[35m                    special_char = BRACKET_PAIRS[special_char][0m
[30;1m89 | [0m[35m                for password in new_passwords:[0m
[30;1m90 | [0m[35m                    new_passwords.extend([password[:i] for i, ltr in enumerate(password) if ltr == s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m86 | [0m[35m                special_char = line[index - 1][0m
[30;1m87 | [0m[35m                if special_char in BRACKET_PAIRS:[0m
[30;1m88 | [0m[35m                    special_char = BRACKET_PAIRS[special_char][0m
[30;1m89 | [0m[35m                for password in new_passwords:[0m
[30;1m90 | [0m[35m                    new_passwords.extend([password[:i] for i, ltr in enumerate(password) if ltr == s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m                new_passwords = set(new_passwords)[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m81 | [0m[35m    for line in texts:[0m
[30;1m82 | [0m[35m        if password_keyword in line.lower():[0m
[30;1m83 | [0m[35m            new_passwords = re.split(password_regex, line)[0m
[30;1m84 | [0m[35m            index = line.lower().rindex(password_keyword)[0m
[30;1m85 | [0m[35m            if index > 0 and line[index - 1] != " ":[0m
[30;1m86 | [0m[35m                special_char = line[index - 1][0m
[30;1m87 | [0m[35m                if special_char in BRACKET_PAIRS:[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m
[30;1m82 | [0m[35m        if password_keyword in line.lower():[0m
[30;1m83 | [0m[35m            new_passwords = re.split(password_regex, line)[0m
[30;1m84 | [0m[35m            index = line.lower().rindex(password_keyword)[0m
[30;1m85 | [0m[35m            if index > 0 and line[index - 1] != " ":[0m
[30;1m86 | [0m[35m                special_char = line[index - 1][0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m
[30;1m82 | [0m[35m        if password_keyword in line.lower():[0m
[30;1m83 | [0m[35m            new_passwords = re.split(password_regex, line)[0m
[30;1m84 | [0m[35m            index = line.lower().rindex(password_keyword)[0m
[30;1m85 | [0m[35m            if index > 0 and line[index - 1] != " ":[0m
[30;1m86 | [0m[35m                special_char = line[index - 1][0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35m    all_passwords = set()[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m
[30;1m82 | [0m[35m        if password_keyword in line.lower():[0m
[30;1m83 | [0m[35m            new_passwords = re.split(password_regex, line)[0m
[30;1m84 | [0m[35m            index = line.lower().rindex(password_keyword)[0m
[30;1m85 | [0m[35m            if index > 0 and line[index - 1] != " ":[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef __extract_passwords_from_lines(texts, password_word, password_regex):[0m
[30;1m79 | [0m[35m    all_passwords = set()[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m
[30;1m82 | [0m[35m        if password_keyword in line.lower():[0m
[30;1m83 | [0m[35m            new_passwords = re.split(password_regex, line)[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef __extract_passwords_from_lines(texts, password_word, password_regex):[0m
[30;1m79 | [0m[35m    all_passwords = set()[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m
[30;1m82 | [0m[35m        if password_keyword in line.lower():[0m
[30;1m83 | [0m[35m            new_passwords = re.split(password_regex, line)[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef __extract_passwords_from_lines(texts, password_word, password_regex):[0m
[30;1m79 | [0m[35m    all_passwords = set()[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m
[30;1m82 | [0m[35m        if password_keyword in line.lower():[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m        signal.signal(signal.SIGALRM, self.alarm_default)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef __extract_passwords_from_lines(texts, password_word, password_regex):[0m
[30;1m79 | [0m[35m    all_passwords = set()[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m        signal.signal(signal.SIGALRM, self.alarm_default)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef __extract_passwords_from_lines(texts, password_word, password_regex):[0m
[30;1m79 | [0m[35m    all_passwords = set()[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m        signal.signal(signal.SIGALRM, self.alarm_default)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef __extract_passwords_from_lines(texts, password_word, password_regex):[0m
[30;1m79 | [0m[35m    all_passwords = set()[0m
[30;1m80 | [0m[35m    password_keyword = f"{password_word}:"[0m
[30;1m81 | [0m[35m    for line in texts:[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m][0m
[30;1m26 | [0m[35mPASSWORD_REGEXES = [re.compile(fr".*{p}:(.+)", re.I) for p in PASSWORD_WORDS][0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mPASSWORD_STRIP = [[0m
[30;1m29 | [0m[35m    '"',[0m
[30;1m30 | [0m[35m    "'",[0m
[30;1m31 | [0m[35m    "ÏûÖÎãàÎã§",[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m    "–ø–∞—Ä–æ–ª—å",  # Russian[0m
[30;1m24 | [0m[35m    "contrase√±a",  # Spanish[0m
[30;1m25 | [0m[35m][0m
[30;1m26 | [0m[35mPASSWORD_REGEXES = [re.compile(fr".*{p}:(.+)", re.I) for p in PASSWORD_WORDS][0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mPASSWORD_STRIP = [[0m
[30;1m29 | [0m[35m    '"',[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m    "–ø–∞—Ä–æ–ª—å",  # Russian[0m
[30;1m24 | [0m[35m    "contrase√±a",  # Spanish[0m
[30;1m25 | [0m[35m][0m
[30;1m26 | [0m[35mPASSWORD_REGEXES = [re.compile(fr".*{p}:(.+)", re.I) for p in PASSWORD_WORDS][0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mPASSWORD_STRIP = [[0m
[30;1m29 | [0m[35m    '"',[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35m    "ŸÉŸÑŸÖŸá ÿßŸÑÿ≥ÿ±",  # Arabic[0m
[30;1m14 | [0m[35m    "ÂØÜÁ†Å",  # Chinese Simplified[0m
[30;1m15 | [0m[35m    "ÂØÜÁ¢º",  # Chinese Traditional[0m
[30;1m16 | [0m[35m    "password",  # English[0m
[30;1m17 | [0m[35m    "mot de passe",  # French[0m
[30;1m18 | [0m[35m    "passwort",  # German[0m
[30;1m19 | [0m[35m    "parola d'ordine",  # Italian[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mlibc = ctypes.CDLL("libc.so.6")[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mPASSWORD_WORDS = [[0m
[30;1m13 | [0m[35m    "ŸÉŸÑŸÖŸá ÿßŸÑÿ≥ÿ±",  # Arabic[0m
[30;1m14 | [0m[35m    "ÂØÜÁ†Å",  # Chinese Simplified[0m
[30;1m15 | [0m[35m    "ÂØÜÁ¢º",  # Chinese Traditional[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m66 | [0m[35m    @functools.wraps(func)[0m
[30;1m67 | [0m[35m    def base(*args, **kwargs):[0m
[30;1m68 | [0m[35m        # Before anything else, check that the API key is set[0m
[30;1m69 | [0m[35m        apikey = request.environ.get('HTTP_X_APIKEY', None)[0m
[30;1m70 | [0m[35m        if AUTH_KEY != apikey:[0m
[30;1m71 | [0m[35m            app.logger.warning(f'Client provided wrong api key [{apikey}]')[0m
[30;1m72 | [0m[35m            raise Unauthorized("Unauthorized access denied")[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mapp = Flask('service_updater')[0m
[30;1m19 | [0m[35mAUTH_KEY = os.environ.get('AL_INSTANCE_KEY', 'ThisIsARandomAuthKey...ChangeMe!')[0m
[30;1m20 | [0m[35mAL_ROOT_CA = os.environ.get('AL_ROOT_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mssl_context = None[0m
[30;1m23 | [0m[35mif os.path.exists(AL_ROOT_CA):[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mapp = Flask('service_updater')[0m
[30;1m19 | [0m[35mAUTH_KEY = os.environ.get('AL_INSTANCE_KEY', 'ThisIsARandomAuthKey...ChangeMe!')[0m
[30;1m20 | [0m[35mAL_ROOT_CA = os.environ.get('AL_ROOT_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mssl_context = None[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m23 | [0m[35m            raise Exception('Unable to reach service-server')[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    # If running with an updater, check for availability. Make sure test doesn't run on the actual u[0m
[30;1m26 | [0m[35m    if environ.get('updates_host') and not environ['HOSTNAME'].startswith(environ['updates_host']):[0m
[30;1m27 | [0m[35m        scheme, verify = ("http", None) if not path.exists(UPDATES_CA) else ("https", UPDATES_CA)[0m
[30;1m28 | [0m[35m        if not requests.get(f"{scheme}://{environ['updates_host']}:{environ['updates_port']}/healthz[0m
[30;1m29 | [0m[35m                            verify=verify).ok:[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m11 | [0m[35m# Intended for use with Kubernetes deployments[0m
[30;1m12 | [0m[35mdef perform_check():[0m
[30;1m13 | [0m[35m    # If the service is privileged, test connectivity to core[0m
[30;1m14 | [0m[35m    if environ.get('PRIVILEGED', 'false').lower() == 'true':[0m
[30;1m15 | [0m[35m        forge.get_datastore()[0m
[30;1m16 | [0m[35m        forge.get_filestore(connection_attempts=1)[0m
[30;1m17 | [0m[35m        forge.get_service_queue(service=environ['AL_SERVICE_NAME'])[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m5 | [0m[35mfrom sys import exit[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUPDATES_CA = environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m8 | [0m[35mSERVICE_SERVER_CA = environ.get('SERVICE_SERVER_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# Intended for use with Kubernetes deployments[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m4 | [0m[35mfrom assemblyline.common import forge[0m
[30;1m5 | [0m[35mfrom sys import exit[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUPDATES_CA = environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m8 | [0m[35mSERVICE_SERVER_CA = environ.get('SERVICE_SERVER_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m32 | [0m[35m            "Service-Tool-Version": get_service_manifest().get('tool_version', '')[0m
[30;1m33 | [0m[35m        })[0m
[30;1m34 | [0m[35m        if self.service_api_host.startswith('https'):[0m
[30;1m35 | [0m[35m            self.session.verify = os.environ.get('SERVICE_SERVER_ROOT_CA_PATH', '/etc/assemblyline/s[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def _with_retries(self, func, url, **kwargs):[0m
[30;1m38 | [0m[35m        retries = 0[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35m        self.session = requests.Session()[0m
[30;1m27 | [0m[35m        self.session.headers.update({[0m
[30;1m28 | [0m[35m            "X-APIKey": os.environ.get("SERVICE_API_KEY", DEFAULT_AUTH_KEY),[0m
[30;1m29 | [0m[35m            "Container-ID": os.environ.get('HOSTNAME', 'dev-service'),[0m
[30;1m30 | [0m[35m            "Service-Name": service_attributes.name,[0m
[30;1m31 | [0m[35m            "Service-Version": service_attributes.version,[0m
[30;1m32 | [0m[35m            "Service-Tool-Version": get_service_manifest().get('tool_version', '')[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35m        self.service_api_host = os.environ.get("SERVICE_API_HOST", DEFAULT_SERVICE_SERVER)[0m
[30;1m26 | [0m[35m        self.session = requests.Session()[0m
[30;1m27 | [0m[35m        self.session.headers.update({[0m
[30;1m28 | [0m[35m            "X-APIKey": os.environ.get("SERVICE_API_KEY", DEFAULT_AUTH_KEY),[0m
[30;1m29 | [0m[35m            "Container-ID": os.environ.get('HOSTNAME', 'dev-service'),[0m
[30;1m30 | [0m[35m            "Service-Name": service_attributes.name,[0m
[30;1m31 | [0m[35m            "Service-Version": service_attributes.version,[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m22 | [0m[35mclass ServiceAPI:[0m
[30;1m23 | [0m[35m    def __init__(self, service_attributes, logger):[0m
[30;1m24 | [0m[35m        self.log = logger[0m
[30;1m25 | [0m[35m        self.service_api_host = os.environ.get("SERVICE_API_HOST", DEFAULT_SERVICE_SERVER)[0m
[30;1m26 | [0m[35m        self.session = requests.Session()[0m
[30;1m27 | [0m[35m        self.session.headers.update({[0m
[30;1m28 | [0m[35m            "X-APIKey": os.environ.get("SERVICE_API_KEY", DEFAULT_AUTH_KEY),[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m200 | [0m[35m        auth = f'{username}:{password}@'[0m
[30;1m201 | [0m[35m    elif password:[0m
[30;1m202 | [0m[35m        # Token-based authentication[0m
[30;1m203 | [0m[35m        auth = f'{password}@'[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    git_env = {}[0m
[30;1m206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m198 | [0m[35m    if username and password:[0m
[30;1m199 | [0m[35m        # Basic authentication scheme[0m
[30;1m200 | [0m[35m        auth = f'{username}:{password}@'[0m
[30;1m201 | [0m[35m    elif password:[0m
[30;1m202 | [0m[35m        # Token-based authentication[0m
[30;1m203 | [0m[35m        auth = f'{password}@'[0m
[30;1m204 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m197 | [0m[35m    auth = None[0m
[30;1m198 | [0m[35m    if username and password:[0m
[30;1m199 | [0m[35m        # Basic authentication scheme[0m
[30;1m200 | [0m[35m        auth = f'{username}:{password}@'[0m
[30;1m201 | [0m[35m    elif password:[0m
[30;1m202 | [0m[35m        # Token-based authentication[0m
[30;1m203 | [0m[35m        auth = f'{password}@'[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m    ca_cert = source.get("ca_cert")[0m
[30;1m196 | [0m[35m    proxy = source.get('proxy', None)[0m
[30;1m197 | [0m[35m    auth = None[0m
[30;1m198 | [0m[35m    if username and password:[0m
[30;1m199 | [0m[35m        # Basic authentication scheme[0m
[30;1m200 | [0m[35m        auth = f'{username}:{password}@'[0m
[30;1m201 | [0m[35m    elif password:[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m188 | [0m[35m    url = source['uri'][0m
[30;1m189 | [0m[35m    key = source.get('private_key', None)[0m
[30;1m190 | [0m[35m    username = source.get('username', None)[0m
[30;1m191 | [0m[35m    password = source.get('password', None)[0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    ignore_ssl_errors = source.get("ssl_ignore_errors", False)[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m188 | [0m[35m    url = source['uri'][0m
[30;1m189 | [0m[35m    key = source.get('private_key', None)[0m
[30;1m190 | [0m[35m    username = source.get('username', None)[0m
[30;1m191 | [0m[35m    password = source.get('password', None)[0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    ignore_ssl_errors = source.get("ssl_ignore_errors", False)[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m186 | [0m[35mdef git_clone_repo(source: Dict[str, Any], previous_update: int = None, logger=None, output_dir: str[0m
[30;1m187 | [0m[35m    name = source['name'][0m
[30;1m188 | [0m[35m    url = source['uri'][0m
[30;1m189 | [0m[35m    key = source.get('private_key', None)[0m
[30;1m190 | [0m[35m    username = source.get('username', None)[0m
[30;1m191 | [0m[35m    password = source.get('password', None)[0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m                logger.info('A private key has been provided with this source')[0m
[30;1m115 | [0m[35m                private_key_file.write(source['private_key'])[0m
[30;1m116 | [0m[35m                private_key_file.seek(0)[0m
[30;1m117 | [0m[35m                session.cert = private_key_file.name[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m            # Check the response header for the last modified date[0m
[30;1m120 | [0m[35m            response = session.head(uri, auth=auth, headers=headers, proxies=proxies)[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m113 | [0m[35m            if source.get('private_key'):[0m
[30;1m114 | [0m[35m                logger.info('A private key has been provided with this source')[0m
[30;1m115 | [0m[35m                private_key_file.write(source['private_key'])[0m
[30;1m116 | [0m[35m                private_key_file.seek(0)[0m
[30;1m117 | [0m[35m                session.cert = private_key_file.name[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m            # Check the response header for the last modified date[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35m        with tempfile.NamedTemporaryFile('w') as private_key_file:[0m
[30;1m113 | [0m[35m            if source.get('private_key'):[0m
[30;1m114 | [0m[35m                logger.info('A private key has been provided with this source')[0m
[30;1m115 | [0m[35m                private_key_file.write(source['private_key'])[0m
[30;1m116 | [0m[35m                private_key_file.seek(0)[0m
[30;1m117 | [0m[35m                session.cert = private_key_file.name[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35m        with tempfile.NamedTemporaryFile('w') as private_key_file:[0m
[30;1m113 | [0m[35m            if source.get('private_key'):[0m
[30;1m114 | [0m[35m                logger.info('A private key has been provided with this source')[0m
[30;1m115 | [0m[35m                private_key_file.write(source['private_key'])[0m
[30;1m116 | [0m[35m                private_key_file.seek(0)[0m
[30;1m117 | [0m[35m                session.cert = private_key_file.name[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m    try:[0m
[30;1m111 | [0m[35m        response = None[0m
[30;1m112 | [0m[35m        with tempfile.NamedTemporaryFile('w') as private_key_file:[0m
[30;1m113 | [0m[35m            if source.get('private_key'):[0m
[30;1m114 | [0m[35m                logger.info('A private key has been provided with this source')[0m
[30;1m115 | [0m[35m                private_key_file.write(source['private_key'])[0m
[30;1m116 | [0m[35m                private_key_file.seek(0)[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    try:[0m
[30;1m111 | [0m[35m        response = None[0m
[30;1m112 | [0m[35m        with tempfile.NamedTemporaryFile('w') as private_key_file:[0m
[30;1m113 | [0m[35m            if source.get('private_key'):[0m
[30;1m114 | [0m[35m                logger.info('A private key has been provided with this source')[0m
[30;1m115 | [0m[35m                private_key_file.write(source['private_key'])[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m    password = source.get('password', None)[0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m
[30;1m91 | [0m[35m    fetch_method = source.get('fetch_method', 'GET').lower()[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    proxy = source.get('proxy', None)[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m    password = source.get('password', None)[0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m
[30;1m91 | [0m[35m    fetch_method = source.get('fetch_method', 'GET').lower()[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    proxy = source.get('proxy', None)[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m        raise ValueError(f"Provided source uri does not end with a file name: '{uri}'")[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    username = source.get('username', None)[0m
[30;1m87 | [0m[35m    password = source.get('password', None)[0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m        raise ValueError(f"Provided source uri does not end with a file name: '{uri}'")[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    username = source.get('username', None)[0m
[30;1m87 | [0m[35m    password = source.get('password', None)[0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m            # As checking for .git at the end of the URI is not reliable[0m
[30;1m240 | [0m[35m            # we will use the exception to determine if its a git repo or direct download.[0m
[30;1m241 | [0m[35m            repo = Repo.clone_from(url, clone_dir, env=git_env, branch=branch,[0m
[30;1m242 | [0m[35m                                   allow_unsafe_protocols=GIT_ALLOW_UNSAFE_PROTOCOLS, depth=1)[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m            # Check repo last commit[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m19 | [0m[35mfrom assemblyline_v4_service.common.utils import DEVELOPMENT_MODE[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mBLOCK_SIZE = 64 * 1024[0m
[30;1m22 | [0m[35mGIT_ALLOW_UNSAFE_PROTOCOLS = os.environ.get('GIT_ALLOW_UNSAFE_PROTOCOLS', 'false').lower() == 'true'[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mif DEVELOPMENT_MODE:[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m
[30;1m135 | [0m[35m                    self.temp_submission_data['passwords'] = sorted(pw_list)[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m                heuristic = Heuristic(ocr_heuristic_id, signatures={[0m
[30;1m138 | [0m[35m                    f'{k}_strings': len(v) for k, v in detections.items()})[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m                # If we were able to detect potential passwords, add it to the submission's password[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m
[30;1m135 | [0m[35m                    self.temp_submission_data['passwords'] = sorted(pw_list)[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m                heuristic = Heuristic(ocr_heuristic_id, signatures={[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m                # If we were able to detect potential passwords, add it to the submission's password[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m
[30;1m135 | [0m[35m                    self.temp_submission_data['passwords'] = sorted(pw_list)[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m                heuristic = Heuristic(ocr_heuristic_id, signatures={[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m130 | [0m[35m            if detections:[0m
[30;1m131 | [0m[35m                # If we were able to detect potential passwords, add it to the submission's password[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m
[30;1m135 | [0m[35m                    self.temp_submission_data['passwords'] = sorted(pw_list)[0m
[30;1m136 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m            if detections:[0m
[30;1m131 | [0m[35m                # If we were able to detect potential passwords, add it to the submission's password[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m
[30;1m135 | [0m[35m                    self.temp_submission_data['passwords'] = sorted(pw_list)[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m128 | [0m[35m                    pass[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m            if detections:[0m
[30;1m131 | [0m[35m                # If we were able to detect potential passwords, add it to the submission's password[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m128 | [0m[35m                    pass[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m            if detections:[0m
[30;1m131 | [0m[35m                # If we were able to detect potential passwords, add it to the submission's password[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35mfrom assemblyline_v4_service.common.ocr import ocr_detections[0m
[30;1m8 | [0m[35mfrom assemblyline_v4_service.common.result import Heuristic, Result, ResultKeyValueSection[0m
[30;1m9 | [0m[35mfrom assemblyline_v4_service.common.task import PARENT_RELATION, MaxExtractedExceeded, Task[0m
[30;1m10 | [0m[35mfrom assemblyline_v4_service.common.utils import extract_passwords[0m
[30;1m11 | [0m[35mfrom PIL import Image[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom assemblyline.common import forge[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m
[30;1m33 | [0m[35mcertfile = env.get('CERTFILE')[0m
[30;1m34 | [0m[35mkeyfile = env.get('KEYFILE')[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m30 | [0m[35mtimeout = int(env.get('TIMEOUT', '60'))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m
[30;1m33 | [0m[35mcertfile = env.get('CERTFILE')[0m
[30;1m34 | [0m[35mkeyfile = env.get('KEYFILE')[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35m# Connection timeouts[0m
[30;1m28 | [0m[35m#  - Defaults to double what the poll length for services should be[0m
[30;1m29 | [0m[35mgraceful_timeout = int(env.get('GRACEFUL_TIMEOUT', '60'))[0m
[30;1m30 | [0m[35mtimeout = int(env.get('TIMEOUT', '60'))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m
[30;1m33 | [0m[35mcertfile = env.get('CERTFILE')[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m# Connection timeouts[0m
[30;1m28 | [0m[35m#  - Defaults to double what the poll length for services should be[0m
[30;1m29 | [0m[35mgraceful_timeout = int(env.get('GRACEFUL_TIMEOUT', '60'))[0m
[30;1m30 | [0m[35mtimeout = int(env.get('TIMEOUT', '60'))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# Recycle the process after X request randomized by the jitter[0m
[30;1m24 | [0m[35mmax_requests = int(env.get('MAX_REQUESTS', '0'))[0m
[30;1m25 | [0m[35mmax_requests_jitter = int(env.get('MAX_REQUESTS_JITTER', '0'))[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m# Connection timeouts[0m
[30;1m28 | [0m[35m#  - Defaults to double what the poll length for services should be[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m21 | [0m[35mworker_connections = int(env.get('WORKER_CONNECTIONS', '1000'))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# Recycle the process after X request randomized by the jitter[0m
[30;1m24 | [0m[35mmax_requests = int(env.get('MAX_REQUESTS', '0'))[0m
[30;1m25 | [0m[35mmax_requests_jitter = int(env.get('MAX_REQUESTS_JITTER', '0'))[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m# Connection timeouts[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Number of concurrent handled connections[0m
[30;1m20 | [0m[35mthreads = int(env.get('THREADS', 4))[0m
[30;1m21 | [0m[35mworker_connections = int(env.get('WORKER_CONNECTIONS', '1000'))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# Recycle the process after X request randomized by the jitter[0m
[30;1m24 | [0m[35mmax_requests = int(env.get('MAX_REQUESTS', '0'))[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35mworkers = int(env.get('WORKERS', 1))[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Number of concurrent handled connections[0m
[30;1m20 | [0m[35mthreads = int(env.get('THREADS', 4))[0m
[30;1m21 | [0m[35mworker_connections = int(env.get('WORKER_CONNECTIONS', '1000'))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# Recycle the process after X request randomized by the jitter[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m14 | [0m[35mbind = f":{int(env.get('PORT', 5003))}"[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# Number of processes to launch[0m
[30;1m17 | [0m[35mworkers = int(env.get('WORKERS', 1))[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Number of concurrent handled connections[0m
[30;1m20 | [0m[35mthreads = int(env.get('THREADS', 4))[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m11 | [0m[35mworker_class = env.get('WORKER_CLASS', 'gevent')[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Port to bind to[0m
[30;1m14 | [0m[35mbind = f":{int(env.get('PORT', 5003))}"[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# Number of processes to launch[0m
[30;1m17 | [0m[35mworkers = int(env.get('WORKERS', 1))[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m8 | [0m[35mfrom os import environ as env[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m# What backend gunicorn should use for workers[0m
[30;1m11 | [0m[35mworker_class = env.get('WORKER_CLASS', 'gevent')[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Port to bind to[0m
[30;1m14 | [0m[35mbind = f":{int(env.get('PORT', 5003))}"[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        self.tasking_client = TaskingClient(redis=self.redis, redis_persist=self.redis_persist,[0m
[30;1m67 | [0m[35m                                            register_only=REGISTER_ONLY)[0m
[30;1m68 | [0m[35m        self.tasking_dir = os.environ.get('TASKING_DIR', tempfile.gettempdir())[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        self.service = None[0m
[30;1m71 | [0m[35m        self.service_config = {}[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m49 | [0m[35m        super(RunPrivilegedService, self).__init__([0m
[30;1m50 | [0m[35m            f'assemblyline.service.{SERVICE_NAME}', shutdown_timeout=shutdown_timeout)[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        self.client_id = os.environ.get('HOSTNAME', 'dev-service')[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        self.redis = get_client([0m
[30;1m55 | [0m[35m            host=self.config.core.redis.nonpersistent.host,[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m27 | [0m[35mSERVICE_MANIFEST = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'service_manifes[0m
[30;1m28 | [0m[35mTMP_SERVICE_MANIFEST = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"[0m
[30;1m29 | [0m[35mREGISTER_ONLY = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mSERVICE_NAME = SERVICE_PATH.split(".")[-1].lower()[0m
[30;1m32 | [0m[35mSHUTDOWN_SECONDS_LIMIT = 10[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35mSERVICE_PATH = os.environ['SERVICE_PATH'][0m
[30;1m26 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m27 | [0m[35mSERVICE_MANIFEST = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'service_manifes[0m
[30;1m28 | [0m[35mTMP_SERVICE_MANIFEST = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"[0m
[30;1m29 | [0m[35mREGISTER_ONLY = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mSERVICE_NAME = SERVICE_PATH.split(".")[-1].lower()[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mSERVICE_PATH = os.environ['SERVICE_PATH'][0m
[30;1m26 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m27 | [0m[35mSERVICE_MANIFEST = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'service_manifes[0m
[30;1m28 | [0m[35mTMP_SERVICE_MANIFEST = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"[0m
[30;1m29 | [0m[35mREGISTER_ONLY = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m23 | [0m[35mfrom assemblyline_v4_service.common.base import is_recoverable_runtime_error[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mSERVICE_PATH = os.environ['SERVICE_PATH'][0m
[30;1m26 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m27 | [0m[35mSERVICE_MANIFEST = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'service_manifes[0m
[30;1m28 | [0m[35mTMP_SERVICE_MANIFEST = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"[0m
[30;1m29 | [0m[35mREGISTER_ONLY = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m236 | [0m[35m        'signatures': {'password_strings': 1},[0m
[30;1m237 | [0m[35m        'frequency': 0, 'score_map': {}}[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    assert service_request.temp_submission_data == {'passwords': [' 975', '975', 'DOCUMENT', 'PASSWO[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35mdef test_add_supplementary(service_request):[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m236 | [0m[35m        'signatures': {'password_strings': 1},[0m
[30;1m237 | [0m[35m        'frequency': 0, 'score_map': {}}[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    assert service_request.temp_submission_data == {'passwords': [' 975', '975', 'DOCUMENT', 'PASSWO[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35mdef test_add_supplementary(service_request):[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m236 | [0m[35m        'signatures': {'password_strings': 1},[0m
[30;1m237 | [0m[35m        'frequency': 0, 'score_map': {}}[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    assert service_request.temp_submission_data == {'passwords': [' 975', '975', 'DOCUMENT', 'PASSWO[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35mdef test_add_supplementary(service_request):[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    assert heur_dict == {[0m
[30;1m235 | [0m[35m        'heur_id': 1, 'score': 250, 'attack_ids': ['T1005'],[0m
[30;1m236 | [0m[35m        'signatures': {'password_strings': 1},[0m
[30;1m237 | [0m[35m        'frequency': 0, 'score_map': {}}[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    assert service_request.temp_submission_data == {'passwords': [' 975', '975', 'DOCUMENT', 'PASSWO[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m225 | [0m[35m    }[0m
[30;1m226 | [0m[35m    assert data["ocr_section"].__dict__["section_body"].__dict__ == {[0m
[30;1m227 | [0m[35m        '_config': {},[0m
[30;1m228 | [0m[35m        '_data': {'password': ['DOCUMENT PASSWORD: 975']},[0m
[30;1m229 | [0m[35m        '_format': 'KEY_VALUE'[0m
[30;1m230 | [0m[35m    }[0m
[30;1m231 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m225 | [0m[35m    }[0m
[30;1m226 | [0m[35m    assert data["ocr_section"].__dict__["section_body"].__dict__ == {[0m
[30;1m227 | [0m[35m        '_config': {},[0m
[30;1m228 | [0m[35m        '_data': {'password': ['DOCUMENT PASSWORD: 975']},[0m
[30;1m229 | [0m[35m        '_format': 'KEY_VALUE'[0m
[30;1m230 | [0m[35m    }[0m
[30;1m231 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    service_request.task.supplementary.clear()[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    # Classification, OCR heuristic, OCR_IO, image with password[0m
[30;1m209 | [0m[35m    image_path = os.path.join([0m
[30;1m210 | [0m[35m        os.path.dirname(__file__),[0m
[30;1m211 | [0m[35m        "4031ed8786439eee24b87f84901e38038a76b8c55e9d87dd5a7d88df2806c1cf")[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    service_request.task.supplementary.clear()[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m    # Classification, OCR heuristic, OCR_IO, image with no password[0m
[30;1m159 | [0m[35m    ocr_heuristic_id = 1[0m
[30;1m160 | [0m[35m    _, path = tempfile.mkstemp()[0m
[30;1m161 | [0m[35m    ocr_io = open(path, "w")[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom typing import Any, Dict, List, Optional, Set, Union[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mSIGNATURE_UPDATE_BATCH = int(os.environ.get('SIGNATURE_UPDATE_BATCH', '1000'))[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mclass SyncableBadlistClient(BadlistClient):[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m66 | [0m[35m    service_manifest_yml = os.environ.get([0m
[30;1m67 | [0m[35m        'SERVICE_MANIFEST_PATH', f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml")[0m
[30;1m68 | [0m[35m    if not os.path.exists(service_manifest_yml):[0m
[30;1m69 | [0m[35m        service_manifest_yml = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'ser[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    if os.path.exists(service_manifest_yml):[0m
[30;1m72 | [0m[35m        bio = BytesIO()[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mdef get_service_manifest() -> Dict:[0m
[30;1m66 | [0m[35m    service_manifest_yml = os.environ.get([0m
[30;1m67 | [0m[35m        'SERVICE_MANIFEST_PATH', f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml")[0m
[30;1m68 | [0m[35m    if not os.path.exists(service_manifest_yml):[0m
[30;1m69 | [0m[35m        service_manifest_yml = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'ser[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mdef get_service_manifest() -> Dict:[0m
[30;1m66 | [0m[35m    service_manifest_yml = os.environ.get([0m
[30;1m67 | [0m[35m        'SERVICE_MANIFEST_PATH', f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml")[0m
[30;1m68 | [0m[35m    if not os.path.exists(service_manifest_yml):[0m
[30;1m69 | [0m[35m        service_manifest_yml = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'ser[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m9 | [0m[35mfrom assemblyline.odm.models.heuristic import Heuristic[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef get_classification() -> Classification:[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        if not os.path.exists(self.runtime_service_manifest):[0m
[30;1m49 | [0m[35m            # In case service tag have not been overwritten we will do it here (This is mainly use d[0m
[30;1m50 | [0m[35m            service_tag = os.environ.get("SERVICE_TAG",[0m
[30;1m51 | [0m[35m                                         f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev0")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m            with open(self.service_manifest, "rb") as srv_manifest:[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m36 | [0m[35m        self.service_file_required = None[0m
[30;1m37 | [0m[35m        self.task_fifo = None[0m
[30;1m38 | [0m[35m        self.done_fifo = None[0m
[30;1m39 | [0m[35m        self.tasking_dir = os.environ.get('TASKING_DIR', tempfile.gettempdir())[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    def try_run(self):[0m
[30;1m42 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35m        self.service_manifest = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'se[0m
[30;1m26 | [0m[35m        self.runtime_service_manifest = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifes[0m
[30;1m27 | [0m[35m        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"[0m
[30;1m28 | [0m[35m        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        self.status = None[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m24 | [0m[35m        self.classification_yml = '/etc/assemblyline/classification.yml'[0m
[30;1m25 | [0m[35m        self.service_manifest = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'se[0m
[30;1m26 | [0m[35m        self.runtime_service_manifest = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifes[0m
[30;1m27 | [0m[35m        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"[0m
[30;1m28 | [0m[35m        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        self.status = None[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self.classification_yml = '/etc/assemblyline/classification.yml'[0m
[30;1m25 | [0m[35m        self.service_manifest = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'se[0m
[30;1m26 | [0m[35m        self.runtime_service_manifest = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifes[0m
[30;1m27 | [0m[35m        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"[0m
[30;1m28 | [0m[35m        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m22 | [0m[35m        super(RunService, self).__init__(f'assemblyline.service.{SERVICE_NAME}', shutdown_timeout=sh[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self.classification_yml = '/etc/assemblyline/classification.yml'[0m
[30;1m25 | [0m[35m        self.service_manifest = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'se[0m
[30;1m26 | [0m[35m        self.runtime_service_manifest = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifes[0m
[30;1m27 | [0m[35m        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"[0m
[30;1m28 | [0m[35m        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m78 | [0m[35m        self.default_pattern = None[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        if not logger:[0m
[30;1m81 | [0m[35m            al_log.init_logging(f'updater.{self.updater_type}', log_level=os.environ.get('LOG_LEVEL'[0m
[30;1m82 | [0m[35m            logger = logging.getLogger(f'assemblyline.updater.{self.updater_type}')[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        super().__init__(f'assemblyline.{SERVICE_NAME}_updater', logger=logger, shutdown_timeout=shu[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m51 | [0m[35mSOURCE_STATUS_KEY = 'status'[0m
[30;1m52 | [0m[35mSOURCE_UPDATE_ATTEMPT_DELAY_BASE = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_DELAY_BASE", "5"))[0m
[30;1m53 | [0m[35mSOURCE_UPDATE_ATTEMPT_MAX_RETRY = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_MAX_RETRY", "3"))[0m
[30;1m54 | [0m[35mUPDATER_DIR = os.getenv('UPDATER_DIR', os.path.join(tempfile.gettempdir(), 'updater'))[0m
[30;1m55 | [0m[35mUPDATER_API_ROLES = ['badlist_manage', 'signature_import', 'signature_download',[0m
[30;1m56 | [0m[35m                     'signature_view', 'safelist_manage', 'apikey_access', 'signature_manage'][0m
[30;1m57 | [0m[35mSTATUS_FILE = '/tmp/status'[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m50 | [0m[35mSOURCE_EXTRA_KEY = 'source_extra'[0m
[30;1m51 | [0m[35mSOURCE_STATUS_KEY = 'status'[0m
[30;1m52 | [0m[35mSOURCE_UPDATE_ATTEMPT_DELAY_BASE = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_DELAY_BASE", "5"))[0m
[30;1m53 | [0m[35mSOURCE_UPDATE_ATTEMPT_MAX_RETRY = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_MAX_RETRY", "3"))[0m
[30;1m54 | [0m[35mUPDATER_DIR = os.getenv('UPDATER_DIR', os.path.join(tempfile.gettempdir(), 'updater'))[0m
[30;1m55 | [0m[35mUPDATER_API_ROLES = ['badlist_manage', 'signature_import', 'signature_download',[0m
[30;1m56 | [0m[35m                     'signature_view', 'safelist_manage', 'apikey_access', 'signature_manage'][0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m49 | [0m[35mLOCAL_UPDATE_TIME_KEY = 'local_update_time'[0m
[30;1m50 | [0m[35mSOURCE_EXTRA_KEY = 'source_extra'[0m
[30;1m51 | [0m[35mSOURCE_STATUS_KEY = 'status'[0m
[30;1m52 | [0m[35mSOURCE_UPDATE_ATTEMPT_DELAY_BASE = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_DELAY_BASE", "5"))[0m
[30;1m53 | [0m[35mSOURCE_UPDATE_ATTEMPT_MAX_RETRY = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_MAX_RETRY", "3"))[0m
[30;1m54 | [0m[35mUPDATER_DIR = os.getenv('UPDATER_DIR', os.path.join(tempfile.gettempdir(), 'updater'))[0m
[30;1m55 | [0m[35mUPDATER_API_ROLES = ['badlist_manage', 'signature_import', 'signature_download',[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35m}[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m# The minimum number of indicator hits to avoid FP detections[0m
[30;1m155 | [0m[35mOCR_INDICATORS_THRESHOLD: Dict[str, int] = {"ransomware": 2, "macros": 2, "banned": 1, "password": 1[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35mdef update_ocr_config(ocr_config: Dict[str, Union[List[str], Dict[str, Any]]] = None):[0m
[30;1m158 | [0m[35m    global OCR_INDICATORS_TERMS[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m144 | [0m[35m        "mobile banking",[0m
[30;1m145 | [0m[35m        "online banking",[0m
[30;1m146 | [0m[35m        "paypal account",[0m
[30;1m147 | [0m[35m        "remember password",[0m
[30;1m148 | [0m[35m        "secure login",[0m
[30;1m149 | [0m[35m        "security challenge",[0m
[30;1m150 | [0m[35m        "verify your identity",[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m140 | [0m[35m        "enter document",[0m
[30;1m141 | [0m[35m        "enter security",[0m
[30;1m142 | [0m[35m        "forgot email",[0m
[30;1m143 | [0m[35m        "forgot password",[0m
[30;1m144 | [0m[35m        "mobile banking",[0m
[30;1m145 | [0m[35m        "online banking",[0m
[30;1m146 | [0m[35m        "paypal account",[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        "windows system alert",[0m
[30;1m130 | [0m[35m        "your browser has been infected",[0m
[30;1m131 | [0m[35m        "your customer number is made up of your date of birth",[0m
[30;1m132 | [0m[35m        "your paypal id or password was entered incorrectly",[0m
[30;1m133 | [0m[35m        # Other[0m
[30;1m134 | [0m[35m        "banking security",[0m
[30;1m135 | [0m[35m        "card number",[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35m        "protected documents",[0m
[30;1m119 | [0m[35m    ],[0m
[30;1m120 | [0m[35m    "banned": [],[0m
[30;1m121 | [0m[35m    "password": PASSWORD_WORDS,[0m
[30;1m122 | [0m[35m    "phishing": [[0m
[30;1m123 | [0m[35m        # https://github.com/CAPESandbox/community/blob/815e21980f4b234cf84e78749447f262af2beef9/mod[0m
[30;1m124 | [0m[35m        "Invalid Card Number",[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35m        "protected documents",[0m
[30;1m119 | [0m[35m    ],[0m
[30;1m120 | [0m[35m    "banned": [],[0m
[30;1m121 | [0m[35m    "password": PASSWORD_WORDS,[0m
[30;1m122 | [0m[35m    "phishing": [[0m
[30;1m123 | [0m[35m        # https://github.com/CAPESandbox/community/blob/815e21980f4b234cf84e78749447f262af2beef9/mod[0m
[30;1m124 | [0m[35m        "Invalid Card Number",[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m3 | [0m[35mfrom typing import Any, Dict, List, TextIO, Union[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom assemblyline_v4_service.common.helper import get_service_manifest[0m
[30;1m6 | [0m[35mfrom assemblyline_v4_service.common.utils import PASSWORD_WORDS[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# The terms related to each indicator category[0m
[30;1m9 | [0m[35mOCR_INDICATORS_TERMS: dict[str, list[str]] = {[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m    @property[0m
[30;1m332 | [0m[35m    def working_directory(self) -> str:[0m
[30;1m333 | [0m[35m        temp_dir = os.path.join(os.environ.get('TASKING_DIR', tempfile.gettempdir()), 'working_direc[0m
[30;1m334 | [0m[35m        if not os.path.isdir(temp_dir):[0m
[30;1m335 | [0m[35m            os.makedirs(temp_dir)[0m
[30;1m336 | [0m[35m        if self._working_directory is None:[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m317 | [0m[35m        self.save_result()[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m    def validate_file(self) -> str:[0m
[30;1m320 | [0m[35m        file_path = os.path.join(os.environ.get('TASKING_DIR', tempfile.gettempdir()), self.sha256)[0m
[30;1m321 | [0m[35m        if not os.path.exists(file_path):[0m
[30;1m322 | [0m[35m            raise Exception("File download failed. File not found on local filesystem.")[0m
[30;1m323 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m292 | [0m[35m    def save_result(self) -> None:[0m
[30;1m293 | [0m[35m        result = self.get_service_result()[0m
[30;1m294 | [0m[35m        result_path = os.path.join([0m
[30;1m295 | [0m[35m            os.environ.get('TASKING_DIR', tempfile.gettempdir()),[0m
[30;1m296 | [0m[35m            f'{self.sid}_{self.sha256}_result.json')[0m
[30;1m297 | [0m[35m        with open(result_path, 'w') as f:[0m
[30;1m298 | [0m[35m            json.dump(result, f, default=str)[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        error = self.get_service_error()[0m
[30;1m285 | [0m[35m        error_path = os.path.join([0m
[30;1m286 | [0m[35m            os.environ.get('TASKING_DIR', tempfile.gettempdir()),[0m
[30;1m287 | [0m[35m            f'{self.sid}_{self.sha256}_error.json')[0m
[30;1m288 | [0m[35m        with open(error_path, 'w') as f:[0m
[30;1m289 | [0m[35m            json.dump(error, f, default=str)[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1314 | [0m[35m[0m
[30;1m1315 | [0m[35m    ris = ResultImageSection(service_request, "title_text_as_str")[0m
[30;1m1316 | [0m[35m[0m
[30;1m1317 | [0m[35m    # Classification, OCR heuristic, OCR_IO, image with no password, auto_add_ocr_section is False[0m
[30;1m1318 | [0m[35m    ocr_heuristic_id = 1[0m
[30;1m1319 | [0m[35m    _, path = tempfile.mkstemp()[0m
[30;1m1320 | [0m[35m    ocr_io = open(path, "w")[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1297 | [0m[35m[0m
[30;1m1298 | [0m[35m    ris = ResultImageSection(service_request, "title_text_as_str")[0m
[30;1m1299 | [0m[35m[0m
[30;1m1300 | [0m[35m    # Classification, OCR heuristic, OCR_IO, image with no password, auto_add_ocr_section is True[0m
[30;1m1301 | [0m[35m    ocr_heuristic_id = 1[0m
[30;1m1302 | [0m[35m    _, path = tempfile.mkstemp()[0m
[30;1m1303 | [0m[35m    ocr_io = open(path, "w")[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m    isb._data.clear()[0m
[30;1m620 | [0m[35m[0m
[30;1m621 | [0m[35m    # Classification, OCR heuristic, OCR_IO, image with no password[0m
[30;1m622 | [0m[35m    ocr_heuristic_id = 1[0m
[30;1m623 | [0m[35m    _, path = tempfile.mkstemp()[0m
[30;1m624 | [0m[35m    ocr_io = open(path, "w")[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m241 | [0m[35m                self._working_directory = self._task.working_directory[0m
[30;1m242 | [0m[35m            else:[0m
[30;1m243 | [0m[35m                # Or create a new working directory[0m
[30;1m244 | [0m[35m                temp_dir = os.path.join(os.environ.get('TASKING_DIR', tempfile.gettempdir()), 'worki[0m
[30;1m245 | [0m[35m                if not os.path.isdir(temp_dir):[0m
[30;1m246 | [0m[35m                    os.makedirs(temp_dir)[0m
[30;1m247 | [0m[35m                self._working_directory = tempfile.mkdtemp(dir=temp_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m29 | [0m[35mUPDATES_DIR = os.environ.get('UPDATES_DIR', '/updates')[0m
[30;1m30 | [0m[35mUPDATES_CA = os.environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m31 | [0m[35mPRIVILEGED = os.environ.get('PRIVILEGED', 'false') == 'true'[0m
[30;1m32 | [0m[35mMIN_SECONDS_BETWEEN_UPDATES = float(os.environ.get('MIN_SECONDS_BETWEEN_UPDATES', '10.0'))[0m
[30;1m33 | [0m[35mSIGNATURES_META_FILENAME = "signatures_meta.json"[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mRECOVERABLE_RE_MSG = [[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mUPDATES_DIR = os.environ.get('UPDATES_DIR', '/updates')[0m
[30;1m30 | [0m[35mUPDATES_CA = os.environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m31 | [0m[35mPRIVILEGED = os.environ.get('PRIVILEGED', 'false') == 'true'[0m
[30;1m32 | [0m[35mMIN_SECONDS_BETWEEN_UPDATES = float(os.environ.get('MIN_SECONDS_BETWEEN_UPDATES', '10.0'))[0m
[30;1m33 | [0m[35mSIGNATURES_META_FILENAME = "signatures_meta.json"[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35mwarnings.filterwarnings("ignore")[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mUPDATES_DIR = os.environ.get('UPDATES_DIR', '/updates')[0m
[30;1m30 | [0m[35mUPDATES_CA = os.environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m31 | [0m[35mPRIVILEGED = os.environ.get('PRIVILEGED', 'false') == 'true'[0m
[30;1m32 | [0m[35mMIN_SECONDS_BETWEEN_UPDATES = float(os.environ.get('MIN_SECONDS_BETWEEN_UPDATES', '10.0'))[0m
[30;1m33 | [0m[35mSIGNATURES_META_FILENAME = "signatures_meta.json"[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35m# Ignore all other warnings that a service's libraries can generate[0m
[30;1m27 | [0m[35mwarnings.filterwarnings("ignore")[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mUPDATES_DIR = os.environ.get('UPDATES_DIR', '/updates')[0m
[30;1m30 | [0m[35mUPDATES_CA = os.environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m31 | [0m[35mPRIVILEGED = os.environ.get('PRIVILEGED', 'false') == 'true'[0m
[30;1m32 | [0m[35mMIN_SECONDS_BETWEEN_UPDATES = float(os.environ.get('MIN_SECONDS_BETWEEN_UPDATES', '10.0'))[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m156 | [0m[35m    # for that line, split on each.[0m
[30;1m157 | [0m[35m    # Also check for matching <> () [] {} instead if it's an opening one preceding.[0m
[30;1m158 | [0m[35m    res = extract_passwords(text)[0m
[30;1m159 | [0m[35m    assert password in res[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m155 | [0m[35m    # if the character preceding the word password in any language is found in the extracted passwor[0m
[30;1m156 | [0m[35m    # for that line, split on each.[0m
[30;1m157 | [0m[35m    # Also check for matching <> () [] {} instead if it's an opening one preceding.[0m
[30;1m158 | [0m[35m    res = extract_passwords(text)[0m
[30;1m159 | [0m[35m    assert password in res[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35m)[0m
[30;1m153 | [0m[35mdef test_non_space_password_delimiter(text, password):[0m
[30;1m154 | [0m[35m    # The use-non-space-as-delimiter[0m
[30;1m155 | [0m[35m    # if the character preceding the word password in any language is found in the extracted passwor[0m
[30;1m156 | [0m[35m    # for that line, split on each.[0m
[30;1m157 | [0m[35m    # Also check for matching <> () [] {} instead if it's an opening one preceding.[0m
[30;1m158 | [0m[35m    res = extract_passwords(text)[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35m)[0m
[30;1m153 | [0m[35mdef test_non_space_password_delimiter(text, password):[0m
[30;1m154 | [0m[35m    # The use-non-space-as-delimiter[0m
[30;1m155 | [0m[35m    # if the character preceding the word password in any language is found in the extracted passwor[0m
[30;1m156 | [0m[35m    # for that line, split on each.[0m
[30;1m157 | [0m[35m    # Also check for matching <> () [] {} instead if it's an opening one preceding.[0m
[30;1m158 | [0m[35m    res = extract_passwords(text)[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m150 | [0m[35m        ("password:1234# and tell me if I can do anything else", "1234#"),[0m
[30;1m151 | [0m[35m    ][0m
[30;1m152 | [0m[35m)[0m
[30;1m153 | [0m[35mdef test_non_space_password_delimiter(text, password):[0m
[30;1m154 | [0m[35m    # The use-non-space-as-delimiter[0m
[30;1m155 | [0m[35m    # if the character preceding the word password in any language is found in the extracted passwor[0m
[30;1m156 | [0m[35m    # for that line, split on each.[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m150 | [0m[35m        ("password:1234# and tell me if I can do anything else", "1234#"),[0m
[30;1m151 | [0m[35m    ][0m
[30;1m152 | [0m[35m)[0m
[30;1m153 | [0m[35mdef test_non_space_password_delimiter(text, password):[0m
[30;1m154 | [0m[35m    # The use-non-space-as-delimiter[0m
[30;1m155 | [0m[35m    # if the character preceding the word password in any language is found in the extracted passwor[0m
[30;1m156 | [0m[35m    # for that line, split on each.[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m147 | [0m[35m        ("(mot de passe: 1234#@!)", "1234#@!"),[0m
[30;1m148 | [0m[35m        ("(mot de passe: 1234#@!)", " 1234#@!"),[0m
[30;1m149 | [0m[35m        # Password-keyword starting line shouldn't cause any problem[0m
[30;1m150 | [0m[35m        ("password:1234# and tell me if I can do anything else", "1234#"),[0m
[30;1m151 | [0m[35m    ][0m
[30;1m152 | [0m[35m)[0m
[30;1m153 | [0m[35mdef test_non_space_password_delimiter(text, password):[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m146 | [0m[35m        ("(mot de passe:1234#@!)", "1234#@!"),[0m
[30;1m147 | [0m[35m        ("(mot de passe: 1234#@!)", "1234#@!"),[0m
[30;1m148 | [0m[35m        ("(mot de passe: 1234#@!)", " 1234#@!"),[0m
[30;1m149 | [0m[35m        # Password-keyword starting line shouldn't cause any problem[0m
[30;1m150 | [0m[35m        ("password:1234# and tell me if I can do anything else", "1234#"),[0m
[30;1m151 | [0m[35m    ][0m
[30;1m152 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m        ("Please use attached<password:1234#@!> and tell me if I can do anything else", "1234#@!"),[0m
[30;1m143 | [0m[35m        ("Please use attached password:1234#@!) and tell me if I can do anything else", "1234#@!)"),[0m
[30;1m144 | [0m[35m        ("Please use attached(password:1234#@!) and tell me if I can do anything else", "1234#@!"),[0m
[30;1m145 | [0m[35m        ("Please use attached(password: 1234#@!) and tell me if I can do anything else", "1234#@!"),[0m
[30;1m146 | [0m[35m        ("(mot de passe:1234#@!)", "1234#@!"),[0m
[30;1m147 | [0m[35m        ("(mot de passe: 1234#@!)", "1234#@!"),[0m
[30;1m148 | [0m[35m        ("(mot de passe: 1234#@!)", " 1234#@!"),[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m141 | [0m[35m        ("Please use attached[password:1234#@!] and tell me if I can do anything else", "1234#@!"),[0m
[30;1m142 | [0m[35m        ("Please use attached<password:1234#@!> and tell me if I can do anything else", "1234#@!"),[0m
[30;1m143 | [0m[35m        ("Please use attached password:1234#@!) and tell me if I can do anything else", "1234#@!)"),[0m
[30;1m144 | [0m[35m        ("Please use attached(password:1234#@!) and tell me if I can do anything else", "1234#@!"),[0m
[30;1m145 | [0m[35m        ("Please use attached(password: 1234#@!) and tell me if I can do anything else", "1234#@!"),[0m
[30;1m146 | [0m[35m        ("(mot de passe:1234#@!)", "1234#@!"),[0m
[30;1m147 | [0m[35m        ("(mot de passe: 1234#@!)", "1234#@!"),[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m140 | [0m[35mssword:1234#@!## and tell me if I can do anything else", "1234#@!#"),[0m
[30;1m141 | [0m[35m        ("Please use attached[password:1234#@!] and tell me if I can do anything else", "1234#@!"),[0m
[30;1m142 | [0m[35m        ("Please use attached<password:1234#@!> and tell me if I can do anything else", "1234#@!"),[0m
[30;1m143 | [0m[35m        ("Please use attached password:1234#@!) and tell me if I can do anything else", "1234#@!)"),[0m
[30;1m144 | [0m[35m        ("Please use attached(password:1234#@!) and tell me if I can do anything else", "1234#@!"),[0m
[30;1m145 | [0m[35m        ("Please use attached(password: 1234#@!) and tell me if I can do anything else", "1234#@!"),[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m139 | [0m[35mssword:1234#@!# and tell me if I can do anything else", "1234#@!"),[0m
[30;1m140 | [0m[35m        ("Please use attached#password:1234#@!## and tell me if I can do anything else", "1234#@!#")[0m
[30;1m141 | [0m[35m        ("Please use attached[password:1234#@!] and tell me if I can do anything else", "1234#@!"),[0m
[30;1m142 | [0m[35m        ("Please use attached<password:1234#@!> and tell me if I can do anything else", "1234#@!"),[0m
[30;1m143 | [0m[35m        ("Please use attached password:1234#@!) and tell me if I can do anything else", "1234#@!)"),[0m
[30;1m144 | [0m[35m        ("Please use attached(password:1234#@!) and tell me if I can do anything else", "1234#@!"),[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m133 | [0m[35md_password)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m@pytest.mark.parametrize([0m
[30;1m137 | [0m[35m    "text, password",[0m
[30;1m138 | [0m[35m    [[0m
[30;1m139 | [0m[35m        ("Please use attached#password:1234#@!# and tell me if I can do anything else", "1234#@!"),[0m
[30;1m140 | [0m[35m        ("Please use attached#password:1234#@!## and tell me if I can do anything else", "1234#@!#")[0m
[30;1m141 | [0m[35m        ("Please use attached[password:1234#@!] and tell me if I can do anything else", "1234#@!"),[0m
[30;1m142 | [0m[35m        ("Please use attached<password:1234#@!> and tell me if I can do anything else", "1234#@!"),[0m
[30;1m143 | [0m[35m        ("Please use attached password:1234#@!) and tell me if I can do anything else", "1234#@!)"),[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m137 | [0m[35m    "text, password",[0m
[30;1m138 | [0m[35m    [[0m
[30;1m139 | [0m[35m        ("Please use attached#password:1234#@!# and tell me if I can do anything else", "1234#@!"),[0m
[30;1m140 | [0m[35m        ("Please use attached#password:1234#@!## and tell me if I can do anything else", "1234#@!#")[0m
[30;1m141 | [0m[35m        ("Please use attached[password:1234#@!] and tell me if I can do anything else", "1234#@!"),[0m
[30;1m142 | [0m[35m        ("Please use attached<password:1234#@!> and tell me if I can do anything else", "1234#@!"),[0m
[30;1m143 | [0m[35m        ("Please use attached password:1234#@!) and tell me if I can do anything else", "1234#@!)"),[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m136 | [0m[35m@pytest.mark.parametrize([0m
[30;1m137 | [0m[35m    "text, password",[0m
[30;1m138 | [0m[35m    [[0m
[30;1m139 | [0m[35m        ("Please use attached#password:1234#@!# and tell me if I can do anything else", "1234#@!"),[0m
[30;1m140 | [0m[35m        ("Please use attached#password:1234#@!## and tell me if I can do anything else", "1234#@!#")[0m
[30;1m141 | [0m[35m        ("Please use attached[password:1234#@!] and tell me if I can do anything else", "1234#@!"),[0m
[30;1m142 | [0m[35m        ("Please use attached<password:1234#@!> and tell me if I can do anything else", "1234#@!"),[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m@pytest.mark.parametrize([0m
[30;1m137 | [0m[35m    "text, password",[0m
[30;1m138 | [0m[35m    [[0m
[30;1m139 | [0m[35m        ("Please use attached#password:1234#@!# and tell me if I can do anything else", "1234#@!"),[0m
[30;1m140 | [0m[35m        ("Please use attached#password:1234#@!## and tell me if I can do anything else", "1234#@!#")[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m
[30;1m131 | [0m[35m    wanted_password = ["shibboleet"][0m
[30;1m132 | [0m[35m    res = extract_passwords(text)[0m
[30;1m133 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m@pytest.mark.parametrize([0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m
[30;1m131 | [0m[35m    wanted_password = ["shibboleet"][0m
[30;1m132 | [0m[35m    res = extract_passwords(text)[0m
[30;1m133 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m@pytest.mark.parametrize([0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m
[30;1m131 | [0m[35m    wanted_password = ["shibboleet"][0m
[30;1m132 | [0m[35m    res = extract_passwords(text)[0m
[30;1m133 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m@pytest.mark.parametrize([0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m
[30;1m131 | [0m[35m    wanted_password = ["shibboleet"][0m
[30;1m132 | [0m[35m    res = extract_passwords(text)[0m
[30;1m133 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m128 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m
[30;1m131 | [0m[35m    wanted_password = ["shibboleet"][0m
[30;1m132 | [0m[35m    res = extract_passwords(text)[0m
[30;1m133 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m
[30;1m126 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m127 | [0m[35m    res = extract_passwords(text)[0m
[30;1m128 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m
[30;1m131 | [0m[35m    wanted_password = ["shibboleet"][0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m
[30;1m126 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m127 | [0m[35m    res = extract_passwords(text)[0m
[30;1m128 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m
[30;1m131 | [0m[35m    wanted_password = ["shibboleet"][0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m
[30;1m126 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m127 | [0m[35m    res = extract_passwords(text)[0m
[30;1m128 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m
[30;1m131 | [0m[35m    wanted_password = ["shibboleet"][0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m
[30;1m126 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m127 | [0m[35m    res = extract_passwords(text)[0m
[30;1m128 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    text = "ÎÇ¥ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî shibboleetÏûÖÎãàÎã§"[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m123 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m
[30;1m126 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m127 | [0m[35m    res = extract_passwords(text)[0m
[30;1m128 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m129 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m
[30;1m121 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m122 | [0m[35m    res = extract_passwords(text)[0m
[30;1m123 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m
[30;1m126 | [0m[35m    wanted_password = ["mon secret"][0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m
[30;1m121 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m122 | [0m[35m    res = extract_passwords(text)[0m
[30;1m123 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m
[30;1m126 | [0m[35m    wanted_password = ["mon secret"][0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m
[30;1m121 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m122 | [0m[35m    res = extract_passwords(text)[0m
[30;1m123 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m
[30;1m126 | [0m[35m    wanted_password = ["mon secret"][0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m
[30;1m121 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m122 | [0m[35m    res = extract_passwords(text)[0m
[30;1m123 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    text = 'mot de passe: "mon secret"\n'[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m
[30;1m121 | [0m[35m    wanted_password = ["mon secret"][0m
[30;1m122 | [0m[35m    res = extract_passwords(text)[0m
[30;1m123 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m
[30;1m117 | [0m[35m    res = extract_passwords(text)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m
[30;1m121 | [0m[35m    wanted_password = ["mon secret"][0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m
[30;1m117 | [0m[35m    res = extract_passwords(text)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m
[30;1m121 | [0m[35m    wanted_password = ["mon secret"][0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m
[30;1m117 | [0m[35m    res = extract_passwords(text)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m
[30;1m121 | [0m[35m    wanted_password = ["mon secret"][0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m
[30;1m117 | [0m[35m    res = extract_passwords(text)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    text = "mot de passe: mon secret\n"[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m
[30;1m117 | [0m[35m    res = extract_passwords(text)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m
[30;1m117 | [0m[35m    res = extract_passwords(text)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m
[30;1m117 | [0m[35m    res = extract_passwords(text)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m
[30;1m117 | [0m[35m    res = extract_passwords(text)[0m
[30;1m118 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m
[30;1m116 | [0m[35m    wanted_password = ["the password"][0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    text = 'password: "the password"\n'[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m    res = extract_passwords(text)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m    res = extract_passwords(text)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m
[30;1m112 | [0m[35m    res = extract_passwords(text)[0m
[30;1m113 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m
[30;1m107 | [0m[35m    res = extract_passwords(text)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m
[30;1m107 | [0m[35m    res = extract_passwords(text)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m
[30;1m107 | [0m[35m    res = extract_passwords(text)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m
[30;1m111 | [0m[35m    wanted_password = ["the password"][0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m
[30;1m107 | [0m[35m    res = extract_passwords(text)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    text = "password: the password\n"[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m
[30;1m107 | [0m[35m    res = extract_passwords(text)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m    res = extract_passwords(text)[0m
[30;1m103 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m
[30;1m107 | [0m[35m    res = extract_passwords(text)[0m
[30;1m108 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m
[30;1m101 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m102 | [0m[35m    res = extract_passwords(text)[0m
[30;1m103 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m
[30;1m101 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m102 | [0m[35m    res = extract_passwords(text)[0m
[30;1m103 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m
[30;1m101 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m102 | [0m[35m    res = extract_passwords(text)[0m
[30;1m103 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m
[30;1m106 | [0m[35m    wanted_password = ["AB5675"][0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m
[30;1m101 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m102 | [0m[35m    res = extract_passwords(text)[0m
[30;1m103 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    text = "password: AB5675.\n"[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m
[30;1m101 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m102 | [0m[35m    res = extract_passwords(text)[0m
[30;1m103 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m
[30;1m96 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m97 | [0m[35m    res = extract_passwords(text)[0m
[30;1m98 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m
[30;1m101 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m
[30;1m96 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m97 | [0m[35m    res = extract_passwords(text)[0m
[30;1m98 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m
[30;1m101 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m
[30;1m96 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m97 | [0m[35m    res = extract_passwords(text)[0m
[30;1m98 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m
[30;1m101 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m
[30;1m96 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m97 | [0m[35m    res = extract_passwords(text)[0m
[30;1m98 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    text = "mot de passe:'Kahj#@!!45'\n"[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m93 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m
[30;1m96 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m97 | [0m[35m    res = extract_passwords(text)[0m
[30;1m98 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m
[30;1m91 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m92 | [0m[35m    res = extract_passwords(text)[0m
[30;1m93 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m
[30;1m96 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m
[30;1m91 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m92 | [0m[35m    res = extract_passwords(text)[0m
[30;1m93 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m
[30;1m96 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m
[30;1m91 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m92 | [0m[35m    res = extract_passwords(text)[0m
[30;1m93 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m
[30;1m96 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m
[30;1m91 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m92 | [0m[35m    res = extract_passwords(text)[0m
[30;1m93 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    text = "mot de passe: 'Kahj#@!!45'\n"[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m88 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m
[30;1m91 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m92 | [0m[35m    res = extract_passwords(text)[0m
[30;1m93 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m
[30;1m86 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m87 | [0m[35m    res = extract_passwords(text)[0m
[30;1m88 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m
[30;1m91 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m
[30;1m86 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m87 | [0m[35m    res = extract_passwords(text)[0m
[30;1m88 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m
[30;1m91 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m
[30;1m86 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m87 | [0m[35m    res = extract_passwords(text)[0m
[30;1m88 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m
[30;1m91 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m
[30;1m86 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m87 | [0m[35m    res = extract_passwords(text)[0m
[30;1m88 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    text = 'mot de passe:"Kahj#@!!45"\n'[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m
[30;1m86 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m87 | [0m[35m    res = extract_passwords(text)[0m
[30;1m88 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m
[30;1m81 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m82 | [0m[35m    res = extract_passwords(text)[0m
[30;1m83 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m
[30;1m86 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m
[30;1m81 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m82 | [0m[35m    res = extract_passwords(text)[0m
[30;1m83 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m
[30;1m86 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m
[30;1m81 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m82 | [0m[35m    res = extract_passwords(text)[0m
[30;1m83 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m
[30;1m86 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m
[30;1m81 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m82 | [0m[35m    res = extract_passwords(text)[0m
[30;1m83 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    text = 'mot de passe: "Kahj#@!!45"\n'[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m78 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m
[30;1m81 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m82 | [0m[35m    res = extract_passwords(text)[0m
[30;1m83 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m77 | [0m[35m    res = extract_passwords(text)[0m
[30;1m78 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m
[30;1m81 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m77 | [0m[35m    res = extract_passwords(text)[0m
[30;1m78 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m
[30;1m81 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m77 | [0m[35m    res = extract_passwords(text)[0m
[30;1m78 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m
[30;1m81 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m77 | [0m[35m    res = extract_passwords(text)[0m
[30;1m78 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    text = "mot de passe:Kahj#@!!45\n"[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m73 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m77 | [0m[35m    res = extract_passwords(text)[0m
[30;1m78 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m72 | [0m[35m    res = extract_passwords(text)[0m
[30;1m73 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m77 | [0m[35m    res = extract_passwords(text)[0m
[30;1m78 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m72 | [0m[35m    res = extract_passwords(text)[0m
[30;1m73 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m72 | [0m[35m    res = extract_passwords(text)[0m
[30;1m73 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m72 | [0m[35m    res = extract_passwords(text)[0m
[30;1m73 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m
[30;1m76 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m72 | [0m[35m    res = extract_passwords(text)[0m
[30;1m73 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    text = "Password:'1jdhQ-9!h$'\n"[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m68 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m72 | [0m[35m    res = extract_passwords(text)[0m
[30;1m73 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m    res = extract_passwords(text)[0m
[30;1m68 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m72 | [0m[35m    res = extract_passwords(text)[0m
[30;1m73 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m67 | [0m[35m    res = extract_passwords(text)[0m
[30;1m68 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m67 | [0m[35m    res = extract_passwords(text)[0m
[30;1m68 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m67 | [0m[35m    res = extract_passwords(text)[0m
[30;1m68 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m
[30;1m71 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m67 | [0m[35m    res = extract_passwords(text)[0m
[30;1m68 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    text = "Password: '1jdhQ-9!h$'\n"[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m67 | [0m[35m    res = extract_passwords(text)[0m
[30;1m68 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m    res = extract_passwords(text)[0m
[30;1m63 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m67 | [0m[35m    res = extract_passwords(text)[0m
[30;1m68 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m62 | [0m[35m    res = extract_passwords(text)[0m
[30;1m63 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m62 | [0m[35m    res = extract_passwords(text)[0m
[30;1m63 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m62 | [0m[35m    res = extract_passwords(text)[0m
[30;1m63 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m
[30;1m66 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m62 | [0m[35m    res = extract_passwords(text)[0m
[30;1m63 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    text = 'password:"Kahj#@!!45"\n'[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m58 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m62 | [0m[35m    res = extract_passwords(text)[0m
[30;1m63 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m    res = extract_passwords(text)[0m
[30;1m58 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m
[30;1m62 | [0m[35m    res = extract_passwords(text)[0m
[30;1m63 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m57 | [0m[35m    res = extract_passwords(text)[0m
[30;1m58 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m57 | [0m[35m    res = extract_passwords(text)[0m
[30;1m58 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m57 | [0m[35m    res = extract_passwords(text)[0m
[30;1m58 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m
[30;1m61 | [0m[35m    wanted_password = ["Kahj#@!!45"][0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m57 | [0m[35m    res = extract_passwords(text)[0m
[30;1m58 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    text = 'password: "Kahj#@!!45"\n'[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m53 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m57 | [0m[35m    res = extract_passwords(text)[0m
[30;1m58 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m    res = extract_passwords(text)[0m
[30;1m53 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m
[30;1m57 | [0m[35m    res = extract_passwords(text)[0m
[30;1m58 | [0m[35m    assert all(password in res for password in wanted_password)[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m        "Kahj#@!!45",[0m
[30;1m51 | [0m[35m    ][0m
[30;1m52 | [0m[35m    res = extract_passwords(text)[0m
[30;1m53 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m        "Kahj#@!!45",[0m
[30;1m51 | [0m[35m    ][0m
[30;1m52 | [0m[35m    res = extract_passwords(text)[0m
[30;1m53 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m        "Kahj#@!!45",[0m
[30;1m51 | [0m[35m    ][0m
[30;1m52 | [0m[35m    res = extract_passwords(text)[0m
[30;1m53 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m
[30;1m56 | [0m[35m    wanted_password = ["1jdhQ-9!h$"][0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m        "dhfkIJK892",[0m
[30;1m50 | [0m[35m        "Kahj#@!!45",[0m
[30;1m51 | [0m[35m    ][0m
[30;1m52 | [0m[35m    res = extract_passwords(text)[0m
[30;1m53 | [0m[35m    assert all(password in res for password in wanted_password)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    text = "Password:1jdhQ-9!h$\n"[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m
[30;1m37 | [0m[35m    )[0m
[30;1m38 | [0m[35m    wanted_password = [[0m
[30;1m39 | [0m[35m        "A",[0m
[30;1m40 | [0m[35m        "B",[0m
[30;1m41 | [0m[35m        "C",[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m
[30;1m37 | [0m[35m    )[0m
[30;1m38 | [0m[35m    wanted_password = [[0m
[30;1m39 | [0m[35m        "A",[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m
[30;1m37 | [0m[35m    )[0m
[30;1m38 | [0m[35m    wanted_password = [[0m
[30;1m39 | [0m[35m        "A",[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m
[30;1m37 | [0m[35m    )[0m
[30;1m38 | [0m[35m    wanted_password = [[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m
[30;1m37 | [0m[35m    )[0m
[30;1m38 | [0m[35m    wanted_password = [[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m
[30;1m37 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m
[30;1m37 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m
[30;1m37 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m
[30;1m34 | [0m[35m        "Test string\npassword: E \nTest string\nPassword: dhfkIJK891\nTest string\nPassword: dh_!l-[0m
[30;1m35 | [0m[35m        "Test string\nThe Password is: F\nTest string\nPassword:\nG\nTest string\nMot de passe: H\n"[0m
[30;1m36 | [0m[35m        "Test string\nPassword:\ndhfkIJK892\nTest string\nPassword:\nKahj#@!!45\n"[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m
[30;1m29 | [0m[35m    res = extract_passwords(text)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m
[30;1m29 | [0m[35m    res = extract_passwords(text)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m
[30;1m29 | [0m[35m    res = extract_passwords(text)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m
[30;1m33 | [0m[35m        "Password : A\nTest string \nPassword: B\nTest string\npassword:C\nTest string\npassword: D\[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m
[30;1m29 | [0m[35m    res = extract_passwords(text)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    text = ([0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m
[30;1m29 | [0m[35m    res = extract_passwords(text)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m    res = extract_passwords(text)[0m
[30;1m25 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m
[30;1m29 | [0m[35m    res = extract_passwords(text)[0m
[30;1m30 | [0m[35m    assert all([password in res for password in wanted_password])[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m
[30;1m23 | [0m[35m    wanted_password = ["A"][0m
[30;1m24 | [0m[35m    res = extract_passwords(text)[0m
[30;1m25 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m
[30;1m23 | [0m[35m    wanted_password = ["A"][0m
[30;1m24 | [0m[35m    res = extract_passwords(text)[0m
[30;1m25 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m
[30;1m23 | [0m[35m    wanted_password = ["A"][0m
[30;1m24 | [0m[35m    res = extract_passwords(text)[0m
[30;1m25 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m
[30;1m28 | [0m[35m    wanted_password = ["ABCDE"][0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m
[30;1m23 | [0m[35m    wanted_password = ["A"][0m
[30;1m24 | [0m[35m    res = extract_passwords(text)[0m
[30;1m25 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    text = "Invoice Password: ABCDE"[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m    assert res == {"Password", "Password:"}[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m
[30;1m23 | [0m[35m    wanted_password = ["A"][0m
[30;1m24 | [0m[35m    res = extract_passwords(text)[0m
[30;1m25 | [0m[35m    assert all([password in res for password in wanted_password])[0m
[30;1m26 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m19 | [0m[35m    res = extract_passwords(text)[0m
[30;1m20 | [0m[35m    assert res == {"Password", "Password:"}[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m
[30;1m23 | [0m[35m    wanted_password = ["A"][0m
[30;1m24 | [0m[35m    res = extract_passwords(text)[0m
[30;1m25 | [0m[35m    assert all([password in res for password in wanted_password])[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m    # give us an empty password[0m
[30;1m18 | [0m[35m    text = "Password:"[0m
[30;1m19 | [0m[35m    res = extract_passwords(text)[0m
[30;1m20 | [0m[35m    assert res == {"Password", "Password:"}[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m
[30;1m23 | [0m[35m    wanted_password = ["A"][0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m    # give us an empty password[0m
[30;1m18 | [0m[35m    text = "Password:"[0m
[30;1m19 | [0m[35m    res = extract_passwords(text)[0m
[30;1m20 | [0m[35m    assert res == {"Password", "Password:"}[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m
[30;1m23 | [0m[35m    wanted_password = ["A"][0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35m    # Make sure a string that only contains the text "password:" does not[0m
[30;1m17 | [0m[35m    # give us an empty password[0m
[30;1m18 | [0m[35m    text = "Password:"[0m
[30;1m19 | [0m[35m    res = extract_passwords(text)[0m
[30;1m20 | [0m[35m    assert res == {"Password", "Password:"}[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    text = "Invoice Password: A"[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    # Make sure a string that only contains the text "password:" does not[0m
[30;1m17 | [0m[35m    # give us an empty password[0m
[30;1m18 | [0m[35m    text = "Password:"[0m
[30;1m19 | [0m[35m    res = extract_passwords(text)[0m
[30;1m20 | [0m[35m    assert res == {"Password", "Password:"}[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14 | [0m[35m    assert res == set()[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    # Make sure a string that only contains the text "password:" does not[0m
[30;1m17 | [0m[35m    # give us an empty password[0m
[30;1m18 | [0m[35m    text = "Password:"[0m
[30;1m19 | [0m[35m    res = extract_passwords(text)[0m
[30;1m20 | [0m[35m    assert res == {"Password", "Password:"}[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35m    res = extract_passwords(text)[0m
[30;1m14 | [0m[35m    assert res == set()[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    # Make sure a string that only contains the text "password:" does not[0m
[30;1m17 | [0m[35m    # give us an empty password[0m
[30;1m18 | [0m[35m    text = "Password:"[0m
[30;1m19 | [0m[35m    res = extract_passwords(text)[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    # Make sure an empty string doesn't cause any problem[0m
[30;1m12 | [0m[35m    text = "\n"[0m
[30;1m13 | [0m[35m    res = extract_passwords(text)[0m
[30;1m14 | [0m[35m    assert res == set()[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    # Make sure a string that only contains the text "password:" does not[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35mdef test_extract_passwords():[0m
[30;1m6 | [0m[35m    # Make sure an empty string doesn't cause any problem[0m
[30;1m7 | [0m[35m    text = ""[0m
[30;1m8 | [0m[35m    res = extract_passwords(text)[0m
[30;1m9 | [0m[35m    assert res == set()[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    # Make sure an empty string doesn't cause any problem[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2 | [0m[35mfrom assemblyline_v4_service.common.utils import extract_passwords[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mdef test_extract_passwords():[0m
[30;1m6 | [0m[35m    # Make sure an empty string doesn't cause any problem[0m
[30;1m7 | [0m[35m    text = ""[0m
[30;1m8 | [0m[35m    res = extract_passwords(text)[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test_common/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1 | [0m[35mimport pytest[0m
[30;1m2 | [0m[35mfrom assemblyline_v4_service.common.utils import extract_passwords[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mdef test_extract_passwords():[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m338 | [0m[35m            "magic": "blah",[0m
[30;1m339 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m340 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m341 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m342 | [0m[35m            "size": 0,[0m
[30;1m343 | [0m[35m            "type": "text/plain",[0m
[30;1m344 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m337 | [0m[35m        "fileinfo": {[0m
[30;1m338 | [0m[35m            "magic": "blah",[0m
[30;1m339 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m340 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m341 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m342 | [0m[35m            "size": 0,[0m
[30;1m343 | [0m[35m            "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m272 | [0m[35m            "magic": "blah",[0m
[30;1m273 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m274 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m275 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m276 | [0m[35m            "size": 0,[0m
[30;1m277 | [0m[35m            "type": "text/plain",[0m
[30;1m278 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m271 | [0m[35m        "fileinfo": {[0m
[30;1m272 | [0m[35m            "magic": "blah",[0m
[30;1m273 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m274 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m275 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m276 | [0m[35m            "size": 0,[0m
[30;1m277 | [0m[35m            "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m224 | [0m[35m            "magic": "blah",[0m
[30;1m225 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m226 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m227 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m228 | [0m[35m            "size": 0,[0m
[30;1m229 | [0m[35m            "type": "text/plain",[0m
[30;1m230 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m223 | [0m[35m        "fileinfo": {[0m
[30;1m224 | [0m[35m            "magic": "blah",[0m
[30;1m225 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m226 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m227 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m228 | [0m[35m            "size": 0,[0m
[30;1m229 | [0m[35m            "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m202 | [0m[35m            "magic": "blah",[0m
[30;1m203 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m204 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m205 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m206 | [0m[35m            "size": 0,[0m
[30;1m207 | [0m[35m            "type": "text/plain",[0m
[30;1m208 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m201 | [0m[35m        "fileinfo": {[0m
[30;1m202 | [0m[35m            "magic": "blah",[0m
[30;1m203 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m204 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m205 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m206 | [0m[35m            "size": 0,[0m
[30;1m207 | [0m[35m            "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m178 | [0m[35m            "magic": "blah",[0m
[30;1m179 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m180 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m181 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m182 | [0m[35m            "size": 0,[0m
[30;1m183 | [0m[35m            "type": "text/plain",[0m
[30;1m184 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m177 | [0m[35m        "fileinfo": {[0m
[30;1m178 | [0m[35m            "magic": "blah",[0m
[30;1m179 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m180 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m181 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m182 | [0m[35m            "size": 0,[0m
[30;1m183 | [0m[35m            "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m142 | [0m[35m            "magic": "blah",[0m
[30;1m143 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m144 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m145 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m146 | [0m[35m            "size": 0,[0m
[30;1m147 | [0m[35m            "type": "text/plain",[0m
[30;1m148 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m141 | [0m[35m        "fileinfo": {[0m
[30;1m142 | [0m[35m            "magic": "blah",[0m
[30;1m143 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m144 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m145 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m146 | [0m[35m            "size": 0,[0m
[30;1m147 | [0m[35m            "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_ocr.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m8 | [0m[35m@pytest.mark.skipif(len(TESSERACT_LIST) < 1, reason="Requires tesseract-ocr apt package")[0m
[30;1m9 | [0m[35mdef test_ocr_detections():[0m
[30;1m10 | [0m[35m    update_ocr_config()[0m
[30;1m11 | [0m[35m    file_path = os.path.join(os.path.dirname(__file__), "b32969aa664e3905c20f865cdd7b921f922678f5c38[0m
[30;1m12 | [0m[35m    assert ocr_detections(file_path) == {[0m
[30;1m13 | [0m[35m        'ransomware': [[0m
[30;1m14 | [0m[35m            "YOUR FILES HAVE BEEN ENCRYPTED AND YOU WON'T BE ABLE TO "[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35mdef test_file_contents(service_request):[0m
[30;1m287 | [0m[35m    file_path = os.path.join(tempfile.gettempdir(), "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934[0m
[30;1m288 | [0m[35m    with open(file_path, "w") as f:[0m
[30;1m289 | [0m[35m        f.write("")[0m
[30;1m290 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m276 | [0m[35m        service_request.file_path[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    # File exists now[0m
[30;1m279 | [0m[35m    file_path = os.path.join(tempfile.gettempdir(), "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934[0m
[30;1m280 | [0m[35m    with open(file_path, "w") as f:[0m
[30;1m281 | [0m[35m        f.write("")[0m
[30;1m282 | [0m[35m    assert service_request.file_path == file_path[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m260 | [0m[35m            'name': 'name',[0m
[30;1m261 | [0m[35m            'parent_relation': 'INFORMATION',[0m
[30;1m262 | [0m[35m            'path': path,[0m
[30;1m263 | [0m[35m            'sha256': '9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08'[0m
[30;1m264 | [0m[35m        },[0m
[30;1m265 | [0m[35m    ][0m
[30;1m266 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m221 | [0m[35m    assert data["thumb"] == {[0m
[30;1m222 | [0m[35m        'description': 'description of image (thumbnail)',[0m
[30;1m223 | [0m[35m        'name': 'image_name.thumb',[0m
[30;1m224 | [0m[35m        'sha256': '558358f966f17197a6a8dd479b99b6d5428f0848bc4c2b2511e6f34f5d2db645'[0m
[30;1m225 | [0m[35m    }[0m
[30;1m226 | [0m[35m    assert data["ocr_section"].__dict__["section_body"].__dict__ == {[0m
[30;1m227 | [0m[35m        '_config': {},[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m216 | [0m[35m    assert data["img"] == {[0m
[30;1m217 | [0m[35m        'description': 'description of image',[0m
[30;1m218 | [0m[35m        'name': 'image_name',[0m
[30;1m219 | [0m[35m        'sha256': '9dac3e45d5a20626b5a96bcfb708160fb36690c41d07cad912289186726f9e57'[0m
[30;1m220 | [0m[35m    }[0m
[30;1m221 | [0m[35m    assert data["thumb"] == {[0m
[30;1m222 | [0m[35m        'description': 'description of image (thumbnail)',[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m208 | [0m[35m    # Classification, OCR heuristic, OCR_IO, image with password[0m
[30;1m209 | [0m[35m    image_path = os.path.join([0m
[30;1m210 | [0m[35m        os.path.dirname(__file__),[0m
[30;1m211 | [0m[35m        "4031ed8786439eee24b87f84901e38038a76b8c55e9d87dd5a7d88df2806c1cf")[0m
[30;1m212 | [0m[35m    _, path = tempfile.mkstemp()[0m
[30;1m213 | [0m[35m    ocr_io = open(path, "w")[0m
[30;1m214 | [0m[35m    data = service_request.add_image(image_path, "image_name", "description of image",[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m169 | [0m[35m    assert data["thumb"] == {[0m
[30;1m170 | [0m[35m        'description': 'description of image (thumbnail)',[0m
[30;1m171 | [0m[35m        'name': 'image_name.thumb',[0m
[30;1m172 | [0m[35m        'sha256': '1af0e0d99845493b64cf402b3704170f17ecf15001714016e48f9d4854218901'[0m
[30;1m173 | [0m[35m    }[0m
[30;1m174 | [0m[35m    assert data["ocr_section"].__dict__["section_body"].__dict__ == {[0m
[30;1m175 | [0m[35m        '_config': {},[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m164 | [0m[35m    assert data["img"] == {[0m
[30;1m165 | [0m[35m        'description': 'description of image',[0m
[30;1m166 | [0m[35m        'name': 'image_name',[0m
[30;1m167 | [0m[35m        'sha256': '09bf99ab5431af13b701a06dc2b04520aea9fd346584fa2a034d6d4af0c57329'[0m
[30;1m168 | [0m[35m    }[0m
[30;1m169 | [0m[35m    assert data["thumb"] == {[0m
[30;1m170 | [0m[35m        'description': 'description of image (thumbnail)',[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m149 | [0m[35m            'is_supplementary': True,[0m
[30;1m150 | [0m[35m            'name': 'image_name.thumb',[0m
[30;1m151 | [0m[35m            'parent_relation': 'INFORMATION',[0m
[30;1m152 | [0m[35m            'sha256': '1af0e0d99845493b64cf402b3704170f17ecf15001714016e48f9d4854218901'[0m
[30;1m153 | [0m[35m        },[0m
[30;1m154 | [0m[35m    ][0m
[30;1m155 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m139 | [0m[35m            'is_supplementary': True,[0m
[30;1m140 | [0m[35m            'name': 'image_name',[0m
[30;1m141 | [0m[35m            'parent_relation': 'INFORMATION',[0m
[30;1m142 | [0m[35m            'sha256': '09bf99ab5431af13b701a06dc2b04520aea9fd346584fa2a034d6d4af0c57329'[0m
[30;1m143 | [0m[35m        },[0m
[30;1m144 | [0m[35m        {[0m
[30;1m145 | [0m[35m            'allow_dynamic_recursion': False,[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m124 | [0m[35m        'thumb': {[0m
[30;1m125 | [0m[35m            'description': 'description of image (thumbnail)',[0m
[30;1m126 | [0m[35m            'name': 'image_name.thumb',[0m
[30;1m127 | [0m[35m            'sha256': '1af0e0d99845493b64cf402b3704170f17ecf15001714016e48f9d4854218901'[0m
[30;1m128 | [0m[35m        }[0m
[30;1m129 | [0m[35m    }[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m119 | [0m[35m        'img': {[0m
[30;1m120 | [0m[35m            'description': 'description of image',[0m
[30;1m121 | [0m[35m            'name': 'image_name',[0m
[30;1m122 | [0m[35m            'sha256': '09bf99ab5431af13b701a06dc2b04520aea9fd346584fa2a034d6d4af0c57329'[0m
[30;1m123 | [0m[35m        },[0m
[30;1m124 | [0m[35m        'thumb': {[0m
[30;1m125 | [0m[35m            'description': 'description of image (thumbnail)',[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m112 | [0m[35mdef test_add_image(service_request):[0m
[30;1m113 | [0m[35m    image_path = os.path.join([0m
[30;1m114 | [0m[35m        os.path.dirname(__file__),[0m
[30;1m115 | [0m[35m        "b32969aa664e3905c20f865cdd7b921f922678f5c3850c78e4c803fbc1757a8e")[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    # Basic[0m
[30;1m118 | [0m[35m    assert service_request.add_image(image_path, "image_name", "description of image") == {[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m103 | [0m[35m            'name': 'name',[0m
[30;1m104 | [0m[35m            'parent_relation': 'DYNAMIC',[0m
[30;1m105 | [0m[35m            'path': path,[0m
[30;1m106 | [0m[35m            'sha256': '9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08'[0m
[30;1m107 | [0m[35m        },[0m
[30;1m108 | [0m[35m    ][0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m76 | [0m[35m            'name': 'name',[0m
[30;1m77 | [0m[35m            'parent_relation': 'EXTRACTED',[0m
[30;1m78 | [0m[35m            'path': path,[0m
[30;1m79 | [0m[35m            'sha256': '9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08'[0m
[30;1m80 | [0m[35m        },[0m
[30;1m81 | [0m[35m    ][0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m49 | [0m[35m    assert service_request.max_extracted == 0[0m
[30;1m50 | [0m[35m    assert service_request.md5 == "d41d8cd98f00b204e9800998ecf8427e"[0m
[30;1m51 | [0m[35m    assert service_request.sha1 == "da39a3ee5e6b4b0d3255bfef95601890afd80709"[0m
[30;1m52 | [0m[35m    assert service_request.sha256 == "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b8[0m
[30;1m53 | [0m[35m    assert isinstance(service_request.sid, str)[0m
[30;1m54 | [0m[35m    assert isinstance(service_request.task, Task)[0m
[30;1m55 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m48 | [0m[35m    assert service_request._file_path is None[0m
[30;1m49 | [0m[35m    assert service_request.max_extracted == 0[0m
[30;1m50 | [0m[35m    assert service_request.md5 == "d41d8cd98f00b204e9800998ecf8427e"[0m
[30;1m51 | [0m[35m    assert service_request.sha1 == "da39a3ee5e6b4b0d3255bfef95601890afd80709"[0m
[30;1m52 | [0m[35m    assert service_request.sha256 == "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b8[0m
[30;1m53 | [0m[35m    assert isinstance(service_request.sid, str)[0m
[30;1m54 | [0m[35m    assert isinstance(service_request.task, Task)[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m24 | [0m[35m            "magic": "blah",[0m
[30;1m25 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m26 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m27 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m28 | [0m[35m            "size": 0,[0m
[30;1m29 | [0m[35m            "type": "text/plain",[0m
[30;1m30 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m23 | [0m[35m        "fileinfo": {[0m
[30;1m24 | [0m[35m            "magic": "blah",[0m
[30;1m25 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m26 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m27 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m28 | [0m[35m            "size": 0,[0m
[30;1m29 | [0m[35m            "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1338 | [0m[35m            'description': 'description of image'},[0m
[30;1m1339 | [0m[35m        'thumb': {[0m
[30;1m1340 | [0m[35m            'name': 'image_name.thumb',[0m
[30;1m1341 | [0m[35m            'sha256': '1af0e0d99845493b64cf402b3704170f17ecf15001714016e48f9d4854218901',[0m
[30;1m1342 | [0m[35m            'description': 'description of image (thumbnail)'}}][0m
[30;1m1343 | [0m[35m[0m
[30;1m1344 | [0m[35m    # Ensure that the image files added are marked as `is_image_section`[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1334 | [0m[35m    assert ris.section_body._data == [{[0m
[30;1m1335 | [0m[35m        'img': {[0m
[30;1m1336 | [0m[35m            'name': 'image_name',[0m
[30;1m1337 | [0m[35m            'sha256': '09bf99ab5431af13b701a06dc2b04520aea9fd346584fa2a034d6d4af0c57329',[0m
[30;1m1338 | [0m[35m            'description': 'description of image'},[0m
[30;1m1339 | [0m[35m        'thumb': {[0m
[30;1m1340 | [0m[35m            'name': 'image_name.thumb',[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1330 | [0m[35m                                                             'SEND $15, TO ONE OF OUR CRYPTO ADDRESS[0m
[30;1m1331 | [0m[35m                                                             'US EMAIL WITH PAYMENT", "CONFIRMATION [0m
[30;1m1332 | [0m[35m                                                             'THE DECRYPTION SOFTWARE IN EMAIL.", "B[0m
[30;1m1333 | [0m[35m                                                             'bciqsht77cpgw7kv420r4secmu88g34wvn96ds[0m
[30;1m1334 | [0m[35m    assert ris.section_body._data == [{[0m
[30;1m1335 | [0m[35m        'img': {[0m
[30;1m1336 | [0m[35m            'name': 'image_name',[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1309 | [0m[35m                                       'description': 'description of image'},[0m
[30;1m1310 | [0m[35m                                      'thumb':[0m
[30;1m1311 | [0m[35m                                      {'name': 'image_name.thumb',[0m
[30;1m1312 | [0m[35m                                       'sha256': '1af0e0d99845493b64cf402b3704170f17ecf15001714016e4[0m
[30;1m1313 | [0m[35m                                       'description': 'description of image (thumbnail)'}}][0m
[30;1m1314 | [0m[35m[0m
[30;1m1315 | [0m[35m    ris = ResultImageSection(service_request, "title_text_as_str")[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1305 | [0m[35m    assert ris.section_body._data == [{[0m
[30;1m1306 | [0m[35m        'img':[0m
[30;1m1307 | [0m[35m                                      {'name': 'image_name',[0m
[30;1m1308 | [0m[35m                                       'sha256': '09bf99ab5431af13b701a06dc2b04520aea9fd346584fa2a03[0m
[30;1m1309 | [0m[35m                                       'description': 'description of image'},[0m
[30;1m1310 | [0m[35m                                      'thumb':[0m
[30;1m1311 | [0m[35m                                      {'name': 'image_name.thumb',[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1292 | [0m[35m                                       'description': 'description of image'},[0m
[30;1m1293 | [0m[35m                                      'thumb':[0m
[30;1m1294 | [0m[35m                                      {'name': 'image_name.thumb',[0m
[30;1m1295 | [0m[35m                                       'sha256': '1af0e0d99845493b64cf402b3704170f17ecf15001714016e4[0m
[30;1m1296 | [0m[35m                                       'description': 'description of image (thumbnail)'}}][0m
[30;1m1297 | [0m[35m[0m
[30;1m1298 | [0m[35m    ris = ResultImageSection(service_request, "title_text_as_str")[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1288 | [0m[35m    assert ris.section_body._data == [{[0m
[30;1m1289 | [0m[35m        'img':[0m
[30;1m1290 | [0m[35m                                      {'name': 'image_name',[0m
[30;1m1291 | [0m[35m                                       'sha256': '09bf99ab5431af13b701a06dc2b04520aea9fd346584fa2a03[0m
[30;1m1292 | [0m[35m                                       'description': 'description of image'},[0m
[30;1m1293 | [0m[35m                                      'thumb':[0m
[30;1m1294 | [0m[35m                                      {'name': 'image_name.thumb',[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1281 | [0m[35m    ris = ResultImageSection(service_request, "title_text_as_str")[0m
[30;1m1282 | [0m[35m[0m
[30;1m1283 | [0m[35m    image_path = os.path.join(os.path.dirname(__file__),[0m
[30;1m1284 | [0m[35m                              "b32969aa664e3905c20f865cdd7b921f922678f5c3850c78e4c803fbc1757a8e")[0m
[30;1m1285 | [0m[35m[0m
[30;1m1286 | [0m[35m    # Basic[0m
[30;1m1287 | [0m[35m    assert ris.add_image(image_path, "image_name", "description of image") is None[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m639 | [0m[35m            'description': 'description of image'},[0m
[30;1m640 | [0m[35m         'thumb': {[0m
[30;1m641 | [0m[35m            'name': 'image_name.thumb',[0m
[30;1m642 | [0m[35m            'sha256': '1af0e0d99845493b64cf402b3704170f17ecf15001714016e48f9d4854218901',[0m
[30;1m643 | [0m[35m            'description': 'description of image (thumbnail)'}}][0m
[30;1m644 | [0m[35m[0m
[30;1m645 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m635 | [0m[35m    assert isb._data == [[0m
[30;1m636 | [0m[35m        {'img': {[0m
[30;1m637 | [0m[35m            'name': 'image_name',[0m
[30;1m638 | [0m[35m            'sha256': '09bf99ab5431af13b701a06dc2b04520aea9fd346584fa2a034d6d4af0c57329',[0m
[30;1m639 | [0m[35m            'description': 'description of image'},[0m
[30;1m640 | [0m[35m         'thumb': {[0m
[30;1m641 | [0m[35m            'name': 'image_name.thumb',[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m613 | [0m[35m            'description': 'description of image'},[0m
[30;1m614 | [0m[35m         'thumb': {[0m
[30;1m615 | [0m[35m             'name': 'image_name.thumb',[0m
[30;1m616 | [0m[35m             'sha256': '1af0e0d99845493b64cf402b3704170f17ecf15001714016e48f9d4854218901',[0m
[30;1m617 | [0m[35m             'description': 'description of image (thumbnail)'}}][0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m    isb._data.clear()[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m609 | [0m[35m    assert isb._data == [[0m
[30;1m610 | [0m[35m        {'img': {[0m
[30;1m611 | [0m[35m            'name': 'image_name',[0m
[30;1m612 | [0m[35m            'sha256': '09bf99ab5431af13b701a06dc2b04520aea9fd346584fa2a034d6d4af0c57329',[0m
[30;1m613 | [0m[35m            'description': 'description of image'},[0m
[30;1m614 | [0m[35m         'thumb': {[0m
[30;1m615 | [0m[35m             'name': 'image_name.thumb',[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m602 | [0m[35m    isb = ImageSectionBody(service_request)[0m
[30;1m603 | [0m[35m    image_path = os.path.join([0m
[30;1m604 | [0m[35m        os.path.dirname(__file__),[0m
[30;1m605 | [0m[35m        "b32969aa664e3905c20f865cdd7b921f922678f5c3850c78e4c803fbc1757a8e")[0m
[30;1m606 | [0m[35m[0m
[30;1m607 | [0m[35m    # Basic[0m
[30;1m608 | [0m[35m    assert isb.add_image(image_path, "image_name", "description of image") is None[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m38 | [0m[35m            "magic": "blah",[0m
[30;1m39 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m40 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m41 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m42 | [0m[35m            "size": 0,[0m
[30;1m43 | [0m[35m            "type": "text/plain",[0m
[30;1m44 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m37 | [0m[35m        "fileinfo": {[0m
[30;1m38 | [0m[35m            "magic": "blah",[0m
[30;1m39 | [0m[35m            "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m40 | [0m[35m            "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m41 | [0m[35m            "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m42 | [0m[35m            "size": 0,[0m
[30;1m43 | [0m[35m            "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m554 | [0m[35m    if hasattr(t, "fileinfo"):[0m
[30;1m555 | [0m[35m        t.fileinfo.sha256 = "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"[0m
[30;1m556 | [0m[35m    else:[0m
[30;1m557 | [0m[35m        t.sha256 = "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35m    path = f"/tmp/{t.sha256}"[0m
[30;1m560 | [0m[35m    with open(path, "w") as f:[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m552 | [0m[35m    # File exists and sha256 is a match[0m
[30;1m553 | [0m[35m    # Backwards compatibility check with service base[0m
[30;1m554 | [0m[35m    if hasattr(t, "fileinfo"):[0m
[30;1m555 | [0m[35m        t.fileinfo.sha256 = "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"[0m
[30;1m556 | [0m[35m    else:[0m
[30;1m557 | [0m[35m        t.sha256 = "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"[0m
[30;1m558 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m488 | [0m[35m        },[0m
[30;1m489 | [0m[35m        "result": {"score": 0, "sections": []},[0m
[30;1m490 | [0m[35m        "partial": False,[0m
[30;1m491 | [0m[35m        "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m492 | [0m[35m        "type": "text/plain",[0m
[30;1m493 | [0m[35m        "size": 0,[0m
[30;1m494 | [0m[35m        "drop_file": False,[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m462 | [0m[35m            "service_tool_version": None,[0m
[30;1m463 | [0m[35m            "status": "FAIL_NONRECOVERABLE",[0m
[30;1m464 | [0m[35m        },[0m
[30;1m465 | [0m[35m        "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m466 | [0m[35m        "type": "EXCEPTION",[0m
[30;1m467 | [0m[35m    }[0m
[30;1m468 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m446 | [0m[35m            "service_tool_version": None,[0m
[30;1m447 | [0m[35m            "status": "FAIL_RECOVERABLE",[0m
[30;1m448 | [0m[35m        },[0m
[30;1m449 | [0m[35m        "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m450 | [0m[35m        "type": "EXCEPTION",[0m
[30;1m451 | [0m[35m    }[0m
[30;1m452 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m424 | [0m[35m            "score": 0,[0m
[30;1m425 | [0m[35m        },[0m
[30;1m426 | [0m[35m        "partial": False,[0m
[30;1m427 | [0m[35m        "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m428 | [0m[35m        "type": "text/plain",[0m
[30;1m429 | [0m[35m        "size": 0,[0m
[30;1m430 | [0m[35m        "drop_file": False,[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m414 | [0m[35m                    "name": "name",[0m
[30;1m415 | [0m[35m                    "parent_relation": "EXTRACTED",[0m
[30;1m416 | [0m[35m                    "path": path,[0m
[30;1m417 | [0m[35m                    "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",[0m
[30;1m418 | [0m[35m                }[0m
[30;1m419 | [0m[35m            ],[0m
[30;1m420 | [0m[35m            "service_context": None,[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m380 | [0m[35m        },[0m
[30;1m381 | [0m[35m        "result": {"score": 0, "sections": []},[0m
[30;1m382 | [0m[35m        "partial": False,[0m
[30;1m383 | [0m[35m        "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m384 | [0m[35m        "type": "text/plain",[0m
[30;1m385 | [0m[35m        "size": 0,[0m
[30;1m386 | [0m[35m        "drop_file": False,[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m356 | [0m[35m            "service_tool_version": "service_tool_version",[0m
[30;1m357 | [0m[35m            "status": "error_status",[0m
[30;1m358 | [0m[35m        },[0m
[30;1m359 | [0m[35m        "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m360 | [0m[35m        "type": "EXCEPTION",[0m
[30;1m361 | [0m[35m    }[0m
[30;1m362 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m339 | [0m[35m            "service_tool_version": None,[0m
[30;1m340 | [0m[35m            "status": None,[0m
[30;1m341 | [0m[35m        },[0m
[30;1m342 | [0m[35m        "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m343 | [0m[35m        "type": "EXCEPTION",[0m
[30;1m344 | [0m[35m    }[0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m269 | [0m[35m    assert t.supplementary == [[0m
[30;1m270 | [0m[35m        {[0m
[30;1m271 | [0m[35m            "name": "name",[0m
[30;1m272 | [0m[35m            "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",[0m
[30;1m273 | [0m[35m            "description": "description",[0m
[30;1m274 | [0m[35m            "classification": "TLP:C",[0m
[30;1m275 | [0m[35m            "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    assert t.add_supplementary(path, "name", "description") == {[0m
[30;1m259 | [0m[35m        "name": "name",[0m
[30;1m260 | [0m[35m        "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",[0m
[30;1m261 | [0m[35m        "description": "description",[0m
[30;1m262 | [0m[35m        "classification": "TLP:C",[0m
[30;1m263 | [0m[35m        "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m221 | [0m[35m    assert t.extracted == [[0m
[30;1m222 | [0m[35m        {[0m
[30;1m223 | [0m[35m            "name": "name",[0m
[30;1m224 | [0m[35m            "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",[0m
[30;1m225 | [0m[35m            "description": "description",[0m
[30;1m226 | [0m[35m            "classification": "TLP:C",[0m
[30;1m227 | [0m[35m            "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m169 | [0m[35m        path, "name", "description", classification="TLP:AMBER", allow_dynamic_recursion=True, paren[0m
[30;1m170 | [0m[35m    ) == {[0m
[30;1m171 | [0m[35m        "name": "name",[0m
[30;1m172 | [0m[35m        "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",[0m
[30;1m173 | [0m[35m        "description": "description",[0m
[30;1m174 | [0m[35m        "classification": "TLP:C",[0m
[30;1m175 | [0m[35m        "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m154 | [0m[35m    # File is not empty[0m
[30;1m155 | [0m[35m    assert t._add_file(path, "name", "description") == {[0m
[30;1m156 | [0m[35m        "name": "name",[0m
[30;1m157 | [0m[35m        "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",[0m
[30;1m158 | [0m[35m        "description": "description",[0m
[30;1m159 | [0m[35m        "classification": "TLP:C",[0m
[30;1m160 | [0m[35m        "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m119 | [0m[35m                "magic": "blah",[0m
[30;1m120 | [0m[35m                "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m121 | [0m[35m                "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m122 | [0m[35m                "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m123 | [0m[35m                "size": 0,[0m
[30;1m124 | [0m[35m                "type": "text/plain",[0m
[30;1m125 | [0m[35m            },[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m118 | [0m[35m            "fileinfo": {[0m
[30;1m119 | [0m[35m                "magic": "blah",[0m
[30;1m120 | [0m[35m                "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m121 | [0m[35m                "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m122 | [0m[35m                "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m123 | [0m[35m                "size": 0,[0m
[30;1m124 | [0m[35m                "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m87 | [0m[35m                "magic": "blah",[0m
[30;1m88 | [0m[35m                "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m89 | [0m[35m                "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m90 | [0m[35m                "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m91 | [0m[35m                "size": 0,[0m
[30;1m92 | [0m[35m                "type": "text/plain",[0m
[30;1m93 | [0m[35m            },[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m86 | [0m[35m            "fileinfo": {[0m
[30;1m87 | [0m[35m                "magic": "blah",[0m
[30;1m88 | [0m[35m                "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m89 | [0m[35m                "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m90 | [0m[35m                "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m91 | [0m[35m                "size": 0,[0m
[30;1m92 | [0m[35m                "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m70 | [0m[35m    assert t.service_tool_version is None[0m
[30;1m71 | [0m[35m    assert t.service_version is None[0m
[30;1m72 | [0m[35m    assert t.sha1 == "da39a3ee5e6b4b0d3255bfef95601890afd80709"[0m
[30;1m73 | [0m[35m    assert t.sha256 == "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"[0m
[30;1m74 | [0m[35m    assert isinstance(t.sid, str)[0m
[30;1m75 | [0m[35m    assert t.supplementary == [][0m
[30;1m76 | [0m[35m    assert t.tags == {}[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m69 | [0m[35m    assert t.service_name == "blah"[0m
[30;1m70 | [0m[35m    assert t.service_tool_version is None[0m
[30;1m71 | [0m[35m    assert t.service_version is None[0m
[30;1m72 | [0m[35m    assert t.sha1 == "da39a3ee5e6b4b0d3255bfef95601890afd80709"[0m
[30;1m73 | [0m[35m    assert t.sha256 == "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"[0m
[30;1m74 | [0m[35m    assert isinstance(t.sid, str)[0m
[30;1m75 | [0m[35m    assert t.supplementary == [][0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m24 | [0m[35m                "magic": "blah",[0m
[30;1m25 | [0m[35m                "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m26 | [0m[35m                "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m27 | [0m[35m                "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m28 | [0m[35m                "size": 0,[0m
[30;1m29 | [0m[35m                "type": "text/plain",[0m
[30;1m30 | [0m[35m            },[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m23 | [0m[35m            "fileinfo": {[0m
[30;1m24 | [0m[35m                "magic": "blah",[0m
[30;1m25 | [0m[35m                "md5": "d41d8cd98f00b204e9800998ecf8427e",[0m
[30;1m26 | [0m[35m                "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",[0m
[30;1m27 | [0m[35m                "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",[0m
[30;1m28 | [0m[35m                "size": 0,[0m
[30;1m29 | [0m[35m                "type": "text/plain",[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35mdef _is_dev_mode() -> bool:[0m
[30;1m117 | [0m[35m    with StringIO() as stack_trace:[0m
[30;1m118 | [0m[35m        # Check if run_service_once, pytest or assemblyline_v4_service.testing.helper is in the[0m
[30;1m119 | [0m[35m        # stack trace to determine if we're running the service in a development mode[0m
[30;1m120 | [0m[35m        traceback.print_stack(file=stack_trace)[0m
[30;1m121 | [0m[35m        stack_trace.seek(0)[0m
[30;1m122 | [0m[35m        read_stack_trace = stack_trace.read()[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    """A context manager that causes an exception to be raised after a timeout."""[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    def __init__(self, timeout):[0m
[30;1m60 | [0m[35m        self.timeout = timeout[0m
[30;1m61 | [0m[35m        self.alarm_default = signal.getsignal(signal.SIGALRM)[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def __enter__(self):[0m
[30;1m64 | [0m[35m        # noinspection PyUnusedLocal[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m        passwords.update(__extract_passwords_from_lines(text_split_n, PASSWORD_WORDS[i], r))[0m
[30;1m107 | [0m[35m    for p in list(passwords):[0m
[30;1m108 | [0m[35m        p = p.strip()[0m
[30;1m109 | [0m[35m        # We can assume that at least one of the strip_char won't be there, to have the simple space[0m
[30;1m110 | [0m[35m        passwords.update([p.strip(strip_char) for strip_char in PASSWORD_STRIP])[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    passwords.discard("")[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m914 | [0m[35m            self._flatten_sections(section)[0m
[30;1m915 | [0m[35m[0m
[30;1m916 | [0m[35m        for flattened_section in self._flattened_sections:[0m
[30;1m917 | [0m[35m            heuristic = flattened_section.get('heuristic')[0m
[30;1m918 | [0m[35m            if heuristic:[0m
[30;1m919 | [0m[35m                self._score += heuristic['score'][0m
[30;1m920 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m                #   2. Live service submitted score map[0m
[30;1m170 | [0m[35m                #   3. Heuristic's default signature[0m
[30;1m171 | [0m[35m                sig_score = self._definition.signature_score_map.get(sig_name,[0m
[30;1m172 | [0m[35m                                                                     self._score_map.get(sig_name,[0m
[30;1m173 | [0m[35m                                                                                         self._defin[0m
[30;1m174 | [0m[35m                temp_score += sig_score * freq[0m
[30;1m175 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m                #   1. Heuristic's signature score map[0m
[30;1m169 | [0m[35m                #   2. Live service submitted score map[0m
[30;1m170 | [0m[35m                #   3. Heuristic's default signature[0m
[30;1m171 | [0m[35m                sig_score = self._definition.signature_score_map.get(sig_name,[0m
[30;1m172 | [0m[35m                                                                     self._score_map.get(sig_name,[0m
[30;1m173 | [0m[35m                                                                                         self._defin[0m
[30;1m174 | [0m[35m                temp_score += sig_score * freq[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m667 | [0m[35m                                            f"[Current: {self.heuristic.heur_id}, New: {heur_id}]")[0m
[30;1m668 | [0m[35m        elif isinstance(heur, Heuristic):[0m
[30;1m669 | [0m[35m            self._heuristic = heur[0m
[30;1m670 | [0m[35m        # at this point, heur is an integer representing a heuristic ID[0m
[30;1m671 | [0m[35m        else:[0m
[30;1m672 | [0m[35m            self._heuristic = Heuristic(heur)[0m
[30;1m673 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m        self.pid = pid[0m
[30;1m351 | [0m[35m        self.name = name[0m
[30;1m352 | [0m[35m        self.cmd = cmd[0m
[30;1m353 | [0m[35m        self.network_count = network_count[0m
[30;1m354 | [0m[35m        self.file_count = file_count[0m
[30;1m355 | [0m[35m        self.registry_count = registry_count[0m
[30;1m356 | [0m[35m        self.safelisted = safelisted[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m890 | [0m[35m        Add a result section to the root of the result.[0m
[30;1m891 | [0m[35m[0m
[30;1m892 | [0m[35m        :param section: Section to add to the root of the result[0m
[30;1m893 | [0m[35m        :param on_top: Display this result section on top of other sections[0m
[30;1m894 | [0m[35m        """[0m
[30;1m895 | [0m[35m        if on_top:[0m
[30;1m896 | [0m[35m            self.sections.insert(0, section)[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m663 | [0m[35m            self._heuristic = None[0m
[30;1m664 | [0m[35m        elif self._heuristic:[0m
[30;1m665 | [0m[35m            heur_id = heur.heur_id if isinstance(heur, Heuristic) else heur[0m
[30;1m666 | [0m[35m            raise InvalidHeuristicException(f"The service is trying to set the heuristic twice, this[0m
[30;1m667 | [0m[35m                                            f"[Current: {self.heuristic.heur_id}, New: {heur_id}]")[0m
[30;1m668 | [0m[35m        elif isinstance(heur, Heuristic):[0m
[30;1m669 | [0m[35m            self._heuristic = heur[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m655 | [0m[35m        Set a heuristic for a result section/subsection.[0m
[30;1m656 | [0m[35m        A heuristic is required to assign a score to a result section/subsection.[0m
[30;1m657 | [0m[35m[0m
[30;1m658 | [0m[35m        :param heur: Heuristic ID as set in the service manifest or Heuristic Instance[0m
[30;1m659 | [0m[35m        :param attack_id: (optional) Attack ID related to the heuristic[0m
[30;1m660 | [0m[35m        :param signature: (optional) Signature Name that triggered the heuristic[0m
[30;1m661 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m592 | [0m[35m        Add a result subsection to another result section or subsection.[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m        :param subsection: Subsection to add to another result section or subsection[0m
[30;1m595 | [0m[35m        :param on_top: Display this result section on top of other subsections[0m
[30;1m596 | [0m[35m        """[0m
[30;1m597 | [0m[35m        if on_top:[0m
[30;1m598 | [0m[35m            self._subsections.insert(0, subsection)[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m491 | [0m[35m            auto_collapse: bool = False,[0m
[30;1m492 | [0m[35m            zeroize_on_sig_safe: bool = True,[0m
[30;1m493 | [0m[35m    ):[0m
[30;1m494 | [0m[35m        # Lazy load service attributes[0m
[30;1m495 | [0m[35m        global SERVICE_ATTRIBUTES[0m
[30;1m496 | [0m[35m        if not SERVICE_ATTRIBUTES:[0m
[30;1m497 | [0m[35m            SERVICE_ATTRIBUTES = get_service_attributes()[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m            for sig_name, freq in self._signatures.items():[0m
[30;1m167 | [0m[35m                # Find which score we should use for this signature (In order of importance)[0m
[30;1m168 | [0m[35m                #   1. Heuristic's signature score map[0m
[30;1m169 | [0m[35m                #   2. Live service submitted score map[0m
[30;1m170 | [0m[35m                #   3. Heuristic's default signature[0m
[30;1m171 | [0m[35m                sig_score = self._definition.signature_score_map.get(sig_name,[0m
[30;1m172 | [0m[35m                                                                     self._score_map.get(sig_name,[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m        if len(self._signatures) > 0:[0m
[30;1m165 | [0m[35m            # There are signatures associated to the heuristic, loop through them and compute a scor[0m
[30;1m166 | [0m[35m            for sig_name, freq in self._signatures.items():[0m
[30;1m167 | [0m[35m                # Find which score we should use for this signature (In order of importance)[0m
[30;1m168 | [0m[35m                #   1. Heuristic's signature score map[0m
[30;1m169 | [0m[35m                #   2. Live service submitted score map[0m
[30;1m170 | [0m[35m                #   3. Heuristic's default signature[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m        # Validate heuristic[0m
[30;1m96 | [0m[35m        if heur_id not in HEUR_LIST:[0m
[30;1m97 | [0m[35m            raise InvalidHeuristicException(f"Invalid heuristic. A heuristic with ID: {heur_id}, mus[0m
[30;1m98 | [0m[35m                                            f"the service manifest before using it.")[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # Set default values[0m
[30;1m101 | [0m[35m        self._definition = HEUR_LIST[heur_id][0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    @functools.wraps(func)[0m
[30;1m67 | [0m[35m    def base(*args, **kwargs):[0m
[30;1m68 | [0m[35m        # Before anything else, check that the API key is set[0m
[30;1m69 | [0m[35m        apikey = request.environ.get('HTTP_X_APIKEY', None)[0m
[30;1m70 | [0m[35m        if AUTH_KEY != apikey:[0m
[30;1m71 | [0m[35m            app.logger.warning(f'Client provided wrong api key [{apikey}]')[0m
[30;1m72 | [0m[35m            raise Unauthorized("Unauthorized access denied")[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mapp = Flask('service_updater')[0m
[30;1m19 | [0m[35mAUTH_KEY = os.environ.get('AL_INSTANCE_KEY', 'ThisIsARandomAuthKey...ChangeMe!')[0m
[30;1m20 | [0m[35mAL_ROOT_CA = os.environ.get('AL_ROOT_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mssl_context = None[0m
[30;1m23 | [0m[35mif os.path.exists(AL_ROOT_CA):[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mapp = Flask('service_updater')[0m
[30;1m19 | [0m[35mAUTH_KEY = os.environ.get('AL_INSTANCE_KEY', 'ThisIsARandomAuthKey...ChangeMe!')[0m
[30;1m20 | [0m[35mAL_ROOT_CA = os.environ.get('AL_ROOT_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mssl_context = None[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m@app.route('/tar')[0m
[30;1m116 | [0m[35m@api_login[0m
[30;1m117 | [0m[35mdef get_all_files():[0m
[30;1m118 | [0m[35m    """Download a tar containing all the files in the current update."""[0m
[30;1m119 | [0m[35m    _, path = get_paths()[0m
[30;1m120 | [0m[35m    return send_file(path)[0m
[30;1m121 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m            raise ValueError("_tar is None or is not file")[0m
[30;1m87 | [0m[35m    except Exception as e:[0m
[30;1m88 | [0m[35m        raise ServiceUnavailable(f"No update ready due to '{e}'")[0m
[30;1m89 | [0m[35m    return path, tar[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m@app.route('/files')[0m
[30;1m93 | [0m[35m@api_login[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m        tar = status['_tar'][0m
[30;1m83 | [0m[35m        if path is None or not os.path.isdir(path):[0m
[30;1m84 | [0m[35m            raise ValueError("_directory is None or is not directory")[0m
[30;1m85 | [0m[35m        if tar is None or not os.path.isfile(tar):[0m
[30;1m86 | [0m[35m            raise ValueError("_tar is None or is not file")[0m
[30;1m87 | [0m[35m    except Exception as e:[0m
[30;1m88 | [0m[35m        raise ServiceUnavailable(f"No update ready due to '{e}'")[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m    try:[0m
[30;1m80 | [0m[35m        status = _get_status()[0m
[30;1m81 | [0m[35m        path = status['_directory'][0m
[30;1m82 | [0m[35m        tar = status['_tar'][0m
[30;1m83 | [0m[35m        if path is None or not os.path.isdir(path):[0m
[30;1m84 | [0m[35m            raise ValueError("_directory is None or is not directory")[0m
[30;1m85 | [0m[35m        if tar is None or not os.path.isfile(tar):[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m85 | [0m[35m        if tar is None or not os.path.isfile(tar):[0m
[30;1m86 | [0m[35m            raise ValueError("_tar is None or is not file")[0m
[30;1m87 | [0m[35m    except Exception as e:[0m
[30;1m88 | [0m[35m        raise ServiceUnavailable(f"No update ready due to '{e}'")[0m
[30;1m89 | [0m[35m    return path, tar[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    # If running with an updater, check for availability. Make sure test doesn't run on the actual u[0m
[30;1m26 | [0m[35m    if environ.get('updates_host') and not environ['HOSTNAME'].startswith(environ['updates_host']):[0m
[30;1m27 | [0m[35m        scheme, verify = ("http", None) if not path.exists(UPDATES_CA) else ("https", UPDATES_CA)[0m
[30;1m28 | [0m[35m        if not requests.get(f"{scheme}://{environ['updates_host']}:{environ['updates_port']}/healthz[0m
[30;1m29 | [0m[35m                            verify=verify).ok:[0m
[30;1m30 | [0m[35m            raise Exception('Unable to reach local update server')[0m
[30;1m31 | [0m[35m    exit()[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m            raise Exception('Unable to reach service-server')[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    # If running with an updater, check for availability. Make sure test doesn't run on the actual u[0m
[30;1m26 | [0m[35m    if environ.get('updates_host') and not environ['HOSTNAME'].startswith(environ['updates_host']):[0m
[30;1m27 | [0m[35m        scheme, verify = ("http", None) if not path.exists(UPDATES_CA) else ("https", UPDATES_CA)[0m
[30;1m28 | [0m[35m        if not requests.get(f"{scheme}://{environ['updates_host']}:{environ['updates_port']}/healthz[0m
[30;1m29 | [0m[35m                            verify=verify).ok:[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m        service_api_host = environ['SERVICE_API_HOST'][0m
[30;1m20 | [0m[35m        verify = None if not service_api_host.startswith('https') else SERVICE_SERVER_CA[0m
[30;1m21 | [0m[35m        # Otherwise, perform a test for service-server availability[0m
[30;1m22 | [0m[35m        if not requests.get(f"{service_api_host}/healthz/live", verify=verify).ok:[0m
[30;1m23 | [0m[35m            raise Exception('Unable to reach service-server')[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    # If running with an updater, check for availability. Make sure test doesn't run on the actual u[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m# Intended for use with Kubernetes deployments[0m
[30;1m12 | [0m[35mdef perform_check():[0m
[30;1m13 | [0m[35m    # If the service is privileged, test connectivity to core[0m
[30;1m14 | [0m[35m    if environ.get('PRIVILEGED', 'false').lower() == 'true':[0m
[30;1m15 | [0m[35m        forge.get_datastore()[0m
[30;1m16 | [0m[35m        forge.get_filestore(connection_attempts=1)[0m
[30;1m17 | [0m[35m        forge.get_service_queue(service=environ['AL_SERVICE_NAME'])[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35mfrom sys import exit[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUPDATES_CA = environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m8 | [0m[35mSERVICE_SERVER_CA = environ.get('SERVICE_SERVER_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# Intended for use with Kubernetes deployments[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m4 | [0m[35mfrom assemblyline.common import forge[0m
[30;1m5 | [0m[35mfrom sys import exit[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUPDATES_CA = environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m8 | [0m[35mSERVICE_SERVER_CA = environ.get('SERVICE_SERVER_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m        scheme, verify = ("http", None) if not path.exists(UPDATES_CA) else ("https", UPDATES_CA)[0m
[30;1m28 | [0m[35m        if not requests.get(f"{scheme}://{environ['updates_host']}:{environ['updates_port']}/healthz[0m
[30;1m29 | [0m[35m                            verify=verify).ok:[0m
[30;1m30 | [0m[35m            raise Exception('Unable to reach local update server')[0m
[30;1m31 | [0m[35m    exit()[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/healthz.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# Intended for use with Kubernetes deployments[0m
[30;1m12 | [0m[35mdef perform_check():[0m
[30;1m13 | [0m[35m    # If the service is privileged, test connectivity to core[0m
[30;1m14 | [0m[35m    if environ.get('PRIVILEGED', 'false').lower() == 'true':[0m
[30;1m15 | [0m[35m        forge.get_datastore()[0m
[30;1m16 | [0m[35m        forge.get_filestore(connection_attempts=1)[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m            "Service-Tool-Version": get_service_manifest().get('tool_version', '')[0m
[30;1m33 | [0m[35m        })[0m
[30;1m34 | [0m[35m        if self.service_api_host.startswith('https'):[0m
[30;1m35 | [0m[35m            self.session.verify = os.environ.get('SERVICE_SERVER_ROOT_CA_PATH', '/etc/assemblyline/s[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def _with_retries(self, func, url, **kwargs):[0m
[30;1m38 | [0m[35m        retries = 0[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m            "Container-ID": os.environ.get('HOSTNAME', 'dev-service'),[0m
[30;1m30 | [0m[35m            "Service-Name": service_attributes.name,[0m
[30;1m31 | [0m[35m            "Service-Version": service_attributes.version,[0m
[30;1m32 | [0m[35m            "Service-Tool-Version": get_service_manifest().get('tool_version', '')[0m
[30;1m33 | [0m[35m        })[0m
[30;1m34 | [0m[35m        if self.service_api_host.startswith('https'):[0m
[30;1m35 | [0m[35m            self.session.verify = os.environ.get('SERVICE_SERVER_ROOT_CA_PATH', '/etc/assemblyline/s[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m        self.session = requests.Session()[0m
[30;1m27 | [0m[35m        self.session.headers.update({[0m
[30;1m28 | [0m[35m            "X-APIKey": os.environ.get("SERVICE_API_KEY", DEFAULT_AUTH_KEY),[0m
[30;1m29 | [0m[35m            "Container-ID": os.environ.get('HOSTNAME', 'dev-service'),[0m
[30;1m30 | [0m[35m            "Service-Name": service_attributes.name,[0m
[30;1m31 | [0m[35m            "Service-Version": service_attributes.version,[0m
[30;1m32 | [0m[35m            "Service-Tool-Version": get_service_manifest().get('tool_version', '')[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        self.service_api_host = os.environ.get("SERVICE_API_HOST", DEFAULT_SERVICE_SERVER)[0m
[30;1m26 | [0m[35m        self.session = requests.Session()[0m
[30;1m27 | [0m[35m        self.session.headers.update({[0m
[30;1m28 | [0m[35m            "X-APIKey": os.environ.get("SERVICE_API_KEY", DEFAULT_AUTH_KEY),[0m
[30;1m29 | [0m[35m            "Container-ID": os.environ.get('HOSTNAME', 'dev-service'),[0m
[30;1m30 | [0m[35m            "Service-Name": service_attributes.name,[0m
[30;1m31 | [0m[35m            "Service-Version": service_attributes.version,[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35mclass ServiceAPI:[0m
[30;1m23 | [0m[35m    def __init__(self, service_attributes, logger):[0m
[30;1m24 | [0m[35m        self.log = logger[0m
[30;1m25 | [0m[35m        self.service_api_host = os.environ.get("SERVICE_API_HOST", DEFAULT_SERVICE_SERVER)[0m
[30;1m26 | [0m[35m        self.session = requests.Session()[0m
[30;1m27 | [0m[35m        self.session.headers.update({[0m
[30;1m28 | [0m[35m            "X-APIKey": os.environ.get("SERVICE_API_KEY", DEFAULT_AUTH_KEY),[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport requests[0m
[30;1m5 | [0m[35mfrom assemblyline_core.badlist_client import BadlistClient[0m
[30;1m6 | [0m[35mfrom assemblyline_core.safelist_client import SafelistClient[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    ignore_ssl_errors = source.get("ssl_ignore_errors", False)[0m
[30;1m195 | [0m[35m    ca_cert = source.get("ca_cert")[0m
[30;1m196 | [0m[35m    proxy = source.get('proxy', None)[0m
[30;1m197 | [0m[35m    auth = None[0m
[30;1m198 | [0m[35m    if username and password:[0m
[30;1m199 | [0m[35m        # Basic authentication scheme[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    ignore_ssl_errors = source.get("ssl_ignore_errors", False)[0m
[30;1m195 | [0m[35m    ca_cert = source.get("ca_cert")[0m
[30;1m196 | [0m[35m    proxy = source.get('proxy', None)[0m
[30;1m197 | [0m[35m    auth = None[0m
[30;1m198 | [0m[35m    if username and password:[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m    password = source.get('password', None)[0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    ignore_ssl_errors = source.get("ssl_ignore_errors", False)[0m
[30;1m195 | [0m[35m    ca_cert = source.get("ca_cert")[0m
[30;1m196 | [0m[35m    proxy = source.get('proxy', None)[0m
[30;1m197 | [0m[35m    auth = None[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m    key = source.get('private_key', None)[0m
[30;1m190 | [0m[35m    username = source.get('username', None)[0m
[30;1m191 | [0m[35m    password = source.get('password', None)[0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    ignore_ssl_errors = source.get("ssl_ignore_errors", False)[0m
[30;1m195 | [0m[35m    ca_cert = source.get("ca_cert")[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m    url = source['uri'][0m
[30;1m189 | [0m[35m    key = source.get('private_key', None)[0m
[30;1m190 | [0m[35m    username = source.get('username', None)[0m
[30;1m191 | [0m[35m    password = source.get('password', None)[0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    ignore_ssl_errors = source.get("ssl_ignore_errors", False)[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m    name = source['name'][0m
[30;1m188 | [0m[35m    url = source['uri'][0m
[30;1m189 | [0m[35m    key = source.get('private_key', None)[0m
[30;1m190 | [0m[35m    username = source.get('username', None)[0m
[30;1m191 | [0m[35m    password = source.get('password', None)[0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35mdef git_clone_repo(source: Dict[str, Any], previous_update: int = None, logger=None, output_dir: str[0m
[30;1m187 | [0m[35m    name = source['name'][0m
[30;1m188 | [0m[35m    url = source['uri'][0m
[30;1m189 | [0m[35m    key = source.get('private_key', None)[0m
[30;1m190 | [0m[35m    username = source.get('username', None)[0m
[30;1m191 | [0m[35m    password = source.get('password', None)[0m
[30;1m192 | [0m[35m    branch = source.get('git_branch', None) or None[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m            if fetch_method == 'get':[0m
[30;1m139 | [0m[35m                response = session.get(uri, auth=auth, headers=headers, proxies=proxies, stream=True[0m
[30;1m140 | [0m[35m            elif fetch_method == 'post':[0m
[30;1m141 | [0m[35m                response = session.post(uri, auth=auth, headers=headers, proxies=proxies, data=sourc[0m
[30;1m142 | [0m[35m            else:[0m
[30;1m143 | [0m[35m                raise ValueError(f"Unknown fetch method: {fetch_method}")[0m
[30;1m144 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m            if fetch_method == 'get':[0m
[30;1m139 | [0m[35m                response = session.get(uri, auth=auth, headers=headers, proxies=proxies, stream=True[0m
[30;1m140 | [0m[35m            elif fetch_method == 'post':[0m
[30;1m141 | [0m[35m                response = session.post(uri, auth=auth, headers=headers, proxies=proxies, data=sourc[0m
[30;1m142 | [0m[35m            else:[0m
[30;1m143 | [0m[35m                raise ValueError(f"Unknown fetch method: {fetch_method}")[0m
[30;1m144 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                    headers = {'If-Modified-Since': previous_update}[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m            if fetch_method == 'get':[0m
[30;1m139 | [0m[35m                response = session.get(uri, auth=auth, headers=headers, proxies=proxies, stream=True[0m
[30;1m140 | [0m[35m            elif fetch_method == 'post':[0m
[30;1m141 | [0m[35m                response = session.post(uri, auth=auth, headers=headers, proxies=proxies, data=sourc[0m
[30;1m142 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m            # Check the response header for the last modified date[0m
[30;1m120 | [0m[35m            response = session.head(uri, auth=auth, headers=headers, proxies=proxies)[0m
[30;1m121 | [0m[35m            last_modified = response.headers.get('Last-Modified', None)[0m
[30;1m122 | [0m[35m            if last_modified:[0m
[30;1m123 | [0m[35m                # Convert the last modified time to epoch[0m
[30;1m124 | [0m[35m                last_modified = time.mktime(time.strptime(last_modified, "%a, %d %b %Y %H:%M:%S %Z")[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m    try:[0m
[30;1m111 | [0m[35m        response = None[0m
[30;1m112 | [0m[35m        with tempfile.NamedTemporaryFile('w') as private_key_file:[0m
[30;1m113 | [0m[35m            if source.get('private_key'):[0m
[30;1m114 | [0m[35m                logger.info('A private key has been provided with this source')[0m
[30;1m115 | [0m[35m                private_key_file.write(source['private_key'])[0m
[30;1m116 | [0m[35m                private_key_file.seek(0)[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    fetch_method = source.get('fetch_method', 'GET').lower()[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    proxy = source.get('proxy', None)[0m
[30;1m94 | [0m[35m    headers_list = source.get('headers', [])[0m
[30;1m95 | [0m[35m    headers = {}[0m
[30;1m96 | [0m[35m    [headers.update({header['name']: header['value']}) for header in headers_list][0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m
[30;1m91 | [0m[35m    fetch_method = source.get('fetch_method', 'GET').lower()[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    proxy = source.get('proxy', None)[0m
[30;1m94 | [0m[35m    headers_list = source.get('headers', [])[0m
[30;1m95 | [0m[35m    headers = {}[0m
[30;1m96 | [0m[35m    [headers.update({header['name']: header['value']}) for header in headers_list][0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m
[30;1m91 | [0m[35m    fetch_method = source.get('fetch_method', 'GET').lower()[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    proxy = source.get('proxy', None)[0m
[30;1m94 | [0m[35m    headers_list = source.get('headers', [])[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m    username = source.get('username', None)[0m
[30;1m87 | [0m[35m    password = source.get('password', None)[0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m
[30;1m91 | [0m[35m    fetch_method = source.get('fetch_method', 'GET').lower()[0m
[30;1m92 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    username = source.get('username', None)[0m
[30;1m87 | [0m[35m    password = source.get('password', None)[0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m
[30;1m91 | [0m[35m    fetch_method = source.get('fetch_method', 'GET').lower()[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        raise ValueError(f"Provided source uri does not end with a file name: '{uri}'")[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    username = source.get('username', None)[0m
[30;1m87 | [0m[35m    password = source.get('password', None)[0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m
[30;1m90 | [0m[35m    auth = (username, password) if username and password else None[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m    if not os.path.basename(urlparse(uri).path):[0m
[30;1m84 | [0m[35m        raise ValueError(f"Provided source uri does not end with a file name: '{uri}'")[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    username = source.get('username', None)[0m
[30;1m87 | [0m[35m    password = source.get('password', None)[0m
[30;1m88 | [0m[35m    ca_cert = source.get('ca_cert', None)[0m
[30;1m89 | [0m[35m    ignore_ssl_errors = source.get('ssl_ignore_errors', False)[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35mfrom assemblyline_v4_service.common.utils import DEVELOPMENT_MODE[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mBLOCK_SIZE = 64 * 1024[0m
[30;1m22 | [0m[35mGIT_ALLOW_UNSAFE_PROTOCOLS = os.environ.get('GIT_ALLOW_UNSAFE_PROTOCOLS', 'false').lower() == 'true'[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mif DEVELOPMENT_MODE:[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m258 | [0m[35m        # Catch all other types of exceptions such as ConnectionError, ProxyError, etc.[0m
[30;1m259 | [0m[35m        raise e[0m
[30;1m260 | [0m[35m    finally:[0m
[30;1m261 | [0m[35m        # Cleanup any lingering Git zombies[0m
[30;1m262 | [0m[35m        for p in psutil.process_iter():[0m
[30;1m263 | [0m[35m            if 'git' in p.name() and p.status() == 'zombie':[0m
[30;1m264 | [0m[35m                p.terminate()[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m237 | [0m[35m                git_env['GIT_SSH_COMMAND'] = git_ssh_cmd[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m            # As checking for .git at the end of the URI is not reliable[0m
[30;1m240 | [0m[35m            # we will use the exception to determine if its a git repo or direct download.[0m
[30;1m241 | [0m[35m            repo = Repo.clone_from(url, clone_dir, env=git_env, branch=branch,[0m
[30;1m242 | [0m[35m                                   allow_unsafe_protocols=GIT_ALLOW_UNSAFE_PROTOCOLS, depth=1)[0m
[30;1m243 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m                # Convert the last modified time to epoch[0m
[30;1m124 | [0m[35m                last_modified = time.mktime(time.strptime(last_modified, "%a, %d %b %Y %H:%M:%S %Z")[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m                # Compare the last modified time with the last updated time[0m
[30;1m127 | [0m[35m                if previous_update and last_modified <= previous_update:[0m
[30;1m128 | [0m[35m                    # File has not been modified since last update, do nothing[0m
[30;1m129 | [0m[35m                    raise SkipSource()[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m                # Convert the last modified time to epoch[0m
[30;1m124 | [0m[35m                last_modified = time.mktime(time.strptime(last_modified, "%a, %d %b %Y %H:%M:%S %Z")[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m                # Compare the last modified time with the last updated time[0m
[30;1m127 | [0m[35m                if previous_update and last_modified <= previous_update:[0m
[30;1m128 | [0m[35m                    # File has not been modified since last update, do nothing[0m
[30;1m129 | [0m[35m                    raise SkipSource()[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m            response = session.head(uri, auth=auth, headers=headers, proxies=proxies)[0m
[30;1m121 | [0m[35m            last_modified = response.headers.get('Last-Modified', None)[0m
[30;1m122 | [0m[35m            if last_modified:[0m
[30;1m123 | [0m[35m                # Convert the last modified time to epoch[0m
[30;1m124 | [0m[35m                last_modified = time.mktime(time.strptime(last_modified, "%a, %d %b %Y %H:%M:%S %Z")[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m                # Compare the last modified time with the last updated time[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport psutil[0m
[30;1m12 | [0m[35mimport regex as re[0m
[30;1m13 | [0m[35mimport requests[0m
[30;1m14 | [0m[35mfrom git import Repo[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom assemblyline.common.digests import get_sha256_for_file[0m
[30;1m17 | [0m[35mfrom assemblyline.common.identify import Identify[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport shutil[0m
[30;1m3 | [0m[35mimport tempfile[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom logging import Logger[0m
[30;1m6 | [0m[35mfrom shutil import make_archive[0m
[30;1m7 | [0m[35mfrom typing import Any, Dict, List, Optional, Tuple[0m
[30;1m8 | [0m[35mfrom urllib.parse import urlparse[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/helper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m236 | [0m[35m                git_ssh_cmd = f"ssh -oStrictHostKeyChecking=no -i {git_ssh_identity_file.name}"[0m
[30;1m237 | [0m[35m                git_env['GIT_SSH_COMMAND'] = git_ssh_cmd[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m            # As checking for .git at the end of the URI is not reliable[0m
[30;1m240 | [0m[35m            # we will use the exception to determine if its a git repo or direct download.[0m
[30;1m241 | [0m[35m            repo = Repo.clone_from(url, clone_dir, env=git_env, branch=branch,[0m
[30;1m242 | [0m[35m                                   allow_unsafe_protocols=GIT_ALLOW_UNSAFE_PROTOCOLS, depth=1)[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m        sb.dependencies["updates"] = {"host": "blah.com", "port": 123, "key": "blah"}[0m
[30;1m388 | [0m[35m        sb._load_rules = _load_rules[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m        m.get("https://blah.com:123/tar", exc=Exception("blah"))[0m
[30;1m391 | [0m[35m        assert sb._download_rules() is None[0m
[30;1m392 | [0m[35m        assert sb.update_time is None[0m
[30;1m393 | [0m[35m        assert sb.update_hash is None[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m375 | [0m[35m        m.get("https://blah.com:123/status", status_code=200,[0m
[30;1m376 | [0m[35m              json={"download_available": "blah", "local_update_time": "blah", "local_update_hash": [0m
[30;1m377 | [0m[35m        m.get("https://blah.com:123/tar", status_code=200, json={"download_available": "blah"})[0m
[30;1m378 | [0m[35m        assert sb._download_rules() is None[0m
[30;1m379 | [0m[35m        assert sb.update_time == "blah"[0m
[30;1m380 | [0m[35m        assert sb.update_hash == "blah"[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m    sb._load_rules = _load_rules[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m375 | [0m[35m        m.get("https://blah.com:123/status", status_code=200,[0m
[30;1m376 | [0m[35m              json={"download_available": "blah", "local_update_time": "blah", "local_update_hash": [0m
[30;1m377 | [0m[35m        m.get("https://blah.com:123/tar", status_code=200, json={"download_available": "blah"})[0m
[30;1m378 | [0m[35m        assert sb._download_rules() is None[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m381 | [0m[35m        assert sb.rules_directory == "/updates/blah"[0m
[30;1m382 | [0m[35m        assert sb.rules_hash == "e3b0c44"[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35m        # Throw exception at tar phase[0m
[30;1m385 | [0m[35m        sb = ServiceBase()[0m
[30;1m386 | [0m[35m        sb.update_check_time = time.time() - 30[0m
[30;1m387 | [0m[35m        sb.dependencies["updates"] = {"host": "blah.com", "port": 123, "key": "blah"}[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35mfrom assemblyline.common import exceptions[0m
[30;1m20 | [0m[35mfrom assemblyline.common.version import FRAMEWORK_VERSION, SYSTEM_VERSION[0m
[30;1m21 | [0m[35mfrom assemblyline.odm.messages.task import Task as ServiceTask[0m
[30;1m22 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m@pytest.fixture[0m
[30;1m26 | [0m[35mdef dummy_tar_class():[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom test.test_common import setup_module[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Ensure service manifest is instantiated before loading assemblyline_v4_service module[0m
[30;1m10 | [0m[35msetup_module()[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom logging import Logger[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom test.test_common import setup_module[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m381 | [0m[35m        assert sb.rules_directory == "/updates/blah"[0m
[30;1m382 | [0m[35m        assert sb.rules_hash == "e3b0c44"[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35m        # Throw exception at tar phase[0m
[30;1m385 | [0m[35m        sb = ServiceBase()[0m
[30;1m386 | [0m[35m        sb.update_check_time = time.time() - 30[0m
[30;1m387 | [0m[35m        sb.dependencies["updates"] = {"host": "blah.com", "port": 123, "key": "blah"}[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m            service_config = service_manifest_data.get('config', {})[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        self.submission_params = {x['name']: x['value'][0m
[30;1m220 | [0m[35m                                    for x in service_manifest_data.get('submission_params', [])}[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        self.service = self.service_class(config=service_config)[0m
[30;1m223 | [0m[35m        if return_heuristics:[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        service_config = {}[0m
[30;1m216 | [0m[35m        if service_manifest_data:[0m
[30;1m217 | [0m[35m            service_config = service_manifest_data.get('config', {})[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        self.submission_params = {x['name']: x['value'][0m
[30;1m220 | [0m[35m                                    for x in service_manifest_data.get('submission_params', [])}[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m    def load_service_manifest(self, return_heuristics=False) -> Union[None, Dict]:[0m
[30;1m202 | [0m[35m        service_manifest_data = get_service_manifest()[0m
[30;1m203 | [0m[35m        heuristics = service_manifest_data.get('heuristics', None)[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m        # Pop the 'extra' data from the service manifest[0m
[30;1m206 | [0m[35m        for x in ['file_required', 'tool_version', 'heuristics']:[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        # Identify the file[0m
[30;1m64 | [0m[35m        file_info = self.identify.fileinfo(FILE_PATH, skip_fuzzy_hashes=True, calculate_entropy=Fals[0m
[30;1m65 | [0m[35m        if file_info['type'] == "archive/cart" or file_info['magic'] == "custom: archive/cart":[0m
[30;1m66 | [0m[35m            original_file_name = get_metadata_only(FILE_PATH).get("name")[0m
[30;1m67 | [0m[35m            if original_file_name:[0m
[30;1m68 | [0m[35m                file_name = original_file_name[0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m        try:[0m
[30;1m211 | [0m[35m            self.service = Service(service_manifest_data)[0m
[30;1m212 | [0m[35m        except Exception as e:[0m
[30;1m213 | [0m[35m            LOG.error(f"Invalid service manifest: {str(e)}")[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        service_config = {}[0m
[30;1m216 | [0m[35m        if service_manifest_data:[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35m        for x in ['file_required', 'tool_version', 'heuristics']:[0m
[30;1m207 | [0m[35m            service_manifest_data.pop(x, None)[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m        # Validate the service manifest[0m
[30;1m210 | [0m[35m        try:[0m
[30;1m211 | [0m[35m            self.service = Service(service_manifest_data)[0m
[30;1m212 | [0m[35m        except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m        service_manifest_data = get_service_manifest()[0m
[30;1m203 | [0m[35m        heuristics = service_manifest_data.get('heuristics', None)[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m        # Pop the 'extra' data from the service manifest[0m
[30;1m206 | [0m[35m        for x in ['file_required', 'tool_version', 'heuristics']:[0m
[30;1m207 | [0m[35m            service_manifest_data.pop(x, None)[0m
[30;1m208 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m                                   f'{service_task.sid}_{service_task.fileinfo.sha256}_result.json')[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        if not os.path.exists(result_json):[0m
[30;1m134 | [0m[35m            raise Exception("A service error occured and no result json was found.")[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        # Validate the generated result[0m
[30;1m137 | [0m[35m        with open(result_json, 'r') as fh:[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m        for f in files:[0m
[30;1m125 | [0m[35m            shutil.move(os.path.join(source, f), os.path.join(working_dir, 'working_directory'))[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        # Cleanup files from the original directory created by the service base[0m
[30;1m128 | [0m[35m        shutil.rmtree(source)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        result_json = os.path.join(tempfile.gettempdir(),[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m        file_info.pop("ascii", None)[0m
[30;1m93 | [0m[35m        file_info.pop("hex", None)[0m
[30;1m94 | [0m[35m        file_info.pop("entropy", None)[0m
[30;1m95 | [0m[35m        # Create service processing task[0m
[30;1m96 | [0m[35m        service_task = ServiceTask(dict([0m
[30;1m97 | [0m[35m            sid=get_random_id(),[0m
[30;1m98 | [0m[35m            metadata={},[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m        file_name = os.path.basename(FILE_PATH)[0m
[30;1m58 | [0m[35m        working_dir = os.path.join(self.file_dir, f'{os.path.basename(FILE_PATH)}_{SERVICE_NAME.lowe[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        # Start service[0m
[30;1m61 | [0m[35m        self.service.start_service()[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # Identify the file[0m
[30;1m64 | [0m[35m        file_info = self.identify.fileinfo(FILE_PATH, skip_fuzzy_hashes=True, calculate_entropy=Fals[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m        self.load_service_manifest()[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        if self.service.service_attributes.update_config:[0m
[30;1m47 | [0m[35m            # Download required signatures and process them for the service run[0m
[30;1m48 | [0m[35m            load_rules(self.service)[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m        if not os.path.isfile(FILE_PATH):[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m        except ValueError:[0m
[30;1m39 | [0m[35m            raise[0m
[30;1m40 | [0m[35m        except Exception:[0m
[30;1m41 | [0m[35m            LOG.error("Could not find service in path. Check your environment variables.")[0m
[30;1m42 | [0m[35m            raise[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        self.load_service_manifest()[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/run_service_once.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35mfrom assemblyline.common.uid import get_random_id[0m
[30;1m19 | [0m[35mfrom assemblyline.odm.messages.task import Task as ServiceTask[0m
[30;1m20 | [0m[35mfrom assemblyline.odm.models.result import Result[0m
[30;1m21 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m22 | [0m[35mfrom assemblyline_v4_service.common.base import ServiceBase[0m
[30;1m23 | [0m[35mfrom assemblyline_v4_service.common.helper import get_heuristics, get_service_manifest[0m
[30;1m24 | [0m[35mfrom assemblyline_v4_service.dev.updater import load_rules[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m    def get_uri_metadata(self, uri: str) -> Dict[str, Any]:[0m
[30;1m239 | [0m[35m        md5hash = hashlib.md5(uri.encode()).hexdigest()[0m
[30;1m240 | [0m[35m        return self.temp_submission_data.get(f"uri_metadata_{md5hash}", None)[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m    @property[0m
[30;1m243 | [0m[35m    def temp_submission_data(self) -> Dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m            if detections:[0m
[30;1m131 | [0m[35m                # If we were able to detect potential passwords, add it to the submission's password[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m
[30;1m135 | [0m[35m                    self.temp_submission_data['passwords'] = sorted(pw_list)[0m
[30;1m136 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m            if detections:[0m
[30;1m131 | [0m[35m                # If we were able to detect potential passwords, add it to the submission's password[0m
[30;1m132 | [0m[35m                if detections.get('password'):[0m
[30;1m133 | [0m[35m                    pw_list = set(self.temp_submission_data.get('passwords', []))[0m
[30;1m134 | [0m[35m                    [pw_list.update(extract_passwords(pw_string)) for pw_string in detections['passw[0m
[30;1m135 | [0m[35m                    self.temp_submission_data['passwords'] = sorted(pw_list)[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m    @property[0m
[30;1m243 | [0m[35m    def temp_submission_data(self) -> Dict[str, Any]:[0m
[30;1m244 | [0m[35m        """[0m
[30;1m245 | [0m[35m        Get the temporary submission data as set by the service in parent task(s) and current task.[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m        :return: Current temporary submission data[0m
[30;1m248 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m        """[0m
[30;1m228 | [0m[35m        Set the service context.[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        :param context: Context of the service[0m
[30;1m231 | [0m[35m        """[0m
[30;1m232 | [0m[35m        self.task.set_service_context(context)[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    def set_uri_metadata(self, uri: str, params: Dict[str, Any] = None):[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    def set_service_context(self, context) -> None:[0m
[30;1m227 | [0m[35m        """[0m
[30;1m228 | [0m[35m        Set the service context.[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        :param context: Context of the service[0m
[30;1m231 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m219 | [0m[35m        """[0m
[30;1m220 | [0m[35m        Set the result.[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        :param result: Result object created by the service[0m
[30;1m223 | [0m[35m        """[0m
[30;1m224 | [0m[35m        self.task.result = result[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    def set_service_context(self, context) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m        """[0m
[30;1m211 | [0m[35m        Get the current Result as set by the service.[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m        :return: Current Result object as set by the service[0m
[30;1m214 | [0m[35m        """[0m
[30;1m215 | [0m[35m        return self.task.result[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m    @result.setter[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m        :param path: Complete path to the supplementary file[0m
[30;1m156 | [0m[35m        :param name: Display name of the supplementary file[0m
[30;1m157 | [0m[35m        :param description: Descriptive text about the supplementary file[0m
[30;1m158 | [0m[35m        :param classification: Classification of the supplementary file (default: service classifica[0m
[30;1m159 | [0m[35m        :param parent_relation: File relation to parent, if any.[0m
[30;1m160 | [0m[35m        :return: None[0m
[30;1m161 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m                    detections = ocr_detections(outtmp.name, ocr_io)[0m
[30;1m125 | [0m[35m                except (SystemError, RuntimeError):[0m
[30;1m126 | [0m[35m                    # If we encountered a system error, then let OCR analysis go[0m
[30;1m127 | [0m[35m                    # This shouldn't affect service analysis[0m
[30;1m128 | [0m[35m                    pass[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m            if detections:[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        :param path: Complete path to the image file[0m
[30;1m73 | [0m[35m        :param name: Display name of the image file[0m
[30;1m74 | [0m[35m        :param description: Descriptive text about the image file[0m
[30;1m75 | [0m[35m        :param classification: Classification of the image file (default: service classification)[0m
[30;1m76 | [0m[35m        :param ocr_heuristic_id: Heuristic ID associated to suspicious OCR detections[0m
[30;1m77 | [0m[35m        :param ocr_io: Stream to write the raw OCR output to[0m
[30;1m78 | [0m[35m        :return: None[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m        :param path: Complete path to the extracted file[0m
[30;1m40 | [0m[35m        :param name: Display name of the extracted file[0m
[30;1m41 | [0m[35m        :param description: Descriptive text about the extracted file[0m
[30;1m42 | [0m[35m        :param classification: Classification of the extracted file (default: service classification[0m
[30;1m43 | [0m[35m        :param safelist_interface: Safelisting interface provided by service. Used to filter extract[0m
[30;1m44 | [0m[35m        :param allow_dynamic_recursion: Allow this file to be analyzed during Dynamic Analysis even [0m
[30;1m45 | [0m[35m               Dynamic Recursion Prevention (DRP) is enabled.[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mclass ServiceRequest:[0m
[30;1m23 | [0m[35m    def __init__(self, task: Task) -> None:[0m
[30;1m24 | [0m[35m        # Initialize logging for the service[0m
[30;1m25 | [0m[35m        al_log.init_logging(f'{task.service_name}', log_level=logging.INFO)[0m
[30;1m26 | [0m[35m        self.log = logging.getLogger(f'assemblyline.service.{task.service_name.lower()}')[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        self._working_directory = task.working_directory[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m
[30;1m33 | [0m[35mcertfile = env.get('CERTFILE')[0m
[30;1m34 | [0m[35mkeyfile = env.get('KEYFILE')[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35mtimeout = int(env.get('TIMEOUT', '60'))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m
[30;1m33 | [0m[35mcertfile = env.get('CERTFILE')[0m
[30;1m34 | [0m[35mkeyfile = env.get('KEYFILE')[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m# Connection timeouts[0m
[30;1m28 | [0m[35m#  - Defaults to double what the poll length for services should be[0m
[30;1m29 | [0m[35mgraceful_timeout = int(env.get('GRACEFUL_TIMEOUT', '60'))[0m
[30;1m30 | [0m[35mtimeout = int(env.get('TIMEOUT', '60'))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m
[30;1m33 | [0m[35mcertfile = env.get('CERTFILE')[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m# Connection timeouts[0m
[30;1m28 | [0m[35m#  - Defaults to double what the poll length for services should be[0m
[30;1m29 | [0m[35mgraceful_timeout = int(env.get('GRACEFUL_TIMEOUT', '60'))[0m
[30;1m30 | [0m[35mtimeout = int(env.get('TIMEOUT', '60'))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# Recycle the process after X request randomized by the jitter[0m
[30;1m24 | [0m[35mmax_requests = int(env.get('MAX_REQUESTS', '0'))[0m
[30;1m25 | [0m[35mmax_requests_jitter = int(env.get('MAX_REQUESTS_JITTER', '0'))[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m# Connection timeouts[0m
[30;1m28 | [0m[35m#  - Defaults to double what the poll length for services should be[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35mworker_connections = int(env.get('WORKER_CONNECTIONS', '1000'))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# Recycle the process after X request randomized by the jitter[0m
[30;1m24 | [0m[35mmax_requests = int(env.get('MAX_REQUESTS', '0'))[0m
[30;1m25 | [0m[35mmax_requests_jitter = int(env.get('MAX_REQUESTS_JITTER', '0'))[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m# Connection timeouts[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Number of concurrent handled connections[0m
[30;1m20 | [0m[35mthreads = int(env.get('THREADS', 4))[0m
[30;1m21 | [0m[35mworker_connections = int(env.get('WORKER_CONNECTIONS', '1000'))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# Recycle the process after X request randomized by the jitter[0m
[30;1m24 | [0m[35mmax_requests = int(env.get('MAX_REQUESTS', '0'))[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35mworkers = int(env.get('WORKERS', 1))[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Number of concurrent handled connections[0m
[30;1m20 | [0m[35mthreads = int(env.get('THREADS', 4))[0m
[30;1m21 | [0m[35mworker_connections = int(env.get('WORKER_CONNECTIONS', '1000'))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# Recycle the process after X request randomized by the jitter[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35mbind = f":{int(env.get('PORT', 5003))}"[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# Number of processes to launch[0m
[30;1m17 | [0m[35mworkers = int(env.get('WORKERS', 1))[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Number of concurrent handled connections[0m
[30;1m20 | [0m[35mthreads = int(env.get('THREADS', 4))[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35mworker_class = env.get('WORKER_CLASS', 'gevent')[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Port to bind to[0m
[30;1m14 | [0m[35mbind = f":{int(env.get('PORT', 5003))}"[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# Number of processes to launch[0m
[30;1m17 | [0m[35mworkers = int(env.get('WORKERS', 1))[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35mfrom os import environ as env[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m# What backend gunicorn should use for workers[0m
[30;1m11 | [0m[35mworker_class = env.get('WORKER_CLASS', 'gevent')[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Port to bind to[0m
[30;1m14 | [0m[35mbind = f":{int(env.get('PORT', 5003))}"[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35mIf these variables are set globally for ui and you don't want it to effect the updaters[0m
[30;1m4 | [0m[35mthey can be overwritten (for all future systems) by setting them in the service manifest[0m
[30;1m5 | [0m[35mentry for the updater container, or (for a running system) in the service configuration[0m
[30;1m6 | [0m[35mUI panel for the update container.[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35mfrom os import environ as env[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m# Connection timeouts[0m
[30;1m28 | [0m[35m#  - Defaults to double what the poll length for services should be[0m
[30;1m29 | [0m[35mgraceful_timeout = int(env.get('GRACEFUL_TIMEOUT', '60'))[0m
[30;1m30 | [0m[35mtimeout = int(env.get('TIMEOUT', '60'))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# TLS/SSL Configuration[0m
[30;1m33 | [0m[35mcertfile = env.get('CERTFILE')[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mentry for the updater container, or (for a running system) in the service configuration[0m
[30;1m6 | [0m[35mUI panel for the update container.[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35mfrom os import environ as env[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m# What backend gunicorn should use for workers[0m
[30;1m11 | [0m[35mworker_class = env.get('WORKER_CLASS', 'gevent')[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mThe updater components get all the same environment variables as other core containers.[0m
[30;1m3 | [0m[35mIf these variables are set globally for ui and you don't want it to effect the updaters[0m
[30;1m4 | [0m[35mthey can be overwritten (for all future systems) by setting them in the service manifest[0m
[30;1m5 | [0m[35mentry for the updater container, or (for a running system) in the service configuration[0m
[30;1m6 | [0m[35mUI panel for the update container.[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35mfrom os import environ as env[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/gunicorn_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mThe updater components get all the same environment variables as other core containers.[0m
[30;1m3 | [0m[35mIf these variables are set globally for ui and you don't want it to effect the updaters[0m
[30;1m4 | [0m[35mthey can be overwritten (for all future systems) by setting them in the service manifest[0m
[30;1m5 | [0m[35mentry for the updater container, or (for a running system) in the service configuration[0m
[30;1m6 | [0m[35mUI panel for the update container.[0m
[30;1m7 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35mVous pouvez cr√©er un nouveau service Assemblyline en utilisant ce [template](https://github.com/Cybe[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m```bash[0m
[30;1m93 | [0m[35mapt install jq[0m
[30;1m94 | [0m[35mpip install git+https://github.com/CybercentreCanada/assemblyline-service-template.git[0m
[30;1m95 | [0m[35mcruft create https://github.com/CybercentreCanada/assemblyline-service-template.git[0m
[30;1m96 | [0m[35m```[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mVous pouvez cr√©er un nouveau service Assemblyline en utilisant ce [template](https://github.com/Cybe[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m```bash[0m
[30;1m93 | [0m[35mapt install jq[0m
[30;1m94 | [0m[35mpip install git+https://github.com/CybercentreCanada/assemblyline-service-template.git[0m
[30;1m95 | [0m[35mcruft create https://github.com/CybercentreCanada/assemblyline-service-template.git[0m
[30;1m96 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m## Cr√©er un nouveau service Assemblyline[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mVous pouvez cr√©er un nouveau service Assemblyline en utilisant ce [template](https://github.com/Cybe[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m```bash[0m
[30;1m93 | [0m[35mapt install jq[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mCe r√©f√©rentiel fournit les fonctionnalit√©s de base des services Assemblyline 4.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m## Cr√©er un nouveau service Assemblyline[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mVous pouvez cr√©er un nouveau service Assemblyline en utilisant ce [template](https://github.com/Cybe[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m---[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m# Assemblyline 4 - Service Base[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mCe r√©f√©rentiel fournit les fonctionnalit√©s de base des services Assemblyline 4.[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m## Documentation[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mFor more information about service development for Assemblyline, follow this [guide](https://cyberce[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m---[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35mYou can create a new Assemblyline service by using this [template](https://github.com/CybercentreCan[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m```bash[0m
[30;1m73 | [0m[35mapt install jq[0m
[30;1m74 | [0m[35mpip install git+https://github.com/CybercentreCanada/assemblyline-service-template.git[0m
[30;1m75 | [0m[35mcruft create https://github.com/CybercentreCanada/assemblyline-service-template.git[0m
[30;1m76 | [0m[35m```[0m
[30;1m77 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mYou can create a new Assemblyline service by using this [template](https://github.com/CybercentreCan[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m```bash[0m
[30;1m73 | [0m[35mapt install jq[0m
[30;1m74 | [0m[35mpip install git+https://github.com/CybercentreCanada/assemblyline-service-template.git[0m
[30;1m75 | [0m[35mcruft create https://github.com/CybercentreCanada/assemblyline-service-template.git[0m
[30;1m76 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m## Creating a new Assemblyline service[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mYou can create a new Assemblyline service by using this [template](https://github.com/CybercentreCan[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m```bash[0m
[30;1m73 | [0m[35mapt install jq[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m|  build_type  | The type of build used. `dev` is the latest unstable build. `stable` is the latest [0m
[30;1m66 | [0m[35m|    series    | Complete build details, including version and build type: `version.buildType`.     [0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m## Creating a new Assemblyline service[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mYou can create a new Assemblyline service by using this [template](https://github.com/CybercentreCan[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m```bash[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m# Assemblyline 4 - Service Base[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mThis repository provides the base service functionality for Assemblyline 4 services.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m## Image variants and tags[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m[![GitHub Issues or Pull Requests by label](https://img.shields.io/github/issues/CybercentreCanada/a[0m
[30;1m54 | [0m[35m[![License](https://img.shields.io/github/license/CybercentreCanada/assemblyline-v4-service)](./LICE[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m# Assemblyline 4 - Service Base[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mThis repository provides the base service functionality for Assemblyline 4 services.[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service-4.6.0.dev5.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mMetadata-Version: 2.4[0m
[30;1m2 | [0m[35mName: assemblyline-v4-service[0m
[30;1m3 | [0m[35mVersion: 4.6.0.dev5[0m
[30;1m4 | [0m[35mSummary: Assemblyline 4 - Service base[0m
[30;1m5 | [0m[35mHome-page: https://github.com/CybercentreCanada/assemblyline-v4-service/[0m
[30;1m6 | [0m[35mAuthor: CCCS Assemblyline development team[0m
[30;1m7 | [0m[35mAuthor-email: assemblyline@cyber.gc.ca[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m            self._shutdown_timeout = TASK_REQUEST_TIMEOUT + self.service_config.get('timeout', SHUTD[0m
[30;1m322 | [0m[35m        elif self.status not in [STATUSES.INITIALIZING, STATUSES.STOPPING]:[0m
[30;1m323 | [0m[35m            # A task is currently running, so wait until service timeout before doing a hard stop[0m
[30;1m324 | [0m[35m            self._shutdown_timeout = self.service_config.get('timeout', SHUTDOWN_SECONDS_LIMIT)[0m
[30;1m325 | [0m[35m        else:[0m
[30;1m326 | [0m[35m            # Already the default[0m
[30;1m327 | [0m[35m            self._shutdown_timeout = SHUTDOWN_SECONDS_LIMIT[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m    def stop(self):[0m
[30;1m319 | [0m[35m        if self.status == STATUSES.WAITING_FOR_TASK:[0m
[30;1m320 | [0m[35m            # A task request was sent and a task might be received, so shutdown after giving service[0m
[30;1m321 | [0m[35m            self._shutdown_timeout = TASK_REQUEST_TIMEOUT + self.service_config.get('timeout', SHUTD[0m
[30;1m322 | [0m[35m        elif self.status not in [STATUSES.INITIALIZING, STATUSES.STOPPING]:[0m
[30;1m323 | [0m[35m            # A task is currently running, so wait until service timeout before doing a hard stop[0m
[30;1m324 | [0m[35m            self._shutdown_timeout = self.service_config.get('timeout', SHUTDOWN_SECONDS_LIMIT)[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m                    file_info['classification'],[0m
[30;1m260 | [0m[35m                    task.ttl,[0m
[30;1m261 | [0m[35m                    file_info.get('is_section_image', False),[0m
[30;1m262 | [0m[35m                    file_info.get('is_supplementary', False),[0m
[30;1m263 | [0m[35m                    expected_sha256=file_info['sha256'][0m
[30;1m264 | [0m[35m                )[0m
[30;1m265 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m                    file_info['path'],[0m
[30;1m259 | [0m[35m                    file_info['classification'],[0m
[30;1m260 | [0m[35m                    task.ttl,[0m
[30;1m261 | [0m[35m                    file_info.get('is_section_image', False),[0m
[30;1m262 | [0m[35m                    file_info.get('is_supplementary', False),[0m
[30;1m263 | [0m[35m                    expected_sha256=file_info['sha256'][0m
[30;1m264 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m            result_files[file['sha256']] = copy.deepcopy(file)[0m
[30;1m243 | [0m[35m            file.pop('path', None)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        new_tool_version = result.get('response', {}).get('service_tool_version', None)[0m
[30;1m246 | [0m[35m        if new_tool_version is not None and self.service_tool_version != new_tool_version:[0m
[30;1m247 | [0m[35m            self.service_tool_version = new_tool_version[0m
[30;1m248 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m            result_files[file['sha256']] = copy.deepcopy(file)[0m
[30;1m243 | [0m[35m            file.pop('path', None)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        new_tool_version = result.get('response', {}).get('service_tool_version', None)[0m
[30;1m246 | [0m[35m        if new_tool_version is not None and self.service_tool_version != new_tool_version:[0m
[30;1m247 | [0m[35m            self.service_tool_version = new_tool_version[0m
[30;1m248 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m            # Load Task[0m
[30;1m167 | [0m[35m            try:[0m
[30;1m168 | [0m[35m                # Inspect task to ensure submission parameters are given, add defaults where necessa[0m
[30;1m169 | [0m[35m                params = {x['name']: x['default'] for x in service_manifest.get('submission_params',[0m
[30;1m170 | [0m[35m                params.update(task['service_config'])[0m
[30;1m171 | [0m[35m                task['service_config'] = params[0m
[30;1m172 | [0m[35m                service_task = ServiceTask(task)[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m        self.service_tool_version = self.service.get_tool_version()[0m
[30;1m147 | [0m[35m        self.metric_factory = MetricsFactory('service', Metrics, name=self.service_name,[0m
[30;1m148 | [0m[35m                                             export_zero=False, redis=self.redis)[0m
[30;1m149 | [0m[35m        file_required = self.service_config.get('file_required', True)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        # Start the service[0m
[30;1m152 | [0m[35m        self.service.start_service()[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # Instantiate the service based of the registration results[0m
[30;1m143 | [0m[35m        self.service_config = registration.get('service_config', {})[0m
[30;1m144 | [0m[35m        self.service = service_class(config=self.service_config.get('config'))[0m
[30;1m145 | [0m[35m        self.service_name = self.service_config['name'][0m
[30;1m146 | [0m[35m        self.service_tool_version = self.service.get_tool_version()[0m
[30;1m147 | [0m[35m        self.metric_factory = MetricsFactory('service', Metrics, name=self.service_name,[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m        self._update_manifest(registration.get('service_config', {}))[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # Instantiate the service based of the registration results[0m
[30;1m143 | [0m[35m        self.service_config = registration.get('service_config', {})[0m
[30;1m144 | [0m[35m        self.service = service_class(config=self.service_config.get('config'))[0m
[30;1m145 | [0m[35m        self.service_name = self.service_config['name'][0m
[30;1m146 | [0m[35m        self.service_tool_version = self.service.get_tool_version()[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m            return[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        # Commit service manifest changes back to disk[0m
[30;1m140 | [0m[35m        self._update_manifest(registration.get('service_config', {}))[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # Instantiate the service based of the registration results[0m
[30;1m143 | [0m[35m        self.service_config = registration.get('service_config', {})[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        self.tasking_client = TaskingClient(redis=self.redis, redis_persist=self.redis_persist,[0m
[30;1m67 | [0m[35m                                            register_only=REGISTER_ONLY)[0m
[30;1m68 | [0m[35m        self.tasking_dir = os.environ.get('TASKING_DIR', tempfile.gettempdir())[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        self.service = None[0m
[30;1m71 | [0m[35m        self.service_config = {}[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        super(RunPrivilegedService, self).__init__([0m
[30;1m50 | [0m[35m            f'assemblyline.service.{SERVICE_NAME}', shutdown_timeout=shutdown_timeout)[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        self.client_id = os.environ.get('HOSTNAME', 'dev-service')[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        self.redis = get_client([0m
[30;1m55 | [0m[35m            host=self.config.core.redis.nonpersistent.host,[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m27 | [0m[35mSERVICE_MANIFEST = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'service_manifes[0m
[30;1m28 | [0m[35mTMP_SERVICE_MANIFEST = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"[0m
[30;1m29 | [0m[35mREGISTER_ONLY = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mSERVICE_NAME = SERVICE_PATH.split(".")[-1].lower()[0m
[30;1m32 | [0m[35mSHUTDOWN_SECONDS_LIMIT = 10[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35mSERVICE_PATH = os.environ['SERVICE_PATH'][0m
[30;1m26 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m27 | [0m[35mSERVICE_MANIFEST = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'service_manifes[0m
[30;1m28 | [0m[35mTMP_SERVICE_MANIFEST = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"[0m
[30;1m29 | [0m[35mREGISTER_ONLY = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mSERVICE_NAME = SERVICE_PATH.split(".")[-1].lower()[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mSERVICE_PATH = os.environ['SERVICE_PATH'][0m
[30;1m26 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m27 | [0m[35mSERVICE_MANIFEST = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'service_manifes[0m
[30;1m28 | [0m[35mTMP_SERVICE_MANIFEST = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"[0m
[30;1m29 | [0m[35mREGISTER_ONLY = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35mfrom assemblyline_v4_service.common.base import is_recoverable_runtime_error[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mSERVICE_PATH = os.environ['SERVICE_PATH'][0m
[30;1m26 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m27 | [0m[35mSERVICE_MANIFEST = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'service_manifes[0m
[30;1m28 | [0m[35mTMP_SERVICE_MANIFEST = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"[0m
[30;1m29 | [0m[35mREGISTER_ONLY = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m320 | [0m[35m            # A task request was sent and a task might be received, so shutdown after giving service[0m
[30;1m321 | [0m[35m            self._shutdown_timeout = TASK_REQUEST_TIMEOUT + self.service_config.get('timeout', SHUTD[0m
[30;1m322 | [0m[35m        elif self.status not in [STATUSES.INITIALIZING, STATUSES.STOPPING]:[0m
[30;1m323 | [0m[35m            # A task is currently running, so wait until service timeout before doing a hard stop[0m
[30;1m324 | [0m[35m            self._shutdown_timeout = self.service_config.get('timeout', SHUTDOWN_SECONDS_LIMIT)[0m
[30;1m325 | [0m[35m        else:[0m
[30;1m326 | [0m[35m            # Already the default[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m    def stop(self):[0m
[30;1m319 | [0m[35m        if self.status == STATUSES.WAITING_FOR_TASK:[0m
[30;1m320 | [0m[35m            # A task request was sent and a task might be received, so shutdown after giving service[0m
[30;1m321 | [0m[35m            self._shutdown_timeout = TASK_REQUEST_TIMEOUT + self.service_config.get('timeout', SHUTD[0m
[30;1m322 | [0m[35m        elif self.status not in [STATUSES.INITIALIZING, STATUSES.STOPPING]:[0m
[30;1m323 | [0m[35m            # A task is currently running, so wait until service timeout before doing a hard stop[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m                with open(error_json_path, 'r') as f:[0m
[30;1m304 | [0m[35m                    error = json.load(f)[0m
[30;1m305 | [0m[35m            except (IOError, JSONDecodeError, OSError):[0m
[30;1m306 | [0m[35m                self.log.exception(f"[{task.sid}] An error occurred while loading service error file[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m        try:[0m
[30;1m309 | [0m[35m            resp = self.tasking_client.task_finished([0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m        error = dict([0m
[30;1m291 | [0m[35m            response=dict([0m
[30;1m292 | [0m[35m                message=message or "The service instance processing this task has terminated unexpec[0m
[30;1m293 | [0m[35m                service_name=task.service_name,[0m
[30;1m294 | [0m[35m                service_version=version,[0m
[30;1m295 | [0m[35m                status=status or 'FAIL_RECOVERABLE',[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m                    self._handle_task_result(result_json, service_task)[0m
[30;1m221 | [0m[35m                except RuntimeError as re:[0m
[30;1m222 | [0m[35m                    if is_recoverable_runtime_error(re):[0m
[30;1m223 | [0m[35m                        self.log.info(f"[{service_task.sid}] Service trying to use a threadpool duri[0m
[30;1m224 | [0m[35m                                      "sending recoverable error.")[0m
[30;1m225 | [0m[35m                        self._handle_task_error(service_task)[0m
[30;1m226 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m                    self.status = STATUSES.ERROR_FOUND[0m
[30;1m214 | [0m[35m                    error_json = None[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m            # Handle the service response[0m
[30;1m217 | [0m[35m            if self.status == STATUSES.RESULT_FOUND:[0m
[30;1m218 | [0m[35m                self.log.info(f"[{service_task.sid}] Task successfully completed")[0m
[30;1m219 | [0m[35m                try:[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m                self.status = STATUSES.PROCESSING[0m
[30;1m201 | [0m[35m                self.service.handle_task(service_task)[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m                # Check for the response from the service[0m
[30;1m204 | [0m[35m                result_json = os.path.join([0m
[30;1m205 | [0m[35m                    self.tasking_dir, f"{service_task.sid}_{service_task.fileinfo.sha256}_result.jso[0m
[30;1m206 | [0m[35m                error_json = os.path.join([0m
[30;1m207 | [0m[35m                    self.tasking_dir, f"{service_task.sid}_{service_task.fileinfo.sha256}_error.json[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m                                             export_zero=False, redis=self.redis)[0m
[30;1m149 | [0m[35m        file_required = self.service_config.get('file_required', True)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        # Start the service[0m
[30;1m152 | [0m[35m        self.service.start_service()[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m        while self.running:[0m
[30;1m155 | [0m[35m            # Cleanup the working directory[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m        # Commit service manifest changes back to disk[0m
[30;1m140 | [0m[35m        self._update_manifest(registration.get('service_config', {}))[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # Instantiate the service based of the registration results[0m
[30;1m143 | [0m[35m        self.service_config = registration.get('service_config', {})[0m
[30;1m144 | [0m[35m        self.service = service_class(config=self.service_config.get('config'))[0m
[30;1m145 | [0m[35m        self.service_name = self.service_config['name'][0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m            self.stop()[0m
[30;1m137 | [0m[35m            return[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        # Commit service manifest changes back to disk[0m
[30;1m140 | [0m[35m        self._update_manifest(registration.get('service_config', {}))[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # Instantiate the service based of the registration results[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m        # Load on-disk manifest for bootstrap/registration[0m
[30;1m128 | [0m[35m        service_manifest = self._load_manifest()[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        # Register the service[0m
[30;1m131 | [0m[35m        registration = self.tasking_client.register_service(service_manifest)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        # Are we just registering?[0m
[30;1m134 | [0m[35m        if not registration['keep_alive'] or REGISTER_ONLY:[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m        try:[0m
[30;1m122 | [0m[35m            service_class = load_module_by_path(SERVICE_PATH)[0m
[30;1m123 | [0m[35m        except Exception:[0m
[30;1m124 | [0m[35m            self.log.error("Could not find service in path.")[0m
[30;1m125 | [0m[35m            raise[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        # Load on-disk manifest for bootstrap/registration[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_privileged_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    def try_run(self):[0m
[30;1m118 | [0m[35m        self.status = STATUSES.INITIALIZING[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m        # Try to load service class[0m
[30;1m121 | [0m[35m        try:[0m
[30;1m122 | [0m[35m            service_class = load_module_by_path(SERVICE_PATH)[0m
[30;1m123 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_ocr.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m            'RANSOMWARE FROM YOUR COMPUTER. THE PRICE OF THE SOFTWARE IS '[0m
[30;1m19 | [0m[35m            '$.2..%.. PAYMENT CAN BE MADE IN BITCOIN OR XMR.',[0m
[30;1m20 | [0m[35m            'How 00! PAY, WHERE DO | GET BITCOIN OR XMR?',[0m
[30;1m21 | [0m[35m            'YOURSELF TO FIND OUT HOW TO BUY BITCOIN OR XMR.',[0m
[30;1m22 | [0m[35m            'PAYMENT INFORMATION: SEND $15, TO ONE OF OUR CRYPTO '[0m
[30;1m23 | [0m[35m            'ADDRESSES, THEN SEND US EMAIL WITH PAYMENT',[0m
[30;1m24 | [0m[35m            "CONFIRMATION AND YOU'LL GET THE DECRYPTION SOFTWARE IN EMAIL.",[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_ocr.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom assemblyline_v4_service.common.ocr import ocr_detections, detections, update_ocr_config[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m@pytest.mark.skipif(len(TESSERACT_LIST) < 1, reason="Requires tesseract-ocr apt package")[0m
[30;1m9 | [0m[35mdef test_ocr_detections():[0m
[30;1m10 | [0m[35m    update_ocr_config()[0m
[30;1m11 | [0m[35m    file_path = os.path.join(os.path.dirname(__file__), "b32969aa664e3905c20f865cdd7b921f922678f5c38[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m                self.delimiter = self._service.update_config.signature_delimiter[0m
[30;1m82 | [0m[35m                self.default_pattern = self._service.update_config.default_pattern[0m
[30;1m83 | [0m[35m                self.signatures_meta = {}[0m
[30;1m84 | [0m[35m                [self.update_queue.put(update.name) for update in self._service.update_config.source[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m                self.latest_updates_dir = latest_updates_dir[0m
[30;1m87 | [0m[35m                self.client = TestUpdaterClient(latest_updates_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m        # Initialize updater, download signatures, and load them into the service[0m
[30;1m142 | [0m[35m        updater = TestServiceUpdater()[0m
[30;1m143 | [0m[35m        updater.do_source_update()[0m
[30;1m144 | [0m[35m        updater.do_local_update()[0m
[30;1m145 | [0m[35m        rules_directory = updater.prepare_output_directory()[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/dev/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35mdef load_rules(service: ServiceBase):[0m
[30;1m63 | [0m[35m    with tempfile.TemporaryDirectory() as latest_updates_dir:[0m
[30;1m64 | [0m[35m        updater_module = importlib.import_module(service.service_attributes.dependencies['updates'].[0m
[30;1m65 | [0m[35m        # Find the UpdaterServer class[0m
[30;1m66 | [0m[35m        for v in updater_module.__dict__.values():[0m
[30;1m67 | [0m[35m            if inspect.isclass(v) and issubclass(v, ServiceUpdater) and v != ServiceUpdater:[0m
[30;1m68 | [0m[35m                updater_class = v[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m184 | [0m[35m                'SOFTWARE IS $.2..%.. PAYMENT CAN BE MADE IN BITCOIN '[0m
[30;1m185 | [0m[35m                'OR XMR.',[0m
[30;1m186 | [0m[35m                'How 00! PAY, WHERE DO | GET BITCOIN OR XMR?',[0m
[30;1m187 | [0m[35m                'YOURSELF TO FIND OUT HOW TO BUY BITCOIN OR XMR.',[0m
[30;1m188 | [0m[35m                'PAYMENT INFORMATION: SEND $15, TO ONE OF OUR CRYPTO '[0m
[30;1m189 | [0m[35m                'ADDRESSES, THEN SEND US EMAIL WITH PAYMENT',[0m
[30;1m190 | [0m[35m                "CONFIRMATION AND YOU'LL GET THE DECRYPTION SOFTWARE IN EMAIL.",[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m    ][0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m@pytest.mark.skipif(len(TESSERACT_LIST) < 1, reason="Requires tesseract-ocr apt package")[0m
[30;1m112 | [0m[35mdef test_add_image(service_request):[0m
[30;1m113 | [0m[35m    image_path = os.path.join([0m
[30;1m114 | [0m[35m        os.path.dirname(__file__),[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_request.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom assemblyline.odm.messages.task import Task as ServiceTask[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Ensure service manifest is instantiated before importing from OCR submodule[0m
[30;1m14 | [0m[35msetup_module()[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m            # Find the signature IDs that don't exist at this source anymore and disable them[0m
[30;1m190 | [0m[35m            for missing_signature_id in (existing_signature_ids - current_signature_ids):[0m
[30;1m191 | [0m[35m                missing_signature = self.datastore.signature.get(missing_signature_id)[0m
[30;1m192 | [0m[35m                if missing_signature.state_change_user in ['update_service_account', None] and \[0m
[30;1m193 | [0m[35m                        missing_signature.status != 'DISABLED':[0m
[30;1m194 | [0m[35m                    # Only disable signature if it doesn't seem to be in use/altered by a (real) use[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m        # Find the IDs that don't exist at this source anymore and remove the source from the source[0m
[30;1m92 | [0m[35m        missing_ids = existing_ids - current_ids[0m
[30;1m93 | [0m[35m        for missing_id in missing_ids:[0m
[30;1m94 | [0m[35m            missing_item = collection.get(missing_id)[0m
[30;1m95 | [0m[35m            original_sources = missing_item.sources[0m
[30;1m96 | [0m[35m            missing_item.sources = [[0m
[30;1m97 | [0m[35m                s[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom typing import Any, Dict, List, Optional, Set, Union[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mSIGNATURE_UPDATE_BATCH = int(os.environ.get('SIGNATURE_UPDATE_BATCH', '1000'))[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mclass SyncableBadlistClient(BadlistClient):[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m199 | [0m[35m        response = None[0m
[30;1m200 | [0m[35m        # Proceed with adding/updating signatures[0m
[30;1m201 | [0m[35m        if len(data) < SIGNATURE_UPDATE_BATCH:[0m
[30;1m202 | [0m[35m            # Update all of them in a single batch[0m
[30;1m203 | [0m[35m            response = super().add_update_many(source, sig_type, data, dedup_name)[0m
[30;1m204 | [0m[35m        else:[0m
[30;1m205 | [0m[35m            response = {[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m186 | [0m[35m                i.id for i in self.datastore.signature.stream_search(f"source:{source} AND type:{sig[0m
[30;1m187 | [0m[35m            ])[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m            # Find the signature IDs that don't exist at this source anymore and disable them[0m
[30;1m190 | [0m[35m            for missing_signature_id in (existing_signature_ids - current_signature_ids):[0m
[30;1m191 | [0m[35m                missing_signature = self.datastore.signature.get(missing_signature_id)[0m
[30;1m192 | [0m[35m                if missing_signature.state_change_user in ['update_service_account', None] and \[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m177 | [0m[35m                    # Otherwise a change did happen and this has to be reflected[0m
[30;1m178 | [0m[35m                    d['last_modified'] = 'NOW'[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m            # Update with JSON-friendly version of data to be sent to API[0m
[30;1m181 | [0m[35m            data[i] = d[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        if self.sync:[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m143 | [0m[35m    def add_update_many(self, source: str, sig_type: str, data: List[Union[dict, SignatureModel]],[0m
[30;1m144 | [0m[35m                        dedup_name: bool = True) -> Dict[str, Any]:[0m
[30;1m145 | [0m[35m        # This version of the API allows to sync signatures with the system by making direct changes[0m
[30;1m146 | [0m[35m        # Signatures that no longer exist at the source will be DISABLED to maintain active synchron[0m
[30;1m147 | [0m[35m        # but users can always re-deploy signatures if desired[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        current_signature_ids = set()[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    # Proceed with adding/updating items[0m
[30;1m114 | [0m[35m    if len(data) < SIGNATURE_UPDATE_BATCH:[0m
[30;1m115 | [0m[35m        # Update all of them in a single batch[0m
[30;1m116 | [0m[35m        return super(client.__class__, client).add_update_many(data)[0m
[30;1m117 | [0m[35m    else:[0m
[30;1m118 | [0m[35m        response = {"success": 0, "errors": False}[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m107 | [0m[35m            # Update the last updated time[0m
[30;1m108 | [0m[35m            missing_item.updated = "NOW"[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m            # Update missing item with latest changes[0m
[30;1m111 | [0m[35m            collection.save(missing_id, missing_item)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    # Proceed with adding/updating items[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m104 | [0m[35m                missing_item.enabled = False[0m
[30;1m105 | [0m[35m                missing_item.sources = original_sources[:1][0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m            # Update the last updated time[0m
[30;1m108 | [0m[35m            missing_item.updated = "NOW"[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m            # Update missing item with latest changes[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m99 | [0m[35m                if not (s.type == "external" and s.name == source)[0m
[30;1m100 | [0m[35m            ][0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m            # If there are no more sources to back this item, then disable it but leave at least one[0m
[30;1m103 | [0m[35m            if not missing_item.sources:[0m
[30;1m104 | [0m[35m                missing_item.enabled = False[0m
[30;1m105 | [0m[35m                missing_item.sources = original_sources[:1][0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m88 | [0m[35m            ][0m
[30;1m89 | [0m[35m        )[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        # Find the IDs that don't exist at this source anymore and remove the source from the source[0m
[30;1m92 | [0m[35m        missing_ids = existing_ids - current_ids[0m
[30;1m93 | [0m[35m        for missing_id in missing_ids:[0m
[30;1m94 | [0m[35m            missing_item = collection.get(missing_id)[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m            # Compute the expected ID and add it to the list[0m
[30;1m75 | [0m[35m            current_ids.add(client._preprocess_object(d))[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m        # Update with JSON-friendly version of data to be sent to API[0m
[30;1m78 | [0m[35m        data[i] = d[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    if client.sync:[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m46 | [0m[35m                             collection: ESCollection,[0m
[30;1m47 | [0m[35m                             data: List[Union[dict, BadlistModel, SafelistModel]]):[0m
[30;1m48 | [0m[35m    # This generic function allows to sync hashlist items with the system by making direct changes t[0m
[30;1m49 | [0m[35m    # Items that no longer exist at the source will be removed from `sources` to maintain active syn[0m
[30;1m50 | [0m[35m    # amongst multiple sources.[0m
[30;1m51 | [0m[35m    # If there are no more sources actively blocking the item, then the item will be DISABLED but us[0m
[30;1m52 | [0m[35m    # re-deploy item if desired[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m                i.id for i in self.datastore.signature.stream_search(f"source:{source} AND type:{sig[0m
[30;1m187 | [0m[35m            ])[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m            # Find the signature IDs that don't exist at this source anymore and disable them[0m
[30;1m190 | [0m[35m            for missing_signature_id in (existing_signature_ids - current_signature_ids):[0m
[30;1m191 | [0m[35m                missing_signature = self.datastore.signature.get(missing_signature_id)[0m
[30;1m192 | [0m[35m                if missing_signature.state_change_user in ['update_service_account', None] and \[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m                missing_item.enabled = False[0m
[30;1m105 | [0m[35m                missing_item.sources = original_sources[:1][0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m            # Update the last updated time[0m
[30;1m108 | [0m[35m            missing_item.updated = "NOW"[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m            # Update missing item with latest changes[0m
[30;1m111 | [0m[35m            collection.save(missing_id, missing_item)[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m            ][0m
[30;1m89 | [0m[35m        )[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        # Find the IDs that don't exist at this source anymore and remove the source from the source[0m
[30;1m92 | [0m[35m        missing_ids = existing_ids - current_ids[0m
[30;1m93 | [0m[35m        for missing_id in missing_ids:[0m
[30;1m94 | [0m[35m            missing_item = collection.get(missing_id)[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        yml_data = yaml.safe_load(bio)[0m
[30;1m80 | [0m[35m        if yml_data:[0m
[30;1m81 | [0m[35m            # Ignore stable from service version[0m
[30;1m82 | [0m[35m            yml_data['version'] = yml_data.get('version', SERVICE_TAG).replace('stable', '')[0m
[30;1m83 | [0m[35m            return yml_data[0m
[30;1m84 | [0m[35m        else:[0m
[30;1m85 | [0m[35m            raise Exception("Service manifest is empty.")[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    service_manifest_yml = os.environ.get([0m
[30;1m67 | [0m[35m        'SERVICE_MANIFEST_PATH', f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml")[0m
[30;1m68 | [0m[35m    if not os.path.exists(service_manifest_yml):[0m
[30;1m69 | [0m[35m        service_manifest_yml = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'ser[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    if os.path.exists(service_manifest_yml):[0m
[30;1m72 | [0m[35m        bio = BytesIO()[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mdef get_service_manifest() -> Dict:[0m
[30;1m66 | [0m[35m    service_manifest_yml = os.environ.get([0m
[30;1m67 | [0m[35m        'SERVICE_MANIFEST_PATH', f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml")[0m
[30;1m68 | [0m[35m    if not os.path.exists(service_manifest_yml):[0m
[30;1m69 | [0m[35m        service_manifest_yml = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'ser[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mdef get_service_manifest() -> Dict:[0m
[30;1m66 | [0m[35m    service_manifest_yml = os.environ.get([0m
[30;1m67 | [0m[35m        'SERVICE_MANIFEST_PATH', f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml")[0m
[30;1m68 | [0m[35m    if not os.path.exists(service_manifest_yml):[0m
[30;1m69 | [0m[35m        service_manifest_yml = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'ser[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35mdef get_heuristics() -> Dict[Union[str, int], Heuristic]:[0m
[30;1m35 | [0m[35m    service_manifest_data = get_service_manifest()[0m
[30;1m36 | [0m[35m    output = {}[0m
[30;1m37 | [0m[35m    heuristics = service_manifest_data.get('heuristics', None)[0m
[30;1m38 | [0m[35m    if heuristics:[0m
[30;1m39 | [0m[35m        for heuristic in heuristics:[0m
[30;1m40 | [0m[35m            # Fix attack ID legacy values and convert them to a list[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35mfrom assemblyline.odm.models.heuristic import Heuristic[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef get_classification() -> Classification:[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m        yml_data = yaml.safe_load(bio)[0m
[30;1m80 | [0m[35m        if yml_data:[0m
[30;1m81 | [0m[35m            # Ignore stable from service version[0m
[30;1m82 | [0m[35m            yml_data['version'] = yml_data.get('version', SERVICE_TAG).replace('stable', '')[0m
[30;1m83 | [0m[35m            return yml_data[0m
[30;1m84 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35mdef get_service_attributes() -> Service:[0m
[30;1m51 | [0m[35m    service_manifest_data = get_service_manifest()[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    # Pop the 'extra' data from the service manifest[0m
[30;1m54 | [0m[35m    for x in ['file_required', 'tool_version', 'heuristics']:[0m
[30;1m55 | [0m[35m        service_manifest_data.pop(x, None)[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m                classification_definition = recursive_update(classification_definition, yml_data)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    if not classification_definition:[0m
[30;1m29 | [0m[35m        raise InvalidDefinition("Could not find any classification definition to load.")[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    return Classification(classification_definition)[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom assemblyline.common.dict_utils import recursive_update[0m
[30;1m8 | [0m[35mfrom assemblyline.common.version import BUILD_MINOR, FRAMEWORK_VERSION, SYSTEM_VERSION[0m
[30;1m9 | [0m[35mfrom assemblyline.odm.models.heuristic import Heuristic[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSERVICE_TAG = os.environ.get("SERVICE_TAG", f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        self.service_tool_version = self.service.get_tool_version()[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        self.service_file_required = service_manifest_data.get('file_required', True)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35mif __name__ == '__main__':[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m    def load_service_attributes(self) -> None:[0m
[30;1m125 | [0m[35m        service_manifest_data = helper.get_service_manifest()[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        self.service_config = service_manifest_data.get('config', {})[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        self.service = self.service_class(config=self.service_config)[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        if not os.path.exists(self.runtime_service_manifest):[0m
[30;1m49 | [0m[35m            # In case service tag have not been overwritten we will do it here (This is mainly use d[0m
[30;1m50 | [0m[35m            service_tag = os.environ.get("SERVICE_TAG",[0m
[30;1m51 | [0m[35m                                         f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev0")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m            with open(self.service_manifest, "rb") as srv_manifest:[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        self.service_file_required = None[0m
[30;1m37 | [0m[35m        self.task_fifo = None[0m
[30;1m38 | [0m[35m        self.done_fifo = None[0m
[30;1m39 | [0m[35m        self.tasking_dir = os.environ.get('TASKING_DIR', tempfile.gettempdir())[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    def try_run(self):[0m
[30;1m42 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        self.service_manifest = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'se[0m
[30;1m26 | [0m[35m        self.runtime_service_manifest = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifes[0m
[30;1m27 | [0m[35m        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"[0m
[30;1m28 | [0m[35m        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        self.status = None[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        self.classification_yml = '/etc/assemblyline/classification.yml'[0m
[30;1m25 | [0m[35m        self.service_manifest = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'se[0m
[30;1m26 | [0m[35m        self.runtime_service_manifest = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifes[0m
[30;1m27 | [0m[35m        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"[0m
[30;1m28 | [0m[35m        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        self.status = None[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self.classification_yml = '/etc/assemblyline/classification.yml'[0m
[30;1m25 | [0m[35m        self.service_manifest = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'se[0m
[30;1m26 | [0m[35m        self.runtime_service_manifest = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifes[0m
[30;1m27 | [0m[35m        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"[0m
[30;1m28 | [0m[35m        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35mn_timeout: int = SHUTDOWN_SECONDS_LIMIT):[0m
[30;1m22 | [0m[35m        super(RunService, self).__init__(f'assemblyline.service.{SERVICE_NAME}', shutdown_timeout=sh[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self.classification_yml = '/etc/assemblyline/classification.yml'[0m
[30;1m25 | [0m[35m        self.service_manifest = os.path.join(os.getcwd(), os.environ.get('MANIFEST_FOLDER', ''), 'se[0m
[30;1m26 | [0m[35m        self.runtime_service_manifest = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifes[0m
[30;1m27 | [0m[35m        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m            os.mkfifo(self.done_fifo_path)[0m
[30;1m68 | [0m[35m        self.done_fifo = open(self.done_fifo_path, "w")[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        # Reload the service again with the new config parameters (if any) received from service ser[0m
[30;1m71 | [0m[35m        self.load_service_attributes()[0m
[30;1m72 | [0m[35m        self.service.start_service()[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m            os.mkfifo(self.done_fifo_path)[0m
[30;1m68 | [0m[35m        self.done_fifo = open(self.done_fifo_path, "w")[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        # Reload the service again with the new config parameters (if any) received from service ser[0m
[30;1m71 | [0m[35m        self.load_service_attributes()[0m
[30;1m72 | [0m[35m        self.service.start_service()[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m            raise[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        if not os.path.exists(self.runtime_service_manifest):[0m
[30;1m49 | [0m[35m            # In case service tag have not been overwritten we will do it here (This is mainly use d[0m
[30;1m50 | [0m[35m            service_tag = os.environ.get("SERVICE_TAG",[0m
[30;1m51 | [0m[35m                                         f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{BUILD_MINOR}.dev0")[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/run_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m        try:[0m
[30;1m43 | [0m[35m            self.service_class = load_module_by_path(SERVICE_PATH)[0m
[30;1m44 | [0m[35m        except Exception:[0m
[30;1m45 | [0m[35m            self.log.error("Could not find service in path.")[0m
[30;1m46 | [0m[35m            raise[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        if not os.path.exists(self.runtime_service_manifest):[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_ontology_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m            self.task.extracted.append({"path": path, "name": name, "description": description})[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        def get_param(self, key):[0m
[30;1m66 | [0m[35m            val = self.get(key, None)[0m
[30;1m67 | [0m[35m            if val is None:[0m
[30;1m68 | [0m[35m                raise Exception(f"Service submission parameter not found: {key}")[0m
[30;1m69 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m472 | [0m[35m                        self.push_status("UPDATING", "Importing..")[0m
[30;1m473 | [0m[35m                        # Import into Assemblyline[0m
[30;1m474 | [0m[35m                        self.import_update(validated_files, source_name, default_classification,[0m
[30;1m475 | [0m[35m                                           source.get('configuration') or {})[0m
[30;1m476 | [0m[35m                        self.push_status("DONE", "Signature(s) Imported.")[0m
[30;1m477 | [0m[35m                    except SkipSource:[0m
[30;1m478 | [0m[35m                        # This source hasn't changed, no need to re-import into Assemblyline[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m464 | [0m[35m                        for file, sha256 in files:[0m
[30;1m465 | [0m[35m                            files_sha256.setdefault(source_name, {})[0m
[30;1m466 | [0m[35m                            if previous_hashes.get([0m
[30;1m467 | [0m[35m                                    source_name, {}).get([0m
[30;1m468 | [0m[35m                                    file, None) != sha256 and self.is_valid(file):[0m
[30;1m469 | [0m[35m                                files_sha256[source_name][file] = sha256[0m
[30;1m470 | [0m[35m                                validated_files.append((file, sha256))[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m463 | [0m[35m                        validated_files = list()[0m
[30;1m464 | [0m[35m                        for file, sha256 in files:[0m
[30;1m465 | [0m[35m                            files_sha256.setdefault(source_name, {})[0m
[30;1m466 | [0m[35m                            if previous_hashes.get([0m
[30;1m467 | [0m[35m                                    source_name, {}).get([0m
[30;1m468 | [0m[35m                                    file, None) != sha256 and self.is_valid(file):[0m
[30;1m469 | [0m[35m                                files_sha256[source_name][file] = sha256[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m                        self.push_status("UPDATING", "Pulling..")[0m
[30;1m432 | [0m[35m                        output = None[0m
[30;1m433 | [0m[35m                        seen_fetch = seen_fetches.get(uri)[0m
[30;1m434 | [0m[35m                        if seen_fetch == 'skipped':[0m
[30;1m435 | [0m[35m                            # Skip source if another source says nothing has changed[0m
[30;1m436 | [0m[35m                            raise SkipSource[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m425 | [0m[35m                        # Override classfication of signatures if specified[0m
[30;1m426 | [0m[35m                        # Reset client back to original classification state between updates[0m
[30;1m427 | [0m[35m                        self.client.classification_override = None[0m
[30;1m428 | [0m[35m                        if source.get('override_classification', False):[0m
[30;1m429 | [0m[35m                            self.client.classification_override = default_classification[0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m                        self.push_status("UPDATING", "Pulling..")[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m421 | [0m[35m                        # Configure the client as necessary[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35m                        # Enable syncing if the source specifies it[0m
[30;1m424 | [0m[35m                        self.client.sync = source.get('sync', False)[0m
[30;1m425 | [0m[35m                        # Override classfication of signatures if specified[0m
[30;1m426 | [0m[35m                        # Reset client back to original classification state between updates[0m
[30;1m427 | [0m[35m                        self.client.classification_override = None[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m                        self.push_status("UPDATING", "Starting..")[0m
[30;1m418 | [0m[35m                        fetch_method = source.get('fetch_method', 'GET')[0m
[30;1m419 | [0m[35m                        default_classification = source.get('default_classification', classification[0m
[30;1m420 | [0m[35m[0m
[30;1m421 | [0m[35m                        # Configure the client as necessary[0m
[30;1m422 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m                        self.push_status("UPDATING", "Starting..")[0m
[30;1m418 | [0m[35m                        fetch_method = source.get('fetch_method', 'GET')[0m
[30;1m419 | [0m[35m                        default_classification = source.get('default_classification', classification[0m
[30;1m420 | [0m[35m[0m
[30;1m421 | [0m[35m                        # Configure the client as necessary[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m                        # Is it time for this source to run?[0m
[30;1m410 | [0m[35m                        elapsed_time = time.time() - old_update_time[0m
[30;1m411 | [0m[35m                        update_interval = source.get('update_interval') or service.update_config.upd[0m
[30;1m412 | [0m[35m                        if elapsed_time < update_interval:[0m
[30;1m413 | [0m[35m                            # Too early to run the update for this particular source, skip for now[0m
[30;1m414 | [0m[35m                            raise SkipSource[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m378 | [0m[35m            # Go through each source queued and download file[0m
[30;1m379 | [0m[35m            while self.update_queue.qsize():[0m
[30;1m380 | [0m[35m                update_attempt = -1[0m
[30;1m381 | [0m[35m                source_name = self.update_queue.get()[0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m                if source_name not in sources:[0m
[30;1m384 | [0m[35m                    # This source has been removed from the service configuration[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m        if missing_sources and not self.source_update_flag.is_set():[0m
[30;1m313 | [0m[35m            # If sources are missing, then clear caching from Redis and trigger source updates[0m
[30;1m314 | [0m[35m            for source in missing_sources:[0m
[30;1m315 | [0m[35m                source_status = self.update_data_hash.get(f"{source}.{SOURCE_STATUS_KEY}")[0m
[30;1m316 | [0m[35m                if source_status and source_status["state"] != "ERROR":[0m
[30;1m317 | [0m[35m                    # Re-task missing sources that aren't known to have a critical error[0m
[30;1m318 | [0m[35m                    self.update_data_hash.set(f"{source}.{SOURCE_UPDATE_TIME_KEY}", 0)[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m                                  value=dict(state=state, message=message, ts=now_as_iso()))[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m    def _set_service_stage(self):[0m
[30;1m276 | [0m[35m        old_service_stage = self._service_stage_hash.get(SERVICE_NAME)[0m
[30;1m277 | [0m[35m        new_service_stage = ServiceStage.Running[0m
[30;1m278 | [0m[35m        if self._service.update_config.wait_for_update:[0m
[30;1m279 | [0m[35m            new_service_stage = ServiceStage.Running if self._inventory_check() else ServiceStage.Up[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        # Update signature client with any changes to classification rewrites[0m
[30;1m262 | [0m[35m        self.client.signature.classification_replace_map = \[0m
[30;1m263 | [0m[35m            self._service.config.get('updater', {}).get('classification_replace', {})[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        # If the update configuration for the service has changed, trigger an update[0m
[30;1m266 | [0m[35m        if self.config_hash(self._service) != self.get_active_config_hash():[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        # Update signature client with any changes to classification rewrites[0m
[30;1m262 | [0m[35m        self.client.signature.classification_replace_map = \[0m
[30;1m263 | [0m[35m            self._service.config.get('updater', {}).get('classification_replace', {})[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        # If the update configuration for the service has changed, trigger an update[0m
[30;1m266 | [0m[35m        if self.config_hash(self._service) != self.get_active_config_hash():[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def stop(self):[0m
[30;1m192 | [0m[35m        current_source_state = self.update_data_hash.get(f"{self._current_source}.{SOURCE_STATUS_KEY[0m
[30;1m193 | [0m[35m        if current_source_state.get("state") == "UPDATING":[0m
[30;1m194 | [0m[35m            # Declare the update has failed and will retry again on next boot[0m
[30;1m195 | [0m[35m            self.push_status("ERROR", "Update interrupted by server shutdown")[0m
[30;1m196 | [0m[35m        super().stop()[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m        }[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def stop(self):[0m
[30;1m192 | [0m[35m        current_source_state = self.update_data_hash.get(f"{self._current_source}.{SOURCE_STATUS_KEY[0m
[30;1m193 | [0m[35m        if current_source_state.get("state") == "UPDATING":[0m
[30;1m194 | [0m[35m            # Declare the update has failed and will retry again on next boot[0m
[30;1m195 | [0m[35m            self.push_status("ERROR", "Update interrupted by server shutdown")[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m        self.update_data_hash.set(f"{self._current_source}.{SOURCE_UPDATE_TIME_KEY}", update_time)[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    def get_source_extra(self) -> dict[str, Any]:[0m
[30;1m169 | [0m[35m        return self.update_data_hash.get(f"{self._current_source}.{SOURCE_EXTRA_KEY}") or {}[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    def set_source_extra(self, extra_data: dict[str, Any]):[0m
[30;1m172 | [0m[35m        self.update_data_hash.set(f"{self._current_source}.{SOURCE_EXTRA_KEY}", extra_data)[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m        return self.update_data_hash.set(SOURCE_UPDATE_TIME_KEY, update_time)[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m    def get_source_update_time(self) -> float:[0m
[30;1m163 | [0m[35m        return self.update_data_hash.get(f"{self._current_source}.{SOURCE_UPDATE_TIME_KEY}") or 0[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    def set_source_update_time(self, update_time: float):[0m
[30;1m166 | [0m[35m        self.update_data_hash.set(f"{self._current_source}.{SOURCE_UPDATE_TIME_KEY}", update_time)[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m        self.update_data_hash.set(CONFIG_HASH_KEY, config_hash)[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    def get_scheduled_update_time(self) -> float:[0m
[30;1m157 | [0m[35m        return self.update_data_hash.get(SOURCE_UPDATE_TIME_KEY) or 0[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    def set_scheduled_update_time(self, update_time):[0m
[30;1m160 | [0m[35m        return self.update_data_hash.set(SOURCE_UPDATE_TIME_KEY, update_time)[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        return self._update_tar[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def get_active_config_hash(self) -> int:[0m
[30;1m151 | [0m[35m        return self.update_data_hash.get(CONFIG_HASH_KEY) or 0[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def set_active_config_hash(self, config_hash: int):[0m
[30;1m154 | [0m[35m        self.update_data_hash.set(CONFIG_HASH_KEY, config_hash)[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        # Queue up any sources that were tasked from a previous run or that has failed[0m
[30;1m92 | [0m[35m        for k, v in self.update_data_hash.items().items():[0m
[30;1m93 | [0m[35m            if k.endswith(".status") and v.get("state") in ["UPDATING", "ERROR"]:[0m
[30;1m94 | [0m[35m                self.update_queue.put(k.rsplit(".", 1)[0])[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        self._update_dir = None[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        self.default_pattern = None[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        if not logger:[0m
[30;1m81 | [0m[35m            al_log.init_logging(f'updater.{self.updater_type}', log_level=os.environ.get('LOG_LEVEL'[0m
[30;1m82 | [0m[35m            logger = logging.getLogger(f'assemblyline.updater.{self.updater_type}')[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        super().__init__(f'assemblyline.{SERVICE_NAME}_updater', logger=logger, shutdown_timeout=shu[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35mSOURCE_EXTRA_KEY = 'source_extra'[0m
[30;1m51 | [0m[35mSOURCE_STATUS_KEY = 'status'[0m
[30;1m52 | [0m[35mSOURCE_UPDATE_ATTEMPT_DELAY_BASE = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_DELAY_BASE", "5"))[0m
[30;1m53 | [0m[35mSOURCE_UPDATE_ATTEMPT_MAX_RETRY = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_MAX_RETRY", "3"))[0m
[30;1m54 | [0m[35mUPDATER_DIR = os.getenv('UPDATER_DIR', os.path.join(tempfile.gettempdir(), 'updater'))[0m
[30;1m55 | [0m[35mUPDATER_API_ROLES = ['badlist_manage', 'signature_import', 'signature_download',[0m
[30;1m56 | [0m[35m                     'signature_view', 'safelist_manage', 'apikey_access', 'signature_manage'][0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35mLOCAL_UPDATE_TIME_KEY = 'local_update_time'[0m
[30;1m50 | [0m[35mSOURCE_EXTRA_KEY = 'source_extra'[0m
[30;1m51 | [0m[35mSOURCE_STATUS_KEY = 'status'[0m
[30;1m52 | [0m[35mSOURCE_UPDATE_ATTEMPT_DELAY_BASE = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_DELAY_BASE", "5"))[0m
[30;1m53 | [0m[35mSOURCE_UPDATE_ATTEMPT_MAX_RETRY = int(os.environ.get("SOURCE_UPDATE_ATTEMPT_MAX_RETRY", "3"))[0m
[30;1m54 | [0m[35mUPDATER_DIR = os.getenv('UPDATER_DIR', os.path.join(tempfile.gettempdir(), 'updater'))[0m
[30;1m55 | [0m[35mUPDATER_API_ROLES = ['badlist_manage', 'signature_import', 'signature_download',[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m645 | [0m[35m[0m
[30;1m646 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m
[30;1m647 | [0m[35m        while self.running:[0m
[30;1m648 | [0m[35m            # Is it time to update yet?[0m
[30;1m649 | [0m[35m            if not self.local_update_flag.is_set():[0m
[30;1m650 | [0m[35m                self.local_update_flag.wait(60)[0m
[30;1m651 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m643 | [0m[35m            return[0m
[30;1m644 | [0m[35m        self.local_update_start.wait()[0m
[30;1m645 | [0m[35m[0m
[30;1m646 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m
[30;1m647 | [0m[35m        while self.running:[0m
[30;1m648 | [0m[35m            # Is it time to update yet?[0m
[30;1m649 | [0m[35m            if not self.local_update_flag.is_set():[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m616 | [0m[35m                self.log.info(f"Remove old directory: {new_directory}")[0m
[30;1m617 | [0m[35m                shutil.rmtree(new_directory, ignore_errors=True)[0m
[30;1m618 | [0m[35m            if new_time and os.path.exists(new_time):[0m
[30;1m619 | [0m[35m                self.log.info(f"Remove old time keeper file: {new_time}")[0m
[30;1m620 | [0m[35m                os.unlink(new_time)[0m
[30;1m621 | [0m[35m[0m
[30;1m622 | [0m[35m            # Cleanup old timekeepers/tars from unexpected termination(s) on persistent storage[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m609 | [0m[35m            self.log.info(f"Now serving: {self._update_dir} and {self._update_tar} ({self.get_local_[0m
[30;1m610 | [0m[35m        finally:[0m
[30;1m611 | [0m[35m            if new_tar and os.path.exists(new_tar):[0m
[30;1m612 | [0m[35m                self.log.info(f"Remove old tar file: {new_tar}")[0m
[30;1m613 | [0m[35m                time.sleep(3)[0m
[30;1m614 | [0m[35m                os.unlink(new_tar)[0m
[30;1m615 | [0m[35m            if new_directory and os.path.exists(new_directory):[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m587 | [0m[35m        open(os.path.join(new_directory, SIGNATURES_META_FILENAME), 'w').write(json.dumps(signature_[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35m        try:[0m
[30;1m590 | [0m[35m            # Tar update directory[0m
[30;1m591 | [0m[35m            new_tar = tempfile.NamedTemporaryFile(prefix="signatures_", dir=UPDATER_DIR, suffix='.ta[0m
[30;1m592 | [0m[35m                                                  delete=False)[0m
[30;1m593 | [0m[35m            new_tar.close()[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m579 | [0m[35m                                                                   as_obj=False)[0m
[30;1m580 | [0m[35m            }[0m
[30;1m581 | [0m[35m        else:[0m
[30;1m582 | [0m[35m            # Pull source metadata from synced service configuration[0m
[30;1m583 | [0m[35m            signature_map = {[0m
[30;1m584 | [0m[35m                source.name: {'classification': source['default_classification'].value}[0m
[30;1m585 | [0m[35m                for source in self._service.update_config.sources[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m567 | [0m[35m        new_tar = ''[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m        # Before serving directory, let's maintain a map of the different signatures and their curre[0m
[30;1m570 | [0m[35m        # This map allows the service to be more responsive to changes made locally to the system su[0m
[30;1m571 | [0m[35m        # classification changes.[0m
[30;1m572 | [0m[35m        # This also avoids the need to have to insert this kind of metadata into the signature itsel[0m
[30;1m573 | [0m[35m        if self._service.update_config.generates_signatures:[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m534 | [0m[35m            update_interval = min([service.update_config.update_interval_seconds] +[0m
[30;1m535 | [0m[35m                                  [s.update_interval for s in service.update_config.sources if s.upd[0m
[30;1m536 | [0m[35m[0m
[30;1m537 | [0m[35m            # Is it time to update yet?[0m
[30;1m538 | [0m[35m            if time.time() - self.get_scheduled_update_time() < update_interval \[0m
[30;1m539 | [0m[35m                    and not self.source_update_flag.is_set():[0m
[30;1m540 | [0m[35m                self.source_update_flag.wait(60)[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m528 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m
[30;1m529 | [0m[35m        while self.running:[0m
[30;1m530 | [0m[35m            # Stringify and hash the the current update configuration[0m
[30;1m531 | [0m[35m            service = self._service[0m
[30;1m532 | [0m[35m[0m
[30;1m533 | [0m[35m            # The update interval (or sleep interval) will be based on the smallest interval across [0m
[30;1m534 | [0m[35m            update_interval = min([service.update_config.update_interval_seconds] +[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m525 | [0m[35m            self.log.exception('An error occurred loading cached update files. Continuing.')[0m
[30;1m526 | [0m[35m        self.local_update_start.set()[0m
[30;1m527 | [0m[35m[0m
[30;1m528 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m
[30;1m529 | [0m[35m        while self.running:[0m
[30;1m530 | [0m[35m            # Stringify and hash the the current update configuration[0m
[30;1m531 | [0m[35m            service = self._service[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m447 | [0m[35m                                if not os.path.exists(output):[0m
[30;1m448 | [0m[35m                                    raise FileNotFoundError(f"{output} doesn't exist within containe[0m
[30;1m449 | [0m[35m                            elif fetch_method == "GIT" or uri.endswith('.git'):[0m
[30;1m450 | [0m[35m                                # First we'll attempt by performing a Git clone[0m
[30;1m451 | [0m[35m                                # (since not all services hint at being a repository in their URL),[0m
[30;1m452 | [0m[35m                                output = git_clone_repo(source, old_update_time, self.log, update_di[0m
[30;1m453 | [0m[35m                            else:[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m442 | [0m[35m                            self.log.info(f"Fetching {source_name} using {fetch_method}")[0m
[30;1m443 | [0m[35m                            # Pull sources from external locations[0m
[30;1m444 | [0m[35m                            if uri.startswith("file:///"):[0m
[30;1m445 | [0m[35m                                # Perform an update using a local mount[0m
[30;1m446 | [0m[35m                                output = uri.split("file://", 1)[1][0m
[30;1m447 | [0m[35m                                if not os.path.exists(output):[0m
[30;1m448 | [0m[35m                                    raise FileNotFoundError(f"{output} doesn't exist within containe[0m
[30;1m449 | [0m[35m                            elif fetch_method == "GIT" or uri.endswith('.git'):[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m406 | [0m[35m                        if not source_obj.enabled:[0m
[30;1m407 | [0m[35m                            raise SkipSource[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m                        # Is it time for this source to run?[0m
[30;1m410 | [0m[35m                        elapsed_time = time.time() - old_update_time[0m
[30;1m411 | [0m[35m                        update_interval = source.get('update_interval') or service.update_config.upd[0m
[30;1m412 | [0m[35m                        if elapsed_time < update_interval:[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m381 | [0m[35m                source_name = self.update_queue.get()[0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m                if source_name not in sources:[0m
[30;1m384 | [0m[35m                    # This source has been removed from the service configuration[0m
[30;1m385 | [0m[35m                    continue[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m                while update_attempt < SOURCE_UPDATE_ATTEMPT_MAX_RETRY:[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m        if not os.path.exists(UPDATER_DIR):[0m
[30;1m327 | [0m[35m            os.makedirs(UPDATER_DIR)[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m        # Create a temporary file for the time keeper[0m
[30;1m330 | [0m[35m        time_keeper = tempfile.NamedTemporaryFile(prefix="time_keeper_", dir=UPDATER_DIR, delete=Fal[0m
[30;1m331 | [0m[35m        time_keeper.close()[0m
[30;1m332 | [0m[35m        time_keeper = time_keeper.name[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m299 | [0m[35m                remove_source = None[0m
[30;1m300 | [0m[35m                for source in missing_sources:[0m
[30;1m301 | [0m[35m                    if source in path:[0m
[30;1m302 | [0m[35m                        # We have at least one source we can pass to the service for now[0m
[30;1m303 | [0m[35m                        remove_source = source[0m
[30;1m304 | [0m[35m                        check_passed = True[0m
[30;1m305 | [0m[35m                        break[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m283 | [0m[35m            if not old_service_stage:[0m
[30;1m284 | [0m[35m                old_service_stage = 0[0m
[30;1m285 | [0m[35m            old_service_stage = ServiceStage(old_service_stage)[0m
[30;1m286 | [0m[35m            self.log.info(f"Moving service from stage: {old_service_stage.name} to {new_service_stag[0m
[30;1m287 | [0m[35m            self._service_stage_hash.set(SERVICE_NAME, new_service_stage)[0m
[30;1m288 | [0m[35m            self.event_sender.send(SERVICE_NAME, {'operation': Operation.Modified, 'name': SERVICE_N[0m
[30;1m289 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m            new_service_stage = ServiceStage.Running if self._inventory_check() else ServiceStage.Up[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m        if old_service_stage != new_service_stage:[0m
[30;1m282 | [0m[35m            # There has been a change in service stages, alert Scaler[0m
[30;1m283 | [0m[35m            if not old_service_stage:[0m
[30;1m284 | [0m[35m                old_service_stage = 0[0m
[30;1m285 | [0m[35m            old_service_stage = ServiceStage(old_service_stage)[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m        self.client.signature.classification_replace_map = \[0m
[30;1m263 | [0m[35m            self._service.config.get('updater', {}).get('classification_replace', {})[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        # If the update configuration for the service has changed, trigger an update[0m
[30;1m266 | [0m[35m        if self.config_hash(self._service) != self.get_active_config_hash():[0m
[30;1m267 | [0m[35m            self.source_update_flag.set()[0m
[30;1m268 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m251 | [0m[35m            self._pull_settings()[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    def _pull_settings(self):[0m
[30;1m254 | [0m[35m        # Download the service object from datastore[0m
[30;1m255 | [0m[35m        self._service = self.datastore.get_service_with_delta(SERVICE_NAME)[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m        # Set default pattern if not already set[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    @staticmethod[0m
[30;1m225 | [0m[35m    def config_hash(service: Service) -> int:[0m
[30;1m226 | [0m[35m        if service is None:[0m
[30;1m227 | [0m[35m            return 0[0m
[30;1m228 | [0m[35m        return hash(json.dumps(service.update_config.as_primitives()))[0m
[30;1m229 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        # Load threads[0m
[30;1m125 | [0m[35m        self.expected_threads = {[0m
[30;1m126 | [0m[35m            'Sync Service Settings': self._sync_settings,[0m
[30;1m127 | [0m[35m            'Outward HTTP Server': self._run_http,[0m
[30;1m128 | [0m[35m            'Run source updates': self._run_source_updates,[0m
[30;1m129 | [0m[35m            'Run local updates': self._run_local_updates,[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mimport tarfile[0m
[30;1m10 | [0m[35mimport tempfile[0m
[30;1m11 | [0m[35mimport threading[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mimport typing[0m
[30;1m14 | [0m[35mfrom io import BytesIO[0m
[30;1m15 | [0m[35mfrom queue import Queue[0m
[30;1m16 | [0m[35mfrom typing import Any, List, Optional, Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m656 | [0m[35m[0m
[30;1m657 | [0m[35m            # With temp directory[0m
[30;1m658 | [0m[35m            self.log.info('Updating local files...')[0m
[30;1m659 | [0m[35m            # Run update function[0m
[30;1m660 | [0m[35m            # noinspection PyBroadException[0m
[30;1m661 | [0m[35m            try:[0m
[30;1m662 | [0m[35m                self.do_local_update()[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m645 | [0m[35m[0m
[30;1m646 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m
[30;1m647 | [0m[35m        while self.running:[0m
[30;1m648 | [0m[35m            # Is it time to update yet?[0m
[30;1m649 | [0m[35m            if not self.local_update_flag.is_set():[0m
[30;1m650 | [0m[35m                self.local_update_flag.wait(60)[0m
[30;1m651 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m643 | [0m[35m            return[0m
[30;1m644 | [0m[35m        self.local_update_start.wait()[0m
[30;1m645 | [0m[35m[0m
[30;1m646 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m
[30;1m647 | [0m[35m        while self.running:[0m
[30;1m648 | [0m[35m            # Is it time to update yet?[0m
[30;1m649 | [0m[35m            if not self.local_update_flag.is_set():[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m596 | [0m[35m            tar_handle.add(new_directory, '/')[0m
[30;1m597 | [0m[35m            tar_handle.close()[0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35m            # swap update directory with old one[0m
[30;1m600 | [0m[35m            self._update_dir, new_directory = new_directory, self._update_dir[0m
[30;1m601 | [0m[35m            self._update_tar, new_tar = new_tar, self._update_tar[0m
[30;1m602 | [0m[35m            self._time_keeper, new_time = new_time, self._time_keeper[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m587 | [0m[35m        open(os.path.join(new_directory, SIGNATURES_META_FILENAME), 'w').write(json.dumps(signature_[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35m        try:[0m
[30;1m590 | [0m[35m            # Tar update directory[0m
[30;1m591 | [0m[35m            new_tar = tempfile.NamedTemporaryFile(prefix="signatures_", dir=UPDATER_DIR, suffix='.ta[0m
[30;1m592 | [0m[35m                                                  delete=False)[0m
[30;1m593 | [0m[35m            new_tar.close()[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m551 | [0m[35m            try:[0m
[30;1m552 | [0m[35m                # Check to see if we have anything queued up for this run[0m
[30;1m553 | [0m[35m                if not self.update_queue.qsize():[0m
[30;1m554 | [0m[35m                    # Queue all sources to update[0m
[30;1m555 | [0m[35m                    for source in self._service.update_config.sources:[0m
[30;1m556 | [0m[35m                        self.update_queue.put(source.name)[0m
[30;1m557 | [0m[35m                self.do_source_update(service=service)[0m
[30;1m558 | [0m[35m                self.set_scheduled_update_time(update_time=time.time())[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m546 | [0m[35m            # With temp directory[0m
[30;1m547 | [0m[35m            self.source_update_flag.clear()[0m
[30;1m548 | [0m[35m            self.log.info('Calling update function...')[0m
[30;1m549 | [0m[35m            # Run update function[0m
[30;1m550 | [0m[35m            # noinspection PyBroadException[0m
[30;1m551 | [0m[35m            try:[0m
[30;1m552 | [0m[35m                # Check to see if we have anything queued up for this run[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m545 | [0m[35m[0m
[30;1m546 | [0m[35m            # With temp directory[0m
[30;1m547 | [0m[35m            self.source_update_flag.clear()[0m
[30;1m548 | [0m[35m            self.log.info('Calling update function...')[0m
[30;1m549 | [0m[35m            # Run update function[0m
[30;1m550 | [0m[35m            # noinspection PyBroadException[0m
[30;1m551 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m534 | [0m[35m            update_interval = min([service.update_config.update_interval_seconds] +[0m
[30;1m535 | [0m[35m                                  [s.update_interval for s in service.update_config.sources if s.upd[0m
[30;1m536 | [0m[35m[0m
[30;1m537 | [0m[35m            # Is it time to update yet?[0m
[30;1m538 | [0m[35m            if time.time() - self.get_scheduled_update_time() < update_interval \[0m
[30;1m539 | [0m[35m                    and not self.source_update_flag.is_set():[0m
[30;1m540 | [0m[35m                self.source_update_flag.wait(60)[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m530 | [0m[35m            # Stringify and hash the the current update configuration[0m
[30;1m531 | [0m[35m            service = self._service[0m
[30;1m532 | [0m[35m[0m
[30;1m533 | [0m[35m            # The update interval (or sleep interval) will be based on the smallest interval across [0m
[30;1m534 | [0m[35m            update_interval = min([service.update_config.update_interval_seconds] +[0m
[30;1m535 | [0m[35m                                  [s.update_interval for s in service.update_config.sources if s.upd[0m
[30;1m536 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m527 | [0m[35m[0m
[30;1m528 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m
[30;1m529 | [0m[35m        while self.running:[0m
[30;1m530 | [0m[35m            # Stringify and hash the the current update configuration[0m
[30;1m531 | [0m[35m            service = self._service[0m
[30;1m532 | [0m[35m[0m
[30;1m533 | [0m[35m            # The update interval (or sleep interval) will be based on the smallest interval across [0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m525 | [0m[35m            self.log.exception('An error occurred loading cached update files. Continuing.')[0m
[30;1m526 | [0m[35m        self.local_update_start.set()[0m
[30;1m527 | [0m[35m[0m
[30;1m528 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m
[30;1m529 | [0m[35m        while self.running:[0m
[30;1m530 | [0m[35m            # Stringify and hash the the current update configuration[0m
[30;1m531 | [0m[35m            service = self._service[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m522 | [0m[35m            self.do_local_update()[0m
[30;1m523 | [0m[35m            self._set_service_stage()[0m
[30;1m524 | [0m[35m        except Exception:[0m
[30;1m525 | [0m[35m            self.log.exception('An error occurred loading cached update files. Continuing.')[0m
[30;1m526 | [0m[35m        self.local_update_start.set()[0m
[30;1m527 | [0m[35m[0m
[30;1m528 | [0m[35m        # Go into a loop running the update whenever triggered or its time to[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m518 | [0m[35m        self.log.info("Service info loaded")[0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m        try:[0m
[30;1m521 | [0m[35m            self.log.info("Checking for in cluster update cache")[0m
[30;1m522 | [0m[35m            self.do_local_update()[0m
[30;1m523 | [0m[35m            self._set_service_stage()[0m
[30;1m524 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m498 | [0m[35m    def is_valid(self, file_path) -> bool:[0m
[30;1m499 | [0m[35m        return True[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m    # Define how your source update gets imported into Assemblyline[0m
[30;1m502 | [0m[35m    def import_update(self, files_sha256: List[Tuple[str, str]], source_name: str, default_classific[0m
[30;1m503 | [0m[35m                      configuration: dict = {}, *args, **kwargs):[0m
[30;1m504 | [0m[35m        raise NotImplementedError()[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m448 | [0m[35m                                    raise FileNotFoundError(f"{output} doesn't exist within containe[0m
[30;1m449 | [0m[35m                            elif fetch_method == "GIT" or uri.endswith('.git'):[0m
[30;1m450 | [0m[35m                                # First we'll attempt by performing a Git clone[0m
[30;1m451 | [0m[35m                                # (since not all services hint at being a repository in their URL),[0m
[30;1m452 | [0m[35m                                output = git_clone_repo(source, old_update_time, self.log, update_di[0m
[30;1m453 | [0m[35m                            else:[0m
[30;1m454 | [0m[35m                                # Other fetch methods are meant for URL downloads using Requests[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m442 | [0m[35m                            self.log.info(f"Fetching {source_name} using {fetch_method}")[0m
[30;1m443 | [0m[35m                            # Pull sources from external locations[0m
[30;1m444 | [0m[35m                            if uri.startswith("file:///"):[0m
[30;1m445 | [0m[35m                                # Perform an update using a local mount[0m
[30;1m446 | [0m[35m                                output = uri.split("file://", 1)[1][0m
[30;1m447 | [0m[35m                                if not os.path.exists(output):[0m
[30;1m448 | [0m[35m                                    raise FileNotFoundError(f"{output} doesn't exist within containe[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m410 | [0m[35m                        elapsed_time = time.time() - old_update_time[0m
[30;1m411 | [0m[35m                        update_interval = source.get('update_interval') or service.update_config.upd[0m
[30;1m412 | [0m[35m                        if elapsed_time < update_interval:[0m
[30;1m413 | [0m[35m                            # Too early to run the update for this particular source, skip for now[0m
[30;1m414 | [0m[35m                            raise SkipSource[0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m349 | [0m[35m                                                       sig_type=self.updater_type):[0m
[30;1m350 | [0m[35m                self.log.info("An update is available for download from the datastore")[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m                self.log.debug(f"{self.updater_type} update available since {epoch_to_iso(old_update[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m                with ZipFile(BytesIO(self.client.signature.download(self.signatures_query)), 'r') as[0m
[30;1m355 | [0m[35m                    zip_f.extractall(output_directory)[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m347 | [0m[35m            if sources_removed_locally or \[0m
[30;1m348 | [0m[35m                self.client.signature.update_available(since=epoch_to_iso(old_update_time) or None,[0m
[30;1m349 | [0m[35m                                                       sig_type=self.updater_type):[0m
[30;1m350 | [0m[35m                self.log.info("An update is available for download from the datastore")[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m                self.log.debug(f"{self.updater_type} update available since {epoch_to_iso(old_update[0m
[30;1m353 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m299 | [0m[35m                remove_source = None[0m
[30;1m300 | [0m[35m                for source in missing_sources:[0m
[30;1m301 | [0m[35m                    if source in path:[0m
[30;1m302 | [0m[35m                        # We have at least one source we can pass to the service for now[0m
[30;1m303 | [0m[35m                        remove_source = source[0m
[30;1m304 | [0m[35m                        check_passed = True[0m
[30;1m305 | [0m[35m                        break[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m294 | [0m[35m        if not self._update_dir:[0m
[30;1m295 | [0m[35m            return check_passed[0m
[30;1m296 | [0m[35m        for _, dirs, files in os.walk(self._update_dir):[0m
[30;1m297 | [0m[35m            # Walk through update directory (account for sources being nested)[0m
[30;1m298 | [0m[35m            for path in dirs + files:[0m
[30;1m299 | [0m[35m                remove_source = None[0m
[30;1m300 | [0m[35m                for source in missing_sources:[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m262 | [0m[35m        self.client.signature.classification_replace_map = \[0m
[30;1m263 | [0m[35m            self._service.config.get('updater', {}).get('classification_replace', {})[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        # If the update configuration for the service has changed, trigger an update[0m
[30;1m266 | [0m[35m        if self.config_hash(self._service) != self.get_active_config_hash():[0m
[30;1m267 | [0m[35m            self.source_update_flag.set()[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    def push_status(self, state: str, message: str):[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m262 | [0m[35m        self.client.signature.classification_replace_map = \[0m
[30;1m263 | [0m[35m            self._service.config.get('updater', {}).get('classification_replace', {})[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        # If the update configuration for the service has changed, trigger an update[0m
[30;1m266 | [0m[35m        if self.config_hash(self._service) != self.get_active_config_hash():[0m
[30;1m267 | [0m[35m            self.source_update_flag.set()[0m
[30;1m268 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m        if not self.default_pattern:[0m
[30;1m259 | [0m[35m            self.default_pattern = self._service.update_config.default_pattern[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        # Update signature client with any changes to classification rewrites[0m
[30;1m262 | [0m[35m        self.client.signature.classification_replace_map = \[0m
[30;1m263 | [0m[35m            self._service.config.get('updater', {}).get('classification_replace', {})[0m
[30;1m264 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m246 | [0m[35m            self._pull_settings()[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m    def _sync_settings(self):[0m
[30;1m249 | [0m[35m        # Pull settings at startup and periodically thereafter[0m
[30;1m250 | [0m[35m        while not self._service or self.sleep(SERVICE_PULL_INTERVAL):[0m
[30;1m251 | [0m[35m            self._pull_settings()[0m
[30;1m252 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m230 | [0m[35m    def _handle_source_update_event(self, data: Optional[list[str]]):[0m
[30;1m231 | [0m[35m        if data is not None:[0m
[30;1m232 | [0m[35m            # Received an event regarding a change to source[0m
[30;1m233 | [0m[35m            self.log.info(f'Queued to update the following: {data}')[0m
[30;1m234 | [0m[35m            for d in data:[0m
[30;1m235 | [0m[35m                self.update_queue.put(d)[0m
[30;1m236 | [0m[35m        self.trigger_update()[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m191 | [0m[35m    def stop(self):[0m
[30;1m192 | [0m[35m        current_source_state = self.update_data_hash.get(f"{self._current_source}.{SOURCE_STATUS_KEY[0m
[30;1m193 | [0m[35m        if current_source_state.get("state") == "UPDATING":[0m
[30;1m194 | [0m[35m            # Declare the update has failed and will retry again on next boot[0m
[30;1m195 | [0m[35m            self.push_status("ERROR", "Update interrupted by server shutdown")[0m
[30;1m196 | [0m[35m        super().stop()[0m
[30;1m197 | [0m[35m        self.signature_change_watcher.stop()[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/updater/updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m        self.source_update_watcher.register(f'changes.sources.{SERVICE_NAME.lower()}',[0m
[30;1m114 | [0m[35m                                            self._handle_source_update_event)[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m        # A event flag that gets set when an update should be run for[0m
[30;1m117 | [0m[35m        # reasons other than it being the regular interval (eg, change in signatures)[0m
[30;1m118 | [0m[35m        self.source_update_flag = threading.Event()[0m
[30;1m119 | [0m[35m        self.local_update_flag = threading.Event()[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m                terms = list(set(terms).union(included_terms) - excluded_terms)[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m            # Set the indicator hit threshold[0m
[30;1m193 | [0m[35m            hit_threshold = indicator_config.get("threshold", 1)[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m        # Overwrite key-value in respective constants[0m
[30;1m196 | [0m[35m        OCR_INDICATORS_TERMS[indicator] = terms[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m                terms = indicator_config["terms"][0m
[30;1m186 | [0m[35m            else:[0m
[30;1m187 | [0m[35m                included_terms = set(indicator_config.get("include", []))[0m
[30;1m188 | [0m[35m                excluded_terms = set(indicator_config.get("exclude", []))[0m
[30;1m189 | [0m[35m                # Compute the new terms list for indicator type[0m
[30;1m190 | [0m[35m                terms = list(set(terms).union(included_terms) - excluded_terms)[0m
[30;1m191 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m                # Overwrite terms list with service configuration[0m
[30;1m185 | [0m[35m                terms = indicator_config["terms"][0m
[30;1m186 | [0m[35m            else:[0m
[30;1m187 | [0m[35m                included_terms = set(indicator_config.get("include", []))[0m
[30;1m188 | [0m[35m                excluded_terms = set(indicator_config.get("exclude", []))[0m
[30;1m189 | [0m[35m                # Compute the new terms list for indicator type[0m
[30;1m190 | [0m[35m                terms = list(set(terms).union(included_terms) - excluded_terms)[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m            terms = indicator_config[0m
[30;1m181 | [0m[35m        elif isinstance(indicator_config, dict):[0m
[30;1m182 | [0m[35m            # Either you're exclusively overwriting the terms list or you're selectively including/e[0m
[30;1m183 | [0m[35m            if indicator_config.get("terms"):[0m
[30;1m184 | [0m[35m                # Overwrite terms list with service configuration[0m
[30;1m185 | [0m[35m                terms = indicator_config["terms"][0m
[30;1m186 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m    for indicator in indicators:[0m
[30;1m171 | [0m[35m        indicator_config = ocr_config.get(indicator)[0m
[30;1m172 | [0m[35m        terms = OCR_INDICATORS_TERMS.get(indicator, [])[0m
[30;1m173 | [0m[35m        hit_threshold = OCR_INDICATORS_THRESHOLD.get(indicator, 1)[0m
[30;1m174 | [0m[35m        # Backwards compatibility: Check how the OCR configuration is formatted[0m
[30;1m175 | [0m[35m        if not indicator_config:[0m
[30;1m176 | [0m[35m            # Empty block/no override provided by service[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m    # Iterate over the different indicators and include lines of detection in response[0m
[30;1m170 | [0m[35m    for indicator in indicators:[0m
[30;1m171 | [0m[35m        indicator_config = ocr_config.get(indicator)[0m
[30;1m172 | [0m[35m        terms = OCR_INDICATORS_TERMS.get(indicator, [])[0m
[30;1m173 | [0m[35m        hit_threshold = OCR_INDICATORS_THRESHOLD.get(indicator, 1)[0m
[30;1m174 | [0m[35m        # Backwards compatibility: Check how the OCR configuration is formatted[0m
[30;1m175 | [0m[35m        if not indicator_config:[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m    indicators = set(list(OCR_INDICATORS_TERMS.keys()) + list(ocr_config.keys()))[0m
[30;1m169 | [0m[35m    # Iterate over the different indicators and include lines of detection in response[0m
[30;1m170 | [0m[35m    for indicator in indicators:[0m
[30;1m171 | [0m[35m        indicator_config = ocr_config.get(indicator)[0m
[30;1m172 | [0m[35m        terms = OCR_INDICATORS_TERMS.get(indicator, [])[0m
[30;1m173 | [0m[35m        hit_threshold = OCR_INDICATORS_THRESHOLD.get(indicator, 1)[0m
[30;1m174 | [0m[35m        # Backwards compatibility: Check how the OCR configuration is formatted[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m    if not ocr_config:[0m
[30;1m161 | [0m[35m        try:[0m
[30;1m162 | [0m[35m            # Retrieve service-configured OCR settings on module load (primary used in testing)[0m
[30;1m163 | [0m[35m            ocr_config: Dict = get_service_manifest().get("config", {}).get("ocr", {})[0m
[30;1m164 | [0m[35m        except Exception:[0m
[30;1m165 | [0m[35m            # No configuration updates provided[0m
[30;1m166 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m    if not ocr_config:[0m
[30;1m161 | [0m[35m        try:[0m
[30;1m162 | [0m[35m            # Retrieve service-configured OCR settings on module load (primary used in testing)[0m
[30;1m163 | [0m[35m            ocr_config: Dict = get_service_manifest().get("config", {}).get("ocr", {})[0m
[30;1m164 | [0m[35m        except Exception:[0m
[30;1m165 | [0m[35m            # No configuration updates provided[0m
[30;1m166 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m246 | [0m[35m                        list_of_strings.append(line)[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m        if list_of_strings and len(indicator_hits) >= hit_threshold:[0m
[30;1m249 | [0m[35m            # If we were to find hits and those hits are above the required threshold, then add them[0m
[30;1m250 | [0m[35m            detection_output[indicator] = list_of_strings[0m
[30;1m251 | [0m[35m    return detection_output[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m        elif isinstance(indicator_config, dict):[0m
[30;1m182 | [0m[35m            # Either you're exclusively overwriting the terms list or you're selectively including/e[0m
[30;1m183 | [0m[35m            if indicator_config.get("terms"):[0m
[30;1m184 | [0m[35m                # Overwrite terms list with service configuration[0m
[30;1m185 | [0m[35m                terms = indicator_config["terms"][0m
[30;1m186 | [0m[35m            else:[0m
[30;1m187 | [0m[35m                included_terms = set(indicator_config.get("include", []))[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ocr.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m        hit_threshold = OCR_INDICATORS_THRESHOLD.get(indicator, 1)[0m
[30;1m174 | [0m[35m        # Backwards compatibility: Check how the OCR configuration is formatted[0m
[30;1m175 | [0m[35m        if not indicator_config:[0m
[30;1m176 | [0m[35m            # Empty block/no override provided by service[0m
[30;1m177 | [0m[35m            pass[0m
[30;1m178 | [0m[35m        elif isinstance(indicator_config, list):[0m
[30;1m179 | [0m[35m            # Legacy support (before configurable indicator thresholds)[0m
[30;1m180 | [0m[35m            terms = indicator_config[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m    @property[0m
[30;1m332 | [0m[35m    def working_directory(self) -> str:[0m
[30;1m333 | [0m[35m        temp_dir = os.path.join(os.environ.get('TASKING_DIR', tempfile.gettempdir()), 'working_direc[0m
[30;1m334 | [0m[35m        if not os.path.isdir(temp_dir):[0m
[30;1m335 | [0m[35m            os.makedirs(temp_dir)[0m
[30;1m336 | [0m[35m        if self._working_directory is None:[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m        self.save_result()[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m    def validate_file(self) -> str:[0m
[30;1m320 | [0m[35m        file_path = os.path.join(os.environ.get('TASKING_DIR', tempfile.gettempdir()), self.sha256)[0m
[30;1m321 | [0m[35m        if not os.path.exists(file_path):[0m
[30;1m322 | [0m[35m            raise Exception("File download failed. File not found on local filesystem.")[0m
[30;1m323 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m    def save_result(self) -> None:[0m
[30;1m293 | [0m[35m        result = self.get_service_result()[0m
[30;1m294 | [0m[35m        result_path = os.path.join([0m
[30;1m295 | [0m[35m            os.environ.get('TASKING_DIR', tempfile.gettempdir()),[0m
[30;1m296 | [0m[35m            f'{self.sid}_{self.sha256}_result.json')[0m
[30;1m297 | [0m[35m        with open(result_path, 'w') as f:[0m
[30;1m298 | [0m[35m            json.dump(result, f, default=str)[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        error = self.get_service_error()[0m
[30;1m285 | [0m[35m        error_path = os.path.join([0m
[30;1m286 | [0m[35m            os.environ.get('TASKING_DIR', tempfile.gettempdir()),[0m
[30;1m287 | [0m[35m            f'{self.sid}_{self.sha256}_error.json')[0m
[30;1m288 | [0m[35m        with open(error_path, 'w') as f:[0m
[30;1m289 | [0m[35m            json.dump(error, f, default=str)[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        else:[0m
[30;1m210 | [0m[35m            # Check service manifest commited to disk and use param's default, if it exists.[0m
[30;1m211 | [0m[35m            for s_param in get_service_manifest().get('config', {}).get('submission_params', []):[0m
[30;1m212 | [0m[35m                if s_param.get('name') == name:[0m
[30;1m213 | [0m[35m                    return s_param['default'][0m
[30;1m214 | [0m[35m            raise Exception(f"Service submission parameter not found: {name}")[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m            return param[0m
[30;1m209 | [0m[35m        else:[0m
[30;1m210 | [0m[35m            # Check service manifest commited to disk and use param's default, if it exists.[0m
[30;1m211 | [0m[35m            for s_param in get_service_manifest().get('config', {}).get('submission_params', []):[0m
[30;1m212 | [0m[35m                if s_param.get('name') == name:[0m
[30;1m213 | [0m[35m                    return s_param['default'][0m
[30;1m214 | [0m[35m            raise Exception(f"Service submission parameter not found: {name}")[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m            return param[0m
[30;1m209 | [0m[35m        else:[0m
[30;1m210 | [0m[35m            # Check service manifest commited to disk and use param's default, if it exists.[0m
[30;1m211 | [0m[35m            for s_param in get_service_manifest().get('config', {}).get('submission_params', []):[0m
[30;1m212 | [0m[35m                if s_param.get('name') == name:[0m
[30;1m213 | [0m[35m                    return s_param['default'][0m
[30;1m214 | [0m[35m            raise Exception(f"Service submission parameter not found: {name}")[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m        self.drop_file = True[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    def get_param(self, name: str) -> Any:[0m
[30;1m206 | [0m[35m        param = self.service_config.get(name, None)[0m
[30;1m207 | [0m[35m        if param is not None:[0m
[30;1m208 | [0m[35m            return param[0m
[30;1m209 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m133 | [0m[35mtion] = None,[0m
[30;1m134 | [0m[35m                      safelist_interface: Optional[Union[ServiceAPI, PrivilegedServiceAPI]] = None,[0m
[30;1m135 | [0m[35m                      allow_dynamic_recursion: bool = False, parent_relation: str = PARENT_RELATION.[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        # Service-based safelisting of files has to be configured at the global configuration[0m
[30;1m138 | [0m[35m        # Allows the administrator to be selective about the types of hashes to lookup in the safeli[0m
[30;1m139 | [0m[35m        if safelist_interface and self.safelist_config.enabled and not (self.deep_scan or self.ignor[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m        if param is not None:[0m
[30;1m208 | [0m[35m            return param[0m
[30;1m209 | [0m[35m        else:[0m
[30;1m210 | [0m[35m            # Check service manifest commited to disk and use param's default, if it exists.[0m
[30;1m211 | [0m[35m            for s_param in get_service_manifest().get('config', {}).get('submission_params', []):[0m
[30;1m212 | [0m[35m                if s_param.get('name') == name:[0m
[30;1m213 | [0m[35m                    return s_param['default'][0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mTEMP_SERVICE_CONFIG_PATH ="/tmp/service_manifest.yml"[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mret = subprocess.run("dpkg -l | grep ^ii | awk '{print $2}' | grep -i 'tesseract'", capture_output=T[0m
[30;1m9 | [0m[35mTESSERACT_LIST = list(filter(None, ret.stdout.decode().split('\n')))[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mTEMP_SERVICE_CONFIG_PATH ="/tmp/service_manifest.yml"[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mret = subprocess.run("dpkg -l | grep ^ii | awk '{print $2}' | grep -i 'tesseract'", capture_output=T[0m
[30;1m9 | [0m[35mTESSERACT_LIST = list(filter(None, ret.stdout.decode().split('\n')))[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mTEMP_SERVICE_CONFIG_PATH ="/tmp/service_manifest.yml"[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mret = subprocess.run("dpkg -l | grep ^ii | awk '{print $2}' | grep -i 'tesseract'", capture_output=T[0m
[30;1m9 | [0m[35mTESSERACT_LIST = list(filter(None, ret.stdout.decode().split('\n')))[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m            sa._with_retries(sa.session.get, url)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        # Status code of 400 and the required keys[0m
[30;1m94 | [0m[35m        m.get(url, status_code=400, json={"api_error_message": "blah",[0m
[30;1m95 | [0m[35m              "api_server_version": "blah", "api_response": "blah"})[0m
[30;1m96 | [0m[35m        with pytest.raises(ServiceAPIError):[0m
[30;1m97 | [0m[35m            sa._with_retries(sa.session.get, url)[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        assert sa._with_retries(sa.session.get, url) == "blah"[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        # Status code of 400 and no "api_error_message" key[0m
[30;1m89 | [0m[35m        m.get(url, status_code=400, json={})[0m
[30;1m90 | [0m[35m        with pytest.raises(ServiceAPIError):[0m
[30;1m91 | [0m[35m            sa._with_retries(sa.session.get, url)[0m
[30;1m92 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        assert p1.exitcode is None[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        # Status code of 200[0m
[30;1m85 | [0m[35m        m.get(url, status_code=200, json={"api_response": "blah"})[0m
[30;1m86 | [0m[35m        assert sa._with_retries(sa.session.get, url) == "blah"[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        # Status code of 400 and no "api_error_message" key[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        assert p1.exitcode is None[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m        # Timeout[0m
[30;1m76 | [0m[35m        m.get(url, exc=Timeout)[0m
[30;1m77 | [0m[35m        p1 = Process(target=sa._with_retries, args=(sa.session.get, url),[0m
[30;1m78 | [0m[35m                     name="_with_retries with exception ConnectionError")[0m
[30;1m79 | [0m[35m        p1.start()[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        url = f"{sa.service_api_host}/api/v1/blah/"[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        # ConnectionError[0m
[30;1m67 | [0m[35m        m.get(url, exc=ConnectionError)[0m
[30;1m68 | [0m[35m        p1 = Process(target=sa._with_retries, args=(sa.session.get, url),[0m
[30;1m69 | [0m[35m                     name="_with_retries with exception ConnectionError")[0m
[30;1m70 | [0m[35m        p1.start()[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        p1.terminate()[0m
[30;1m73 | [0m[35m        assert p1.exitcode is None[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m        # Timeout[0m
[30;1m76 | [0m[35m        m.get(url, exc=Timeout)[0m
[30;1m77 | [0m[35m        p1 = Process(target=sa._with_retries, args=(sa.session.get, url),[0m
[30;1m78 | [0m[35m                     name="_with_retries with exception ConnectionError")[0m
[30;1m79 | [0m[35m        p1.start()[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom assemblyline.common.version import FRAMEWORK_VERSION, SYSTEM_VERSION[0m
[30;1m8 | [0m[35mfrom assemblyline_v4_service.common import helper[0m
[30;1m9 | [0m[35mfrom assemblyline_v4_service.common.api import *[0m
[30;1m10 | [0m[35mfrom requests import ConnectionError, Session, Timeout[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mdef test_development_mode():[0m
[30;1m14 | [0m[35m    assert DEVELOPMENT_MODE is True[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1195 | [0m[35m    assert rjs.update_json({"a": "b"}) is None[0m
[30;1m1196 | [0m[35m    assert rjs.section_body._data == {"a": "b"}[0m
[30;1m1197 | [0m[35m[0m
[30;1m1198 | [0m[35m    # Update[0m
[30;1m1199 | [0m[35m    assert rjs.update_json({"b": "c"}) is None[0m
[30;1m1200 | [0m[35m    assert rjs.section_body._data == {"a": "b", "b": "c"}[0m
[30;1m1201 | [0m[35m[0m
[30;1m1202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m395 | [0m[35m    assert jsb.update_json({"a": "b"}) is None[0m
[30;1m396 | [0m[35m    assert jsb._data == {"a": "b"}[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35m    # Update[0m
[30;1m399 | [0m[35m    assert jsb.update_json({"b": "c"}) is None[0m
[30;1m400 | [0m[35m    assert jsb._data == {"a": "b", "b": "c"}[0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1447 | [0m[35m    assert r.add_section(rs2) is None[0m
[30;1m1448 | [0m[35m    assert r.sections == [rs1, rs2][0m
[30;1m1449 | [0m[35m[0m
[30;1m1450 | [0m[35m    # Add section to top[0m
[30;1m1451 | [0m[35m    rs3 = ResultSection("section")[0m
[30;1m1452 | [0m[35m    assert r.add_section(rs3, on_top=True) is None[0m
[30;1m1453 | [0m[35m    assert r.sections == [rs3, rs1, rs2][0m
[30;1m1454 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1424 | [0m[35m    assert r._flatten_sections(rs) is None[0m
[30;1m1425 | [0m[35m    assert len(r._flattened_sections) == 2[0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m    # Flatten another ResultSection as not root. Because of this, we expect some weird behaviour[0m
[30;1m1428 | [0m[35m    # Note, we have four result sections. The first two are the same as above, expected. The next tw[0m
[30;1m1429 | [0m[35m    # are the first subsection and the second subsection. This is because since "root=False", the[0m
[30;1m1430 | [0m[35m    # main result section is not added, only the subsections are.[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1326 | [0m[35m              'YOUR COMPUTER. THE PRICE OF THE SOFTWARE IS $.2..%.. ' \[0m
[30;1m1327 | [0m[35m                                                             'PAYMENT CAN BE MADE IN BITCOIN OR XMR.[0m
[30;1m1328 | [0m[35m                                                             'WHERE DO | GET BITCOIN OR XMR?", "YOUR[0m
[30;1m1329 | [0m[35m                                                             'HOW TO BUY BITCOIN OR XMR.", "PAYMENT [0m
[30;1m1330 | [0m[35m                                                             'SEND $15, TO ONE OF OUR CRYPTO ADDRESS[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1276 | [0m[35m    assert ris.section_body._request == service_request[0m
[30;1m1277 | [0m[35m[0m
[30;1m1278 | [0m[35m[0m
[30;1m1279 | [0m[35m@pytest.mark.skipif(len(TESSERACT_LIST) < 1, reason="Requires tesseract-ocr apt package")[0m
[30;1m1280 | [0m[35mdef test_resultimagesection_add_image(service_request):[0m
[30;1m1281 | [0m[35m    ris = ResultImageSection(service_request, "title_text_as_str")[0m
[30;1m1282 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m854 | [0m[35m    assert rs.subsections == [ss1, ss2][0m
[30;1m855 | [0m[35m    assert ss2.parent == rs[0m
[30;1m856 | [0m[35m[0m
[30;1m857 | [0m[35m    # Add subsection to top[0m
[30;1m858 | [0m[35m    ss3 = ResultSection("subsection")[0m
[30;1m859 | [0m[35m    assert rs.add_subsection(ss3, on_top=True) is None[0m
[30;1m860 | [0m[35m    assert rs.subsections == [ss3, ss1, ss2][0m
[30;1m861 | [0m[35m    assert ss3.parent == rs[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m628 | [0m[35mARE FROM YOUR ' \[0m
[30;1m629 | [0m[35m                                         'COMPUTER. THE PRICE OF THE SOFTWARE IS $.2..%.. PAYMENT CA[0m
[30;1m630 | [0m[35m                                         'BITCOIN OR XMR.", "How 00! PAY, WHERE DO | GET BITCOIN OR [0m
[30;1m631 | [0m[35m                                         'TO FIND OUT HOW TO BUY BITCOIN OR XMR.", "PAYMENT INFORMAT[0m
[30;1m632 | [0m[35m                                         'TO ONE OF OUR CRYPTO ADDRESSES, THEN SEND US EMAIL WITH PA[0m
[30;1m633 | [0m[35m                                         '"CONFIRMATION AND YOU\'LL GET THE DECRYPTION SOFTWARE IN E[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m597 | [0m[35m    assert isb._data == [][0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35m[0m
[30;1m600 | [0m[35m@pytest.mark.skipif(len(TESSERACT_LIST) < 1, reason="Requires tesseract-ocr apt package")[0m
[30;1m601 | [0m[35mdef test_imagesectionbody_add_image(service_request):[0m
[30;1m602 | [0m[35m    isb = ImageSectionBody(service_request)[0m
[30;1m603 | [0m[35m    image_path = os.path.join([0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_result.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mimport tempfile[0m
[30;1m15 | [0m[35mfrom test.test_common import TESSERACT_LIST, setup_module[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m# Ensure service manifest is instantiated before importing from OCR submodule[0m
[30;1m18 | [0m[35msetup_module()[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m        old_rules_list = self.rules_list[0m
[30;1m293 | [0m[35m        try:[0m
[30;1m294 | [0m[35m            with os.fdopen(buffer_handle, 'wb') as buffer:[0m
[30;1m295 | [0m[35m                resp = requests.get(url_base + 'tar', headers=headers, verify=verify)[0m
[30;1m296 | [0m[35m                resp.raise_for_status()[0m
[30;1m297 | [0m[35m                for chunk in resp.iter_content(chunk_size=1024):[0m
[30;1m298 | [0m[35m                    buffer.write(chunk)[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m        # Check if there are new signatures[0m
[30;1m268 | [0m[35m        retries = 0[0m
[30;1m269 | [0m[35m        while True:[0m
[30;1m270 | [0m[35m            resp = requests.get(url_base + 'status', verify=verify)[0m
[30;1m271 | [0m[35m            resp.raise_for_status()[0m
[30;1m272 | [0m[35m            status = resp.json()[0m
[30;1m273 | [0m[35m            if self.update_time is not None and self.update_time >= status['local_update_time'] and [0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m                self._working_directory = self._task.working_directory[0m
[30;1m242 | [0m[35m            else:[0m
[30;1m243 | [0m[35m                # Or create a new working directory[0m
[30;1m244 | [0m[35m                temp_dir = os.path.join(os.environ.get('TASKING_DIR', tempfile.gettempdir()), 'worki[0m
[30;1m245 | [0m[35m                if not os.path.isdir(temp_dir):[0m
[30;1m246 | [0m[35m                    os.makedirs(temp_dir)[0m
[30;1m247 | [0m[35m                self._working_directory = tempfile.mkdtemp(dir=temp_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m    def start_service(self) -> None:[0m
[30;1m203 | [0m[35m        self.log.info(f"Starting service: {self.service_attributes.name} ({self.service_attributes.v[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m        if self.dependencies.get('updates', None):[0m
[30;1m206 | [0m[35m            # Start with a clean update dir[0m
[30;1m207 | [0m[35m            if os.path.exists(UPDATES_DIR):[0m
[30;1m208 | [0m[35m                for files in os.scandir(UPDATES_DIR):[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m    def _cleanup(self) -> None:[0m
[30;1m106 | [0m[35m        self._task = None[0m
[30;1m107 | [0m[35m        self._working_directory = None[0m
[30;1m108 | [0m[35m        if self.dependencies.get('updates', None):[0m
[30;1m109 | [0m[35m            try:[0m
[30;1m110 | [0m[35m                self._download_rules()[0m
[30;1m111 | [0m[35m            except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        self.signatures_meta: dict = {}[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        # OCR-related[0m
[30;1m88 | [0m[35m        if self.config.get('ocr'):[0m
[30;1m89 | [0m[35m            update_ocr_config(self.config['ocr'])[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35mUPDATES_DIR = os.environ.get('UPDATES_DIR', '/updates')[0m
[30;1m30 | [0m[35mUPDATES_CA = os.environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m31 | [0m[35mPRIVILEGED = os.environ.get('PRIVILEGED', 'false') == 'true'[0m
[30;1m32 | [0m[35mMIN_SECONDS_BETWEEN_UPDATES = float(os.environ.get('MIN_SECONDS_BETWEEN_UPDATES', '10.0'))[0m
[30;1m33 | [0m[35mSIGNATURES_META_FILENAME = "signatures_meta.json"[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mRECOVERABLE_RE_MSG = [[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mUPDATES_DIR = os.environ.get('UPDATES_DIR', '/updates')[0m
[30;1m30 | [0m[35mUPDATES_CA = os.environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m31 | [0m[35mPRIVILEGED = os.environ.get('PRIVILEGED', 'false') == 'true'[0m
[30;1m32 | [0m[35mMIN_SECONDS_BETWEEN_UPDATES = float(os.environ.get('MIN_SECONDS_BETWEEN_UPDATES', '10.0'))[0m
[30;1m33 | [0m[35mSIGNATURES_META_FILENAME = "signatures_meta.json"[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35mwarnings.filterwarnings("ignore")[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mUPDATES_DIR = os.environ.get('UPDATES_DIR', '/updates')[0m
[30;1m30 | [0m[35mUPDATES_CA = os.environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m31 | [0m[35mPRIVILEGED = os.environ.get('PRIVILEGED', 'false') == 'true'[0m
[30;1m32 | [0m[35mMIN_SECONDS_BETWEEN_UPDATES = float(os.environ.get('MIN_SECONDS_BETWEEN_UPDATES', '10.0'))[0m
[30;1m33 | [0m[35mSIGNATURES_META_FILENAME = "signatures_meta.json"[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m# Ignore all other warnings that a service's libraries can generate[0m
[30;1m27 | [0m[35mwarnings.filterwarnings("ignore")[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mUPDATES_DIR = os.environ.get('UPDATES_DIR', '/updates')[0m
[30;1m30 | [0m[35mUPDATES_CA = os.environ.get('UPDATES_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m31 | [0m[35mPRIVILEGED = os.environ.get('PRIVILEGED', 'false') == 'true'[0m
[30;1m32 | [0m[35mMIN_SECONDS_BETWEEN_UPDATES = float(os.environ.get('MIN_SECONDS_BETWEEN_UPDATES', '10.0'))[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m285 | [0m[35m        if not os.path.exists(UPDATES_DIR):[0m
[30;1m286 | [0m[35m            os.mkdir(UPDATES_DIR)[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m        # Download the current update[0m
[30;1m289 | [0m[35m        temp_directory = tempfile.mkdtemp(dir=UPDATES_DIR)[0m
[30;1m290 | [0m[35m        buffer_handle, buffer_name = tempfile.mkstemp()[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m        old_rules_list = self.rules_list[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m277 | [0m[35m            if status['download_available']:[0m
[30;1m278 | [0m[35m                self.log.info("A signature update is available, downloading new signatures...")[0m
[30;1m279 | [0m[35m                break[0m
[30;1m280 | [0m[35m            self.log.warning('Waiting on update server availability...')[0m
[30;1m281 | [0m[35m            time.sleep(min(5**retries, 30))[0m
[30;1m282 | [0m[35m            retries += 1[0m
[30;1m283 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m275 | [0m[35m                self.log.info(f"There are no new signatures. ({self.update_time} >= {status['local_u[0m
[30;1m276 | [0m[35m                return[0m
[30;1m277 | [0m[35m            if status['download_available']:[0m
[30;1m278 | [0m[35m                self.log.info("A signature update is available, downloading new signatures...")[0m
[30;1m279 | [0m[35m                break[0m
[30;1m280 | [0m[35m            self.log.warning('Waiting on update server availability...')[0m
[30;1m281 | [0m[35m            time.sleep(min(5**retries, 30))[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m255 | [0m[35m            return[0m
[30;1m256 | [0m[35m        self.update_check_time = time.time()[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m        # Resolve the update target[0m
[30;1m259 | [0m[35m        scheme, verify = 'http', None[0m
[30;1m260 | [0m[35m        if os.path.exists(UPDATES_CA):[0m
[30;1m261 | [0m[35m            scheme, verify = 'https', UPDATES_CA[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m    def stop(self) -> None:[0m
[30;1m223 | [0m[35m        """[0m
[30;1m224 | [0m[35m        Called at worker stop.[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m        :return:[0m
[30;1m227 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m203 | [0m[35m        self.log.info(f"Starting service: {self.service_attributes.name} ({self.service_attributes.v[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m        if self.dependencies.get('updates', None):[0m
[30;1m206 | [0m[35m            # Start with a clean update dir[0m
[30;1m207 | [0m[35m            if os.path.exists(UPDATES_DIR):[0m
[30;1m208 | [0m[35m                for files in os.scandir(UPDATES_DIR):[0m
[30;1m209 | [0m[35m                    path = os.path.join(UPDATES_DIR, files)[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    def start(self) -> None:[0m
[30;1m195 | [0m[35m        """[0m
[30;1m196 | [0m[35m        Called at worker start.[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m        :return:[0m
[30;1m199 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m340 | [0m[35m    def _clear_rules(self) -> None:[0m
[30;1m341 | [0m[35m        pass[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m    # Use the rules_list to setup rules-use for the service[0m
[30;1m344 | [0m[35m    def _load_rules(self) -> None:[0m
[30;1m345 | [0m[35m        raise NotImplementedError[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m            self.update_time = status['local_update_time'][0m
[30;1m303 | [0m[35m            self.update_hash = status['local_update_hash'][0m
[30;1m304 | [0m[35m            self.rules_directory, temp_directory = temp_directory, self.rules_directory[0m
[30;1m305 | [0m[35m            # Try to load the rules into the service before declaring we're using these rules moving[0m
[30;1m306 | [0m[35m            temp_hash = self._gen_rules_hash()[0m
[30;1m307 | [0m[35m            self._clear_rules()[0m
[30;1m308 | [0m[35m            self._load_rules()[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m                          f"({self._task.sid}/{self._task.sha256}) {exception}: {stack_info}")[0m
[30;1m125 | [0m[35m            self._task.save_error(stack_info, recoverable=True)[0m
[30;1m126 | [0m[35m        else:[0m
[30;1m127 | [0m[35m            self.log.error(f"Nonrecoverable Service Error "[0m
[30;1m128 | [0m[35m                           f"({self._task.sid}/{self._task.sha256}) {exception}: {stack_info}")[0m
[30;1m129 | [0m[35m            self._task.save_error(stack_info, recoverable=False)[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m        self._task.clear_supplementary()[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        if isinstance(exception, exceptions.RecoverableError):[0m
[30;1m123 | [0m[35m            self.log.info(f"Recoverable Service Error "[0m
[30;1m124 | [0m[35m                          f"({self._task.sid}/{self._task.sha256}) {exception}: {stack_info}")[0m
[30;1m125 | [0m[35m            self._task.save_error(stack_info, recoverable=True)[0m
[30;1m126 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m            self.config.update(config)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        self.name = self.service_attributes.name.lower()[0m
[30;1m57 | [0m[35m        # Initialize logging for the service[0m
[30;1m58 | [0m[35m        log.init_logging(f'{self.service_attributes.name}')[0m
[30;1m59 | [0m[35m        self.log = logging.getLogger(f'assemblyline.service.{self.name}')[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        # Replace warning/error methods with our own patched version[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m        # Load the service attributes from the service manifest[0m
[30;1m49 | [0m[35m        self.service_attributes = helper.get_service_attributes()[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        # Start with default service parameters and override with anything provided[0m
[30;1m52 | [0m[35m        self.config = self.service_attributes.config[0m
[30;1m53 | [0m[35m        if config:[0m
[30;1m54 | [0m[35m            self.config.update(config)[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mclass ServiceBase:[0m
[30;1m47 | [0m[35m    def __init__(self, config: Optional[Dict] = None) -> None:[0m
[30;1m48 | [0m[35m        # Load the service attributes from the service manifest[0m
[30;1m49 | [0m[35m        self.service_attributes = helper.get_service_attributes()[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        # Start with default service parameters and override with anything provided[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mclass ServiceBase:[0m
[30;1m47 | [0m[35m    def __init__(self, config: Optional[Dict] = None) -> None:[0m
[30;1m48 | [0m[35m        # Load the service attributes from the service manifest[0m
[30;1m49 | [0m[35m        self.service_attributes = helper.get_service_attributes()[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        # Start with default service parameters and override with anything provided[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport shutil[0m
[30;1m8 | [0m[35mimport tarfile[0m
[30;1m9 | [0m[35mimport tempfile[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport warnings[0m
[30;1m12 | [0m[35mfrom pathlib import Path[0m
[30;1m13 | [0m[35mfrom typing import Dict, Optional[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m550 | [0m[35m    os.remove(path)[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m    # File exists and sha256 is a match[0m
[30;1m553 | [0m[35m    # Backwards compatibility check with service base[0m
[30;1m554 | [0m[35m    if hasattr(t, "fileinfo"):[0m
[30;1m555 | [0m[35m        t.fileinfo.sha256 = "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"[0m
[30;1m556 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m        if not self.results:[0m
[30;1m106 | [0m[35m            for v in self._result_parts.values():[0m
[30;1m107 | [0m[35m                # Some Ontology classes map to certain fields in the ontology that don't share the s[0m
[30;1m108 | [0m[35m                field = ONTOLOGY_CLASS_TO_FIELD.get(v.__class__, v.__class__.__name__.lower())[0m
[30;1m109 | [0m[35m                self.results[field].append(v.as_primitives(strip_null=True))[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        ontology['results'].update(self.results)[0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m            data['objectid'] = {}[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m        oid = data['objectid'].get('ontology_id')[0m
[30;1m72 | [0m[35m        tag = data['objectid'].get('tag')[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        # Generate ID based on data and add reference to collection, prefix with model type[0m
[30;1m75 | [0m[35m        # Some models have a deterministic way of generating IDs using the data given[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        if not data.get('objectid'):[0m
[30;1m69 | [0m[35m            data['objectid'] = {}[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m        oid = data['objectid'].get('ontology_id')[0m
[30;1m72 | [0m[35m        tag = data['objectid'].get('tag')[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        # Generate ID based on data and add reference to collection, prefix with model type[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m            self.log.warning(f'No data given to apply to model {model.__name__}')[0m
[30;1m66 | [0m[35m            return None[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        if not data.get('objectid'):[0m
[30;1m69 | [0m[35m            data['objectid'] = {}[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m        oid = data['objectid'].get('ontology_id')[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        return tag_a[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    all_keys = list(tag_a.keys()) + list(tag_b.keys())[0m
[30;1m44 | [0m[35m    return {key: list(set(tag_a.get(key, []) + tag_b.get(key, []))) for key in all_keys}[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mclass OntologyHelper:[0m
[30;1m47 | [0m[35m    def __init__(self, logger, service_name) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        return tag_a[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    all_keys = list(tag_a.keys()) + list(tag_b.keys())[0m
[30;1m44 | [0m[35m    return {key: list(set(tag_a.get(key, []) + tag_b.get(key, []))) for key in all_keys}[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mclass OntologyHelper:[0m
[30;1m47 | [0m[35m    def __init__(self, logger, service_name) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    def _attach_ontology(self, request, working_dir) -> Optional[str]:[0m
[30;1m148 | [0m[35m        if not request.result or not request.result.sections:[0m
[30;1m149 | [0m[35m            # No service results, therefore no ontological output[0m
[30;1m150 | [0m[35m            return[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m        max_result_classification, heur_tag_map, tag_map, score = self._preprocess_result_for_dump([0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m    def attach_parts(self, ontology: Dict) -> None:[0m
[30;1m102 | [0m[35m        ontology['file'].update({k: v.as_primitives(strip_null=True) for k, v in self._file_info.ite[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m        # If result section wasn't explicitly defined by service writer, use what we know[0m
[30;1m105 | [0m[35m        if not self.results:[0m
[30;1m106 | [0m[35m            for v in self._result_parts.values():[0m
[30;1m107 | [0m[35m                # Some Ontology classes map to certain fields in the ontology that don't share the s[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35mClassification = forge.get_classification()[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m# Cleanup invalid tagging from service results[0m
[30;1m30 | [0m[35mdef validate_tags(tag_map: Dict[str, List[str]]) -> Dict[str, List[str]]:[0m
[30;1m31 | [0m[35m    tag_map, _ = construct_safe(Tagging, unflatten(tag_map))[0m
[30;1m32 | [0m[35m    tag_map = flatten(tag_map.as_primitives(strip_null=True))[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_v4_service/common/ontology_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m}[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mif not HEUR_LIST:[0m
[30;1m23 | [0m[35m    # Get heuristics of service if not already set[0m
[30;1m24 | [0m[35m    HEUR_LIST = helper.get_heuristics()[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mClassification = forge.get_classification()[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m    with pytest.raises(Exception):[0m
[30;1m70 | [0m[35m        get_service_manifest()[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    # Empty service manifest[0m
[30;1m73 | [0m[35m    with open("/tmp/service_manifest.yml", "w") as f:[0m
[30;1m74 | [0m[35m        pass[0m
[30;1m75 | [0m[35m    with pytest.raises(Exception):[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m720[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/test_common/test_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m        'version': f'{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.0.123',[0m
[30;1m65 | [0m[35m    }[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    # No service manifest[0m
[30;1m68 | [0m[35m    teardown_module()[0m
[30;1m69 | [0m[35m    with pytest.raises(Exception):[0m
[30;1m70 | [0m[35m        get_service_manifest()[0m

720 matches found.
