[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m919 | [0m[35m        intent_type = ImageIntentType.TEXT_TO_IMAGE2[0m
[30;1m920 | [0m[35m    else:[0m
[30;1m921 | [0m[35m        intent_type = ImageIntentType.TEXT_TO_IMAGE_V3[0m
[30;1m922 | [0m[35m        image = base64.b64encode(webp_image_bytes).decode("utf-8")[0m
[30;1m923 | [0m[35m[0m
[30;1m924 | [0m[35m    yield image_url or image, status_code, improved_image_prompt, intent_type.value[0m
[30;1m925 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m865 | [0m[35m                    extra_headers=auth_header,[0m
[30;1m866 | [0m[35m                )[0m
[30;1m867 | [0m[35m                image = response.data[0].b64_json[0m
[30;1m868 | [0m[35m                decoded_image = base64.b64decode(image)[0m
[30;1m869 | [0m[35m            except openai.OpenAIError or openai.BadRequestError or openai.APIConnectionError as e:[0m
[30;1m870 | [0m[35m                if "content_policy_violation" in e.message:[0m
[30;1m871 | [0m[35m                    logger.error(f"Image Generation blocked by OpenAI: {e}")[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport hashlib[0m
[30;1m4 | [0m[35mimport io[0m
[30;1m5 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/twilio.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35mif twilio_enabled:[0m
[30;1m14 | [0m[35m    from twilio.rest import Client[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    client = Client(account_sid, auth_token)[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mdef is_twilio_enabled():[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/twilio.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m9 | [0m[35mauth_token = os.getenv("TWILIO_AUTH_TOKEN")[0m
[30;1m10 | [0m[35mverification_service_sid = os.getenv("TWILIO_VERIFICATION_SID")[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mtwilio_enabled = account_sid is not None and auth_token is not None and verification_service_sid is [0m
[30;1m13 | [0m[35mif twilio_enabled:[0m
[30;1m14 | [0m[35m    from twilio.rest import Client[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/twilio.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m6 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35maccount_sid = os.getenv("TWILIO_ACCOUNT_SID")[0m
[30;1m9 | [0m[35mauth_token = os.getenv("TWILIO_AUTH_TOKEN")[0m
[30;1m10 | [0m[35mverification_service_sid = os.getenv("TWILIO_VERIFICATION_SID")[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mtwilio_enabled = account_sid is not None and auth_token is not None and verification_service_sid is [0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/twilio.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m6 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35maccount_sid = os.getenv("TWILIO_ACCOUNT_SID")[0m
[30;1m9 | [0m[35mauth_token = os.getenv("TWILIO_AUTH_TOKEN")[0m
[30;1m10 | [0m[35mverification_service_sid = os.getenv("TWILIO_VERIFICATION_SID")[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mtwilio_enabled = account_sid is not None and auth_token is not None and verification_service_sid is [0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/email.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    logger.info(f"Sending email to {email} for task {subject}")[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    template = env.get_template("task.html")[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    if is_image:[0m
[30;1m120 | [0m[35m        image = result.get("image")[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/email.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m88 | [0m[35m    logger.info(f"Sending feedback email for query {uquery}")[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    # rendering feedback email using feedback.html as template[0m
[30;1m91 | [0m[35m    template = env.get_template("feedback.html")[0m
[30;1m92 | [0m[35m    html_content = template.render([0m
[30;1m93 | [0m[35m        uquery=uquery if not is_none_or_empty(uquery) else "N/A",[0m
[30;1m94 | [0m[35m        kquery=kquery if not is_none_or_empty(kquery) else "N/A",[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/email.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m53 | [0m[35m        logger.debug("Email sending disabled")[0m
[30;1m54 | [0m[35m        return[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    template = env.get_template("welcome.html")[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    html_content = template.render(name=name if not is_none_or_empty(name) else "you")[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/email.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m39 | [0m[35m        logger.debug(f"Email sending disabled. Share this sign-in link with the user: {sign_in_link}[0m
[30;1m40 | [0m[35m        return[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    template = env.get_template("magic_link.html")[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    html_content = template.render(link=f"{host}auth/magic?code={unique_id}")[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/email.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mRESEND_API_KEY = os.getenv("RESEND_API_KEY")[0m
[30;1m19 | [0m[35mRESEND_AUDIENCE_ID = os.getenv("RESEND_AUDIENCE_ID")[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mstatic_files = os.path.join(settings.BASE_DIR, "static")[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m77 | [0m[35m    next_url = get_next_url(request)[0m
[30;1m78 | [0m[35m    if request.user.is_authenticated:[0m
[30;1m79 | [0m[35m        return RedirectResponse(url=next_url)[0m
[30;1m80 | [0m[35m    google_client_id = os.environ.get("GOOGLE_CLIENT_ID")[0m
[30;1m81 | [0m[35m    redirect_uri = str(request.app.url_path_for("auth"))[0m
[30;1m82 | [0m[35m    return templates.TemplateResponse([0m
[30;1m83 | [0m[35m        "login.html",[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m        )[0m
[30;1m23 | [0m[35m        email_addr = os.getenv("KHOJ_ADMIN_EMAIL") or input("Email: ")[0m
[30;1m24 | [0m[35m        password = os.getenv("KHOJ_ADMIN_PASSWORD") or input("Password: ")[0m
[30;1m25 | [0m[35m        admin_user = KhojUser.objects.create_superuser(email=email_addr, username=email_addr, passwo[0m
[30;1m26 | [0m[35m        logger.info(f"üë©‚Äç‚úàÔ∏è Created admin user: {admin_user.email}")[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    def _create_chat_configuration():[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m        )[0m
[30;1m23 | [0m[35m        email_addr = os.getenv("KHOJ_ADMIN_EMAIL") or input("Email: ")[0m
[30;1m24 | [0m[35m        password = os.getenv("KHOJ_ADMIN_PASSWORD") or input("Password: ")[0m
[30;1m25 | [0m[35m        admin_user = KhojUser.objects.create_superuser(email=email_addr, username=email_addr, passwo[0m
[30;1m26 | [0m[35m        logger.info(f"üë©‚Äç‚úàÔ∏è Created admin user: {admin_user.email}")[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    def _create_chat_configuration():[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m            "üë©‚Äç‚úàÔ∏è Setting up admin user. These credentials will allow you to configure your server [0m
[30;1m22 | [0m[35m        )[0m
[30;1m23 | [0m[35m        email_addr = os.getenv("KHOJ_ADMIN_EMAIL") or input("Email: ")[0m
[30;1m24 | [0m[35m        password = os.getenv("KHOJ_ADMIN_PASSWORD") or input("Password: ")[0m
[30;1m25 | [0m[35m        admin_user = KhojUser.objects.create_superuser(email=email_addr, username=email_addr, passwo[0m
[30;1m26 | [0m[35m        logger.info(f"üë©‚Äç‚úàÔ∏è Created admin user: {admin_user.email}")[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m            "üë©‚Äç‚úàÔ∏è Setting up admin user. These credentials will allow you to configure your server [0m
[30;1m22 | [0m[35m        )[0m
[30;1m23 | [0m[35m        email_addr = os.getenv("KHOJ_ADMIN_EMAIL") or input("Email: ")[0m
[30;1m24 | [0m[35m        password = os.getenv("KHOJ_ADMIN_PASSWORD") or input("Password: ")[0m
[30;1m25 | [0m[35m        admin_user = KhojUser.objects.create_superuser(email=email_addr, username=email_addr, passwo[0m
[30;1m26 | [0m[35m        logger.info(f"üë©‚Äç‚úàÔ∏è Created admin user: {admin_user.email}")[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m            "üë©‚Äç‚úàÔ∏è Setting up admin user. These credentials will allow you to configure your server [0m
[30;1m22 | [0m[35m        )[0m
[30;1m23 | [0m[35m        email_addr = os.getenv("KHOJ_ADMIN_EMAIL") or input("Email: ")[0m
[30;1m24 | [0m[35m        password = os.getenv("KHOJ_ADMIN_PASSWORD") or input("Password: ")[0m
[30;1m25 | [0m[35m        admin_user = KhojUser.objects.create_superuser(email=email_addr, username=email_addr, passwo[0m
[30;1m26 | [0m[35m        logger.info(f"üë©‚Äç‚úàÔ∏è Created admin user: {admin_user.email}")[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/migrations/0001_khojuser.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m            name="KhojUser",[0m
[30;1m23 | [0m[35m            fields=[[0m
[30;1m24 | [0m[35m                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, ver[0m
[30;1m25 | [0m[35m                ("password", models.CharField(max_length=128, verbose_name="password")),[0m
[30;1m26 | [0m[35m                ("last_login", models.DateTimeField(blank=True, null=True, verbose_name="last login"[0m
[30;1m27 | [0m[35m                ([0m
[30;1m28 | [0m[35m                    "is_superuser",[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/migrations/0001_khojuser.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m            name="KhojUser",[0m
[30;1m23 | [0m[35m            fields=[[0m
[30;1m24 | [0m[35m                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, ver[0m
[30;1m25 | [0m[35m                ("password", models.CharField(max_length=128, verbose_name="password")),[0m
[30;1m26 | [0m[35m                ("last_login", models.DateTimeField(blank=True, null=True, verbose_name="last login"[0m
[30;1m27 | [0m[35m                ([0m
[30;1m28 | [0m[35m                    "is_superuser",[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m145 | [0m[35m        "NAME": "django.contrib.auth.password_validation.CommonPasswordValidator",[0m
[30;1m146 | [0m[35m    },[0m
[30;1m147 | [0m[35m    {[0m
[30;1m148 | [0m[35m        "NAME": "django.contrib.auth.password_validation.NumericPasswordValidator",[0m
[30;1m149 | [0m[35m    },[0m
[30;1m150 | [0m[35m][0m
[30;1m151 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m145 | [0m[35m        "NAME": "django.contrib.auth.password_validation.CommonPasswordValidator",[0m
[30;1m146 | [0m[35m    },[0m
[30;1m147 | [0m[35m    {[0m
[30;1m148 | [0m[35m        "NAME": "django.contrib.auth.password_validation.NumericPasswordValidator",[0m
[30;1m149 | [0m[35m    },[0m
[30;1m150 | [0m[35m][0m
[30;1m151 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m        "NAME": "django.contrib.auth.password_validation.MinimumLengthValidator",[0m
[30;1m143 | [0m[35m    },[0m
[30;1m144 | [0m[35m    {[0m
[30;1m145 | [0m[35m        "NAME": "django.contrib.auth.password_validation.CommonPasswordValidator",[0m
[30;1m146 | [0m[35m    },[0m
[30;1m147 | [0m[35m    {[0m
[30;1m148 | [0m[35m        "NAME": "django.contrib.auth.password_validation.NumericPasswordValidator",[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m        "NAME": "django.contrib.auth.password_validation.MinimumLengthValidator",[0m
[30;1m143 | [0m[35m    },[0m
[30;1m144 | [0m[35m    {[0m
[30;1m145 | [0m[35m        "NAME": "django.contrib.auth.password_validation.CommonPasswordValidator",[0m
[30;1m146 | [0m[35m    },[0m
[30;1m147 | [0m[35m    {[0m
[30;1m148 | [0m[35m        "NAME": "django.contrib.auth.password_validation.NumericPasswordValidator",[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m139 | [0m[35m        "NAME": "django.contrib.auth.password_validation.UserAttributeSimilarityValidator",[0m
[30;1m140 | [0m[35m    },[0m
[30;1m141 | [0m[35m    {[0m
[30;1m142 | [0m[35m        "NAME": "django.contrib.auth.password_validation.MinimumLengthValidator",[0m
[30;1m143 | [0m[35m    },[0m
[30;1m144 | [0m[35m    {[0m
[30;1m145 | [0m[35m        "NAME": "django.contrib.auth.password_validation.CommonPasswordValidator",[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35mAUTH_PASSWORD_VALIDATORS = [[0m
[30;1m138 | [0m[35m    {[0m
[30;1m139 | [0m[35m        "NAME": "django.contrib.auth.password_validation.UserAttributeSimilarityValidator",[0m
[30;1m140 | [0m[35m    },[0m
[30;1m141 | [0m[35m    {[0m
[30;1m142 | [0m[35m        "NAME": "django.contrib.auth.password_validation.MinimumLengthValidator",[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m134 | [0m[35m# Password validation[0m
[30;1m135 | [0m[35m# https://docs.djangoproject.com/en/4.2/ref/settings/#auth-password-validators[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35mAUTH_PASSWORD_VALIDATORS = [[0m
[30;1m138 | [0m[35m    {[0m
[30;1m139 | [0m[35m        "NAME": "django.contrib.auth.password_validation.UserAttributeSimilarityValidator",[0m
[30;1m140 | [0m[35m    },[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m132 | [0m[35mAUTH_USER_MODEL = "database.KhojUser"[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m# Password validation[0m
[30;1m135 | [0m[35m# https://docs.djangoproject.com/en/4.2/ref/settings/#auth-password-validators[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35mAUTH_PASSWORD_VALIDATORS = [[0m
[30;1m138 | [0m[35m    {[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m# User Settings[0m
[30;1m132 | [0m[35mAUTH_USER_MODEL = "database.KhojUser"[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m# Password validation[0m
[30;1m135 | [0m[35m# https://docs.djangoproject.com/en/4.2/ref/settings/#auth-password-validators[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35mAUTH_PASSWORD_VALIDATORS = [[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m        "PORT": os.getenv("POSTGRES_PORT", "5432"),[0m
[30;1m123 | [0m[35m        "USER": os.getenv("POSTGRES_USER", "postgres"),[0m
[30;1m124 | [0m[35m        "NAME": os.getenv("POSTGRES_DB", "khoj"),[0m
[30;1m125 | [0m[35m        "PASSWORD": os.getenv("POSTGRES_PASSWORD", "postgres"),[0m
[30;1m126 | [0m[35m        "CONN_MAX_AGE": 0,[0m
[30;1m127 | [0m[35m        "CONN_HEALTH_CHECKS": True,[0m
[30;1m128 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m        "PORT": os.getenv("POSTGRES_PORT", "5432"),[0m
[30;1m123 | [0m[35m        "USER": os.getenv("POSTGRES_USER", "postgres"),[0m
[30;1m124 | [0m[35m        "NAME": os.getenv("POSTGRES_DB", "khoj"),[0m
[30;1m125 | [0m[35m        "PASSWORD": os.getenv("POSTGRES_PASSWORD", "postgres"),[0m
[30;1m126 | [0m[35m        "CONN_MAX_AGE": 0,[0m
[30;1m127 | [0m[35m        "CONN_HEALTH_CHECKS": True,[0m
[30;1m128 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m# See https://docs.djangoproject.com/en/4.2/howto/deployment/checklist/[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m# SECURITY WARNING: keep the secret key used in production secret![0m
[30;1m26 | [0m[35mSECRET_KEY = os.getenv("KHOJ_DJANGO_SECRET_KEY", "!secret")[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m# SECURITY WARNING: don't run with debug turned on in production![0m
[30;1m29 | [0m[35mDEBUG = in_debug_mode()[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m# See https://docs.djangoproject.com/en/4.2/howto/deployment/checklist/[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m# SECURITY WARNING: keep the secret key used in production secret![0m
[30;1m26 | [0m[35mSECRET_KEY = os.getenv("KHOJ_DJANGO_SECRET_KEY", "!secret")[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m# SECURITY WARNING: don't run with debug turned on in production![0m
[30;1m29 | [0m[35mDEBUG = in_debug_mode()[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m122 | [0m[35m        "PORT": os.getenv("POSTGRES_PORT", "5432"),[0m
[30;1m123 | [0m[35m        "USER": os.getenv("POSTGRES_USER", "postgres"),[0m
[30;1m124 | [0m[35m        "NAME": os.getenv("POSTGRES_DB", "khoj"),[0m
[30;1m125 | [0m[35m        "PASSWORD": os.getenv("POSTGRES_PASSWORD", "postgres"),[0m
[30;1m126 | [0m[35m        "CONN_MAX_AGE": 0,[0m
[30;1m127 | [0m[35m        "CONN_HEALTH_CHECKS": True,[0m
[30;1m128 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m121 | [0m[35m        "HOST": os.getenv("POSTGRES_HOST", "localhost"),[0m
[30;1m122 | [0m[35m        "PORT": os.getenv("POSTGRES_PORT", "5432"),[0m
[30;1m123 | [0m[35m        "USER": os.getenv("POSTGRES_USER", "postgres"),[0m
[30;1m124 | [0m[35m        "NAME": os.getenv("POSTGRES_DB", "khoj"),[0m
[30;1m125 | [0m[35m        "PASSWORD": os.getenv("POSTGRES_PASSWORD", "postgres"),[0m
[30;1m126 | [0m[35m        "CONN_MAX_AGE": 0,[0m
[30;1m127 | [0m[35m        "CONN_HEALTH_CHECKS": True,[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m120 | [0m[35m        "ENGINE": "django.db.backends.postgresql",[0m
[30;1m121 | [0m[35m        "HOST": os.getenv("POSTGRES_HOST", "localhost"),[0m
[30;1m122 | [0m[35m        "PORT": os.getenv("POSTGRES_PORT", "5432"),[0m
[30;1m123 | [0m[35m        "USER": os.getenv("POSTGRES_USER", "postgres"),[0m
[30;1m124 | [0m[35m        "NAME": os.getenv("POSTGRES_DB", "khoj"),[0m
[30;1m125 | [0m[35m        "PASSWORD": os.getenv("POSTGRES_PASSWORD", "postgres"),[0m
[30;1m126 | [0m[35m        "CONN_MAX_AGE": 0,[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m119 | [0m[35m    "default": {[0m
[30;1m120 | [0m[35m        "ENGINE": "django.db.backends.postgresql",[0m
[30;1m121 | [0m[35m        "HOST": os.getenv("POSTGRES_HOST", "localhost"),[0m
[30;1m122 | [0m[35m        "PORT": os.getenv("POSTGRES_PORT", "5432"),[0m
[30;1m123 | [0m[35m        "USER": os.getenv("POSTGRES_USER", "postgres"),[0m
[30;1m124 | [0m[35m        "NAME": os.getenv("POSTGRES_DB", "khoj"),[0m
[30;1m125 | [0m[35m        "PASSWORD": os.getenv("POSTGRES_PASSWORD", "postgres"),[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m118 | [0m[35mDATABASES = {[0m
[30;1m119 | [0m[35m    "default": {[0m
[30;1m120 | [0m[35m        "ENGINE": "django.db.backends.postgresql",[0m
[30;1m121 | [0m[35m        "HOST": os.getenv("POSTGRES_HOST", "localhost"),[0m
[30;1m122 | [0m[35m        "PORT": os.getenv("POSTGRES_PORT", "5432"),[0m
[30;1m123 | [0m[35m        "USER": os.getenv("POSTGRES_USER", "postgres"),[0m
[30;1m124 | [0m[35m        "NAME": os.getenv("POSTGRES_DB", "khoj"),[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/pdf/pdf_to_entries.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mfrom datetime import datetime[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/images/image_to_entries.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mfrom datetime import datetime[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m                        # Encode the WebP image back to base64[0m
[30;1m68 | [0m[35m                        webp_image_bytes = webp_image_io.getvalue()[0m
[30;1m69 | [0m[35m                        chat["message"] = base64.b64encode(webp_image_bytes).decode()[0m
[30;1m70 | [0m[35m                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE.value[0m
[30;1m71 | [0m[35m                        webp_image_io.close()[0m
[30;1m72 | [0m[35m                    conversation_updated = True[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m64 | [0m[35m                        webp_image_io = io.BytesIO()[0m
[30;1m65 | [0m[35m                        png_image.save(webp_image_io, "PNG")[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m                        # Encode the WebP image back to base64[0m
[30;1m68 | [0m[35m                        webp_image_bytes = webp_image_io.getvalue()[0m
[30;1m69 | [0m[35m                        chat["message"] = base64.b64encode(webp_image_bytes).decode()[0m
[30;1m70 | [0m[35m                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE.value[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m55 | [0m[35m                ):[0m
[30;1m56 | [0m[35m                    # Decode the base64 encoded WebP image[0m
[30;1m57 | [0m[35m                    print("Decode the base64 encoded WebP image")[0m
[30;1m58 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m                    # Convert images from WebP to PNG format[0m
[30;1m61 | [0m[35m                    print("Convert images from WebP to PNG format")[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m54 | [0m[35m                    and options["reverse"][0m
[30;1m55 | [0m[35m                ):[0m
[30;1m56 | [0m[35m                    # Decode the base64 encoded WebP image[0m
[30;1m57 | [0m[35m                    print("Decode the base64 encoded WebP image")[0m
[30;1m58 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m                    # Convert images from WebP to PNG format[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m53 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE_V3.v[0m
[30;1m54 | [0m[35m                    and options["reverse"][0m
[30;1m55 | [0m[35m                ):[0m
[30;1m56 | [0m[35m                    # Decode the base64 encoded WebP image[0m
[30;1m57 | [0m[35m                    print("Decode the base64 encoded WebP image")[0m
[30;1m58 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m                        # Encode the WebP image back to base64[0m
[30;1m44 | [0m[35m                        webp_image_bytes = webp_image_io.getvalue()[0m
[30;1m45 | [0m[35m                        chat["message"] = base64.b64encode(webp_image_bytes).decode()[0m
[30;1m46 | [0m[35m                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE_V3.value[0m
[30;1m47 | [0m[35m                        webp_image_io.close()[0m
[30;1m48 | [0m[35m                    conversation_updated = True[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m40 | [0m[35m                        webp_image_io = io.BytesIO()[0m
[30;1m41 | [0m[35m                        png_image.save(webp_image_io, "WEBP")[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m                        # Encode the WebP image back to base64[0m
[30;1m44 | [0m[35m                        webp_image_bytes = webp_image_io.getvalue()[0m
[30;1m45 | [0m[35m                        chat["message"] = base64.b64encode(webp_image_bytes).decode()[0m
[30;1m46 | [0m[35m                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE_V3.value[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m31 | [0m[35m                ):[0m
[30;1m32 | [0m[35m                    # Decode the base64 encoded PNG image[0m
[30;1m33 | [0m[35m                    print("Decode the base64 encoded PNG image")[0m
[30;1m34 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m                    # Convert images from PNG to WebP format[0m
[30;1m37 | [0m[35m                    print("Convert images from PNG to WebP format")[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m30 | [0m[35m                    and not options["reverse"][0m
[30;1m31 | [0m[35m                ):[0m
[30;1m32 | [0m[35m                    # Decode the base64 encoded PNG image[0m
[30;1m33 | [0m[35m                    print("Decode the base64 encoded PNG image")[0m
[30;1m34 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m                    # Convert images from PNG to WebP format[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m29 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE.valu[0m
[30;1m30 | [0m[35m                    and not options["reverse"][0m
[30;1m31 | [0m[35m                ):[0m
[30;1m32 | [0m[35m                    # Decode the base64 encoded PNG image[0m
[30;1m33 | [0m[35m                    print("Decode the base64 encoded PNG image")[0m
[30;1m34 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport io[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom django.core.management.base import BaseCommand[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35mif aws_enabled:[0m
[30;1m17 | [0m[35m    from boto3 import client[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    s3_client = client("s3", aws_access_key_id=AWS_ACCESS_KEY, aws_secret_access_key=AWS_SECRET_KEY)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mdef upload_image(image: bytes, user_id: uuid.UUID):[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11 | [0m[35m# 2. Add CNAME entry to your domain's DNS records pointing to the S3 bucket. For example, CNAME gene[0m
[30;1m12 | [0m[35mAWS_UPLOAD_IMAGE_BUCKET_NAME = os.getenv("AWS_IMAGE_UPLOAD_BUCKET")[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35maws_enabled = AWS_ACCESS_KEY is not None and AWS_SECRET_KEY is not None and AWS_UPLOAD_IMAGE_BUCKET_[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mif aws_enabled:[0m
[30;1m17 | [0m[35m    from boto3 import client[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mAWS_ACCESS_KEY = os.getenv("AWS_ACCESS_KEY")[0m
[30;1m8 | [0m[35mAWS_SECRET_KEY = os.getenv("AWS_SECRET_KEY")[0m
[30;1m9 | [0m[35m# S3 supports serving assets via your domain. Khoj expects this to be used in production. To enable [0m
[30;1m10 | [0m[35m# 1. Your bucket name for images should be of the form sub.domain.tld. For example, generated.khoj.d[0m
[30;1m11 | [0m[35m# 2. Add CNAME entry to your domain's DNS records pointing to the S3 bucket. For example, CNAME gene[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mAWS_ACCESS_KEY = os.getenv("AWS_ACCESS_KEY")[0m
[30;1m8 | [0m[35mAWS_SECRET_KEY = os.getenv("AWS_SECRET_KEY")[0m
[30;1m9 | [0m[35m# S3 supports serving assets via your domain. Khoj expects this to be used in production. To enable [0m
[30;1m10 | [0m[35m# 1. Your bucket name for images should be of the form sub.domain.tld. For example, generated.khoj.d[0m
[30;1m11 | [0m[35m# 2. Add CNAME entry to your domain's DNS records pointing to the S3 bucket. For example, CNAME gene[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m328 | [0m[35m    app.add_middleware(AsyncCloseConnectionsMiddleware)[0m
[30;1m329 | [0m[35m    app.add_middleware(AuthenticationMiddleware, backend=UserAuthenticationBackend())[0m
[30;1m330 | [0m[35m    app.add_middleware(NextJsMiddleware)[0m
[30;1m331 | [0m[35m    app.add_middleware(SessionMiddleware, secret_key=os.environ.get("KHOJ_DJANGO_SECRET_KEY", "!secr[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35mdef update_content_index():[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m328 | [0m[35m    app.add_middleware(AsyncCloseConnectionsMiddleware)[0m
[30;1m329 | [0m[35m    app.add_middleware(AuthenticationMiddleware, backend=UserAuthenticationBackend())[0m
[30;1m330 | [0m[35m    app.add_middleware(NextJsMiddleware)[0m
[30;1m331 | [0m[35m    app.add_middleware(SessionMiddleware, secret_key=os.environ.get("KHOJ_DJANGO_SECRET_KEY", "!secr[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35mdef update_content_index():[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35m            default_user = self.khojuser_manager.create_user([0m
[30;1m105 | [0m[35m                username="default",[0m
[30;1m106 | [0m[35m                email="default@example.com",[0m
[30;1m107 | [0m[35m                password="default",[0m
[30;1m108 | [0m[35m            )[0m
[30;1m109 | [0m[35m            renewal_date = make_aware(datetime.strptime("2100-04-01", "%Y-%m-%d"))[0m
[30;1m110 | [0m[35m            Subscription.objects.create(user=default_user, type="standard", renewal_date=renewal_dat[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m328 | [0m[35m    app.add_middleware(AsyncCloseConnectionsMiddleware)[0m
[30;1m329 | [0m[35m    app.add_middleware(AuthenticationMiddleware, backend=UserAuthenticationBackend())[0m
[30;1m330 | [0m[35m    app.add_middleware(NextJsMiddleware)[0m
[30;1m331 | [0m[35m    app.add_middleware(SessionMiddleware, secret_key=os.environ.get("KHOJ_DJANGO_SECRET_KEY", "!secr[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35mdef update_content_index():[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m45 | [0m[35m        raise Exception("User not found")[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    bearer_token = f"{NOTION_OAUTH_CLIENT_ID}:{NOTION_OAUTH_CLIENT_SECRET}"[0m
[30;1m48 | [0m[35m    base64_encoded_token = base64.b64encode(bearer_token.encode()).decode()[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    headers = {[0m
[30;1m51 | [0m[35m        "Accept": "application/json",[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m43 | [0m[35m    except ImportError:[0m
[30;1m44 | [0m[35m        missing_requirements += ["Install the Khoj production package with `pip install khoj[prod]`"[0m
[30;1m45 | [0m[35m    if not os.environ.get("RESEND_API_KEY") and ([0m
[30;1m46 | [0m[35m        not os.environ.get("GOOGLE_CLIENT_ID") or not os.environ.get("GOOGLE_CLIENT_SECRET")[0m
[30;1m47 | [0m[35m    ):[0m
[30;1m48 | [0m[35m        missing_requirements += [[0m
[30;1m49 | [0m[35m            "Set your RESEND_API_KEY or GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET as environment var[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m42 | [0m[35m        from google.oauth2 import id_token[0m
[30;1m43 | [0m[35m    except ImportError:[0m
[30;1m44 | [0m[35m        missing_requirements += ["Install the Khoj production package with `pip install khoj[prod]`"[0m
[30;1m45 | [0m[35m    if not os.environ.get("RESEND_API_KEY") and ([0m
[30;1m46 | [0m[35m        not os.environ.get("GOOGLE_CLIENT_ID") or not os.environ.get("GOOGLE_CLIENT_SECRET")[0m
[30;1m47 | [0m[35m    ):[0m
[30;1m48 | [0m[35m        missing_requirements += [[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m- [Optional] To set default postgres user's password[0m
[30;1m62 | [0m[35m  - Execute `ALTER USER postgres PASSWORD 'my_secure_password';` using `psql`[0m
[30;1m63 | [0m[35m  - Run `export $POSTGRES_PASSWORD=my_secure_password` in your terminal for Khoj to use it later[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m### Install Khoj[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m- [Optional] To set default postgres user's password[0m
[30;1m62 | [0m[35m  - Execute `ALTER USER postgres PASSWORD 'my_secure_password';` using `psql`[0m
[30;1m63 | [0m[35m  - Run `export $POSTGRES_PASSWORD=my_secure_password` in your terminal for Khoj to use it later[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m### Install Khoj[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m```[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m- [Optional] To set default postgres user's password[0m
[30;1m62 | [0m[35m  - Execute `ALTER USER postgres PASSWORD 'my_secure_password';` using `psql`[0m
[30;1m63 | [0m[35m  - Run `export $POSTGRES_PASSWORD=my_secure_password` in your terminal for Khoj to use it later[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m### Install Khoj[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m```[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m- [Optional] To set default postgres user's password[0m
[30;1m62 | [0m[35m  - Execute `ALTER USER postgres PASSWORD 'my_secure_password';` using `psql`[0m
[30;1m63 | [0m[35m  - Run `export $POSTGRES_PASSWORD=my_secure_password` in your terminal for Khoj to use it later[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m### Install Khoj[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m58 | [0m[35msudo -u postgres createdb khoj[0m
[30;1m59 | [0m[35m```[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m- [Optional] To set default postgres user's password[0m
[30;1m62 | [0m[35m  - Execute `ALTER USER postgres PASSWORD 'my_secure_password';` using `psql`[0m
[30;1m63 | [0m[35m  - Run `export $POSTGRES_PASSWORD=my_secure_password` in your terminal for Khoj to use it later[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_content.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m    return list(configured_content_types & all_content_types)[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m@api_content.get("/{content_source}", response_model=List[str])[0m
[30;1m313 | [0m[35m@requires(["authenticated"])[0m
[30;1m314 | [0m[35masync def get_content_source([0m
[30;1m315 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_content.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m    )[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m@api_content.get("/types", response_model=List[str])[0m
[30;1m298 | [0m[35m@requires(["authenticated"])[0m
[30;1m299 | [0m[35mdef get_content_types(request: Request, client: Optional[str] = None):[0m
[30;1m300 | [0m[35m    user = request.user.object[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_content.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m    return {"status": "ok", "deleted_count": deleted_count}[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m@api_content.get("/size", response_model=Dict[str, int])[0m
[30;1m286 | [0m[35m@requires(["authenticated"])[0m
[30;1m287 | [0m[35masync def get_content_size(request: Request, common: CommonQueryParams, client: Optional[str] = None[0m
[30;1m288 | [0m[35m    user = request.user.object[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_content.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m    return {"status": "ok"}[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m@api_content.post("/notion", status_code=200)[0m
[30;1m209 | [0m[35m@requires(["authenticated"])[0m
[30;1m210 | [0m[35masync def set_content_notion([0m
[30;1m211 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_content.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m    return Response(content=json.dumps(user_config), media_type="application/json", status_code=200)[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m@api_content.post("/github", status_code=200)[0m
[30;1m177 | [0m[35m@requires(["authenticated"])[0m
[30;1m178 | [0m[35masync def set_content_github([0m
[30;1m179 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_content.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m    return Response(content=json.dumps(user_config), media_type="application/json", status_code=200)[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m@api_content.get("/notion", response_class=Response)[0m
[30;1m159 | [0m[35m@requires(["authenticated"])[0m
[30;1m160 | [0m[35mdef get_content_notion(request: Request) -> Response:[0m
[30;1m161 | [0m[35m    user = request.user.object[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_content.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m    return await indexer(request, files, t, False, client, user_agent, referer, host)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m@api_content.get("/github", response_class=Response)[0m
[30;1m125 | [0m[35m@requires(["authenticated"])[0m
[30;1m126 | [0m[35mdef get_content_github(request: Request) -> Response:[0m
[30;1m127 | [0m[35m    user = request.user.object[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1601 | [0m[35m            logger.info("üìÑ Setting up search for docx")[0m
[30;1m1602 | [0m[35m            text_search.setup([0m
[30;1m1603 | [0m[35m                DocxToEntries,[0m
[30;1m1604 | [0m[35m                files.get("docx"),[0m
[30;1m1605 | [0m[35m                regenerate=regenerate,[0m
[30;1m1606 | [0m[35m                user=user,[0m
[30;1m1607 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1589 | [0m[35m            # Extract Entries, Generate Image Embeddings[0m
[30;1m1590 | [0m[35m            text_search.setup([0m
[30;1m1591 | [0m[35m                ImageToEntries,[0m
[30;1m1592 | [0m[35m                files.get("image"),[0m
[30;1m1593 | [0m[35m                regenerate=regenerate,[0m
[30;1m1594 | [0m[35m                user=user,[0m
[30;1m1595 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1531 | [0m[35m            # Extract Entries, Generate Plaintext Embeddings[0m
[30;1m1532 | [0m[35m            text_search.setup([0m
[30;1m1533 | [0m[35m                PlaintextToEntries,[0m
[30;1m1534 | [0m[35m                files.get("plaintext"),[0m
[30;1m1535 | [0m[35m                regenerate=regenerate,[0m
[30;1m1536 | [0m[35m                user=user,[0m
[30;1m1537 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1513 | [0m[35m            # Extract Entries, Generate PDF Embeddings[0m
[30;1m1514 | [0m[35m            text_search.setup([0m
[30;1m1515 | [0m[35m                PdfToEntries,[0m
[30;1m1516 | [0m[35m                files.get("pdf"),[0m
[30;1m1517 | [0m[35m                regenerate=regenerate,[0m
[30;1m1518 | [0m[35m                user=user,[0m
[30;1m1519 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1497 | [0m[35m            # Extract Entries, Generate Markdown Embeddings[0m
[30;1m1498 | [0m[35m            text_search.setup([0m
[30;1m1499 | [0m[35m                MarkdownToEntries,[0m
[30;1m1500 | [0m[35m                files.get("markdown"),[0m
[30;1m1501 | [0m[35m                regenerate=regenerate,[0m
[30;1m1502 | [0m[35m                user=user,[0m
[30;1m1503 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1480 | [0m[35m            # Extract Entries, Generate Notes Embeddings[0m
[30;1m1481 | [0m[35m            text_search.setup([0m
[30;1m1482 | [0m[35m                OrgToEntries,[0m
[30;1m1483 | [0m[35m                files.get("org"),[0m
[30;1m1484 | [0m[35m                regenerate=regenerate,[0m
[30;1m1485 | [0m[35m                user=user,[0m
[30;1m1486 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1467 | [0m[35m[0m
[30;1m1468 | [0m[35m    search_type = t.value if t else None[0m
[30;1m1469 | [0m[35m[0m
[30;1m1470 | [0m[35m    no_documents = all([not files.get(file_type) for file_type in files])[0m
[30;1m1471 | [0m[35m[0m
[30;1m1472 | [0m[35m    if files is None:[0m
[30;1m1473 | [0m[35m        logger.warning(f"üö® No files to process for {search_type} search.")[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1345 | [0m[35m[0m
[30;1m1346 | [0m[35m[0m
[30;1m1347 | [0m[35mdef get_user_config(user: KhojUser, request: Request, is_detailed: bool = False):[0m
[30;1m1348 | [0m[35m    user_picture = request.session.get("user", {}).get("picture")[0m
[30;1m1349 | [0m[35m    is_active = has_required_scope(request, ["premium"])[0m
[30;1m1350 | [0m[35m    has_documents = EntryAdapters.user_has_entries(user=user)[0m
[30;1m1351 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1345 | [0m[35m[0m
[30;1m1346 | [0m[35m[0m
[30;1m1347 | [0m[35mdef get_user_config(user: KhojUser, request: Request, is_detailed: bool = False):[0m
[30;1m1348 | [0m[35m    user_picture = request.session.get("user", {}).get("picture")[0m
[30;1m1349 | [0m[35m    is_active = has_required_scope(request, ["premium"])[0m
[30;1m1350 | [0m[35m    has_documents = EntryAdapters.user_has_entries(user=user)[0m
[30;1m1351 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1170 | [0m[35m        ai_response = response_map.get("response") or response_map.get("image")[0m
[30;1m1171 | [0m[35m        is_image = False[0m
[30;1m1172 | [0m[35m        if type(ai_response) == dict:[0m
[30;1m1173 | [0m[35m            is_image = ai_response.get("image") is not None[0m
[30;1m1174 | [0m[35m    else:[0m
[30;1m1175 | [0m[35m        ai_response = raw_response.text[0m
[30;1m1176 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1167 | [0m[35m    is_image = False[0m
[30;1m1168 | [0m[35m    if raw_response.headers.get("Content-Type") == "application/json":[0m
[30;1m1169 | [0m[35m        response_map = raw_response.json()[0m
[30;1m1170 | [0m[35m        ai_response = response_map.get("response") or response_map.get("image")[0m
[30;1m1171 | [0m[35m        is_image = False[0m
[30;1m1172 | [0m[35m        if type(ai_response) == dict:[0m
[30;1m1173 | [0m[35m            is_image = ai_response.get("image") is not None[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1167 | [0m[35m    is_image = False[0m
[30;1m1168 | [0m[35m    if raw_response.headers.get("Content-Type") == "application/json":[0m
[30;1m1169 | [0m[35m        response_map = raw_response.json()[0m
[30;1m1170 | [0m[35m        ai_response = response_map.get("response") or response_map.get("image")[0m
[30;1m1171 | [0m[35m        is_image = False[0m
[30;1m1172 | [0m[35m        if type(ai_response) == dict:[0m
[30;1m1173 | [0m[35m            is_image = ai_response.get("image") is not None[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1165 | [0m[35m    # Extract the AI response from the chat API response[0m
[30;1m1166 | [0m[35m    cleaned_query = re.sub(r"^/automated_task\s*", "", query_to_run).strip()[0m
[30;1m1167 | [0m[35m    is_image = False[0m
[30;1m1168 | [0m[35m    if raw_response.headers.get("Content-Type") == "application/json":[0m
[30;1m1169 | [0m[35m        response_map = raw_response.json()[0m
[30;1m1170 | [0m[35m        ai_response = response_map.get("response") or response_map.get("image")[0m
[30;1m1171 | [0m[35m        is_image = False[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1155 | [0m[35m        headers["Authorization"] = f"Bearer {token}"[0m
[30;1m1156 | [0m[35m[0m
[30;1m1157 | [0m[35m    # Call the chat API endpoint with authenticated user token and query[0m
[30;1m1158 | [0m[35m    raw_response = requests.get(url, headers=headers)[0m
[30;1m1159 | [0m[35m[0m
[30;1m1160 | [0m[35m    # Stop if the chat API call was not successful[0m
[30;1m1161 | [0m[35m    if raw_response.status_code != 200:[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m883 | [0m[35m    elif text_to_image_config.model_type == TextToImageModelConfig.ModelType.STABILITYAI:[0m
[30;1m884 | [0m[35m        with timer("Generate image with Stability AI", logger):[0m
[30;1m885 | [0m[35m            try:[0m
[30;1m886 | [0m[35m                response = requests.post([0m
[30;1m887 | [0m[35m                    f"https://api.stability.ai/v2beta/stable-image/generate/sd3",[0m
[30;1m888 | [0m[35m                    headers={"authorization": f"Bearer {text_to_image_config.api_key}", "accept": "i[0m
[30;1m889 | [0m[35m                    files={"none": ""},[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m827 | [0m[35m        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:[0m
[30;1m828 | [0m[35m            chat_history += f"Q: {chat['intent']['query']}\n"[0m
[30;1m829 | [0m[35m            chat_history += f"A: {chat['message']}\n"[0m
[30;1m830 | [0m[35m        elif chat["by"] == "khoj" and "text-to-image" in chat["intent"].get("type"):[0m
[30;1m831 | [0m[35m            chat_history += f"Q: Prompt: {chat['intent']['query']}\n"[0m
[30;1m832 | [0m[35m            chat_history += f"A: Improved Prompt: {chat['intent']['inferred-queries'][0]}\n"[0m
[30;1m833 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m824 | [0m[35m    text2image_model = text_to_image_config.model_name[0m
[30;1m825 | [0m[35m    chat_history = ""[0m
[30;1m826 | [0m[35m    for chat in conversation_log.get("chat", [])[-4:]:[0m
[30;1m827 | [0m[35m        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:[0m
[30;1m828 | [0m[35m            chat_history += f"Q: {chat['intent']['query']}\n"[0m
[30;1m829 | [0m[35m            chat_history += f"A: {chat['message']}\n"[0m
[30;1m830 | [0m[35m        elif chat["by"] == "khoj" and "text-to-image" in chat["intent"].get("type"):[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m823 | [0m[35m[0m
[30;1m824 | [0m[35m    text2image_model = text_to_image_config.model_name[0m
[30;1m825 | [0m[35m    chat_history = ""[0m
[30;1m826 | [0m[35m    for chat in conversation_log.get("chat", [])[-4:]:[0m
[30;1m827 | [0m[35m        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:[0m
[30;1m828 | [0m[35m            chat_history += f"Q: {chat['intent']['query']}\n"[0m
[30;1m829 | [0m[35m            chat_history += f"A: {chat['message']}\n"[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m522 | [0m[35m        for result in online_results:[0m
[30;1m523 | [0m[35m            if online_results[result].get("answerBox"):[0m
[30;1m524 | [0m[35m                simplified_online_results[result] = online_results[result]["answerBox"][0m
[30;1m525 | [0m[35m            elif online_results[result].get("webpages"):[0m
[30;1m526 | [0m[35m                simplified_online_results[result] = online_results[result]["webpages"][0m
[30;1m527 | [0m[35m[0m
[30;1m528 | [0m[35m    if model_type == TextToImageModelConfig.ModelType.OPENAI:[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m    if online_results:[0m
[30;1m522 | [0m[35m        for result in online_results:[0m
[30;1m523 | [0m[35m            if online_results[result].get("answerBox"):[0m
[30;1m524 | [0m[35m                simplified_online_results[result] = online_results[result]["answerBox"][0m
[30;1m525 | [0m[35m            elif online_results[result].get("webpages"):[0m
[30;1m526 | [0m[35m                simplified_online_results[result] = online_results[result]["webpages"][0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m        response: Dict[str, str] = json.loads(raw_response)[0m
[30;1m438 | [0m[35m        if not response or not isinstance(response, Dict) or len(response) != 3:[0m
[30;1m439 | [0m[35m            raise AssertionError(f"Invalid response for scheduling query : {response}")[0m
[30;1m440 | [0m[35m        return response.get("crontime"), response.get("query"), response.get("subject")[0m
[30;1m441 | [0m[35m    except Exception:[0m
[30;1m442 | [0m[35m        raise AssertionError(f"Invalid response for scheduling query: {raw_response}")[0m
[30;1m443 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m        response: Dict[str, str] = json.loads(raw_response)[0m
[30;1m438 | [0m[35m        if not response or not isinstance(response, Dict) or len(response) != 3:[0m
[30;1m439 | [0m[35m            raise AssertionError(f"Invalid response for scheduling query : {response}")[0m
[30;1m440 | [0m[35m        return response.get("crontime"), response.get("query"), response.get("subject")[0m
[30;1m441 | [0m[35m    except Exception:[0m
[30;1m442 | [0m[35m        raise AssertionError(f"Invalid response for scheduling query: {raw_response}")[0m
[30;1m443 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m        response: Dict[str, str] = json.loads(raw_response)[0m
[30;1m438 | [0m[35m        if not response or not isinstance(response, Dict) or len(response) != 3:[0m
[30;1m439 | [0m[35m            raise AssertionError(f"Invalid response for scheduling query : {response}")[0m
[30;1m440 | [0m[35m        return response.get("crontime"), response.get("query"), response.get("subject")[0m
[30;1m441 | [0m[35m    except Exception:[0m
[30;1m442 | [0m[35m        raise AssertionError(f"Invalid response for scheduling query: {raw_response}")[0m
[30;1m443 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:[0m
[30;1m206 | [0m[35m            chat_history += f"User: {chat['intent']['query']}\n"[0m
[30;1m207 | [0m[35m            chat_history += f"{agent_name}: {chat['message']}\n"[0m
[30;1m208 | [0m[35m        elif chat["by"] == "khoj" and ("text-to-image" in chat["intent"].get("type")):[0m
[30;1m209 | [0m[35m            chat_history += f"User: {chat['intent']['query']}\n"[0m
[30;1m210 | [0m[35m            chat_history += f"{agent_name}: [generated image redacted for space]\n"[0m
[30;1m211 | [0m[35m    return chat_history[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35mdef construct_chat_history(conversation_history: dict, n: int = 4, agent_name="AI") -> str:[0m
[30;1m203 | [0m[35m    chat_history = ""[0m
[30;1m204 | [0m[35m    for chat in conversation_history.get("chat", [])[-n:]:[0m
[30;1m205 | [0m[35m        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:[0m
[30;1m206 | [0m[35m            chat_history += f"User: {chat['intent']['query']}\n"[0m
[30;1m207 | [0m[35m            chat_history += f"{agent_name}: {chat['message']}\n"[0m
[30;1m208 | [0m[35m        elif chat["by"] == "khoj" and ("text-to-image" in chat["intent"].get("type")):[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35mdef construct_chat_history(conversation_history: dict, n: int = 4, agent_name="AI") -> str:[0m
[30;1m203 | [0m[35m    chat_history = ""[0m
[30;1m204 | [0m[35m    for chat in conversation_history.get("chat", [])[-n:]:[0m
[30;1m205 | [0m[35m        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:[0m
[30;1m206 | [0m[35m            chat_history += f"User: {chat['intent']['query']}\n"[0m
[30;1m207 | [0m[35m            chat_history += f"{agent_name}: {chat['message']}\n"[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35mdef get_next_url(request: Request) -> str:[0m
[30;1m191 | [0m[35m    "Construct next url relative to current domain from request"[0m
[30;1m192 | [0m[35m    next_url_param = urlparse(request.query_params.get("next", "/"))[0m
[30;1m193 | [0m[35m    next_path = "/"  # default next path[0m
[30;1m194 | [0m[35m    # If relative path or absolute path to current domain[0m
[30;1m195 | [0m[35m    if is_none_or_empty(next_url_param.scheme) or next_url_param.netloc == request.base_url.netloc:[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1203 | [0m[35m    # Disable minute level automation recurrence[0m
[30;1m1204 | [0m[35m    minute_value = crontime.split(" ")[0][0m
[30;1m1205 | [0m[35m    if not minute_value.isdigit():[0m
[30;1m1206 | [0m[35m        # Run automation at some random minute (to distribute request load) instead of running every[0m
[30;1m1207 | [0m[35m        crontime = " ".join([str(math.floor(random() * 60))] + crontime.split(" ")[1:])[0m
[30;1m1208 | [0m[35m[0m
[30;1m1209 | [0m[35m    user_timezone = pytz.timezone(timezone)[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1245 | [0m[35m[0m
[30;1m1246 | [0m[35m[0m
[30;1m1247 | [0m[35mdef construct_automation_created_message(automation: Job, crontime: str, query_to_run: str, subject:[0m
[30;1m1248 | [0m[35m    # Display next run time in user timezone instead of UTC[0m
[30;1m1249 | [0m[35m    schedule = f'{cron_descriptor.get_description(crontime)} {automation.next_run_time.strftime("%Z"[0m
[30;1m1250 | [0m[35m    next_run_time = automation.next_run_time.strftime("%Y-%m-%d %I:%M %p %Z")[0m
[30;1m1251 | [0m[35m    # Remove /automated_task prefix from inferred_query[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1122 | [0m[35m[0m
[30;1m1123 | [0m[35m            # If the last run time was within the last 6 hours, don't run it again. This helps avoid[0m
[30;1m1124 | [0m[35m            if (datetime.now(timezone.utc) - last_run_time).total_seconds() < 21600:[0m
[30;1m1125 | [0m[35m                logger.info(f"Skipping scheduled chat {job_id} as the next run time is in the future[0m
[30;1m1126 | [0m[35m                return[0m
[30;1m1127 | [0m[35m[0m
[30;1m1128 | [0m[35m    # Extract relevant params from the original URL[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1120 | [0m[35m        if last_run_time:[0m
[30;1m1121 | [0m[35m            last_run_time = datetime.strptime(last_run_time, "%Y-%m-%d %I:%M %p %Z").replace(tzinfo=[0m
[30;1m1122 | [0m[35m[0m
[30;1m1123 | [0m[35m            # If the last run time was within the last 6 hours, don't run it again. This helps avoid[0m
[30;1m1124 | [0m[35m            if (datetime.now(timezone.utc) - last_run_time).total_seconds() < 21600:[0m
[30;1m1125 | [0m[35m                logger.info(f"Skipping scheduled chat {job_id} as the next run time is in the future[0m
[30;1m1126 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1112 | [0m[35m):[0m
[30;1m1113 | [0m[35m    logger.info(f"Processing scheduled_chat: {query_to_run}")[0m
[30;1m1114 | [0m[35m    if job_id:[0m
[30;1m1115 | [0m[35m        # Get the job object and check whether the time is valid for it to run. This helps avoid rac[0m
[30;1m1116 | [0m[35m        job = AutomationAdapters.get_automation(user, job_id)[0m
[30;1m1117 | [0m[35m        last_run_time = AutomationAdapters.get_job_last_run(user, job)[0m
[30;1m1118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m986 | [0m[35m        user: KhojUser = request.user.object[0m
[30;1m987 | [0m[35m        subscribed = has_required_scope(request, ["premium"])[0m
[30;1m988 | [0m[35m[0m
[30;1m989 | [0m[35m        # Remove requests outside of the 24-hr time window[0m
[30;1m990 | [0m[35m        cutoff = datetime.now(tz=timezone.utc) - timedelta(seconds=60 * 60 * 24)[0m
[30;1m991 | [0m[35m        command_slug = f"{self.slug}_{conversation_command.value}"[0m
[30;1m992 | [0m[35m        count_requests = await UserRequests.objects.filter([0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m944 | [0m[35m        user: KhojUser = request.user.object[0m
[30;1m945 | [0m[35m        subscribed = has_required_scope(request, ["premium"])[0m
[30;1m946 | [0m[35m[0m
[30;1m947 | [0m[35m        # Remove requests outside of the time window[0m
[30;1m948 | [0m[35m        cutoff = datetime.now(tz=timezone.utc) - timedelta(seconds=self.window)[0m
[30;1m949 | [0m[35m        count_requests = UserRequests.objects.filter(user=user, created_at__gte=cutoff, slug=self.sl[0m
[30;1m950 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m420 | [0m[35m[0m
[30;1m421 | [0m[35masync def schedule_query(q: str, conversation_history: dict) -> Tuple[str, ...]:[0m
[30;1m422 | [0m[35m    """[0m
[30;1m423 | [0m[35m    Schedule the date, time to run the query. Assume the server timezone is UTC.[0m
[30;1m424 | [0m[35m    """[0m
[30;1m425 | [0m[35m    chat_history = construct_chat_history(conversation_history)[0m
[30;1m426 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport hashlib[0m
[30;1m4 | [0m[35mimport io[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35mapi_agents = APIRouter()[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m@api_agents.get("", response_class=Response)[0m
[30;1m20 | [0m[35masync def all_agents([0m
[30;1m21 | [0m[35m    request: Request,[0m
[30;1m22 | [0m[35m    common: CommonQueryParams,[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_phone.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    return {"status": "ok"}[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m@api_phone.post("/verify", status_code=200)[0m
[30;1m63 | [0m[35m@requires(["authenticated"])[0m
[30;1m64 | [0m[35masync def verify_mobile_otp([0m
[30;1m65 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_phone.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m@api_phone.post("", status_code=200)[0m
[30;1m17 | [0m[35m@requires(["authenticated"])[0m
[30;1m18 | [0m[35masync def update_phone_number([0m
[30;1m19 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/jsonl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m40 | [0m[35m    with gzip.open(output_path, "wt", encoding="utf-8") as gzip_file:[0m
[30;1m41 | [0m[35m        gzip_file.write(jsonl_data)[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    logger.debug(f"Wrote jsonl data to gzip compressed jsonl at {output_path}")[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/email.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m    template = env.get_template("task.html")[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    if is_image:[0m
[30;1m120 | [0m[35m        image = result.get("image")[0m
[30;1m121 | [0m[35m        result = f"![{subject}]({image})"[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    html_result = markdown_it.MarkdownIt().render(result)[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/email.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mRESEND_AUDIENCE_ID = os.getenv("RESEND_AUDIENCE_ID")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mstatic_files = os.path.join(settings.BASE_DIR, "static")[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35menv = Environment(loader=FileSystemLoader(static_files))[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mif not RESEND_API_KEY:[0m
[30;1m28 | [0m[35m    logger.warn("RESEND_API_KEY not set - email sending disabled")[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_chat_default_model_2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35mdef migrate_offline_chat_default_model(args):[0m
[30;1m42 | [0m[35m    schema_version = "1.7.0"[0m
[30;1m43 | [0m[35m    raw_config = load_config_from_file(args.config_file)[0m
[30;1m44 | [0m[35m    previous_version = raw_config.get("version")[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    if "processor" not in raw_config:[0m
[30;1m47 | [0m[35m        return args[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_chat_default_model_2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m60 | [0m[35m        )[0m
[30;1m61 | [0m[35m        raw_config["version"] = schema_version[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # Update offline chat model to use Nous Research's Hermes-2-Pro GGUF in path format suitable[0m
[30;1m64 | [0m[35m        offline_chat_model = raw_config["processor"]["conversation"]["offline-chat"]["chat-model"][0m
[30;1m65 | [0m[35m        if offline_chat_model == "mistral-7b-instruct-v0.1.Q4_0.gguf":[0m
[30;1m66 | [0m[35m            raw_config["processor"]["conversation"]["offline-chat"][[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m    return {"status": "ok"}[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m@api_model.post("/paint", status_code=200)[0m
[30;1m131 | [0m[35m@requires(["authenticated"])[0m
[30;1m132 | [0m[35masync def update_paint_model([0m
[30;1m133 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m    return Response(status_code=202, content=json.dumps({"status": "ok"}))[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m@api_model.post("/search", status_code=200)[0m
[30;1m98 | [0m[35m@requires(["authenticated"])[0m
[30;1m99 | [0m[35masync def update_search_model([0m
[30;1m100 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m    return {"status": "ok"}[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m@api_model.post("/voice", status_code=200)[0m
[30;1m74 | [0m[35m@requires(["authenticated", "premium"])[0m
[30;1m75 | [0m[35masync def update_voice_model([0m
[30;1m76 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    return Response(status_code=200, content=json.dumps({"id": chat_model.id, "chat_model": chat_mod[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m@api_model.post("/chat", status_code=200)[0m
[30;1m49 | [0m[35m@requires(["authenticated", "premium"])[0m
[30;1m50 | [0m[35masync def update_chat_model([0m
[30;1m51 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m    return Response(content=json.dumps(all_conversation_options), media_type="application/json", sta[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m@api_model.get("/chat")[0m
[30;1m33 | [0m[35m@requires(["authenticated"])[0m
[30;1m34 | [0m[35mdef get_user_chat_model([0m
[30;1m35 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m@api_model.get("/chat/options", response_model=Dict[str, Union[str, int]])[0m
[30;1m19 | [0m[35mdef get_chat_model_options([0m
[30;1m20 | [0m[35m    request: Request,[0m
[30;1m21 | [0m[35m    client: Optional[str] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    )[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m@web_client.get("/automations", response_class=HTMLResponse)[0m
[30;1m149 | [0m[35mdef automations_config_page([0m
[30;1m150 | [0m[35m    request: Request,[0m
[30;1m151 | [0m[35m):[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m    return templates.TemplateResponse("content_source_github_input.html", context=user_config)[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m@web_client.get("/share/chat/{public_conversation_slug}", response_class=HTMLResponse)[0m
[30;1m139 | [0m[35mdef view_public_conversation(request: Request):[0m
[30;1m140 | [0m[35m    return templates.TemplateResponse([0m
[30;1m141 | [0m[35m        "share/chat/index.html",[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m    return templates.TemplateResponse("settings/index.html", context={"request": request})[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m@web_client.get("/settings/content/github", response_class=HTMLResponse)[0m
[30;1m109 | [0m[35m@requires(["authenticated"], redirect="login_page")[0m
[30;1m110 | [0m[35mdef github_config_page(request: Request):[0m
[30;1m111 | [0m[35m    user = request.user.object[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m    )[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m@web_client.get("/settings", response_class=HTMLResponse)[0m
[30;1m103 | [0m[35m@requires(["authenticated"], redirect="login_page")[0m
[30;1m104 | [0m[35mdef config_page(request: Request):[0m
[30;1m105 | [0m[35m    return templates.TemplateResponse("settings/index.html", context={"request": request})[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    )[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m@web_client.get("/agents", response_class=HTMLResponse)[0m
[30;1m93 | [0m[35mdef agents_page(request: Request):[0m
[30;1m94 | [0m[35m    return templates.TemplateResponse([0m
[30;1m95 | [0m[35m        "agents/index.html",[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    next_url = get_next_url(request)[0m
[30;1m78 | [0m[35m    if request.user.is_authenticated:[0m
[30;1m79 | [0m[35m        return RedirectResponse(url=next_url)[0m
[30;1m80 | [0m[35m    google_client_id = os.environ.get("GOOGLE_CLIENT_ID")[0m
[30;1m81 | [0m[35m    redirect_uri = str(request.app.url_path_for("auth"))[0m
[30;1m82 | [0m[35m    return templates.TemplateResponse([0m
[30;1m83 | [0m[35m        "login.html",[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    )[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m@web_client.get("/login", response_class=FileResponse)[0m
[30;1m76 | [0m[35mdef login_page(request: Request):[0m
[30;1m77 | [0m[35m    next_url = get_next_url(request)[0m
[30;1m78 | [0m[35m    if request.user.is_authenticated:[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m    )[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m@web_client.get("/factchecker", response_class=FileResponse)[0m
[30;1m66 | [0m[35mdef fact_checker_page(request: Request):[0m
[30;1m67 | [0m[35m    return templates.TemplateResponse([0m
[30;1m68 | [0m[35m        "factchecker/index.html",[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m    )[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m@web_client.get("/experimental", response_class=FileResponse)[0m
[30;1m55 | [0m[35m@requires(["authenticated"], redirect="login_page")[0m
[30;1m56 | [0m[35mdef experimental_page(request: Request):[0m
[30;1m57 | [0m[35m    return templates.TemplateResponse([0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m    )[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m@web_client.get("/chat", response_class=FileResponse)[0m
[30;1m44 | [0m[35m@requires(["authenticated"], redirect="login_page")[0m
[30;1m45 | [0m[35mdef chat_page(request: Request):[0m
[30;1m46 | [0m[35m    return templates.TemplateResponse([0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m    return templates.TemplateResponse("index.html", context={"request": request})[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m@web_client.get("/search", response_class=FileResponse)[0m
[30;1m33 | [0m[35m@requires(["authenticated"], redirect="login_page")[0m
[30;1m34 | [0m[35mdef search_page(request: Request):[0m
[30;1m35 | [0m[35m    return templates.TemplateResponse([0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m    return templates.TemplateResponse("index.html", context={"request": request})[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m@web_client.post("/", response_class=FileResponse)[0m
[30;1m27 | [0m[35m@requires(["authenticated"], redirect="login_page")[0m
[30;1m28 | [0m[35mdef index_post(request: Request):[0m
[30;1m29 | [0m[35m    return templates.TemplateResponse("index.html", context={"request": request})[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/web_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# Create Routes[0m
[30;1m21 | [0m[35m@web_client.get("/", response_class=FileResponse)[0m
[30;1m22 | [0m[35mdef index(request: Request):[0m
[30;1m23 | [0m[35m    return templates.TemplateResponse("index.html", context={"request": request})[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_chat_default_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35mdef migrate_offline_chat_default_model(args):[0m
[30;1m42 | [0m[35m    schema_version = "0.12.4"[0m
[30;1m43 | [0m[35m    raw_config = load_config_from_file(args.config_file)[0m
[30;1m44 | [0m[35m    previous_version = raw_config.get("version")[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    if "processor" not in raw_config:[0m
[30;1m47 | [0m[35m        return args[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_chat_default_model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m60 | [0m[35m        )[0m
[30;1m61 | [0m[35m        raw_config["version"] = schema_version[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # Update offline chat model to mistral in GGUF format to use latest GPT4All[0m
[30;1m64 | [0m[35m        offline_chat_model = raw_config["processor"]["conversation"]["offline-chat"]["chat-model"][0m
[30;1m65 | [0m[35m        if offline_chat_model.endswith(".bin"):[0m
[30;1m66 | [0m[35m            raw_config["processor"]["conversation"]["offline-chat"]["chat-model"] = "mistral-7b-inst[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/rawconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m            compiled=dictionary["compiled"],[0m
[30;1m162 | [0m[35m            file=dictionary.get("file", None),[0m
[30;1m163 | [0m[35m            heading=dictionary.get("heading", None),[0m
[30;1m164 | [0m[35m            corpus_id=dictionary.get("corpus_id", None),[0m
[30;1m165 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/rawconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m            raw=dictionary["raw"],[0m
[30;1m161 | [0m[35m            compiled=dictionary["compiled"],[0m
[30;1m162 | [0m[35m            file=dictionary.get("file", None),[0m
[30;1m163 | [0m[35m            heading=dictionary.get("heading", None),[0m
[30;1m164 | [0m[35m            corpus_id=dictionary.get("corpus_id", None),[0m
[30;1m165 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/rawconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m        return cls([0m
[30;1m160 | [0m[35m            raw=dictionary["raw"],[0m
[30;1m161 | [0m[35m            compiled=dictionary["compiled"],[0m
[30;1m162 | [0m[35m            file=dictionary.get("file", None),[0m
[30;1m163 | [0m[35m            heading=dictionary.get("heading", None),[0m
[30;1m164 | [0m[35m            corpus_id=dictionary.get("corpus_id", None),[0m
[30;1m165 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/assets/utils.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35mI am ‚ú®Khoj‚ú®, your open-source, personal AI copilot.[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mSee my source code at https://github.com/khoj-ai/khoj[0m
[30;1m32 | [0m[35mRead my operating manual at https://docs.khoj.dev[0m
[30;1m33 | [0m[35m`);[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/assets/utils.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mI am ‚ú®Khoj‚ú®, your open-source, personal AI copilot.[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mSee my source code at https://github.com/khoj-ai/khoj[0m
[30;1m32 | [0m[35mRead my operating manual at https://docs.khoj.dev[0m
[30;1m33 | [0m[35m`);[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_type/text_search.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35m    with timer("Rank Time", logger, state.device):[0m
[30;1m239 | [0m[35m        hits.sort(key=lambda x: x["score"])  # sort by bi-encoder score[0m
[30;1m240 | [0m[35m        if rank_results:[0m
[30;1m241 | [0m[35m            hits.sort(key=lambda x: x["cross_score"])  # sort by cross-encoder score[0m
[30;1m242 | [0m[35m    return hits[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_type/text_search.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m236 | [0m[35mdef sort_results(rank_results: bool, hits: List[dict]) -> List[dict]:[0m
[30;1m237 | [0m[35m    """Order results by cross-encoder score followed by bi-encoder score"""[0m
[30;1m238 | [0m[35m    with timer("Rank Time", logger, state.device):[0m
[30;1m239 | [0m[35m        hits.sort(key=lambda x: x["score"])  # sort by bi-encoder score[0m
[30;1m240 | [0m[35m        if rank_results:[0m
[30;1m241 | [0m[35m            hits.sort(key=lambda x: x["cross_score"])  # sort by cross-encoder score[0m
[30;1m242 | [0m[35m    return hits[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_type/text_search.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m    if rank_results:[0m
[30;1m190 | [0m[35m        hits = cross_encoder_score(query, hits, search_model_name)[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    # Sort results by cross-encoder score followed by bi-encoder score[0m
[30;1m193 | [0m[35m    hits = sort_results(rank_results=rank_results, hits=hits)[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m    return hits[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_type/text_search.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m            search_model = await sync_to_async(get_user_search_model_or_default)(user)[0m
[30;1m115 | [0m[35m            question_embedding = state.embeddings_model[search_model.name].embed_query(query)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    # Find relevant entries for the query[0m
[30;1m118 | [0m[35m    top_k = 10[0m
[30;1m119 | [0m[35m    with timer("Search Time", logger, state.device):[0m
[30;1m120 | [0m[35m        hits = EntryAdapters.search_with_embeddings([0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_type/text_search.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m86 | [0m[35mdef load_embeddings([0m
[30;1m87 | [0m[35m    embeddings_file: Path,[0m
[30;1m88 | [0m[35m):[0m
[30;1m89 | [0m[35m    "Load pre-computed embeddings from file if exists and update them if required"[0m
[30;1m90 | [0m[35m    if embeddings_file.exists():[0m
[30;1m91 | [0m[35m        corpus_embeddings: torch.Tensor = torch.load(get_absolute_path(embeddings_file), map_locatio[0m
[30;1m92 | [0m[35m        logger.debug(f"Loaded {len(corpus_embeddings)} text embeddings from {embeddings_file}")[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_type/text_search.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m        corpus_embeddings = torch.tensor([], device=state.device)[0m
[30;1m56 | [0m[35m        create_index_msg = " Creating index from scratch."[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    # Encode any new entries in the corpus and update corpus embeddings[0m
[30;1m59 | [0m[35m    new_entries = [entry.compiled for id, entry in entries_with_ids if id == -1][0m
[30;1m60 | [0m[35m    if new_entries:[0m
[30;1m61 | [0m[35m        logger.info(f"üì© Indexing {len(new_entries)} text entries.{create_index_msg}")[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_type/text_search.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m47 | [0m[35m    new_embeddings = torch.tensor([], device=state.device)[0m
[30;1m48 | [0m[35m    existing_embeddings = torch.tensor([], device=state.device)[0m
[30;1m49 | [0m[35m    create_index_msg = ""[0m
[30;1m50 | [0m[35m    # Load pre-computed embeddings from file if exists and update them if required[0m
[30;1m51 | [0m[35m    if embeddings_file.exists() and not regenerate:[0m
[30;1m52 | [0m[35m        corpus_embeddings: torch.Tensor = torch.load(get_absolute_path(embeddings_file), map_locatio[0m
[30;1m53 | [0m[35m        logger.debug(f"Loaded {len(corpus_embeddings)} text embeddings from {embeddings_file}")[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m    if telemetry_disabled(app_config):[0m
[30;1m254 | [0m[35m        return [][0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    if properties.get("server_id") is None:[0m
[30;1m257 | [0m[35m        properties["server_id"] = get_server_id()[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m    # Populate telemetry data to log[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35mmode_descriptions_for_llm = {[0m
[30;1m337 | [0m[35m    ConversationCommand.Image: "Use this if the user is requesting an image or visual response to th[0m
[30;1m338 | [0m[35m    ConversationCommand.Automation: "Use this if the user is requesting a response at a scheduled da[0m
[30;1m339 | [0m[35m    ConversationCommand.Text: "Use this if the other response modes don't seem to fit the query.",[0m
[30;1m340 | [0m[35m}[0m
[30;1m341 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m319 | [0m[35m    ConversationCommand.Online: "Search for information on the internet.",[0m
[30;1m320 | [0m[35m    ConversationCommand.Webpage: "Get information from webpage links provided by you.",[0m
[30;1m321 | [0m[35m    ConversationCommand.Image: "Generate images by describing your imagination in words.",[0m
[30;1m322 | [0m[35m    ConversationCommand.Automation: "Automatically run your query at a specified time or interval.",[0m
[30;1m323 | [0m[35m    ConversationCommand.Help: "Get help with how to use or setup Khoj from the documentation",[0m
[30;1m324 | [0m[35m    ConversationCommand.Summarize: "Create an appropriate summary using provided documents.",[0m
[30;1m325 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m200 | [0m[35m    Maintains anonymity by using non-PII random id."""[0m
[30;1m201 | [0m[35m    # Initialize server_id to None[0m
[30;1m202 | [0m[35m    server_id = None[0m
[30;1m203 | [0m[35m    # Expand path to the khoj env file. It contains persistent internal app data[0m
[30;1m204 | [0m[35m    app_env_filename = path.expanduser(constants.app_env_filepath)[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    # Check if the file exists[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m319 | [0m[35m    ConversationCommand.Online: "Search for information on the internet.",[0m
[30;1m320 | [0m[35m    ConversationCommand.Webpage: "Get information from webpage links provided by you.",[0m
[30;1m321 | [0m[35m    ConversationCommand.Image: "Generate images by describing your imagination in words.",[0m
[30;1m322 | [0m[35m    ConversationCommand.Automation: "Automatically run your query at a specified time or interval.",[0m
[30;1m323 | [0m[35m    ConversationCommand.Help: "Get help with how to use or setup Khoj from the documentation",[0m
[30;1m324 | [0m[35m    ConversationCommand.Summarize: "Create an appropriate summary using provided documents.",[0m
[30;1m325 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m        # Create khoj config directory if it doesn't exist[0m
[30;1m231 | [0m[35m        os.makedirs(path.dirname(app_env_filename), exist_ok=True)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        # Write the server_id to the env file[0m
[30;1m234 | [0m[35m        with open(app_env_filename, "w") as f:[0m
[30;1m235 | [0m[35m            f.write("server_id=" + server_id + "\n")[0m
[30;1m236 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m                server_id = value.strip()[0m
[30;1m217 | [0m[35m                break[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        # If server_id is not found, generate and write to env file[0m
[30;1m220 | [0m[35m        if server_id is None:[0m
[30;1m221 | [0m[35m            # If server_id is not found, generate a new one[0m
[30;1m222 | [0m[35m            server_id = str(uuid.uuid4())[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m    Maintains anonymity by using non-PII random id."""[0m
[30;1m201 | [0m[35m    # Initialize server_id to None[0m
[30;1m202 | [0m[35m    server_id = None[0m
[30;1m203 | [0m[35m    # Expand path to the khoj env file. It contains persistent internal app data[0m
[30;1m204 | [0m[35m    app_env_filename = path.expanduser(constants.app_env_filepath)[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    # Check if the file exists[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m    Maintains anonymity by using non-PII random id."""[0m
[30;1m201 | [0m[35m    # Initialize server_id to None[0m
[30;1m202 | [0m[35m    server_id = None[0m
[30;1m203 | [0m[35m    # Expand path to the khoj env file. It contains persistent internal app data[0m
[30;1m204 | [0m[35m    app_env_filename = path.expanduser(constants.app_env_filepath)[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    # Check if the file exists[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35mclass timer:[0m
[30;1m161 | [0m[35m    """Context manager to log time taken for a block of code to run"""[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    def __init__(self, message: str, logger: logging.Logger, device: torch.device = None):[0m
[30;1m164 | [0m[35m        self.message = message[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mfrom itertools import islice[0m
[30;1m14 | [0m[35mfrom os import path[0m
[30;1m15 | [0m[35mfrom pathlib import Path[0m
[30;1m16 | [0m[35mfrom time import perf_counter[0m
[30;1m17 | [0m[35mfrom typing import TYPE_CHECKING, Optional, Union[0m
[30;1m18 | [0m[35mfrom urllib.parse import urlparse[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/embeddings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m            target_url = f"{self.inference_endpoint}"[0m
[30;1m112 | [0m[35m            payload = {"inputs": {"query": query, "passages": [hit.additional[key] for hit in hits]}[0m
[30;1m113 | [0m[35m            headers = {"Authorization": f"Bearer {self.api_key}", "Content-Type": "application/json"[0m
[30;1m114 | [0m[35m            response = requests.post(target_url, json=payload, headers=headers)[0m
[30;1m115 | [0m[35m            return response.json()["scores"][0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        cross_inp = [[query, hit.additional[key]] for hit in hits][0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/embeddings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m            "Content-Type": "application/json",[0m
[30;1m61 | [0m[35m        }[0m
[30;1m62 | [0m[35m        try:[0m
[30;1m63 | [0m[35m            response = requests.post(self.inference_endpoint, json=payload, headers=headers)[0m
[30;1m64 | [0m[35m            response.raise_for_status()[0m
[30;1m65 | [0m[35m        except requests.exceptions.HTTPError as e:[0m
[30;1m66 | [0m[35m            logger.error([0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m            )[0m
[30;1m78 | [0m[35m            openai_chat_model = openai_chat_model or default_online_chat_model[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m            default_max_tokens = model_to_prompt_size.get(openai_chat_model, 2000)[0m
[30;1m81 | [0m[35m            max_tokens = input([0m
[30;1m82 | [0m[35m                f"Enter the maximum number of tokens to use for the OpenAI chat model (default: {def[0m
[30;1m83 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m                    )[0m
[30;1m50 | [0m[35m                    max_tokens = max_tokens or default_max_tokens[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m                    default_tokenizer = model_to_tokenizer.get([0m
[30;1m53 | [0m[35m                        offline_chat_model, "hf-internal-testing/llama-tokenizer"[0m
[30;1m54 | [0m[35m                    )[0m
[30;1m55 | [0m[35m                    tokenizer = input([0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m                        chat_model=default_offline_chat_model, model_type=ChatModelOptions.ModelType[0m
[30;1m44 | [0m[35m                    )[0m
[30;1m45 | [0m[35m                else:[0m
[30;1m46 | [0m[35m                    default_max_tokens = model_to_prompt_size.get(offline_chat_model, 2000)[0m
[30;1m47 | [0m[35m                    max_tokens = input([0m
[30;1m48 | [0m[35m                        f"Enter the maximum number of tokens to use for the offline chat model (defa[0m
[30;1m49 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    def _create_chat_configuration():[0m
[30;1m29 | [0m[35m        logger.info([0m
[30;1m30 | [0m[35m            "üó£Ô∏è  Configure chat models available to your server. You can always update these at /se[0m
[30;1m31 | [0m[35m        )[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    def _create_chat_configuration():[0m
[30;1m29 | [0m[35m        logger.info([0m
[30;1m30 | [0m[35m            "üó£Ô∏è  Configure chat models available to your server. You can always update these at /se[0m
[30;1m31 | [0m[35m        )[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/utils/initialization.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m18 | [0m[35mdef initialization():[0m
[30;1m19 | [0m[35m    def _create_admin_user():[0m
[30;1m20 | [0m[35m        logger.info([0m
[30;1m21 | [0m[35m            "üë©‚Äç‚úàÔ∏è Setting up admin user. These credentials will allow you to configure your server [0m
[30;1m22 | [0m[35m        )[0m
[30;1m23 | [0m[35m        email_addr = os.getenv("KHOJ_ADMIN_EMAIL") or input("Email: ")[0m
[30;1m24 | [0m[35m        password = os.getenv("KHOJ_ADMIN_PASSWORD") or input("Password: ")[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m655 | [0m[35m    automation_metadata["query_to_run"] = query_to_run[0m
[30;1m656 | [0m[35m    automation_metadata["subject"] = subject.strip()[0m
[30;1m657 | [0m[35m    automation_metadata["crontime"] = crontime[0m
[30;1m658 | [0m[35m    conversation_id = automation_metadata.get("conversation_id")[0m
[30;1m659 | [0m[35m[0m
[30;1m660 | [0m[35m    if not conversation_id:[0m
[30;1m661 | [0m[35m        title = f"Automation: {subject}"[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m575 | [0m[35m    return Response(content=json.dumps(automation_info), media_type="application/json", status_code=[0m
[30;1m576 | [0m[35m[0m
[30;1m577 | [0m[35m[0m
[30;1m578 | [0m[35m@api.post("/trigger/automation", response_class=Response)[0m
[30;1m579 | [0m[35m@requires(["authenticated"])[0m
[30;1m580 | [0m[35mdef trigger_manual_job([0m
[30;1m581 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m    return Response(content=json.dumps(automation_info), media_type="application/json", status_code=[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m[0m
[30;1m504 | [0m[35m@api.post("/automation", response_class=Response)[0m
[30;1m505 | [0m[35m@requires(["authenticated"])[0m
[30;1m506 | [0m[35masync def post_automation([0m
[30;1m507 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m    return Response(content=json.dumps(user_info), media_type="application/json", status_code=200)[0m
[30;1m476 | [0m[35m[0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m@api.get("/automations", response_class=Response)[0m
[30;1m479 | [0m[35m@requires(["authenticated"])[0m
[30;1m480 | [0m[35mdef get_automations(request: Request) -> Response:[0m
[30;1m481 | [0m[35m    user: KhojUser = request.user.object[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m453 | [0m[35m    return Response(content=json.dumps(response_obj), media_type="application/json", status_code=200[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m[0m
[30;1m456 | [0m[35m@api.get("/v1/user", response_class=Response)[0m
[30;1m457 | [0m[35m@requires(["authenticated"])[0m
[30;1m458 | [0m[35mdef user_info(request: Request) -> Response:[0m
[30;1m459 | [0m[35m    # Get user information[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m    yield compiled_references, inferred_queries, defiltered_query[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m[0m
[30;1m449 | [0m[35m@api.get("/health", response_class=Response)[0m
[30;1m450 | [0m[35m@requires(["authenticated"], status_code=200)[0m
[30;1m451 | [0m[35mdef health_check(request: Request) -> Response:[0m
[30;1m452 | [0m[35m    response_obj = {"email": request.user.object.email}[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m    return Response(content=content, media_type="application/json", status_code=200)[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m@api.get("/settings", response_class=Response)[0m
[30;1m283 | [0m[35m@requires(["authenticated"])[0m
[30;1m284 | [0m[35mdef get_settings(request: Request, detailed: Optional[bool] = False) -> Response:[0m
[30;1m285 | [0m[35m    user = request.user.object[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m    return {"status": "ok", "message": "khoj reloaded"}[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m@api.post("/transcribe")[0m
[30;1m222 | [0m[35m@requires(["authenticated"])[0m
[30;1m223 | [0m[35masync def transcribe([0m
[30;1m224 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m    return results[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m@api.get("/update")[0m
[30;1m186 | [0m[35m@requires(["authenticated"])[0m
[30;1m187 | [0m[35mdef update([0m
[30;1m188 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m@api.get("/search", response_model=List[SearchResponse])[0m
[30;1m67 | [0m[35m@requires(["authenticated"])[0m
[30;1m68 | [0m[35masync def search([0m
[30;1m69 | [0m[35m    q: str,[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m198 | [0m[35m    try:[0m
[30;1m199 | [0m[35m        initialize_content(regenerate=force, search_type=t, user=user)[0m
[30;1m200 | [0m[35m    except Exception as e:[0m
[30;1m201 | [0m[35m        error_msg = f"üö® Failed to update server via API: {e}"[0m
[30;1m202 | [0m[35m        logger.error(error_msg, exc_info=True)[0m
[30;1m203 | [0m[35m        raise HTTPException(status_code=500, detail=error_msg)[0m
[30;1m204 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m167 | [0m[35m                # Collate results[0m
[30;1m168 | [0m[35m                results += text_search.collate_results(hits, dedupe=dedupe)[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m                # Sort results across all content types and take top results[0m
[30;1m171 | [0m[35m                results = text_search.rerank_and_sort_results([0m
[30;1m172 | [0m[35m                    results, query=defiltered_query, rank_results=r, search_model_name=search_model.[0m
[30;1m173 | [0m[35m                )[:results_count][0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m167 | [0m[35m                # Collate results[0m
[30;1m168 | [0m[35m                results += text_search.collate_results(hits, dedupe=dedupe)[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m                # Sort results across all content types and take top results[0m
[30;1m171 | [0m[35m                results = text_search.rerank_and_sort_results([0m
[30;1m172 | [0m[35m                    results, query=defiltered_query, rank_results=r, search_model_name=search_model.[0m
[30;1m173 | [0m[35m                )[:results_count][0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport math[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mimport threading[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mimport uuid[0m
[30;1m9 | [0m[35mfrom typing import Any, Callable, List, Optional, Union[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport cron_descriptor[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_chat_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m            .get("chat-model", "llama-2-7b-chat.ggmlv3.q4_0.bin")[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m        raw_config["processor"]["conversation"]["offline-chat"] = {[0m
[30;1m74 | [0m[35m            "enable-offline-chat": raw_config["processor"]["conversation"].get("enable-offline-chat"[0m
[30;1m75 | [0m[35m            "chat-model": offline_chat_model,[0m
[30;1m76 | [0m[35m        }[0m
[30;1m77 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_chat_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        offline_chat_model = ([0m
[30;1m69 | [0m[35m            raw_config["processor"]["conversation"][0m
[30;1m70 | [0m[35m            .get("offline-chat", {})[0m
[30;1m71 | [0m[35m            .get("chat-model", "llama-2-7b-chat.ggmlv3.q4_0.bin")[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m        raw_config["processor"]["conversation"]["offline-chat"] = {[0m
[30;1m74 | [0m[35m            "enable-offline-chat": raw_config["processor"]["conversation"].get("enable-offline-chat"[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_chat_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        # Create offline chat schema based on existing enable_offline_chat field in khoj config sche[0m
[30;1m68 | [0m[35m        offline_chat_model = ([0m
[30;1m69 | [0m[35m            raw_config["processor"]["conversation"][0m
[30;1m70 | [0m[35m            .get("offline-chat", {})[0m
[30;1m71 | [0m[35m            .get("chat-model", "llama-2-7b-chat.ggmlv3.q4_0.bin")[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m        raw_config["processor"]["conversation"]["offline-chat"] = {[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_chat_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35mdef migrate_offline_chat_schema(args):[0m
[30;1m46 | [0m[35m    schema_version = "0.12.3"[0m
[30;1m47 | [0m[35m    raw_config = load_config_from_file(args.config_file)[0m
[30;1m48 | [0m[35m    previous_version = raw_config.get("version")[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    if "processor" not in raw_config:[0m
[30;1m51 | [0m[35m        return args[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/main.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m153 | [0m[35m        {[0m
[30;1m154 | [0m[35m            "apscheduler.timezone": "UTC",[0m
[30;1m155 | [0m[35m            "apscheduler.job_defaults.misfire_grace_time": "60",  # Useful to run scheduled jobs eve[0m
[30;1m156 | [0m[35m            "apscheduler.job_defaults.coalesce": "true",  # Combine multiple jobs into one if they a[0m
[30;1m157 | [0m[35m        }[0m
[30;1m158 | [0m[35m    )[0m
[30;1m159 | [0m[35m    state.scheduler.add_jobstore(DjangoJobStore(), "default")[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/main.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m    # Start Server[0m
[30;1m181 | [0m[35m    configure_routes(app)[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    #  Mount Django and Static Files[0m
[30;1m184 | [0m[35m    app.mount("/server", django_app, name="server")[0m
[30;1m185 | [0m[35m    static_dir = os.path.join(os.path.dirname(os.path.abspath(__file__)), "static")[0m
[30;1m186 | [0m[35m    if not os.path.exists(static_dir):[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/main.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m        {[0m
[30;1m154 | [0m[35m            "apscheduler.timezone": "UTC",[0m
[30;1m155 | [0m[35m            "apscheduler.job_defaults.misfire_grace_time": "60",  # Useful to run scheduled jobs eve[0m
[30;1m156 | [0m[35m            "apscheduler.job_defaults.coalesce": "true",  # Combine multiple jobs into one if they a[0m
[30;1m157 | [0m[35m        }[0m
[30;1m158 | [0m[35m    )[0m
[30;1m159 | [0m[35m    state.scheduler.add_jobstore(DjangoJobStore(), "default")[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m# syntax details.[0m
[30;1m189 | [0m[35mAPSCHEDULER_DATETIME_FORMAT = "N j, Y, f:s a"[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m# Maximum run time allowed for jobs that are triggered manually via the Django admin site, which[0m
[30;1m192 | [0m[35m# prevents admin site HTTP requests from timing out.[0m
[30;1m193 | [0m[35m#[0m
[30;1m194 | [0m[35m# Longer running jobs should probably be handed over to a background task processing library[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/settings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35mDEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m# Format string for displaying run time timestamps in the Django admin site. The default[0m
[30;1m184 | [0m[35m# just adds seconds to the standard Django format, which is useful for displaying the timestamps[0m
[30;1m185 | [0m[35m# for jobs that are scheduled to run on intervals of less than one minute.[0m
[30;1m186 | [0m[35m#[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_filter/date_filter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m197 | [0m[35m        return self.date_to_daterange(parsed_date, date_str)[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    def date_to_daterange(self, parsed_date, date_str):[0m
[30;1m200 | [0m[35m        "Convert parsed date to date ranges at natural granularity (day, week, month or year)"[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m        start_of_day = parsed_date.replace(hour=0, minute=0, second=0, microsecond=0)[0m
[30;1m203 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/search_filter/date_filter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m        return query[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    def extract_date_range(self, query):[0m
[30;1m121 | [0m[35m        # find date range filter in query[0m
[30;1m122 | [0m[35m        date_range_matches = re.findall(self.date_regex, query)[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        if len(date_range_matches) == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/offline/chat_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m    if streaming:[0m
[30;1m256 | [0m[35m        return response[0m
[30;1m257 | [0m[35m    else:[0m
[30;1m258 | [0m[35m        return response["choices"][0]["message"].get("content", "")[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/offline/chat_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m            messages, loaded_model=model, stop=stop_phrases, max_prompt_size=max_prompt_size, stream[0m
[30;1m232 | [0m[35m        )[0m
[30;1m233 | [0m[35m        for response in response_iterator:[0m
[30;1m234 | [0m[35m            g.send(response["choices"][0]["delta"].get("content", ""))[0m
[30;1m235 | [0m[35m    finally:[0m
[30;1m236 | [0m[35m        state.chat_lock.release()[0m
[30;1m237 | [0m[35m    g.close()[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/offline/chat_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m    if ConversationCommand.Online in conversation_commands:[0m
[30;1m196 | [0m[35m        simplified_online_results = online_results.copy()[0m
[30;1m197 | [0m[35m        for result in online_results:[0m
[30;1m198 | [0m[35m            if online_results[result].get("webpages"):[0m
[30;1m199 | [0m[35m                simplified_online_results[result] = online_results[result]["webpages"][0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        conversation_primer = f"{prompts.online_search_conversation_offline.format(online_results=st[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/offline/chat_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    if use_history:[0m
[30;1m56 | [0m[35m        for chat in conversation_log.get("chat", [])[-4:]:[0m
[30;1m57 | [0m[35m            if chat["by"] == "khoj" and "text-to-image" not in chat["intent"].get("type"):[0m
[30;1m58 | [0m[35m                chat_history += f"Q: {chat['intent']['query']}\n"[0m
[30;1m59 | [0m[35m                chat_history += f"Khoj: {chat['message']}\n\n"[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/offline/chat_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m    chat_history = ""[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    if use_history:[0m
[30;1m56 | [0m[35m        for chat in conversation_log.get("chat", [])[-4:]:[0m
[30;1m57 | [0m[35m            if chat["by"] == "khoj" and "text-to-image" not in chat["intent"].get("type"):[0m
[30;1m58 | [0m[35m                chat_history += f"Q: {chat['intent']['query']}\n"[0m
[30;1m59 | [0m[35m                chat_history += f"Khoj: {chat['message']}\n\n"[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/offline/chat_model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    # Extract, Clean Message from GPT's Response[0m
[30;1m95 | [0m[35m    try:[0m
[30;1m96 | [0m[35m        # This will expect to be a list with a single string with a list of questions[0m
[30;1m97 | [0m[35m        questions_str = ([0m
[30;1m98 | [0m[35m            str(response)[0m
[30;1m99 | [0m[35m            .strip(empty_escape_sequences)[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/markdown/markdown_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m            heading = parsed_entry.splitlines()[0] if re.search(r"^#+\s", parsed_entry) else ""[0m
[30;1m145 | [0m[35m            # Append base filename to compiled entry for context to model[0m
[30;1m146 | [0m[35m            # Increment heading level for heading entries and make filename as its top level heading[0m
[30;1m147 | [0m[35m            prefix = f"# {entry_filename}\n#" if heading else f"# {entry_filename}\n"[0m
[30;1m148 | [0m[35m            compiled_entry = f"{prefix}{parsed_entry}"[0m
[30;1m149 | [0m[35m            entries.append([0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/pdf/pdf_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mfrom datetime import datetime[0m
[30;1m5 | [0m[35mfrom typing import Dict, List, Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_offline_model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35mdef migrate_offline_model(args):[0m
[30;1m12 | [0m[35m    schema_version = "0.10.1"[0m
[30;1m13 | [0m[35m    raw_config = load_config_from_file(args.config_file)[0m
[30;1m14 | [0m[35m    previous_version = raw_config.get("version")[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    if previous_version is None or version.parse(previous_version) < version.parse("0.10.1"):[0m
[30;1m17 | [0m[35m        logger.info([0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/org_to_entries.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m        # Split this entry tree into sections by the next heading level in it[0m
[30;1m113 | [0m[35m        # Increment heading level until able to split entry into sections or reach max heading level[0m
[30;1m114 | [0m[35m        # A successful split will result in at least 2 sections[0m
[30;1m115 | [0m[35m        max_heading_level = 100[0m
[30;1m116 | [0m[35m        next_heading_level = len(ancestry)[0m
[30;1m117 | [0m[35m        sections: List[str] = [][0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/org_to_entries.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m    ) -> Tuple[List[List[Orgnode]], List[Tuple[Orgnode, str]]]:[0m
[30;1m91 | [0m[35m        """Parse org_content from org_file into OrgNode entries[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        Recurse down org file entries, one heading level at a time,[0m
[30;1m94 | [0m[35m        until reach a leaf entry or the current entry tree fits max_tokens.[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        Parse recursion terminating entry (trees) into (a list of) OrgNode objects.[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/org_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m                    heading += f"{parsed_entry.heading}."[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m                # Prepend ancestor headings, filename as top heading to root parent entry for contex[0m
[30;1m190 | [0m[35m                # Children nodes do not need ancestors trail as root parent node will have it[0m
[30;1m191 | [0m[35m                if not entry_heading:[0m
[30;1m192 | [0m[35m                    ancestors_trail = " / ".join(parsed_entry.ancestors) or Path(entry_to_file_map[p[0m
[30;1m193 | [0m[35m                    heading = f"* {ancestors_trail}\n{heading}" if heading else f"* {ancestors_trail[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/org_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m                if parsed_entry.heading:[0m
[30;1m187 | [0m[35m                    heading += f"{parsed_entry.heading}."[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m                # Prepend ancestor headings, filename as top heading to root parent entry for contex[0m
[30;1m190 | [0m[35m                # Children nodes do not need ancestors trail as root parent node will have it[0m
[30;1m191 | [0m[35m                if not entry_heading:[0m
[30;1m192 | [0m[35m                    ancestors_trail = " / ".join(parsed_entry.ancestors) or Path(entry_to_file_map[p[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/org_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m                # Set base level to current org-node tree's root heading level[0m
[30;1m182 | [0m[35m                if not entry_heading and parsed_entry.level > 0:[0m
[30;1m183 | [0m[35m                    base_level = parsed_entry.level[0m
[30;1m184 | [0m[35m                # Indent entry by 1 heading level as ancestry is prepended as top level heading[0m
[30;1m185 | [0m[35m                heading = f"{'*' * (parsed_entry.level-base_level+2)} {todo_str}" if parsed_entry.le[0m
[30;1m186 | [0m[35m                if parsed_entry.heading:[0m
[30;1m187 | [0m[35m                    heading += f"{parsed_entry.heading}."[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        except Exception as e:[0m
[30;1m222 | [0m[35m            logger.error(f"Error getting page {page_id}: {e}", exc_info=True)[0m
[30;1m223 | [0m[35m            return None, None[0m
[30;1m224 | [0m[35m        properties = page.get("properties", {})[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m        title_field = "title"[0m
[30;1m227 | [0m[35m        if "Title" in properties:[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m        return self.session.get(f"https://api.notion.com/v1/pages/{page_id}").json()[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m    def get_page_children(self, page_id):[0m
[30;1m215 | [0m[35m        return self.session.get(f"https://api.notion.com/v1/blocks/{page_id}/children").json()[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m    def get_page_content(self, page_id):[0m
[30;1m218 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m            return {}[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    def get_page(self, page_id):[0m
[30;1m212 | [0m[35m        return self.session.get(f"https://api.notion.com/v1/pages/{page_id}").json()[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m    def get_page_children(self, page_id):[0m
[30;1m215 | [0m[35m        return self.session.get(f"https://api.notion.com/v1/blocks/{page_id}/children").json()[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    def get_block_children(self, block_id):[0m
[30;1m205 | [0m[35m        try:[0m
[30;1m206 | [0m[35m            return self.session.get(f"https://api.notion.com/v1/blocks/{block_id}/children").json()[0m
[30;1m207 | [0m[35m        except Exception as e:[0m
[30;1m208 | [0m[35m            logger.error(f"Error getting children for block {block_id}: {e}")[0m
[30;1m209 | [0m[35m            return {}[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m        text_type = text.get("type", None)[0m
[30;1m195 | [0m[35m        if text_type in self.unsupported_block_types:[0m
[30;1m196 | [0m[35m            return ""[0m
[30;1m197 | [0m[35m        if text.get("href", None):[0m
[30;1m198 | [0m[35m            return f"<a href='{text['href']}'>{text['plain_text']}</a>"[0m
[30;1m199 | [0m[35m        raw_text = text["plain_text"][0m
[30;1m200 | [0m[35m        if text_type in self.display_block_block_types or block_type in self.display_block_block_typ[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m        return raw_content[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    def process_text(self, text, block_type=None):[0m
[30;1m194 | [0m[35m        text_type = text.get("type", None)[0m
[30;1m195 | [0m[35m        if text_type in self.unsupported_block_types:[0m
[30;1m196 | [0m[35m            return ""[0m
[30;1m197 | [0m[35m        if text.get("href", None):[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m            if child_data.get("rich_text") and len(child_data["rich_text"]) > 0:[0m
[30;1m186 | [0m[35m                for text in child_data["rich_text"]:[0m
[30;1m187 | [0m[35m                    raw_content += self.process_text(text, block_type)[0m
[30;1m188 | [0m[35m            if child_data.get("has_children", True):[0m
[30;1m189 | [0m[35m                return self.process_nested_children(self.get_block_children(child["id"]), raw_conten[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        return raw_content[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m            if child_type == None:[0m
[30;1m183 | [0m[35m                continue[0m
[30;1m184 | [0m[35m            child_data = child[child_type][0m
[30;1m185 | [0m[35m            if child_data.get("rich_text") and len(child_data["rich_text"]) > 0:[0m
[30;1m186 | [0m[35m                for text in child_data["rich_text"]:[0m
[30;1m187 | [0m[35m                    raw_content += self.process_text(text, block_type)[0m
[30;1m188 | [0m[35m            if child_data.get("has_children", True):[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m    def process_nested_children(self, children, raw_content, block_type=None):[0m
[30;1m179 | [0m[35m        results = children.get("results", [])[0m
[30;1m180 | [0m[35m        for child in results:[0m
[30;1m181 | [0m[35m            child_type = child.get("type")[0m
[30;1m182 | [0m[35m            if child_type == None:[0m
[30;1m183 | [0m[35m                continue[0m
[30;1m184 | [0m[35m            child_data = child[child_type][0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m        return f"\n<b>{heading}</b>\n"[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    def process_nested_children(self, children, raw_content, block_type=None):[0m
[30;1m179 | [0m[35m        results = children.get("results", [])[0m
[30;1m180 | [0m[35m        for child in results:[0m
[30;1m181 | [0m[35m            child_type = child.get("type")[0m
[30;1m182 | [0m[35m            if child_type == None:[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m            for text in block_data["rich_text"]:[0m
[30;1m156 | [0m[35m                raw_content += self.process_text(text)[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m            if block.get("has_children", True):[0m
[30;1m159 | [0m[35m                raw_content += "\n"[0m
[30;1m160 | [0m[35m                raw_content = self.process_nested_children([0m
[30;1m161 | [0m[35m                    self.get_block_children(block["id"]), raw_content, block_type[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m                continue[0m
[30;1m131 | [0m[35m            block_data = block[block_type][0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m            if block_data.get("rich_text") == None or len(block_data["rich_text"]) == 0:[0m
[30;1m134 | [0m[35m                # There's no text to handle here.[0m
[30;1m135 | [0m[35m                continue[0m
[30;1m136 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        current_entries = [][0m
[30;1m125 | [0m[35m        curr_heading = ""[0m
[30;1m126 | [0m[35m        for block in content.get("results", []):[0m
[30;1m127 | [0m[35m            block_type = block.get("type")[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m            if block_type == None:[0m
[30;1m130 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        current_entries = [][0m
[30;1m125 | [0m[35m        curr_heading = ""[0m
[30;1m126 | [0m[35m        for block in content.get("results", []):[0m
[30;1m127 | [0m[35m            block_type = block.get("type")[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m            if block_type == None:[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        for response in responses:[0m
[30;1m100 | [0m[35m            with timer("Processing response", logger=logger):[0m
[30;1m101 | [0m[35m                pages_or_databases = response.get("results", [])[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m                # Get all pages content[0m
[30;1m104 | [0m[35m                for p_or_d in pages_or_databases:[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m                    json=self.body_params,[0m
[30;1m92 | [0m[35m                ).json()[0m
[30;1m93 | [0m[35m                responses.append(result)[0m
[30;1m94 | [0m[35m                if result.get("has_more", False) == False:[0m
[30;1m95 | [0m[35m                    break[0m
[30;1m96 | [0m[35m                else:[0m
[30;1m97 | [0m[35m                    self.body_params.update({"start_cursor": result["next_cursor"]})[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m            responses = [][0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m            while True:[0m
[30;1m89 | [0m[35m                result = self.session.post([0m
[30;1m90 | [0m[35m                    "https://api.notion.com/v1/search",[0m
[30;1m91 | [0m[35m                    json=self.body_params,[0m
[30;1m92 | [0m[35m                ).json()[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m765 | [0m[35mAI Response: https://khoj-generated-images.khoj.dev/user110/image78124.webp[0m
[30;1m766 | [0m[35mKhoj: Yes[0m
[30;1m767 | [0m[35m[0m
[30;1m768 | [0m[35mOriginal User Query: Share a summary of the tasks I've completed at the end of the day. My Current L[0m
[30;1m769 | [0m[35mExecuted User Query: Share a summary of the tasks I've completed today.[0m
[30;1m770 | [0m[35mAI Response: I'm sorry, I couldn't find any relevant notes to respond to your message.[0m
[30;1m771 | [0m[35mKhoj: No[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m745 | [0m[35m- You should only respond with a "Yes" or "No". Do not say anything else.[0m
[30;1m746 | [0m[35m[0m
[30;1m747 | [0m[35m# Examples:[0m
[30;1m748 | [0m[35mOriginal User Query: Hahah, nice! Show a new one every morning at 9am. My Current Location: Shanghai[0m
[30;1m749 | [0m[35mExecuted User Query: Could you share a funny Calvin and Hobbes quote from my notes?[0m
[30;1m750 | [0m[35mAI Reponse: Here is one I found: "It's not denial. I'm just selective about the reality I accept."[0m
[30;1m751 | [0m[35mKhoj: Yes[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m723 | [0m[35m- Use the user query to infer the subject or title of the task.[0m
[30;1m724 | [0m[35m[0m
[30;1m725 | [0m[35m# Examples:[0m
[30;1m726 | [0m[35mUser: Show a new Calvin and Hobbes quote every morning at 9am. My Current Location: Shanghai, China[0m
[30;1m727 | [0m[35mKhoj: Your daily Calvin and Hobbes Quote[0m
[30;1m728 | [0m[35m[0m
[30;1m729 | [0m[35mUser: Notify me when version 2.0.0 of the sentence transformers python package is released. My Curre[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m## Chat History[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35mUser: Inform me when the national election results are declared. Run task at 4pm every thursday.[0m
[30;1m706 | [0m[35mKhoj: {{[0m
[30;1m707 | [0m[35m    "crontime": "0 16 * * 4",[0m
[30;1m708 | [0m[35m    "query": "/automated_task Check if the Indian national election results are officially declared"[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m673 | [0m[35m[0m
[30;1m674 | [0m[35m## Chat History[0m
[30;1m675 | [0m[35m[0m
[30;1m676 | [0m[35mUser: Every monday evening at 6 share the top posts on hacker news from last week. Format it as a ne[0m
[30;1m677 | [0m[35mKhoj: {{[0m
[30;1m678 | [0m[35m    "crontime": "0 18 * * 1",[0m
[30;1m679 | [0m[35m    "query": "/automated_task Top posts last week on Hacker News",[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m656 | [0m[35mYou are Khoj, an extremely smart and helpful task scheduling assistant[0m
[30;1m657 | [0m[35m- Given a user query, infer the date, time to run the query at as a cronjob time string[0m
[30;1m658 | [0m[35m- Use an approximate time that makes sense, if it not unspecified.[0m
[30;1m659 | [0m[35m- Also extract the search query to run at the scheduled time. Add any context required from the chat[0m
[30;1m660 | [0m[35m- Return a JSON object with the cronjob time, the search query to run and the task subject in it.[0m
[30;1m661 | [0m[35m[0m
[30;1m662 | [0m[35m# Examples:[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m654 | [0m[35mcrontime_prompt = PromptTemplate.from_template([0m
[30;1m655 | [0m[35m    """[0m
[30;1m656 | [0m[35mYou are Khoj, an extremely smart and helpful task scheduling assistant[0m
[30;1m657 | [0m[35m- Given a user query, infer the date, time to run the query at as a cronjob time string[0m
[30;1m658 | [0m[35m- Use an approximate time that makes sense, if it not unspecified.[0m
[30;1m659 | [0m[35m- Also extract the search query to run at the scheduled time. Add any context required from the chat[0m
[30;1m660 | [0m[35m- Return a JSON object with the cronjob time, the search query to run and the task subject in it.[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m617 | [0m[35mUser: Going well. Ananya is in town tonight![0m
[30;1m618 | [0m[35mAI: Oh that's awesome! What are your plans for the evening?[0m
[30;1m619 | [0m[35m[0m
[30;1m620 | [0m[35mQ: She wants to see a movie. Any decent sci-fi movies playing at the local theater?[0m
[30;1m621 | [0m[35mKhoj: {{"queries": ["new sci-fi movies in theaters near {location}"]}}[0m
[30;1m622 | [0m[35m[0m
[30;1m623 | [0m[35mHistory:[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m584 | [0m[35m- Break messages into multiple search queries when required to retrieve the relevant information.[0m
[30;1m585 | [0m[35m- Use site: google search operators when appropriate[0m
[30;1m586 | [0m[35m- You have access to the the whole internet to retrieve information.[0m
[30;1m587 | [0m[35m- Official, up-to-date information about you, Khoj, is available at site:khoj.dev, github or pypi.[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35mWhat Google searches, if any, will you need to perform to answer the user's question?[0m
[30;1m590 | [0m[35mProvide search queries as a list of strings in a JSON object.[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35mExample:[0m
[30;1m431 | [0m[35mChat History:[0m
[30;1m432 | [0m[35mUser: I'm having trouble deciding which laptop to get. I want something with at least 16 GB of RAM a[0m
[30;1m433 | [0m[35mAI: I can help with that. I see online that there is a new model of the Dell XPS 15 that meets your [0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35mQ: What are the specs of the new Dell XPS 15?[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35mUser: Share some random, interesting experiences from this month[0m
[30;1m346 | [0m[35mAssistant: {{"queries": ["Exciting travel adventures from {current_month}", "Fun social events dt>='[0m
[30;1m347 | [0m[35mA: You had a great time at the local beach with your friends, attended a music concert and had a dee[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m""".strip()[0m
[30;1m350 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35mQ: Share some random, interesting experiences from this month[0m
[30;1m290 | [0m[35mKhoj: {{"queries": ["Exciting travel adventures from {current_month}", "Fun social events dt>='{curr[0m
[30;1m291 | [0m[35mA: You had a great time at the local beach with your friends, attended a music concert and had a dee[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35mQ: Is Bob older than Tom?[0m
[30;1m294 | [0m[35mKhoj: {{"queries": ["When was Bob born?", "What is Tom's age?"]}}[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m96 | [0m[35m- Ask crisp follow-up questions to get additional context, when the answer cannot be inferred from t[0m
[30;1m97 | [0m[35m- Do not print verbatim Notes unless necessary.[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35mNote: More information about you, the company or Khoj apps can be found at https://khoj.dev.[0m
[30;1m100 | [0m[35mToday is {day_of_week}, {current_date} in UTC.[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35mInstructions:\n{bio}[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m- Ask crisp follow-up questions to get additional context, when the answer cannot be inferred from t[0m
[30;1m83 | [0m[35m- Do not print verbatim Notes unless necessary.[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35mNote: More information about you, the company or Khoj apps can be found at https://khoj.dev.[0m
[30;1m86 | [0m[35mToday is {day_of_week}, {current_date} in UTC.[0m
[30;1m87 | [0m[35m""".strip()[0m
[30;1m88 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m20 | [0m[35m web pages you refer to in your responses in markdown format. For example, "The farmer had ten sheep[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mNote: More information about you, the company or Khoj apps can be found at https://khoj.dev.[0m
[30;1m23 | [0m[35mToday is {day_of_week}, {current_date} in UTC.[0m
[30;1m24 | [0m[35m""".strip()[0m
[30;1m25 | [0m[35m)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mcustom_personality = PromptTemplate.from_template([0m
[30;1m28 | [0m[35m    """[0m
[30;1m29 | [0m[35mYou are {name}, a personal agent on Khoj.[0m
[30;1m30 | [0m[35mUse your general knowledge and past conversation with the user as context to inform your responses.[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m767 | [0m[35m[0m
[30;1m768 | [0m[35mOriginal User Query: Share a summary of the tasks I've completed at the end of the day. My Current L[0m
[30;1m769 | [0m[35mExecuted User Query: Share a summary of the tasks I've completed today.[0m
[30;1m770 | [0m[35mAI Response: I'm sorry, I couldn't find any relevant notes to respond to your message.[0m
[30;1m771 | [0m[35mKhoj: No[0m
[30;1m772 | [0m[35m[0m
[30;1m773 | [0m[35mOriginal User Query: {original_query}[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m696 | [0m[35mUser: Tell me the latest local tech news on the first sunday of every month[0m
[30;1m697 | [0m[35mKhoj: {{[0m
[30;1m698 | [0m[35m    "crontime": "0 8 1-7 * 0",[0m
[30;1m699 | [0m[35m    "query": "/automated_task Find the latest local tech, AI and engineering news. Format it as a ne[0m
[30;1m700 | [0m[35m    "subject": "Your Monthly Dose of Local Tech News"[0m
[30;1m701 | [0m[35m}}[0m
[30;1m702 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m677 | [0m[35mKhoj: {{[0m
[30;1m678 | [0m[35m    "crontime": "0 18 * * 1",[0m
[30;1m679 | [0m[35m    "query": "/automated_task Top posts last week on Hacker News",[0m
[30;1m680 | [0m[35m    "subject": "Your Weekly Top Hacker News Posts Newsletter"[0m
[30;1m681 | [0m[35m}}[0m
[30;1m682 | [0m[35m[0m
[30;1m683 | [0m[35m## Chat History[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m676 | [0m[35mUser: Every monday evening at 6 share the top posts on hacker news from last week. Format it as a ne[0m
[30;1m677 | [0m[35mKhoj: {{[0m
[30;1m678 | [0m[35m    "crontime": "0 18 * * 1",[0m
[30;1m679 | [0m[35m    "query": "/automated_task Top posts last week on Hacker News",[0m
[30;1m680 | [0m[35m    "subject": "Your Weekly Top Hacker News Posts Newsletter"[0m
[30;1m681 | [0m[35m}}[0m
[30;1m682 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m673 | [0m[35m[0m
[30;1m674 | [0m[35m## Chat History[0m
[30;1m675 | [0m[35m[0m
[30;1m676 | [0m[35mUser: Every monday evening at 6 share the top posts on hacker news from last week. Format it as a ne[0m
[30;1m677 | [0m[35mKhoj: {{[0m
[30;1m678 | [0m[35m    "crontime": "0 18 * * 1",[0m
[30;1m679 | [0m[35m    "query": "/automated_task Top posts last week on Hacker News",[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m655 | [0m[35m    """[0m
[30;1m656 | [0m[35mYou are Khoj, an extremely smart and helpful task scheduling assistant[0m
[30;1m657 | [0m[35m- Given a user query, infer the date, time to run the query at as a cronjob time string[0m
[30;1m658 | [0m[35m- Use an approximate time that makes sense, if it not unspecified.[0m
[30;1m659 | [0m[35m- Also extract the search query to run at the scheduled time. Add any context required from the chat[0m
[30;1m660 | [0m[35m- Return a JSON object with the cronjob time, the search query to run and the task subject in it.[0m
[30;1m661 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m654 | [0m[35mcrontime_prompt = PromptTemplate.from_template([0m
[30;1m655 | [0m[35m    """[0m
[30;1m656 | [0m[35mYou are Khoj, an extremely smart and helpful task scheduling assistant[0m
[30;1m657 | [0m[35m- Given a user query, infer the date, time to run the query at as a cronjob time string[0m
[30;1m658 | [0m[35m- Use an approximate time that makes sense, if it not unspecified.[0m
[30;1m659 | [0m[35m- Also extract the search query to run at the scheduled time. Add any context required from the chat[0m
[30;1m660 | [0m[35m- Return a JSON object with the cronjob time, the search query to run and the task subject in it.[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m654 | [0m[35mcrontime_prompt = PromptTemplate.from_template([0m
[30;1m655 | [0m[35m    """[0m
[30;1m656 | [0m[35mYou are Khoj, an extremely smart and helpful task scheduling assistant[0m
[30;1m657 | [0m[35m- Given a user query, infer the date, time to run the query at as a cronjob time string[0m
[30;1m658 | [0m[35m- Use an approximate time that makes sense, if it not unspecified.[0m
[30;1m659 | [0m[35m- Also extract the search query to run at the scheduled time. Add any context required from the chat[0m
[30;1m660 | [0m[35m- Return a JSON object with the cronjob time, the search query to run and the task subject in it.[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m597 | [0m[35mUser: I like to use Hacker News to get my tech news.[0m
[30;1m598 | [0m[35mAI: Hacker News is an online forum for sharing and discussing the latest tech news. It is a great pl[0m
[30;1m599 | [0m[35m[0m
[30;1m600 | [0m[35mQ: Summarize the top posts on HackerNews[0m
[30;1m601 | [0m[35mKhoj: {{"queries": ["top posts on HackerNews"]}}[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35mHistory:[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m550 | [0m[35mUser: I like to use Hacker News to get my tech news.[0m
[30;1m551 | [0m[35mAI: Hacker News is an online forum for sharing and discussing the latest tech news. It is a great pl[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35mQ: Summarize top posts on Hacker News today[0m
[30;1m554 | [0m[35mKhoj: {{"links": ["https://news.ycombinator.com/best"]}}[0m
[30;1m555 | [0m[35m[0m
[30;1m556 | [0m[35mHistory:[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35mUser: Share some random, interesting experiences from this month[0m
[30;1m346 | [0m[35mAssistant: {{"queries": ["Exciting travel adventures from {current_month}", "Fun social events dt>='[0m
[30;1m347 | [0m[35mA: You had a great time at the local beach with your friends, attended a music concert and had a dee[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m""".strip()[0m
[30;1m350 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35mQ: Share some random, interesting experiences from this month[0m
[30;1m290 | [0m[35mKhoj: {{"queries": ["Exciting travel adventures from {current_month}", "Fun social events dt>='{curr[0m
[30;1m291 | [0m[35mA: You had a great time at the local beach with your friends, attended a music concert and had a dee[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35mQ: Is Bob older than Tom?[0m
[30;1m294 | [0m[35mKhoj: {{"queries": ["When was Bob born?", "What is Tom's age?"]}}[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mno_online_results_found = PromptTemplate.from_template([0m
[30;1m63 | [0m[35m    """[0m
[30;1m64 | [0m[35m    I'm sorry, I couldn't find any relevant information from the internet to respond to your message[0m
[30;1m65 | [0m[35m    """.strip()[0m
[30;1m66 | [0m[35m)[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mno_notes_found = PromptTemplate.from_template([0m
[30;1m57 | [0m[35m    """[0m
[30;1m58 | [0m[35m    I'm sorry, I couldn't find any relevant notes to respond to your message.[0m
[30;1m59 | [0m[35m    """.strip()[0m
[30;1m60 | [0m[35m)[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35mthe user as context to inform your responses.[0m
[30;1m31 | [0m[35mYou were created by Khoj Inc. with the following capabilities:[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m- You *CAN REMEMBER ALL NOTES and PERSONAL INFORMATION FOREVER* that the user ever shares with you.[0m
[30;1m34 | [0m[35m- Users can share files and other information with you using the Khoj Desktop, Obsidian or Emacs app[0m
[30;1m35 | [0m[35m- Say "I don't know" or "I don't understand" if you don't know what to say or if you don't know the [0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mthe user as context to inform your responses.[0m
[30;1m9 | [0m[35mYou were created by Khoj Inc. with the following capabilities:[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m- You *CAN REMEMBER ALL NOTES and PERSONAL INFORMATION FOREVER* that the user ever shares with you.[0m
[30;1m12 | [0m[35m- Users can share files and other information with you using the Khoj Desktop, Obsidian or Emacs app[0m
[30;1m13 | [0m[35m- You *CAN* generate images, look-up real-time information from the internet, set reminders and answ[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/images/image_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mfrom datetime import datetime[0m
[30;1m5 | [0m[35mfrom typing import Dict, List, Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/assets/khoj.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m    }[0m
[30;1m216 | [0m[35m}[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m@media only screen and (max-width: 1000px) {[0m
[30;1m219 | [0m[35m    div.khoj-header {[0m
[30;1m220 | [0m[35m        display: grid;[0m
[30;1m221 | [0m[35m        grid-auto-flow: column;[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/assets/khoj.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m    border: 3px solid var(--primary-hover);[0m
[30;1m200 | [0m[35m}[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m@media screen and (max-width: 1000px) {[0m
[30;1m203 | [0m[35m    .khoj-nav-dropdown-content {[0m
[30;1m204 | [0m[35m        display: block;[0m
[30;1m205 | [0m[35m        grid-auto-flow: row;[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/assets/khoj.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m/* Amber Dark scheme (Auto) */[0m
[30;1m22 | [0m[35m/* Automatically enabled if user has Dark mode enabled */[0m
[30;1m23 | [0m[35m@media only screen and (prefers-color-scheme: dark) {[0m
[30;1m24 | [0m[35m    :root:not([data-theme]) {[0m
[30;1m25 | [0m[35m        --primary: #f9f5de;[0m
[30;1m26 | [0m[35m        --primary-hover: #fee285;[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m    # Extract Chat History for Context[0m
[30;1m156 | [0m[35m    chat_logs = [][0m
[30;1m157 | [0m[35m    for chat in conversation_log.get("chat", []):[0m
[30;1m158 | [0m[35m        chat_notes = f'\n\n Notes:\n{chat.get("context")}' if chat.get("context") else "\n"[0m
[30;1m159 | [0m[35m        chat_logs += [chat["message"] + chat_notes][0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    rest_backnforths: List[ChatMessage] = [][0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m    # Extract Chat History for Context[0m
[30;1m156 | [0m[35m    chat_logs = [][0m
[30;1m157 | [0m[35m    for chat in conversation_log.get("chat", []):[0m
[30;1m158 | [0m[35m        chat_notes = f'\n\n Notes:\n{chat.get("context")}' if chat.get("context") else "\n"[0m
[30;1m159 | [0m[35m        chat_logs += [chat["message"] + chat_notes][0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    rest_backnforths: List[ChatMessage] = [][0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    # Extract Chat History for Context[0m
[30;1m156 | [0m[35m    chat_logs = [][0m
[30;1m157 | [0m[35m    for chat in conversation_log.get("chat", []):[0m
[30;1m158 | [0m[35m        chat_notes = f'\n\n Notes:\n{chat.get("context")}' if chat.get("context") else "\n"[0m
[30;1m159 | [0m[35m        chat_logs += [chat["message"] + chat_notes][0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        if loaded_model:[0m
[30;1m148 | [0m[35m            max_prompt_size = infer_max_tokens(loaded_model.n_ctx(), model_to_prompt_size.get(model_[0m
[30;1m149 | [0m[35m        else:[0m
[30;1m150 | [0m[35m            max_prompt_size = model_to_prompt_size.get(model_name, 2000)[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    # Scale lookback turns proportional to max prompt size supported by model[0m
[30;1m153 | [0m[35m    lookback_turns = max_prompt_size // 750[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    # Set max prompt size from user config or based on pre-configured for model and machine specs[0m
[30;1m146 | [0m[35m    if not max_prompt_size:[0m
[30;1m147 | [0m[35m        if loaded_model:[0m
[30;1m148 | [0m[35m            max_prompt_size = infer_max_tokens(loaded_model.n_ctx(), model_to_prompt_size.get(model_[0m
[30;1m149 | [0m[35m        else:[0m
[30;1m150 | [0m[35m            max_prompt_size = model_to_prompt_size.get(model_name, 2000)[0m
[30;1m151 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m            "onlineContext": online_results,[0m
[30;1m113 | [0m[35m            "automationId": automation_id,[0m
[30;1m114 | [0m[35m        },[0m
[30;1m115 | [0m[35m        conversation_log=meta_log.get("chat", []),[0m
[30;1m116 | [0m[35m    )[0m
[30;1m117 | [0m[35m    ConversationAdapters.save_conversation([0m
[30;1m118 | [0m[35m        user,[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m        return self[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    def __next__(self):[0m
[30;1m46 | [0m[35m        item = self.queue.get()[0m
[30;1m47 | [0m[35m        if item is StopIteration:[0m
[30;1m48 | [0m[35m            time_to_response = perf_counter() - self.start_time[0m
[30;1m49 | [0m[35m            logger.info(f"Chat streaming took: {time_to_response:.3f} seconds")[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport math[0m
[30;1m4 | [0m[35mimport queue[0m
[30;1m5 | [0m[35mfrom datetime import datetime[0m
[30;1m6 | [0m[35mfrom time import perf_counter[0m
[30;1m7 | [0m[35mfrom typing import Any, Dict, List, Optional[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport tiktoken[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m            parsed_response = [[0m
[30;1m232 | [0m[35m                {[0m
[30;1m233 | [0m[35m                    "title": item["title"],[0m
[30;1m234 | [0m[35m                    "content": item.get("content"),[0m
[30;1m235 | [0m[35m                    # rename description -> snippet for consistency[0m
[30;1m236 | [0m[35m                    "snippet": item["description"],[0m
[30;1m237 | [0m[35m                    # rename url -> link for consistency[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m        headers["Authorization"] = f"Bearer {JINA_API_KEY}"[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m    async with aiohttp.ClientSession() as session:[0m
[30;1m226 | [0m[35m        async with session.get(jina_search_api_url, headers=headers) as response:[0m
[30;1m227 | [0m[35m            if response.status != 200:[0m
[30;1m228 | [0m[35m                logger.error(await response.text())[0m
[30;1m229 | [0m[35m                return query, {}[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        headers["Authorization"] = f"Bearer {JINA_API_KEY}"[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    async with aiohttp.ClientSession() as session:[0m
[30;1m212 | [0m[35m        async with session.get(jina_reader_api_url, headers=headers) as response:[0m
[30;1m213 | [0m[35m            response.raise_for_status()[0m
[30;1m214 | [0m[35m            response_json = await response.json()[0m
[30;1m215 | [0m[35m            return response_json["data"]["content"][0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m    web_scraping_params["url"] = web_url[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    async with aiohttp.ClientSession() as session:[0m
[30;1m199 | [0m[35m        async with session.get(OLOSTEP_API_URL, params=web_scraping_params, headers=headers) as resp[0m
[30;1m200 | [0m[35m            response.raise_for_status()[0m
[30;1m201 | [0m[35m            response_json = await response.json()[0m
[30;1m202 | [0m[35m            return response_json["markdown_content"][0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m    }[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    async with aiohttp.ClientSession() as session:[0m
[30;1m185 | [0m[35m        async with session.get(web_url, headers=headers, timeout=30) as response:[0m
[30;1m186 | [0m[35m            response.raise_for_status()[0m
[30;1m187 | [0m[35m            html = await response.text()[0m
[30;1m188 | [0m[35m            parsed_html = BeautifulSoup(html, "html.parser")[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m            extracted_search_result = {[0m
[30;1m126 | [0m[35m                field: json_response[field][0m
[30;1m127 | [0m[35m                for field in extraction_fields[0m
[30;1m128 | [0m[35m                if not is_none_or_empty(json_response.get(field))[0m
[30;1m129 | [0m[35m            }[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m            return query, extracted_search_result[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    headers = {"X-API-KEY": SERPER_DEV_API_KEY, "Content-Type": "application/json"}[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    async with aiohttp.ClientSession() as session:[0m
[30;1m119 | [0m[35m        async with session.post(SERPER_DEV_URL, headers=headers, data=payload) as response:[0m
[30;1m120 | [0m[35m            if response.status != 200:[0m
[30;1m121 | [0m[35m                logger.error(await response.text())[0m
[30;1m122 | [0m[35m                return query, {}[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m    webpages = {[0m
[30;1m86 | [0m[35m        (organic.get("link"), subquery, organic.get("content"))[0m
[30;1m87 | [0m[35m        for subquery in response_dict[0m
[30;1m88 | [0m[35m        for organic in response_dict[subquery].get("organic", [])[:MAX_WEBPAGES_TO_READ][0m
[30;1m89 | [0m[35m        if "answerBox" not in response_dict[subquery][0m
[30;1m90 | [0m[35m    }[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m    # Gather distinct web page data from organic results of each subquery without an instant answer.[0m
[30;1m84 | [0m[35m    # Content of web pages is directly available when Jina is used for search.[0m
[30;1m85 | [0m[35m    webpages = {[0m
[30;1m86 | [0m[35m        (organic.get("link"), subquery, organic.get("content"))[0m
[30;1m87 | [0m[35m        for subquery in response_dict[0m
[30;1m88 | [0m[35m        for organic in response_dict[subquery].get("organic", [])[:MAX_WEBPAGES_TO_READ][0m
[30;1m89 | [0m[35m        if "answerBox" not in response_dict[subquery][0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m    # Gather distinct web page data from organic results of each subquery without an instant answer.[0m
[30;1m84 | [0m[35m    # Content of web pages is directly available when Jina is used for search.[0m
[30;1m85 | [0m[35m    webpages = {[0m
[30;1m86 | [0m[35m        (organic.get("link"), subquery, organic.get("content"))[0m
[30;1m87 | [0m[35m        for subquery in response_dict[0m
[30;1m88 | [0m[35m        for organic in response_dict[subquery].get("organic", [])[:MAX_WEBPAGES_TO_READ][0m
[30;1m89 | [0m[35m        if "answerBox" not in response_dict[subquery][0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m172 | [0m[35m            extracted_info = await extract_relevant_info(subquery, content, subscribed=subscribed)[0m
[30;1m173 | [0m[35m        return subquery, extracted_info, url[0m
[30;1m174 | [0m[35m    except Exception as e:[0m
[30;1m175 | [0m[35m        logger.error(f"Failed to read web page at '{url}' with {e}")[0m
[30;1m176 | [0m[35m        return subquery, None, url[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m168 | [0m[35m        if is_none_or_empty(content):[0m
[30;1m169 | [0m[35m            with timer(f"Reading web page at '{url}' took", logger):[0m
[30;1m170 | [0m[35m                content = await read_webpage_with_olostep(url) if OLOSTEP_API_KEY else await read_we[0m
[30;1m171 | [0m[35m        with timer(f"Extracting relevant information from web page at '{url}' took", logger):[0m
[30;1m172 | [0m[35m            extracted_info = await extract_relevant_info(subquery, content, subscribed=subscribed)[0m
[30;1m173 | [0m[35m        return subquery, extracted_info, url[0m
[30;1m174 | [0m[35m    except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m166 | [0m[35m) -> Tuple[str, Union[None, str], str]:[0m
[30;1m167 | [0m[35m    try:[0m
[30;1m168 | [0m[35m        if is_none_or_empty(content):[0m
[30;1m169 | [0m[35m            with timer(f"Reading web page at '{url}' took", logger):[0m
[30;1m170 | [0m[35m                content = await read_webpage_with_olostep(url) if OLOSTEP_API_KEY else await read_we[0m
[30;1m171 | [0m[35m        with timer(f"Extracting relevant information from web page at '{url}' took", logger):[0m
[30;1m172 | [0m[35m            extracted_info = await extract_relevant_info(subquery, content, subscribed=subscribed)[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m40 | [0m[35m    "htmlTransformer": "none",[0m
[30;1m41 | [0m[35m    "removeImages": "True",[0m
[30;1m42 | [0m[35m    "fastLane": "True",[0m
[30;1m43 | [0m[35m    # Similar to Stripe's API, the expand parameters avoid the need to make a second API call[0m
[30;1m44 | [0m[35m    # to retrieve the dataset (from the dataset API) if you only need the markdown or html.[0m
[30;1m45 | [0m[35m    "expandMarkdown": "True",[0m
[30;1m46 | [0m[35m    "expandHtml": "False",[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    "htmlTransformer": "none",[0m
[30;1m41 | [0m[35m    "removeImages": "True",[0m
[30;1m42 | [0m[35m    "fastLane": "True",[0m
[30;1m43 | [0m[35m    # Similar to Stripe's API, the expand parameters avoid the need to make a second API call[0m
[30;1m44 | [0m[35m    # to retrieve the dataset (from the dataset API) if you only need the markdown or html.[0m
[30;1m45 | [0m[35m    "expandMarkdown": "True",[0m
[30;1m46 | [0m[35m    "expandHtml": "False",[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m                        chat["message"] = chat["message"].replace(".webp", ".png")[0m
[30;1m83 | [0m[35m                        conversation_updated = True[0m
[30;1m84 | [0m[35m                        updated_count += 1[0m
[30;1m85 | [0m[35m                    elif chat.get("message", "").endswith(".png"):[0m
[30;1m86 | [0m[35m                        # Convert PNG url to WebP url[0m
[30;1m87 | [0m[35m                        print("Convert PNG url to WebP url")[0m
[30;1m88 | [0m[35m                        chat["message"] = chat["message"].replace(".png", ".webp")[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m77 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m78 | [0m[35m                ):[0m
[30;1m79 | [0m[35m                    if options["reverse"] and chat.get("message", "").endswith(".webp"):[0m
[30;1m80 | [0m[35m                        # Convert WebP url to PNG url[0m
[30;1m81 | [0m[35m                        print("Convert WebP url to PNG url")[0m
[30;1m82 | [0m[35m                        chat["message"] = chat["message"].replace(".webp", ".png")[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m                elif ([0m
[30;1m76 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m77 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m78 | [0m[35m                ):[0m
[30;1m79 | [0m[35m                    if options["reverse"] and chat.get("message", "").endswith(".webp"):[0m
[30;1m80 | [0m[35m                        # Convert WebP url to PNG url[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m                elif ([0m
[30;1m76 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m77 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m78 | [0m[35m                ):[0m
[30;1m79 | [0m[35m                    if options["reverse"] and chat.get("message", "").endswith(".webp"):[0m
[30;1m80 | [0m[35m                        # Convert WebP url to PNG url[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m                    updated_count += 1[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m                elif ([0m
[30;1m76 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m77 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m78 | [0m[35m                ):[0m
[30;1m79 | [0m[35m                    if options["reverse"] and chat.get("message", "").endswith(".webp"):[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m                elif ([0m
[30;1m52 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m53 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE_V3.v[0m
[30;1m54 | [0m[35m                    and options["reverse"][0m
[30;1m55 | [0m[35m                ):[0m
[30;1m56 | [0m[35m                    # Decode the base64 encoded WebP image[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m                elif ([0m
[30;1m52 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m53 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE_V3.v[0m
[30;1m54 | [0m[35m                    and options["reverse"][0m
[30;1m55 | [0m[35m                ):[0m
[30;1m56 | [0m[35m                    # Decode the base64 encoded WebP image[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m                    updated_count += 1[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m                elif ([0m
[30;1m52 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m53 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE_V3.v[0m
[30;1m54 | [0m[35m                    and options["reverse"][0m
[30;1m55 | [0m[35m                ):[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m            for chat in conversation.conversation_log.get("chat", []):[0m
[30;1m27 | [0m[35m                if ([0m
[30;1m28 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m29 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE.valu[0m
[30;1m30 | [0m[35m                    and not options["reverse"][0m
[30;1m31 | [0m[35m                ):[0m
[30;1m32 | [0m[35m                    # Decode the base64 encoded PNG image[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m            for chat in conversation.conversation_log.get("chat", []):[0m
[30;1m27 | [0m[35m                if ([0m
[30;1m28 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m29 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE.valu[0m
[30;1m30 | [0m[35m                    and not options["reverse"][0m
[30;1m31 | [0m[35m                ):[0m
[30;1m32 | [0m[35m                    # Decode the base64 encoded PNG image[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m            conversation_updated = False[0m
[30;1m26 | [0m[35m            for chat in conversation.conversation_log.get("chat", []):[0m
[30;1m27 | [0m[35m                if ([0m
[30;1m28 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m29 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE.valu[0m
[30;1m30 | [0m[35m                    and not options["reverse"][0m
[30;1m31 | [0m[35m                ):[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        updated_count = 0[0m
[30;1m24 | [0m[35m        for conversation in Conversation.objects.all():[0m
[30;1m25 | [0m[35m            conversation_updated = False[0m
[30;1m26 | [0m[35m            for chat in conversation.conversation_log.get("chat", []):[0m
[30;1m27 | [0m[35m                if ([0m
[30;1m28 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m29 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE.valu[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m                        webp_image_io = io.BytesIO()[0m
[30;1m65 | [0m[35m                        png_image.save(webp_image_io, "PNG")[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m                        # Encode the WebP image back to base64[0m
[30;1m68 | [0m[35m                        webp_image_bytes = webp_image_io.getvalue()[0m
[30;1m69 | [0m[35m                        chat["message"] = base64.b64encode(webp_image_bytes).decode()[0m
[30;1m70 | [0m[35m                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE.value[0m
[30;1m71 | [0m[35m                        webp_image_io.close()[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m                    and options["reverse"][0m
[30;1m55 | [0m[35m                ):[0m
[30;1m56 | [0m[35m                    # Decode the base64 encoded WebP image[0m
[30;1m57 | [0m[35m                    print("Decode the base64 encoded WebP image")[0m
[30;1m58 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m                    # Convert images from WebP to PNG format[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE_V3.v[0m
[30;1m54 | [0m[35m                    and options["reverse"][0m
[30;1m55 | [0m[35m                ):[0m
[30;1m56 | [0m[35m                    # Decode the base64 encoded WebP image[0m
[30;1m57 | [0m[35m                    print("Decode the base64 encoded WebP image")[0m
[30;1m58 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m                        webp_image_io = io.BytesIO()[0m
[30;1m41 | [0m[35m                        png_image.save(webp_image_io, "WEBP")[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m                        # Encode the WebP image back to base64[0m
[30;1m44 | [0m[35m                        webp_image_bytes = webp_image_io.getvalue()[0m
[30;1m45 | [0m[35m                        chat["message"] = base64.b64encode(webp_image_bytes).decode()[0m
[30;1m46 | [0m[35m                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE_V3.value[0m
[30;1m47 | [0m[35m                        webp_image_io.close()[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m                    and not options["reverse"][0m
[30;1m31 | [0m[35m                ):[0m
[30;1m32 | [0m[35m                    # Decode the base64 encoded PNG image[0m
[30;1m33 | [0m[35m                    print("Decode the base64 encoded PNG image")[0m
[30;1m34 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m                    # Convert images from PNG to WebP format[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE.valu[0m
[30;1m30 | [0m[35m                    and not options["reverse"][0m
[30;1m31 | [0m[35m                ):[0m
[30;1m32 | [0m[35m                    # Decode the base64 encoded PNG image[0m
[30;1m33 | [0m[35m                    print("Decode the base64 encoded PNG image")[0m
[30;1m34 | [0m[35m                    decoded_image = base64.b64decode(chat["message"])[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport io[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom django.core.management.base import BaseCommand[0m
[30;1m5 | [0m[35mfrom PIL import Image[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/text_to_entries.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m193 | [0m[35m            with timer("Indexed text of modified file in", logger):[0m
[30;1m194 | [0m[35m                # get the set of modified files from added_entries[0m
[30;1m195 | [0m[35m                modified_files = {entry.file_path for entry in added_entries}[0m
[30;1m196 | [0m[35m                # create or update text of each updated file indexed on DB[0m
[30;1m197 | [0m[35m                for modified_file in modified_files:[0m
[30;1m198 | [0m[35m                    raw_text = file_to_text_map[modified_file][0m
[30;1m199 | [0m[35m                    file_object = FileObjectAdapters.get_file_object_by_name(user, modified_file)[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/text_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m                    else (set(previous_entry_hashes) - to_delete_entry_hashes)[0m
[30;1m271 | [0m[35m                )[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m            # load new entries in the order in which they are processed for a stable sort[0m
[30;1m274 | [0m[35m            new_entries = [[0m
[30;1m275 | [0m[35m                (current_entry_hashes.index(entry_hash), hash_to_current_entries[entry_hash])[0m
[30;1m276 | [0m[35m                for entry_hash in new_entry_hashes[0m
[30;1m277 | [0m[35m            ][0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/speech/text_to_speech.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    }[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    # Make the POST request to the TTS API with headers and data, enabling streaming response[0m
[30;1m46 | [0m[35m    response = requests.post(tts_url, headers=headers, json=data, stream=True)[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    if response.ok:[0m
[30;1m49 | [0m[35m        return response[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/speech/text_to_speech.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35mfrom markdown_it import MarkdownIt[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# Define constants for the script[0m
[30;1m9 | [0m[35mCHUNK_SIZE = 1024  # Size of chunks to read/write at a time[0m
[30;1m10 | [0m[35mELEVEN_LABS_API_KEY = os.getenv("ELEVEN_LABS_API_KEY", None)  # Your API key for authentication[0m
[30;1m11 | [0m[35mVOICE_ID = "RPEIZnKMqlQiZyZd1Dae"  # ID of the voice model to use. MALE - Christopher - friendly guy[0m
[30;1m12 | [0m[35mELEVEN_API_URL = "https://api.elevenlabs.io/v1/text-to-speech"  # Base URL for the Text-to-Speech AP[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/speech/text_to_speech.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mfrom markdown_it import MarkdownIt[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# Define constants for the script[0m
[30;1m9 | [0m[35mCHUNK_SIZE = 1024  # Size of chunks to read/write at a time[0m
[30;1m10 | [0m[35mELEVEN_LABS_API_KEY = os.getenv("ELEVEN_LABS_API_KEY", None)  # Your API key for authentication[0m
[30;1m11 | [0m[35mVOICE_ID = "RPEIZnKMqlQiZyZd1Dae"  # ID of the voice model to use. MALE - Christopher - friendly guy[0m
[30;1m12 | [0m[35mELEVEN_API_URL = "https://api.elevenlabs.io/v1/text-to-speech"  # Base URL for the Text-to-Speech AP[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/speech/text_to_speech.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mfrom bs4 import BeautifulSoup[0m
[30;1m6 | [0m[35mfrom markdown_it import MarkdownIt[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# Define constants for the script[0m
[30;1m9 | [0m[35mCHUNK_SIZE = 1024  # Size of chunks to read/write at a time[0m
[30;1m10 | [0m[35mELEVEN_LABS_API_KEY = os.getenv("ELEVEN_LABS_API_KEY", None)  # Your API key for authentication[0m
[30;1m11 | [0m[35mVOICE_ID = "RPEIZnKMqlQiZyZd1Dae"  # ID of the voice model to use. MALE - Christopher - friendly guy[0m
[30;1m12 | [0m[35mELEVEN_API_URL = "https://api.elevenlabs.io/v1/text-to-speech"  # Base URL for the Text-to-Speech AP[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m                    and not is_none_or_empty(chat.get("message"))[0m
[30;1m46 | [0m[35m                    and chat.get("message", "").startswith(source)[0m
[30;1m47 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m48 | [0m[35m                    and chat.get("message", "").endswith(".webp")[0m
[30;1m49 | [0m[35m                ):[0m
[30;1m50 | [0m[35m                    # Convert source url to destination url[0m
[30;1m51 | [0m[35m                    chat["message"] = chat["message"].replace(source, destination)[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m45 | [0m[35m                    and not is_none_or_empty(chat.get("message"))[0m
[30;1m46 | [0m[35m                    and chat.get("message", "").startswith(source)[0m
[30;1m47 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m48 | [0m[35m                    and chat.get("message", "").endswith(".webp")[0m
[30;1m49 | [0m[35m                ):[0m
[30;1m50 | [0m[35m                    # Convert source url to destination url[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m45 | [0m[35m                    and not is_none_or_empty(chat.get("message"))[0m
[30;1m46 | [0m[35m                    and chat.get("message", "").startswith(source)[0m
[30;1m47 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m48 | [0m[35m                    and chat.get("message", "").endswith(".webp")[0m
[30;1m49 | [0m[35m                ):[0m
[30;1m50 | [0m[35m                    # Convert source url to destination url[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m                if ([0m
[30;1m44 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m45 | [0m[35m                    and not is_none_or_empty(chat.get("message"))[0m
[30;1m46 | [0m[35m                    and chat.get("message", "").startswith(source)[0m
[30;1m47 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m48 | [0m[35m                    and chat.get("message", "").endswith(".webp")[0m
[30;1m49 | [0m[35m                ):[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m            for chat in tqdm(conversation.conversation_log.get("chat", []), desc="Processing Convers[0m
[30;1m43 | [0m[35m                if ([0m
[30;1m44 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m45 | [0m[35m                    and not is_none_or_empty(chat.get("message"))[0m
[30;1m46 | [0m[35m                    and chat.get("message", "").startswith(source)[0m
[30;1m47 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m
[30;1m48 | [0m[35m                    and chat.get("message", "").endswith(".webp")[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m            conversation_updated = False[0m
[30;1m42 | [0m[35m            for chat in tqdm(conversation.conversation_log.get("chat", []), desc="Processing Convers[0m
[30;1m43 | [0m[35m                if ([0m
[30;1m44 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m45 | [0m[35m                    and not is_none_or_empty(chat.get("message"))[0m
[30;1m46 | [0m[35m                    and chat.get("message", "").startswith(source)[0m
[30;1m47 | [0m[35m                    and chat.get("intent", {}).get("type", "") == ImageIntentType.TEXT_TO_IMAGE2.val[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        source = options["destination"] if options["reverse"] else options["source"][0m
[30;1m40 | [0m[35m        for conversation in Conversation.objects.all():[0m
[30;1m41 | [0m[35m            conversation_updated = False[0m
[30;1m42 | [0m[35m            for chat in tqdm(conversation.conversation_log.get("chat", []), desc="Processing Convers[0m
[30;1m43 | [0m[35m                if ([0m
[30;1m44 | [0m[35m                    chat.get("by", "") == "khoj"[0m
[30;1m45 | [0m[35m                    and not is_none_or_empty(chat.get("message"))[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    def handle(self, *args, **options):[0m
[30;1m29 | [0m[35m        updated_count = 0[0m
[30;1m30 | [0m[35m        if not options.get("source") or not options.get("destination"):[0m
[30;1m31 | [0m[35m            self.stdout.write([0m
[30;1m32 | [0m[35m                self.style.ERROR([0m
[30;1m33 | [0m[35m                    "Set --source, --destination args to migrate serving images from source to desti[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/management/commands/change_generated_images_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    def handle(self, *args, **options):[0m
[30;1m29 | [0m[35m        updated_count = 0[0m
[30;1m30 | [0m[35m        if not options.get("source") or not options.get("destination"):[0m
[30;1m31 | [0m[35m            self.stdout.write([0m
[30;1m32 | [0m[35m                self.style.ERROR([0m
[30;1m33 | [0m[35m                    "Set --source, --destination args to migrate serving images from source to desti[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/login.html[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m            font-weight: 500;[0m
[30;1m203 | [0m[35m        }[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m        @media only screen and (max-width: 700px) {[0m
[30;1m206 | [0m[35m            body{[0m
[30;1m207 | [0m[35m                background: url('/static/assets/samples/phone-plain-chat-sample.png') no-repeat cent[0m
[30;1m208 | [0m[35m                background-size: contain;[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/login.html[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m                grid-column: 1;[0m
[30;1m93 | [0m[35m            }[0m
[30;1m94 | [0m[35m        }[0m
[30;1m95 | [0m[35m        @media only screen and (min-width: 700px) {[0m
[30;1m96 | [0m[35m            body {[0m
[30;1m97 | [0m[35m                display: grid;[0m
[30;1m98 | [0m[35m                grid-template-columns: 1fr min(50vw, 100%) 1fr;[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/login.html[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m    </script>[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    <style>[0m
[30;1m84 | [0m[35m        @media only screen and (max-width: 700px) {[0m
[30;1m85 | [0m[35m            body {[0m
[30;1m86 | [0m[35m                display: grid;[0m
[30;1m87 | [0m[35m                grid-template-columns: 1fr;[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/base_config.html[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m396 | [0m[35m                grid-template-columns: 1fr;[0m
[30;1m397 | [0m[35m            }[0m
[30;1m398 | [0m[35m        }[0m
[30;1m399 | [0m[35m        @media only screen and (max-width: 700px) {[0m
[30;1m400 | [0m[35m            body {[0m
[30;1m401 | [0m[35m                display: grid;[0m
[30;1m402 | [0m[35m                grid-template-columns: 1fr;[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/base_config.html[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m391 | [0m[35m            margin: 0;[0m
[30;1m392 | [0m[35m        }[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m        @media screen and (max-width: 700px) {[0m
[30;1m395 | [0m[35m            .section-cards {[0m
[30;1m396 | [0m[35m                grid-template-columns: 1fr;[0m
[30;1m397 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m829 | [0m[35m                        direct_web_pages = result[0m
[30;1m830 | [0m[35m                webpages = [][0m
[30;1m831 | [0m[35m                for query in direct_web_pages:[0m
[30;1m832 | [0m[35m                    if online_results.get(query):[0m
[30;1m833 | [0m[35m                        online_results[query]["webpages"] = direct_web_pages[query]["webpages"][0m
[30;1m834 | [0m[35m                    else:[0m
[30;1m835 | [0m[35m                        online_results[query] = {"webpages": direct_web_pages[query]["webpages"]}[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m778 | [0m[35m                defiltered_query = result[2][0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m        if not is_none_or_empty(compiled_references):[0m
[30;1m781 | [0m[35m            headings = "\n- " + "\n- ".join(set([c.get("compiled", c).split("\n")[0] for c in compil[0m
[30;1m782 | [0m[35m            # Strip only leading # from headings[0m
[30;1m783 | [0m[35m            headings = headings.replace("#", "")[0m
[30;1m784 | [0m[35m            async for result in send_event(ChatEvent.STATUS, f"**Found Relevant Notes**: {headings}"[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m                api="chat",[0m
[30;1m603 | [0m[35m                client=request.user.client_app,[0m
[30;1m604 | [0m[35m                user_agent=request.headers.get("user-agent"),[0m
[30;1m605 | [0m[35m                host=request.headers.get("host"),[0m
[30;1m606 | [0m[35m                metadata=chat_metadata,[0m
[30;1m607 | [0m[35m            )[0m
[30;1m608 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m                telemetry_type="api",[0m
[30;1m602 | [0m[35m                api="chat",[0m
[30;1m603 | [0m[35m                client=request.user.client_app,[0m
[30;1m604 | [0m[35m                user_agent=request.headers.get("user-agent"),[0m
[30;1m605 | [0m[35m                host=request.headers.get("host"),[0m
[30;1m606 | [0m[35m                metadata=chat_metadata,[0m
[30;1m607 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m    )[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m@api_chat.get("")[0m
[30;1m521 | [0m[35m@requires(["authenticated"])[0m
[30;1m522 | [0m[35masync def chat([0m
[30;1m523 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m468 | [0m[35m    return Response(content=json.dumps(response), media_type="application/json", status_code=200)[0m
[30;1m469 | [0m[35m[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m@api_chat.get("/options", response_class=Response)[0m
[30;1m472 | [0m[35masync def chat_options([0m
[30;1m473 | [0m[35m    request: Request,[0m
[30;1m474 | [0m[35m    common: CommonQueryParams,[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m    return Response(content=json.dumps(session_values), media_type="application/json", status_code=2[0m
[30;1m440 | [0m[35m[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m@api_chat.post("/sessions")[0m
[30;1m443 | [0m[35m@requires(["authenticated"])[0m
[30;1m444 | [0m[35masync def create_chat_session([0m
[30;1m445 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m    )[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m@api_chat.get("/sessions")[0m
[30;1m403 | [0m[35m@requires(["authenticated"])[0m
[30;1m404 | [0m[35mdef chat_sessions([0m
[30;1m405 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m    conversation_id: int,[0m
[30;1m375 | [0m[35m):[0m
[30;1m376 | [0m[35m    user = request.user.object[0m
[30;1m377 | [0m[35m    domain = request.headers.get("host")[0m
[30;1m378 | [0m[35m    scheme = request.url.scheme[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35m    # Throw unauthorized exception if domain not in ALLOWED_HOSTS[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35m    )[0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m@api_chat.post("/share")[0m
[30;1m370 | [0m[35m@requires(["authenticated"])[0m
[30;1m371 | [0m[35mdef duplicate_chat_history_public_conversation([0m
[30;1m372 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m    return {"status": "ok", "message": "Conversation history cleared"}[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m@api_chat.post("/share/fork")[0m
[30;1m329 | [0m[35m@requires(["authenticated"])[0m
[30;1m330 | [0m[35mdef fork_public_conversation([0m
[30;1m331 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        if n > 0 and meta_log.get("chat"):[0m
[30;1m291 | [0m[35m            meta_log["chat"] = meta_log["chat"][-n:][0m
[30;1m292 | [0m[35m        # Else return all messages except latest N[0m
[30;1m293 | [0m[35m        elif n < 0 and meta_log.get("chat"):[0m
[30;1m294 | [0m[35m            meta_log["chat"] = meta_log["chat"][:n][0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m    update_telemetry_state([0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m    if n:[0m
[30;1m289 | [0m[35m        # Get latest N messages if N > 0[0m
[30;1m290 | [0m[35m        if n > 0 and meta_log.get("chat"):[0m
[30;1m291 | [0m[35m            meta_log["chat"] = meta_log["chat"][-n:][0m
[30;1m292 | [0m[35m        # Else return all messages except latest N[0m
[30;1m293 | [0m[35m        elif n < 0 and meta_log.get("chat"):[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m    return {"status": "ok", "response": meta_log}[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m@api_chat.get("/share/history")[0m
[30;1m245 | [0m[35mdef get_shared_chat([0m
[30;1m246 | [0m[35m    request: Request,[0m
[30;1m247 | [0m[35m    common: CommonQueryParams,[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m        if n > 0 and meta_log.get("chat"):[0m
[30;1m229 | [0m[35m            meta_log["chat"] = meta_log["chat"][-n:][0m
[30;1m230 | [0m[35m        # Else return all messages except latest N[0m
[30;1m231 | [0m[35m        elif n < 0 and meta_log.get("chat"):[0m
[30;1m232 | [0m[35m            meta_log["chat"] = meta_log["chat"][:n][0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    update_telemetry_state([0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    if n:[0m
[30;1m227 | [0m[35m        # Get latest N messages if N > 0[0m
[30;1m228 | [0m[35m        if n > 0 and meta_log.get("chat"):[0m
[30;1m229 | [0m[35m            meta_log["chat"] = meta_log["chat"][-n:][0m
[30;1m230 | [0m[35m        # Else return all messages except latest N[0m
[30;1m231 | [0m[35m        elif n < 0 and meta_log.get("chat"):[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m    return Response(content=json.dumps(starter_questions), media_type="application/json", status_cod[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m@api_chat.get("/history")[0m
[30;1m184 | [0m[35m@requires(["authenticated"])[0m
[30;1m185 | [0m[35mdef chat_history([0m
[30;1m186 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m    return StreamingResponse(speech_stream.iter_content(chunk_size=1024), media_type="audio/mpeg")[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m@api_chat.get("/starters", response_class=Response)[0m
[30;1m173 | [0m[35m@requires(["authenticated"])[0m
[30;1m174 | [0m[35masync def chat_starters([0m
[30;1m175 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    await send_query_feedback(data.uquery, data.kquery, data.sentiment, user.email)[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m@api_chat.post("/speech")[0m
[30;1m149 | [0m[35m@requires(["authenticated"])[0m
[30;1m150 | [0m[35masync def text_to_speech([0m
[30;1m151 | [0m[35m    request: Request,[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m    sentiment: str[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m@api_chat.post("/feedback")[0m
[30;1m142 | [0m[35m@requires(["authenticated"])[0m
[30;1m143 | [0m[35masync def sendfeedback(request: Request, data: FeedbackData):[0m
[30;1m144 | [0m[35m    user: KhojUser = request.user.object[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m        raise HTTPException(status_code=422, detail=str(e))[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m@api_chat.post("/conversation/file-filters", response_class=Response)[0m
[30;1m114 | [0m[35m@requires(["authenticated"])[0m
[30;1m115 | [0m[35mdef add_file_filter(request: Request, filter: FileFilterRequest):[0m
[30;1m116 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m    return Response(content=json.dumps(file_filters), media_type="application/json", status_code=200[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m@api_chat.post("/conversation/file-filters/bulk", response_class=Response)[0m
[30;1m101 | [0m[35m@requires(["authenticated"])[0m
[30;1m102 | [0m[35mdef add_files_filter(request: Request, filter: FilesFilterRequest):[0m
[30;1m103 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35mfrom khoj.routers.email import send_query_feedback[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m@api_chat.get("/conversation/file-filters/{conversation_id}", response_class=Response)[0m
[30;1m74 | [0m[35m@requires(["authenticated"])[0m
[30;1m75 | [0m[35mdef get_file_filter(request: Request, conversation_id: str) -> Response:[0m
[30;1m76 | [0m[35m    conversation = ConversationAdapters.get_conversation_by_user([0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m649 | [0m[35m            if mode not in conversation_commands:[0m
[30;1m650 | [0m[35m                conversation_commands.append(mode)[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m        for cmd in conversation_commands:[0m
[30;1m653 | [0m[35m            await conversation_command_rate_limiter.update_and_check_if_valid(request, cmd)[0m
[30;1m654 | [0m[35m            q = q.replace(f"/{cmd.value}", "").strip()[0m
[30;1m655 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m637 | [0m[35m            conversation_commands = await aget_relevant_information_sources([0m
[30;1m638 | [0m[35m                q, meta_log, is_automated_task, subscribed=subscribed[0m
[30;1m639 | [0m[35m            )[0m
[30;1m640 | [0m[35m            conversation_commands_str = ", ".join([cmd.value for cmd in conversation_commands])[0m
[30;1m641 | [0m[35m            async for result in send_event([0m
[30;1m642 | [0m[35m                ChatEvent.STATUS, f"**Chose Data Sources to Search:** {conversation_commands_str}"[0m
[30;1m643 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m587 | [0m[35m            # Gather chat response telemetry[0m
[30;1m588 | [0m[35m            nonlocal chat_metadata[0m
[30;1m589 | [0m[35m            latency = time.perf_counter() - start_time[0m
[30;1m590 | [0m[35m            cmd_set = set([cmd.value for cmd in conversation_commands])[0m
[30;1m591 | [0m[35m            chat_metadata = chat_metadata or {}[0m
[30;1m592 | [0m[35m            chat_metadata["conversation_command"] = cmd_set[0m
[30;1m593 | [0m[35m            chat_metadata["agent"] = conversation.agent.slug if conversation.agent else None[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m475 | [0m[35m) -> Response:[0m
[30;1m476 | [0m[35m    cmd_options = {}[0m
[30;1m477 | [0m[35m    for cmd in ConversationCommand:[0m
[30;1m478 | [0m[35m        if cmd in command_descriptions:[0m
[30;1m479 | [0m[35m            cmd_options[cmd.value] = command_descriptions[cmd][0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m    update_telemetry_state([0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m474 | [0m[35m    common: CommonQueryParams,[0m
[30;1m475 | [0m[35m) -> Response:[0m
[30;1m476 | [0m[35m    cmd_options = {}[0m
[30;1m477 | [0m[35m    for cmd in ConversationCommand:[0m
[30;1m478 | [0m[35m        if cmd in command_descriptions:[0m
[30;1m479 | [0m[35m            cmd_options[cmd.value] = command_descriptions[cmd][0m
[30;1m480 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m679 | [0m[35m                try:[0m
[30;1m680 | [0m[35m                    file_object = await FileObjectAdapters.async_get_file_objects_by_name(user, file[0m
[30;1m681 | [0m[35m                    if len(file_object) == 0:[0m
[30;1m682 | [0m[35m                        response_log = "Sorry, we couldn't find the full text of this file. Please r[0m
[30;1m683 | [0m[35m                        async for result in send_llm_response(response_log):[0m
[30;1m684 | [0m[35m                            yield result[0m
[30;1m685 | [0m[35m                        return[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m594 | [0m[35m            chat_metadata["latency"] = f"{latency:.3f}"[0m
[30;1m595 | [0m[35m            chat_metadata["ttft_latency"] = f"{ttft:.3f}"[0m
[30;1m596 | [0m[35m[0m
[30;1m597 | [0m[35m            logger.info(f"Chat response time to first token: {ttft:.3f} seconds")[0m
[30;1m598 | [0m[35m            logger.info(f"Chat response total time: {latency:.3f} seconds")[0m
[30;1m599 | [0m[35m            update_telemetry_state([0m
[30;1m600 | [0m[35m                request=request,[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom datetime import datetime[0m
[30;1m6 | [0m[35mfrom functools import partial[0m
[30;1m7 | [0m[35mfrom typing import Dict, Optional[0m
[30;1m8 | [0m[35mfrom urllib.parse import unquote[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m    if not await sync_to_async(session.exists)(session_key=session_id):[0m
[30;1m372 | [0m[35m        raise HTTPException(status_code=401, detail="Invalid session")[0m
[30;1m373 | [0m[35m    session_data = await sync_to_async(session.load)()[0m
[30;1m374 | [0m[35m    user = await KhojUser.objects.filter(id=session_data.get("_auth_user_id")).afirst()[0m
[30;1m375 | [0m[35m    if not user:[0m
[30;1m376 | [0m[35m        raise HTTPException(status_code=401, detail="Invalid user")[0m
[30;1m377 | [0m[35m    return user[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35masync def get_user_by_token(token: dict) -> KhojUser:[0m
[30;1m344 | [0m[35m    google_user = await GoogleUser.objects.filter(sub=token.get("sub")).select_related("user").afirs[0m
[30;1m345 | [0m[35m    if not google_user:[0m
[30;1m346 | [0m[35m        return None[0m
[30;1m347 | [0m[35m    return google_user.user[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        given_name=token.get("given_name"),[0m
[30;1m207 | [0m[35m        family_name=token.get("family_name"),[0m
[30;1m208 | [0m[35m        picture=token.get("picture"),[0m
[30;1m209 | [0m[35m        locale=token.get("locale"),[0m
[30;1m210 | [0m[35m        user=user,[0m
[30;1m211 | [0m[35m    )[0m
[30;1m212 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        name=token.get("name"),[0m
[30;1m206 | [0m[35m        given_name=token.get("given_name"),[0m
[30;1m207 | [0m[35m        family_name=token.get("family_name"),[0m
[30;1m208 | [0m[35m        picture=token.get("picture"),[0m
[30;1m209 | [0m[35m        locale=token.get("locale"),[0m
[30;1m210 | [0m[35m        user=user,[0m
[30;1m211 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m        email=token.get("email"),[0m
[30;1m205 | [0m[35m        name=token.get("name"),[0m
[30;1m206 | [0m[35m        given_name=token.get("given_name"),[0m
[30;1m207 | [0m[35m        family_name=token.get("family_name"),[0m
[30;1m208 | [0m[35m        picture=token.get("picture"),[0m
[30;1m209 | [0m[35m        locale=token.get("locale"),[0m
[30;1m210 | [0m[35m        user=user,[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m        azp=token.get("azp"),[0m
[30;1m204 | [0m[35m        email=token.get("email"),[0m
[30;1m205 | [0m[35m        name=token.get("name"),[0m
[30;1m206 | [0m[35m        given_name=token.get("given_name"),[0m
[30;1m207 | [0m[35m        family_name=token.get("family_name"),[0m
[30;1m208 | [0m[35m        picture=token.get("picture"),[0m
[30;1m209 | [0m[35m        locale=token.get("locale"),[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        sub=token.get("sub"),[0m
[30;1m203 | [0m[35m        azp=token.get("azp"),[0m
[30;1m204 | [0m[35m        email=token.get("email"),[0m
[30;1m205 | [0m[35m        name=token.get("name"),[0m
[30;1m206 | [0m[35m        given_name=token.get("given_name"),[0m
[30;1m207 | [0m[35m        family_name=token.get("family_name"),[0m
[30;1m208 | [0m[35m        picture=token.get("picture"),[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m    await GoogleUser.objects.acreate([0m
[30;1m202 | [0m[35m        sub=token.get("sub"),[0m
[30;1m203 | [0m[35m        azp=token.get("azp"),[0m
[30;1m204 | [0m[35m        email=token.get("email"),[0m
[30;1m205 | [0m[35m        name=token.get("name"),[0m
[30;1m206 | [0m[35m        given_name=token.get("given_name"),[0m
[30;1m207 | [0m[35m        family_name=token.get("family_name"),[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m    await GoogleUser.objects.acreate([0m
[30;1m202 | [0m[35m        sub=token.get("sub"),[0m
[30;1m203 | [0m[35m        azp=token.get("azp"),[0m
[30;1m204 | [0m[35m        email=token.get("email"),[0m
[30;1m205 | [0m[35m        name=token.get("name"),[0m
[30;1m206 | [0m[35m        given_name=token.get("given_name"),[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m    await user.asave()[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m    await GoogleUser.objects.acreate([0m
[30;1m202 | [0m[35m        sub=token.get("sub"),[0m
[30;1m203 | [0m[35m        azp=token.get("azp"),[0m
[30;1m204 | [0m[35m        email=token.get("email"),[0m
[30;1m205 | [0m[35m        name=token.get("name"),[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35masync def create_user_by_google_token(token: dict) -> KhojUser:[0m
[30;1m195 | [0m[35m    user, _ = await KhojUser.objects.filter(email=token.get("email")).aupdate_or_create([0m
[30;1m196 | [0m[35m        defaults={"username": token.get("email"), "email": token.get("email")}[0m
[30;1m197 | [0m[35m    )[0m
[30;1m198 | [0m[35m    user.verified_email = True[0m
[30;1m199 | [0m[35m    await user.asave()[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35masync def create_user_by_google_token(token: dict) -> KhojUser:[0m
[30;1m195 | [0m[35m    user, _ = await KhojUser.objects.filter(email=token.get("email")).aupdate_or_create([0m
[30;1m196 | [0m[35m        defaults={"username": token.get("email"), "email": token.get("email")}[0m
[30;1m197 | [0m[35m    )[0m
[30;1m198 | [0m[35m    user.verified_email = True[0m
[30;1m199 | [0m[35m    await user.asave()[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35masync def create_user_by_google_token(token: dict) -> KhojUser:[0m
[30;1m195 | [0m[35m    user, _ = await KhojUser.objects.filter(email=token.get("email")).aupdate_or_create([0m
[30;1m196 | [0m[35m        defaults={"username": token.get("email"), "email": token.get("email")}[0m
[30;1m197 | [0m[35m    )[0m
[30;1m198 | [0m[35m    user.verified_email = True[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m252 | [0m[35m    user = await aget_or_create_user_by_email(email)[0m
[30;1m253 | [0m[35m    user_subscription = await Subscription.objects.filter(user=user).afirst()[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m    # Update the user subscription state[0m
[30;1m256 | [0m[35m    user_subscription.type = type[0m
[30;1m257 | [0m[35m    if is_recurring is not None:[0m
[30;1m258 | [0m[35m        user_subscription.is_recurring = is_recurring[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m                    ChatModelOptions.objects.create([0m
[30;1m129 | [0m[35m                        chat_model=openai.get("chat-model"),[0m
[30;1m130 | [0m[35m                        tokenizer=processor_conversation.get("tokenizer"),[0m
[30;1m131 | [0m[35m                        max_prompt_size=processor_conversation.get("max-prompt-size"),[0m
[30;1m132 | [0m[35m                        model_type=ChatModelOptions.ModelType.OPENAI,[0m
[30;1m133 | [0m[35m                        openai_config=openai_config,[0m
[30;1m134 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m                    ChatModelOptions.objects.create([0m
[30;1m129 | [0m[35m                        chat_model=openai.get("chat-model"),[0m
[30;1m130 | [0m[35m                        tokenizer=processor_conversation.get("tokenizer"),[0m
[30;1m131 | [0m[35m                        max_prompt_size=processor_conversation.get("max-prompt-size"),[0m
[30;1m132 | [0m[35m                        model_type=ChatModelOptions.ModelType.OPENAI,[0m
[30;1m133 | [0m[35m                        openai_config=openai_config,[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m                    )[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m                    ChatModelOptions.objects.create([0m
[30;1m129 | [0m[35m                        chat_model=openai.get("chat-model"),[0m
[30;1m130 | [0m[35m                        tokenizer=processor_conversation.get("tokenizer"),[0m
[30;1m131 | [0m[35m                        max_prompt_size=processor_conversation.get("max-prompt-size"),[0m
[30;1m132 | [0m[35m                        model_type=ChatModelOptions.ModelType.OPENAI,[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m                        openai["chat-model"] = "gpt-3.5-turbo"[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m                    openai_config = OpenAIProcessorConversationConfig.objects.create([0m
[30;1m125 | [0m[35m                        api_key=openai.get("api-key"), name="default"[0m
[30;1m126 | [0m[35m                    )[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m                    ChatModelOptions.objects.create([0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m                if openai.get("api-key") is None:[0m
[30;1m119 | [0m[35m                    logger.error("OpenAI API Key is not set. Will not be migrating OpenAI config.")[0m
[30;1m120 | [0m[35m                else:[0m
[30;1m121 | [0m[35m                    if openai.get("chat-model") is None:[0m
[30;1m122 | [0m[35m                        openai["chat-model"] = "gpt-3.5-turbo"[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m                    openai_config = OpenAIProcessorConversationConfig.objects.create([0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m            ):[0m
[30;1m116 | [0m[35m                openai = raw_config["processor"]["conversation"]["openai"][0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m                if openai.get("api-key") is None:[0m
[30;1m119 | [0m[35m                    logger.error("OpenAI API Key is not set. Will not be migrating OpenAI config.")[0m
[30;1m120 | [0m[35m                else:[0m
[30;1m121 | [0m[35m                    if openai.get("chat-model") is None:[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m                ChatModelOptions.objects.create([0m
[30;1m106 | [0m[35m                    chat_model=offline_chat.get("chat-model"),[0m
[30;1m107 | [0m[35m                    tokenizer=processor_conversation.get("tokenizer"),[0m
[30;1m108 | [0m[35m                    max_prompt_size=processor_conversation.get("max-prompt-size"),[0m
[30;1m109 | [0m[35m                    model_type=ChatModelOptions.ModelType.OFFLINE,[0m
[30;1m110 | [0m[35m                )[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m                offline_chat = raw_config["processor"]["conversation"]["offline-chat"][0m
[30;1m105 | [0m[35m                ChatModelOptions.objects.create([0m
[30;1m106 | [0m[35m                    chat_model=offline_chat.get("chat-model"),[0m
[30;1m107 | [0m[35m                    tokenizer=processor_conversation.get("tokenizer"),[0m
[30;1m108 | [0m[35m                    max_prompt_size=processor_conversation.get("max-prompt-size"),[0m
[30;1m109 | [0m[35m                    model_type=ChatModelOptions.ModelType.OFFLINE,[0m
[30;1m110 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m            if "offline-chat" in raw_config["processor"]["conversation"]:[0m
[30;1m104 | [0m[35m                offline_chat = raw_config["processor"]["conversation"]["offline-chat"][0m
[30;1m105 | [0m[35m                ChatModelOptions.objects.create([0m
[30;1m106 | [0m[35m                    chat_model=offline_chat.get("chat-model"),[0m
[30;1m107 | [0m[35m                    tokenizer=processor_conversation.get("tokenizer"),[0m
[30;1m108 | [0m[35m                    max_prompt_size=processor_conversation.get("max-prompt-size"),[0m
[30;1m109 | [0m[35m                    model_type=ChatModelOptions.ModelType.OFFLINE,[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m                    name="default",[0m
[30;1m95 | [0m[35m                    model_type=SearchModelConfig.ModelType.TEXT,[0m
[30;1m96 | [0m[35m                    bi_encoder=asymmetric_search.get("encoder"),[0m
[30;1m97 | [0m[35m                    cross_encoder=asymmetric_search.get("cross-encoder"),[0m
[30;1m98 | [0m[35m                )[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        if "processor" in raw_config and raw_config["processor"] and "conversation" in raw_config["p[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m                SearchModelConfig.objects.create([0m
[30;1m94 | [0m[35m                    name="default",[0m
[30;1m95 | [0m[35m                    model_type=SearchModelConfig.ModelType.TEXT,[0m
[30;1m96 | [0m[35m                    bi_encoder=asymmetric_search.get("encoder"),[0m
[30;1m97 | [0m[35m                    cross_encoder=asymmetric_search.get("cross-encoder"),[0m
[30;1m98 | [0m[35m                )[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_server_pg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35mdef migrate_server_pg(args):[0m
[30;1m74 | [0m[35m    schema_version = "0.15.0"[0m
[30;1m75 | [0m[35m    raw_config = load_config_from_file(args.config_file)[0m
[30;1m76 | [0m[35m    previous_version = raw_config.get("version")[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    if previous_version is None or version.parse(previous_version) < version.parse(schema_version):[0m
[30;1m79 | [0m[35m        logger.info([0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m                    json.dumps(log[field])[0m
[30;1m375 | [0m[35m                except TypeError:[0m
[30;1m376 | [0m[35m                    log[field] = str(log[field])[0m
[30;1m377 | [0m[35m        response = requests.post(constants.telemetry_server, json=state.telemetry)[0m
[30;1m378 | [0m[35m        response.raise_for_status()[0m
[30;1m379 | [0m[35m    except Exception as e:[0m
[30;1m380 | [0m[35m        logger.error(f"üì° Error uploading telemetry: {e}", exc_info=True)[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m    app.add_middleware(AsyncCloseConnectionsMiddleware)[0m
[30;1m329 | [0m[35m    app.add_middleware(AuthenticationMiddleware, backend=UserAuthenticationBackend())[0m
[30;1m330 | [0m[35m    app.add_middleware(NextJsMiddleware)[0m
[30;1m331 | [0m[35m    app.add_middleware(SessionMiddleware, secret_key=os.environ.get("KHOJ_DJANGO_SECRET_KEY", "!secr[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35mdef update_content_index():[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m            if not phone_number.startswith("+"):[0m
[30;1m164 | [0m[35m                phone_number = f"+{phone_number}"[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m            create_if_not_exists = request.query_params.get("create_if_not_exists")[0m
[30;1m167 | [0m[35m            if create_if_not_exists:[0m
[30;1m168 | [0m[35m                user = await aget_or_create_user_by_phone_number(phone_number)[0m
[30;1m169 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m            if client_application is None:[0m
[30;1m157 | [0m[35m                return AuthCredentials(), UnauthenticatedUser()[0m
[30;1m158 | [0m[35m            # Get the identifier used for the user[0m
[30;1m159 | [0m[35m            phone_number = request.query_params.get("phone_number")[0m
[30;1m160 | [0m[35m            if is_none_or_empty(phone_number):[0m
[30;1m161 | [0m[35m                return AuthCredentials(), UnauthenticatedUser()[0m
[30;1m162 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                return AuthCredentials(["authenticated"]), AuthenticatedKhojUser(user_with_token.use[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m        # Request from Whatsapp client[0m
[30;1m144 | [0m[35m        client_id = request.query_params.get("client_id")[0m
[30;1m145 | [0m[35m        if client_id:[0m
[30;1m146 | [0m[35m            # Get the client secret, which is passed in the Authorization header[0m
[30;1m147 | [0m[35m            client_secret = request.headers["Authorization"].split("Bearer ")[1][0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m                return AuthCredentials(["authenticated"]), AuthenticatedKhojUser(user)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        # Request from Desktop, Emacs, Obsidian clients[0m
[30;1m127 | [0m[35m        if len(request.headers.get("Authorization", "").split("Bearer ")) == 2:[0m
[30;1m128 | [0m[35m            # Get bearer token from header[0m
[30;1m129 | [0m[35m            bearer_token = request.headers["Authorization"].split("Bearer ")[1][0m
[30;1m130 | [0m[35m            # Get user owning token[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m        current_user = request.session.get("user")[0m
[30;1m114 | [0m[35m        if current_user and current_user.get("email"):[0m
[30;1m115 | [0m[35m            user = ([0m
[30;1m116 | [0m[35m                await self.khojuser_manager.filter(email=current_user.get("email"))[0m
[30;1m117 | [0m[35m                .prefetch_related("subscription")[0m
[30;1m118 | [0m[35m                .afirst()[0m
[30;1m119 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    async def authenticate(self, request: HTTPConnection):[0m
[30;1m113 | [0m[35m        current_user = request.session.get("user")[0m
[30;1m114 | [0m[35m        if current_user and current_user.get("email"):[0m
[30;1m115 | [0m[35m            user = ([0m
[30;1m116 | [0m[35m                await self.khojuser_manager.filter(email=current_user.get("email"))[0m
[30;1m117 | [0m[35m                .prefetch_related("subscription")[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            Subscription.objects.create(user=default_user, type="standard", renewal_date=renewal_dat[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    async def authenticate(self, request: HTTPConnection):[0m
[30;1m113 | [0m[35m        current_user = request.session.get("user")[0m
[30;1m114 | [0m[35m        if current_user and current_user.get("email"):[0m
[30;1m115 | [0m[35m            user = ([0m
[30;1m116 | [0m[35m                await self.khojuser_manager.filter(email=current_user.get("email"))[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m338 | [0m[35m    all_files = collect_files(user=None)[0m
[30;1m339 | [0m[35m    success = configure_content(all_files, user=None)[0m
[30;1m340 | [0m[35m    if not success:[0m
[30;1m341 | [0m[35m        raise RuntimeError("Failed to update content index")[0m
[30;1m342 | [0m[35m    logger.info("üì™ Content index updated via Scheduler")[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m272 | [0m[35m                user=user,[0m
[30;1m273 | [0m[35m            )[0m
[30;1m274 | [0m[35m            if not status:[0m
[30;1m275 | [0m[35m                raise RuntimeError("Failed to update content index")[0m
[30;1m276 | [0m[35m        except Exception as e:[0m
[30;1m277 | [0m[35m            raise e[0m
[30;1m278 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m201 | [0m[35m    init=False,[0m
[30;1m202 | [0m[35m    user: KhojUser = None,[0m
[30;1m203 | [0m[35m):[0m
[30;1m204 | [0m[35m    # Update Config[0m
[30;1m205 | [0m[35m    if config == None:[0m
[30;1m206 | [0m[35m        logger.info(f"üö® Khoj is not configured.\nInitializing it with a default config.")[0m
[30;1m207 | [0m[35m        config = FullConfig()[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/configure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m66 | [0m[35m    (used by Django) have divergent behavior, ultimately acquiring the incorrect thread[0m
[30;1m67 | [0m[35m    in mixed sync/async which has the effect of duplicating connections.[0m
[30;1m68 | [0m[35m    We could fix the duplicate connections too if we normalized the thread behavior,[0m
[30;1m69 | [0m[35m    but at minimum we need to clean up connections in each case to prevent persistent[0m
[30;1m70 | [0m[35m    "InterfaceError: connection already closed" errors when the database connection is[0m
[30;1m71 | [0m[35m    reset via a database restart or something -- so here we are![0m
[30;1m72 | [0m[35m    If we always use smart_sync_to_async(), this double calling isn't necessary, but[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/models/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m161 | [0m[35m        SCHEDULE_LEADER = "schedule_leader"[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    # We need to make sure that some operations are thread-safe. To do so, add locks for potentially[0m
[30;1m164 | [0m[35m    # For example, we need to make sure that only one process is updating the embeddings at a time.[0m
[30;1m165 | [0m[35m    name = models.CharField(max_length=200, choices=Operation.choices, unique=True)[0m
[30;1m166 | [0m[35m    started_at = models.DateTimeField(auto_now_add=True)[0m
[30;1m167 | [0m[35m    max_duration_in_seconds = models.IntegerField(default=60 * 60 * 12)  # 12 hours[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/models/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m    class StyleColorTypes(models.TextChoices):[0m
[30;1m108 | [0m[35m        BLUE = "blue"[0m
[30;1m109 | [0m[35m        GREEN = "green"[0m
[30;1m110 | [0m[35m        RED = "red"[0m
[30;1m111 | [0m[35m        YELLOW = "yellow"[0m
[30;1m112 | [0m[35m        ORANGE = "orange"[0m
[30;1m113 | [0m[35m        PURPLE = "purple"[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/openai/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m    messages, model, temperature=0, openai_api_key=None, api_base_url=None, model_kwargs=None[0m
[30;1m37 | [0m[35m) -> str:[0m
[30;1m38 | [0m[35m    client_key = f"{openai_api_key}--{api_base_url}"[0m
[30;1m39 | [0m[35m    client: openai.OpenAI | None = openai_clients.get(client_key)[0m
[30;1m40 | [0m[35m    if not client:[0m
[30;1m41 | [0m[35m        client = openai.OpenAI([0m
[30;1m42 | [0m[35m            api_key=openai_api_key,[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/web/content_source_github_input.html[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m        }[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m        if (repos.length == 0) {[0m
[30;1m157 | [0m[35m            document.getElementById("success").textContent = "‚ùå Please add at least one repository."[0m
[30;1m158 | [0m[35m            document.getElementById("success").style.display = "block";[0m
[30;1m159 | [0m[35m            return;[0m
[30;1m160 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/openai/gpt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        [[0m
[30;1m40 | [0m[35m            f'Q: {chat["intent"]["query"]}\nKhoj: {{"queries": {chat["intent"].get("inferred-queries[0m
[30;1m41 | [0m[35m            for chat in conversation_log.get("chat", [])[-4:][0m
[30;1m42 | [0m[35m            if chat["by"] == "khoj" and "text-to-image" not in chat["intent"].get("type")[0m
[30;1m43 | [0m[35m        ][0m
[30;1m44 | [0m[35m    )[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/openai/gpt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    chat_history = "".join([0m
[30;1m39 | [0m[35m        [[0m
[30;1m40 | [0m[35m            f'Q: {chat["intent"]["query"]}\nKhoj: {{"queries": {chat["intent"].get("inferred-queries[0m
[30;1m41 | [0m[35m            for chat in conversation_log.get("chat", [])[-4:][0m
[30;1m42 | [0m[35m            if chat["by"] == "khoj" and "text-to-image" not in chat["intent"].get("type")[0m
[30;1m43 | [0m[35m        ][0m
[30;1m44 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/openai/gpt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m    # Extract Past User Message and Inferred Questions from Conversation Log[0m
[30;1m38 | [0m[35m    chat_history = "".join([0m
[30;1m39 | [0m[35m        [[0m
[30;1m40 | [0m[35m            f'Q: {chat["intent"]["query"]}\nKhoj: {{"queries": {chat["intent"].get("inferred-queries[0m
[30;1m41 | [0m[35m            for chat in conversation_log.get("chat", [])[-4:][0m
[30;1m42 | [0m[35m            if chat["by"] == "khoj" and "text-to-image" not in chat["intent"].get("type")[0m
[30;1m43 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m    owner = final_response.get("owner")[0m
[30;1m72 | [0m[35m    workspace_id = final_response.get("workspace_id")[0m
[30;1m73 | [0m[35m    workspace_name = final_response.get("workspace_name")[0m
[30;1m74 | [0m[35m    bot_id = final_response.get("bot_id")[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    logger.info([0m
[30;1m77 | [0m[35m        f"Notion integration. Owner: {owner}, Workspace ID: {workspace_id}, Workspace Name: {workspa[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    owner = final_response.get("owner")[0m
[30;1m72 | [0m[35m    workspace_id = final_response.get("workspace_id")[0m
[30;1m73 | [0m[35m    workspace_name = final_response.get("workspace_name")[0m
[30;1m74 | [0m[35m    bot_id = final_response.get("bot_id")[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    logger.info([0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    await NotionConfig.objects.acreate(token=access_token, user=user)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    owner = final_response.get("owner")[0m
[30;1m72 | [0m[35m    workspace_id = final_response.get("workspace_id")[0m
[30;1m73 | [0m[35m    workspace_name = final_response.get("workspace_name")[0m
[30;1m74 | [0m[35m    bot_id = final_response.get("bot_id")[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m    access_token = final_response.get("access_token")[0m
[30;1m69 | [0m[35m    await NotionConfig.objects.acreate(token=access_token, user=user)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    owner = final_response.get("owner")[0m
[30;1m72 | [0m[35m    workspace_id = final_response.get("workspace_id")[0m
[30;1m73 | [0m[35m    workspace_name = final_response.get("workspace_name")[0m
[30;1m74 | [0m[35m    bot_id = final_response.get("bot_id")[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    logger.info(f"Notion auth callback response: {final_response}")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    access_token = final_response.get("access_token")[0m
[30;1m69 | [0m[35m    await NotionConfig.objects.acreate(token=access_token, user=user)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    owner = final_response.get("owner")[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        "redirect_uri": NOTION_REDIRECT_URI,[0m
[30;1m60 | [0m[35m    }[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    response = requests.post("https://api.notion.com/v1/oauth/token", data=json.dumps(data), headers[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    final_response = response.json()[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m@notion_router.get("/auth/callback")[0m
[30;1m34 | [0m[35masync def notion_auth_callback(request: Request, background_tasks: BackgroundTasks):[0m
[30;1m35 | [0m[35m    code = request.query_params.get("code")[0m
[30;1m36 | [0m[35m    state = request.query_params.get("state")[0m
[30;1m37 | [0m[35m    if not code or not state:[0m
[30;1m38 | [0m[35m        return Response("Missing code or state", status_code=400)[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m@notion_router.get("/auth/callback")[0m
[30;1m34 | [0m[35masync def notion_auth_callback(request: Request, background_tasks: BackgroundTasks):[0m
[30;1m35 | [0m[35m    code = request.query_params.get("code")[0m
[30;1m36 | [0m[35m    state = request.query_params.get("state")[0m
[30;1m37 | [0m[35m    if not code or not state:[0m
[30;1m38 | [0m[35m        return Response("Missing code or state", status_code=400)[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m    return await loop.run_in_executor(executor, func, *args)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m@notion_router.get("/auth/callback")[0m
[30;1m34 | [0m[35masync def notion_auth_callback(request: Request, background_tasks: BackgroundTasks):[0m
[30;1m35 | [0m[35m    code = request.query_params.get("code")[0m
[30;1m36 | [0m[35m    state = request.query_params.get("state")[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/notion.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/anthropic/anthropic_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m        [[0m
[30;1m41 | [0m[35m            f'User: {chat["intent"]["query"]}\nAssistant: {{"queries": {chat["intent"].get("inferred[0m
[30;1m42 | [0m[35m            for chat in conversation_log.get("chat", [])[-4:][0m
[30;1m43 | [0m[35m            if chat["by"] == "khoj" and "text-to-image" not in chat["intent"].get("type")[0m
[30;1m44 | [0m[35m        ][0m
[30;1m45 | [0m[35m    )[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/anthropic/anthropic_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m    chat_history = "".join([0m
[30;1m40 | [0m[35m        [[0m
[30;1m41 | [0m[35m            f'User: {chat["intent"]["query"]}\nAssistant: {{"queries": {chat["intent"].get("inferred[0m
[30;1m42 | [0m[35m            for chat in conversation_log.get("chat", [])[-4:][0m
[30;1m43 | [0m[35m            if chat["by"] == "khoj" and "text-to-image" not in chat["intent"].get("type")[0m
[30;1m44 | [0m[35m        ][0m
[30;1m45 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/conversation/anthropic/anthropic_chat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    # Extract Past User Message and Inferred Questions from Conversation Log[0m
[30;1m39 | [0m[35m    chat_history = "".join([0m
[30;1m40 | [0m[35m        [[0m
[30;1m41 | [0m[35m            f'User: {chat["intent"]["query"]}\nAssistant: {{"queries": {chat["intent"].get("inferred[0m
[30;1m42 | [0m[35m            for chat in conversation_log.get("chat", [])[-4:][0m
[30;1m43 | [0m[35m            if chat["by"] == "khoj" and "text-to-image" not in chat["intent"].get("type")[0m
[30;1m44 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m    return RedirectResponse(url=next_url, status_code=HTTP_302_FOUND)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m@auth_router.get("/logout")[0m
[30;1m179 | [0m[35masync def logout(request: Request):[0m
[30;1m180 | [0m[35m    request.session.pop("user", None)[0m
[30;1m181 | [0m[35m    return RedirectResponse(url="/")[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m        return Response("Invalid CSRF token", status_code=400)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    try:[0m
[30;1m156 | [0m[35m        idinfo = id_token.verify_oauth2_token(credential, google_requests.Request(), os.environ["GOO[0m
[30;1m157 | [0m[35m    except OAuthError as error:[0m
[30;1m158 | [0m[35m        return HTMLResponse(f"<h1>{error.error}</h1>")[0m
[30;1m159 | [0m[35m    khoj_user = await get_or_create_user(idinfo)[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    if not csrf_token_cookie:[0m
[30;1m146 | [0m[35m        logger.info("Missing CSRF token. Redirecting user to login page")[0m
[30;1m147 | [0m[35m        return RedirectResponse(url=next_url)[0m
[30;1m148 | [0m[35m    csrf_token_body = form.get("g_csrf_token")[0m
[30;1m149 | [0m[35m    if not csrf_token_body:[0m
[30;1m150 | [0m[35m        logger.info("Missing CSRF token body. Redirecting user to login page")[0m
[30;1m151 | [0m[35m        return RedirectResponse(url=next_url)[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    credential = form.get("credential")[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    csrf_token_cookie = request.cookies.get("g_csrf_token")[0m
[30;1m145 | [0m[35m    if not csrf_token_cookie:[0m
[30;1m146 | [0m[35m        logger.info("Missing CSRF token. Redirecting user to login page")[0m
[30;1m147 | [0m[35m        return RedirectResponse(url=next_url)[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m        if not q == "next":[0m
[30;1m140 | [0m[35m            next_url += f"&{q}={request.query_params[q]}"[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    credential = form.get("credential")[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    csrf_token_cookie = request.cookies.get("g_csrf_token")[0m
[30;1m145 | [0m[35m    if not csrf_token_cookie:[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m    return await delete_khoj_token(user=request.user.object, token=token)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m@auth_router.post("/redirect")[0m
[30;1m135 | [0m[35masync def auth(request: Request):[0m
[30;1m136 | [0m[35m    form = await request.form()[0m
[30;1m137 | [0m[35m    next_url = get_next_url(request)[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    }[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m@auth_router.get("/token")[0m
[30;1m120 | [0m[35m@requires(["authenticated"], redirect="login_page")[0m
[30;1m121 | [0m[35mdef get_tokens(request: Request):[0m
[30;1m122 | [0m[35m    "Get API tokens enabled for given user"[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m    return RedirectResponse(request.app.url_path_for("login_page"))[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m@auth_router.post("/token")[0m
[30;1m106 | [0m[35m@requires(["authenticated"], redirect="login_page")[0m
[30;1m107 | [0m[35masync def generate_token(request: Request, token_name: Optional[str] = None):[0m
[30;1m108 | [0m[35m    "Generate API token for given user"[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    return Response(status_code=200)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m@auth_router.get("/magic")[0m
[30;1m93 | [0m[35masync def sign_in_with_magic_link(request: Request, code: str):[0m
[30;1m94 | [0m[35m    user = await aget_user_validated_by_email_verification_code(code)[0m
[30;1m95 | [0m[35m    if user:[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    return await oauth.google.authorize_redirect(request, redirect_uri)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m@auth_router.post("/magic")[0m
[30;1m77 | [0m[35masync def login_magic_link(request: Request, form: MagicLinkForm):[0m
[30;1m78 | [0m[35m    if request.user.is_authenticated:[0m
[30;1m79 | [0m[35m        # Clear the session if user is already authenticated[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m    return await oauth.google.authorize_redirect(request, redirect_uri)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m@auth_router.post("/login")[0m
[30;1m71 | [0m[35masync def login(request: Request):[0m
[30;1m72 | [0m[35m    redirect_uri = str(request.app.url_path_for("auth"))[0m
[30;1m73 | [0m[35m    return await oauth.google.authorize_redirect(request, redirect_uri)[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    oauth.register(name="google", server_metadata_url=CONF_URL, client_kwargs={"scope": "openid emai[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m@auth_router.get("/login")[0m
[30;1m65 | [0m[35masync def login_get(request: Request):[0m
[30;1m66 | [0m[35m    redirect_uri = str(request.app.url_path_for("auth"))[0m
[30;1m67 | [0m[35m    return await oauth.google.authorize_redirect(request, redirect_uri)[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    except ImportError:[0m
[30;1m44 | [0m[35m        missing_requirements += ["Install the Khoj production package with `pip install khoj[prod]`"[0m
[30;1m45 | [0m[35m    if not os.environ.get("RESEND_API_KEY") and ([0m
[30;1m46 | [0m[35m        not os.environ.get("GOOGLE_CLIENT_ID") or not os.environ.get("GOOGLE_CLIENT_SECRET")[0m
[30;1m47 | [0m[35m    ):[0m
[30;1m48 | [0m[35m        missing_requirements += [[0m
[30;1m49 | [0m[35m            "Set your RESEND_API_KEY or GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET as environment var[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    except ImportError:[0m
[30;1m44 | [0m[35m        missing_requirements += ["Install the Khoj production package with `pip install khoj[prod]`"[0m
[30;1m45 | [0m[35m    if not os.environ.get("RESEND_API_KEY") and ([0m
[30;1m46 | [0m[35m        not os.environ.get("GOOGLE_CLIENT_ID") or not os.environ.get("GOOGLE_CLIENT_SECRET")[0m
[30;1m47 | [0m[35m    ):[0m
[30;1m48 | [0m[35m        missing_requirements += [[0m
[30;1m49 | [0m[35m            "Set your RESEND_API_KEY or GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET as environment var[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        from google.oauth2 import id_token[0m
[30;1m43 | [0m[35m    except ImportError:[0m
[30;1m44 | [0m[35m        missing_requirements += ["Install the Khoj production package with `pip install khoj[prod]`"[0m
[30;1m45 | [0m[35m    if not os.environ.get("RESEND_API_KEY") and ([0m
[30;1m46 | [0m[35m        not os.environ.get("GOOGLE_CLIENT_ID") or not os.environ.get("GOOGLE_CLIENT_SECRET")[0m
[30;1m47 | [0m[35m    ):[0m
[30;1m48 | [0m[35m        missing_requirements += [[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m### Install Khoj[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m```bash[0m
[30;1m68 | [0m[35mpip install -e '.[dev]'[0m
[30;1m69 | [0m[35m```[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m### Make Khoj DB migrations[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m2. Follow instructions to [Install PgVector](https://github.com/pgvector/pgvector#installation) in c[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m```bash[0m
[30;1m42 | [0m[35mcd /tmp[0m
[30;1m43 | [0m[35mgit clone --branch v0.5.1 https://github.com/pgvector/pgvector.git[0m
[30;1m44 | [0m[35mcd pgvector[0m
[30;1m45 | [0m[35mmake[0m
[30;1m46 | [0m[35mmake install # may need sudo[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m```bash[0m
[30;1m29 | [0m[35msudo apt install -y postgresql-common[0m
[30;1m30 | [0m[35msudo /usr/share/postgresql-common/pgdg/apt.postgresql.org.sh[0m
[30;1m31 | [0m[35msudo apt install postgres-16 postgresql-16-pgvector[0m
[30;1m32 | [0m[35m```[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m#### Windows[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35mFrom [official instructions](https://wiki.postgresql.org/wiki/Apt)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m```bash[0m
[30;1m29 | [0m[35msudo apt install -y postgresql-common[0m
[30;1m30 | [0m[35msudo /usr/share/postgresql-common/pgdg/apt.postgresql.org.sh[0m
[30;1m31 | [0m[35msudo apt install postgres-16 postgresql-16-pgvector[0m
[30;1m32 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/app/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Django App[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mKhoj uses Django as the backend framework primarily for its powerful ORM and the admin interface. Th[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m## Setup (Docker)[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/subscription.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35msubscription_router = APIRouter()[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m@subscription_router.post("")[0m
[30;1m23 | [0m[35masync def subscribe(request: Request):[0m
[30;1m24 | [0m[35m    """Webhook for Stripe to send subscription events to Khoj Cloud"""[0m
[30;1m25 | [0m[35m    event = None[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/subscription.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m96 | [0m[35m        # Find the subscription that is set to cancel at the end of the period[0m
[30;1m97 | [0m[35m        for subscription in subscriptions:[0m
[30;1m98 | [0m[35m            if subscription.cancel_at_period_end:[0m
[30;1m99 | [0m[35m                # Update the subscription to not cancel at the end of the period[0m
[30;1m100 | [0m[35m                stripe.Subscription.modify(subscription.id, cancel_at_period_end=False)[0m
[30;1m101 | [0m[35m                return {"success": True}[0m
[30;1m102 | [0m[35m        return {"success": False, "message": "No subscription found that is set to cancel"}[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/subscription.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m96 | [0m[35m        # Find the subscription that is set to cancel at the end of the period[0m
[30;1m97 | [0m[35m        for subscription in subscriptions:[0m
[30;1m98 | [0m[35m            if subscription.cancel_at_period_end:[0m
[30;1m99 | [0m[35m                # Update the subscription to not cancel at the end of the period[0m
[30;1m100 | [0m[35m                stripe.Subscription.modify(subscription.id, cancel_at_period_end=False)[0m
[30;1m101 | [0m[35m                return {"success": True}[0m
[30;1m102 | [0m[35m        return {"success": False, "message": "No subscription found that is set to cancel"}[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/subscription.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    elif operation == "resubscribe":[0m
[30;1m95 | [0m[35m        subscriptions = stripe.Subscription.list(customer=customer.id).auto_paging_iter()[0m
[30;1m96 | [0m[35m        # Find the subscription that is set to cancel at the end of the period[0m
[30;1m97 | [0m[35m        for subscription in subscriptions:[0m
[30;1m98 | [0m[35m            if subscription.cancel_at_period_end:[0m
[30;1m99 | [0m[35m                # Update the subscription to not cancel at the end of the period[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/subscription.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m52 | [0m[35m    # Handle valid stripe webhook events[0m
[30;1m53 | [0m[35m    success = True[0m
[30;1m54 | [0m[35m    if event_type in {"invoice.paid"}:[0m
[30;1m55 | [0m[35m        # Mark the user as subscribed and update the next renewal date on payment[0m
[30;1m56 | [0m[35m        subscription = stripe.Subscription.list(customer=customer_id).data[0][0m
[30;1m57 | [0m[35m        renewal_date = datetime.fromtimestamp(subscription["current_period_end"], tz=timezone.utc)[0m
[30;1m58 | [0m[35m        user = await adapters.set_user_subscription(customer_email, is_recurring=True, renewal_date=[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/routers/subscription.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    elif operation == "resubscribe":[0m
[30;1m95 | [0m[35m        subscriptions = stripe.Subscription.list(customer=customer.id).auto_paging_iter()[0m
[30;1m96 | [0m[35m        # Find the subscription that is set to cancel at the end of the period[0m
[30;1m97 | [0m[35m        for subscription in subscriptions:[0m
[30;1m98 | [0m[35m            if subscription.cancel_at_period_end:[0m
[30;1m99 | [0m[35m                # Update the subscription to not cancel at the end of the period[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m        response = self.session.get(file_url, headers=headers, stream=True)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m        # Stop indexing on hitting rate limit[0m
[30;1m178 | [0m[35m        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":[0m
[30;1m179 | [0m[35m            raise ConnectionAbortedError("Github rate limit reached")[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        content = "" if decode else b""[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m    def get_file_contents(self, file_url, decode=True):[0m
[30;1m173 | [0m[35m        # Get text from each markdown file[0m
[30;1m174 | [0m[35m        headers = {"Accept": "application/vnd.github.v3.raw"}[0m
[30;1m175 | [0m[35m        response = self.session.get(file_url, headers=headers, stream=True)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m        # Stop indexing on hitting rate limit[0m
[30;1m178 | [0m[35m        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m        contents = response.json()[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        # Raise exception if hit rate limit[0m
[30;1m123 | [0m[35m        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":[0m
[30;1m124 | [0m[35m            raise ConnectionAbortedError("Github rate limit reached")[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        # Extract markdown files from the repository[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        repo_content_url = f"{repo_url}/git/trees/{repo.branch}"[0m
[30;1m117 | [0m[35m        headers = {"Authorization": f"token {self.config.pat_token}"}[0m
[30;1m118 | [0m[35m        params = {"recursive": "true"}[0m
[30;1m119 | [0m[35m        response = requests.get(repo_content_url, headers=headers, params=params)[0m
[30;1m120 | [0m[35m        contents = response.json()[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        # Raise exception if hit rate limit[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    @staticmethod[0m
[30;1m42 | [0m[35m    def wait_for_rate_limit_reset(response, func, *args, **kwargs):[0m
[30;1m43 | [0m[35m        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":[0m
[30;1m44 | [0m[35m            wait_time = int(response.headers.get("X-RateLimit-Reset")) - int(time.time())[0m
[30;1m45 | [0m[35m            logger.info(f"Github Rate limit reached. Waiting for {wait_time} seconds")[0m
[30;1m46 | [0m[35m            time.sleep(wait_time)[0m
[30;1m47 | [0m[35m            return func(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    @staticmethod[0m
[30;1m42 | [0m[35m    def wait_for_rate_limit_reset(response, func, *args, **kwargs):[0m
[30;1m43 | [0m[35m        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":[0m
[30;1m44 | [0m[35m            wait_time = int(response.headers.get("X-RateLimit-Reset")) - int(time.time())[0m
[30;1m45 | [0m[35m            logger.info(f"Github Rate limit reached. Waiting for {wait_time} seconds")[0m
[30;1m46 | [0m[35m            time.sleep(wait_time)[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m163 | [0m[35m                    try:[0m
[30;1m164 | [0m[35m                        content_str = content_bytes.decode("utf-8")[0m
[30;1m165 | [0m[35m                    except:[0m
[30;1m166 | [0m[35m                        logger.error(f"Unable to decode content of file at {url_path}. Skip indexing[0m
[30;1m167 | [0m[35m                        continue[0m
[30;1m168 | [0m[35m                    plaintext_files += [{"content": content_str, "path": url_path}][0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m155 | [0m[35m                try:[0m
[30;1m156 | [0m[35m                    content_type = magika.identify_bytes(content_bytes).output.group[0m
[30;1m157 | [0m[35m                except:[0m
[30;1m158 | [0m[35m                    logger.error(f"Unable to identify content type of file at {url_path}. Skip index[0m
[30;1m159 | [0m[35m                    continue[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m                # Add non-binary file contents and URL to list[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m                # Add markdown file contents and URL to list[0m
[30;1m140 | [0m[35m                markdown_files += [{"content": self.get_file_contents(item["url"]), "path": url_path[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m            # Find all org files in the repository[0m
[30;1m143 | [0m[35m            elif item["type"] == "blob" and item["path"].endswith(".org"):[0m
[30;1m144 | [0m[35m                # Create URL for each org file on Github[0m
[30;1m145 | [0m[35m                url_path = f'https://github.com/{repo.owner}/{repo.name}/blob/{repo.branch}/{item["p[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m            return markdown_files, org_files, plaintext_files[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        for item in contents["tree"]:[0m
[30;1m134 | [0m[35m            # Find all markdown files in the repository[0m
[30;1m135 | [0m[35m            if item["type"] == "blob" and item["path"].endswith(".md"):[0m
[30;1m136 | [0m[35m                # Create URL for each markdown file on Github[0m
[30;1m137 | [0m[35m                url_path = f'https://github.com/{repo.owner}/{repo.name}/blob/{repo.branch}/{item["p[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom typing import Any, Dict, List, Tuple[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport requests[0m
[30;1m6 | [0m[35mfrom magika import Magika[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/admin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        for conversation in queryset:[0m
[30;1m264 | [0m[35m            return_log = dict()[0m
[30;1m265 | [0m[35m            chat_log = conversation.conversation_log.get("chat", [])[0m
[30;1m266 | [0m[35m            for idx, log in enumerate(chat_log):[0m
[30;1m267 | [0m[35m                updated_log = {}[0m
[30;1m268 | [0m[35m                for key in fields_to_keep:[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/database/admin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        for conversation in queryset:[0m
[30;1m224 | [0m[35m            modified_log = conversation.conversation_log[0m
[30;1m225 | [0m[35m            chat_log = modified_log.get("chat", [])[0m
[30;1m226 | [0m[35m            for idx, log in enumerate(chat_log):[0m
[30;1m227 | [0m[35m                if ([0m
[30;1m228 | [0m[35m                    log["by"] == "khoj"[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m        Returns the value of the requested property or null if the[0m
[30;1m423 | [0m[35m        property does not exist.[0m
[30;1m424 | [0m[35m        """[0m
[30;1m425 | [0m[35m        return self._properties.get(property_key, "")[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m    @property[0m
[30;1m428 | [0m[35m    def scheduled(self):[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m308 | [0m[35m    @ancestors.setter[0m
[30;1m309 | [0m[35m    def ancestors(self, new_ancestors):[0m
[30;1m310 | [0m[35m        """[0m
[30;1m311 | [0m[35m        Update the ancestor headings of the node[0m
[30;1m312 | [0m[35m        """[0m
[30;1m313 | [0m[35m        self._ancestor_headings = new_ancestors[0m
[30;1m314 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m251 | [0m[35m                n.heading = todo_search.group(2)[0m
[30;1m252 | [0m[35m                n.todo = todo_search.group(1)[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        # extract, set priority from heading, update heading if necessary[0m
[30;1m255 | [0m[35m        priority_search = re.search(r"^\[\#(A|B|C)\] (.*?)$", n.heading)[0m
[30;1m256 | [0m[35m        if priority_search:[0m
[30;1m257 | [0m[35m            n.priority = priority_search.group(1)[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m224 | [0m[35m                    introtext += line[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    # write out intro node before headings[0m
[30;1m227 | [0m[35m    # this is done at the end to allow collating all title lines[0m
[30;1m228 | [0m[35m    if introtext:[0m
[30;1m229 | [0m[35m        thisNode = Orgnode(level, file_title, introtext, tags)[0m
[30;1m230 | [0m[35m        nodelist = [thisNode] + nodelist[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m# February - March 2009[0m
[30;1m25 | [0m[35m# Version 2 - June 2009[0m
[30;1m26 | [0m[35m#   Added support for all tags, TODO priority and checking existence of a tag[0m
[30;1m27 | [0m[35m# More information at[0m
[30;1m28 | [0m[35m#    http://members.optusnet.com.au/~charles57/GTD[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m"""[0m
[30;1m31 | [0m[35mThe Orgnode module consists of the Orgnode class for representing a[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m    def __repr__(self):[0m
[30;1m484 | [0m[35m        """[0m
[30;1m485 | [0m[35m        Print the level, heading text and tag of a node and the body[0m
[30;1m486 | [0m[35m        text as used to construct the node.[0m
[30;1m487 | [0m[35m        """[0m
[30;1m488 | [0m[35m        # Output heading line[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m345 | [0m[35m    def level(self):[0m
[30;1m346 | [0m[35m        """[0m
[30;1m347 | [0m[35m        Returns an integer corresponding to the level of the node.[0m
[30;1m348 | [0m[35m        Top level (one asterisk) has a level of 1.[0m
[30;1m349 | [0m[35m        """[0m
[30;1m350 | [0m[35m        return self._level[0m
[30;1m351 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m    @property[0m
[30;1m338 | [0m[35m    def hasBody(self):[0m
[30;1m339 | [0m[35m        """[0m
[30;1m340 | [0m[35m        Returns True if node has non empty body, else False[0m
[30;1m341 | [0m[35m        """[0m
[30;1m342 | [0m[35m        return self._body and re.sub(r"\n|\t|\r| ", "", self._body) != ""[0m
[30;1m343 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m329 | [0m[35m    @property[0m
[30;1m330 | [0m[35m    def body(self):[0m
[30;1m331 | [0m[35m        """[0m
[30;1m332 | [0m[35m        Returns all lines of text of the body of this node except the[0m
[30;1m333 | [0m[35m        Property Drawer[0m
[30;1m334 | [0m[35m        """[0m
[30;1m335 | [0m[35m        return self._body[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m315 | [0m[35m    @property[0m
[30;1m316 | [0m[35m    def heading(self):[0m
[30;1m317 | [0m[35m        """[0m
[30;1m318 | [0m[35m        Return the Heading text of the node without the TODO tag[0m
[30;1m319 | [0m[35m        """[0m
[30;1m320 | [0m[35m        return self._heading[0m
[30;1m321 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m    @ancestors.setter[0m
[30;1m309 | [0m[35m    def ancestors(self, new_ancestors):[0m
[30;1m310 | [0m[35m        """[0m
[30;1m311 | [0m[35m        Update the ancestor headings of the node[0m
[30;1m312 | [0m[35m        """[0m
[30;1m313 | [0m[35m        self._ancestor_headings = new_ancestors[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m301 | [0m[35m    @property[0m
[30;1m302 | [0m[35m    def ancestors(self) -> List[str]:[0m
[30;1m303 | [0m[35m        """[0m
[30;1m304 | [0m[35m        Return the ancestor headings of the node[0m
[30;1m305 | [0m[35m        """[0m
[30;1m306 | [0m[35m        return self._ancestor_headings[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m    @ancestors.setter[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m    if introtext:[0m
[30;1m229 | [0m[35m        thisNode = Orgnode(level, file_title, introtext, tags)[0m
[30;1m230 | [0m[35m        nodelist = [thisNode] + nodelist[0m
[30;1m231 | [0m[35m    # write out last heading node[0m
[30;1m232 | [0m[35m    if heading:[0m
[30;1m233 | [0m[35m        thisNode = Orgnode(level, heading, bodytext, tags, ancestor_headings)[0m
[30;1m234 | [0m[35m        thisNode.properties = property_map[0m
[30;1m235 | [0m[35m        if sched_date:[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m                    # so add the line to the introtext[0m
[30;1m224 | [0m[35m                    introtext += line[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    # write out intro node before headings[0m
[30;1m227 | [0m[35m    # this is done at the end to allow collating all title lines[0m
[30;1m228 | [0m[35m    if introtext:[0m
[30;1m229 | [0m[35m        thisNode = Orgnode(level, file_title, introtext, tags)[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/processor/content/org_mode/orgnode.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m                # convert clock in, clock out strings to datetime objects[0m
[30;1m182 | [0m[35m                clocked_in = datetime.datetime.strptime(clocked_re.group(1), "%Y-%m-%d %a %H:%M")[0m
[30;1m183 | [0m[35m                clocked_out = datetime.datetime.strptime(clocked_re.group(2), "%Y-%m-%d %a %H:%M")[0m
[30;1m184 | [0m[35m                # add clocked time to the entries logbook list[0m
[30;1m185 | [0m[35m                logbook += [(clocked_in, clocked_out)][0m
[30;1m186 | [0m[35m                line = ""[0m
[30;1m187 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/email/welcome.html[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m44 | [0m[35m        </div>[0m
[30;1m45 | [0m[35m    </div>[0m
[30;1m46 | [0m[35m</div>[0m
[30;1m47 | [0m[35m<p style="color: #333; font-size: medium; margin-top: 20px; padding: 0; line-height: 1.5;">Like some[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m<p style="color: #333; font-size: large; margin-top: 20px; padding: 0; line-height: 1.5;">- The Khoj[0m
[30;1m50 | [0m[35m<table style="width: 100%; margin-top: 20px;">[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/interface/email/welcome.html[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m          <h3 style="color: #333; font-size: large; margin: 0; padding: 0; line-height: 2.0; backgro[0m
[30;1m35 | [0m[35m                </a>[0m
[30;1m36 | [0m[35m                <p style="color: #333; font-size: medium; margin-top: 20px; padding: 0; line-height:[0m
[30;1m37 | [0m[35m            </div>[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_processor_config_openai.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m        raw_config["processor"]["conversation"]["enable-offline-chat"] = False[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    # Update conversation processor schema[0m
[30;1m59 | [0m[35m    conversation_logfile = raw_config["processor"]["conversation"].get("conversation-logfile", None)[0m
[30;1m60 | [0m[35m    raw_config["processor"]["conversation"] = {[0m
[30;1m61 | [0m[35m        "openai": {"chat-model": current_chat_model, "api-key": current_openai_api_key},[0m
[30;1m62 | [0m[35m        "conversation-logfile": conversation_logfile,[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_processor_config_openai.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        return args[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    current_openai_api_key = raw_config["processor"]["conversation"].get("openai-api-key", None)[0m
[30;1m48 | [0m[35m    current_chat_model = raw_config["processor"]["conversation"].get("chat-model", None)[0m
[30;1m49 | [0m[35m    if current_openai_api_key is None and current_chat_model is None:[0m
[30;1m50 | [0m[35m        return args[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_processor_config_openai.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m    if "conversation" not in raw_config["processor"]:[0m
[30;1m45 | [0m[35m        return args[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    current_openai_api_key = raw_config["processor"]["conversation"].get("openai-api-key", None)[0m
[30;1m48 | [0m[35m    current_chat_model = raw_config["processor"]["conversation"].get("chat-model", None)[0m
[30;1m49 | [0m[35m    if current_openai_api_key is None and current_chat_model is None:[0m
[30;1m50 | [0m[35m        return args[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m474[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/khoj_assistant-1.21.1/src/khoj/migrations/migrate_processor_config_openai.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m    if "enable-offline-chat" not in raw_config["processor"]["conversation"]:[0m
[30;1m56 | [0m[35m        raw_config["processor"]["conversation"]["enable-offline-chat"] = False[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    # Update conversation processor schema[0m
[30;1m59 | [0m[35m    conversation_logfile = raw_config["processor"]["conversation"].get("conversation-logfile", None)[0m
[30;1m60 | [0m[35m    raw_config["processor"]["conversation"] = {[0m
[30;1m61 | [0m[35m        "openai": {"chat-model": current_chat_model, "api-key": current_openai_api_key},[0m

474 matches found.
