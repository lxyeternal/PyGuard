[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m166 | [0m[35m                        " and in `password` field of the connection. Using the token from the passwo[0m
[30;1m167 | [0m[35m                    )[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m                json_config["core"]["databand_access_token"] = dbnd_conn_config.password[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m            return json_config[0m
[30;1m172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m163 | [0m[35m                if "databand_access_token" in json_config["core"]:[0m
[30;1m164 | [0m[35m                    dbnd_log_debug([0m
[30;1m165 | [0m[35m                        "Found access token both in extra (`core.databand_access_token`)"[0m
[30;1m166 | [0m[35m                        " and in `password` field of the connection. Using the token from the passwo[0m
[30;1m167 | [0m[35m                    )[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m                json_config["core"]["databand_access_token"] = dbnd_conn_config.password[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m163 | [0m[35m                if "databand_access_token" in json_config["core"]:[0m
[30;1m164 | [0m[35m                    dbnd_log_debug([0m
[30;1m165 | [0m[35m                        "Found access token both in extra (`core.databand_access_token`)"[0m
[30;1m166 | [0m[35m                        " and in `password` field of the connection. Using the token from the passwo[0m
[30;1m167 | [0m[35m                    )[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m                json_config["core"]["databand_access_token"] = dbnd_conn_config.password[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m158 | [0m[35m    try:[0m
[30;1m159 | [0m[35m        json_config = dbnd_conn_config.extra_dejson[0m
[30;1m160 | [0m[35m        if json_config:[0m
[30;1m161 | [0m[35m            if dbnd_conn_config.password:[0m
[30;1m162 | [0m[35m                json_config.setdefault("core", {})[0m
[30;1m163 | [0m[35m                if "databand_access_token" in json_config["core"]:[0m
[30;1m164 | [0m[35m                    dbnd_log_debug([0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/testing/unittest_env.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m20 | [0m[35m    airflow_sql_conn = conf.get("core", "SQL_ALCHEMY_CONN")[0m
[30;1m21 | [0m[35m    env = os.environ.copy()[0m
[30;1m22 | [0m[35m    env["AIRFLOW__CORE__SQL_ALCHEMY_CONN"] = airflow_sql_conn[0m
[30;1m23 | [0m[35m    env["AIRFLOW__CORE__FERNET_KEY"] = conf.get("core", "FERNET_KEY")[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    # if we use airflow, we can get airflow from external env[0m
[30;1m26 | [0m[35m    args = ["airflow"] + args[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m393 | [0m[35m    operator._conf = get_dbnd_context_spark_conf([0m
[30;1m394 | [0m[35m        tracking_info, spark_conf=operator._conf[0m
[30;1m395 | [0m[35m    )[0m
[30;1m396 | [0m[35m    operator._env_vars = get_dbnd_context_env_vars([0m
[30;1m397 | [0m[35m        tracking_info, env_vars=operator._env_vars[0m
[30;1m398 | [0m[35m    )[0m
[30;1m399 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m366 | [0m[35m            pyspark_job = operator.job["pyspark_job"][0m
[30;1m367 | [0m[35m            pyspark_job.setdefault("properties", {})[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m            spark_envs = get_dbnd_context_spark_conf([0m
[30;1m370 | [0m[35m                tracking_info=tracking_info, spark_conf=pyspark_job["properties"][0m
[30;1m371 | [0m[35m            )[0m
[30;1m372 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m337 | [0m[35mdef track_dataproc_pyspark_operator(operator, tracking_info):[0m
[30;1m338 | [0m[35m    if operator.dataproc_properties is None:[0m
[30;1m339 | [0m[35m        operator.dataproc_properties = dict()[0m
[30;1m340 | [0m[35m    spark_envs = get_dbnd_context_spark_conf([0m
[30;1m341 | [0m[35m        tracking_info, spark_conf=operator.dataproc_properties[0m
[30;1m342 | [0m[35m    )[0m
[30;1m343 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m264 | [0m[35m        )[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        if "spark_python_task" in config:[0m
[30;1m267 | [0m[35m            script_name = cluster["spark_env_vars"].get(ENV_DBND_SCRIPT_NAME)[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    yield[0m
[30;1m270 | [0m[35m    if script_name:[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m255 | [0m[35m        cluster["spark_env_vars"] = get_dbnd_context_env_vars([0m
[30;1m256 | [0m[35m            tracking_info=tracking_info,[0m
[30;1m257 | [0m[35m            script_name=config.get("spark_python_task", {}).get("python_file"),[0m
[30;1m258 | [0m[35m            env_vars=cluster.get("spark_env_vars"),[0m
[30;1m259 | [0m[35m        )[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        # via spark.conf[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m252 | [0m[35m        cluster = config["new_cluster"][0m
[30;1m253 | [0m[35m        cluster.setdefault("spark_env_vars", {})[0m
[30;1m254 | [0m[35m        # via Environment[0m
[30;1m255 | [0m[35m        cluster["spark_env_vars"] = get_dbnd_context_env_vars([0m
[30;1m256 | [0m[35m            tracking_info=tracking_info,[0m
[30;1m257 | [0m[35m            script_name=config.get("spark_python_task", {}).get("python_file"),[0m
[30;1m258 | [0m[35m            env_vars=cluster.get("spark_env_vars"),[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m211 | [0m[35mdef track_emr_add_steps_operator(operator, tracking_info):[0m
[30;1m212 | [0m[35m    dbnd_log_info("Updating HadoopJarStep.Args with dbnd context")[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m    spark_envs = get_dbnd_context_spark_conf(tracking_info)[0m
[30;1m215 | [0m[35m    # EMR uses list arguments, it's safe to update it[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m    dbnd_context_as_cli = convert_spark_conf_to_cli_args(spark_envs)[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m149 | [0m[35mdef get_dbnd_context_env_vars(tracking_info=None, env_vars=None, script_name=None):[0m
[30;1m150 | [0m[35m    env_vars_with_dbnd = env_vars.copy() if env_vars else dict()[0m
[30;1m151 | [0m[35m    env_vars_with_dbnd.update(tracking_info)[0m
[30;1m152 | [0m[35m    # env_vars_with_dbnd.update(get_databand_url_conf())[0m
[30;1m153 | [0m[35m    if script_name:[0m
[30;1m154 | [0m[35m        script_name = _normalize_python_script_name(script_name)[0m
[30;1m155 | [0m[35m        if script_name:[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_handler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m135 | [0m[35m                f"context={ self.dbnd_context is not None }. "[0m
[30;1m136 | [0m[35m            )[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m        if os.environ.get(task_key):[0m
[30;1m139 | [0m[35m            # This key is already set which means we are in `--raw run`[0m
[30;1m140 | [0m[35m            return[0m
[30;1m141 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_handler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m        # Airflow is running with two process `--local` and `--raw`.[0m
[30;1m117 | [0m[35m        # But we want the handler to run only once (Idempotency)[0m
[30;1m118 | [0m[35m        # So we are using an environment variable to sync those two process[0m
[30;1m119 | [0m[35m        task_key = calc_task_key_from_af_ti(ti)[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m        if ti.raw:[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m        dag_ids_config: Optional[str] = monitor_config.get([0m
[30;1m247 | [0m[35m            DAG_IDS_FOR_TRACKING_CONFIG_NAME, None[0m
[30;1m248 | [0m[35m        )[0m
[30;1m249 | [0m[35m        excluded_dag_ids_config = monitor_config.get([0m
[30;1m250 | [0m[35m            EXCLUDED_DAG_IDS_FOR_TRACKING_FLAG_CONFIG_NAME, None[0m
[30;1m251 | [0m[35m        )[0m
[30;1m252 | [0m[35m        dag_ids_config_parsed: Optional[List[str]] = None[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m        is_sync_enabled = monitor_config.get(IS_SYNC_ENABLED_TRACKING_CONFIG_NAME, True)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        dag_ids_config: Optional[str] = monitor_config.get([0m
[30;1m247 | [0m[35m            DAG_IDS_FOR_TRACKING_CONFIG_NAME, None[0m
[30;1m248 | [0m[35m        )[0m
[30;1m249 | [0m[35m        excluded_dag_ids_config = monitor_config.get([0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m        if not monitor_config:[0m
[30;1m242 | [0m[35m            return True, None, None[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m        is_sync_enabled = monitor_config.get(IS_SYNC_ENABLED_TRACKING_CONFIG_NAME, True)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        dag_ids_config: Optional[str] = monitor_config.get([0m
[30;1m247 | [0m[35m            DAG_IDS_FOR_TRACKING_CONFIG_NAME, None[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        if not dbnd_config_from_connection:[0m
[30;1m237 | [0m[35m            return True, None, None[0m
[30;1m238 | [0m[35m        monitor_config = dbnd_config_from_connection.get([0m
[30;1m239 | [0m[35m            AIRFLOW_MONITOR_CONFIG_NAME, None[0m
[30;1m240 | [0m[35m        )[0m
[30;1m241 | [0m[35m        if not monitor_config:[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35mdef extract_airflow_conf(context):[0m
[30;1m78 | [0m[35m    task_instance = context.get("task_instance")[0m
[30;1m79 | [0m[35m    if task_instance is None:[0m
[30;1m80 | [0m[35m        return {}[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    from airflow.models import Variable  # pylint: disable=import-error[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    airflow_instance_uid = Variable.get([0m
[30;1m32 | [0m[35m        AIRFLOW_INSTANCE_UUID_VAR_NAME, default_var=None[0m
[30;1m33 | [0m[35m    )[0m
[30;1m34 | [0m[35m    if airflow_instance_uid:[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/models.py[0m
   Pattern: [32m.hostname[0m
[30;1m298 | [0m[35m            is_committed=self.is_committed,[0m
[30;1m299 | [0m[35m            git_commit=self.git_commit,[0m
[30;1m300 | [0m[35m            dag_folder=self.dag_folder,[0m
[30;1m301 | [0m[35m            hostname=self.hostname,[0m
[30;1m302 | [0m[35m            source_code=self.source_code,[0m
[30;1m303 | [0m[35m            module_source_hash=self.module_source_hash,[0m
[30;1m304 | [0m[35m            tasks_hash_to_source=self.tasks_hash_to_source,[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/models.py[0m
   Pattern: [32m.hostname[0m
[30;1m298 | [0m[35m            is_committed=self.is_committed,[0m
[30;1m299 | [0m[35m            git_commit=self.git_commit,[0m
[30;1m300 | [0m[35m            dag_folder=self.dag_folder,[0m
[30;1m301 | [0m[35m            hostname=self.hostname,[0m
[30;1m302 | [0m[35m            source_code=self.source_code,[0m
[30;1m303 | [0m[35m            module_source_hash=self.module_source_hash,[0m
[30;1m304 | [0m[35m            tasks_hash_to_source=self.tasks_hash_to_source,[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/models.py[0m
   Pattern: [32m.hostname[0m
[30;1m269 | [0m[35m            start_date=resolve_attribute_or_default_value(dag, "start_date", None),[0m
[30;1m270 | [0m[35m            end_date=resolve_attribute_or_default_value(dag, "end_date", None),[0m
[30;1m271 | [0m[35m            dag_folder=dag_folder,[0m
[30;1m272 | [0m[35m            hostname=get_hostname(),[0m
[30;1m273 | [0m[35m            source_code=source_code if not raw_data_only and include_source else "",[0m
[30;1m274 | [0m[35m            tasks_hash_to_source=tasks_hash_to_source,[0m
[30;1m275 | [0m[35m            module_source_hash=source_md5(source_code),[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/models.py[0m
   Pattern: [32m.hostname[0m
[30;1m269 | [0m[35m            start_date=resolve_attribute_or_default_value(dag, "start_date", None),[0m
[30;1m270 | [0m[35m            end_date=resolve_attribute_or_default_value(dag, "end_date", None),[0m
[30;1m271 | [0m[35m            dag_folder=dag_folder,[0m
[30;1m272 | [0m[35m            hostname=get_hostname(),[0m
[30;1m273 | [0m[35m            source_code=source_code if not raw_data_only and include_source else "",[0m
[30;1m274 | [0m[35m            tasks_hash_to_source=tasks_hash_to_source,[0m
[30;1m275 | [0m[35m            module_source_hash=source_md5(source_code),[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/models.py[0m
   Pattern: [32m.hostname[0m
[30;1m216 | [0m[35m        self.start_date = start_date[0m
[30;1m217 | [0m[35m        self.end_date = end_date[0m
[30;1m218 | [0m[35m        self.dag_folder = dag_folder[0m
[30;1m219 | [0m[35m        self.hostname = hostname[0m
[30;1m220 | [0m[35m        self.source_code = source_code[0m
[30;1m221 | [0m[35m        self.module_source_hash = module_source_hash[0m
[30;1m222 | [0m[35m        self.tasks_hash_to_source = tasks_hash_to_source[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/models.py[0m
   Pattern: [32m.hostname[0m
[30;1m216 | [0m[35m        self.start_date = start_date[0m
[30;1m217 | [0m[35m        self.end_date = end_date[0m
[30;1m218 | [0m[35m        self.dag_folder = dag_folder[0m
[30;1m219 | [0m[35m        self.hostname = hostname[0m
[30;1m220 | [0m[35m        self.source_code = source_code[0m
[30;1m221 | [0m[35m        self.module_source_hash = module_source_hash[0m
[30;1m222 | [0m[35m        self.tasks_hash_to_source = tasks_hash_to_source[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/models.py[0m
   Pattern: [32m.hostname[0m
[30;1m192 | [0m[35m        start_date,[0m
[30;1m193 | [0m[35m        end_date,[0m
[30;1m194 | [0m[35m        dag_folder,[0m
[30;1m195 | [0m[35m        hostname,[0m
[30;1m196 | [0m[35m        source_code,[0m
[30;1m197 | [0m[35m        module_source_hash,[0m
[30;1m198 | [0m[35m        tasks_hash_to_source,[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/models.py[0m
   Pattern: [32m.hostname[0m
[30;1m9 | [0m[35mimport attr[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom airflow.models import BaseOperator, DagRun, TaskInstance[0m
[30;1m12 | [0m[35mfrom airflow.utils.net import get_hostname[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom dbnd._core.utils.uid_utils import source_md5[0m
[30;1m15 | [0m[35mfrom dbnd_airflow.export_plugin.helpers import ([0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/testing/unittest_env.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    airflow_sql_conn = conf.get("core", "SQL_ALCHEMY_CONN")[0m
[30;1m21 | [0m[35m    env = os.environ.copy()[0m
[30;1m22 | [0m[35m    env["AIRFLOW__CORE__SQL_ALCHEMY_CONN"] = airflow_sql_conn[0m
[30;1m23 | [0m[35m    env["AIRFLOW__CORE__FERNET_KEY"] = conf.get("core", "FERNET_KEY")[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    # if we use airflow, we can get airflow from external env[0m
[30;1m26 | [0m[35m    args = ["airflow"] + args[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/testing/unittest_env.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m    from sqlalchemy.engine.url import make_url[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    # let's make sure that we user correct connection string[0m
[30;1m20 | [0m[35m    airflow_sql_conn = conf.get("core", "SQL_ALCHEMY_CONN")[0m
[30;1m21 | [0m[35m    env = os.environ.copy()[0m
[30;1m22 | [0m[35m    env["AIRFLOW__CORE__SQL_ALCHEMY_CONN"] = airflow_sql_conn[0m
[30;1m23 | [0m[35m    env["AIRFLOW__CORE__FERNET_KEY"] = conf.get("core", "FERNET_KEY")[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/testing/unittest_env.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m    env["AIRFLOW__CORE__SQL_ALCHEMY_CONN"] = airflow_sql_conn[0m
[30;1m23 | [0m[35m    env["AIRFLOW__CORE__FERNET_KEY"] = conf.get("core", "FERNET_KEY")[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    # if we use airflow, we can get airflow from external env[0m
[30;1m26 | [0m[35m    args = ["airflow"] + args[0m
[30;1m27 | [0m[35m    logging.info([0m
[30;1m28 | [0m[35m        "Running airflow command at subprocess: '%s" " with DB=%s",[0m
[30;1m29 | [0m[35m        subprocess.list2cmdline(args),[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/testing/unittest_env.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    # let's make sure that we user correct connection string[0m
[30;1m20 | [0m[35m    airflow_sql_conn = conf.get("core", "SQL_ALCHEMY_CONN")[0m
[30;1m21 | [0m[35m    env = os.environ.copy()[0m
[30;1m22 | [0m[35m    env["AIRFLOW__CORE__SQL_ALCHEMY_CONN"] = airflow_sql_conn[0m
[30;1m23 | [0m[35m    env["AIRFLOW__CORE__FERNET_KEY"] = conf.get("core", "FERNET_KEY")[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/testing/unittest_env.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    # we can't call load_test_config, as it override airflow.cfg[0m
[30;1m60 | [0m[35m    # we want to keep it as base[0m
[30;1m61 | [0m[35m    logger.info("Reading Airflow test config at %s" % TEST_CONFIG_FILE)[0m
[30;1m62 | [0m[35m    airflow_configuration.conf.read(TEST_CONFIG_FILE)[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    # init db first[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/testing/unittest_env.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m    # if we use airflow, we can get airflow from external env[0m
[30;1m26 | [0m[35m    args = ["airflow"] + args[0m
[30;1m27 | [0m[35m    logging.info([0m
[30;1m28 | [0m[35m        "Running airflow command at subprocess: '%s" " with DB=%s",[0m
[30;1m29 | [0m[35m        subprocess.list2cmdline(args),[0m
[30;1m30 | [0m[35m        repr(make_url(airflow_sql_conn)),[0m
[30;1m31 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m    # Only for orchestration, tracking users should install Airflow manually before DBND[0m
[30;1m21 | [0m[35m    # The best way to install airflow is manually with constraints beforehand.[0m
[30;1m22 | [0m[35m    # For example:[0m
[30;1m23 | [0m[35m    # pip install apache-airflow  --constraint "https://raw.githubusercontent.com/apache/airflow/con[0m
[30;1m24 | [0m[35m    extras_require=dict([0m
[30;1m25 | [0m[35m        tests=[[0m
[30;1m26 | [0m[35m            # airflow 2.3 has a problem with pluggy <1.0, that makes pytest 4 incompatible[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m        )[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        if "spark_python_task" in config:[0m
[30;1m267 | [0m[35m            script_name = cluster["spark_env_vars"].get(ENV_DBND_SCRIPT_NAME)[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    yield[0m
[30;1m270 | [0m[35m    if script_name:[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        # via spark.conf[0m
[30;1m262 | [0m[35m        cluster["spark_conf"] = get_dbnd_context_spark_conf([0m
[30;1m263 | [0m[35m            tracking_info=tracking_info, spark_conf=cluster.get("spark_conf")[0m
[30;1m264 | [0m[35m        )[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        if "spark_python_task" in config:[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m        cluster["spark_env_vars"] = get_dbnd_context_env_vars([0m
[30;1m256 | [0m[35m            tracking_info=tracking_info,[0m
[30;1m257 | [0m[35m            script_name=config.get("spark_python_task", {}).get("python_file"),[0m
[30;1m258 | [0m[35m            env_vars=cluster.get("spark_env_vars"),[0m
[30;1m259 | [0m[35m        )[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        # via spark.conf[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m        # via Environment[0m
[30;1m255 | [0m[35m        cluster["spark_env_vars"] = get_dbnd_context_env_vars([0m
[30;1m256 | [0m[35m            tracking_info=tracking_info,[0m
[30;1m257 | [0m[35m            script_name=config.get("spark_python_task", {}).get("python_file"),[0m
[30;1m258 | [0m[35m            env_vars=cluster.get("spark_env_vars"),[0m
[30;1m259 | [0m[35m        )[0m
[30;1m260 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m        # via Environment[0m
[30;1m255 | [0m[35m        cluster["spark_env_vars"] = get_dbnd_context_env_vars([0m
[30;1m256 | [0m[35m            tracking_info=tracking_info,[0m
[30;1m257 | [0m[35m            script_name=config.get("spark_python_task", {}).get("python_file"),[0m
[30;1m258 | [0m[35m            env_vars=cluster.get("spark_env_vars"),[0m
[30;1m259 | [0m[35m        )[0m
[30;1m260 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m                set_task_run_state_safe(tracking_store, task_run, TaskRunState.FAILED)[0m
[30;1m309 | [0m[35m        except Exception as exc:[0m
[30;1m310 | [0m[35m            logger.error([0m
[30;1m311 | [0m[35m                "Unable to get inline script run state from Databricks. Setting task run state to Fa[0m
[30;1m312 | [0m[35m                exc,[0m
[30;1m313 | [0m[35m            )[0m
[30;1m314 | [0m[35m            set_task_run_state_safe(tracking_store, task_run, TaskRunState.FAILED)[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m275 | [0m[35m            task_run_attempt_uid,[0m
[30;1m276 | [0m[35m        ) = get_task_run_uid_for_inline_script(tracking_info, script_name)[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m        # When dbnd is running inside Databricks, the script can be SIGTERM'd before dbnd will send [0m
[30;1m279 | [0m[35m        # So we need to check whenever the run was succeeded afterwards and set run state manually[0m
[30;1m280 | [0m[35m        tracking_store = dbnd_context().tracking_store  # type: TrackingStore[0m
[30;1m281 | [0m[35m        run = FakeRun(source=UpdateSource.airflow_tracking)[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m    # type: (DatabricksSubmitRunOperator, Dict[str, str])-> None[0m
[30;1m246 | [0m[35m    config = operator.json[0m
[30;1m247 | [0m[35m    script_name = None  # type: str[0m
[30;1m248 | [0m[35m    # passing env variables is only supported in new clusters[0m
[30;1m249 | [0m[35m    cluster = None[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m    if "new_cluster" in config:[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m    )[0m
[30;1m196 | [0m[35m    if index == -1:[0m
[30;1m197 | [0m[35m        dbnd_log_exception([0m
[30;1m198 | [0m[35m            "Failed to find 'spark-submit' cmd in %s"[0m
[30;1m199 | [0m[35m            % " ".join(original_command_as_list)[0m
[30;1m200 | [0m[35m        )[0m
[30;1m201 | [0m[35m        return original_command_as_list[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m                spark_conf[property_name] + "," + dbnd_spark_conf[property_name][0m
[30;1m143 | [0m[35m            )[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    dbnd_log_debug("Injecting Env variables with merge: %s", dbnd_spark_conf)[0m
[30;1m146 | [0m[35m    return merged_conf[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    # simple case, used doesn't have his own configuration[0m
[30;1m124 | [0m[35m    if not spark_conf:[0m
[30;1m125 | [0m[35m        dbnd_log_debug("Injecting Env variables %s", dbnd_spark_conf)[0m
[30;1m126 | [0m[35m        return dbnd_spark_conf[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # we need to merge[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m        return script_name[0m
[30;1m71 | [0m[35m    except Exception as exc:[0m
[30;1m72 | [0m[35m        logger.error([0m
[30;1m73 | [0m[35m            "Unable to determine script name from path %s, exception: %s",[0m
[30;1m74 | [0m[35m            raw_script_path,[0m
[30;1m75 | [0m[35m            exc,[0m
[30;1m76 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m        script_name = os.path.basename(raw_script_path)[0m
[30;1m64 | [0m[35m        if not script_name:[0m
[30;1m65 | [0m[35m            logger.warning([0m
[30;1m66 | [0m[35m                "Unable to determine script name from path %s", raw_script_path[0m
[30;1m67 | [0m[35m            )[0m
[30;1m68 | [0m[35m            return None[0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m431 | [0m[35m    # enables DbndSparkQueryExecutionListener. - it can be omitted as a first step[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m    try:[0m
[30;1m434 | [0m[35m        # UPDATE CUSTOM OPERATOR[0m
[30;1m435 | [0m[35m        custom_cli = convert_spark_conf_to_cli_args([0m
[30;1m436 | [0m[35m            get_dbnd_context_spark_conf(tracking_info)[0m
[30;1m437 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m275 | [0m[35m            task_run_attempt_uid,[0m
[30;1m276 | [0m[35m        ) = get_task_run_uid_for_inline_script(tracking_info, script_name)[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m        # When dbnd is running inside Databricks, the script can be SIGTERM'd before dbnd will send [0m
[30;1m279 | [0m[35m        # So we need to check whenever the run was succeeded afterwards and set run state manually[0m
[30;1m280 | [0m[35m        tracking_store = dbnd_context().tracking_store  # type: TrackingStore[0m
[30;1m281 | [0m[35m        run = FakeRun(source=UpdateSource.airflow_tracking)[0m
[30;1m282 | [0m[35m        task_run = FakeTaskRun([0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m212 | [0m[35m    dbnd_log_info("Updating HadoopJarStep.Args with dbnd context")[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m    spark_envs = get_dbnd_context_spark_conf(tracking_info)[0m
[30;1m215 | [0m[35m    # EMR uses list arguments, it's safe to update it[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m    dbnd_context_as_cli = convert_spark_conf_to_cli_args(spark_envs)[0m
[30;1m218 | [0m[35m    for step in operator.steps:[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_spark_conf.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m195 | [0m[35m    )[0m
[30;1m196 | [0m[35m    if index == -1:[0m
[30;1m197 | [0m[35m        dbnd_log_exception([0m
[30;1m198 | [0m[35m            "Failed to find 'spark-submit' cmd in %s"[0m
[30;1m199 | [0m[35m            % " ".join(original_command_as_list)[0m
[30;1m200 | [0m[35m        )[0m
[30;1m201 | [0m[35m        return original_command_as_list[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/execute_tracking.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m346 | [0m[35m            try_number=try_number,[0m
[30;1m347 | [0m[35m            context=airflow_context,[0m
[30;1m348 | [0m[35m            airflow_instance_uid=airflow_instance_uid,[0m
[30;1m349 | [0m[35m            is_subdag=airflow_context.get("dag").is_subdag,[0m
[30;1m350 | [0m[35m        )[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/execute_tracking.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m) -> Optional[AirflowTaskContext]:[0m
[30;1m329 | [0m[35m    """Create AirflowTaskContext for airflow_context dict"""[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m    task_instance = airflow_context.get("task_instance")[0m
[30;1m332 | [0m[35m    if task_instance is None:[0m
[30;1m333 | [0m[35m        return None[0m
[30;1m334 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/execute_tracking.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m        if hasattr(operator, "_tracked_instance"):[0m
[30;1m292 | [0m[35m            return operator[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        # this is the first time we encounter this instance so we mark it[0m
[30;1m295 | [0m[35m        operator._tracked_instance = True[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m        # if the operator's class is tracked, we can't used `operator.__class__.execute`[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/execute_tracking.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m280 | [0m[35m        ):[0m
[30;1m281 | [0m[35m            return operator[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m        # this is the first time we encounter this class so we mark it[0m
[30;1m284 | [0m[35m        operator._tracked_class = operator.__name__[0m
[30;1m285 | [0m[35m        operator.__execute__ = operator.execute[0m
[30;1m286 | [0m[35m        operator.execute = execute_with_dbnd_tracking_for_class[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/execute_tracking.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m    dbnd_tracking_stop,[0m
[30;1m19 | [0m[35m    tracking_start_base,[0m
[30;1m20 | [0m[35m)[0m
[30;1m21 | [0m[35mfrom dbnd._core.utils.basics.environ_utils import env[0m
[30;1m22 | [0m[35mfrom dbnd._core.utils.basics.nested_context import safe_nested[0m
[30;1m23 | [0m[35mfrom dbnd_airflow.raw_constants import MONITOR_DAG_NAME[0m
[30;1m24 | [0m[35mfrom dbnd_airflow.tracking.config import AirflowTrackingConfig[0m
[30;1m25 | [0m[35mfrom dbnd_airflow.tracking.dbnd_airflow_conf import ([0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/execute_tracking.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m350 | [0m[35m        )[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    logger.debug([0m
[30;1m353 | [0m[35m        "airflow context from inspect, at least one of those params is missing"[0m
[30;1m354 | [0m[35m        "dag_id: %s, execution_date: %s, task_id: %s",[0m
[30;1m355 | [0m[35m        dag_id,[0m
[30;1m356 | [0m[35m        execution_date,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m# Using dbnd_config[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mLet's look at the example again, but change the default_args defined at the very top:[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m```python[0m
[30;1m90 | [0m[35mdefault_args = {[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m# Using dbnd_config[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mLet's look at the example again, but change the default_args defined at the very top:[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m```python[0m
[30;1m90 | [0m[35mdefault_args = {[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/entrypoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    airflow_logger = logging.getLogger(AIRFLOW_TASK_LOGGER)[0m
[30;1m32 | [0m[35m    dbnd_log_debug("Airflow wrapping via entrypoint")[0m
[30;1m33 | [0m[35m    # This code will run every time Airflow imports our plugin[0m
[30;1m34 | [0m[35m    # it will change current airflow policy to include Databand policy via add_tracking_to_policy[0m
[30;1m35 | [0m[35m    # -> `dbnd_airflow.tracking.dbnd_dag_tracking.track_task` will be applied on every task[0m
[30;1m36 | [0m[35m    # -> `dbnd_airflow.tracking.execute_tracking.new_execute` will wrap Operator.execute[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/airflow_patching.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mdef patch_airflow_context_vars():[0m
[30;1m63 | [0m[35m    """Used for tracking bash operators"""[0m
[30;1m64 | [0m[35m    try:[0m
[30;1m65 | [0m[35m        from dbnd._core.utils.object_utils import patch_models[0m
[30;1m66 | [0m[35m        from dbnd_airflow.tracking.operator_helpers import context_to_airflow_vars[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/airflow_patching.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mdef patch_airflow_context_vars():[0m
[30;1m63 | [0m[35m    """Used for tracking bash operators"""[0m
[30;1m64 | [0m[35m    try:[0m
[30;1m65 | [0m[35m        from dbnd._core.utils.object_utils import patch_models[0m
[30;1m66 | [0m[35m        from dbnd_airflow.tracking.operator_helpers import context_to_airflow_vars[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m                    continue[0m
[30;1m161 | [0m[35m        return res[0m
[30;1m162 | [0m[35m    except Exception as ex:[0m
[30;1m163 | [0m[35m        task_id = t_dict.get("task_id") or t_dict.get("_dag_id")[0m
[30;1m164 | [0m[35m        logging.error("Could not collect task args for %s: %s", task_id, ex)[0m
[30;1m165 | [0m[35m        return {}[0m
[30;1m166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m                    continue[0m
[30;1m161 | [0m[35m        return res[0m
[30;1m162 | [0m[35m    except Exception as ex:[0m
[30;1m163 | [0m[35m        task_id = t_dict.get("task_id") or t_dict.get("_dag_id")[0m
[30;1m164 | [0m[35m        logging.error("Could not collect task args for %s: %s", task_id, ex)[0m
[30;1m165 | [0m[35m        return {}[0m
[30;1m166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m134 | [0m[35m        return {}[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    if isinstance(t_dict, str) and t_dict.startswith("{"):[0m
[30;1m137 | [0m[35m        # try load json. is this correct at all?[0m
[30;1m138 | [0m[35m        try:[0m
[30;1m139 | [0m[35m            t_dict = json.loads(t_dict)[0m
[30;1m140 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35m            if isinstance(t.bash_command, str):[0m
[30;1m98 | [0m[35m                return t.bash_command[0m
[30;1m99 | [0m[35m            if hasattr(t, "python_callable"):[0m
[30;1m100 | [0m[35m                # Adds support for bash decorator added in Airflow 2.9[0m
[30;1m101 | [0m[35m                return inspect.getsource(t.python_callable)[0m
[30;1m102 | [0m[35m        return None[0m
[30;1m103 | [0m[35m    except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m            if isinstance(t.bash_command, str):[0m
[30;1m98 | [0m[35m                return t.bash_command[0m
[30;1m99 | [0m[35m            if hasattr(t, "python_callable"):[0m
[30;1m100 | [0m[35m                # Adds support for bash decorator added in Airflow 2.9[0m
[30;1m101 | [0m[35m                return inspect.getsource(t.python_callable)[0m
[30;1m102 | [0m[35m        return None[0m
[30;1m103 | [0m[35m    except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m# Using dbnd_config[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35mLet's look at the example again, but change the default_args defined at the very top:[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m```python[0m
[30;1m131 | [0m[35mdefault_args = {[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m# Using dbnd_config[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35mLet's look at the example again, but change the default_args defined at the very top:[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m```python[0m
[30;1m131 | [0m[35mdefault_args = {[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m# Using dbnd_config[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35mLet's look at the example again, but change the default_args defined at the very top:[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m```python[0m
[30;1m131 | [0m[35mdefault_args = {[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m# Using dbnd_config[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35mLet's look at the example again, but change the default_args defined at the very top:[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m```python[0m
[30;1m131 | [0m[35mdefault_args = {[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/api_functions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35mdef remove_place_holders(dbnd_response):[0m
[30;1m172 | [0m[35m    """Remove from configurations value which only have placeholders, so they won't override valid v[0m
[30;1m173 | [0m[35m    if dbnd_response.get("core") is not None:[0m
[30;1m174 | [0m[35m        dbnd_response["core"].pop("databand_access_token", None)[0m
[30;1m175 | [0m[35m        dbnd_response["core"].pop("databand_url", None)[0m
[30;1m176 | [0m[35m        if not dbnd_response["core"]:[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/api_functions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m            returned = deep_update(source.get(key, {}), value)[0m
[30;1m161 | [0m[35m            source[key] = returned[0m
[30;1m162 | [0m[35m        else:[0m
[30;1m163 | [0m[35m            if source.get(key) != overrides[key]:[0m
[30;1m164 | [0m[35m                dbnd_log_debug([0m
[30;1m165 | [0m[35m                    f"Updating Airflow config value at '{key}' with '{overrides[key]}'"[0m
[30;1m166 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/api_functions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m    """[0m
[30;1m158 | [0m[35m    for key, value in overrides.items():[0m
[30;1m159 | [0m[35m        if isinstance(value, Mapping) and value:[0m
[30;1m160 | [0m[35m            returned = deep_update(source.get(key, {}), value)[0m
[30;1m161 | [0m[35m            source[key] = returned[0m
[30;1m162 | [0m[35m        else:[0m
[30;1m163 | [0m[35m            if source.get(key) != overrides[key]:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/api_functions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        request_args=dict(flask.request.args) if flask.has_request_context() else {},[0m
[30;1m74 | [0m[35m        metrics={[0m
[30;1m75 | [0m[35m            "performance": metrics.get("perf_metrics", {}),[0m
[30;1m76 | [0m[35m            "sizes": metrics.get("size_metrics", {}),[0m
[30;1m77 | [0m[35m        },[0m
[30;1m78 | [0m[35m    )[0m
[30;1m79 | [0m[35m    return meta[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/api_functions.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        api_mode=get_api_mode(),[0m
[30;1m73 | [0m[35m        request_args=dict(flask.request.args) if flask.has_request_context() else {},[0m
[30;1m74 | [0m[35m        metrics={[0m
[30;1m75 | [0m[35m            "performance": metrics.get("perf_metrics", {}),[0m
[30;1m76 | [0m[35m            "sizes": metrics.get("size_metrics", {}),[0m
[30;1m77 | [0m[35m        },[0m
[30;1m78 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/api_functions.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m162 | [0m[35m        else:[0m
[30;1m163 | [0m[35m            if source.get(key) != overrides[key]:[0m
[30;1m164 | [0m[35m                dbnd_log_debug([0m
[30;1m165 | [0m[35m                    f"Updating Airflow config value at '{key}' with '{overrides[key]}'"[0m
[30;1m166 | [0m[35m                )[0m
[30;1m167 | [0m[35m            source[key] = overrides[key][0m
[30;1m168 | [0m[35m    return source[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/api_functions.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35mdef deep_update(source, overrides):[0m
[30;1m154 | [0m[35m    """[0m
[30;1m155 | [0m[35m    Update a nested dictionary or similar mapping.[0m
[30;1m156 | [0m[35m    Modify ``source`` in place.[0m
[30;1m157 | [0m[35m    """[0m
[30;1m158 | [0m[35m    for key, value in overrides.items():[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m                f"context={ self.dbnd_context is not None }. "[0m
[30;1m136 | [0m[35m            )[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m        if os.environ.get(task_key):[0m
[30;1m139 | [0m[35m            # This key is already set which means we are in `--raw run`[0m
[30;1m140 | [0m[35m            return[0m
[30;1m141 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m        try:[0m
[30;1m187 | [0m[35m            if self.dbnd_context_manage:[0m
[30;1m188 | [0m[35m                if is_dbnd_tracking_active():[0m
[30;1m189 | [0m[35m                    # Stops and clears the script tracking if exists and the user forgot to stop it.[0m
[30;1m190 | [0m[35m                    self.airflow_logger.info([0m
[30;1m191 | [0m[35m                        "Stopping Databand Tracking (on logging shutdown)."[0m
[30;1m192 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/dbnd_airflow_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m174 | [0m[35m                    task_run=fake_task_run, log_body=in_memory_log_body[0m
[30;1m175 | [0m[35m                )[0m
[30;1m176 | [0m[35m                dbnd_log_debug([0m
[30;1m177 | [0m[35m                    "Saved Airflow log to Databand service (size=%s)"[0m
[30;1m178 | [0m[35m                    % len(in_memory_log_body or "")[0m
[30;1m179 | [0m[35m                )[0m
[30;1m180 | [0m[35m            except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/smart_dagbag.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m        return self._dags[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    def get_dag(self, dag_id):[0m
[30;1m97 | [0m[35m        return self._dags.get(dag_id, None)[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m# we can not use `dbnd_airflow.compat` here,[0m
[30;1m34 | [0m[35m# as we have .compat usage at "import" level,[0m
[30;1m35 | [0m[35m# meaning we might have circular dependency while loading airflow plugins[0m
[30;1m36 | [0m[35m# (import dbnd_airflow.compat -> import airflow -> import plugin -> import dbnd_airflow.compat again[0m
[30;1m37 | [0m[35mAIRFLOW_VERSION_2 = version.parse(airflow.version.version) >= version.parse("2.0.0")[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    provide_databand_service_endpoint = parameter([0m
[30;1m38 | [0m[35m        default=True,[0m
[30;1m39 | [0m[35m        description="Should Databand inject tracker URL and access token into spark-submit cmd,"[0m
[30;1m40 | [0m[35m        "e.g. `spark-submit --conf DBND__CORE__DATABAND_URL=... --conf DBND__CORE__DATABAND_ACCESS_T[0m
[30;1m41 | [0m[35m    )[bool][0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    try:[0m
[30;1m23 | [0m[35m        return conf.get("core", "task_log_reader")[0m
[30;1m24 | [0m[35m    except AirflowConfigException:[0m
[30;1m25 | [0m[35m        return conf.get("logging", "task_log_reader")[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef get_api_mode():[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mdef get_task_log_reader():[0m
[30;1m22 | [0m[35m    try:[0m
[30;1m23 | [0m[35m        return conf.get("core", "task_log_reader")[0m
[30;1m24 | [0m[35m    except AirflowConfigException:[0m
[30;1m25 | [0m[35m        return conf.get("logging", "task_log_reader")[0m
[30;1m26 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m    try:[0m
[30;1m16 | [0m[35m        return conf.get("core", "base_log_folder")[0m
[30;1m17 | [0m[35m    except AirflowConfigException:[0m
[30;1m18 | [0m[35m        return conf.get("logging", "base_log_folder")[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mdef get_task_log_reader():[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mdef base_log_folder():[0m
[30;1m15 | [0m[35m    try:[0m
[30;1m16 | [0m[35m        return conf.get("core", "base_log_folder")[0m
[30;1m17 | [0m[35m    except AirflowConfigException:[0m
[30;1m18 | [0m[35m        return conf.get("logging", "base_log_folder")[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/export_plugin/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mdef is_rbac_enabled():[0m
[30;1m8 | [0m[35m    try:[0m
[30;1m9 | [0m[35m        return conf.get("webserver", "rbac").lower() == "true"[0m
[30;1m10 | [0m[35m    except AirflowConfigException:[0m
[30;1m11 | [0m[35m        return True[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/wrap_operators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        # not found[0m
[30;1m149 | [0m[35m        return None[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    tracking_wrapper = airflow_operator_handlers.get(name)[0m
[30;1m152 | [0m[35m    if not tracking_wrapper:[0m
[30;1m153 | [0m[35m        # found but empty -> user has disabled the operator[0m
[30;1m154 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/wrap_operators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m        return None[0m
[30;1m155 | [0m[35m    if isinstance(tracking_wrapper, str):[0m
[30;1m156 | [0m[35m        tracking_wrapper = load_python_callable(tracking_wrapper)[0m
[30;1m157 | [0m[35m        # Update the cache with the loaded function[0m
[30;1m158 | [0m[35m        airflow_operator_handlers[name] = tracking_wrapper[0m
[30;1m159 | [0m[35m    return tracking_wrapper[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/wrap_operators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m134 | [0m[35m        )[0m
[30;1m135 | [0m[35m        if tracking_wrapper:[0m
[30;1m136 | [0m[35m            dbnd_log_debug([0m
[30;1m137 | [0m[35m                "Applying airflow operator wrapper %s at %s",[0m
[30;1m138 | [0m[35m                operator.task_id,[0m
[30;1m139 | [0m[35m                tracking_wrapper,[0m
[30;1m140 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m95[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dbnd_airflow-1.0.28.1/src/dbnd_airflow/tracking/airflow_connections.py[0m
   Pattern: [32m.hostname[0m
[30;1m10 | [0m[35m    connection = BaseHook.get_connection(conn_id)  # type: Connection[0m
[30;1m11 | [0m[35m    return build_conn_path([0m
[30;1m12 | [0m[35m        conn_type=connection.conn_type,[0m
[30;1m13 | [0m[35m        hostname=connection.host,[0m
[30;1m14 | [0m[35m        port=connection.port,[0m
[30;1m15 | [0m[35m        path=connection.schema,[0m
[30;1m16 | [0m[35m    )[0m

95 matches found.
